"use strict";var _TACAT,_TAPAL,_TASCORE;function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function asyncGeneratorStep(t,e,i,s,l,o,a){try{var n=t[o](a),r=n.value}catch(t){return void i(t)}n.done?e(r):Promise.resolve(r).then(s,l)}function _asyncToGenerator(n){return function(){var t=this,a=arguments;return new Promise(function(e,i){var s=n.apply(t,a);function l(t){asyncGeneratorStep(s,e,i,l,o,"next",t)}function o(t){asyncGeneratorStep(s,e,i,l,o,"throw",t)}l(void 0)})}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function SaveInterface(t){this.PlanetInterface=t,this.logo=null,this.turtles=null,this.storage=null,this.planet=null,this.printBlockSVG=null,this.filename=null,this.notationConvert="",this.timeLastSaved=-100,this.htmlSaveTemplate='<!DOCTYPE html><html lang="en"><head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="description" content="{{ project_description }}"> <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0"> <title>{{ project_name }}</title> <meta property="og:site_name" content="Music Blocks"/> <meta property="og:type" content="website"/> <meta property="og:title" content="'+_("Music Blocks Project")+' - {{ project_name }}"/> <meta property="og:description" content="{{ project_description }}"/> <style>body{background-color: #dbf0fb;}#main{background-color: white; padding: 5%; position: fixed; width: 80vw; height: max-content; margin: auto; top: 0; left: 0; bottom: 0; right: 0; display: flex; flex-direction: column; justify-content: center; text-align: center; color: #424242; box-shadow: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23); font-family: "Roboto", "Helvetica","Arial",sans-serif;}h3{font-weight: 400; font-size: 36px; margin-top: 10px;}hr{border-top: 0px solid #ccc; margin: 1em;}.btn{border: solid; border-color: #96D3F3; padding: 5px 10px; line-height: 50px; color: #0a3e58;}.btn:hover{transition: 0.4s; -webkit-transition: 0.3s; -moz-transition: 0.3s; background-color: #96D3F3;}.code{word-break: break-all; height: 15vh; background: #f6f8fa; color: #494949; text-align: justify; margin-right: 10vw; margin-left: 10vw; padding: 16px; overflow: auto; line-height: 1.45; background-color: #f6f8fa; border-radius: 3px; font-family: "SFMono-Regular",Consolas,"Liberation Mono",Menlo,Courier,monospace;}.image{border-radius: 2px 2px 0 0; position: relative; background-color: #96D3F3;}.image-div{margin-bottom: 10px;}.moreinfo-div{margin-top: 20px;}h4{font-weight: 500; font-size: 1.4em; margin-top: 10px; margin-bottom: 10px;}.tbcode{margin-bottom: 10px;}</style></head><body> <div id="main"> <div class="image-div"><img class="image" id="project-image" src="{{ project_image }}"></div><h3 id="title">'+_("Music Blocks Project")+' - {{ project_name }}</h3> <p>{{ project_description }}</p><hr> <div> <div style="color: #9E9E9E"><p>'+_("This project was created in Music Blocks")+' (<a href="https://musicblocks.sugarlabs.org" target="_blank">https://musicblocks.sugarlabs.org</a>). '+TITLESTRING+" "+_("Music Blocks is a Free/Libre Software application.")+" "+_("The source code can be accessed at")+' <a href="https://github.com/sugarlabs/musicblocks" target="_blank">https://github.com/sugarlabs/musicblocks</a>. '+_("For more information, please consult the")+' <a href="'+GUIDEURL+'" target="_blank">'+_("Music Blocks Guide")+"</a>.</p><p>"+_("To run this project, open Music Blocks in a web browser and drag and drop this file into the browser window.")+" "+_("Alternatively, open the file in Music Blocks using the Load project button.")+'</p></div><div class="moreinfo-div"> <div class="tbcode"><h4>'+_("Project Code")+"</h4>"+_("This code stores data about the blocks in a project.")+' <a href="javascript:toggle();" id="showhide">'+_("Show")+'</a></div> <div class="code">{{ data }}</div></div></div></div><script type="text/javascript">function toggle(){if (document.getElementsByClassName("code")[0].style.display=="none"){document.getElementsByClassName("code")[0].style.display="flex";document.getElementById("showhide").textContent = "'+_("Hide")+'";} else {document.getElementsByClassName("code")[0].style.display="none";document.getElementById("showhide").textContent = "Show";}} var name=decodeURIComponent(window.location.pathname.split("/").pop().slice(0, -5)); var prefix="'+_("Music Blocks Project")+' - "; var title=prefix+name; document.querySelector(\'meta[property="og:title"]\').content=title; document.title=name; document.getElementById("title").textContent=title; document.getElementsByClassName("code")[0].style.display = "none";<\/script></body></html>',this.download=function(t,e,i){var s=null;s=null==i?(i=void 0===this.PlanetInterface?_("My Project"):this.PlanetInterface.getCurrentProjectName(),console.log(i),fileExt(i)!=t&&(i+="."+t),1==window.isElectron?i:prompt("Filename:",i)):(fileExt(i)!=t&&(i+="."+t),i),console.log(s),null!==s?(fileExt(s)!=t&&(s+="."+t),this.downloadURL(s,e)):console.log("save cancelled")},this.downloadURL=function(t,e){var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i)},this.setVariables=function(t){for(var e=0;e<t.length;e++)this[t[e][0]]=t[e][1]},this.prepareHTML=function(){var t=this.htmlSaveTemplate;if(void 0!==this.PlanetInterface)var e=this.PlanetInterface.getCurrentProjectDescription();else e=_("No description provided");if(null==e&&(e=_("No description provided")),void 0!==this.PlanetInterface)var i=this.PlanetInterface.getCurrentProjectName();else i=_("My Project");var s=prepareExport();if(void 0!==this.PlanetInterface)var l=this.PlanetInterface.getCurrentProjectImage();else l="";return t=t.replace(new RegExp("{{ project_description }}","g"),e).replace(new RegExp("{{ project_name }}","g"),i).replace(new RegExp("{{ data }}","g"),s).replace(new RegExp("{{ project_image }}","g"),l)},this.saveHTML=function(t){var e="data:text/plain;charset=utf-8,"+encodeURIComponent(this.prepareHTML());console.log(t),this.download("html",e,t)},this.saveHTMLNoPrompt=function(){setTimeout(function(){var t="data:text/plain;charset=utf-8,"+encodeURIComponent(this.prepareHTML());void 0!==this.PlanetInterface?this.downloadURL(this.PlanetInterface.getCurrentProjectName()+".html",t):this.downloadURL(_("My Project").replace(" ","_")+".html",t)}.bind(this),500)},this.saveSVG=function(t){var e="data:image/svg+xml;utf8,"+doSVG(this.logo.canvas,this.logo,this.logo.turtles,this.logo.canvas.width,this.logo.canvas.height,1);this.download("svg",e,t)},this.savePNG=function(t){var e=docById("overlayCanvas").toDataURL("image/png");this.download("png",e,t)},this.saveBlockArtwork=function(t){var e="data:image/svg+xml;utf8,"+this.printBlockSVG();this.download("svg",e,t)},this.saveWAV=function(t){document.body.style.cursor="wait",this.filename=t,this.logo.playbackQueue={},this.logo.playbackTime=0,this.logo.compiling=!0,this.logo.recording=!0,console.log("DURING SAVE WAV"),this.logo.runLogoCommands()},this.afterSaveWAV=function(t){console.log("AFTER SAVE WAV"),this.download("wav",URL.createObjectURL(t))},this.saveAbc=function(t){document.body.style.cursor="wait",this.filename=t,console.log("Saving .abc file"),this.logo.runningAbc=!0,this.logo.notationOutput=ABCHEADER,this.logo.notationNotes={};for(var e=0;e<this.turtles.turtleList.length;e++)this.logo.notationStaging[e]=[],this.logo.notationDrumStaging[e]=[],this.turtles.turtleList[e].doClear(!0,!0,!0);this.logo.runLogoCommands()},this.afterSaveAbc=function(t){var e=encodeURIComponent(saveAbcOutput(this.logo));this.download("abc","data:text;utf8,"+e,t)},this.saveLilypond=function(t){void 0===t&&(t=void 0!==this.PlanetInterface?this.PlanetInterface.getCurrentProjectName():_("My Project")),"ly"!=fileExt(t)&&(t+=".ly"),console.log("Saving .ly file"),docById("lilypondModal").style.display="block",docById("fileNameText").textContent=_("File name"),docById("titleText").textContent=_("Project title"),docById("authorText").textContent=_("Project author"),docById("MIDIText").textContent=_("Include MIDI output?"),docById("guitarText").textContent=_("Include guitar tablature output?"),docById("submitLilypond").textContent=_("Save as Lilypond"),docById("fileName").value=t,void 0!==this.PlanetInterface?docById("title").value=this.PlanetInterface.getCurrentProjectName():docById("title").value=_("My Project");var e=this.storage.getItem("customAuthor");docById("author").value=null!=e?JSON.parse(e):_("Mr. Mouse"),docById("submitLilypond").onclick=function(){this.saveLYFile(!1)}.bind(this);var i=this;docByClass("close")[0].onclick=function(){i.logo.runningLilypond=!1,docById("lilypondModal").style.display="none"}},this.saveLYFile=function(t){void 0===t&&(t=!1);var e=docById("fileName").value,i=docById("title").value,s=docById("author").value;this.storage.setItem("customAuthor",JSON.stringify(s));var l=docById("MIDICheck").checked,o=docById("guitarCheck").checked;null!=e&&"ly"!==fileExt(e)&&(e+=".ly");var a={"My Music Blocks Creation":i,"Mr. Mouse":s},n=LILYPONDHEADER.replace(/My Music Blocks Creation|Mr. Mouse/gi,function(t){return a[t]});MIDIOutput=l?"% MIDI SECTION\n% MIDI Output included! \n\n\\midi {\n   \\tempo 4=90\n}\n\n\n}\n\n":"% MIDI SECTION\n% Delete the %{ and %} below to include MIDI output.\n%{\n\\midi {\n   \\tempo 4=90\n}\n%}\n\n}\n\n",guitarOutputEnd=o?(guitarOutputHead='\n\n% GUITAR TAB SECTION\n% Guitar tablature output included!\n\n      \\new TabStaff = "guitar tab" \n      <<\n         \\clef moderntab\n',"      >>\n\n"):(guitarOutputHead='\n\n% GUITAR TAB SECTION\n% Delete the %{ and %} below to include guitar tablature output.\n%{\n      \\new TabStaff = "guitar tab" \n      <<\n         \\clef moderntab\n',"      >>\n%}\n"),this.logo.runningLilypond=!0,this.notationConvert=t?"pdf":"",this.logo.notationOutput=n,this.logo.notationNotes={};for(var r=0;r<this.turtles.turtleList.length;r++)this.logo.notationStaging[r]=[],this.logo.notationDrumStaging[r]=[],this.turtles.turtleList[r].doClear(!0,!0,!0);document.body.style.cursor="wait",this.logo.runLogoCommands(),docById("lilypondModal").style.display="none"},this.afterSaveLilypond=function(t){var e=saveLilypondOutput(this.logo);switch(this.notationConvert){case"pdf":this.afterSaveLilypondPDF(e,t);break;default:this.afterSaveLilypondLY(e,t)}this.notationConvert=""},this.afterSaveLilypondLY=function(t,e){this.download("ly","data:text;utf8,"+encodeURIComponent(t),e)},this.afterSaveLilypondPDF=function(t,i){document.body.style.cursor="wait",window.Converter.ly2pdf(t,function(t,e){document.body.style.cursor="default",t?save.download("pdf",e,i):console.log("Error: "+e)})},this.init=function(){var t;this.timeLastSaved=-100,window.onbeforeunload=function(){if(void 0!==this.PlanetInterface&&this.PlanetInterface.getTimeLastSaved()!=this.timeLastSaved)return this.timeLastSaved=this.PlanetInterface.getTimeLastSaved(),unloadTimer2=null,t=window.requestAnimationFrame(function(){unloadTimer2=window.requestAnimationFrame(this.saveHTMLNoPrompt.bind(this),1e3)}.bind(this),500),_("Do you want to save your project?")}.bind(this),window.onunload=function(){cancelAnimationFrame(t),cancelAnimationFrame(unloadTimer2)}}}var ABCHEADER="X:1\nT:Music Blocks composition\nC:Mr. Mouse\nL:1/16\nM:C\n";function Activity(){_THIS_IS_MUSIC_BLOCKS_=!0,_THIS_IS_TURTLE_BLOCKS_=!_THIS_IS_MUSIC_BLOCKS_,_ERRORMSGTIMEOUT_=15e3,LEADING=0,cellSize=55,searchSuggestions=[],homeButtonContainers=[];var t,e,d=this;if(_findBlocks=this._findBlocks,_doFastButton=this._doFastButton,_doSlowButton=this._doSlowButton,doHardStopButton=this.doHardStopButton,_setupBlocksContainerEvents=this._setupBlocksContainerEvents,getCurrentKeyCode=this.getCurrentKeyCode,clearCurrentKeyCode=this.clearCurrentKeyCode,onStopTurtle=this.onStopTurtle,onRunTurtle=this.onRunTurtle,doSave=this.doSave,runProject=this.runProject,loadProject=this.loadProject,loadStartWrapper=this.loadStartWrapper,showContents=this.showContents,_loadStart=this._loadStart,_setupAndroidToolbar=this._setupAndroidToolbar,_loadButtonDragHandler=this._loadButtonDragHandler,_THIS_IS_TURTLE_BLOCKS_){try{t=document,e="facebook-jssdk",js,fjs=t.getElementsByTagName("script")[0],t.getElementById(e)||(js=t.createElement("script"),js.id=e,js.src="https://connect.facebook.net/en_US/sdk.js",fjs.parentNode.insertBefore(js,fjs))}catch(t){}}if(firstTimeUser=!1,_THIS_IS_MUSIC_BLOCKS_){beginnerMode=!0;try{void 0===localStorage.beginnerMode?(firstTimeUser=!0,console.log("FIRST TIME USER")):null!==localStorage.beginnerMode&&(beginnerMode=localStorage.beginnerMode,console.log("READING BEGINNERMODE FROM LOCAL STORAGE: "+beginnerMode+" "+("undefined"==typeof beginnerMode?"undefined":_typeof(beginnerMode))),"string"==typeof beginnerMode&&"false"===beginnerMode&&(beginnerMode=!1)),console.log("BEGINNERMODE is "+beginnerMode)}catch(t){console.log(t),console.log("ERROR READING BEGINNER MODE"),console.log("BEGINNERMODE is "+beginnerMode)}}else beginnerMode=!1;beginnerMode?console.log("BEGINNER MODE"):console.log("ADVANCED MODE");try{if(console.log("stored preference: "+localStorage.languagePreference),console.log("browser preference: "+navigator.language),void 0!==localStorage.languagePreference)try{lang=localStorage.languagePreference,document.webL10n.setLanguage(lang)}catch(t){console.log(t)}else lang=navigator.language,-1!==lang.indexOf("-")&&(lang=lang.slice(0,lang.indexOf("-")),document.webL10n.setLanguage(lang))}catch(t){console.log(t)}function f(){blocks.activeBlock=null,scrollBlockContainer=!scrollBlockContainer,scrollPaletteContainer=!scrollPaletteContainer;var t=docById("enableHorizScrollIcon"),e=docById("disableHorizScrollIcon");scrollBlockContainer&&!beginnerMode?(t.style.display="none",e.style.display="block"):(t.style.display="block",e.style.display="none")}MYDEFINES=["activity/sugarizer-compatibility","utils/platformstyle","easeljs.min","tweenjs.min","preloadjs.min","howler","p5.min","p5.sound.min","p5.dom.min","Chart","utils/utils","activity/artwork","widgets/status","widgets/help","utils/munsell","activity/toolbar","activity/trash","activity/boundary","activity/turtle","activity/palette","activity/protoblocks","activity/blocks","activity/block","activity/turtledefs","activity/logo","activity/languagebox","activity/basicblocks","activity/blockfactory","activity/rubrics","activity/macros","activity/SaveInterface","utils/musicutils","utils/synthutils","activity/pastebox","prefixfree.min"],_THIS_IS_MUSIC_BLOCKS_&&(MUSICBLOCKS_EXTRAS=["Tone","widgets/modewidget","widgets/meterwidget","widgets/pitchtimematrix","widgets/pitchdrummatrix","widgets/rhythmruler","widgets/pitchstaircase","widgets/temperament","widgets/tempo","widgets/pitchslider","widgets/musickeyboard","widgets/timbre","activity/lilypond","activity/abc"],MYDEFINES=MYDEFINES.concat(MUSICBLOCKS_EXTRAS)),this.setupDependencies=function(){createDefaultStack(),createHelpContent(),window.scroll(0,0),document.title=TITLESTRING,canvas=docById("myCanvas"),fileChooser=docById("myOpenFile"),pluginChooser=docById("myOpenPlugin"),allFilesChooser=docById("myOpenAll"),auxToolbar=docById("aux-toolbar"),server=!0,turtleBlocksScale=1,mousestage=null,stage=null,turtles=null,palettes=null,blocks=null,logo=null,pasteBox=null,languageBox=null,planet=null,window.converter=null,storage=null,buttonsVisible=!0,headerContainer=null,swiping=!1,menuButtonsVisible=!1,scrollBlockContainer=!1,scrollPaletteContainer=!1,currentKeyCode=0,pasteContainer=null,pasteImage=null,chartBitmap=null,merging=!1,loading=!1,smallerContainer=null,largerContainer=null,smallerOffContainer=null,largerOffContainer=null,resizeDebounce=!1,hideBlocksContainer=null,collapseBlocksContainer=null,searchWidget=docById("search"),searchWidget.style.visibility="hidden",progressBar=docById("myProgress"),progressBar.style.visibility="hidden",new createjs.DOMElement(docById("paste")),paste=docById("paste"),paste.style.visibility="hidden",closeContextWheel=function(){},toolbarHeight=document.getElementById("toolbars").offsetHeight},this.doContextMenus=function(){document.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()},!1)},this.doPluginsAndPaletteCols=function(){for(p in platformColor.paletteColors)PALETTEFILLCOLORS[p]=platformColor.paletteColors[p][0],PALETTESTROKECOLORS[p]=platformColor.paletteColors[p][1],PALETTEHIGHLIGHTCOLORS[p]=platformColor.paletteColors[p][2],HIGHLIGHTSTROKECOLORS[p]=platformColor.paletteColors[p][1];pluginObjs={PALETTEPLUGINS:{},PALETTEFILLCOLORS:{},PALETTESTROKECOLORS:{},PALETTEHIGHLIGHTCOLORS:{},FLOWPLUGINS:{},ARGPLUGINS:{},BLOCKPLUGINS:{},MACROPLUGINS:{},ONLOAD:{},ONSTART:{},ONSTOP:{}},macroDict={},cameraID=null;BLOCKSCALES=[1,1.5,2,3,4],blockscale=BLOCKSCALES.indexOf(DEFAULTBLOCKSCALE),-1===blockscale&&(blockscale=1),stageMouseDown=!1,stageX=0,stageY=0,onXO=1200===screen.width&&900===screen.height||900===screen.width&&1200===screen.height,cellSize=55,onXO&&(cellSize=75),onscreenButtons=[],onscreenMenu=[],firstRun=!0,pluginsImages={}},window.onblur=function(){d.doHardStopButton(!0)},this._findBlocks=function(){blocks.visible||_changeBlockVisibility();var t,e=Math.floor(canvas.width/4);blocks.activeBlock=null,hideDOMLabel(),logo.showBlocks(),blocksContainer.x=0,blocksContainer.y=0,t="block"===auxToolbar.style.display?90+toolbarHeight:90,palettes.updatePalettes();var i=Math.floor(e*turtleBlocksScale),s=Math.floor(t*turtleBlocksScale),l=!0;for(var o in blocks.blockList)if(!blocks.blockList[o].trash){if("start"!==(h=blocks.blockList[o]).name)continue;if(null==h.connections[0]){var a=i-h.container.x,n=s-h.container.y;if(blocks.moveBlockRelative(o,a,n),blocks.findDragGroup(o),0<blocks.dragGroup.length)for(var r=0;r<blocks.dragGroup.length;r++){var c=blocks.dragGroup[r];0!==r&&blocks.moveBlockRelative(c,a,n)}(i+=Math.floor(150*turtleBlocksScale))>7*canvas.width/8/turtleBlocksScale&&(i=(l=!l)?Math.floor(e):Math.floor(e+STANDARDBLOCKHEIGHT),s+=STANDARDBLOCKHEIGHT)}}for(var o in blocks.blockList)if(!blocks.blockList[o].trash){var h;if("start"===(h=blocks.blockList[o]).name)continue;if(null==h.connections[0]){a=i-h.container.x,n=s-h.container.y;if(blocks.moveBlockRelative(o,a,n),blocks.findDragGroup(o),0<blocks.dragGroup.length)for(r=0;r<blocks.dragGroup.length;r++){c=blocks.dragGroup[r];0!==r&&blocks.moveBlockRelative(c,a,n)}(i+=150*turtleBlocksScale)>7*canvas.width/8/turtleBlocksScale&&(i=(l=!l)?Math.floor(e):Math.floor(e+STANDARDBLOCKHEIGHT),s+=STANDARDBLOCKHEIGHT)}}setHomeContainers(!1,!0),boundary.hide()},setHomeContainers=function(t,e){null!==homeButtonContainers[0]&&(homeButtonContainers[0].visible=t,homeButtonContainers[1].visible=e)},__saveHelpBlock=function(o,t){setTimeout(function(){sendAllToTrash(!1,!0),setTimeout(function(){if(BLOCKHELP[o].length<4){console.log("CLICK: "+o);var t=blocks.palettes.getProtoNameAndPalette(o),e=t[0],i=t[1],s=t[2];blocks.protoBlockDict.hasOwnProperty(s)&&blocks.palettes.dict[i].makeBlockFromSearch(e,s,function(t){blocks.moveBlock(t,0,0)})}else if("string"==typeof BLOCKHELP[o][3]){var l=getMacroExpansion(BLOCKHELP[o][3],0,0);console.log("CLICK: "+l),blocks.loadNewBlocks(l)}else{l=BLOCKHELP[o][3];console.log("CLICK: "+l),blocks.loadNewBlocks(l)}setTimeout(function(){save.saveBlockArtwork(o+"_block.svg")},500)},500)},t+1e3)},_saveHelpBlocks=function(){var t=0;for(var e in BLOCKHELP)console.log(e),__saveHelpBlock(e,2e3*t),t+=1;sendAllToTrash(!0,!0)},_printBlockSVG=function(){blocks.activeBlock=null;for(var t=0,e="",i=0,s=0,l=0;l<blocks.blockList.length;l++)if(!blocks.blockList[l].ignore()){if(blocks.blockList[l].container.x+blocks.blockList[l].width>i&&(i=blocks.blockList[l].container.x+blocks.blockList[l].width),blocks.blockList[l].container.y+blocks.blockList[l].height>s&&(s=blocks.blockList[l].container.y+blocks.blockList[l].height),blocks.blockList[l].collapsed)var o=blocks.blockCollapseArt[l].split("><");else o=blocks.blockArt[l].split("><");if(blocks.blockList[l].isCollapsible()&&(e+="<g>"),e+='<g transform="translate('+blocks.blockList[l].container.x+", "+blocks.blockList[l].container.y+')">',-1!==SPECIALINPUTS.indexOf(blocks.blockList[l].name))for(var a=1;a<o.length;a++)1===a?e+="<"+o[a]+"><":2===a||(3===a?e+=o[a].replace("filter:url(#dropshadow);","")+"><":5===a?"string"==typeof blocks.blockList[l].value?(console.log(_(blocks.blockList[l].value)),e+=o[a]+">"+_(blocks.blockList[l].value)+"<"):e+=o[a]+">"+blocks.blockList[l].value+"<":a===o.length-2?e+=o[a]+">":a===o.length-1||(e+=o[a]+"><"));else for(a=1;a<o.length;a++)1===a?e+="<"+o[a]+"><":2===a||(3===a?e+=o[a].replace("filter:url(#dropshadow);","")+"><":a===o.length-2?e+=o[a]+">":a===o.length-1||(e+=o[a]+"><"));if(e+="</g>",blocks.blockList[l].isCollapsible()){if(-1!==INLINECOLLAPSIBLES.indexOf(blocks.blockList[l].name))var n=blocks.blockList[l].container.y+4;else n=blocks.blockList[l].container.y+12;if(e+='<g transform="translate('+blocks.blockList[l].container.x+", "+n+') scale(0.5 0.5)">',blocks.blockList[l].collapsed)o=EXPANDBUTTON.split("><");else o=COLLAPSEBUTTON.split("><");for(a=2;a<o.length-1;a++)e+="<"+o[a]+">";e+="</g>"}if("start"===blocks.blockList[l].name){e+='<g transform="translate('+(blocks.blockList[l].container.x+110)+", "+(n=blocks.blockList[l].container.y+12)+') scale(0.4 0.4)">';o=TURTLESVG.replace(/fill_color/g,FILLCOLORS[t]).replace(/stroke_color/g,STROKECOLORS[t]).split("><");9<(t+=1)&&(t=0);for(a=2;a<o.length-1;a++)e+="<"+o[a]+">";e+="</g>"}blocks.blockList[l].isCollapsible()&&(e+="</g>")}return e+="</svg>",'<svg xmlns="http://www.w3.org/2000/svg" width="'+i+'" height="'+s+'">'+encodeURIComponent(e)},_allClear=function(){blocks.activeBlock=null,hideDOMLabel(),null!=chartBitmap&&(stage.removeChild(chartBitmap),chartBitmap=null),logo.boxes={},logo.time=0,hideMsgs(),logo.setBackgroundColor(-1),logo.notationOutput="";for(var t=0;t<turtles.turtleList.length;t++)logo.turtleHeaps[t]=[],logo.notationStaging[t]=[],logo.notationDrumStaging[t]=[],turtles.turtleList[t].doClear(!0,!0,!0);blocksContainer.x=0,blocksContainer.y=0,Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var t=0,e=this.length;t<e;t++)this[t]&&this[t].parentElement&&this[t].parentElement.removeChild(this[t])};var e=docById("myTable");null!=e&&e.remove()},this._doFastButton=function(t){blocks.activeBlock=null,hideDOMLabel();var e=logo.turtleDelay,i=!1;if(logo.setTurtleDelay(0),_THIS_IS_MUSIC_BLOCKS_){if(logo.synth.resume(),"visible"===docById("ptmDiv").style.visibility&&(i=!0,logo.pitchTimeMatrix.playAll()),"visible"===docById("pscDiv").style.visibility&&(i=!0,logo.pitchStaircase.playUpAndDown()),"visible"===docById("rulerDiv").style.visibility&&("visible"===docById("tempoDiv").style.visibility&&(logo.tempo.isMoving&&logo.tempo.pause(),logo.tempo.resume()),i=!0,logo.rhythmRuler.playAll()),i)return;"visible"===docById("tempoDiv").style.visibility&&(logo.tempo.isMoving&&logo.tempo.pause(),logo.tempo.resume())}turtles.running()?0!==e?(console.log("RUNNING FROM STEP"),logo.step()):(console.log("STOPPING..."),document.getElementById("stop").style.color="white",logo.doStopTurtle(),setTimeout(function(){console.log("AND RUNNING"),document.getElementById("stop").style.color="#ea174c",logo.runLogoCommands(null,t)},500)):(console.log("RUNNING"),turtles.isShrunk||logo.hideBlocks(!0),logo.runLogoCommands(null,t))},this._doSlowButton=function(){blocks.activeBlock=null,hideDOMLabel(),logo.setTurtleDelay(DEFAULTDELAY),_THIS_IS_MUSIC_BLOCKS_&&logo.synth.resume(),_THIS_IS_MUSIC_BLOCKS_&&"visible"===docById("ptmDiv").style.visibility?logo.pitchTimeMatrix.playAll():turtles.running()?logo.step():logo.runLogoCommands()},_doStepButton=function(){blocks.activeBlock=null,hideDOMLabel();var t=Object.keys(logo.stepQueue).length;_THIS_IS_MUSIC_BLOCKS_&&logo.synth.resume(),0===t||logo.turtleDelay!==TURTLESTEP?(logo.setTurtleDelay(TURTLESTEP),turtles.running()||logo.runLogoCommands()):logo.setTurtleDelay(TURTLESTEP),logo.step()},this.doHardStopButton=function(t){blocks.activeBlock=null,hideDOMLabel(),null==t&&(t=!1),t&&_THIS_IS_MUSIC_BLOCKS_&&logo.recordingStatus()?console.log("Ignoring hard stop due to blur"):(logo.doStopTurtle(),_THIS_IS_MUSIC_BLOCKS_&&(logo._setMasterVolume(0),null!=docById("tempoDiv")&&"visible"===docById("tempoDiv").style.visibility&&logo.tempo.isMoving&&logo.tempo.pause()))},doSwitchMode=function(){blocks.activeBlock=null;var t=localStorage.beginnerMode;null===t||"true"===t?(textMsg(_("Refresh your browser to change to advanced mode.")),localStorage.setItem("beginnerMode",!1)):(textMsg(_("Refresh your browser to change to beginner mode.")),localStorage.setItem("beginnerMode",!0)),w()},doStopButton=function(){blocks.activeBlock=null,logo.doStopTurtle()},this.closeAnalytics=function(e,i){blocks.activeBlock=null;var s=this;s.x=canvas.width/(2*turtleBlocksScale)+300/Math.sqrt(2),s.y=200,this.closeButton=_makeButton(CANCELBUTTON,_("Close"),s.x,s.y,55,0),this.closeButton.on("click",function(t){s.closeButton.visible=!1,stage.removeChild(e),logo.showBlocks(),update=!0,i.clearRect(0,0,600,600)})},closeAnalytics=this.closeAnalytics;var s,l=this;function b(){}function m(t){var e=t.wheelDelta||-t.detail,i=Math.max(-1,Math.min(1,e));t.clientX<cellSize?(palettes.menuScrollEvent(i,30),palettes.hidePaletteIconCircles()):(palette=palettes.findPalette(t.clientX/turtleBlocksScale,t.clientY/turtleBlocksScale),palette&&(blocks.activeBlock=null,palette.scrollEvent(i,30)))}function g(){return turtleBlocksScale}function k(){return turtles.screenX2turtleX(stageX/turtleBlocksScale)}function v(){return turtles.screenY2turtleY((stageY-toolbarHeight)/turtleBlocksScale)}function y(){return stageMouseDown}function T(t){if(!docById("labelDiv").classList.contains("hasKeyboard")){if(_THIS_IS_MUSIC_BLOCKS_){if(docById("BPMInput").classList.contains("hasKeyboard"))return;if(docById("musicratio1").classList.contains("hasKeyboard"))return;if(docById("musicratio2").classList.contains("hasKeyboard"))return;if(docById("dissectNumber").classList.contains("hasKeyboard"))return;if(null!==docById("timbreName")&&docById("timbreName").classList.contains("hasKeyboard"))return}if(13===t.keyCode&&0<docById("search").value.length&&doSearch(),_THIS_IS_MUSIC_BLOCKS_)var e="block"===docById("lilypondModal").style.display||"visible"===searchWidget.style.visibility||""===docById("planet-iframe").style.display||"visible"===docById("paste").style.visibility||""===docById("wheelDiv").style.display||logo.turtles.running();else e="visible"===searchWidget.style.visibility||"visible"===docById("paste").style.visibility||logo.turtles.running();var i=_THIS_IS_MUSIC_BLOCKS_&&("visible"===docById("sliderDiv").style.visibility||"visible"===docById("tempoDiv").style.visibility);if(t.altKey&&!e)switch(t.keyCode){case 66:save.saveBlockArtwork();break;case 67:blocks.prepareStackForCopy();break;case 68:palettes.dict.myblocks.promptMacrosDelete();break;case 69:_allClear();break;case 80:break;case 82:this._doFastButton();break;case 83:logo.doStopTurtle();break;case 86:blocks.pasteStack();break;case 72:_saveHelpBlocks()}else if(t.ctrlKey)switch(t.keyCode){case 86:pasteBox.createBox(turtleBlocksScale,200,200),pasteBox.show(),docById("paste").style.left=(pasteBox.getPos()[0]+10)*turtleBlocksScale+"px",docById("paste").style.top=(pasteBox.getPos()[1]+10)*turtleBlocksScale+"px",docById("paste").focus(),docById("paste").style.visibility="visible",update=!0}else if(t.shiftKey&&!e)switch(t.keyCode){case 68:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(5,"do");break;case 82:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(5,"re");break;case 77:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(5,"mi");break;case 70:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(5,"fa");break;case 83:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(5,"sol");break;case 76:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(5,"la");break;case 84:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(5,"ti")}else{if("visible"===docById("paste").style.visibility&&13===t.keyCode)0<docById("paste").value.length&&pasted();else if(!e)switch(t.keyCode){case 35:blocksContainer.y=-blocks.bottomMostBlock()+logo.canvas.height/2;break;case 33:blocksContainer.y+=logo.canvas.height/2,stage.update();break;case 34:blocksContainer.y-=logo.canvas.height/2,stage.update();break;case 46:blocks.extract();break;case 38:i||(null!=blocks.activeBlock?(blocks.moveStackRelative(blocks.activeBlock,0,-STANDARDBLOCKHEIGHT/2),blocks.blockMoved(blocks.activeBlock),blocks.adjustDocks(blocks.activeBlock,!0)):palettes.mouseOver?(palettes.menuScrollEvent(1,10),palettes.hidePaletteIconCircles()):null!=palettes.activePalette?palettes.activePalette.scrollEvent(STANDARDBLOCKHEIGHT,1):scrollBlockContainer&&(blocksContainer.y-=20)),stage.update();break;case 40:i||(null!=blocks.activeBlock?(blocks.moveStackRelative(blocks.activeBlock,0,STANDARDBLOCKHEIGHT/2),blocks.blockMoved(blocks.activeBlock),blocks.adjustDocks(blocks.activeBlock,!0)):palettes.mouseOver?(palettes.menuScrollEvent(-1,10),palettes.hidePaletteIconCircles()):null!=palettes.activePalette?palettes.activePalette.scrollEvent(-STANDARDBLOCKHEIGHT,1):scrollBlockContainer&&(blocksContainer.y+=20)),stage.update();break;case 37:i||(null!=blocks.activeBlock?(blocks.moveStackRelative(blocks.activeBlock,-STANDARDBLOCKHEIGHT/2,0),blocks.blockMoved(blocks.activeBlock),blocks.adjustDocks(blocks.activeBlock,!0)):scrollBlockContainer&&(blocksContainer.x-=20)),stage.update();break;case 39:i||(null!=blocks.activeBlock?(blocks.moveStackRelative(blocks.activeBlock,STANDARDBLOCKHEIGHT/2,0),blocks.blockMoved(blocks.activeBlock),blocks.adjustDocks(blocks.activeBlock,!0)):scrollBlockContainer&&(blocksContainer.x+=20)),stage.update();break;case 36:if(palettes.mouseOver){var s=Math.max(55-palettes.buttons.rhythm.y,0);palettes.menuScrollEvent(1,s),palettes.hidePaletteIconCircles()}else null!=palettes.activePalette?palettes.activePalette.scrollEvent(-palettes.activePalette.scrollDiff,1):this._findBlocks();stage.update();break;case 9:break;case 32:1==turtleContainer.scaleX?turtles.scaleStage(.5):turtles.scaleStage(1);break;case 27:"visible"===searchWidget.style.visibility&&(searchWidget.style.visibility="hidden");break;case 13:i||(0<docById("search").value.length?doSearch():null!=blocks.activeBlock&&-1!==SPECIALINPUTS.indexOf(blocks.blockList[blocks.activeBlock].name)||logo.runLogoCommands());break;case 68:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(4,"do");break;case 82:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(4,"re");break;case 77:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(4,"mi");break;case 70:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(4,"fa");break;case 83:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(4,"sol");break;case 76:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(4,"la");break;case 84:_THIS_IS_MUSIC_BLOCKS_&&__makeNewNote(4,"ti")}currentKeyCode=t.keyCode}}}function L(t){var e=jQuery.noConflict();if(console.log("document.body.clientWidth and clientHeight: "+document.body.clientWidth+" "+document.body.clientHeight),console.log("stored values: "+this._clientWidth+" "+this._clientHeight),console.log("window inner/outer width/height: "+window.innerWidth+", "+window.innerHeight+" "+window.outerWidth+", "+window.outerHeight),platform.androidWebkit)i=window.outerWidth,s=window.outerHeight;else var i=window.innerWidth,s=window.innerHeight;if(t||(this._clientWidth,document.body.clientWidth),this._clientWidth=document.body.clientWidth,this._clientHeight=document.body.clientHeight,this._innerWidth=window.innerWidth,this._innerHeight=window.innerHeight,this._outerWidth=window.outerWidth,this._outerHeight=window.outerHeight,null!==largerContainer&&(homeButtonContainers[0].x=this._innerWidth-220-27.5,homeButtonContainers[1].x=homeButtonContainers[0].x,hideBlocksContainer.x=homeButtonContainers[0].x,collapseBlocksContainer.x=homeButtonContainers[0].x,smallerContainer.x=homeButtonContainers[0].x,largerContainer.x=homeButtonContainers[0].x,homeButtonContainers[0].y=this._innerHeight-27.5,homeButtonContainers[1].y=homeButtonContainers[0].y,hideBlocksContainer.y=homeButtonContainers[0].y,collapseBlocksContainer.y=homeButtonContainers[0].y,smallerContainer.y=homeButtonContainers[0].y,largerContainer.y=homeButtonContainers[0].y),!docById("labelDiv").classList.contains("hasKeyboard")){var l=Math.min(i,s);if(l<9*cellSize){var o=!1;i<10*cellSize?turtleBlocksScale=l/(11*cellSize):turtleBlocksScale=Math.max(l/(11*cellSize),.75)}else{o=!1;turtleBlocksScale=s/900<i/1200?i/1200:s/900}turtleBlocksScale=1,stage.scaleX=turtleBlocksScale,stage.scaleY=turtleBlocksScale,stage.canvas.width=i,stage.canvas.height=s,turtles.setScale(i,s,turtleBlocksScale),blocks.setScale(turtleBlocksScale),boundary.setScale(i,s,turtleBlocksScale),palettes.setScale(turtleBlocksScale),trashcan.resizeEvent(turtleBlocksScale),_setupPaletteMenu(turtleBlocksScale),cartesianBitmap.x=canvas.width/(2*turtleBlocksScale)-600,cartesianBitmap.y=canvas.height/(2*turtleBlocksScale)-450,polarBitmap.x=canvas.width/(2*turtleBlocksScale)-600,polarBitmap.y=canvas.height/(2*turtleBlocksScale)-450,update=!0,platform.mobile?toolbar.disableTooltips(e):(palettes.setMobile(!1),palettes.bringToTop());for(var a=0;a<turtles.turtleList.length;a++)turtles.turtleList[a].doClear(!1,!1,!0);var n=docById("overlayCanvas");o?(n.width=2*i,n.height=2*s):(n.width=i,n.height=s),blocks.checkBounds()}}function w(){update=!0}function B(){for(var t=[],e=0;e<blocks.blockList.length;e++){(s=blocks.blockList[e]).trash||t.push(e)}var i=[];for(e=0;e<blocks.blockList.length;e++){var s;if(!(s=blocks.blockList[e]).trash){if(s.isValueBlock()||"loadFile"===s.name||"boolean"===s.name)var l={value:s.value};else switch(s.name){case"start":case"drum":if(null==(r=turtles.turtleList[s.value]))l={collapsed:!1,xcor:0,ycor:0,heading:0,color:0,shade:50,pensize:5,grey:100};else l={collapsed:s.collapsed,xcor:r.x,ycor:r.y,heading:r.orientation,color:r.color,shade:r.value,pensize:r.stroke,grey:r.chroma,name:r.name};break;case"temperament1":if(blocks.customTemperamentDefined)l={customTemperamentNotes:TEMPERAMENT.custom,startingPitch:logo.synth.startingPitch,octaveSpace:OCTAVERATIO};break;case"interval":case"newnote":case"action":case"matrix":case"pitchdrummatrix":case"rhythmruler":case"timbre":case"pitchstaircase":case"tempo":case"pitchslider":case"musickeyboard":case"modewidget":case"meterwidget":case"status":l={collapsed:s.collapsed};break;case"namedbox":case"storein2":case"nameddo":case"nameddoArg":case"namedcalc":case"namedcalcArg":case"namedarg":l={value:s.privateData};break;case"nopValueBlock":case"nopZeroArgBlock":case"nopOneArgBlock":case"nopTwoArgBlock":case"nopThreeArgBlock":s.name=s.privateData;l={};break;case"matrixData":l={notes:window.savedMatricesNotes,count:window.savedMatricesCount};!0;break;default:l={}}connections=[];for(var o=0;o<s.connections.length;o++){var a=t.indexOf(s.connections[o]);null==s.connections[o]||-1===a?connections.push(null):connections.push(a)}i.push([t.indexOf(e),[s.name,l],s.container.x,s.container.y,connections])}}logo.runningLilypond&&(logo.playbackQueue={});var n=i.length;if(0<n)for(var r=0;r<turtles.turtleList.length;r++)if(r in logo.playbackQueue)for(var c=0;c<logo.playbackQueue[r].length;c++)i.push([n,r,logo.playbackQueue[r][c]]),n+=1;return JSON.stringify(i)}function o(t){return s.apply(this,arguments)}doAnalytics=function(){toolbar.closeAuxToolbar(_showHideAuxMenu),blocks.activeBlock=null,myChart=docById("myChart"),0!=function(t){var e=document.createElement("canvas");return e.width=t.width,e.height=t.height,t.toDataURL()==e.toDataURL()}(myChart)&&(ctx=myChart.getContext("2d"),loading=!0,document.body.style.cursor="wait",myRadarChart=null,scores=analyzeProject(blocks),data=scoreToChartData(scores),Analytics=this,Analytics.close=l.closeAnalytics,__callback=function(){imageData=myRadarChart.toBase64Image(),img=new Image,img.onload=function(){chartBitmap=new createjs.Bitmap(img),stage.addChild(chartBitmap),chartBitmap.x=canvas.width/(2*turtleBlocksScale)-300,chartBitmap.y=200,chartBitmap.scaleX=chartBitmap.scaleY=chartBitmap.scale=600/chartBitmap.image.width,logo.hideBlocks(),update=!0,document.body.style.cursor="default",loading=!1,Analytics.close(chartBitmap,ctx)},img.src=imageData},options=getChartOptions(__callback),myRadarChart=new Chart(ctx).Radar(data,options))},doLargerBlocks=function(){blocks.activeBlock=null,resizeDebounce||(blockscale<BLOCKSCALES.length-1&&(resizeDebounce=!0,blockscale+=1,blocks.setBlockScale(BLOCKSCALES[blockscale]),setTimeout(function(){resizeDebounce=!1},3e3)),setSmallerLargerStatus())},doSmallerBlocks=function(){blocks.activeBlock=null,resizeDebounce||(0<blockscale&&(resizeDebounce=!0,blockscale-=1,blocks.setBlockScale(BLOCKSCALES[blockscale])),setTimeout(function(){resizeDebounce=!1},3e3)),setSmallerLargerStatus()},setSmallerLargerStatus=function(){1<BLOCKSCALES[blockscale]?(smallerContainer.visible=!0,smallerOffContainer.visible=!1):(smallerOffContainer.visible=!0,smallerContainer.visible=!1),4==BLOCKSCALES[blockscale]?(largerOffContainer.visible=!0,largerContainer.visible=!1):(largerContainer.visible=!0,largerOffContainer.visible=!1)},deletePlugin=function(){toolbar.closeAuxToolbar(_showHideAuxMenu),(blocks.activeBlock=null)!==palettes.paletteObject?palettes.paletteObject.promptPaletteDelete():palettes.buttons.myblocks.visible&&(console.log(palettes.dict.myblocks.visible),palettes.dict.myblocks.visible&&palettes.dict.myblocks.promptMacrosDelete())},hideGrids=function(){turtles.setGridLabel(_("show Cartesian")),_hideCartesian(),_hidePolar()},_doCartesianPolar=function(){cartesianBitmap.visible&&polarBitmap.visible?(_hideCartesian(),turtles.setGridLabel(_("hide Polar"))):!cartesianBitmap.visible&&polarBitmap.visible?(_hidePolar(),turtles.setGridLabel(_("show Cartesian"))):cartesianBitmap.visible||polarBitmap.visible?cartesianBitmap.visible&&!polarBitmap.visible&&(_showPolar(),turtles.setGridLabel(_("hide Cartersian"))):(_showCartesian(),turtles.setGridLabel(_("show Polar"))),update=!0},this._setupBlocksContainerEvents=function(){var t,i=!1,s={x:0,y:0,delta:0},e=function(t){0!=t.deltaY&&t.axis===t.VERTICAL_AXIS&&(palettes.paletteVisible?t.clientX>cellSize+MENUWIDTH&&(palettesContainer.y-=t.deltaY):t.clientX>cellSize&&(palettesContainer.y-=t.deltaY)),scrollPaletteContainer?0!=t.deltaX&&t.axis===t.HORIZONTAL_AXIS&&(palettes.paletteVisible?t.clientX>cellSize+MENUWIDTH&&(palettesContainer.x-=t.deltaX):t.clientX>cellSize&&(palettesContainer.x-=t.deltaX)):t.preventDefault(),w()},l=docById("myCanvas");function o(){window.innerHeight<500?l.addEventListener("wheel",e,!1):l.removeEventListener("wheel",e)}o(),window.addEventListener("resize",function(){t=t||setTimeout(function(){t=null,o()},66)},!1);docById("myCanvas").addEventListener("wheel",function(t){0!=t.deltaY&&t.axis===t.VERTICAL_AXIS&&(palettes.paletteVisible?t.clientX>cellSize+MENUWIDTH&&(blocksContainer.y-=t.deltaY):t.clientX>cellSize&&(blocksContainer.y-=t.deltaY)),scrollBlockContainer?0!=t.deltaX&&t.axis===t.HORIZONTAL_AXIS&&(palettes.paletteVisible?t.clientX>cellSize+MENUWIDTH&&(blocksContainer.x-=t.deltaX):t.clientX>cellSize&&(blocksContainer.x-=t.deltaX)):t.preventDefault(),w()},!1);function a(t){stageMouseDown=!1,i=!1,null===stage.getObjectUnderPoint()&&s.delta<4&&(stageX=t.stageX,stageY=t.stageY)}stage.on("stagemousemove",function(t){stageX=t.stageX,stageY=t.stageY}),stage.on("stagemousedown",function(t){if(stageMouseDown=!0,null!==stage.getObjectUnderPoint()|turtles.running())return stage.removeAllEventListeners("stagemouseup"),void stage.on("stagemouseup",a);i=!0,s={x:t.stageX,y:t.stageY,delta:0},hideDOMLabel(),stage.removeAllEventListeners("stagemousemove"),stage.on("stagemousemove",function(t){if(stageX=t.stageX,stageY=t.stageY,i){blocks.activeBlock=null;var e=Math.abs(t.stageX-s.x)+Math.abs(t.stageY-s.y);scrollBlockContainer&&(blocksContainer.x+=t.stageX-s.x),blocksContainer.y+=t.stageY-s.y,s={x:t.stageX,y:t.stageY,delta:s.delta+e},w()}}),stage.removeAllEventListeners("stagemouseup"),stage.on("stagemouseup",a)})},_createGrid=function(t){var e=new Image;e.src=t;var i=new createjs.Container;stage.addChild(i);var s=new createjs.Bitmap(e);return i.addChild(s),s.cache(0,0,1200,900),s.x=(canvas.width-1200)/2,s.y=(canvas.height-900)/2,s.scaleX=s.scaleY=s.scale=1,s.visible=!1,s.updateCache(),s},_createMsgContainer=function(t,e,l,i){var o=new createjs.Container;stage.addChild(o),o.x=(canvas.width-1e3)/2,o.y=i,o.visible=!1;var a=new Image,s=MSGBLOCK.replace("fill_color",t).replace("stroke_color",e);a.onload=function(){var t=new createjs.Bitmap(a);o.addChild(t);var e=new createjs.Text("your message here","20px Arial","#000000");o.addChild(e),e.textAlign="center",e.textBaseline="alphabetic",e.x=500,e.y=30;var i=o.getBounds();o.cache(i.x,i.y,i.width,i.height);var s=new createjs.Shape;s.graphics.beginFill("#FFF").drawRect(0,0,1e3,42),s.x=0,s.y=0,o.hitArea=s,o.on("click",function(t){o.visible=!1,null!=errorMsgArrow&&errorMsgArrow.removeAllChildren(),update=!0}),l(e),blocks.setMsgText(e)},a.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(s)))},_createErrorContainers=function(){for(var t=0;t<ERRORARTWORK.length;t++){var e=ERRORARTWORK[t];_makeErrorArtwork(e)}},_makeErrorArtwork=function(t){var l=new createjs.Container;stage.addChild(l),l.x=(canvas.width-1e3)/2,l.y=110,errorArtwork[t]=l,errorArtwork[t].name=t,errorArtwork[t].visible=!1;var o=new Image;o.onload=function(){var t=new createjs.Bitmap(o);l.addChild(t);var e=new createjs.Text("","20px Sans","#000000");l.addChild(e),e.x=70,e.y=10;var i=l.getBounds();l.cache(i.x,i.y,i.width,i.height);var s=new createjs.Shape;s.graphics.beginFill("#FFF").drawRect(0,0,i.width,i.height),s.x=0,s.y=0,l.hitArea=s,l.on("click",function(t){l.visible=!1,null!=errorMsgArrow&&errorMsgArrow.removeAllChildren(),update=!0})},o.src="images/"+t+".svg"},prepSearchWidget=function(){for(i in searchWidget.style.visibility="hidden",searchBlockPosition=[100,100],searchSuggestions=[],deprecatedBlockNames=[],blocks.protoBlockDict)blockLabel=blocks.protoBlockDict[i].staticLabels[0],blockLabel&&(blocks.protoBlockDict[i].deprecated?deprecatedBlockNames.push(blockLabel):searchSuggestions.push(blockLabel));searchSuggestions=searchSuggestions.reverse()},hideSearchWidget=function(){var t=docByClass("ui-menu");0<t.length&&(t[0].style.visibility="hidden"),searchWidget.style.visibility="hidden"},showSearchWidget=function(){if("visible"===searchWidget.style.visibility)hideSearchWidget();else{var t=docByClass("ui-menu");0<t.length&&(t[0].style.visibility="visible"),searchWidget.value=null,docById("searchResults").style.visibility="visible",searchWidget.style.visibility="visible",searchWidget.style.left=palettes.getSearchPos()[0]*turtleBlocksScale+"px",searchWidget.style.top=palettes.getSearchPos()[1]*turtleBlocksScale+"px",searchBlockPosition=[100,100],setTimeout(function(){console.log("DO SEARCH!!!"),searchWidget.focus(),doSearch()},500)}},doSearch=function(){var t=jQuery.noConflict();t("#search").autocomplete({source:searchSuggestions}),t("#search").autocomplete("widget").addClass("scrollSearch");var e=searchWidget.value,i=palettes.getProtoNameAndPalette(e),s=i[0],l=i[1],o=i[2],a=blocks.protoBlockDict.hasOwnProperty(o);0<e.length&&(a?(palettes.dict[l].makeBlockFromSearch(s,o,function(t){blocks.moveBlock(t,100+searchBlockPosition[0]-blocksContainer.x,searchBlockPosition[1]-blocksContainer.y)}),searchBlockPosition[0]+=STANDARDBLOCKHEIGHT,searchBlockPosition[1]+=STANDARDBLOCKHEIGHT):-1<deprecatedBlockNames.indexOf(e)?blocks.errorMsg(_("This block is deprecated.")):blocks.errorMsg(_("Block cannot be found.")),searchWidget.value="",update=!0)},__makeNewNote=function(t,e){var i=[[0,"newnote",300-blocksContainer.x,300-blocksContainer.y,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:e}],0,0,[5]],[7,["number",{value:t}],0,0,[5]],[8,"hidden",0,0,[0,null]]];if(blocks.loadNewBlocks(i),null!==blocks.activeBlock){var s=blocks.findBottomBlock(blocks.activeBlock);if(console.log(blocks.activeBlock+" "+s),"hidden"===blocks.blockList[s].name&&"newnote"===blocks.blockList[blocks.blockList[s].connections[0]].name){var l=blocks.blockList.length-9,o=blocks.blockList[s].connections.length-1;blocks.blockList[s].connections[o]=l,blocks.blockList[l].connections[0]=s,blocks.adjustDocks(s,!0)}}blocks.activeBlock=blocks.blockList.length-1},this.getCurrentKeyCode=function(){return currentKeyCode},this.clearCurrentKeyCode=function(){currentKey="",currentKeyCode=0},window.onresize=function(){L(!1)},_restoreTrash=function(){for(var t in blocks.palettes.dict)blocks.palettes.dict[t].hideMenu(!0);blocks.activeBlock=null,w();var e=3*-cellSize;if(0!==blocks.trashStacks.length){var i=blocks.trashStacks.pop();blocks.findDragGroup(i);for(var s=0;s<blocks.dragGroup.length;s++){var l=blocks.dragGroup[s];blocks.blockList[l].trash=!1,blocks.moveBlockRelative(l,0,e),blocks.blockList[l].show()}if(blocks.raiseStackToTop(i),"start"===blocks.blockList[i].name||"drum"===blocks.blockList[i].name){var o=blocks.blockList[i].value;turtles.turtleList[o].trash=!1,turtles.turtleList[o].container.visible=!0}else if("action"===blocks.blockList[i].name){var a=blocks.blockList[blocks.blockList[i].connections[1]];if(null!=a){var n=a.value;blocks.blockList[i].trash=!0;var r=blocks.findUniqueActionName(n);if(blocks.blockList[i].trash=!1,r!==a){console.log("renaming action when restoring from trash. old name: "+n+" unique name: "+r),a.value=r,8<(c=a.value.toString()).length&&(c=c.substr(0,7)+"..."),a.text.text=c,null!=a.label&&(a.label.value=r),a.container.updateCache();for(s=0;s<blocks.dragGroup.length;s++){var c,h=blocks.blockList[blocks.dragGroup[s]];if(-1!==["nameddo","nameddoArg","namedcalc","namedcalcArg"].indexOf(h.name)&&h.privateData===n)console.log("reassigning nameddo to "+r),h.privateData=r,h.value=r,8<(c=h.value.toString()).length&&(c=c.substr(0,7)+"..."),h.text.text=c,h.overrideName=c,h.regenerateArtwork(),h.container.updateCache()}}a.value!==_("action")&&console.log("FIXME: Check for unique action name here")}}blocks.refreshCanvas()}else console.log("Trash is empty--nothing to do")},hideAuxMenu=function(){0<toolbarHeight&&(_showHideAuxMenu(!1),menuButtonsVisible=!1)},_afterDelete=function(){toolbar.closeAuxToolbar(_showHideAuxMenu),sendAllToTrash(!0,!1),void 0!==planet&&planet.initialiseNewProject.bind(planet)},sendAllToTrash=function(t,e){for(var i in blocksContainer.x=0,blocksContainer.y=0,blocks.palettes.dict)blocks.palettes.dict[i].hideMenu(!0);hideDOMLabel(),w();var s=0,l=3*cellSize;for(var o in blocks.blockList){if(null==blocks.blockList[o].connections[0]&&blocks.trashStacks.push(o),"start"===blocks.blockList[o].name||"drum"===blocks.blockList[o].name){console.log("start blk "+o+" value is "+blocks.blockList[o].value);var a=blocks.blockList[o].value;blocks.blockList[o].trash||null==a||(console.log("sending turtle "+a+" to trash"),turtles.turtleList[a].trash=!0,turtles.turtleList[a].container.visible=!1)}else"action"===blocks.blockList[o].name&&(blocks.blockList[o].trash||(blocks.deleteActionBlock(blocks.blockList[o]),s+=1));blocks.blockList[o].trash=!0,blocks.moveBlockRelative(o,0,l),blocks.blockList[o].hide()}t?(logo.playbackQueue={},blocks.loadNewBlocks(DATAOBJS)):e||saveLocally(),setTimeout(function(){stage.dispatchEvent("trashsignal")},100*s),update=!0},_changeBlockVisibility=function(){hideDOMLabel(),blocks.visible?(logo.hideBlocks(),palettes.hide(),hideBlocksContainer[1].visible=!0,hideBlocksContainer[0].visible=!1):(null!=chartBitmap&&(stage.removeChild(chartBitmap),chartBitmap=null),hideBlocksContainer[1].visible=!1,hideBlocksContainer[0].visible=!0,logo.showBlocks(),palettes.show(),palettes.bringToTop())},_toggleCollapsibleStacks=function(){hideDOMLabel(),blocks.visible&&blocks.toggleCollapsibles()},this.onStopTurtle=function(){},this.onRunTurtle=function(){},this.__tick=function(t){(update||createjs.Tween.hasActiveTweens())&&(update=!1,stage.update(t))},_doOpenSamples=function(){toolbar.closeAuxToolbar(_showHideAuxMenu),planet.openPlanet()},this.doSave=function(){toolbar.closeAuxToolbar(_showHideAuxMenu),beginnerMode&&save.saveHTML(_("My Project"))},doUploadToPlanet=function(){planet.openPlanet()},doLoad=function(t){console.log("DO LOAD "+t),toolbar.closeAuxToolbar(_showHideAuxMenu),void 0===t&&(t=!1),t?(console.log("MERGE LOAD"),merging=!0):(console.log("LOAD NEW"),merging=!1),console.log("Loading .tb file"),document.querySelector("#myOpenFile").focus(),document.querySelector("#myOpenFile").click(),window.scroll(0,0),d.doHardStopButton(),_allClear()},window.prepareExport=B,this.runProject=function(t){console.log("Running Project from Event"),document.removeEventListener("finishedLoading",this.runProject),setTimeout(function(){console.log("Run"),_changeBlockVisibility(),d._doFastButton(t)},5e3)},this.loadProject=function(t,e,i){console.log("LOAD PROJECT"),e=void 0!==e?e:{run:!1,show:!1,collapse:!1},loading=!0,document.body.style.cursor="wait",setTimeout(function(){try{planet.openProjectFromPlanet(t,function(){d.loadStartWrapper(d._loadStart)})}catch(t){console.log(t),console.log("that._loadStart on error"),d.loadStartWrapper(d._loadStart)}planet.initialiseNewProject(),loading=!1,document.body.style.cursor="default",update=!0},200);function s(){setTimeout(function(){if(!a&&firstRun&&_toggleCollapsibleStacks(),l&&firstRun){for(var t=0;t<turtles.turtleList.length;t++)turtles.turtleList[t].doClear(!0,!0,!1);d.runProject(i),o&&_changeBlockVisibility(),a||_toggleCollapsibleStacks()}else o||_changeBlockVisibility();document.removeEventListener("finishedLoading",s),firstRun=!1},1e3)}var l=e.run,o=e.show,a=e.collapse;document.addEventListener?document.addEventListener("finishedLoading",s,!1):document.attachEvent("finishedLoading",s)},this.loadStartWrapper=function(t,e,i,s){var l=new Date;t(e,i,s);var o=(new Date).getTime()-l.getTime(),a=Math.max(6e3-o);setTimeout(d.showContents,a)},this.showContents=function(){docById("loading-image-container").style.display="none",docById("hideContents").style.display="block"},this._loadStart=function(){if(console.log("LOAD START"),justLoadStart=function(){console.log("Loading start and a matrix"),logo.playbackQueue={},blocks.loadNewBlocks(DATAOBJS)},sessionData=null,planet)sessionData=planet.openCurrentProject();else{var t=storage.currentProject;sessionData=storage["SESSION"+t]}function e(){turtles.running()||setTimeout(function(){console.log("reset turtles "+turtles.turtleList.length);for(var t=0;t<turtles.turtleList.length;t++)logo.turtleHeaps[t]=[],logo.notationStaging[t]=[],logo.notationDrumStaging[t]=[],turtles.turtleList[t].doClear(!0,!0,!1)},1e3),document.removeEventListener("finishedLoading",e)}if(document.addEventListener?document.addEventListener("finishedLoading",e):document.attachEvent("finishedLoading",e),sessionData)try{if("undefined"===sessionData||"[]"===sessionData)console.log("empty session found: loading start"),justLoadStart();else{for(var i in console.log("restoring session: "+sessionData),blocks.palettes.dict)blocks.palettes.dict[i].hideMenu(!0);logo.playbackQueue={},blocks.loadNewBlocks(JSON.parse(sessionData))}}catch(t){console.log(t)}else justLoadStart();update=!0},hideMsgs=function(){for(var t in errorMsgText.parent.visible=!1,null!=errorMsgArrow&&(errorMsgArrow.removeAllChildren(),w()),msgText.parent.visible=!1,errorArtwork)errorArtwork[t].visible=!1;w()},textMsg=function(t){if(null!=msgText){var e=msgText.parent;e.visible=!0,msgText.text=t,e.updateCache(),stage.setChildIndex(e,stage.children.length-1),w()}},errorMsg=function(t,e,i,s){if(null!=errorMsgTimeoutID&&clearTimeout(errorMsgTimeoutID),_hideStopButton(),null!=errorMsgText){if(void 0!==e&&null!=e&&!blocks.blockList[e].collapsed){var l=(canvas.width-1e3)/2,o=blocks.blockList[e].container.x+blocksContainer.x,a=blocks.blockList[e].container.y+blocksContainer.y;null==errorMsgArrow&&(errorMsgArrow=new createjs.Container,stage.addChild(errorMsgArrow));var n=new createjs.Shape;errorMsgArrow.addChild(n),n.graphics.setStrokeStyle(4).beginStroke("#ff0031").moveTo(l,128).lineTo(o,a),stage.setChildIndex(errorMsgArrow,stage.children.length-1);var r=Math.atan2(o-l,128-a)/Math.PI*180,c=new createjs.Shape;errorMsgArrow.addChild(c),c.graphics.setStrokeStyle(4).beginStroke("#ff0031").moveTo(-10,18).lineTo(0,0).lineTo(10,18),c.x=o,c.y=a,c.rotation=r}switch(t){case NOMICERRORMSG:errorArtwork.nomicrophone.visible=!0,stage.setChildIndex(errorArtwork.nomicrophone,stage.children.length-1);break;case NOSTRINGERRORMSG:errorArtwork.notastring.visible=!0,stage.setChildIndex(errorArtwork.notastring,stage.children.length-1);break;case EMPTYHEAPERRORMSG:errorArtwork.emptyheap.visible=!0,stage.setChildIndex(errorArtwork.emptyheap,stage.children.length-1);break;case NOSQRTERRORMSG:errorArtwork.negroot.visible=!0,stage.setChildIndex(errorArtwork.negroot,stage.children.length-1);break;case NOACTIONERRORMSG:null==i&&(i="foo"),errorArtwork.nostack.children[1].text=i,errorArtwork.nostack.visible=!0,errorArtwork.nostack.updateCache(),stage.setChildIndex(errorArtwork.nostack,stage.children.length-1);break;case NOBOXERRORMSG:null==i&&(i="foo"),errorArtwork.emptybox.children[1].text=i,errorArtwork.emptybox.visible=!0,errorArtwork.emptybox.updateCache(),stage.setChildIndex(errorArtwork.emptybox,stage.children.length-1);break;case ZERODIVIDEERRORMSG:errorArtwork.zerodivide.visible=!0,stage.setChildIndex(errorArtwork.zerodivide,stage.children.length-1);break;case NANERRORMSG:errorArtwork.notanumber.visible=!0,stage.setChildIndex(errorArtwork.notanumber,stage.children.length-1);break;case NOINPUTERRORMSG:errorArtwork.noinput.visible=!0,stage.setChildIndex(errorArtwork.noinput,stage.children.length-1);break;default:var h=errorMsgText.parent;h.visible=!0,errorMsgText.text=t,stage.setChildIndex(h,stage.children.length-1),h.updateCache()}if(null!=s)var u=s;else u=_ERRORMSGTIMEOUT_;0<u&&(errorMsgTimeoutID=setTimeout(function(){hideMsgs()},u)),w()}},_hideCartesian=function(){cartesianBitmap.visible=!1,cartesianBitmap.updateCache(),update=!0},_showCartesian=function(){cartesianBitmap.visible=!0,cartesianBitmap.updateCache(),update=!0},_hidePolar=function(){polarBitmap.visible=!1,polarBitmap.updateCache(),update=!0},_showPolar=function(){polarBitmap.visible=!0,polarBitmap.updateCache(),update=!0},doOpenPlugin=function(){toolbar.closeAuxToolbar(_showHideAuxMenu),pluginChooser.focus(),pluginChooser.click()},_hideStopButton=function(){},_showStopButton=function(){},_doMergeLoad=function(){doLoad(!0)},_setupPaletteMenu=function(t){0!==homeButtonContainers.length&&(stage.removeChild(homeButtonContainers[0]),stage.removeChild(homeButtonContainers[1]),stage.removeChild(hideBlocksContainer[0]),stage.removeChild(hideBlocksContainer[1]),stage.removeChild(collapseBlocksContainer),stage.removeChild(smallerContainer),stage.removeChild(smallerOffContainer),stage.removeChild(largerContainer),stage.removeChild(largerOffContainer));var e=cellSize,i=this._innerWidth-4*e-27.5,s=this._innerHeight-27.5,l=e;homeButtonContainers=[],homeButtonContainers.push(_makeButton(GOHOMEBUTTON,_("Home")+" ["+_("Home").toUpperCase()+"]",i,s,e,0)),d._loadButtonDragHandler(homeButtonContainers[0],i,s,d._findBlocks,null,null,null,null),homeButtonContainers.push(_makeButton(GOHOMEFADEDBUTTON,_("Home")+" ["+_("Home").toUpperCase()+"]",i,s-e,e,0)),d._loadButtonDragHandler(homeButtonContainers[1],i,s,d._findBlocks,null,null,null,null),homeButtonContainers[1].visible=!1,homeButtonContainers[0].y=this._innerHeight-27.5,homeButtonContainers[1].y=this._innerHeight-27.5,boundary.hide(),i+=l,hideBlocksContainer=[],hideBlocksContainer.push(_makeButton(HIDEBLOCKSBUTTON,_("Show/hide block"),i,s,e,0)),d._loadButtonDragHandler(hideBlocksContainer[0],i,s,_changeBlockVisibility,null,null,null,null),hideBlocksContainer.push(_makeButton(HIDEBLOCKSFADEDBUTTON,_("Show/hide block"),i,s-e,e,0)),d._loadButtonDragHandler(hideBlocksContainer[1],i,s,_changeBlockVisibility,null,null,null,null),hideBlocksContainer[1].visible=!1,hideBlocksContainer[0].y=this._innerHeight-27.5,hideBlocksContainer[1].y=this._innerHeight-27.5,i+=l,collapseBlocksContainer=_makeButton(COLLAPSEBLOCKSBUTTON,_("Expand/collapse blocks"),i,s,e,0),d._loadButtonDragHandler(collapseBlocksContainer,i,s,_toggleCollapsibleStacks,null,null,null,null),i+=l,smallerContainer=_makeButton(SMALLERBUTTON,_("Decrease block size"),i,s,e,0),d._loadButtonDragHandler(smallerContainer,i,s,doSmallerBlocks,null,null,null,null),smallerOffContainer=_makeButton(SMALLERDISABLEBUTTON,_("Cannot be further decreased"),i,s,e,0),smallerOffContainer.visible=!1,i+=l,largerContainer=_makeButton(BIGGERBUTTON,_("Increase block size"),i,s,e,0),d._loadButtonDragHandler(largerContainer,i,s,doLargerBlocks,null,null,null,null),largerOffContainer=_makeButton(BIGGERDISABLEBUTTON,_("Cannot be further increased"),i,s,e,0),largerOffContainer.visible=!1},_showHelp=function(){(new HelpWidget).init(null)},_showAboutPage=function(){var t=new HelpWidget;t.init(null),t.showPageByName(_("About"))},_doMenuButton=function(){_doMenuAnimation(!0)},_doMenuAnimation=(s=function(t){if(void 0===t)var e=!0;else e=t;if(e)var i=500;else i=50;var s=last(menuContainer.children);if(null!=s)if(e){var l=s.rotation;if(l%95.5!=0)return;createjs.Tween.get(s).to({rotation:l}).to({rotation:l+95.5},500)}else s.rotation+=95.5;else setTimeout(_doMenuAnimation,50);setTimeout(function(){menuButtonsVisible?menuButtonsVisible=!1:(menuButtonsVisible=!0,_THIS_IS_MUSIC_BLOCKS_?beginnerMode?advancedModeContainer.visible=!1:(beginnerModeContainer.visible=!0,d.setScrollerButton()):d.setScrollerButton()),update=!0},i)},o.toString=function(){return s.toString()},o),_toggleToolbar=function(){for(var t in buttonsVisible=!buttonsVisible,menuContainer.visible=buttonsVisible,headerContainer.visible=buttonsVisible,onscreenButtons)onscreenButtons[t].visible=buttonsVisible;for(var t in onscreenMenu)onscreenMenu[t].visible=buttonsVisible;buttonsVisible&&(_THIS_IS_MUSIC_BLOCKS_?beginnerMode?advancedModeContainer.visible=!1:(beginnerModeContainer.visible=!0,d.setScrollerButton()):d.setScrollerButton()),update=!0},_makeButton=function(t,e,i,s,o,l,a){var n=new createjs.Container;null==a?stage.addChild(n):a.addChild(n),n.x=i,n.y=s;var r,c=new createjs.Text(e,"14px Sans","#282828");n.x<55?(c.textAlign="left",c.x=-14):255<n.x?(c.textAlign="right",c.x=14):(c.textAlign="center",c.x=0),c.y=255<s?-60:30,c.visible=!1,n.on("mouseover",function(t){for(var e=0;e<n.children.length;e++)if(null!=n.children[e].text){if(n.children[e].visible=!0,-1!==[2,5,8].indexOf(n.children.length)){var i=n.children[e].getBounds(),s=new createjs.Shape;"center"===n.children[e].textAlign?s.graphics.beginFill("#FFF").drawRoundRect(i.x-8,n.children[e].y-2,i.width+16,i.height+8,10,10,10,10):"left"===n.children[e].textAlign?s.graphics.beginFill("#FFF").drawRoundRect(i.x-22,n.children[e].y-2,i.width+16,i.height+8,10,10,10,10):s.graphics.beginFill("#FFF").drawRoundRect(i.x+8,n.children[e].y-2,i.width+16,i.height+8,10,10,10,10),n.addChildAt(s,0)}n.children[0].visible=!0,stage.update();break}var l=o/2;r=showButtonHighlight(n.x,n.y,l,t,palettes.scale,stage)}),n.on("mouseout",function(t){hideButtonHighlight(r,stage);for(var e=0;e<n.children.length;e++)if(null!=n.children[e].text){n.children[e].visible=!1,n.children[0].visible=!1,stage.update();break}});var h=new Image;return h.onload=function(){var t=Math.floor(o/2),e=new createjs.Bitmap(h);55!==o&&(e.scaleX=o/55,e.scaleY=o/55),e.regX=t/e.scaleX,e.regY=t/e.scaleY,void 0!==l&&(e.rotation=l),n.addChild(e);var i=new createjs.Shape;i.graphics.beginFill("#FFF").drawEllipse(-t,-t,o,o),i.x=0,i.y=0,n.hitArea=i,e.cache(0,0,o,o),e.updateCache(),update=!0},h.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t))),n.addChild(c),n},this._loadButtonDragHandler=function(i,s,l,o,e){var a=!1,n=null;i.on("mouseover",function(t){loading||(document.body.style.cursor="pointer"),null!==e&&(a||(a=!0,setTimeout(function(){a=!1,clearTimeout(n)},2e3),n=setTimeout(function(){!0,console.log("HOVER ACTION"),e(!1)},1500)))}),i.on("mouseout",function(t){loading||(document.body.style.cursor="default"),null!==n&&clearTimeout(n)}),i.removeAllEventListeners("mousedown"),i.on("mousedown",function(t){var e=showButtonHighlight(s,l,cellSize/2,t,turtleBlocksScale,stage);i.removeAllEventListeners("pressup");i.on("pressup",function(t){hideButtonHighlight(e,stage),o(),mousedown=!1});!1})},pasted=function(){var t=docById("paste").value;if(null!=t&&""!=t){var e=t.replace("\n"," ");try{var i=JSON.parse(e)}catch(t){return void errorMsg(_("Could not parse JSON input."))}for(var s in blocks.palettes.dict)blocks.palettes.dict[s].hideMenu(!0);w(),blocks.loadNewBlocks(i),pasteBox.hide()}},deltaY=function(t){toolbarHeight+=t;for(var e=0;e<onscreenButtons.length;e++)onscreenButtons[e].y+=t;homeButtonContainers[0].y=this._innerHeight-27.5,homeButtonContainers[1].y=homeButtonContainers[0].y,hideBlocksContainer.y=homeButtonContainers[0].y,collapseBlocksContainer.y=homeButtonContainers[0].y,smallerContainer.y=homeButtonContainers[0].y,largerContainer.y=homeButtonContainers[0].y;for(e=0;e<onscreenMenu.length;e++)onscreenMenu[e].y+=t;palettes.deltaY(t),turtles.deltaY(t),blocksContainer.y+=t,w()},_openAuxMenu=function(){turtles.running()||0!==toolbarHeight||_showHideAuxMenu(!1)},_showHideAuxMenu=function(t){if(t||0!==toolbarHeight){var e=toolbarHeight;toolbarHeight=0,homeButtonContainers[0].y=this._innerHeight-27.5,homeButtonContainers[1].y=homeButtonContainers[0].y,hideBlocksContainer.y=homeButtonContainers[0].y,collapseBlocksContainer.y=homeButtonContainers[0].y,smallerContainer.y=homeButtonContainers[0].y,largerContainer.y=homeButtonContainers[0].y,palettes.deltaY(-e),turtles.deltaY(-e),blocksContainer.y-=e}else e=55+LEADING+5,toolbarHeight=e,homeButtonContainers[0].y=this._innerHeight-27.5,homeButtonContainers[1].y=homeButtonContainers[0].y,hideBlocksContainer.y=homeButtonContainers[0].y,collapseBlocksContainer.y=homeButtonContainers[0].y,smallerContainer.y=homeButtonContainers[0].y,largerContainer.y=homeButtonContainers[0].y,palettes.deltaY(e),turtles.deltaY(e),blocksContainer.y+=e,blocks.checkBounds();w()},this.domReady=function(t){saveLocally=void 0,update=!0,cartesianBitmap=null,polarBitmap=null,msgText=null,errorMsgText=null,errorMsgArrow=null,errorMsgTimeoutID=null,errorArtwork={},ERRORARTWORK=["emptybox","emptyheap","negroot","noinput","zerodivide","notanumber","nostack","notastring","nomicrophone"],this.init()},this.init=function(){console.log("document.body.clientWidth and clientHeight: "+document.body.clientWidth+" "+document.body.clientHeight),this._clientWidth=document.body.clientWidth,this._clientHeight=document.body.clientHeight,this._innerWidth=window.innerWidth,this._innerHeight=window.innerHeight,this._outerWidth=window.outerWidth,this._outerHeight=window.outerHeight,console.log("window inner/outer width/height: "+this._innerWidth+", "+this._innerHeight+" "+this._outerWidth+", "+this._outerHeight),sugarizerCompatibility.isInsideSugarizer()?storage=sugarizerCompatibility.data:storage=localStorage,docById("loader").className="loader",stage=new createjs.Stage(canvas),createjs.Touch.enable(stage),createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED,createjs.Ticker.framerate=30,createjs.Ticker.addEventListener("tick",d.__tick),_createMsgContainer("#ffffff","#7a7a7a",function(t){msgText=t},130),_createMsgContainer("#ffcbc4","#ff0031",function(t){errorMsgText=t},130),_createErrorContainers(),palettesContainer=new createjs.Container,blocksContainer=new createjs.Container,trashContainer=new createjs.Container,turtleContainer=new createjs.Container,stage.addChild(turtleContainer),stage.addChild(trashContainer,blocksContainer,palettesContainer),d._setupBlocksContainerEvents(),trashcan=new Trashcan,trashcan.setCanvas(canvas).setStage(trashContainer).setSize(cellSize).setRefreshCanvas(w).init(),turtles=new Turtles,turtles.setCanvas(canvas).setClear(_allClear).setHideMenu(hideAuxMenu).setMasterStage(stage).setStage(turtleContainer).setHideGrids(hideGrids).setDoGrid(_doCartesianPolar).setRefreshCanvas(w),boundary=new Boundary,boundary.setStage(blocksContainer).init(),blocks=new Blocks,blocks.setCanvas(canvas).setStage(blocksContainer).setRefreshCanvas(w).setTrashcan(trashcan).setUpdateStage(stage.update).setGetStageScale(g).setTurtles(turtles).setSetPlaybackStatus(b).setErrorMsg(errorMsg).setHomeContainers(setHomeContainers,boundary),turtles.setBlocks(blocks),palettes=new Palettes,palettes.setCanvas(canvas).setStage(palettesContainer).setRefreshCanvas(w).setSize(cellSize).setTrashcan(trashcan).setSearch(showSearchWidget,hideSearchWidget).setBlocks(blocks).init(),initPalettes(palettes),logo=new Logo,logo.setCanvas(canvas).setBlocks(blocks).setTurtles(turtles).setStage(turtleContainer).setRefreshCanvas(w).setTextMsg(textMsg).setErrorMsg(errorMsg).setHideMsgs(hideMsgs).setOnStopTurtle(d.onStopTurtle).setOnRunTurtle(d.onRunTurtle).setGetStageX(k).setGetStageY(v).setGetStageMouseDown(y).setGetCurrentKeyCode(d.getCurrentKeyCode).setClearCurrentKeyCode(d.clearCurrentKeyCode).setSetPlaybackStatus(b),blocks.setLogo(logo),pasteBox=new PasteBox,pasteBox.setCanvas(canvas).setStage(stage).setRefreshCanvas(w).setPaste(paste),languageBox=new LanguageBox,languageBox.setMessage(textMsg),firstTimeUser&&_showHelp(),playbackOnLoad=function(){};try{planet=new function(t){this.planet=null,this.iframe=null,this.mainCanvas=null,this.hideMusicBlocks=function(){hideSearchWidget(),_THIS_IS_MUSIC_BLOCKS_&&(t.setItem("isMatrixHidden",docById("ptmDiv").style.visibility),t.setItem("isStaircaseHidden",docById("pscDiv").style.visibility),t.setItem("isTimbreHidden",docById("timbreDiv").style.visibility),t.setItem("isPitchDrumMatrixHidden",docById("pdmDiv").style.visibility),t.setItem("isMusicKeyboardHidden",docById("mkbDiv").style.visibility),t.setItem("isRhythmRulerHidden",docById("rulerDiv").style.visibility),t.setItem("isModeWidgetHidden",docById("modeDiv").style.visibility),t.setItem("isMeterWidgetHidden",docById("meterDiv").style.visibility),t.setItem("isSliderHidden",docById("sliderDiv").style.visibility),t.setItem("isTemperamentHidden",docById("temperamentDiv").style.visibility),t.setItem("isTempoHidden",docById("tempoDiv").style.visibility),"hidden"!==docById("ptmDiv").style.visibility&&(docById("ptmDiv").style.visibility="hidden",docById("ptmTableDiv").style.visibility="hidden",docById("ptmButtonsDiv").style.visibility="hidden"),"hidden"!==docById("pdmDiv").style.visibility&&(docById("pdmDiv").style.visibility="hidden",docById("pdmButtonsDiv").style.visibility="hidden",docById("pdmTableDiv").style.visibility="hidden"),"hidden"!==docById("mkbDiv").style.visibility&&(docById("mkbDiv").style.visibility="hidden",docById("mkbButtonsDiv").style.visibility="hidden",docById("mkbTableDiv").style.visibility="hidden"),"hidden"!==docById("rulerDiv").style.visibility&&(docById("rulerDiv").style.visibility="hidden",docById("rulerTableDiv").style.visibility="hidden",docById("rulerButtonsDiv").style.visibility="hidden"),"hidden"!==docById("pscDiv").style.visibility&&(docById("pscDiv").style.visibility="hidden",docById("pscTableDiv").style.visibility="hidden",docById("pscButtonsDiv").style.visibility="hidden"),"hidden"!==docById("timbreDiv").style.visibility&&(docById("timbreDiv").style.visibility="hidden",docById("timbreTableDiv").style.visibility="hidden",docById("timbreButtonsDiv").style.visibility="hidden"),"hidden"!==docById("temperamentDiv").style.visibility&&(docById("temperamentDiv").style.visibility="hidden",docById("temperamentTableDiv").style.visibility="hidden",docById("temperamentButtonsDiv").style.visibility="hidden"),"hidden"!==docById("statusDiv").style.visibility&&(docById("statusDiv").style.visibility="hidden",docById("statusButtonsDiv").style.visibility="hidden",docById("statusTableDiv").style.visibility="hidden"),"hidden"!==docById("sliderDiv").style.visibility&&(docById("sliderDiv").style.visibility="hidden",docById("sliderButtonsDiv").style.visibility="hidden",docById("sliderTableDiv").style.visibility="hidden"),"hidden"!==docById("modeDiv").style.visibility&&(docById("modeDiv").style.visibility="hidden",docById("modeButtonsDiv").style.visibility="hidden",docById("modeTableDiv").style.visibility="hidden"),"hidden"!==docById("tempoDiv").style.visibility&&null!=logo.tempo&&logo.tempo.hide()),t.setItem("isStatusHidden",docById("statusDiv").style.visibility),logo.doStopTurtle(),docById("helpElem").style.visibility="hidden",document.querySelector(".canvasHolder").classList.add("hide"),document.querySelector("#canvas").style.display="none",document.querySelector("#theme-color").content="#8bc34a",setTimeout(function(){stage.enableDOMEvents(!1)},250),window.scroll(0,0)},this.showMusicBlocks=function(){document.getElementById("toolbars").style.display="block",docById("statusDiv").style.visibility=t.getItem("isStatusHidden"),docById("statusButtonsDiv").style.visibility=t.getItem("isStatusHidden"),docById("statusTableDiv").style.visibility=t.getItem("isStatusHidden"),_THIS_IS_MUSIC_BLOCKS_&&(docById("ptmDiv").style.visibility=t.getItem("isMatrixHidden"),docById("ptmButtonsDiv").style.visibility=t.getItem("isMatrixHidden"),docById("ptmTableDiv").style.visibility=t.getItem("isMatrixHidden"),docById("pscDiv").style.visibility=t.getItem("isStaircaseHidden"),docById("pscButtonsDiv").style.visibility=t.getItem("isStaircaseHidden"),docById("pscTableDiv").style.visibility=t.getItem("isStaircaseHidden"),docById("timbreDiv").style.visibility=t.getItem("isTimbreHidden"),docById("timbreButtonsDiv").style.visibility=t.getItem("isTimbreHidden"),docById("timbreTableDiv").style.visibility=t.getItem("isTimbreHidden"),docById("temperamentDiv").style.visibility=t.getItem("isTemperamentHidden"),docById("temperamentButtonsDiv").style.visibility=t.getItem("isTemperamentHidden"),docById("temperamentTableDiv").style.visibility=t.getItem("isTemperamentHidden"),docById("sliderDiv").style.visibility=t.getItem("isSliderHidden"),docById("sliderButtonsDiv").style.visibility=t.getItem("isSliderHidden"),docById("sliderTableDiv").style.visibility=t.getItem("isSliderHidden"),docById("pdmDiv").style.visibility=t.getItem("isPitchDrumMatrixHidden"),docById("pdmButtonsDiv").style.visibility=t.getItem("isPitchDrumMatrixHidden"),docById("pdmTableDiv").style.visibility=t.getItem("isPitchDrumMatrixHidden"),docById("mkbDiv").style.visibility=t.getItem("isMusicKeyboardHidden"),docById("mkbButtonsDiv").style.visibility=t.getItem("isMusicKeyboardHidden"),docById("mkbTableDiv").style.visibility=t.getItem("isMusicKeyboardHidden"),docById("rulerDiv").style.visibility=t.getItem("isRhythmRulerHidden"),docById("rulerButtonsDiv").style.visibility=t.getItem("isRhythmRulerHidden"),docById("rulerTableDiv").style.visibility=t.getItem("isRhythmRulerHidden"),docById("modeDiv").style.visibility=t.getItem("isModeWidgetHidden"),docById("modeButtonsDiv").style.visibility=t.getItem("isModeWidgetHidden"),docById("modeTableDiv").style.visibility=t.getItem("isModeWidgetHidden"),docById("meterDiv").style.visibility=t.getItem("isMeterWidgetHidden"),docById("meterButtonsDiv").style.visibility=t.getItem("isMeterWidgetHidden"),docById("meterTableDiv").style.visibility=t.getItem("isMeterWidgetHidden")),document.querySelector(".canvasHolder").classList.remove("hide"),document.querySelector("#canvas").style.display="",document.querySelector("#theme-color").content=platformColor.header,stage.enableDOMEvents(!0),window.scroll(0,0)},this.showPlanet=function(){this.planet.open(this.mainCanvas.toDataURL("image/png")),this.iframe.style.display="block";try{this.iframe.contentWindow.document.getElementById("local-tab").click()}catch(t){console.log(t)}},this.hidePlanet=function(){this.iframe.style.display="none"},this.openPlanet=function(){console.log("SAVE LOCALLY"),this.saveLocally(),this.hideMusicBlocks(),this.showPlanet()},this.closePlanet=function(){this.hidePlanet(),this.showMusicBlocks()},this.loadProjectFromData=function(t,e){if(void 0===e&&(e=!1),this.closePlanet(),e||sendAllToTrash(!1,!0),null==t)return console.log("loadRawProject: data is undefined... punting"),void errorMsg(_("project undefined"));for(var i in console.log("loadRawProject "+t),loading=!0,document.body.style.cursor="wait",_allClear(),blocks.palettes.dict)blocks.palettes.dict[i].hideMenu(!0);function s(){document.removeEventListener("finishedLoading",s)}document.addEventListener?document.addEventListener("finishedLoading",s):document.attachEvent("finishedLoading",s);try{var l=JSON.parse(t);logo.playbackQueue={},blocks.loadNewBlocks(l)}catch(t){console.log("loadRawProject: could not parse project data"),errorMsg(t)}loading=!1,document.body.style.cursor="default"},this.loadProjectFromFile=function(){document.querySelector("#myOpenFile").focus(),document.querySelector("#myOpenFile").click(),window.scroll(0,0)},this.newProject=function(){console.log("NEW"),this.closePlanet(),this.initialiseNewProject(),d._loadStart(),this.saveLocally()},this.initialiseNewProject=function(t){this.planet.ProjectStorage.initialiseNewProject(t),sendAllToTrash(),w(),blocks.trashStacks=[]},this.saveLocally=function(){console.log("overwriting session data");var i=B(),t=doSVG(canvas,logo,turtles,320,240,320/canvas.width);if(null===t||""===t)this.planet.ProjectStorage.saveLocally(i,null);else{var s=new Image,l=this;s.onload=function(){var t=new createjs.Bitmap(s),e=t.getBounds();t.cache(e.x,e.y,e.width,e.height);try{l.planet.ProjectStorage.saveLocally(i,t.bitmapCache.getCacheDataURL())}catch(t){console.log(t)}},s.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t)))}},this.openCurrentProject=function(){return this.planet.ProjectStorage.getCurrentProjectData()},this.openProjectFromPlanet=function(t,e){this.planet.openProjectFromPlanet(t,e)},this.onConverterLoad=function(){window.Converter=this.planet.Converter},this.getCurrentProjectName=function(){return this.planet.ProjectStorage.getCurrentProjectName()},this.getCurrentProjectDescription=function(){return this.planet.ProjectStorage.getCurrentProjectDescription()},this.getCurrentProjectImage=function(){return this.planet.ProjectStorage.getCurrentProjectImage()},this.getTimeLastSaved=function(){return this.planet.ProjectStorage.TimeLastSaved},this.init=function(){this.iframe=document.getElementById("planet-iframe");try{this.iframe.contentWindow.makePlanet(_THIS_IS_MUSIC_BLOCKS_,t,window._),this.planet=this.iframe.contentWindow.p,this.planet.setLoadProjectFromData(this.loadProjectFromData.bind(this)),this.planet.setPlanetClose(this.closePlanet.bind(this)),this.planet.setLoadNewProject(this.newProject.bind(this)),this.planet.setLoadProjectFromFile(this.loadProjectFromFile.bind(this)),this.planet.setOnConverterLoad(this.onConverterLoad.bind(this))}catch(t){console.log("Planet not available"),this.planet=null}window.Converter=this.planet.Converter,this.mainCanvas=canvas}}(storage),planet.init()}catch(t){planet=void 0}save=new SaveInterface(planet),save.setVariables([["logo",logo],["turtles",turtles],["storage",storage],["printBlockSVG",_printBlockSVG],["planet",planet]]),save.init(),toolbar=new Toolbar,toolbar.init(beginnerMode),toolbar.renderLogoIcon(_showAboutPage),toolbar.renderPlayIcon(d._doFastButton),toolbar.renderStopIcon(d.doHardStopButton),toolbar.renderNewProjectIcon(_afterDelete),toolbar.renderLoadIcon(doLoad),toolbar.renderSaveIcons(save.saveHTML.bind(save),doSVG,save.saveSVG.bind(save),save.savePNG.bind(save),save.saveWAV.bind(save),save.saveLilypond.bind(save),save.saveAbc.bind(save),save.saveBlockArtwork.bind(save)),toolbar.renderPlanetIcon(planet,_doOpenSamples),toolbar.renderMenuIcon(_showHideAuxMenu),toolbar.renderHelpIcon(_showHelp),toolbar.renderModeSelectIcon(doSwitchMode),toolbar.renderRunSlowlyIcon(d._doSlowButton),toolbar.renderRunStepIcon(_doStepButton),toolbar.renderAdvancedIcons(doAnalytics,doOpenPlugin,deletePlugin,f,d._setupBlocksContainerEvents),toolbar.renderMergeIcon(_doMergeLoad),toolbar.renderRestoreIcon(_restoreTrash),toolbar.renderLanguageSelectIcon(languageBox),null!=planet?saveLocally=planet.saveLocally.bind(planet):(__saveLocally=function(){console.log("overwriting session data (local)");B();var t=doSVG(canvas,logo,turtles,320,240,320/canvas.width);if(sugarizerCompatibility.isInsideSugarizer()?storage=sugarizerCompatibility.data:storage=localStorage,void 0===storage.currentProject)try{storage.currentProject="My Project",storage.allProjects=JSON.stringify(["My Project"])}catch(t){console.log(t)}try{var i=storage.currentProject;storage["SESSION"+i]=B()}catch(t){console.log(t)}var s=new Image;t=doSVG(canvas,logo,turtles,320,240,320/canvas.width);s.onload=function(){var t=new createjs.Bitmap(s),e=t.getBounds();t.cache(e.x,e.y,e.width,e.height);try{storage["SESSIONIMAGE"+i]=t.bitmapCache.getCacheDataURL()}catch(t){console.log(t)}},s.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t))),sugarizerCompatibility.isInsideSugarizer()&&sugarizerCompatibility.saveLocally()},saveLocally=__saveLocally),window.saveLocally=saveLocally,logo.setSaveLocally(saveLocally);if(_THIS_IS_MUSIC_BLOCKS_?initBasicProtoBlocks(palettes,blocks,beginnerMode):initBasicProtoBlocks(palettes,blocks),macroData=storage.macros,null!=macroData&&processMacroData(macroData,palettes,blocks,macroDict),blocks.setMacroDictionary(macroDict),palettes.setMacroDictionary(macroDict),pluginData=storage.plugins,null!=pluginData){var i=processPluginData(pluginData,palettes,blocks,logo.evalFlowDict,logo.evalArgDict,logo.evalParameterDict,logo.evalSetterDict,logo.evalOnStartList,logo.evalOnStopList,palettes.pluginMacros);updatePluginObj(i)}var t=storage.custommode;null!=t&&(customMode=JSON.parse(t),console.log("restoring custom mode: "+customMode)),fileChooser.addEventListener("click",function(t){this.value=null}),fileChooser.addEventListener("change",function(t){var l=new FileReader;l.onload=function(t){loading=!0,document.body.style.cursor="wait",setTimeout(function(){var t=l.result;if(null==t||""===t)console.log("rawData is "+t),errorMsg(_("Cannot load project from the file. Please check the file type."));else{var e=t.replace("\n"," ");try{if(e.includes("html"))var i=JSON.parse(e.match('<div class="code">(.+?)</div>')[1]);else i=JSON.parse(e);for(var s in blocks.palettes.dict)blocks.palettes.dict[s].hideMenu(!0);if(stage.removeAllEventListeners("trashsignal"),merging)merging=!1,logo.playbackQueue={},blocks.loadNewBlocks(i);else{stage.addEventListener("trashsignal",function(t){logo.playbackQueue={},blocks.loadNewBlocks(i),stage.removeAllEventListeners("trashsignal")},!1),sendAllToTrash(!1,!1),planet&&planet.initialiseNewProject(fileChooser.files[0].name.substr(0,fileChooser.files[0].name.lastIndexOf(".")))}loading=!1,w()}catch(t){errorMsg(_("Cannot load project from the file. Please check the file type.")),console.log(t),document.body.style.cursor="default",loading=!1}}},200)},l.readAsText(fileChooser.files[0])},!1);var e=docById("canvasHolder");e.addEventListener("dragover",function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},!1),e.addEventListener("drop",function(t){t.stopPropagation(),t.preventDefault();var o=t.dataTransfer.files,a=new FileReader;a.onload=function(t){loading=!0,document.body.style.cursor="wait",setTimeout(function(){var t=a.result;if(null==t||""===t)errorMsg(_("Cannot load project from the file. Please check the file type."));else{var e=t.replace("\n"," ");try{if(e.includes("html")){dat=e.match('<div class="code">(.+?)</div>');var i=JSON.parse(dat[1])}else i=JSON.parse(e);for(var s in blocks.palettes.dict)blocks.palettes.dict[s].hideMenu(!0);stage.removeAllEventListeners("trashsignal");var l=function t(){document.removeEventListener("finishedLoading",t)};stage.addEventListener("trashsignal",function(t){logo.playbackQueue={},blocks.loadNewBlocks(i),stage.removeAllEventListeners("trashsignal"),document.addEventListener?document.addEventListener("finishedLoading",l):document.attachEvent("finishedLoading",l)},!1),sendAllToTrash(!1,!1),void 0!==planet&&planet.initialiseNewProject(o[0].name.substr(0,o[0].name.lastIndexOf("."))),loading=!1,w()}catch(t){console.log(t),errorMsg(_("Cannot load project from the file. Please check the file type.")),document.body.style.cursor="default",loading=!1}}},200)},null!=o[0]&&(a.readAsText(o[0]),window.scroll(0,0))},!1),allFilesChooser.addEventListener("click",function(t){this.value=null}),pluginChooser.addEventListener("click",function(t){window.scroll(0,0),this.value=null}),pluginChooser.addEventListener("change",function(t){window.scroll(0,0);var e=new FileReader;e.onload=function(t){loading=!0,document.body.style.cursor="wait",setTimeout(function(){if(null!=(i=processRawPluginData(e.result,palettes,blocks,errorMsg,logo.evalFlowDict,logo.evalArgDict,logo.evalParameterDict,logo.evalSetterDict,logo.evalOnStartList,logo.evalOnStopList,palettes.pluginMacros))){var t=preparePluginExports(i);storage.plugins=t}setTimeout(function(){palettes.visible&&palettes.hide(),palettes.bringToTop()},1e3),document.body.style.cursor="default",loading=!1},200)},e.readAsText(pluginChooser.files[0])},!1),createjs.Touch.enable(stage,!1,!0),stage.mouseMoveOutside=!0,stage.enableMouseOver(10),cartesianBitmap=_createGrid("data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(CARTESIAN)))),polarBitmap=_createGrid("data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(POLAR))));var s=window.location.href,l=null,o={run:!1,show:!1,collapse:!1};L(!0);var a,r=[];if(!sugarizerCompatibility.isInsideSugarizer()&&0<s.indexOf("?"))if(0<(a=s.split("?"))[1].indexOf("&"))for(var c=a[1].split("&"),h=0;h<c.length;h++){if(0<c[h].indexOf("="))switch((u=c[h].split("="))[0].toLowerCase()){case"file":console.log("Warning: old Music Blocks URLs will no longer work.");break;case"id":l=u[1];break;case"run":"true"===u[1].toLowerCase()&&(o.run=!0);break;case"show":"true"===u[1].toLowerCase()&&(o.show=!0);break;case"collapse":"true"===u[1].toLowerCase()&&(o.collapse=!0);break;case"inurl":(function(t){return new Promise(function(e,i){var s=new XMLHttpRequest;s.open("get",t,!0),s.responseType="json",s.onload=function(){var t=s.status;200===t?e(s.response):i(t)},s.send()})})(u[1]).then(function(t){n=t.arg,r.push(parseInt(n))},function(t){alert("Something went wrong reading JSON-encoded project data.")});break;case"outurl":u[1];break;default:errorMsg(_("Invalid parameters"))}}else{if(0<a[1].indexOf("="))var u=a[1].split("=");"id"===u[0].toLowerCase()&&(l=u[1])}null!=l?setTimeout(function(){console.log("loading "+l),d.loadStartWrapper(d.loadProject,l,o,r)},200):setTimeout(function(){console.log("load new Start block"),d.loadStartWrapper(d._loadStart)},200),prepSearchWidget(),document.addEventListener("mousewheel",m,!1),document.addEventListener("DOMMouseScroll",m,!1),document.onkeydown=T,_hideStopButton()}}getABCHeader=function(){return ABCHEADER},processAbcNotes=function(t,e){function i(t){var e="";switch(t){case 64:e="1/4";break;case 32:e="1/2";break;case 16:e="1";break;case 8:e="2";break;case 4:e="4";break;case 2:e="8";break;case 1:e="16";break;default:e=t}return e}function n(t){if("number"==typeof t){var e=frequencyToPitch(t);t=e[0]+e[1]}return-1<t.indexOf("")&&(t="^"+t.replace("","")),-1<t.indexOf("")&&(t="^"+t.replace(//g,"")),-1<t.indexOf("")&&(t="_"+t.replace("","")),-1<t.indexOf("")&&(t="_"+t.replace(//g,"")),-1<t.indexOf("10")?t.replace("10","'''''").toLowerCase():-1<t.indexOf("9")?t.replace("9","''''").toLowerCase():-1<t.indexOf("8")?t.replace("8","'''").toLowerCase():-1<t.indexOf("7")?t.replace("7","''").toLowerCase():-1<t.indexOf("6")?t.replace("6","'").toLowerCase():-1<t.indexOf("5")?t.replace("5","").toLowerCase():-1<t.indexOf("4")?t.replace("4","").toUpperCase():-1<t.indexOf("3")?t.replace("3",",").toUpperCase():-1<t.indexOf("2")?t.replace("2",",,").toUpperCase():-1<t.indexOf("1")?t.replace("1",",,,").toUpperCase():t.toUpperCase()}t.notationNotes[e]="";for(var s=0,l=!1,o=!1,a=0,r=0,c=0;c<t.notationStaging[e].length;c++)if(obj=t.notationStaging[e][c],"string"==typeof obj)switch(obj){case"break":0<c&&(t.notationNotes[e]+="\n"),s=0;break;case"begin articulation":o=!0;break;case"end articulation":o=!1;break;case"begin crescendo":t.notationNotes[e]+="!<(!";break;case"end crescendo":t.notationNotes[e]+="!<)!";break;case"begin decrescendo":t.notationNotes[e]+="!>(!";break;case"end decrescendo":t.notationNotes[e]+="!<(!";break;case"begin slur":l=!0;break;case"end slur":case"tie":t.notationNotes[e]+="";break;case"meter":t.notationNotes[e]+="M:"+t.notationStaging[e][c+1]+"/"+t.notationStaging[e][c+2]+"\n",c+=2;break;case"pickup":c+=1;break;case"voice one":case"voice two":case"voice three":case"voice four":case"one voice":break;default:t.notationNotes[e]+=obj}else{var h=function(t,e,i,s){for(var l=0,o=0;o<s;){t.notationStaging[e][i+l][NOTATIONDURATION];if("object"===_typeof(d)){for(1<d.length&&(t.notationNotes[e]+="["),ii=0;ii<d.length;ii++)t.notationNotes[e]+=n(d[ii]),t.notationNotes[e]+=" ";obj[NOTATIONSTACCATO]&&(t.notationNotes[e]+="."),1<d.length&&(t.notationNotes[e]+="]"),t.notationNotes[e]+=t.notationStaging[e][i+l][NOTATIONROUNDDOWN],l++,o++}else console.log("ignoring "+d),l++,o++}if(i+l-1<t.notationStaging[e].length-1){var a=t.notationStaging[e][i+l];"string"==typeof a&&")"===a?i+=1:t.notationNotes[e]+=" "}else t.notationNotes[e]+=" ";return l};if(s%8==0&&0<s&&(t.notationNotes[e]+="\n"),s+=1,"string"==typeof obj[NOTATIONNOTE])var u=n(obj[NOTATIONNOTE]);else{var d=obj[NOTATIONNOTE];u=n(d[0])}var f=0;if(null!=obj[NOTATIONTUPLETVALUE]){a=1/t.notationStaging[e][c][NOTATIONDURATION],r=1/t.notationStaging[e][c][NOTATIONROUNDDOWN];for(var p=1,b=1;b<obj[NOTATIONTUPLETVALUE];){if(c+p>=t.notationStaging[e].length){f=p;break}if(0<t.notationStaging[e][c+p][NOTATIONINSIDECHORD]&&t.notationStaging[e][c+p][NOTATIONINSIDECHORD]===t.notationStaging[e][c+p-1][NOTATIONINSIDECHORD])p++;else{if(t.notationStaging[e][c+p][NOTATIONTUPLETVALUE]!==obj[NOTATIONTUPLETVALUE]){f=p;break}a+=1/t.notationStaging[e][c+p][NOTATIONDURATION],r+=1/t.notationStaging[e][c+p][NOTATIONROUNDDOWN],p++,b++}}}if(0<obj[NOTATIONTUPLETVALUE]){if(0===f){var m=toFraction(r/a);t.notationNotes[e]+="("+m[0]+":"+m[1],c+=h(t,e,c,obj[NOTATIONTUPLETVALUE])-1}else{m=toFraction(obj[NOTATIONTUPLETVALUE]/f);t.notationNotes[e]+="("+m[0]+":"+m[1],c+=h(t,e,c,f)-1}r=a=0}else{if("object"===_typeof(d)){for(1<d.length&&(t.notationNotes[e]+="["),ii=0;ii<d.length;ii++)t.notationNotes[e]+=n(d[ii]),t.notationNotes[e]+=" ";1<d.length&&(t.notationNotes[e]+="]"),t.notationNotes[e]+=obj[NOTATIONDURATION];for(var g=0;g<obj[NOTATIONDOTCOUNT];g++)t.notationNotes[e]+=".";t.notationNotes[e]+=" "}if(obj[NOTATIONSTACCATO]&&(t.notationNotes[e]+="."),0<obj[NOTATIONINSIDECHORD]){if(0!==c&&t.notationStaging[e][c-1][NOTATIONINSIDECHORD]===obj[NOTATIONINSIDECHORD]||(t.notationNotes[e]+="["),t.notationNotes[e]+=u,c===t.notationStaging[e].length-1||t.notationStaging[e][c+1][NOTATIONINSIDECHORD]!==obj[NOTATIONINSIDECHORD]){t.notationNotes[e]+="]",t.notationNotes[e]+=i(obj[NOTATIONDURATION]);for(g=0;g<obj[NOTATIONDOTCOUNT];g++)t.notationNotes[e]+=" ";o&&(t.notationNotes[e]+=" "),t.notationNotes[e]+=" "}}else{t.notationNotes[e]+=u,t.notationNotes[e]+=i(obj[NOTATIONDURATION]);for(g=0;g<obj[NOTATIONDOTCOUNT];g++)t.notationNotes[e]+=".";o&&(t.notationNotes[e]+="")}obj[NOTATIONSTACCATO]&&(t.notationNotes[e]+="."),r=a=0}t.notationNotes[e]+=" ",l&&(l=!1,t.notationNotes[e]+="")}},saveAbcOutput=function(t){var e=0;for(var i in t.notationOutput=getABCHeader(),t.notationStaging)e+=1;console.log("saving as abc: "+e);for(var i in t.notationStaging)t.notationOutput+="K:"+t.keySignature[i].toUpperCase().replace(" ","").replace("","b").replace("","#")+"\n",processAbcNotes(t,i),t.notationOutput+=t.notationNotes[i],1;return t.notationOutput+="\n",t.notationOutput},activity=new Activity,require(["domReady!","activity/sugarizer-compatibility"],function(t){sugarizerCompatibility.isInsideSugarizer()?(window.addEventListener("localized",function(){sugarizerCompatibility.loadData(function(){planet=document.getElementById("planet-iframe"),planet.onload=function(){activity.domReady(t)}})}),document.webL10n.setLanguage(sugarizerCompatibility.getLanguage())):(activity.setupDependencies(),activity.domReady(t))}),define(MYDEFINES,function(t){activity.setupDependencies(),activity.doContextMenus(),activity.doPluginsAndPaletteCols()});var COLLAPSEBUTTONXOFF=-48,COLLAPSEBUTTONYOFF=9,STANDARDBLOCKHEIGHT=42,DEFAULTBLOCKSCALE=1.5,FILLCOLORS=["#ed001d","#a34600","#fb5f00","#6cc600","#00843c","#008283","#007ac9","#005dff","#b500e3","#ec008a"],STROKECOLORS=["#ffada6","#ffa300","#ffc000","#037700","#00fa8c","#00f3db","#00e3ff","#8dceff","#f3aeff","#ff97d5"],TURTLESVG='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="55" viewBox="0 0 54.999998 54.999998" version="1.1" id="svg40" height="55"><g transform="translate(-3.1884835,0.12548216)" style="fill:stroke_color;stroke:fill_color;stroke-width:1.99999976;stroke-miterlimit:4;stroke-dasharray:none" id="g3586"><path style="fill:stroke_color;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" id="path4725" d="m 31.188483,5.8745178 c 0,0 -1.254644,-1 -2,-1 -1.490712,0 -2.945907,0.9459074 -4,2 -1.581139,1.5811389 -1.692548,4.1860072 -3,6.0000002 -0.826905,1.14727 -1.85273,2.173095 -3,3 -1.813992,1.307452 -4.41886,1.418861 -5.999999,3 -1.054093,1.054093 -2,2.509288 -2,4 0,1.490712 1.176934,3.540162 2,4 2.595129,1.449868 0.836609,0.648512 2,2 0,0 -1.040434,3.300808 -1,5 0.06539,2.747959 1.999999,7 1.999999,8 0,1 3.621931,4.46873 6,6 2.394526,1.541867 5.323775,2.059095 8.164792,2.258437 3.065644,0.215103 5.976447,-0.356365 8.670416,-1.835208 1.652944,-0.907377 3.020234,-1.924716 4.164792,-3.423229 1.631246,-2.13571 3.310226,-4.40261 4,-7 0.42778,-1.610833 0.203639,-3.345821 0,-5 -0.167925,-1.364071 -1.27205,-2.652826 -1,-4 0.329909,-1.633688 2.319717,-2.47849 3,-4 0.693755,-1.551642 1.687609,-3.445625 1,-5 -0.786311,-1.777496 -3.357594,-1.960634 -5,-3 -1.015577,-0.642689 -2.106041,-1.196706 -3,-2 -1.93647,-1.740075 -3.442391,-3.913943 -5,-6.0000002 -0.71906,-0.9630146 -1.044881,-2.2704844 -2,-3 -0.837694,-0.6398275 -1.974105,-1.2421808 -3,-1 -0.458794,0.1083066 -1,1 -1,1" /><path d="m 46.209786,28.156906 c 0,0 1.463947,5.738921 1.001084,8.583832 -0.503422,3.094194 -1.733796,6.320068 -4.004337,8.583833 -2.061998,2.055845 -3.20724,2.828474 -6.006505,3.815036 -1.290398,0.454783 -4.973515,0.953759 -6.514048,0.953759 -1.540535,0 -5.223651,-0.498977 -6.514049,-0.95376 -2.799265,-0.986562 -3.944507,-1.759191 -6.006506,-3.815036 -2.270541,-2.263765 -3.500915,-5.489639 -4.004337,-8.583833 -0.462863,-2.844911 1.001084,-8.583832 1.001084,-8.583832 M 28.176267,22.43435 c 0,0 -4.122174,4.705629 -7.007589,5.722555 -1.877805,0.661806 -4.201946,0.826315 -6.006506,0 -1.925806,-0.881834 -3.58357,-2.772978 -4.004337,-4.768796 -0.478397,-2.26917 0.558956,-4.123549 2.470477,-5.529022 2.067374,-1.520067 4.598363,-1.662883 6.539282,-3.054811 2.515152,-1.803739 2.912345,-5.389772 5.005421,-7.6300732 1.420632,-1.520559 5.512965,-3.8150366 5.512965,-3.8150366 0,0 4.092331,2.2944775 5.512964,3.8150365 2.093073,2.2403013 2.490269,5.8263353 5.005421,7.6300743 1.940919,1.391928 4.538808,1.465531 6.606183,2.927334 1.937249,1.369793 2.881973,3.387329 2.403575,5.656499 -0.420767,1.995818 -2.078532,3.886962 -4.004337,4.768796 -1.80456,0.826315 -4.1287,0.661806 -6.006505,0 -2.885416,-1.016926 -7.00759,-5.722555 -7.00759,-5.722555" id="path4505-6" style="fill:none;stroke:fill_color;stroke-width:1.95427048;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /><g id="g4565" transform="matrix(1.0010843,0,0,0.95375917,57.401951,5.3863652)" style="fill:none;stroke:fill_color;stroke-opacity:1"><g id="g4553" transform="translate(0,-1)" style="fill:none;stroke:fill_color;stroke-opacity:1"><path d="M -30.228157,8.514322 C -33.422908,9.40349 -38.624018,5.874516 -40.102591,4.585664" id="path3411-7" style="fill:none;fill-rule:evenodd;stroke:fill_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /><path d="M -29.760199,5.904536 C -33.101366,5.473905 -35.931474,3.7361852 -37.633646,2.3416285" id="path3413-5" style="fill:none;fill-rule:evenodd;stroke:fill_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /></g><g id="g4557" style="fill:none;stroke:fill_color;stroke-opacity:1"><path d="m -23.145912,7.514322 c 3.194751,0.889168 8.395861,-2.639806 9.874434,-3.928658" id="path3411-3" style="fill:none;fill-rule:evenodd;stroke:fill_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /><path d="m -23.61387,4.904536 c 3.341167,-0.430631 6.171275,-2.168351 7.873447,-3.5629075" id="path3413-56" style="fill:none;fill-rule:evenodd;stroke:fill_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /></g></g><g id="g4636" transform="matrix(1.0010843,0,0,0.95375917,57.930597,3.4788469)" style="fill:#ffffff;stroke:fill_color;stroke-opacity:1;fill-opacity:0.94117647"><ellipse cx="-30.836912" cy="14.612609" id="circle3409-2" rx="1.8846371" ry="2.0666313" style="fill:#ffffff;fill-rule:evenodd;stroke:fill_color;stroke-width:1.99999976;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:0.94117647" /><ellipse cx="-23.593306" cy="14.699166" id="ellipse4229-9" rx="1.8846371" ry="2.0666313" style="fill:#ffffff;fill-rule:evenodd;stroke:fill_color;stroke-width:1.99999976;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:0.94117647" /></g><g id="g4632" transform="matrix(1.0010843,0,0,0.95375917,58.02711,3.4788469)" style="fill:none;stroke:fill_color;stroke-opacity:1"><path d="m -37.186516,14.624518 c -14.340024,2.75008 -4.810404,15.671871 4.375,5.25" id="path4303-1" style="fill:none;fill-rule:evenodd;stroke:fill_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /><path d="m -17.436517,14.624518 c 14.3400245,2.75008 4.810404,15.671872 -4.375,5.25" id="path4303-1-2" style="fill:none;fill-rule:evenodd;stroke:fill_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /></g><path d="m 33.12784,3.3591671 c -1.384692,1.3140551 -1.985761,2.3793068 -2.459835,2.3793068 -0.662709,0 -1.27278,-1.0652517 -2.459836,-2.3793068 -0.97292,-1.0770097 1.101306,-2.37930771 2.459836,-2.37930771 1.358531,0 3.532987,1.36090081 2.459835,2.37930771 z" id="path4227-7" style="fill:fill_color;fill-rule:evenodd;stroke:fill_color;stroke-width:2.16383076;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:1" /><path style="fill:none;stroke:fill_color;stroke-width:1.95427048;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path4653" d="m 31.302308,50.085622 c 0,0 0.723125,3.123831 5.500191,3.669996 4.777067,0.546166 11.784656,-3.778776 14.78791,-9.501331 3.003254,-5.722555 2.402683,-11.490783 3.003253,-18.121425" /></g></svg>',DRUMSVG='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.1" width="55" height="55" viewBox="0 0 55 55" id="svg2" xml:space="preserve"><path d="m 9.653,18.199 h 35.54 c 0.772,0 1.4,0.628 1.4,1.403 v 2.362 c 0,0.771 -0.628,1.401 -1.4,1.401 H 9.653 c -0.775,0 -1.403,-0.628 -1.403,-1.401 v -2.361 c 0,-0.777 0.627,-1.404 1.403,-1.404 z" id="path8" style="fill:stroke_color;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><rect width="33.139" height="22.128" x="10.852" y="23.365" id="rect10" style="fill:stroke_color;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="m 9.653,45.493 h 35.54 c 0.772,0 1.4,0.627 1.4,1.401 v 2.362 c 0,0.775 -0.628,1.405 -1.4,1.405 H 9.653 c -0.775,0 -1.403,-0.629 -1.403,-1.405 v -2.362 c 0,-0.77 0.627,-1.401 1.403,-1.401 z" id="path17" style="fill:stroke_color;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="M 10.851,45.491 19.395,23.365 27.291,45.49 35.217,23.364" id="path19" style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="M 43.987,45.491 35.217,23.365" id="path21" style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><line style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" y2="5.948" y1="13.149" x2="48.335999" x1="33.689999" id="line27" display="inline" /><line style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" y2="9.4799995" y1="2.2130001" x2="20.658001" x1="6.0419998" id="line29" display="inline" /><path d="m 25.721,9.802 c 0.55,1.451 -0.171,3.066 -1.608,3.612 -1.437,0.545 -3.049,-0.188 -3.599,-1.639 -0.547,-1.45 0.174,-3.067 1.609,-3.613 1.438,-0.542 3.049,0.19 3.598,1.64 z" id="path23" style="fill:stroke_color;stroke:stroke_color;stroke-width:2.25;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="m 33.338,16.442 c -1.04,1.125 -2.798,1.189 -3.928,0.144 -1.128,-1.044 -1.197,-2.801 -0.155,-3.927 1.041,-1.125 2.8,-1.19 3.926,-0.146 1.129,1.045 1.2,2.803 0.157,3.929 z" id="path25" style="fill:stroke_color;stroke:stroke_color;stroke-width:2.25;stroke-linecap:round;stroke-linejoin:round;display:inline" /></svg>',EFFECTSVG='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.1" width="55" height="55" viewBox="0 0 55 55" id="svg2" xml:space="preserve"><path d="m 9.653,18.199 h 35.54 c 0.772,0 1.4,0.628 1.4,1.403 v 2.362 c 0,0.771 -0.628,1.401 -1.4,1.401 H 9.653 c -0.775,0 -1.403,-0.628 -1.403,-1.401 v -2.361 c 0,-0.777 0.627,-1.404 1.403,-1.404 z" id="path8" style="fill:stroke_color;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><rect width="33.139" height="22.128" x="10.852" y="23.365" id="rect10" style="fill:stroke_color;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="m 9.653,45.493 h 35.54 c 0.772,0 1.4,0.627 1.4,1.401 v 2.362 c 0,0.775 -0.628,1.405 -1.4,1.405 H 9.653 c -0.775,0 -1.403,-0.629 -1.403,-1.405 v -2.362 c 0,-0.77 0.627,-1.401 1.403,-1.401 z" id="path17" style="fill:stroke_color;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="M 10.851,45.491 19.395,23.365 27.291,45.49 35.217,23.364" id="path19" style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="M 43.987,45.491 35.217,23.365" id="path21" style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" /><line style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" y2="5.948" y1="13.149" x2="48.335999" x1="33.689999" id="line27" display="inline" /><line style="fill:none;stroke:stroke_color;stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;display:inline" y2="9.4799995" y1="2.2130001" x2="20.658001" x1="6.0419998" id="line29" display="inline" /><path d="m 25.721,9.802 c 0.55,1.451 -0.171,3.066 -1.608,3.612 -1.437,0.545 -3.049,-0.188 -3.599,-1.639 -0.547,-1.45 0.174,-3.067 1.609,-3.613 1.438,-0.542 3.049,0.19 3.598,1.64 z" id="path23" style="fill:stroke_color;stroke:stroke_color;stroke-width:2.25;stroke-linecap:round;stroke-linejoin:round;display:inline" /><path d="m 33.338,16.442 c -1.04,1.125 -2.798,1.189 -3.928,0.144 -1.128,-1.044 -1.197,-2.801 -0.155,-3.927 1.041,-1.125 2.8,-1.19 3.926,-0.146 1.129,1.045 1.2,2.803 0.157,3.929 z" id="path25" style="fill:stroke_color;stroke:stroke_color;stroke-width:2.25;stroke-linecap:round;stroke-linejoin:round;display:inline" /></svg>',TEXTX=26,TEXTY=26,VALUETEXTX=70,COLLAPSETEXTX=10,COLLAPSETEXTY=40,MEDIASAFEAREA=[40,4,108,80],HIGHLIGHTCOLOR="#FFFFFF",ACTIVECOLOR="#212121";function showMaterialHighlight(t,e,i,s,l,o){var a={highlight:new createjs.Shape,active:new createjs.Shape};return a.highlight.graphics.f(HIGHLIGHTCOLOR).drawCircle(-6,-6,i),a.highlight.alpha=.3,a.highlight.x=t,a.highlight.y=e,a.active.graphics.f(ACTIVECOLOR).drawCircle(-6,-6,i),a.active.alpha=0,o.addChild(a.highlight,a.active),createjs.Tween.get(a.active).to({scaleX:.3,scaleY:.3,x:s.rawX/l,y:s.rawY/l}).to({scaleX:1,scaleY:1,x:t,y:e},650,createjs.Ease.circInOut),createjs.Tween.get(a.active).to({alpha:.05}).to({alpha:.3},400),a}function hideButtonHighlight(t,e){void 0!==t.active&&(createjs.Tween.get(t.active).to({alpha:0},400),createjs.Tween.get(t.highlight).to({alpha:0},400),setTimeout(function(){e.removeChild(t.active,t.highlight)},650))}function hidePaletteNameDisplay(t,e){setTimeout(function(){e.removeChild(t)},150)}var MENUWIDTH=200,PALETTEFILLER='<svg xmlns="http://www.w3.org/2000/svg" width="200" height="filler_height"><rect width="200" height="filler_height" x="0" y="0" style="fill:#b3b3b3;fill-opacity:1;stroke:none" /></svg>',PALETTEHEADER='<svg xmlns="http://www.w3.org/2000/svg" width="header_width" height="42"><rect width="header_width" height="42" x="0" y="0" style="fill:fill_color;fill-opacity:1;stroke:none" /><text style="font-size:16px;font-style:normal;font-weight:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill-opacity:1;stroke:none;font-family:Sans"><tspan  x="40" y="28" style="font-size:16px;text-align:start;text-anchor:start;fill:#ffffff">palette_label</tspan></text></svg>',PALETTEBUTTON='<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55"><circle cx="27.5" cy="27.5" r="27.5" x="0" y="0" style="fill:fill_color;fill-opacity:1;stroke:none" /></svg>',BACKGROUND='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="650" height="590"><rect width="650" height="590" x="0" y="0" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" /><g transform="translate(595,0)" style="fill:#000000;display:block"><path d="m 27.557,5.053 c -12.43,0 -22.5,10.076 -22.5,22.497 0,12.432 10.07,22.503 22.5,22.503 12.431,0 22.5,-10.071 22.5,-22.503 0,-12.421 -10.07,-22.497 -22.5,-22.497 z m 10.199,28.159 c 1.254,1.256 1.257,3.291 0,4.545 -0.628,0.629 -1.451,0.943 -2.274,0.943 -0.822,0 -1.644,-0.314 -2.27,-0.94 l -5.76,-5.761 -5.76,5.761 c -0.627,0.626 -1.449,0.94 -2.271,0.94 -0.823,0 -1.647,-0.314 -2.275,-0.943 -1.254,-1.254 -1.254,-3.289 0.004,-4.545 l 5.758,-5.758 -5.758,-5.758 c -1.258,-1.254 -1.258,-3.292 -0.004,-4.546 1.255,-1.254 3.292,-1.259 4.546,0 l 5.76,5.759 5.76,-5.759 c 1.252,-1.259 3.288,-1.254 4.544,0 1.257,1.254 1.254,3.292 0,4.546 l -5.758,5.758 5.758,5.758 z" style="fill:#000000;display:inline" /></g></svg>',NEXTBUTTON='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="55" height="55"><path d="M27.5,50C39.927,50,50,39.927,50,27.5C50,15.072,39.927,5,27.5,5S5,15.072,5,27.5 C5,39.927,15.073,50,27.5,50z M17.093,22.725c0.626-0.624,1.447-0.939,2.271-0.939c0.822,0,1.645,0.315,2.271,0.939l5.84,5.833 l5.657-5.802c0.63-0.645,1.464-0.967,2.3-0.967c0.808,0,1.62,0.305,2.246,0.914c1.266,1.238,1.295,3.271,0.056,4.546l-7.929,8.126 c-0.002,0-0.002,0-0.003,0c-0.01,0.011-0.015,0.021-0.022,0.028c-0.116,0.115-0.245,0.208-0.371,0.302 c-0.039,0.028-0.071,0.064-0.111,0.093c-0.114,0.075-0.24,0.133-0.36,0.194c-0.068,0.035-0.131,0.078-0.2,0.107 c-0.1,0.039-0.203,0.064-0.306,0.093c-0.099,0.032-0.191,0.068-0.292,0.09c-0.083,0.018-0.169,0.018-0.251,0.028 c-0.122,0.015-0.244,0.033-0.366,0.036c-0.071,0-0.147-0.014-0.219-0.021c-0.133-0.007-0.266-0.011-0.395-0.036 c-0.075-0.014-0.147-0.043-0.223-0.064c-0.124-0.035-0.251-0.061-0.373-0.111c-0.083-0.032-0.161-0.082-0.244-0.121 c-0.106-0.055-0.215-0.104-0.316-0.165c-0.084-0.058-0.16-0.13-0.239-0.194c-0.086-0.064-0.176-0.122-0.254-0.201 c-0.005-0.003-0.009-0.011-0.013-0.014c-0.007-0.004-0.011-0.008-0.014-0.011l-8.142-8.13 C15.837,26.019,15.834,23.986,17.093,22.725z" fill="#000000"/></svg>',PREVBUTTON='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="55" height="55"><path d="M27.5,5C15.073,5,5,15.073,5,27.5C5,39.928,15.073,50,27.5,50S50,39.928,50,27.5 C50,15.073,39.927,5,27.5,5z M37.906,32.275c-0.626,0.624-1.447,0.939-2.271,0.939c-0.821,0-1.645-0.315-2.271-0.939l-5.84-5.833 l-5.657,5.802c-0.63,0.645-1.464,0.967-2.3,0.967c-0.808,0-1.62-0.305-2.246-0.914c-1.266-1.238-1.295-3.271-0.056-4.546 l7.929-8.126c0.002,0,0.002,0,0.003,0c0.01-0.011,0.015-0.021,0.022-0.028c0.116-0.115,0.245-0.208,0.371-0.302 c0.039-0.028,0.071-0.064,0.111-0.093c0.114-0.075,0.24-0.133,0.36-0.194c0.068-0.035,0.131-0.078,0.2-0.107 c0.1-0.039,0.203-0.064,0.306-0.093c0.099-0.032,0.191-0.068,0.292-0.09c0.083-0.018,0.169-0.018,0.251-0.028 c0.122-0.015,0.244-0.033,0.366-0.036c0.071,0,0.147,0.014,0.219,0.021c0.133,0.007,0.266,0.011,0.395,0.036 c0.075,0.014,0.146,0.043,0.223,0.064c0.123,0.035,0.251,0.061,0.373,0.111c0.082,0.032,0.161,0.082,0.243,0.121 c0.106,0.055,0.216,0.104,0.316,0.165c0.084,0.058,0.159,0.13,0.238,0.194c0.086,0.064,0.176,0.122,0.255,0.201 c0.005,0.003,0.009,0.011,0.013,0.014c0.007,0.004,0.011,0.008,0.014,0.011l8.142,8.13C39.162,28.981,39.166,31.014,37.906,32.275 z" fill="#000000"/></svg>',MSGBLOCK='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="1000" height="42"><g transform="matrix(2,0,0,2,0,8)"><path d="m 0.5,8.5 0,-8 c 0,-2.09 1.91,-4 4,-4 l 4,0 10,0 473,0 4,0 c 2.09,0 4.26,1.92 4,4 l 0,8 0,4 c 0,2.09 -1.91,4 -4,4 l -4,0 -473,0 -10,0 -4,0 c -2.09,0 -4,-1.91 -4,-4 z" style="fill:fill_color;fill-opacity:1;stroke:stroke_color;stroke-width:1;stroke-linecap:round;stroke-opacity:1" /></g></svg>',BOUNDARY='<svg xmlns="http://www.w3.org/2000/svg" height="HEIGHT" width="WIDTH"> <rect style="fill:none;stroke:stroke_color;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:9, 9;stroke-dashoffset:0;stroke-opacity:1" y="Y" x="X" height="DY" width="DX" /></svg>',MBOUNDARY='<svg xmlns="http://www.w3.org/2000/svg" height="HEIGHT" width="WIDTH"> <rect style="fill:fill_color;stroke:stroke_color;stroke-width:STROKE;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1" y="Y" x="X" height="DY" width="DX" /></svg>',BORDER='<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120"><rect width="115" height="115" x="2.5" y="2.5" style="fill:none;stroke:stroke_color;stroke-width:5.0;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:15, 15;stroke-dashoffset:0" /></svg>',PALETTECOLORS0={widgets:[37.5,70,50],pitch:[37.5,70,50],rhythm:[12.5,60,80],meter:[12.5,60,80],tone:[57.5,50,28],ornament:[57.5,50,28],intervals:[37.5,70,50],volume:[57.5,50,28],drum:[57.5,50,28],mouse:[37.5,70,50],pen:[57.5,50,28],boxes:[12.5,60,80],action:[22.5,80,57],media:[57.5,70,28],number:[0,70,42],boolean:[30,80,57],flow:[15,60,50],sensors:[7.5,60,80],extras:[12.5,60,80],myblocks:[57.5,70,14],heap:[17.5,60,70],mice:[7.5,50,0]},PALETTECOLORS={widgets:[37.5,70,35],pitch:[37.5,70,42],rhythm:[12.5,60,49],meter:[12.5,60,49],tone:[57.5,50,21],ornament:[57.5,50,21],intervals:[37.5,70,42],volume:[57.5,50,21],drum:[57.5,50,21],mouse:[37.5,70,35],pen:[57.5,50,21],boxes:[12.5,60,49],action:[22.5,80,35],media:[57.5,70,21],number:[0,70,28],boolean:[30,80,35],flow:[15,60,28],sensors:[7.5,60,35],extras:[12.5,60,49],myblocks:[57.5,70,14],heap:[17.5,60,28],mice:[7.5,50,0]},PALETTEFILLCOLORS={},PALETTESTROKECOLORS={},PALETTEHIGHLIGHTCOLORS={},HIGHLIGHTSTROKECOLORS={},UPICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 55"><path d="M27.5,5C15.073,5,5,15.073,5,27.5C5,39.928,15.073,50,27.5,50S50,39.928,50,27.5 C50,15.073,39.927,5,27.5,5z M37.906,32.275c-0.626,0.624-1.447,0.939-2.271,0.939c-0.821,0-1.645-0.315-2.271-0.939l-5.84-5.833 l-5.657,5.802c-0.63,0.645-1.464,0.967-2.3,0.967c-0.808,0-1.62-0.305-2.246-0.914c-1.266-1.238-1.295-3.271-0.056-4.546 l7.929-8.126c0.002,0,0.002,0,0.003,0c0.01-0.011,0.015-0.021,0.022-0.028c0.116-0.115,0.245-0.208,0.371-0.302 c0.039-0.028,0.071-0.064,0.111-0.093c0.114-0.075,0.24-0.133,0.36-0.194c0.068-0.035,0.131-0.078,0.2-0.107 c0.1-0.039,0.203-0.064,0.306-0.093c0.099-0.032,0.191-0.068,0.292-0.09c0.083-0.018,0.169-0.018,0.251-0.028 c0.122-0.015,0.244-0.033,0.366-0.036c0.071,0,0.147,0.014,0.219,0.021c0.133,0.007,0.266,0.011,0.395,0.036 c0.075,0.014,0.146,0.043,0.223,0.064c0.123,0.035,0.251,0.061,0.373,0.111c0.082,0.032,0.161,0.082,0.243,0.121 c0.106,0.055,0.216,0.104,0.316,0.165c0.084,0.058,0.159,0.13,0.238,0.194c0.086,0.064,0.176,0.122,0.255,0.201 c0.005,0.003,0.009,0.011,0.013,0.014c0.007,0.004,0.011,0.008,0.014,0.011l8.142,8.13C39.162,28.981,39.166,31.014,37.906,32.275 z" fill="#000000"/></svg>',DOWNICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 55"><path d="M27.5,50C39.927,50,50,39.927,50,27.5C50,15.072,39.927,5,27.5,5S5,15.072,5,27.5 C5,39.927,15.073,50,27.5,50z M17.093,22.725c0.626-0.624,1.447-0.939,2.271-0.939c0.822,0,1.645,0.315,2.271,0.939l5.84,5.833 l5.657-5.802c0.63-0.645,1.464-0.967,2.3-0.967c0.808,0,1.62,0.305,2.246,0.914c1.266,1.238,1.295,3.271,0.056,4.546l-7.929,8.126 c-0.002,0-0.002,0-0.003,0c-0.01,0.011-0.015,0.021-0.022,0.028c-0.116,0.115-0.245,0.208-0.371,0.302 c-0.039,0.028-0.071,0.064-0.111,0.093c-0.114,0.075-0.24,0.133-0.36,0.194c-0.068,0.035-0.131,0.078-0.2,0.107 c-0.1,0.039-0.203,0.064-0.306,0.093c-0.099,0.032-0.191,0.068-0.292,0.09c-0.083,0.018-0.169,0.018-0.251,0.028 c-0.122,0.015-0.244,0.033-0.366,0.036c-0.071,0-0.147-0.014-0.219-0.021c-0.133-0.007-0.266-0.011-0.395-0.036 c-0.075-0.014-0.147-0.043-0.223-0.064c-0.124-0.035-0.251-0.061-0.373-0.111c-0.083-0.032-0.161-0.082-0.244-0.121 c-0.106-0.055-0.215-0.104-0.316-0.165c-0.084-0.058-0.16-0.13-0.239-0.194c-0.086-0.064-0.176-0.122-0.254-0.201 c-0.005-0.003-0.009-0.011-0.013-0.014c-0.007-0.004-0.011-0.008-0.014-0.011l-8.142-8.13 C15.837,26.019,15.834,23.986,17.093,22.725z" fill="#000000"/></svg>',FADEDUPICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 55"><path d="M27.5,5C15.073,5,5,15.073,5,27.5C5,39.928,15.073,50,27.5,50S50,39.928,50,27.5 C50,15.073,39.927,5,27.5,5z M37.906,32.275c-0.626,0.624-1.447,0.939-2.271,0.939c-0.821,0-1.645-0.315-2.271-0.939l-5.84-5.833 l-5.657,5.802c-0.63,0.645-1.464,0.967-2.3,0.967c-0.808,0-1.62-0.305-2.246-0.914c-1.266-1.238-1.295-3.271-0.056-4.546 l7.929-8.126c0.002,0,0.002,0,0.003,0c0.01-0.011,0.015-0.021,0.022-0.028c0.116-0.115,0.245-0.208,0.371-0.302 c0.039-0.028,0.071-0.064,0.111-0.093c0.114-0.075,0.24-0.133,0.36-0.194c0.068-0.035,0.131-0.078,0.2-0.107 c0.1-0.039,0.203-0.064,0.306-0.093c0.099-0.032,0.191-0.068,0.292-0.09c0.083-0.018,0.169-0.018,0.251-0.028 c0.122-0.015,0.244-0.033,0.366-0.036c0.071,0,0.147,0.014,0.219,0.021c0.133,0.007,0.266,0.011,0.395,0.036 c0.075,0.014,0.146,0.043,0.223,0.064c0.123,0.035,0.251,0.061,0.373,0.111c0.082,0.032,0.161,0.082,0.243,0.121 c0.106,0.055,0.216,0.104,0.316,0.165c0.084,0.058,0.159,0.13,0.238,0.194c0.086,0.064,0.176,0.122,0.255,0.201 c0.005,0.003,0.009,0.011,0.013,0.014c0.007,0.004,0.011,0.008,0.014,0.011l8.142,8.13C39.162,28.981,39.166,31.014,37.906,32.275 z" fill="#b8b8b8"/></svg>',FADEDDOWNICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 55"><path d="M27.5,50C39.927,50,50,39.927,50,27.5C50,15.072,39.927,5,27.5,5S5,15.072,5,27.5 C5,39.927,15.073,50,27.5,50z M17.093,22.725c0.626-0.624,1.447-0.939,2.271-0.939c0.822,0,1.645,0.315,2.271,0.939l5.84,5.833 l5.657-5.802c0.63-0.645,1.464-0.967,2.3-0.967c0.808,0,1.62,0.305,2.246,0.914c1.266,1.238,1.295,3.271,0.056,4.546l-7.929,8.126 c-0.002,0-0.002,0-0.003,0c-0.01,0.011-0.015,0.021-0.022,0.028c-0.116,0.115-0.245,0.208-0.371,0.302 c-0.039,0.028-0.071,0.064-0.111,0.093c-0.114,0.075-0.24,0.133-0.36,0.194c-0.068,0.035-0.131,0.078-0.2,0.107 c-0.1,0.039-0.203,0.064-0.306,0.093c-0.099,0.032-0.191,0.068-0.292,0.09c-0.083,0.018-0.169,0.018-0.251,0.028 c-0.122,0.015-0.244,0.033-0.366,0.036c-0.071,0-0.147-0.014-0.219-0.021c-0.133-0.007-0.266-0.011-0.395-0.036 c-0.075-0.014-0.147-0.043-0.223-0.064c-0.124-0.035-0.251-0.061-0.373-0.111c-0.083-0.032-0.161-0.082-0.244-0.121 c-0.106-0.055-0.215-0.104-0.316-0.165c-0.084-0.058-0.16-0.13-0.239-0.194c-0.086-0.064-0.176-0.122-0.254-0.201 c-0.005-0.003-0.009-0.011-0.013-0.014c-0.007-0.004-0.011-0.008-0.014-0.011l-8.142-8.13 C15.837,26.019,15.834,23.986,17.093,22.725z" fill="#b8b8b8"/></svg>',CLOSEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 55"><g transform="translate(0-997.36)"><path fill="fill_color" d="m0 997.36h55v54.998h-55z"/><g fill="#fff"><path d="m44.971 1036.26c1.675 1.674 1.675 4.39 0 6.06-1.675 1.674-4.391 1.674-6.07 0l-28.875-28.872c-1.675-1.674-1.675-4.39 0-6.06 1.675-1.674 4.391-1.674 6.07 0l28.875 28.872"/><path d="m16.09 1042.33c-1.675 1.674-4.391 1.674-6.07 0-1.675-1.674-1.675-4.39 0-6.06l28.875-28.871c1.675-1.674 4.391-1.674 6.07 0 1.675 1.674 1.675 4.39 0 6.06l-28.875 28.871"/></g></g></svg>',ACTIONSPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 11</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M15.67,43.73V39.11H14.05A5.35,5.35,0,0,1,8.7,33.78V17.59a5.34,5.34,0,0,1,5.35-5.32h3v4.62H29.62V12.27H42a5.34,5.34,0,0,1,5.35,5.32V33.78A5.35,5.35,0,0,1,42,39.11H31v4.62Z" style="fill:#ffbf00"/><path d="M42,13a4.63,4.63,0,0,1,4.65,4.62V33.78A4.64,4.64,0,0,1,42,38.41H30.32V43H16.38V38.41H14.05A4.64,4.64,0,0,1,9.4,33.78V17.59A4.63,4.63,0,0,1,14.05,13h2.33v4.62H30.32V13H42m0-1.4h-13v4.62H17.78V11.57H14.05a6,6,0,0,0-6.05,6V33.78a6,6,0,0,0,6.05,6H15v4.62H31.72V39.81H42a6,6,0,0,0,6-6V17.59a6,6,0,0,0-6-6Z" style="fill:#daaf30"/></g></g></svg>',BOOLEANPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 15</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M23.46,28A11.69,11.69,0,0,1,28,18.78a12,12,0,0,0-7.38-2.53,11.75,11.75,0,1,0,0,23.5A12,12,0,0,0,28,37.22,11.69,11.69,0,0,1,23.46,28Z" style="fill:#d97df5;stroke:#b653d3;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><path d="M35.38,16.25A12,12,0,0,0,28,18.78a11.63,11.63,0,0,1,0,18.44,12,12,0,0,0,7.38,2.53,11.75,11.75,0,1,0,0-23.5Z" style="fill:#d97df5;stroke:#b653d3;stroke-miterlimit:10;stroke-width:1.399999976158142px"/></g></g></svg>',BOXESPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 16</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M28.29,44.21a1,1,0,0,1-.53-.16,1,1,0,0,1-.46-.83V26.13a1,1,0,0,1,.59-.9l14.93-6.69a1.11,1.11,0,0,1,.41-.08,1,1,0,0,1,.53.15,1,1,0,0,1,.46.83V36.53a1,1,0,0,1-.59.9L28.7,44.12A1,1,0,0,1,28.29,44.21Z" style="fill:#fe994f"/><path d="M43.23,19.16a.26.26,0,0,1,.15,0,.29.29,0,0,1,.14.24V36.53a.3.3,0,0,1-.17.26L28.41,43.48a.25.25,0,0,1-.12,0,.32.32,0,0,1-.16,0,.28.28,0,0,1-.13-.24V26.14a.3.3,0,0,1,.17-.27L43.1,19.18l.13,0m0-1.4a1.86,1.86,0,0,0-.7.14L27.6,24.6a1.68,1.68,0,0,0-1,1.54V43.22a1.66,1.66,0,0,0,.79,1.42,1.68,1.68,0,0,0,.9.26,1.86,1.86,0,0,0,.7-.14l14.93-6.69a1.7,1.7,0,0,0,1-1.54V19.44a1.69,1.69,0,0,0-1.69-1.68Z" style="fill:#e86b0e"/><path d="M27.71,44.21a.93.93,0,0,1-.4-.09L12.37,37.43a1,1,0,0,1-.59-.9V19.44a1,1,0,0,1,.46-.83,1,1,0,0,1,.53-.15,1.15,1.15,0,0,1,.41.08l14.94,6.7a1,1,0,0,1,.58.89V43.22a1,1,0,0,1-.47.83A.94.94,0,0,1,27.71,44.21Z" style="fill:#fe994f"/><path d="M12.77,19.16l.13,0,14.93,6.69a.3.3,0,0,1,.17.27V43.22a.28.28,0,0,1-.13.24.32.32,0,0,1-.16,0,.25.25,0,0,1-.12,0L12.65,36.79a.3.3,0,0,1-.17-.26V19.44a.29.29,0,0,1,.14-.24.26.26,0,0,1,.15,0m0-1.4a1.69,1.69,0,0,0-1.69,1.69V36.53a1.7,1.7,0,0,0,1,1.54L27,44.76a1.74,1.74,0,0,0,1.6-.12,1.66,1.66,0,0,0,.79-1.42V26.14a1.68,1.68,0,0,0-1-1.54L13.47,17.91a1.69,1.69,0,0,0-.7-.15Z" style="fill:#e86b0e"/><path d="M28,26.52a1,1,0,0,1-.41-.09l-3.36-1.57-7.76-3.42-.28-.11L13.14,20a1,1,0,0,1-.58-.91,1,1,0,0,1,.59-.89L27.6,11.88a.93.93,0,0,1,.4-.09.86.86,0,0,1,.39.09l14.46,6.28a1,1,0,0,1,0,1.8L28.41,26.43A1,1,0,0,1,28,26.52Z" style="fill:#fe994f"/><path d="M28,12.5a.25.25,0,0,1,.12,0l2.49,1.08h0l8.57,3.73,3.39,1.47a.3.3,0,0,1,.17.26.29.29,0,0,1-.17.26L28.12,25.79a.26.26,0,0,1-.24,0l-3.35-1.56-8-3.55h0l-.9-.4h0l-2.15-1a.29.29,0,0,1-.17-.26.3.3,0,0,1,.17-.26l14.45-6.28a.25.25,0,0,1,.12,0m0-1.4a1.63,1.63,0,0,0-.68.14L12.88,17.52a1.67,1.67,0,0,0-1,1.53,1.69,1.69,0,0,0,1,1.55l2.15,1,.9.4.57.26h0L24,25.51l3.31,1.55a1.74,1.74,0,0,0,.72.16,1.65,1.65,0,0,0,.69-.15L43.14,20.6a1.69,1.69,0,0,0,1-1.55,1.67,1.67,0,0,0-1-1.53L39.74,16l-8.57-3.72-2.49-1.08A1.63,1.63,0,0,0,28,11.1Z" style="fill:#e86b0e"/></g></g></svg>',BLOCKSPALETTEICON=BOXESPALETTEICON,CARTESIANBUTTON='<svg width="42" height="42" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><title> 33</title><g style="isolation:isolate"><g id="_2" data-name=" 2"><g id="Icon"><rect width="42" height="42" rx="5" ry="5" style="fill:#292929;opacity:0.4;mix-blend-mode:multiply"/><path d="M31.73,21a10.36,10.36,0,0,1-5.36,9,11,11,0,0,1-10.74,0,10.27,10.27,0,0,1,0-18,11,11,0,0,1,10.74,0A10.36,10.36,0,0,1,31.73,21Z" style="fill:none;stroke:#d8d8d8;stroke-linecap:square;stroke-miterlimit:10;stroke-width:1.36741304397583px"/><line x1="21" y1="8.37" x2="21" y2="33.63" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><line x1="33.63" y1="21" x2="8.37" y2="21" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><rect x="10.98" y="10.98" width="20.04" height="20.04" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/></g></g></g></svg>',CARTESIANPOLARBUTTON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><title> 30</title><g style="isolation:isolate"><g id="_2" data-name=" 2"><g id="Icon"><rect width="42" height="42" rx="5" ry="5" style="fill:#292929;opacity:0.4;mix-blend-mode:multiply"/><path d="M31.73,21a10.36,10.36,0,0,1-5.36,9,11,11,0,0,1-10.74,0,10.27,10.27,0,0,1,0-18,11,11,0,0,1,10.74,0A10.36,10.36,0,0,1,31.73,21Z" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><line x1="21" y1="8.37" x2="21" y2="33.63" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><line x1="33.63" y1="21" x2="8.37" y2="21" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><rect x="10.98" y="10.98" width="20.04" height="20.04" style="fill:none;stroke:#fff;stroke-linecap:square;stroke-miterlimit:10;stroke-width:1.36741304397583px"/></g></g></g></svg>',DRUMPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 8</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><path d="M31.05,23a2.76,2.76,0,0,1,0-5.51,3.38,3.38,0,0,1,.63.07l4.23-4.22a1.46,1.46,0,0,1,2.48,1,1.44,1.44,0,0,1-.43,1l-4.22,4.22A2.76,2.76,0,0,1,31.05,23Z" style="fill:#3edcdd"/><path d="M36.92,13.62a.79.79,0,0,1,.54.22.77.77,0,0,1,0,1.07l-4.53,4.53a2.05,2.05,0,0,1-1.88,2.87,2.06,2.06,0,0,1,0-4.11,2.11,2.11,0,0,1,.82.17l4.53-4.53a.79.79,0,0,1,.53-.22m0-1.4v0a2.18,2.18,0,0,0-1.52.63l-4,4-.39,0a3.46,3.46,0,1,0,3.44,3.07l4-4a2.16,2.16,0,0,0-1.53-3.68Z" style="fill:#1dbcbd"/><path d="M26,20.36A2.75,2.75,0,0,1,23.27,17L19,12.75a1.46,1.46,0,0,1,1-2.48,1.44,1.44,0,0,1,1,.43l4.22,4.22a2.78,2.78,0,0,1,2.57.73A2.76,2.76,0,0,1,26,20.36Z" style="fill:#3edcdd"/><path d="M20.07,11a.73.73,0,0,1,.53.22l4.53,4.53a2.11,2.11,0,0,1,.82-.17,2.05,2.05,0,0,1,1.45,3.5,2.05,2.05,0,0,1-3.34-2.26l-4.53-4.53A.76.76,0,0,1,20.07,11m0-1.4a2.14,2.14,0,0,0-1.53.63,2.16,2.16,0,0,0,0,3.05l4,4A3.47,3.47,0,0,0,26,21.06a3.46,3.46,0,0,0,0-6.91l-.39,0-4-4a2.12,2.12,0,0,0-1.52-.63Z" style="fill:#1dbcbd"/><path d="M15.91,45.73a2.21,2.21,0,0,1-2.21-2.21V42a2.21,2.21,0,0,1,2.21-2.21h.81V26.6h-.81a2.21,2.21,0,0,1-2.21-2.21V22.88a2.22,2.22,0,0,1,2.21-2.22H40.09a2.22,2.22,0,0,1,2.21,2.22v1.51a2.21,2.21,0,0,1-2.21,2.21h-.81V39.8h.81A2.21,2.21,0,0,1,42.3,42v1.51a2.21,2.21,0,0,1-2.21,2.21Z" style="fill:#3edcdd"/><path d="M40.09,21.36a1.52,1.52,0,0,1,1.51,1.52v1.51a1.52,1.52,0,0,1-1.51,1.51H38.58V40.5h1.51A1.51,1.51,0,0,1,41.6,42v1.51A1.52,1.52,0,0,1,40.09,45H15.91a1.52,1.52,0,0,1-1.51-1.51V42a1.51,1.51,0,0,1,1.51-1.51h1.51V25.9H15.91a1.52,1.52,0,0,1-1.51-1.51V22.88a1.52,1.52,0,0,1,1.51-1.52H40.09m0-1.4H15.91A2.92,2.92,0,0,0,13,22.88v1.51a2.92,2.92,0,0,0,2.91,2.91H16V39.1h-.11A2.91,2.91,0,0,0,13,42v1.51a2.92,2.92,0,0,0,2.91,2.91H40.09A2.92,2.92,0,0,0,43,43.52V42a2.91,2.91,0,0,0-2.91-2.91H40V27.3h.11A2.92,2.92,0,0,0,43,24.39V22.88A2.92,2.92,0,0,0,40.09,20Z" style="fill:#1dbcbd"/></g></g></svg>',EFFECTPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 8</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><path d="M31.05,23a2.76,2.76,0,0,1,0-5.51,3.38,3.38,0,0,1,.63.07l4.23-4.22a1.46,1.46,0,0,1,2.48,1,1.44,1.44,0,0,1-.43,1l-4.22,4.22A2.76,2.76,0,0,1,31.05,23Z" style="fill:#3edcdd"/><path d="M36.92,13.62a.79.79,0,0,1,.54.22.77.77,0,0,1,0,1.07l-4.53,4.53a2.05,2.05,0,0,1-1.88,2.87,2.06,2.06,0,0,1,0-4.11,2.11,2.11,0,0,1,.82.17l4.53-4.53a.79.79,0,0,1,.53-.22m0-1.4v0a2.18,2.18,0,0,0-1.52.63l-4,4-.39,0a3.46,3.46,0,1,0,3.44,3.07l4-4a2.16,2.16,0,0,0-1.53-3.68Z" style="fill:#1dbcbd"/><path d="M26,20.36A2.75,2.75,0,0,1,23.27,17L19,12.75a1.46,1.46,0,0,1,1-2.48,1.44,1.44,0,0,1,1,.43l4.22,4.22a2.78,2.78,0,0,1,2.57.73A2.76,2.76,0,0,1,26,20.36Z" style="fill:#3edcdd"/><path d="M20.07,11a.73.73,0,0,1,.53.22l4.53,4.53a2.11,2.11,0,0,1,.82-.17,2.05,2.05,0,0,1,1.45,3.5,2.05,2.05,0,0,1-3.34-2.26l-4.53-4.53A.76.76,0,0,1,20.07,11m0-1.4a2.14,2.14,0,0,0-1.53.63,2.16,2.16,0,0,0,0,3.05l4,4A3.47,3.47,0,0,0,26,21.06a3.46,3.46,0,0,0,0-6.91l-.39,0-4-4a2.12,2.12,0,0,0-1.52-.63Z" style="fill:#1dbcbd"/><path d="M15.91,45.73a2.21,2.21,0,0,1-2.21-2.21V42a2.21,2.21,0,0,1,2.21-2.21h.81V26.6h-.81a2.21,2.21,0,0,1-2.21-2.21V22.88a2.22,2.22,0,0,1,2.21-2.22H40.09a2.22,2.22,0,0,1,2.21,2.22v1.51a2.21,2.21,0,0,1-2.21,2.21h-.81V39.8h.81A2.21,2.21,0,0,1,42.3,42v1.51a2.21,2.21,0,0,1-2.21,2.21Z" style="fill:#3edcdd"/><path d="M40.09,21.36a1.52,1.52,0,0,1,1.51,1.52v1.51a1.52,1.52,0,0,1-1.51,1.51H38.58V40.5h1.51A1.51,1.51,0,0,1,41.6,42v1.51A1.52,1.52,0,0,1,40.09,45H15.91a1.52,1.52,0,0,1-1.51-1.51V42a1.51,1.51,0,0,1,1.51-1.51h1.51V25.9H15.91a1.52,1.52,0,0,1-1.51-1.51V22.88a1.52,1.52,0,0,1,1.51-1.52H40.09m0-1.4H15.91A2.92,2.92,0,0,0,13,22.88v1.51a2.92,2.92,0,0,0,2.91,2.91H16V39.1h-.11A2.91,2.91,0,0,0,13,42v1.51a2.92,2.92,0,0,0,2.91,2.91H40.09A2.92,2.92,0,0,0,43,43.52V42a2.91,2.91,0,0,0-2.91-2.91H40V27.3h.11A2.92,2.92,0,0,0,43,24.39V22.88A2.92,2.92,0,0,0,40.09,20Z" style="fill:#1dbcbd"/></g></g></svg>',ERASEBUTTON='<svg width="42" height="42" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><title> 27</title><g style="isolation:isolate"><g id="_2" data-name=" 2"><g id="Icon"><rect width="42" height="42" rx="5" ry="5" style="fill:#292929;opacity:0.4;mix-blend-mode:multiply"/><path d="M32.54,31.33H19.16l2-2-8-8.09-2.92,2.88a1.14,1.14,0,0,0,0,1.61l5.51,5.58H7.4a.62.62,0,1,0,0,1.24H32.54a.62.62,0,1,0,0-1.24Z" style="fill:#fff"/><path d="M32.82,17.86a1.15,1.15,0,0,0,0-1.61L26.44,9.77a1.15,1.15,0,0,0-1.61,0L14.06,20.39l8,8.1Z" style="fill:#fff"/></g></g></g></svg>',CLEARBUTTON=ERASEBUTTON,EXTRASPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 19</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M41.13,44.77a4.27,4.27,0,0,1-3-1.21l-16-15.63a8.87,8.87,0,0,1-2.61.39,8.76,8.76,0,0,1-6.16-2.5A8.37,8.37,0,0,1,11,18.57a1.4,1.4,0,0,1,1.4-1.2,1.39,1.39,0,0,1,1,.41l2.9,2.83a3,3,0,0,0,4.26,0,2.79,2.79,0,0,0,.8-2,3.08,3.08,0,0,0-.92-2.15l-2.81-2.75a1.37,1.37,0,0,1-.35-1.41,1.4,1.4,0,0,1,1.15-.95,8.24,8.24,0,0,1,1.22-.08,8.71,8.71,0,0,1,6.16,2.5,8.5,8.5,0,0,1,2.16,8.59L43.94,38a3.92,3.92,0,0,1,0,5.67A4,4,0,0,1,41.13,44.77Z" style="fill:#c4c4c4"/><path d="M19.59,11.75a8.25,8.25,0,0,1,5.79,2.35,7.9,7.9,0,0,1,1.92,8.37L43.57,38.41a3.38,3.38,0,0,1,0,4.9,3.48,3.48,0,0,1-2.4.94,3.71,3.71,0,0,1-2.6-1.06L22.34,27.33a8.35,8.35,0,0,1-2.75.46,8.23,8.23,0,0,1-5.79-2.35,7.92,7.92,0,0,1-2.32-6.79.89.89,0,0,1,.88-.75.85.85,0,0,1,.61.25L15.87,21a3.52,3.52,0,0,0,2.48,1,3.56,3.56,0,0,0,2.53-1,3.46,3.46,0,0,0-.13-4.89l-2.81-2.76a.85.85,0,0,1,.5-1.46,8.89,8.89,0,0,1,1.15-.08m0-1.05a9.22,9.22,0,0,0-1.29.09,1.92,1.92,0,0,0-1.58,1.3A1.89,1.89,0,0,0,17.2,14L20,16.8a2.57,2.57,0,0,1,.77,1.78,2.28,2.28,0,0,1-.66,1.62,2.42,2.42,0,0,1-1.77.74,2.52,2.52,0,0,1-1.75-.7L13.71,17.4a1.94,1.94,0,0,0-3.27,1.1,8.93,8.93,0,0,0,2.62,7.7,9.36,9.36,0,0,0,9,2.32L37.79,43.94a4.82,4.82,0,0,0,3.34,1.36,4.51,4.51,0,0,0,3.12-1.22,4.45,4.45,0,0,0,.06-6.42L28.5,22.17a9,9,0,0,0-2.39-8.82,9.25,9.25,0,0,0-6.52-2.65Z" style="fill:#a0a0a0"/></g></g></svg>',FLOWPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 12</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M32.37,24.34a1.24,1.24,0,0,1-1-.61,1.21,1.21,0,0,1,0-1.22l1.53-2.64a13.79,13.79,0,0,0-6.48-1.61,13.49,13.49,0,0,0-7.48,2.25,4.92,4.92,0,0,1-2.65.81A3.3,3.3,0,0,1,14,20.48a2.53,2.53,0,0,1-.76-2.13,4.56,4.56,0,0,1,2.11-3.3A20,20,0,0,1,26.4,11.72a20.27,20.27,0,0,1,9.75,2.5L38,11.1a1.21,1.21,0,0,1,2.18.2L43.69,21a1.22,1.22,0,0,1-.94,1.62L32.51,24.33Z" style="fill:#d98a43"/><path d="M39,11.2a.51.51,0,0,1,.48.34L43,21.26a.52.52,0,0,1-.4.69L32.46,23.63h-.09a.52.52,0,0,1-.44-.78l1.89-3.25a14.56,14.56,0,0,0-7.44-2.05,14.22,14.22,0,0,0-7.87,2.36,4.17,4.17,0,0,1-2.26.7A2.62,2.62,0,0,1,14.44,20c-1-1-.59-3.11,1.26-4.33a19.33,19.33,0,0,1,10.7-3.22,19.57,19.57,0,0,1,10,2.75l2.16-3.72A.5.5,0,0,1,39,11.2m0-1.4a1.91,1.91,0,0,0-1.65.95l-1.47,2.54A20.92,20.92,0,0,0,26.4,11a20.63,20.63,0,0,0-11.47,3.45,5.2,5.2,0,0,0-2.42,3.82,3.28,3.28,0,0,0,1,2.71,4,4,0,0,0,2.76,1,5.68,5.68,0,0,0,3-.92A12.85,12.85,0,0,1,26.38,19a13,13,0,0,1,5.5,1.21l-1.16,2a1.93,1.93,0,0,0,0,1.92,1.91,1.91,0,0,0,1.65,1,1.63,1.63,0,0,0,.31,0l10.18-1.68a1.9,1.9,0,0,0,1.34-.92,1.93,1.93,0,0,0,.15-1.62L40.8,11.06A1.93,1.93,0,0,0,39,9.8Z" style="fill:#b7651a"/><path d="M17,45.5a1.2,1.2,0,0,1-1.14-.8L12.31,35a1.22,1.22,0,0,1,.94-1.62l10.24-1.69h.14a1.24,1.24,0,0,1,1.05.61,1.21,1.21,0,0,1,0,1.22l-1.53,2.64a13.79,13.79,0,0,0,6.48,1.61,13.41,13.41,0,0,0,7.48-2.25,5,5,0,0,1,2.65-.81,3.3,3.3,0,0,1,2.29.84,2.53,2.53,0,0,1,.76,2.13A4.56,4.56,0,0,1,40.69,41,20,20,0,0,1,29.6,44.28a20.27,20.27,0,0,1-9.75-2.5L18,44.9A1.19,1.19,0,0,1,17,45.5Z" style="fill:#d98a43"/><path d="M23.63,32.36a.52.52,0,0,1,.44.78l-1.89,3.25a14.56,14.56,0,0,0,7.44,2,14.22,14.22,0,0,0,7.87-2.36,4.17,4.17,0,0,1,2.26-.7,2.62,2.62,0,0,1,1.81.65c1,1,.59,3.11-1.26,4.33a19.33,19.33,0,0,1-10.7,3.22,19.57,19.57,0,0,1-10-2.75l-2.16,3.72a.5.5,0,0,1-.44.25.51.51,0,0,1-.48-.34L13,34.74a.52.52,0,0,1,.4-.69l10.17-1.68h.09m0-1.4a1.63,1.63,0,0,0-.31,0L13.14,32.67a1.9,1.9,0,0,0-1.34.92,1.93,1.93,0,0,0-.15,1.62l3.55,9.73a1.91,1.91,0,0,0,3.45.31l1.47-2.54A20.92,20.92,0,0,0,29.6,45a20.63,20.63,0,0,0,11.47-3.45,5.18,5.18,0,0,0,2.42-3.82,3.28,3.28,0,0,0-1-2.71,4,4,0,0,0-2.76-1,5.68,5.68,0,0,0-3,.92A12.77,12.77,0,0,1,29.62,37a13,13,0,0,1-5.5-1.21l1.16-2a1.93,1.93,0,0,0,0-1.92,1.91,1.91,0,0,0-1.65-1Z" style="fill:#b7651a"/></g></g></svg>',HEAPPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 13</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><rect x="16.4" y="40.07" width="23.16" height="5.48" rx="0.77" ry="0.77" style="fill:#d98a43"/><path d="M38.79,40.57a.27.27,0,0,1,.27.27v3.93a.27.27,0,0,1-.27.28H17.18a.27.27,0,0,1-.28-.28V40.84a.27.27,0,0,1,.28-.27H38.79m0-1H17.18a1.27,1.27,0,0,0-1.28,1.27v3.93a1.28,1.28,0,0,0,1.28,1.28H38.79a1.27,1.27,0,0,0,1.27-1.28V40.84a1.27,1.27,0,0,0-1.27-1.27Z" style="fill:#b7651a"/><rect x="16.4" y="31.98" width="23.16" height="5.48" rx="0.77" ry="0.77" style="fill:#d98a43"/><path d="M38.79,32.48a.27.27,0,0,1,.27.27v3.94a.27.27,0,0,1-.27.27H17.18a.27.27,0,0,1-.28-.27V32.75a.27.27,0,0,1,.28-.27H38.79m0-1H17.18a1.27,1.27,0,0,0-1.28,1.27v3.94A1.27,1.27,0,0,0,17.18,38H38.79a1.27,1.27,0,0,0,1.27-1.27V32.75a1.27,1.27,0,0,0-1.27-1.27Z" style="fill:#b7651a"/><rect x="16.4" y="23.9" width="23.16" height="5.48" rx="0.77" ry="0.77" style="fill:#d98a43"/><path d="M38.79,24.39a.28.28,0,0,1,.27.28V28.6a.27.27,0,0,1-.27.27H17.18a.27.27,0,0,1-.28-.27V24.67a.28.28,0,0,1,.28-.28H38.79m0-1H17.18a1.28,1.28,0,0,0-1.28,1.28V28.6a1.27,1.27,0,0,0,1.28,1.27H38.79a1.27,1.27,0,0,0,1.27-1.27V24.67a1.28,1.28,0,0,0-1.27-1.28Z" style="fill:#b7651a"/><path d="M33.4,21.58a2,2,0,0,1-2-2V14.29a2,2,0,0,1,2-2h7.41v-1.2a.66.66,0,0,1,.42-.61l.09,0h.16a.68.68,0,0,1,.46.19l3.25,3.1a.67.67,0,0,1,.2.47.63.63,0,0,1-.2.47l-3.25,3.1a.68.68,0,0,1-.46.19h-.1l-.15,0a.66.66,0,0,1-.42-.61V16.1l-5.45,0V19.6A2,2,0,0,1,33.4,21.58Z" style="fill:#d98a43"/><path d="M41.48,11a.16.16,0,0,1,.11.05l3.25,3.1a.15.15,0,0,1,0,.22l-3.25,3.1a.16.16,0,0,1-.11,0l-.07,0a.15.15,0,0,1-.1-.14V15.6H40.19l-5.33,0v4a1.47,1.47,0,0,1-1.46,1.48h0a1.47,1.47,0,0,1-1.47-1.48V14.29a1.47,1.47,0,0,1,1.47-1.48h7.91v-1.7a.18.18,0,0,1,.1-.15h.07m0-1a1.22,1.22,0,0,0-.43.08,1.16,1.16,0,0,0-.74,1.08v.7H33.4a2.48,2.48,0,0,0-2.47,2.48V19.6a2.47,2.47,0,1,0,4.93,0v-3l4.33,0h.12v.71a1.16,1.16,0,0,0,2,.83l3.25-3.09a1.16,1.16,0,0,0,.36-.84,1.14,1.14,0,0,0-.35-.82l-3.26-3.12a1.17,1.17,0,0,0-.8-.32Z" style="fill:#b7651a"/><path d="M22.34,21.58a.65.65,0,0,1-.47-.2L18.8,18.09a.69.69,0,0,1-.13-.7.65.65,0,0,1,.61-.42h1.19V16.1h-8a1.9,1.9,0,0,1,0-3.8h9.85a1.89,1.89,0,0,1,1.88,1.9V17h1.18a.65.65,0,0,1,.61.42.69.69,0,0,1-.13.7l-3.07,3.29A.67.67,0,0,1,22.34,21.58Z" style="fill:#d98a43"/><path d="M22.35,12.81a1.39,1.39,0,0,1,1.38,1.4v3.26h1.68a.16.16,0,0,1,.15.1.17.17,0,0,1,0,.18L22.45,21a.15.15,0,0,1-.22,0l-3.06-3.28a.17.17,0,0,1,0-.18.15.15,0,0,1,.14-.1H21V16.33l0-.73H12.5a1.4,1.4,0,0,1,0-2.8h9.85m0-1H12.5a2.4,2.4,0,0,0,0,4.8h6.23a1.18,1.18,0,0,0-.52.6,1.15,1.15,0,0,0,.23,1.23l3.06,3.29a1.17,1.17,0,0,0,.84.36,1.16,1.16,0,0,0,.84-.36l3.07-3.29a1.17,1.17,0,0,0,.24-1.22,1.16,1.16,0,0,0-1.08-.74h-.68V14.21a2.4,2.4,0,0,0-2.38-2.4Z" style="fill:#b7651a"/></g></g></svg>',INTERVALSPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 4</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><path d="M28,48.8c-2.92,0-5.3-2.1-5.3-4.67s2.38-4.67,5.3-4.67a5.87,5.87,0,0,1,2.25.45V38.84a5.69,5.69,0,0,1-2.25.45c-2.92,0-5.3-2.09-5.3-4.67S25.08,30,28,30a5.69,5.69,0,0,1,2.25.46V29.33a5.69,5.69,0,0,1-2.25.45c-2.92,0-5.3-2.09-5.3-4.67s2.38-4.66,5.3-4.66a5.69,5.69,0,0,1,2.25.45V8.75a1.52,1.52,0,1,1,3,0V24.9a1.36,1.36,0,0,1,0,.21,1.94,1.94,0,0,1,0,.24v9.06a1.25,1.25,0,0,1,0,.21,1.64,1.64,0,0,1,0,.23v9a2.23,2.23,0,0,1,0,.32C33.3,46.7,30.92,48.8,28,48.8Z" style="fill:#7cd622"/><path d="M31.76,7.9a.84.84,0,0,1,.82.85V24.9c0,.07,0,.14,0,.21s0,.14,0,.21v9.09c0,.07,0,.14,0,.21s0,.14,0,.21v8.86s0,.06,0,.09,0,.23,0,.35c0,2.19-2.06,4-4.6,4s-4.6-1.78-4.6-4,2.06-4,4.6-4a5,5,0,0,1,2.95,1V37.64a5,5,0,0,1-2.95,1c-2.54,0-4.6-1.78-4.6-4s2.06-4,4.6-4a5,5,0,0,1,2.95,1V28.13a5,5,0,0,1-2.95.95c-2.54,0-4.6-1.77-4.6-4s2.06-4,4.6-4a5,5,0,0,1,2.95.94V8.75a.84.84,0,0,1,.81-.85m0-1.4a2.23,2.23,0,0,0-2.21,2.25V19.93A6.64,6.64,0,0,0,28,19.75c-3.31,0-6,2.4-6,5.36a5.34,5.34,0,0,0,3.22,4.76,5.12,5.12,0,0,0,0,9.51A5.34,5.34,0,0,0,22,44.13c0,3,2.69,5.37,6,5.37s6-2.41,6-5.37a1.69,1.69,0,0,0,0-.35s0-.06,0-.09V34.92c0-.1,0-.2,0-.3s0-.2,0-.3v-8.9c0-.11,0-.21,0-.31s0-.2,0-.3V8.75A2.24,2.24,0,0,0,31.76,6.5Z" style="fill:#57ad02"/></g></g></svg>',MEDIAPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 18</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M17.74,12.69H37a5,5,0,0,1,5,5V43a4.37,4.37,0,0,1-4.37,4.37H17.74a1.67,1.67,0,0,1-1.67-1.67V14.35A1.67,1.67,0,0,1,17.74,12.69Z" style="fill:#ff664b;stroke:#fc2905;stroke-miterlimit:10;stroke-width:1.1655624461467282px"/><rect x="13.38" y="20.83" width="5.4" height="1.67" rx="0.83" ry="0.83" style="fill:#fc2905"/><rect x="13.38" y="29.17" width="5.4" height="1.67" rx="0.83" ry="0.83" style="fill:#fc2905"/><rect x="13.38" y="37.51" width="5.4" height="1.67" rx="0.83" ry="0.83" style="fill:#fc2905"/><rect x="21.68" y="12.55" width="1.45" height="34.83" style="fill:#fc2905"/></g></g></svg>',METERPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 2</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><path d="M24.17,48.94H15.66a.82.82,0,0,1-.63-.2.83.83,0,0,1-.18-.6c0-.25,0-.82.75-.82l.35,0h.47a3.07,3.07,0,0,0,.73-.08.82.82,0,0,0,.71-.92v-.54a10.61,10.61,0,0,1,0-1.13.38.38,0,0,0,0-.14h-2.7l-2.6,0h0l-.24,0-.33,0a.57.57,0,0,1-.61-.39,1.84,1.84,0,0,1,.17-1.61C12.3,41.45,13,40.25,13.65,39A17.71,17.71,0,0,0,16,31.32c0-.4,0-.81,0-1.2v-1l.41.15a6.58,6.58,0,0,0,2.28.39,12,12,0,0,0,3.24-.53l.65-.18-.29.61a53.29,53.29,0,0,1-8.73,13.18h4.31V38.91a.87.87,0,0,1,.22-.7,27.16,27.16,0,0,0,3.65-4.64l.26-.41.26.41a1.18,1.18,0,0,1,.15.75v.28q0,3.93,0,7.86a.73.73,0,0,0,0,.33h.21a5.06,5.06,0,0,1,.55,0h1a.67.67,0,0,1,.54.18.7.7,0,0,1,.12.59s0,.09,0,.13a.83.83,0,0,1-.12.69.63.63,0,0,1-.49.18H22.38v.12c0,.37,0,.75,0,1.12,0,.22,0,.45,0,.67,0,.54.21.78.72.85a4.44,4.44,0,0,0,.63,0h.54a.71.71,0,0,1,.53.18.79.79,0,0,1,.19.59c0,.59-.25.84-.82.84Z" style="fill:#f5a623"/><path d="M22,29.47a53.22,53.22,0,0,1-9.16,13.62h5.05c.35,0,.26-.25.26-.45,0-1.2,0-2.41,0-3.62,0-.2-.06-.42.12-.6A27,27,0,0,0,22,33.73a1.17,1.17,0,0,1,.09.72q0,4,0,8c0,.42.06.65.45.65h.14a4.43,4.43,0,0,1,.52,0h1.06c.48,0,.29.38.3.62s.11.54-.29.54H22.46c-.29,0-.4.1-.38.45,0,.59,0,1.18,0,1.77a1,1,0,0,0,1,1.16,5.27,5.27,0,0,0,.68,0h.54c.27,0,.42.07.41.46s-.11.53-.51.53H15.65c-.36,0-.5-.08-.49-.49s.07-.51.44-.51h0l.79,0a3.2,3.2,0,0,0,.81-.09,1.13,1.13,0,0,0,.94-1.22c0-.55,0-1.1,0-1.65s-.13-.47-.46-.47H12.56c-.17,0-.38.05-.56.05s-.28,0-.32-.18a1.54,1.54,0,0,1,.14-1.34c.75-1.16,1.45-2.35,2.1-3.58a18,18,0,0,0,2.38-7.85c0-.59,0-1.18,0-1.73a6.83,6.83,0,0,0,2.39.41A12.63,12.63,0,0,0,22,29.47m1.13-1-1.3.37a11.74,11.74,0,0,1-3.16.51A6.18,6.18,0,0,1,16.52,29l-.83-.31v1.42c0,.39,0,.78,0,1.18a17.37,17.37,0,0,1-2.31,7.58c-.65,1.21-1.35,2.4-2.08,3.54a2.15,2.15,0,0,0-.21,1.86.89.89,0,0,0,.91.61,2.33,2.33,0,0,0,.37,0l.19,0,2.61,0,2.39,0c0,.34,0,.66,0,1s0,.35,0,.53c0,.38-.12.53-.48.62a2.52,2.52,0,0,1-.66.07h-.78a1,1,0,0,0-1.1,1.11,1,1,0,0,0,1.11,1.12h8.51a1,1,0,0,0,1.15-1.14,1.12,1.12,0,0,0-.28-.82,1,1,0,0,0-.75-.27h-.54a5.28,5.28,0,0,1-.59,0c-.33,0-.44-.13-.45-.55v-.67q0-.45,0-.93h1.55a.93.93,0,0,0,.71-.29,1.05,1.05,0,0,0,.21-.85v-.07a.23.23,0,0,1,0-.07,1,1,0,0,0-.2-.82.91.91,0,0,0-.73-.29H23.18a3.93,3.93,0,0,0-.49,0h0c0-2.58,0-5.19,0-7.72v-.4a1.43,1.43,0,0,0-.19-.94L22,32.58l-.52.82A27,27,0,0,1,17.86,38a1.15,1.15,0,0,0-.3.94v3.54H14.25a53.72,53.72,0,0,0,8.32-12.73l.58-1.23Z" style="fill:#f09000"/><path d="M15.5,27a.61.61,0,0,1-.5-.19.67.67,0,0,1-.14-.56.48.48,0,0,0,0-.18.7.7,0,0,1,.13-.55.62.62,0,0,1,.46-.17l.74,0,.71,0c.66,0,1-.32,1-1,0-.21,0-.41,0-.62s0-.65,0-1a.47.47,0,0,0,0-.19h0a.72.72,0,0,0-.18,0l-2.54,0H12.47l-.21,0-.3,0a.53.53,0,0,1-.57-.36,1.89,1.89,0,0,1,.13-1.54l.37-.61c.57-.94,1.16-1.92,1.7-2.9A17.73,17.73,0,0,0,16,9.42a7.38,7.38,0,0,0,0-.94c0-.28,0-.56,0-.85V7.19l.41.15a6.59,6.59,0,0,0,2.33.4,14.55,14.55,0,0,0,3.24-.47l.62-.15-.27.58a53.14,53.14,0,0,1-8.72,13.13h2.16l2,0h0a.67.67,0,0,0,.19,0,.53.53,0,0,0,0-.2c0-.8,0-1.59,0-2.39V17.06a1.14,1.14,0,0,1,.31-.9,25.22,25.22,0,0,0,3.42-4.33.56.56,0,0,1,.14-.16l.28-.29.27.29a1.21,1.21,0,0,1,.12.71.76.76,0,0,0,0,.15v1c0,2.33,0,4.65,0,7,0,.25,0,.29,0,.29h0a.29.29,0,0,0,.14,0h.11l.47,0h1a.67.67,0,0,1,.54.18.71.71,0,0,1,.15.57v.14a.78.78,0,0,1-.15.66.61.61,0,0,1-.49.19H23l-.47,0h-.15a1.41,1.41,0,0,0,0,.18c0,.36,0,.72,0,1.08s0,.47,0,.71a.72.72,0,0,0,.76.82h.53a1.88,1.88,0,0,0,.34,0l.23,0a.7.7,0,0,1,.54.21,1,1,0,0,1,.19.82.6.6,0,0,1-.67.64H15.5Z" style="fill:#f5a623"/><path d="M22,7.57A53,53,0,0,1,13,21a.31.31,0,0,0,.28.13l.29,0h2.22c.64,0,1.28,0,1.91,0h0c.38,0,.49-.13.48-.54,0-1.18,0-2.37,0-3.56a.86.86,0,0,1,.22-.69A26.19,26.19,0,0,0,21.85,12a1.22,1.22,0,0,1,.16-.18,1.26,1.26,0,0,1,.07.71c0,2.67,0,5.34,0,8,0,.46.13.62.49.62h.14a3.24,3.24,0,0,1,.44,0h1.09c.44,0,.3.35.32.6s0,.52-.33.52H22.48c-.33,0-.42.16-.4.51,0,.6,0,1.19,0,1.78a1,1,0,0,0,1.06,1.13l.54,0,.38,0,.19,0c.39,0,.45.27.43.7s-.11.35-.37.35H15.5c-.42,0-.33-.27-.32-.51s-.12-.52.27-.52h1.46a1.16,1.16,0,0,0,1.26-1.3c0-.53,0-1.06,0-1.59s-.12-.52-.5-.52H12.47c-.15,0-.35.05-.51.05s-.24,0-.27-.15a1.59,1.59,0,0,1,.1-1.29c.7-1.17,1.42-2.33,2.07-3.53a18.19,18.19,0,0,0,2.45-7.9c0-.59-.06-1.18-.06-1.8A7,7,0,0,0,18.69,8,14.43,14.43,0,0,0,22,7.57m1.11-.9L21.85,7a13.84,13.84,0,0,1-3.16.46,6.3,6.3,0,0,1-2.23-.38l-.82-.29v.87a8.43,8.43,0,0,0,0,.87,7,7,0,0,1,0,.91A17.4,17.4,0,0,1,13.32,17c-.53,1-1.12,1.94-1.68,2.88l-.38.62a2.14,2.14,0,0,0-.16,1.78.83.83,0,0,0,.86.59l.35,0,.16,0,2.72,0,2.37,0c0,.3,0,.59,0,.88v.61c0,.52-.17.68-.67.7h-.71l-.67,0h-.06a.88.88,0,0,0-.68.27,1,1,0,0,0-.21.78v.14a.93.93,0,0,0,.21.79.94.94,0,0,0,.73.29h8.82a.9.9,0,0,0,1-.92A1.37,1.37,0,0,0,25,25.33a1,1,0,0,0-.77-.31l-.28,0-.29,0-.35,0h-.16c-.29,0-.47-.11-.48-.53v-.7c0-.31,0-.63,0-.95h1.52a.93.93,0,0,0,.72-.29,1.14,1.14,0,0,0,.23-.9.27.27,0,0,1,0-.09,1,1,0,0,0-.24-.8.9.9,0,0,0-.7-.28H23.14l-.45,0c0-2.34,0-4.72,0-7V12.4a1.45,1.45,0,0,0-.15-.88l-.42-.75-.58.63,0,0a.85.85,0,0,0-.18.22A24.94,24.94,0,0,1,18,15.94a1.43,1.43,0,0,0-.39,1.12c0,.39,0,.78,0,1.17,0,.77,0,1.54,0,2.31H14.25a53.81,53.81,0,0,0,8.3-12.7l.56-1.16Z" style="fill:#f09000"/><path d="M35.22,50.18l-.61,0a5.15,5.15,0,0,1-3.9-2A5.56,5.56,0,0,1,30,43.51a9,9,0,0,1,8.49-6.46,6.71,6.71,0,0,1,2.39.42l0-29.24A4.33,4.33,0,0,1,41,7.17a1.61,1.61,0,0,1,1.62-1.35,1.65,1.65,0,0,1,1.64,1.35,6,6,0,0,1,.07,1.1q0,16.85,0,33.64a2.32,2.32,0,0,0,0,.24,1.8,1.8,0,0,1-.38,1.47,9.92,9.92,0,0,1-3.14,4.57,9.17,9.17,0,0,1-5.54,2Z" style="fill:#f5a623"/><path d="M42.57,6.54h.06a.89.89,0,0,1,.87.77,4.67,4.67,0,0,1,.06,1q0,16.8,0,33.61c0,.43.17.94-.26,1.3a9.38,9.38,0,0,1-3,4.4,8.52,8.52,0,0,1-5.12,1.85l-.55,0c-3.1-.22-4.75-2.62-4-5.76a8.32,8.32,0,0,1,7.79-5.91,5.91,5.91,0,0,1,3.11.84l0-30.21a5.65,5.65,0,0,1,0-1.09.89.89,0,0,1,.92-.77m0-1.44A2.34,2.34,0,0,0,40.24,7a5.8,5.8,0,0,0-.08,1.21V8.4q0,12.94,0,25.9v2.21a7.72,7.72,0,0,0-1.68-.18,9.79,9.79,0,0,0-9.19,7,6.25,6.25,0,0,0,.86,5.24,5.83,5.83,0,0,0,4.43,2.28c.22,0,.45,0,.66,0a9.83,9.83,0,0,0,6-2.14A10.57,10.57,0,0,0,44.54,44,2.57,2.57,0,0,0,45,42.08a1,1,0,0,1,0-.17q0-16.8,0-33.61A6.88,6.88,0,0,0,44.92,7,2.33,2.33,0,0,0,42.69,5.1Z" style="fill:#f09000"/></g></g></svg>',MICEPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 22</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><g id="g4536"><path id="path4725" d="M24.85,31a2.42,2.42,0,0,0-.35-1.06,3,3,0,0,0-2.11-.71c-1.11,0-2.07.88-3.17,1.06a6.23,6.23,0,0,1-2.11,0c-1.09-.18-2-1.06-3.16-1.06a3,3,0,0,0-2.11.71,2.9,2.9,0,0,0-.7,2.13c.4,1.43.07.52,0,1.42A10.68,10.68,0,0,0,9,34.91c-.94,1-1.76,3.19-2.11,3.54s-.3,2.87,0,4.26A8.64,8.64,0,0,0,9,46.41a7.73,7.73,0,0,0,3.69,2.43,6.37,6.37,0,0,0,2.67.26A10.24,10.24,0,0,0,19.22,48,6.59,6.59,0,0,0,21,46.26c.42-.54.49-1.39,1.06-1.77s1.68-.06,2.46-.36,1.8-.62,2.11-1.42-.5-1.88-.71-2.84a10.66,10.66,0,0,1-.35-1.77,20.5,20.5,0,0,1,.35-3.9,6.61,6.61,0,0,0,.35-1.78,2,2,0,0,0-.7-1.42c-.2-.12-.7,0-.7,0" style="fill:#92a9ff;stroke:#5370dc;stroke-width:0.4994235330523765px"/><path id="path4505-6" d="M22.3,44.24a15.24,15.24,0,0,1-2.67,3.4,7.67,7.67,0,0,1-4.42,1.62,6.56,6.56,0,0,1-3.46-.77,14.91,14.91,0,0,1-2.62-2,15.1,15.1,0,0,1-2-2.65,6.83,6.83,0,0,1-.77-3.48A8,8,0,0,1,8,35.91a15,15,0,0,1,3.37-2.69M18,35.81s-3.1.21-4.48-.46a4.17,4.17,0,0,1-2.11-2.13,3.71,3.71,0,0,1,.27-3.11A2.63,2.63,0,0,1,14.46,29c1.26.19,2.2,1,3.38,1.23,1.51.25,2.91-.88,4.44-.93a15.7,15.7,0,0,1,3.28.6,16.15,16.15,0,0,1,.59,3.31c0,1.54-1.17,2.95-.92,4.49.19,1.18,1.08,2.13,1.29,3.38A2.7,2.7,0,0,1,25.38,44a3.57,3.57,0,0,1-3.08.27,4.19,4.19,0,0,1-2.12-2.13c-.65-1.39-.45-4.52-.45-4.52" style="fill:none;stroke:#5370dc;stroke-linecap:round;stroke-width:0.9760086686920225px"/><g id="g4565"><g id="g4553"><path id="path3411-7" d="M21.08,31.94c-1.42-.84-2.07-3.88-2.16-4.84" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/><path id="path3413-5" d="M22.12,31.22a8.37,8.37,0,0,1-1.58-4" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/></g><g id="g4557"><path id="path3411-3" d="M23.57,34.45c.83,1.44,3.84,2.09,4.79,2.18" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/><path id="path3413-56" d="M24.28,33.4a8.17,8.17,0,0,0,4,1.59" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/></g></g><g id="g4636"><ellipse id="circle3409-2" cx="19.34" cy="33.63" rx="0.98" ry="0.94" transform="matrix(0.63, -0.78, 0.78, 0.63, -18.97, 27.52)" style="fill:none;stroke:#5370dc;stroke-width:0.9988469470329054px"/><ellipse id="ellipse4229-9" cx="21.86" cy="36.24" rx="0.98" ry="0.94" transform="translate(-20.06 30.44) rotate(-51.03)" style="fill:none;stroke:#5370dc;stroke-width:0.9988469470329054px"/></g><g id="g4632"><path id="path4303-1" d="M17.14,31.42c-6-4.17-7,3.59-.22,3.33" style="fill:none;stroke:#5370dc;stroke-width:0.4994235330523765px"/><path id="path4303-1-2" d="M24.09,38.43c4.12,6-3.57,7-3.3.22" style="fill:none;stroke:#5370dc;stroke-width:0.4994235330523765px"/></g><path id="path4227-7" d="M26.41,30.8c-.94,0-1.53.14-1.7,0s-.07-.83,0-1.72c0-.72,1.23-.45,1.71,0S27.15,30.82,26.41,30.8Z" style="fill:#92a9ff;stroke:#5370dc;stroke-width:1.080668001658815px"/><path id="path4653" d="M9.35,46.73S8.5,48.09,10,50s5.47,2.84,8.54,1.88S23.41,48.63,26,46.5" style="fill:none;stroke:#5370dc;stroke-linecap:round;stroke-width:0.9760086686920225px"/></g><g id="g4536-2" data-name="g4536"><path id="path4725-2" data-name="path4725" d="M31.15,25a2.42,2.42,0,0,0,.35,1.06,3,3,0,0,0,2.11.71c1.11,0,2.07-.88,3.17-1.06a6.23,6.23,0,0,1,2.11,0c1.09.18,2,1.06,3.16,1.06a3,3,0,0,0,2.11-.71,2.9,2.9,0,0,0,.7-2.13c-.4-1.43-.07-.52,0-1.42A10.68,10.68,0,0,0,47,21.09c.94-1,1.76-3.19,2.11-3.54s.3-2.87,0-4.26A8.64,8.64,0,0,0,47,9.59a7.73,7.73,0,0,0-3.69-2.43,6.37,6.37,0,0,0-2.67-.26A10.24,10.24,0,0,0,36.78,8,6.59,6.59,0,0,0,35,9.74c-.42.54-.49,1.39-1.06,1.77s-1.68.06-2.46.36-1.8.62-2.11,1.42.5,1.88.71,2.84a10.66,10.66,0,0,1,.35,1.77,20.5,20.5,0,0,1-.35,3.9,6.61,6.61,0,0,0-.35,1.78,2,2,0,0,0,.7,1.42c.2.12.7,0,.7,0" style="fill:#92a9ff;stroke:#5370dc;stroke-width:0.4994235330523765px"/><path id="path4505-6-2" data-name="path4505-6" d="M33.7,11.76a15.24,15.24,0,0,1,2.67-3.4,7.67,7.67,0,0,1,4.42-1.62,6.56,6.56,0,0,1,3.46.77,14.91,14.91,0,0,1,2.62,2,15.1,15.1,0,0,1,2,2.65,6.83,6.83,0,0,1,.77,3.48A8,8,0,0,1,48,20.09a15,15,0,0,1-3.37,2.69M38,20.19s3.1-.21,4.48.46a4.17,4.17,0,0,1,2.11,2.13,3.71,3.71,0,0,1-.27,3.11A2.63,2.63,0,0,1,41.54,27c-1.26-.19-2.2-1-3.38-1.23-1.51-.25-2.91.88-4.44.93a15.7,15.7,0,0,1-3.28-.6,16.15,16.15,0,0,1-.59-3.31c0-1.54,1.17-3,.92-4.49-.19-1.18-1.08-2.13-1.29-3.38A2.7,2.7,0,0,1,30.62,12a3.57,3.57,0,0,1,3.08-.27,4.19,4.19,0,0,1,2.12,2.13c.65,1.39.45,4.52.45,4.52" style="fill:none;stroke:#5370dc;stroke-linecap:round;stroke-width:0.9760086686920225px"/><g id="g4565-2" data-name="g4565"><g id="g4553-2" data-name="g4553"><path id="path3411-7-2" data-name="path3411-7" d="M34.92,24.06c1.42.84,2.07,3.88,2.16,4.84" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/><path id="path3413-5-2" data-name="path3413-5" d="M33.88,24.78a8.37,8.37,0,0,1,1.58,4" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/></g><g id="g4557-2" data-name="g4557"><path id="path3411-3-2" data-name="path3411-3" d="M32.43,21.55c-.83-1.44-3.84-2.09-4.79-2.18" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/><path id="path3413-56-2" data-name="path3413-56" d="M31.72,22.6a8.17,8.17,0,0,0-4-1.59" style="fill:none;stroke:#5370dc;stroke-width:0.9649127798239797px"/></g></g><g id="g4636-2" data-name="g4636"><ellipse id="circle3409-2-2" data-name="circle3409-2" cx="36.66" cy="22.37" rx="0.98" ry="0.94" transform="translate(-3.79 36.8) rotate(-51.03)" style="fill:none;stroke:#5370dc;stroke-width:0.9988469470329054px"/><ellipse id="ellipse4229-9-2" data-name="ellipse4229-9" cx="34.14" cy="19.76" rx="0.98" ry="0.94" transform="translate(-2.7 33.88) rotate(-51.03)" style="fill:none;stroke:#5370dc;stroke-width:0.9988469470329054px"/></g><g id="g4632-2" data-name="g4632"><path id="path4303-1-2-2" data-name="path4303-1" d="M38.86,24.58c6,4.17,7-3.59.22-3.33" style="fill:none;stroke:#5370dc;stroke-width:0.4994235330523765px"/><path id="path4303-1-2-3" data-name="path4303-1-2" d="M31.91,17.57c-4.12-6,3.57-7,3.3-.22" style="fill:none;stroke:#5370dc;stroke-width:0.4994235330523765px"/></g><path id="path4227-7-2" data-name="path4227-7" d="M29.59,25.2c.94,0,1.53-.14,1.7,0s.07.83,0,1.72c0,.72-1.23.45-1.71,0S28.85,25.18,29.59,25.2Z" style="fill:#92a9ff;stroke:#5370dc;stroke-width:1.080668001658815px"/><path id="path4653-2" data-name="path4653" d="M46.65,9.27S47.5,7.91,46,6s-5.47-2.84-8.54-1.88S32.59,7.37,30.05,9.5" style="fill:none;stroke:#5370dc;stroke-linecap:round;stroke-width:0.9760086686920225px"/></g></g></g></svg>',TURTLESPALETTEICON=MICEPALETTEICON,COLLAPSEBUTTON='<svg width="42" height="42" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><title> 29</title><g style="isolation:isolate"><g id="_2" data-name=" 2"><g id="Icon"><rect width="42" height="42" rx="5" ry="5" style="fill:#292929;opacity:0.4;mix-blend-mode:multiply"/><path d="M30.56,29.8l-4.17-4.16h2.26a1,1,0,1,0,0-2.07H23.94a1.08,1.08,0,0,0-1.11,1v0s0,0,0,.06v4.64h0a1,1,0,1,0,2.08,0V27.08l4.19,4.19a1,1,0,0,0,1.46,0A1,1,0,0,0,30.56,29.8Z" style="fill:#fff"/><path d="M19.17,24.6a1.08,1.08,0,0,0-1.11-1H13.35a1,1,0,1,0,0,2.07H15.6L11.44,29.8a1,1,0,0,0,1.47,1.47l4.18-4.19v2.26a1,1,0,1,0,2.08,0V24.7s0,0,0-.06A.08.08,0,0,1,19.17,24.6Z" style="fill:#fff"/><path d="M23.94,20.5h4.7a1,1,0,1,0,0-2.08H26.39l4.17-4.16a1,1,0,0,0,0-1.47,1,1,0,0,0-1.46,0L24.91,17V14.72a1,1,0,1,0-2.08,0v4.64a.43.43,0,0,0,0,.05v.05A1.09,1.09,0,0,0,23.94,20.5Z" style="fill:#fff"/><path d="M18.13,13.62a1.08,1.08,0,0,0-1,1.09V17l-4.18-4.19a1,1,0,0,0-1.47,0,1,1,0,0,0,0,1.46l4.16,4.17H13.35a1,1,0,1,0,0,2.08h4.71a1.09,1.09,0,0,0,1.11-1,.08.08,0,0,1,0,0s0,0,0-.06V14.71A1.07,1.07,0,0,0,18.13,13.62Z" style="fill:#fff"/></g></g></g></svg>',EXPANDBUTTON='<svg width="42" height="42" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><title> 28</title><g style="isolation:isolate"><g id="_2" data-name=" 2"><g id="Icon"><rect width="42" height="42" rx="5" ry="5" style="fill:#292929;opacity:0.4;mix-blend-mode:multiply"/><path d="M30.86,25.8h0a1.06,1.06,0,0,0-1-1.1,1.08,1.08,0,0,0-1,1.1v2.26L24.6,23.87a1,1,0,0,0-1.46,0,1,1,0,0,0,0,1.47L27.3,29.5H25.05a1,1,0,1,0,0,2.08h4.71a1.07,1.07,0,0,0,1.1-1V25.8Z" style="fill:#fff"/><path d="M17.4,23.87l-4.19,4.19V25.8a1.08,1.08,0,0,0-1-1.1,1.06,1.06,0,0,0-1,1.1v4.74a1.07,1.07,0,0,0,1.1,1H17a1,1,0,1,0,0-2.08H14.7l4.16-4.16a1,1,0,0,0,0-1.47A1,1,0,0,0,17.4,23.87Z" style="fill:#fff"/><path d="M24.6,20.19,28.79,16v2.27a1.08,1.08,0,0,0,1,1.09,1.06,1.06,0,0,0,1-1.09V13.52a1.06,1.06,0,0,0-1.1-1H25.05a1,1,0,1,0,0,2.07H27.3l-4.16,4.17a1,1,0,0,0,1.46,1.46Z" style="fill:#fff"/><path d="M14.7,14.56H17a1,1,0,1,0,0-2.07H12.24a1.06,1.06,0,0,0-1.1,1v4.75a1.06,1.06,0,0,0,1,1.09,1.08,1.08,0,0,0,1-1.09V16l4.19,4.18a1,1,0,0,0,1.46-1.46Z" style="fill:#fff"/></g></g></g></svg>',MOUSEPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 20</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><g id="g4536"><path id="path4725" d="M26.85,12.59a3.36,3.36,0,0,0-1.41-.71,4.25,4.25,0,0,0-2.81,1.43c-1.12,1.14-1.2,3-2.12,4.31a9.36,9.36,0,0,1-2.11,2.15c-1.28.94-3.11,1-4.23,2.15a4.43,4.43,0,0,0-1.41,2.88,4.15,4.15,0,0,0,1.41,2.87c1.83,1,.59.46,1.41,1.43a16,16,0,0,0-.7,3.59c0,2,1.41,5,1.41,5.74s2.55,3.21,4.22,4.31a11.88,11.88,0,0,0,5.75,1.62A10.76,10.76,0,0,0,32.37,43a8.93,8.93,0,0,0,2.94-2.45,15.15,15.15,0,0,0,2.81-5,9.42,9.42,0,0,0,0-3.59c-.11-1-.89-1.9-.7-2.87.23-1.17,1.63-1.78,2.11-2.87s1.19-2.47.71-3.59-2.37-1.4-3.53-2.15a15.11,15.11,0,0,1-2.11-1.44,29.21,29.21,0,0,1-3.52-4.3c-.51-.69-.74-1.63-1.41-2.16a2.67,2.67,0,0,0-2.11-.71c-.33.07-.71.71-.71.71" style="fill:#92a9ff;stroke:#5370dc;stroke-width:0.7110743593067895px"/><path id="path4505-6" d="M37.43,28.59s1,4.12.71,6.16a11.4,11.4,0,0,1-2.82,6.16,9.37,9.37,0,0,1-4.23,2.74,21.07,21.07,0,0,1-4.59.68,21,21,0,0,1-4.59-.68,9.37,9.37,0,0,1-4.23-2.74,11.33,11.33,0,0,1-2.82-6.16c-.33-2,.7-6.16.7-6.16m9.17-4.11s-2.9,3.38-4.94,4.11a5.83,5.83,0,0,1-4.23,0,5.23,5.23,0,0,1-2.82-3.43,3.82,3.82,0,0,1,1.74-4c1.46-1.1,3.24-1.2,4.61-2.2,1.77-1.29,2.05-3.87,3.52-5.47a23.17,23.17,0,0,1,3.89-2.74,22.8,22.8,0,0,1,3.88,2.74c1.48,1.6,1.76,4.18,3.53,5.47,1.37,1,3.2,1.06,4.65,2.1a3.9,3.9,0,0,1,1.7,4.06,5.22,5.22,0,0,1-2.83,3.43,5.82,5.82,0,0,1-4.23,0c-2-.73-4.93-4.11-4.93-4.11" style="fill:none;stroke:#5370dc;stroke-linecap:round;stroke-width:1.389631630945327px"/><g id="g4565"><g id="g4553"><path id="path3411-7" d="M24,17.39c-2.25.61-5.92-1.81-7-2.69" style="fill:none;stroke:#5370dc;stroke-width:1.37383341250824px"/><path id="path3413-5" d="M24.33,15.6a11.44,11.44,0,0,1-5.55-2.44" style="fill:none;stroke:#5370dc;stroke-width:1.37383341250824px"/></g><g id="g4557"><path id="path3411-3" d="M29,17.39c2.25.61,5.92-1.81,7-2.69" style="fill:none;stroke:#5370dc;stroke-width:1.37383341250824px"/><path id="path3413-56" d="M28.67,15.6a11.48,11.48,0,0,0,5.55-2.44" style="fill:none;stroke:#5370dc;stroke-width:1.37383341250824px"/></g></g><g id="g4636"><ellipse id="circle3409-2" cx="23.94" cy="20.88" rx="1.33" ry="1.41" style="fill:none;stroke:#5370dc;stroke-width:1.4221485490802457px"/><ellipse id="ellipse4229-9" cx="29.05" cy="20.94" rx="1.33" ry="1.41" style="fill:none;stroke:#5370dc;stroke-width:1.4221485490802457px"/></g><g id="g4632"><path id="path4303-1" d="M19.53,20.89c-10.11,1.88-3.39,10.72,3.09,3.59" style="fill:none;stroke:#5370dc;stroke-width:0.7110743593067895px"/><path id="path4303-1-2" d="M33.46,20.89c10.12,1.88,3.39,10.72-3.08,3.59" style="fill:none;stroke:#5370dc;stroke-width:0.7110743593067895px"/></g><path id="path4227-7" d="M28.22,10.79c-1,.94-1.4,1.71-1.73,1.71s-.9-.77-1.74-1.71c-.68-.77.78-1.71,1.74-1.71S29,10.06,28.22,10.79Z" style="fill:#92a9ff;stroke:#5370dc;stroke-width:1.5386445692824375px"/><path id="path4653" d="M26.93,44.33s.51,2.24,3.88,2.63,8.3-2.71,10.41-6.82,1.7-8.25,2.12-13" style="fill:none;stroke:#5370dc;stroke-linecap:round;stroke-width:1.389631630945327px"/></g></g></g></svg>',TURTLEPALETTEICON=MOUSEPALETTEICON,NOGRIDBUTTON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><title> 32</title><g style="isolation:isolate"><g id="_2" data-name=" 2"><g id="Icon"><rect width="42" height="42" rx="5" ry="5" style="fill:#292929;opacity:0.4;mix-blend-mode:multiply"/><path d="M31.73,21a10.36,10.36,0,0,1-5.36,9,11,11,0,0,1-10.74,0,10.27,10.27,0,0,1,0-18,11,11,0,0,1,10.74,0A10.36,10.36,0,0,1,31.73,21Z" style="fill:none;stroke:#d8d8d8;stroke-linecap:square;stroke-miterlimit:10;stroke-width:1.36741304397583px"/><line x1="21" y1="8.37" x2="21" y2="33.63" style="fill:none;stroke:#d8d8d8;stroke-linecap:square;stroke-miterlimit:10;stroke-width:1.36741304397583px"/><line x1="33.63" y1="21" x2="8.37" y2="21" style="fill:none;stroke:#d8d8d8;stroke-linecap:square;stroke-miterlimit:10;stroke-width:1.36741304397583px"/><rect x="10.98" y="10.98" width="20.04" height="20.04" style="fill:none;stroke:#d8d8d8;stroke-linecap:square;stroke-miterlimit:10;stroke-width:1.36741304397583px"/></g></g></g></svg>',NUMBERPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 14</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M13.19,37.65a1,1,0,0,1-1-1V24.36l-1.87.39-.2,0a1,1,0,0,1-1-.8L9,22.65a1,1,0,0,1,.29-.9l4.21-3.4H15.6a1,1,0,0,1,1,1V36.64a1,1,0,0,1-1,1Z" style="fill:#ff6ea1"/><path d="M15.6,18.85a.52.52,0,0,1,.51.51V36.64a.52.52,0,0,1-.51.51H13.19a.52.52,0,0,1-.53-.51V23.75l-2.47.51h-.1a.45.45,0,0,1-.46-.36l-.17-1.32a.53.53,0,0,1,.14-.48l4-3.26h2m0-1H13.29l-.28.22L9,21.33l0,0,0,0a1.54,1.54,0,0,0-.44,1.34L8.64,24a1.44,1.44,0,0,0,1.45,1.23,1.63,1.63,0,0,0,.31,0L11.66,25V36.64a1.53,1.53,0,0,0,1.53,1.51H15.6a1.52,1.52,0,0,0,1.51-1.51V19.36a1.52,1.52,0,0,0-1.51-1.51Z" style="fill:#ff2c76"/><path d="M20.12,37.65a1,1,0,0,1-1-1v-.81l.12-.14c1.82-2.11,5.33-6.5,7.25-8.94a4.6,4.6,0,0,0,1.32-2.68c0-1-.76-1.95-2.47-1.95a4.17,4.17,0,0,0-2.78,1.44,1,1,0,0,1-1.47,0l-1.34-1.29a1,1,0,0,1,0-1.4,8.27,8.27,0,0,1,5.89-2.8c4,0,6.76,2.41,6.76,5.86,0,1.93-.87,3.13-2,4.65-1,1.36-2.57,3.26-4,4.95l-.19.23h5a1,1,0,0,1,1,1v1.86a1,1,0,0,1-1,1Z" style="fill:#ff6ea1"/><path d="M25.56,18.58c4,0,6.26,2.45,6.26,5.36,0,1.75-.79,2.85-1.88,4.36s-3.34,4.17-4.83,6h6.06a.55.55,0,0,1,.54.51v1.86a.55.55,0,0,1-.54.51h-11a.52.52,0,0,1-.53-.51V36c1.85-2.15,5.38-6.57,7.26-9a5,5,0,0,0,1.43-3c0-1.21-1-2.45-3-2.45a4.65,4.65,0,0,0-3.14,1.59.53.53,0,0,1-.76,0l-1.35-1.29a.52.52,0,0,1,0-.7,7.83,7.83,0,0,1,5.52-2.64m0-1a8.84,8.84,0,0,0-6.29,3,1.51,1.51,0,0,0,.1,2.06l1.35,1.29a1.5,1.5,0,0,0,1.07.44,1.51,1.51,0,0,0,1.07-.44,3.86,3.86,0,0,1,2.45-1.31c1.46,0,2,.78,2,1.45a4.13,4.13,0,0,1-1.19,2.34c-1.93,2.46-5.44,6.84-7.26,9l-.24.28v1a1.53,1.53,0,0,0,1.53,1.51H31.17a1.55,1.55,0,0,0,1.54-1.51V34.78a1.55,1.55,0,0,0-1.54-1.51H27.24c1.27-1.53,2.62-3.17,3.5-4.38,1.12-1.54,2.08-2.86,2.08-4.95,0-3.74-3-6.36-7.26-6.36Z" style="fill:#ff2c76"/><path d="M40.1,37.92a8,8,0,0,1-6.21-2.57,1,1,0,0,1,0-1.33l1.46-1.36a1.07,1.07,0,0,1,.71-.29,1,1,0,0,1,.7.3A5.59,5.59,0,0,0,39.9,34a2.32,2.32,0,0,0,2.47-2c0-1.05-1-2.17-3.37-2.17H37.43a1,1,0,0,1-1-1V27.06a1,1,0,0,1,1-1H39c1.84,0,3-.76,3-2a2.1,2.1,0,0,0-2.22-2,3.19,3.19,0,0,0-2.46,1.12,1,1,0,0,1-.76.35,1.12,1.12,0,0,1-.7-.27L34.46,22a.87.87,0,0,1-.32-.68,1,1,0,0,1,.31-.75,8.18,8.18,0,0,1,5.62-2.51c3.75,0,6.47,2.28,6.47,5.43a5.25,5.25,0,0,1-2.39,4.21,5.28,5.28,0,0,1,2.9,4.45C47.05,35.55,44.19,37.92,40.1,37.92Z" style="fill:#ff6ea1"/><path d="M40.07,18.58c3.25,0,6,1.91,6,4.93a4.87,4.87,0,0,1-2.89,4.19v.08c1.32.54,3.4,2,3.4,4.39,0,3-2.58,5.25-6.45,5.25A7.37,7.37,0,0,1,34.26,35a.51.51,0,0,1,0-.67L35.72,33a.57.57,0,0,1,.37-.16.5.5,0,0,1,.36.16,6,6,0,0,0,3.45,1.45,2.79,2.79,0,0,0,3-2.52c0-1.4-1.34-2.67-3.87-2.67H37.43a.51.51,0,0,1-.53-.54V27.06a.48.48,0,0,1,.53-.54H39c2.3,0,3.48-1.1,3.48-2.48a2.57,2.57,0,0,0-2.72-2.47,3.66,3.66,0,0,0-2.83,1.29.55.55,0,0,1-.39.18.59.59,0,0,1-.37-.15l-1.38-1.24a.48.48,0,0,1,0-.7,7.8,7.8,0,0,1,5.28-2.37m0-1a8.8,8.8,0,0,0-6,2.67,1.5,1.5,0,0,0-.43,1.11,1.42,1.42,0,0,0,.51,1.05l1.35,1.22a1.59,1.59,0,0,0,1,.41,1.53,1.53,0,0,0,1.12-.51,2.73,2.73,0,0,1,2.1-1A1.59,1.59,0,0,1,41.48,24c0,1.09-1.28,1.48-2.48,1.48H37.43a1.48,1.48,0,0,0-1.53,1.54v1.69a1.51,1.51,0,0,0,1.53,1.54H39c1.69,0,2.87.69,2.87,1.67s-1,1.52-2,1.52a5.08,5.08,0,0,1-2.71-1.12l0,0a1.51,1.51,0,0,0-1-.44,1.57,1.57,0,0,0-1,.4l-1.46,1.35,0,0,0,0a1.5,1.5,0,0,0,0,2,8.48,8.48,0,0,0,6.58,2.73c4.38,0,7.45-2.57,7.45-6.25A5.56,5.56,0,0,0,45,27.68a5.58,5.58,0,0,0,2-4.17c0-3.44-2.93-5.93-7-5.93Z" style="fill:#ff2c76"/></g></g></svg>',PENPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 21</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M39.58,9.75,11.52,37.53a1.94,1.94,0,0,0-.5.85L9,45.6a1,1,0,0,0,1.18,1.17l7.29-2a1.81,1.81,0,0,0,.86-.49L46.43,16.53a1.9,1.9,0,0,0,0-2.71L42.32,9.75A2,2,0,0,0,39.58,9.75Z" style="fill:#92a9ff;stroke:#5370dc;stroke-width:1.399999976158142px"/><line x1="36.16" y1="12.81" x2="43.35" y2="19.92" style="fill:#92a9ff;stroke:#5370dc;stroke-width:1.399999976158142px"/></g></g></svg>',PITCHPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 3</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><rect x="8" y="43.16" width="40" height="1.17" style="fill:#57ad02"/><rect x="8" y="36.28" width="40" height="1.17" style="fill:#57ad02"/><rect x="8" y="29.41" width="40" height="1.17" style="fill:#57ad02"/><rect x="8" y="22.54" width="40" height="1.17" style="fill:#57ad02"/><rect x="8" y="15.66" width="40" height="1.17" style="fill:#57ad02"/><path d="M12.77,44h-.36a3.16,3.16,0,0,1-2.36-1.22,3.45,3.45,0,0,1-.48-2.88,5.31,5.31,0,0,1,5-3.87,4.17,4.17,0,0,1,1,.12l0-16a3.58,3.58,0,0,1,0-.75,1.19,1.19,0,0,1,1.2-1,1.21,1.21,0,0,1,1.2,1,3.6,3.6,0,0,1,0,.66V39.2a1.3,1.3,0,0,1-.24,1A5.9,5.9,0,0,1,16,42.86,5.33,5.33,0,0,1,12.77,44Z" style="fill:#7cd622"/><path d="M16.82,19.17h0a.49.49,0,0,1,.48.44,3.44,3.44,0,0,1,0,.56V39.09c0,.24.09.53-.14.73a5.35,5.35,0,0,1-1.63,2.48,4.67,4.67,0,0,1-2.82,1h-.31a2.43,2.43,0,0,1-2.21-3.25,4.6,4.6,0,0,1,4.3-3.32,3.24,3.24,0,0,1,1.71.47q0-8.5,0-17a3.12,3.12,0,0,1,0-.61.49.49,0,0,1,.51-.44m0-1.4a1.9,1.9,0,0,0-1.89,1.56,3.93,3.93,0,0,0,0,.8V35.37h-.31a6,6,0,0,0-5.66,4.41,4.16,4.16,0,0,0,.59,3.45,3.85,3.85,0,0,0,2.87,1.51h.42a6,6,0,0,0,3.66-1.32,6.5,6.5,0,0,0,2-2.87,2.1,2.1,0,0,0,.32-1.41v-19a4,4,0,0,0-.06-.82,1.91,1.91,0,0,0-1.79-1.58h-.09Z" style="fill:#57ad02"/><path d="M26.1,40.78h-.36a3.13,3.13,0,0,1-2.36-1.22,3.48,3.48,0,0,1-.48-2.88,5.33,5.33,0,0,1,5-3.87,3.8,3.8,0,0,1,1,.13V17a4.41,4.41,0,0,1,0-.75,1.19,1.19,0,0,1,1.2-1,1.2,1.2,0,0,1,1.2,1,3.71,3.71,0,0,1,0,.67c0,6.33,0,12.63,0,18.94v.11a1.3,1.3,0,0,1-.25,1,5.75,5.75,0,0,1-1.81,2.66,5.27,5.27,0,0,1-3.24,1.18Z" style="fill:#7cd622"/><path d="M30.15,15.92h0a.48.48,0,0,1,.48.43,2.59,2.59,0,0,1,0,.56q0,9.47,0,18.92c0,.25.1.53-.14.73A5.3,5.3,0,0,1,28.92,39a4.61,4.61,0,0,1-2.82,1h-.31a2.41,2.41,0,0,1-2.2-3.24,4.61,4.61,0,0,1,4.29-3.33A3.22,3.22,0,0,1,29.6,34q0-8.5,0-17a3.12,3.12,0,0,1,0-.61.5.5,0,0,1,.51-.43m0-1.4a1.87,1.87,0,0,0-1.88,1.56,3.88,3.88,0,0,0-.06.79V32.11h-.32a6,6,0,0,0-5.66,4.41A4.15,4.15,0,0,0,22.81,40a3.82,3.82,0,0,0,2.88,1.51h.41a6,6,0,0,0,3.66-1.32,6.35,6.35,0,0,0,2-2.87,2.12,2.12,0,0,0,.33-1.41v-.06q0-9.45,0-18.91a4.06,4.06,0,0,0-.06-.82,1.89,1.89,0,0,0-1.8-1.57h-.09Z" style="fill:#57ad02"/><path d="M39.43,37.53l-.36,0a3.13,3.13,0,0,1-2.36-1.22,3.44,3.44,0,0,1-.47-2.88,5.32,5.32,0,0,1,5-3.87,4.17,4.17,0,0,1,1,.13V13.61a3,3,0,0,1,0-.65,1.18,1.18,0,0,1,1.19-1,1.2,1.2,0,0,1,1.2,1,3.78,3.78,0,0,1,0,.67q0,9.49,0,18.94v.11a1.37,1.37,0,0,1-.24,1,5.88,5.88,0,0,1-1.82,2.65,5.26,5.26,0,0,1-3.24,1.19Z" style="fill:#7cd622"/><path d="M43.48,12.66h0a.5.5,0,0,1,.49.43,3.44,3.44,0,0,1,0,.56q0,9.47,0,18.92c0,.25.1.53-.13.74a5.36,5.36,0,0,1-1.64,2.47,4.59,4.59,0,0,1-2.82,1h-.31a2.42,2.42,0,0,1-2.2-3.25,4.61,4.61,0,0,1,4.3-3.33,3.21,3.21,0,0,1,1.71.48q0-8.5,0-17a3.18,3.18,0,0,1,0-.62.5.5,0,0,1,.51-.43m0-1.4a1.89,1.89,0,0,0-1.88,1.56,4,4,0,0,0-.06.79V28.85h-.31a6,6,0,0,0-5.66,4.41,4.11,4.11,0,0,0,.59,3.46A3.84,3.84,0,0,0,39,38.21l.41,0a6,6,0,0,0,3.66-1.33,6.35,6.35,0,0,0,2-2.87,2,2,0,0,0,.33-1.4v-.07q0-9.44,0-18.91a4.11,4.11,0,0,0-.06-.82,1.89,1.89,0,0,0-1.8-1.57h-.09Z" style="fill:#57ad02"/></g></g></svg>',PLAYBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="55" height="55" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg10" version="1.1" viewBox="0 0 28 28"> <title id="title2"> 23</title> <circle id="circle4" style="fill:#ffffff;stroke-width:0.9285714" r="13" cy="14" cx="14" /> <path id="path6" style="fill:#0050a0" d="M 18.9,13.56 11.65,9 A 1,1 0 0 0 10.09,9.86 V 19 a 1,1 0 0 0 1.56,0.86 l 7.25,-4.54 a 1,1 0 0 0 0,-1.76 z" /> </svg>',POLARBUTTON='<svg width="42" height="42" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><title> 31</title><g style="isolation:isolate"><g id="_2" data-name=" 2"><g id="Icon"><rect width="42" height="42" rx="5" ry="5" style="fill:#292929;opacity:0.4;mix-blend-mode:multiply"/><path d="M31.73,21a10.36,10.36,0,0,1-5.36,9,11,11,0,0,1-10.74,0,10.27,10.27,0,0,1,0-18,11,11,0,0,1,10.74,0A10.36,10.36,0,0,1,31.73,21Z" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><line x1="21" y1="8.37" x2="21" y2="33.63" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><line x1="33.63" y1="21" x2="8.37" y2="21" style="fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:1.6257020235061646px"/><rect x="10.98" y="10.98" width="20.04" height="20.04" style="fill:none;stroke:#d8d8d8;stroke-linecap:square;stroke-miterlimit:10;stroke-width:1.36741304397583px"/></g></g></g></svg>',RHYTHMPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 1</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M7.24,42.72a4.17,4.17,0,0,1-.61,0A3.47,3.47,0,0,1,4,41a3.77,3.77,0,0,1-.14-3.37A6.37,6.37,0,0,1,9.49,34,4.6,4.6,0,0,1,11,34.2V14.88a2.68,2.68,0,0,1,.1-.78,1.07,1.07,0,0,1,1.05-.82h0a1.16,1.16,0,0,1,1.14.75,2.1,2.1,0,0,1,.13.85V37.16A1.82,1.82,0,0,1,13,38.58a6.21,6.21,0,0,1-5.75,4.14ZM10,35.66A6.48,6.48,0,0,0,5.67,39.9a.67.67,0,0,0,.12.56.8.8,0,0,0,.61.35l.12,0a6.18,6.18,0,0,0,4.13-3.59,5.85,5.85,0,0,0,.22-.56l0-.13A1,1,0,0,0,10.6,36a1,1,0,0,0-.58-.33Z" style="fill:#f5a623"/><path d="M12.18,13.78a.67.67,0,0,1,.65.44,2,2,0,0,1,.08.72V37.16c0,.42,0,.85-.37,1.14a5.65,5.65,0,0,1-5.3,3.92,5.09,5.09,0,0,1-.55,0,3,3,0,0,1-2.4-4.33,5.82,5.82,0,0,1,5.2-3.39,3.75,3.75,0,0,1,1.83.44.54.54,0,0,0,.19,0v-20a2.73,2.73,0,0,1,.07-.64.6.6,0,0,1,.58-.46h0M6.4,41.31a1.07,1.07,0,0,0,.25,0,6.75,6.75,0,0,0,4.46-3.86,7.5,7.5,0,0,0,.31-.84A1.67,1.67,0,0,0,10,35.15a.45.45,0,0,0-.2,0,7,7,0,0,0-4.63,4.56A1.29,1.29,0,0,0,6.4,41.31m5.78-28.54h0A1.58,1.58,0,0,0,10.61,14a3.2,3.2,0,0,0-.11.91V33.54a5.5,5.5,0,0,0-1-.09,6.8,6.8,0,0,0-6.14,4,4.31,4.31,0,0,0,.18,3.82,3.94,3.94,0,0,0,3,1.89,5,5,0,0,0,.67,0,6.66,6.66,0,0,0,6.19-4.39,2.33,2.33,0,0,0,.49-1.63V14.88a2.66,2.66,0,0,0-.16-1,1.66,1.66,0,0,0-1.58-1.07ZM6.39,40.3a.24.24,0,0,1-.15-.09.32.32,0,0,1-.09-.16,6,6,0,0,1,3.9-3.87,1.29,1.29,0,0,1,.33.33c-.06.17-.12.33-.19.48a5.7,5.7,0,0,1-3.8,3.31Z" style="fill:#f09000"/><path d="M33.56,42.54h-.4a3.33,3.33,0,0,1-2.52-1.3,3.67,3.67,0,0,1-.5-3.07,5.86,5.86,0,0,1,5.49-4.23,4.57,4.57,0,0,1,1.49.25v-19a3.35,3.35,0,0,1,0-.69,1.11,1.11,0,0,1,2.18,0,3.54,3.54,0,0,1,0,.71c0,7.32,0,14.6,0,21.89,0,0,0,.1,0,.15a1.2,1.2,0,0,1-.25,1,6.44,6.44,0,0,1-2,3,5.87,5.87,0,0,1-3.58,1.3Z" style="fill:#f5a623"/><path d="M38.27,14.12h0a.57.57,0,0,1,.56.5,3.44,3.44,0,0,1,0,.64V37.13c0,.28.11.61-.17.84a6.13,6.13,0,0,1-1.89,2.86A5.4,5.4,0,0,1,33.55,42H33.2c-2-.15-3-1.71-2.57-3.75a5.36,5.36,0,0,1,5-3.84,3.71,3.71,0,0,1,2,.55q0-9.83,0-19.65a4.18,4.18,0,0,1,0-.71.58.58,0,0,1,.6-.51m0-1a1.59,1.59,0,0,0-1.59,1.31,4.58,4.58,0,0,0,0,.79v18.3a5.18,5.18,0,0,0-1-.09,6.37,6.37,0,0,0-6,4.62,4.17,4.17,0,0,0,.58,3.48A3.83,3.83,0,0,0,33.12,43l.43,0a6.36,6.36,0,0,0,3.89-1.41,6.88,6.88,0,0,0,2.16-3.12,1.74,1.74,0,0,0,.31-1.28v-22a4,4,0,0,0-.06-.83,1.55,1.55,0,0,0-1.51-1.32h-.07Z" style="fill:#f09000"/><path d="M46.64,42.54h-.4a3.33,3.33,0,0,1-2.52-1.3,3.7,3.7,0,0,1-.5-3.07,5.86,5.86,0,0,1,5.49-4.23,4.52,4.52,0,0,1,1.49.25l0-19a3.31,3.31,0,0,1,0-.69,1.11,1.11,0,0,1,2.18,0,3.54,3.54,0,0,1,.05.71c0,7.32,0,14.6,0,21.89,0,0,0,.1,0,.15a1.19,1.19,0,0,1-.24,1,6.54,6.54,0,0,1-2,3,5.85,5.85,0,0,1-3.58,1.3Z" style="fill:#f5a623"/><path d="M51.35,14.12h0a.57.57,0,0,1,.57.5,3.43,3.43,0,0,1,0,.64q0,10.93,0,21.86c0,.28.11.61-.16.84a6.23,6.23,0,0,1-1.9,2.86A5.39,5.39,0,0,1,46.64,42h-.36c-2-.15-3-1.71-2.56-3.75a5.35,5.35,0,0,1,5-3.84,3.77,3.77,0,0,1,2,.55q0-9.83,0-19.65a3.35,3.35,0,0,1,0-.71.57.57,0,0,1,.59-.51m0-1a1.57,1.57,0,0,0-1.58,1.31,3.83,3.83,0,0,0-.06.79v18.3a5.36,5.36,0,0,0-1-.09,6.38,6.38,0,0,0-6,4.62,4.17,4.17,0,0,0,.58,3.48,3.85,3.85,0,0,0,2.9,1.5l.43,0a6.31,6.31,0,0,0,3.88-1.41,6.9,6.9,0,0,0,2.17-3.12A1.79,1.79,0,0,0,53,37.24a.45.45,0,0,1,0-.11q0-10.94,0-21.86a4.74,4.74,0,0,0-.05-.83,1.57,1.57,0,0,0-1.51-1.32h-.08Z" style="fill:#f09000"/></g></g></svg>',NOTESPALETTEICON=RHYTHMPALETTEICON,SENSORSPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 17</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#fff;opacity:0"/><path d="M44,14H12a1.56,1.56,0,0,0-1.56,1.56V34.61A1.56,1.56,0,0,0,12,36.17H44a1.56,1.56,0,0,0,1.56-1.56V15.55A1.56,1.56,0,0,0,44,14Zm-.56,18.93a1.32,1.32,0,0,1-1.33,1.32H13.85a1.32,1.32,0,0,1-1.33-1.32V17.24a1.33,1.33,0,0,1,1.33-1.33h28.3a1.33,1.33,0,0,1,1.33,1.33Z" style="fill:#ff664b;stroke:#fc2905;stroke-miterlimit:10;stroke-width:0.6240785530394986px"/><path d="M35.35,46.31H12.47a1.59,1.59,0,0,1-1.53-1.94L12,39.61a1.57,1.57,0,0,1,1.53-1.24H34.29a1.57,1.57,0,0,1,1.53,1.24l1.06,4.76A1.59,1.59,0,0,1,35.35,46.31Z" style="fill:#ff664b;stroke:#fc2905;stroke-miterlimit:10;stroke-width:0.6302884424665127px"/><rect x="40.24" y="38.37" width="4.85" height="7.94" rx="2.42" ry="2.42" style="fill:#ff664b;stroke:#fc2905;stroke-miterlimit:10;stroke-width:0.638317918303686px"/><rect x="42.27" y="39.59" width="0.78" height="1.63" rx="0.39" ry="0.39" style="fill:#fc2905"/></g></g></svg>',STEPBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24">  <metadata   id="metadata12">  <rdf:RDF>  <cc:Work   rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type     rdf:resource="http://purl.org/dc/dcmitype/StillImage" />    <dc:title></dc:title>  </cc:Work>  </rdf:RDF>  </metadata>  <defs   id="defs10" />  <path   id="path2"   fill="none"   d="M0 0h24v24H0z" />  <path   style="fill:#ffffff"   id="path4"   d="M 4,6 H 2 v 14 c 0,1.1 0.9,2 2,2 H 18 V 20 H 4 Z M 20,2 H 8 C 6.9,2 6,2.9 6,4 v 12 c 0,1.1 0.9,2 2,2 h 12 c 1.1,0 2,-0.9 2,-2 V 4 C 22,2.9 21.1,2 20,2 Z m -8,12.5 v -9 l 6,4.5 z" /></svg>',RUNBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24">  <metadata   id="metadata12">  <rdf:RDF>  <cc:Work   rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type     rdf:resource="http://purl.org/dc/dcmitype/StillImage" />    <dc:title></dc:title>  </cc:Work>  </rdf:RDF>  </metadata>  <defs   id="defs10" />  <path   id="path2"   fill="none"   d="M0 0h24v24H0z" />  <path   style="fill:#ffffff"   id="path4"   d="M 12,2 C 6.48,2 2,6.48 2,12 2,17.52 6.48,22 12,22 17.52,22 22,17.52 22,12 22,6.48 17.52,2 12,2 Z m -2,14.5 v -9 l 6,4.5 z" />  <path   id="path844"   d="M 11.128592,21.951552 C 9.7325044,21.795415 8.67695,21.494778 7.5567354,20.934238 6.5159935,20.413465 5.6559169,19.783883 4.8473419,18.950942 3.286112,17.342664 2.354414,15.382869 2.0779232,13.125562 2.007709,12.552323 2.008562,11.445715 2.0796683,10.861591 2.3093043,8.9751759 3.0249886,7.25277 4.1899285,5.7829203 4.5219368,5.3640128 5.3632597,4.5219266 5.774496,4.1969153 7.2687047,3.0160014 8.9774616,2.3063638 10.879701,2.0767506 c 0.565813,-0.068297 1.651271,-0.067788 2.233266,0.00105 0.829757,0.098142 1.630901,0.2890482 2.390625,0.5696686 0.660403,0.2439341 1.667014,0.777132 2.239038,1.1860099 2.078338,1.4855775 3.5084,3.6519503 4.022599,6.0937578 0.16604,0.7884841 0.190548,1.0552941 0.190548,2.0744341 0,1.019141 -0.02451,1.28595 -0.190548,2.074434 -0.314543,1.49369 -1.012847,2.960973 -1.994922,4.191748 -0.326132,0.408722 -1.103537,1.184581 -1.516715,1.513698 -1.167165,0.929708 -2.525854,1.592128 -3.973518,1.937264 -0.761495,0.181547 -1.17509,0.22699 -2.151482,0.236393 -0.489844,0.0047 -0.939844,0.0031 -1,-0.0037 z m 1.877589,-7.685936 c 1.639982,-1.229829 2.985722,-2.247108 2.990533,-2.260618 0.0097,-0.02711 -5.915179,-4.4815993 -5.98244,-4.4978065 -0.034929,-0.00842 -0.041932,0.7418569 -0.041932,4.4921875 0,2.47626 0.011712,4.502291 0.026026,4.502291 0.014315,0 1.36783,-1.006224 3.007813,-2.236054 z"   style="fill:none;fill-opacity:1;stroke:none;stroke-width:0.13553125;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />  <path   id="path846"   d="M 11.128592,21.951552 C 9.7325044,21.795415 8.67695,21.494778 7.5567354,20.934238 6.5159935,20.413465 5.6559169,19.783883 4.8473419,18.950942 3.286112,17.342664 2.354414,15.382869 2.0779232,13.125562 2.007709,12.552323 2.008562,11.445715 2.0796683,10.861591 2.3093043,8.9751759 3.0249886,7.25277 4.1899285,5.7829203 4.5219368,5.3640128 5.3632597,4.5219266 5.774496,4.1969153 7.2687047,3.0160014 8.9774616,2.3063638 10.879701,2.0767506 c 0.565813,-0.068297 1.651271,-0.067788 2.233266,0.00105 0.829757,0.098142 1.630901,0.2890482 2.390625,0.5696686 0.660403,0.2439341 1.667014,0.777132 2.239038,1.1860099 2.078338,1.4855775 3.5084,3.6519503 4.022599,6.0937578 0.16604,0.7884841 0.190548,1.0552941 0.190548,2.0744341 0,1.019141 -0.02451,1.28595 -0.190548,2.074434 -0.314543,1.49369 -1.012847,2.960973 -1.994922,4.191748 -0.326132,0.408722 -1.103537,1.184581 -1.516715,1.513698 -1.167165,0.929708 -2.525854,1.592128 -3.973518,1.937264 -0.761495,0.181547 -1.17509,0.22699 -2.151482,0.236393 -0.489844,0.0047 -0.939844,0.0031 -1,-0.0037 z m 1.877589,-7.685936 c 1.639982,-1.229829 2.985722,-2.247108 2.990533,-2.260618 0.0097,-0.02711 -5.915179,-4.4815993 -5.98244,-4.4978065 -0.034929,-0.00842 -0.041932,0.7418569 -0.041932,4.4921875 0,2.47626 0.011712,4.502291 0.026026,4.502291 0.014315,0 1.36783,-1.006224 3.007813,-2.236054 z"   style="fill:none;fill-opacity:1;stroke:none;stroke-width:0.13553125;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /></svg>',STEPMUSICBUTTON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><title> 26</title><g id="_2" data-name=" 2"><g id="Icon"><circle cx="14" cy="14" r="14" style="fill:#fff"/><path d="M22.66,8.12s0-.51.4-.6.62-1.13-.16-1.08-1,1.09-.88,1.67c0,0,.29,1-.24,1.22s-.62-1.18-.62-1.18,0-.19.29-.48S22,6.44,21,6.61a1.4,1.4,0,0,0-.61,2s.54,2.25.6,3a10.09,10.09,0,0,1-.11,2.34A7,7,0,1,0,9.55,20.55c-1.55.21-2.83.82-3,2.2H18.83a4.94,4.94,0,0,0,4.44-3.56,15,15,0,0,0,.15-6.08,2.52,2.52,0,0,1,1-2c1.07-1-.53-1.53-.53-1.53A1.67,1.67,0,0,1,22.66,8.12ZM14,20.34a5.18,5.18,0,1,1,5.17-5.18A5.18,5.18,0,0,1,14,20.34Z" style="fill:#0050a0"/><path d="M7.1,11.07a1.93,1.93,0,0,0,0-.48s0-.05,0-.07v-4c2.4,1.22,1,1.86,1,1.86h0a.53.53,0,0,0,.18,1,.51.51,0,0,0,.36-.14h0c2.4-1.63.39-3.67-.38-4.16a9.41,9.41,0,0,1-1.21-.92V4a.38.38,0,0,0-.75,0V9.22a1.94,1.94,0,0,0-3.13,1.21,2,2,0,0,0,3.85.64Z" style="fill:#0050a0"/><path d="M13.17,13.29a.37.37,0,0,0-.57.31V17a.37.37,0,0,0,.57.31l2.68-1.67a.37.37,0,0,0,0-.64Z" style="fill:#0050a0"/></g></g></svg>',STOPBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="55" height="55" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg975" version="1.1" viewBox="0 0 28 28"> <title id="title967"> 24</title> <circle id="circle969" style="fill:#ffffff;stroke-width:0.9285714" r="13" cy="14" cx="14" /> <rect id="rect971" style="fill:#0050a0" ry="1" rx="1" height="9" width="9" y="9.5" x="9.5" /> </svg>',TONEPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 6</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><path d="M36.08,45.48a7.08,7.08,0,1,1,0-14.15,6.91,6.91,0,0,1,3.13.75V26.36H22.74v12a7.09,7.09,0,1,1-7.09-7.08,6.91,6.91,0,0,1,3.13.75V14.76H43.17V38.41A7.09,7.09,0,0,1,36.08,45.48Z" style="fill:#3edcdd"/><path d="M42.47,15.46V38.41A6.39,6.39,0,1,1,36.08,32a6.31,6.31,0,0,1,3.83,1.31V25.66H22V38.41A6.39,6.39,0,1,1,15.65,32a6.31,6.31,0,0,1,3.83,1.31V15.46h23m1.4-1.4H18.08V31a7.64,7.64,0,0,0-2.43-.4,7.78,7.78,0,1,0,7.79,7.78V27.06H38.51v4a7.64,7.64,0,0,0-2.43-.4,7.78,7.78,0,1,0,7.79,7.78V14.06Z" style="fill:#1dbcbd"/></g></g></svg>',ORNAMENTPALETTEICON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:osb="http://www.openswatchbook.org/uri/2009/osb" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg8" version="1.1" viewBox="0 0 14.552083 14.552084" height="55" width="55">  <defs   id="defs2">  <linearGradient   osb:paint="solid"   id="linearGradient2390">  <stop   id="stop2388"   offset="0"   style="stop-color:#3edcdd;stop-opacity:1;" />  </linearGradient>  <linearGradient   osb:paint="solid"   id="linearGradient2384">  <stop   id="stop2382"   offset="0"   style="stop-color:#3edcdd;stop-opacity:1;" />  </linearGradient>  </defs>  <metadata   id="metadata5">  <rdf:RDF>  <cc:Work   rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type     rdf:resource="http://purl.org/dc/dcmitype/StillImage" />    <dc:title></dc:title>  </cc:Work>  </rdf:RDF>  </metadata>  <rect   id="rect22"   width="13.493751"   height="0.2645694"   x="0.52916664"   y="1.6284206"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.18520834;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />  <rect   id="rect22-5"   width="13.493751"   height="0.26457596"   x="0.52916664"   y="4.0096707"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.18520834;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />  <rect   id="rect22-3"   width="13.493751"   height="0.26458487"   x="0.52916664"   y="6.3909192"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.18520834;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />  <rect   id="rect22-1"   width="13.493751"   height="0.26458812"   x="0.52916664"   y="8.772171"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.18520834;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />  <rect   id="rect22-51"   width="13.493751"   height="0.2645942"   x="0.52916664"   y="11.153421"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.18520834;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />  <g   transform="translate(0,-1.0174126)"   id="g852">  <rect   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.26458332;stroke-opacity:1"   y="6.6145697"   x="1.3229166"   height="7.6729307"   width="0.52916658"   id="rect94" />  <ellipse   transform="rotate(-20)"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.26458332;stroke-opacity:1"   ry="1.190625"   rx="1.5875"   cy="6.9454117"   cx="0.52833205"   id="path59" />  </g>  <g   transform="translate(0,-1.0174126)"   id="g842">  <rect   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.26458332;stroke-opacity:1"   y="6.5236216"   x="10.124447"   height="7.7638788"   width="0.52503204"   id="rect98" />  <ellipse   transform="rotate(-20)"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.26458332;stroke-opacity:1"   ry="1.190625"   rx="1.5875"   cy="9.9400101"   cx="8.8039436"   id="path59-3" />  </g>  <g   transform="matrix(1.1074117,0,0,0.93882786,-0.98799151,0.10673636)"   id="g2411">  <path   style="fill:none;fill-opacity:1;stroke:#3ecacb;stroke-width:1.14749789;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"   d="M 2.9668896,3.4369029 C 3.8128445,2.4309251 5.0751821,1.951106 6.3020138,1.7118813 7.6589739,1.4719215 9.0939565,1.4813451 10.398451,1.9823751 c 0.608762,0.2482866 1.263846,0.683771 1.401772,1.4056715"   id="path100-6" />  <path   style="fill:none;fill-opacity:1;stroke:#3edcdd;stroke-width:0.62944376;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"   d="M 2.9668899,3.434624 C 3.8128449,2.4755691 4.9672752,1.9102233 6.194107,1.682157 7.6952949,1.4646984 8.9547136,1.4328595 10.228882,1.940034 c 0.608761,0.2367055 1.433416,0.7597844 1.571341,1.4480126"   id="path100" />  </g>  <g   transform="translate(0,-1.0174126)"   id="g846">  <rect   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.26458332;stroke-opacity:1"   y="5.2916632"   x="5.6844077"   height="7.9375038"   width="0.51676416"   id="rect96" />  <ellipse   transform="rotate(-20)"   style="fill:#3edcdd;fill-opacity:1;stroke:#3ecacb;stroke-width:0.26458332;stroke-opacity:1"   ry="1.190625"   rx="1.5875"   cy="7.3167715"   cx="5.0312033"   id="path59-9" />  </g></svg>',VOLUMEPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 7</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><path d="M27,40.15a2.15,2.15,0,0,1-1.13-.32l-9.3-5.54H10.86a2.13,2.13,0,0,1-2.16-2.1V23.81a2.13,2.13,0,0,1,2.16-2.09h5.66l9.3-5.55A2.17,2.17,0,0,1,29.11,18v20.1a2.06,2.06,0,0,1-.67,1.52,2.23,2.23,0,0,1-1.49.58Z" style="fill:#3edcdd"/><path d="M27,16.55A1.43,1.43,0,0,1,28.41,18v20.1A1.43,1.43,0,0,1,27,39.45a1.51,1.51,0,0,1-.78-.22l-9.46-5.65H10.86A1.42,1.42,0,0,1,9.4,32.19V23.81a1.42,1.42,0,0,1,1.46-1.39h5.85l9.46-5.65a1.51,1.51,0,0,1,.78-.22m0-1.4a2.89,2.89,0,0,0-1.49.42L16.33,21H10.86A2.83,2.83,0,0,0,8,23.81v8.38A2.83,2.83,0,0,0,10.86,35h5.47l9.13,5.45a2.89,2.89,0,0,0,1.49.42,2.83,2.83,0,0,0,2.86-2.8V18A2.83,2.83,0,0,0,27,15.15Z" style="fill:#1dbcbd"/><path d="M34.79,35.29a1.67,1.67,0,0,1-1.26-.52,2.47,2.47,0,0,1-.05-3.08,7.06,7.06,0,0,0,0-7.92,2.5,2.5,0,0,1,.05-3.1,1.71,1.71,0,0,1,1.26-.52A2.79,2.79,0,0,1,37,21.45,11.21,11.21,0,0,1,37,34a2.78,2.78,0,0,1-2.23,1.29Z" style="fill:#3edcdd"/><path d="M34.79,20.86a2.1,2.1,0,0,1,1.65,1,10.56,10.56,0,0,1,0,11.77,2.1,2.1,0,0,1-1.65,1A1,1,0,0,1,34,34.3a1.84,1.84,0,0,1,0-2.23,7.77,7.77,0,0,0,0-8.69,1.84,1.84,0,0,1,0-2.23,1,1,0,0,1,.75-.29m-.75.29h0m.75-1.7A2.41,2.41,0,0,0,33,20.2a3.2,3.2,0,0,0-.12,3.95,6.35,6.35,0,0,1,0,7.14,3.2,3.2,0,0,0,.12,4,2.39,2.39,0,0,0,1.77.73,3.49,3.49,0,0,0,2.81-1.6,11.91,11.91,0,0,0,0-13.33,3.5,3.5,0,0,0-2.81-1.61Z" style="fill:#1dbcbd"/><path d="M41.43,39.51A1.79,1.79,0,0,1,40.11,39a2.36,2.36,0,0,1,0-3.11,12.86,12.86,0,0,0,0-16.26,2.37,2.37,0,0,1,0-3.12,1.79,1.79,0,0,1,1.32-.54,2.68,2.68,0,0,1,2,1,17,17,0,0,1,0,21.47,2.68,2.68,0,0,1-2,1Z" style="fill:#3edcdd"/><path d="M41.43,16.64a2,2,0,0,1,1.5.79,16.39,16.39,0,0,1,0,20.59,2,2,0,0,1-1.5.79,1.14,1.14,0,0,1-.82-.32h0a1.69,1.69,0,0,1,.09-2.2,13.62,13.62,0,0,0,0-17.13,1.69,1.69,0,0,1-.09-2.2,1.14,1.14,0,0,1,.82-.32m-.82.32h0m.82-1.72a2.5,2.5,0,0,0-1.82.75,3,3,0,0,0,0,4,12.17,12.17,0,0,1,0,15.38,3.07,3.07,0,0,0,0,4.05,2.5,2.5,0,0,0,1.82.75A3.38,3.38,0,0,0,44,38.9a17.67,17.67,0,0,0,0-22.35,3.38,3.38,0,0,0-2.59-1.31Z" style="fill:#1dbcbd"/></g></g></svg>',WIDGETSPALETTEICON='<svg width="55" height="55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56"><title> 5</title><g id="_2" data-name=" 2"><g id="Icon"><rect width="56" height="56" style="fill:#dfdfdf;opacity:0"/><rect x="9.4" y="9.45" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="18.7" y="9.45" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="28" y="9.45" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="37.3" y="9.45" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="9.4" y="18.72" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="18.7" y="18.72" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="28" y="18.72" width="9.3" height="9.28" style="fill:#57ad02;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="37.3" y="18.72" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="9.4" y="28" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="18.7" y="28" width="9.3" height="9.28" style="fill:#57ad02;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="28" y="28" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="37.3" y="28" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="9.4" y="37.28" width="9.3" height="9.28" style="fill:#57ad02;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="18.7" y="37.28" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="28" y="37.28" width="9.3" height="9.28" style="fill:#7cd622;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/><rect x="37.3" y="37.28" width="9.3" height="9.28" style="fill:#57ad02;stroke:#57ad02;stroke-miterlimit:10;stroke-width:1.399999976158142px"/></g></g></svg>',MATRIXPALETTEICON=WIDGETSPALETTEICON,MYBLOCKSPALETTEICON='<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="55" height="55"> <path d="m 15.719636,31.331478 0.114372,5.261133 11.437247,6.290486 L 27.5,29.387146" style="fill:none;stroke:#282828;stroke-width:2;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 27.728744,29.501519 0.05719,13.381578 11.723178,-7.548583 0,-4.689272 -5.947368,3.545548" style="fill:none;stroke:#282828;stroke-width:2;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 10.001012,27.328441 5.604251,-5.146761 -5.832996,-2.973684 12.123482,-7.091093 5.718623,3.316801 5.489879,-3.088056 12.123482,7.319838 -5.832996,2.401822 5.489878,5.032388 -11.322874,7.205466 -5.947369,-5.261134 -6.290485,5.261134 -11.322875,-6.976721 z" style="fill:none;stroke:#282828;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="M 16.40587,21.952935 27.156883,15.204959 38.937247,22.067308 27.614372,28.815283 16.40587,21.952935 z" style="fill:none;stroke:#282828;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <g transform="matrix(0.39620698,0,0,0.39620698,28.654032,26.094918)" style="display:block"> <path d="m 33.233,35.1 10.102,10.1 c 0.752,0.75 1.217,1.783 1.217,2.932 0,2.287 -1.855,4.143 -4.146,4.143 -1.145,0 -2.178,-0.463 -2.932,-1.211 l -10.102,-10.103 -10.1,10.1 c -0.75,0.75 -1.787,1.211 -2.934,1.211 -2.284,0 -4.143,-1.854 -4.143,-4.141 0,-1.146 0.465,-2.184 1.212,-2.934 L 21.511,35.095 11.409,24.995 c -0.747,-0.748 -1.212,-1.785 -1.212,-2.93 0,-2.289 1.854,-4.146 4.146,-4.146 1.143,0 2.18,0.465 2.93,1.214 L 27.372,29.235 37.474,19.132 c 0.754,-0.749 1.787,-1.214 2.934,-1.214 2.289,0 4.146,1.856 4.146,4.145 0,1.146 -0.467,2.18 -1.217,2.932 L 33.233,35.1 z" style="fill:#282828;stroke:#00abff;stroke-width:3.5" /> <circle cx="27.371" cy="10.849" r="8.1219997" style="fill:#282828;stroke:#00abff;stroke-width:3.5" /> </g></svg>',CARTESIAN='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.0" width="1200" height="900" id="svg2"> <defs id="defs4" /> <g id="layer1"> <path d="m 0,850 1200,0" id="path5" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,750 1200,0" id="path7" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,650 1200,0" id="path9" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,550 1200,0" id="path11" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,350 1200,0" id="path13" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,250 1200,0" id="path15" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,150 1200,0" id="path17" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,50 1200,0" id="path19" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 1100,0 0,900" id="path21" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 1000,0 0,900" id="path23" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 900,0 0,900" id="path25" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 800,0 0,900" id="path27" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 700,0 0,900" id="path29" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 500,0 0,900" id="path31" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 400,0 0,900" id="path33" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 300,0 0,900" id="path35" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 200,0 0,900" id="path37" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 100,0 0,900" id="path39" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,850 20,0" id="path41" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,750 20,0" id="path43" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,650 20,0" id="path45" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,550 20,0" id="path47" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 0,450 1200,0" id="path49" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,350 20,0" id="path51" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,250 20,0" id="path53" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,150 20,0" id="path55" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 590,50 20,0" id="path57" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 1100,440 0,20" id="path59" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 1000,440 0,20" id="path61" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 900,440 0,20" id="path63" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 800,440 0,20" id="path65" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 700,440 0,20" id="path67" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 600,0 0,900" id="path69" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 500,440 0,20" id="path71" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 400,440 0,20" id="path73" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 300,440 0,20" id="path75" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 200,440 0,20" id="path77" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> <path d="m 100,440 0,20" id="path79" style="fill:none;stroke:#000000;stroke-width:1px;stroke-opacity:1" /> </g> <text x="603.90137" y="344.8584" id="text3218" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="603.90137" y="344.8584" id="tspan3220">100</tspan></text> <text x="604.26758" y="244.8584" id="text3218-8" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="604.26758" y="244.8584" id="tspan3220-7">200</tspan></text> <text x="604.23828" y="144.8584" id="text3218-7" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="604.23828" y="144.8584" id="tspan3220-2">300</tspan></text> <text x="604.51172" y="44.858398" id="text3218-2" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="604.51172" y="44.858398" id="tspan3220-26">400</tspan></text> <text x="1104.2285" y="444.8584" id="text3218-6" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="1104.2285" y="444.8584" id="tspan3220-1">500</tspan></text> <text x="1004.5117" y="444.8584" id="text3218-9" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="1004.5117" y="444.8584" id="tspan3220-4">400</tspan></text> <text x="904.23828" y="444.8584" id="text3218-0" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="904.23828" y="444.8584" id="tspan3220-9">300</tspan></text> <text x="804.26758" y="444.8584" id="text3218-71" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="804.26758" y="444.8584" id="tspan3220-15">200</tspan></text> <text x="703.90137" y="444.8584" id="text3218-76" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="703.90137" y="444.8584" id="tspan3220-73">100</tspan></text> <text x="469.51172" y="444.8584" id="text3218-5" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="469.51172" y="444.8584" id="tspan3220-6">100</tspan></text> <text x="369.51172" y="444.8584" id="text3218-94" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="369.51172" y="444.8584" id="tspan3220-8">200</tspan></text> <text x="269.51172" y="444.8584" id="text3218-93" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="269.51172" y="444.8584" id="tspan3220-90">300</tspan></text> <text x="169.51172" y="444.8584" id="text3218-85" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="169.51172" y="444.8584" id="tspan3220-0">400</tspan></text> <text x="69.511719" y="444.8584" id="text3218-3" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="69.511719" y="444.8584" id="tspan3220-85">500</tspan></text> <text x="571.51172" y="544.8584" id="text3218-1" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="571.51172" y="544.8584" id="tspan3220-5">100</tspan></text> <text x="571.51172" y="644.8584" id="text3218-4" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="571.51172" y="644.8584" id="tspan3220-81">200</tspan></text> <text x="571.51172" y="744.8584" id="text3218-30" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="571.51172" y="744.8584" id="tspan3220-44">300</tspan></text> <text x="571.51172" y="844.8584" id="text3218-47" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="571.51172" y="844.8584" id="tspan3220-63">400</tspan></text> <text x="604.34082" y="444.8584" id="text3218-96" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="604.34082" y="444.8584" id="tspan3220-21">0</tspan></text> <text x="69.140625" y="43.681641" id="text3218-2-7" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="69.140625" y="43.681641" id="tspan3220-26-8">(500, 400)</tspan></text> <text x="1074.1406" y="43.681641" id="text3218-2-7-5" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="1074.1406" y="43.681641" id="tspan3220-26-8-7">(500, 400)</tspan></text> <text x="1074.1406" y="843.68164" id="text3218-2-7-1" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="1074.1406" y="843.68164" id="tspan3220-26-8-8">(500, 400)</tspan></text> <text x="69.140625" y="843.68164" id="text3218-2-7-1-5" xml:space="preserve" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"><tspan x="69.140625" y="843.68164" id="tspan3220-26-8-8-9">(500, 400)</tspan></text> </svg>',POLAR='<?xml version="1.0" encoding="UTF-8" standalone="no"?> \x3c!-- Created with Inkscape (http://www.inkscape.org/) --\x3e <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.0" width="1200" height="900" id="svg2"> <path d="M 899.66703,-69.03853 300.33297,969.03853" id="path3403" style="fill:none;stroke:#aaaaaa;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 600,-149.33408 0,1198.66818" id="path69" style="fill:none;stroke:#aaaaaa;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="M 300.33297,-69.03853 899.66703,969.03853" id="path3397" style="fill:none;stroke:#aaaaaa;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 176.2068,26.20681 847.5864,847.58638" id="path3405" style="fill:none;stroke:#aaaaaa;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="M 80.961482,150.33296 1119.0385,749.66704" id="path3399" style="fill:none;stroke:#aaaaaa;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 881.14902,435.72711 c 0,194.53909 -157.2228,352.24418 -351.16696,352.24418 -193.94417,0 -351.16697,-157.70509 -351.16697,-352.24418 0,-194.53909 157.2228,-352.244179 351.16696,-352.244179 193.94417,0 351.16697,157.705089 351.16697,352.244179 l 0,0 z" transform="matrix(1.1334197,0,0,1.1299535,-0.6921025,-42.351375)" id="path2537" style="fill:none;stroke:#000000;stroke-width:0.88363791;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 881.14902,435.72711 c 0,194.53909 -157.2228,352.24418 -351.16696,352.24418 -193.94417,0 -351.16697,-157.70509 -351.16697,-352.24418 0,-194.53909 157.2228,-352.244179 351.16696,-352.244179 193.94417,0 351.16697,157.705089 351.16697,352.244179 l 0,0 z" transform="matrix(0.8500647,0,0,0.8474652,149.48096,80.736436)" id="path3311" style="fill:none;stroke:#000000;stroke-width:1.17818391;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 881.14902,435.72711 c 0,194.53909 -157.2228,352.24418 -351.16696,352.24418 -193.94417,0 -351.16697,-157.70509 -351.16697,-352.24418 0,-194.53909 157.2228,-352.244179 351.16696,-352.244179 193.94417,0 351.16697,157.705089 351.16697,352.244179 l 0,0 z" transform="matrix(0.5667098,0,0,0.5649768,299.65398,203.82429)" id="path3313" style="fill:none;stroke:#000000;stroke-width:1.76727581;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 881.14902,435.72711 c 0,194.53909 -157.2228,352.24418 -351.16696,352.24418 -193.94417,0 -351.16697,-157.70509 -351.16697,-352.24418 0,-194.53909 157.2228,-352.244179 351.16696,-352.244179 193.94417,0 351.16697,157.705089 351.16697,352.244179 l 0,0 z" transform="matrix(0.2833549,0,0,0.2824884,449.82699,326.91215)" id="path3315" style="fill:none;stroke:#000000;stroke-width:3.53455162;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 881.14902,435.72711 c 0,194.53909 -157.2228,352.24418 -351.16696,352.24418 -193.94417,0 -351.16697,-157.70509 -351.16697,-352.24418 0,-194.53909 157.2228,-352.244179 351.16696,-352.244179 193.94417,0 351.16697,157.705089 351.16697,352.244179 l 0,0 z" transform="matrix(1.4220377,0,0,1.417689,-153.65446,-167.72553)" id="path3395" style="fill:none;stroke:#000000;stroke-width:0.70429397;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 0,450 1200,0" id="path49" style="fill:none;stroke:#aaaaaa;stroke-width:1px;stroke-opacity:1" /> <path d="M 80.96149,749.66704 1119.0385,150.33296" id="path3401" style="fill:none;stroke:#aaaaaa;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="M 1023.7932,26.20681 176.2068,873.79319" id="path3407" style="fill:none;stroke:#aaaaaa;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <text x="602.82129" y="175.8584" id="text3003" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="602.82129" y="175.8584" id="tspan3005" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">0</tspan></text> <text x="869.37012" y="459.64014" id="text3003-4" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="869.37012" y="459.64014" id="tspan3005-7" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">90</tspan></text> <text x="602.23438" y="733.8584" id="text3003-5" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="602.23438" y="733.8584" id="tspan3005-6" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">180</tspan></text> <text x="319.26758" y="459.64014" id="text3003-3" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="319.26758" y="459.64014" id="tspan3005-74" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">270</tspan></text> <text x="725.93848" y="209.30679" id="text3003-52" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="725.93848" y="209.30679" id="tspan3005-5" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">30</tspan></text> <text x="836.63684" y="321.30682" id="text3003-7" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="836.63684" y="321.30682" id="tspan3005-4" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">60</tspan></text> <text x="796.0752" y="262.57425" id="text3003-0" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="796.0752" y="262.57425" id="tspan3005-78" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">45</tspan></text> <text x="349.23846" y="323.30682" id="text3003-52-6" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="349.23846" y="323.30682" id="tspan3005-5-8" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">300</tspan></text> <text x="461.2384" y="209.30679" id="text3003-7-8" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="461.2384" y="209.30679" id="tspan3005-4-4" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">330</tspan></text> <text x="387.23846" y="262.64017" id="text3003-0-3" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="387.23846" y="262.64017" id="tspan3005-78-1" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">315</tspan></text> <text x="359.25311" y="595.97345" id="text3003-52-9" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="359.25311" y="595.97345" id="tspan3005-5-2" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">240</tspan></text> <text x="461.25305" y="697.30682" id="text3003-7-0" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="461.25305" y="697.30682" id="tspan3005-4-6" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">210</tspan></text> <text x="407.25311" y="650.6402" id="text3003-0-8" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="407.25311" y="650.6402" id="tspan3005-78-9" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">225</tspan></text> <text x="722.58643" y="699.30682" id="text3003-52-66" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="722.58643" y="699.30682" id="tspan3005-5-4" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">150</tspan></text> <text x="823.25305" y="595.97345" id="text3003-7-9" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="823.25305" y="595.97345" id="tspan3005-4-5" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">120</tspan></text> <text x="780.58643" y="654.6402" id="text3003-0-0" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="780.58643" y="654.6402" id="tspan3005-78-4" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">135</tspan></text> <text x="572.36084" y="733.8584" id="text3003-5-0" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="572.36084" y="733.8584" id="tspan3005-6-9" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">180</tspan></text> <text x="435.53955" y="691.30682" id="text3003-5-0-4" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="435.53955" y="691.30682" id="tspan3005-6-9-8" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">150</tspan></text> <text x="381.53955" y="644.6402" id="text3003-5-0-8" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="381.53955" y="644.6402" id="tspan3005-6-9-6" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">135</tspan></text> <text x="338.53955" y="585.97345" id="text3003-5-0-5" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="338.53955" y="585.97345" id="tspan3005-6-9-9" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">120</tspan></text> <text x="320.63477" y="447.14014" id="text3003-5-0-89" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="320.63477" y="447.14014" id="tspan3005-6-9-2" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">90</tspan></text> <text x="354.41336" y="308.54013" id="text3003-5-0-0" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="354.41336" y="308.54013" id="tspan3005-6-9-1" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">60</tspan></text> <text x="399.03955" y="247.14014" id="text3003-5-0-9" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="399.03955" y="247.14014" id="tspan3005-6-9-62" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">45</tspan></text> <text x="443.03955" y="215.14014" id="text3003-5-0-6" xml:space="preserve" style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;fill:#0000c0;fill-opacity:1;stroke:none;font-family:DejaVu Sans"><tspan x="443.03955" y="215.14014" id="tspan3005-6-9-64" style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#ff0000;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans">30</tspan></text> </svg>',SEARCHPALETTEICON='<svg version="1.1" viewBox="0 0 55 55" height="55" width="55" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="m24.041 6.6112c-9.5473 0-17.367 7.825-17.367 17.367 0 9.5454 7.819 17.367 17.367 17.367 3.5927 0 6.9465-1.1133 9.7246-3.0036l9.9922 9.9922 4.6392-4.6392-9.9625-10.022c1.8768-2.7711 2.9739-6.1147 2.9739-9.6948 0-9.5441-7.8273-17.367-17.367-17.367zm0 6.602c5.9766 0 10.765 4.7852 10.765 10.765 0 5.9848-4.7899 10.765-10.765 10.765-5.9871 0-10.765-4.779-10.765-10.765 0-5.9818 4.7772-10.765 10.765-10.765z" fill="#c0c0c0" stroke="#606060" stroke-linejoin="round" stroke-width="2.5"/></svg>',MUSICICON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg28" height="55" width="55" version="1.0"> <rect ry="0" rx="0" y="0" x="0" height="55" width="55" id="rect841" style="fill:background_fill_color;fill-opacity:1;stroke:none;stroke-width:14.53336239;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <g id="g26" transform="matrix(0.87134744,0,0,0.87134744,3.2573019,3.5379454)"> <g style="fill:fill_color;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" transform="matrix(2.8153153,0,0,2.8153153,175.99125,78.011244)"> <path d="m -61.801691,-12.829594 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-9.472 0.352,0 0,10.352 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 0.736,0.48 q 0.848,0 1.712,-0.72 0.88,-0.72 0.88,-1.072 0,-0.224 -0.192,-0.224 -0.592,0 -1.632,0.688 -1.024,0.672 -1.024,1.12 0,0.208 0.256,0.208 z" style="fill:fill_color;fill-opacity:1" /> </g> <g style="fill:fill_color;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 28.250009,41.891892 q 0,-2.342343 2.297297,-4.144145 2.297298,-1.846846 4.864865,-1.846846 1.486487,0 2.657658,0.765765 l 0,-26.666666 0.990991,0 0,29.144144 q 0,2.522522 -2.207207,4.189189 Q 34.646405,45 31.988748,45 30.502261,45 29.376135,44.144144 28.250009,43.243243 28.250009,41.891892 Z" /> </g> <g style="fill:fill_color;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 42.833345,41.891892 q 0,-2.342343 2.297297,-4.144145 2.297298,-1.846846 4.864865,-1.846846 1.486487,0 2.657658,0.765765 l 0,-26.666666 0.990991,0 0,29.144144 q 0,2.522522 -2.207208,4.189189 Q 49.229741,45 46.572084,45 45.085597,45 43.959471,44.144144 42.833345,43.243243 42.833345,41.891892 Z" /> </g> </g> <path id="path843" d="M 0,0.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path843-3" d="M 0,54.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> </svg>',GRAPHICSICON='<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55"> <rect ry="0" rx="0" y="0" x="0" height="55" width="55" id="rect841" style="fill:background_fill_color;fill-opacity:1;stroke:none;stroke-width:14.53336239;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path d="m 11.152285,41.709935 c 1.43401,0.788706 5.23977,1.402428 7.528553,1.290609 1.626167,-0.07945 3.914929,-0.479849 5.234137,-1.43401 2.238123,-1.618798 3.032695,-5.829627 5.090736,-7.671954 1.225701,-1.097229 3.231844,-2.444635 4.875634,-2.509518 2.003851,-0.07909 4.468168,1.514349 6.166244,2.581219 1.290216,0.810619 3.800127,3.369923 3.800127,3.369923" style="fill:none;stroke:stroke_color;stroke-width:1.5;stroke-linecap:round;stroke-miterlimit:4;stroke-opacity:1" /> <path d="m 35.566307,13.352385 2.437818,-2.366117 1.200984,0.84248 1.416085,1.200984 0.985882,1.272684 0.914181,1.487786 -2.366117,2.509519 -0.896257,-1.505711 -2.186866,-2.366117 -1.50571,-1.075508 z" style="fill:stroke_color;stroke:fill_color;stroke-width:1px;stroke-opacity:1" /> <path d="m 32.877538,16.112854 2.294417,-2.079315 1.200984,0.84248 1.416085,1.200984 0.985882,1.272684 0.914181,1.487786 -2.079315,1.864214 -0.967957,-1.147208 -2.330267,-2.222716 -1.43401,-1.218909 z" style="fill:stroke_color;stroke:fill_color;stroke-width:1px;stroke-opacity:1" /> <path d="m 13.423248,38.807621 0.891754,-3.80169 18.820708,-18.21056 -0.469344,-0.680549 2.252852,-2.135517 5.115854,5.115853 -2.229385,2.135517 -0.774419,-0.539747 -19.05538,18.022823 -3.70782,0.657082 -0.84482,-0.563212 z" style="fill:stroke_color;stroke:fill_color;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1" /> <path d="m 33.482432,17.358584 3.660886,3.473148" style="fill:stroke_color;stroke:fill_color;stroke-width:1.5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1" /> <path d="m 10.935723,41.905293 2.769132,-2.816066" style="fill:stroke_color;stroke:fill_color;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1" /> <path d="m 14.690478,35.287537 c 0,0 1.594197,0.393866 2.158983,0.93869 0.574138,0.553844 1.032558,2.158984 1.032558,2.158984" style="fill:stroke_color;stroke:fill_color;stroke-width:1.5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1" />  <path id="path843" d="M 0,0.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path843-3" d="M 0,54.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> </svg>',GRAPHICSICONX='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg28" height="55" width="55" version="1.0"> <rect ry="0" rx="0" y="0" x="0" height="55" width="55" id="rect841" style="fill:background_fill_color;fill-opacity:1;stroke:none;stroke-width:14.53336239;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <g id="g26" transform="matrix(0.87134744,0,0,0.87134744,3.2573019,3.5379454)"> <g transform="translate(-3.1884835,0.12548216)" style="fill:fill_color;stroke:stroke_color;stroke-width:1.99999976;stroke-miterlimit:4;stroke-dasharray:none" id="g3586"> <path style="fill:fill_color;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" id="path4725" d="m 31.188483,5.8745178 c 0,0 -1.254644,-1 -2,-1 -1.490712,0 -2.945907,0.9459074 -4,2 -1.581139,1.5811389 -1.692548,4.1860072 -3,6.0000002 -0.826905,1.14727 -1.85273,2.173095 -3,3 -1.813992,1.307452 -4.41886,1.418861 -5.999999,3 -1.054093,1.054093 -2,2.509288 -2,4 0,1.490712 1.176934,3.540162 2,4 2.595129,1.449868 0.836609,0.648512 2,2 0,0 -1.040434,3.300808 -1,5 0.06539,2.747959 1.999999,7 1.999999,8 0,1 3.621931,4.46873 6,6 2.394526,1.541867 5.323775,2.059095 8.164792,2.258437 3.065644,0.215103 5.976447,-0.356365 8.670416,-1.835208 1.652944,-0.907377 3.020234,-1.924716 4.164792,-3.423229 1.631246,-2.13571 3.310226,-4.40261 4,-7 0.42778,-1.610833 0.203639,-3.345821 0,-5 -0.167925,-1.364071 -1.27205,-2.652826 -1,-4 0.329909,-1.633688 2.319717,-2.47849 3,-4 0.693755,-1.551642 1.687609,-3.445625 1,-5 -0.786311,-1.777496 -3.357594,-1.960634 -5,-3 -1.015577,-0.642689 -2.106041,-1.196706 -3,-2 -1.93647,-1.740075 -3.442391,-3.913943 -5,-6.0000002 -0.71906,-0.9630146 -1.044881,-2.2704844 -2,-3 -0.837694,-0.6398275 -1.974105,-1.2421808 -3,-1 -0.458794,0.1083066 -1,1 -1,1" /> <path d="m 46.209786,28.156906 c 0,0 1.463947,5.738921 1.001084,8.583832 -0.503422,3.094194 -1.733796,6.320068 -4.004337,8.583833 -2.061998,2.055845 -3.20724,2.828474 -6.006505,3.815036 -1.290398,0.454783 -4.973515,0.953759 -6.514048,0.953759 -1.540535,0 -5.223651,-0.498977 -6.514049,-0.95376 -2.799265,-0.986562 -3.944507,-1.759191 -6.006506,-3.815036 -2.270541,-2.263765 -3.500915,-5.489639 -4.004337,-8.583833 -0.462863,-2.844911 1.001084,-8.583832 1.001084,-8.583832 M 28.176267,22.43435 c 0,0 -4.122174,4.705629 -7.007589,5.722555 -1.877805,0.661806 -4.201946,0.826315 -6.006506,0 -1.925806,-0.881834 -3.58357,-2.772978 -4.004337,-4.768796 -0.478397,-2.26917 0.558956,-4.123549 2.470477,-5.529022 2.067374,-1.520067 4.598363,-1.662883 6.539282,-3.054811 2.515152,-1.803739 2.912345,-5.389772 5.005421,-7.6300732 1.420632,-1.520559 5.512965,-3.8150366 5.512965,-3.8150366 0,0 4.092331,2.2944775 5.512964,3.8150365 2.093073,2.2403013 2.490269,5.8263353 5.005421,7.6300743 1.940919,1.391928 4.538808,1.465531 6.606183,2.927334 1.937249,1.369793 2.881973,3.387329 2.403575,5.656499 -0.420767,1.995818 -2.078532,3.886962 -4.004337,4.768796 -1.80456,0.826315 -4.1287,0.661806 -6.006505,0 -2.885416,-1.016926 -7.00759,-5.722555 -7.00759,-5.722555" id="path4505-6" style="fill:none;stroke:stroke_color;stroke-width:1.95427048;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <g id="g4565" transform="matrix(1.0010843,0,0,0.95375917,57.401951,5.3863652)" style="fill:none;stroke:stroke_color;stroke-opacity:1"> <g id="g4553" transform="translate(0,-1)" style="fill:none;stroke:stroke_color;stroke-opacity:1"> <path d="M -30.228157,8.514322 C -33.422908,9.40349 -38.624018,5.874516 -40.102591,4.585664" id="path3411-7" style="fill:none;fill-rule:evenodd;stroke:stroke_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path d="M -29.760199,5.904536 C -33.101366,5.473905 -35.931474,3.7361852 -37.633646,2.3416285" id="path3413-5" style="fill:none;fill-rule:evenodd;stroke:stroke_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> </g> <g id="g4557" style="fill:none;stroke:stroke_color;stroke-opacity:1"> <path d="m -23.145912,7.514322 c 3.194751,0.889168 8.395861,-2.639806 9.874434,-3.928658" id="path3411-3" style="fill:none;fill-rule:evenodd;stroke:stroke_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path d="m -23.61387,4.904536 c 3.341167,-0.430631 6.171275,-2.168351 7.873447,-3.5629075" id="path3413-56" style="fill:none;fill-rule:evenodd;stroke:stroke_color;stroke-width:1.93205309;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> </g> </g> <g id="g4636" transform="matrix(1.0010843,0,0,0.95375917,57.930597,3.4788469)" style="fill:#ffffff;stroke:stroke_color;stroke-opacity:1;fill-opacity:0.94117647"> <ellipse cx="-30.836912" cy="14.612609" id="circle3409-2" rx="1.8846371" ry="2.0666313" style="fill:#ffffff;fill-rule:evenodd;stroke:stroke_color;stroke-width:1.99999976;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:0.94117647" /> <ellipse cx="-23.593306" cy="14.699166" id="ellipse4229-9" rx="1.8846371" ry="2.0666313" style="fill:#ffffff;fill-rule:evenodd;stroke:stroke_color;stroke-width:1.99999976;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:0.94117647" /> </g> <g id="g4632" transform="matrix(1.0010843,0,0,0.95375917,58.02711,3.4788469)" style="fill:none;stroke:stroke_color;stroke-opacity:1"> <path d="m -37.186516,14.624518 c -14.340024,2.75008 -4.810404,15.671871 4.375,5.25" id="path4303-1" style="fill:none;fill-rule:evenodd;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path d="m -17.436517,14.624518 c 14.3400245,2.75008 4.810404,15.671872 -4.375,5.25" id="path4303-1-2" style="fill:none;fill-rule:evenodd;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> </g> <path d="m 33.12784,3.3591671 c -1.384692,1.3140551 -1.985761,2.3793068 -2.459835,2.3793068 -0.662709,0 -1.27278,-1.0652517 -2.459836,-2.3793068 -0.97292,-1.0770097 1.101306,-2.37930771 2.459836,-2.37930771 1.358531,0 3.532987,1.36090081 2.459835,2.37930771 z" id="path4227-7" style="fill:stroke_color;fill-rule:evenodd;stroke:stroke_color;stroke-width:2.16383076;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:1" /> <path style="fill:none;stroke:stroke_color;stroke-width:1.95427048;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path4653" d="m 31.302308,50.085622 c 0,0 0.723125,3.123831 5.500191,3.669996 4.777067,0.546166 11.784656,-3.778776 14.78791,-9.501331 3.003254,-5.722555 2.402683,-11.490783 3.003253,-18.121425" /> </g> </g> <path id="path843" d="M 0,0.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path843-3" d="M 0,54.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> </svg>',LOGICICON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg28" height="55" width="55" version="1.0"> <rect ry="0" rx="0" y="0" x="0" height="55" width="55" id="rect841" style="fill:background_fill_color;fill-opacity:1;stroke:none;stroke-width:14.53336239;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <g id="g26" transform="matrix(0.87134744,0,0,0.87134744,3.2573019,3.5379454)"> <path d="m 14.85,27.1 -0.45,13.15 4.35,-2.4 c 0,0 6.349418,4.294879 10.2,4.05 4.946317,-0.314563 11.65,-7.5 11.65,-7.5 l -2.25,-2.3 c 0,0 -5.615371,6.15399 -9.4,6.65 -2.286298,0.29964 -7.05,-2.5 -7.05,-2.5 L 26,34.1 14.85,27.1 z" style="fill:fill_color;stroke:stroke_color;stroke-width:1.29999995;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> <path d="m 40.15,28.955044 0.45,-13.150001 -4.35,2.4 c 0,0 -6.349418,-4.294879 -10.2,-4.05 -4.946317,0.314563 -11.65,7.5 -11.65,7.5 l 2.25,2.3 c 0,0 5.615371,-6.15399 9.4,-6.65 2.286298,-0.29964 7.05,2.5 7.05,2.5 l -4.1,2.15 11.15,7.000001 z" style="fill:fill_color;stroke:stroke_color;stroke-width:1.29999995;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /> </g> <path id="path843" d="M 0,0.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path843-3" d="M 0,54.5 H 55" style="fill:none;stroke:stroke_color;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> </svg>',TRASHICON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg12" version="1.1" viewBox="0 0 55.000003 55"> <g transform="translate(3.2399972,2.2500001)" id="g825"> <path d="M 37.422492,7.0250365 H 33.372495 L 31.932496,5.5850377 A 1.9799983,1.9799983 0 0 0 30.514997,5.0000382 H 18.072508 A 1.9799983,1.9799983 0 0 0 16.655009,5.5850377 L 15.14751,7.0250365 H 11.097514 A 2.0249983,2.0249983 0 0 0 9.0725156,9.0500348 V 11.075033 H 39.44749 V 9.0500348 A 2.0249983,2.0249983 0 0 0 37.422492,7.0250365 Z" style="fill:#808080;stroke-width:2.24999809" id="path4" /> <path id="path6" d="m 11.097656,13.099609 v 10.439453 19.935547 c -2.17e-4,1.118682 0.906709,2.025608 2.025391,2.025391 h 8.121094 6.03125 8.123047 c 1.117919,-8.62e-4 2.023654,-0.907471 2.023437,-2.025391 V 23.539062 13.099609 Z" style="fill:#808080;stroke-width:2.24999809" /> </g> </svg>',PALETTEICONS={search:SEARCHPALETTEICON,widgets:MATRIXPALETTEICON,rhythm:NOTESPALETTEICON,meter:METERPALETTEICON,pitch:PITCHPALETTEICON,tone:TONEPALETTEICON,ornament:ORNAMENTPALETTEICON,intervals:INTERVALSPALETTEICON,volume:VOLUMEPALETTEICON,drum:DRUMPALETTEICON,graphics:TURTLEPALETTEICON,turtle:TURTLEPALETTEICON,pen:PENPALETTEICON,number:NUMBERPALETTEICON,boolean:BOOLEANPALETTEICON,flow:FLOWPALETTEICON,boxes:BLOCKSPALETTEICON,action:ACTIONSPALETTEICON,media:MEDIAPALETTEICON,sensors:SENSORSPALETTEICON,extras:EXTRASPALETTEICON,myblocks:MYBLOCKSPALETTEICON,heap:HEAPPALETTEICON,ensemble:TURTLESPALETTEICON,music:MUSICICON,artwork:GRAPHICSICON,logic:LOGICICON},CANCELBUTTON='<?xml version="1.0" ?><svg enable-background="new 0 0 55.125 55" height="55px" version="1.1" viewBox="0 0 55.125 55" width="55.125px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"><g display="block" id="dialog-cancel"> \t<path d="M27.557,5.053c-12.43,0-22.5,10.076-22.5,22.497c0,12.432,10.07,22.503,22.5,22.503 c12.431,0,22.5-10.071,22.5-22.503C50.057,15.129,39.987,5.053,27.557,5.053z M37.756,33.212c1.254,1.256,1.257,3.291,0,4.545 c-0.628,0.629-1.451,0.943-2.274,0.943c-0.822,0-1.644-0.314-2.27-0.94l-5.76-5.761l-5.76,5.761 c-0.627,0.626-1.449,0.94-2.271,0.94c-0.823,0-1.647-0.314-2.275-0.943c-1.254-1.254-1.254-3.289,0.004-4.545l5.758-5.758 l-5.758-5.758c-1.258-1.254-1.258-3.292-0.004-4.546c1.255-1.254,3.292-1.259,4.546,0l5.76,5.759l5.76-5.759 c1.252-1.259,3.288-1.254,4.544,0c1.257,1.254,1.254,3.292,0,4.546l-5.758,5.758L37.756,33.212z" display="inline" fill="#c0c0c0"/> </g></svg>',STOPTURTLEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path id="path2" fill="none" d="M0 0h24v24H0z" /> <path style="fill:#ffffff" id="path4" d="M 6,6 H 18 V 18 H 6 Z" /></svg>',NEWBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path id="path2" fill="none" d="M0 0h24v24H0z" /> <path style="fill:#ffffff" id="path4" d="M 14,2 H 6 C 4.9,2 4.01,2.9 4.01,4 L 4,20 c 0,1.1 0.89,2 1.99,2 H 18 c 1.1,0 2,-0.9 2,-2 V 8 Z m 2,14 h -3 v 3 H 11 V 16 H 8 v -2 h 3 v -3 h 2 v 3 h 3 z M 13,9 V 3.5 L 18.5,9 Z" /></svg>',LOADBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path style="fill:#ffffff" id="path2" d="M 10,4 H 4 C 2.9,4 2.01,4.9 2.01,6 L 2,18 c 0,1.1 0.9,2 2,2 h 16 c 1.1,0 2,-0.9 2,-2 V 8 C 22,6.9 21.1,6 20,6 h -8 z" /> <path id="path4" fill="none" d="M0 0h24v24H0z" /></svg>',OPENMERGEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 54.999998 55" version="1.1" id="svg8" width="55" height="55"> <g id="_2" data-name=" 2" transform="matrix(2.4725237,0,0,2.4725237,5.0000683,9.3764013)"> <g id="Icon"> <path d="M 16.38,12.79 H 1.82 V 3.65 h 14.56 z m 0,-11 H 9.1 L 7.28,0 H 1.82 A 1.82,1.82 0 0 0 0,1.83 v 11 a 1.84,1.84 0 0 0 1.82,1.83 H 16.38 A 1.84,1.84 0 0 0 18.2,12.83 V 3.65 A 1.83,1.83 0 0 0 16.38,1.83 Z" style="fill:#ffffff" id="path4" /> </g> </g> <g id="g914" transform="matrix(1.1228079,0,0,1.1228079,-3.5175661,-3.7519221)"> <line style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_11" y2="24.141842" y1="34.704239" x2="31.403467" x1="31.403467" /> <polyline style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_10" points="30.994023323059082,28.120304211974144 28.845248222351074,30.668672665953636 26.696473121643066,28.120304211974144 " transform="rotate(-90,28.8452,29.3945)" /> <line style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_18" y2="24.454344" y1="29.391743" x2="23.840975" x1="23.840975" /> <line style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_19" y2="26.985588" y1="31.922991" x2="26.434725" x1="26.434725" transform="rotate(90,26.4347,29.4543)" /> <circle style="fill:none;stroke:#ffffff" r="1.312498" stroke-opacity="null" fill-opacity="null" cx="31.312494" cy="22.437506" id="svg_21" /> <circle style="fill:none;stroke:#ffffff" r="1.312498" stroke-opacity="null" fill-opacity="null" cx="23.812502" cy="22.437506" id="svg_22" /> <circle style="fill:none;stroke:#ffffff" r="1.312498" stroke-opacity="null" fill-opacity="null" cx="31.437494" cy="36.624996" id="svg_23" /> <line style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_31" y2="24.016842" y1="34.579239" x2="31.403467" x1="31.403467" /> <polyline style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_32" points="30.994023323059082,28.120304211974144 28.845248222351074,30.668672665953636 26.696473121643066,28.120304211974144 " transform="rotate(-90,28.8452,29.3945)" /> <line style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_33" y2="24.454344" y1="29.391743" x2="23.840975" x1="23.840975" /> <line style="fill:none;stroke:#ffffff;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round" id="svg_34" y2="26.985588" y1="31.922991" x2="26.434725" x1="26.434725" transform="rotate(90,26.4347,29.4543)" /> <circle style="fill:none;stroke:#ffffff" r="1.312498" stroke-opacity="null" fill-opacity="null" cx="31.312494" cy="22.437506" id="svg_35" /> <circle style="fill:none;stroke:#ffffff" r="1.312498" stroke-opacity="null" fill-opacity="null" cx="23.812502" cy="22.437506" id="svg_36" /> <circle style="fill:none;stroke:#ffffff" r="1.312498" stroke-opacity="null" fill-opacity="null" cx="31.437494" cy="36.624996" id="svg_37" /> </g> </svg>',OPENBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg8" version="1.1" viewBox="0 0 54.999998 55"> <g transform="matrix(2.4725237,0,0,2.4725237,5.0000683,9.3764013)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 16.38,12.79 H 1.82 V 3.65 h 14.56 z m 0,-11 H 9.1 L 7.28,0 H 1.82 A 1.82,1.82 0 0 0 0,1.83 v 11 a 1.84,1.84 0 0 0 1.82,1.83 H 16.38 A 1.84,1.84 0 0 0 18.2,12.83 V 3.65 A 1.83,1.83 0 0 0 16.38,1.83 Z" /> </g> </g> </svg>',SAVEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path style="fill:#ffffff" id="path2" d="m 19,12 v 7 H 5 V 12 H 3 v 7 c 0,1.1 0.9,2 2,2 h 14 c 1.1,0 2,-0.9 2,-2 v -7 z m -6,0.67 2.59,-2.58 1.41,1.41 -5,5 -5,-5 1.41,-1.41 2.59,2.58 V 3 h 2 z" /> <path id="path4" d="M0 0h24v24H0z" fill="none" /></svg>',PLANETBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path id="path2" fill="none" d="M0 0h24v24H0z" /> <path style="fill:#ffffff" id="path4" d="M 12,2 C 6.48,2 2,6.48 2,12 2,17.52 6.48,22 12,22 17.52,22 22,17.52 22,12 22,6.48 17.52,2 12,2 Z M 11,19.93 C 7.05,19.44 4,16.08 4,12 4,11.38 4.08,10.79 4.21,10.21 L 9,15 v 1 c 0,1.1 0.9,2 2,2 z m 6.9,-2.54 C 17.64,16.58 16.9,16 16,16 h -1 v -3 c 0,-0.55 -0.45,-1 -1,-1 H 8 v -2 h 2 c 0.55,0 1,-0.45 1,-1 V 7 h 2 c 1.1,0 2,-0.9 2,-2 V 4.59 c 2.93,1.19 5,4.06 5,7.41 0,2.08 -0.8,3.97 -2.1,5.39 z" /></svg>',HELPBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path id="path2" fill="none" d="M0 0h24v24H0z" /> <path style="fill:#ffffff" id="path4" d="M 12,2 C 6.48,2 2,6.48 2,12 2,17.52 6.48,22 12,22 17.52,22 22,17.52 22,12 22,6.48 17.52,2 12,2 Z m 1,17 h -2 v -2 h 2 z m 2.07,-7.75 -0.9,0.92 C 13.45,12.9 13,13.5 13,15 h -2 v -0.5 c 0,-1.1 0.45,-2.1 1.17,-2.83 l 1.24,-1.26 C 13.78,10.05 14,9.55 14,9 14,7.9 13.1,7 12,7 10.9,7 10,7.9 10,9 H 8 c 0,-2.21 1.79,-4 4,-4 2.21,0 4,1.79 4,4 0,0.88 -0.36,1.68 -0.93,2.25 z" /></svg>',SLOWBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path id="path2" fill="none" d="M0 0h24v24H0z" /> <path style="fill:#ffffff" id="path4" d="M 10,16.5 16,12 10,7.5 Z M 12,2 C 6.48,2 2,6.48 2,12 2,17.52 6.48,22 12,22 17.52,22 22,17.52 22,12 22,6.48 17.52,2 12,2 Z m 0,18 C 7.59,20 4,16.41 4,12 4,7.59 7.59,4 12,4 c 4.41,0 8,3.59 8,8 0,4.41 -3.59,8 -8,8 z" /></svg>',SHOWBLOCKSBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42" version="1.1" id="svg10" width="42" height="42"> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#292929" id="rect4" x="0" y="0" /> <g style="fill:#ffffff" id="_2" data-name=" 2" transform="matrix(1.8,0,0,1.8,3,6.375)"> <g style="fill:#ffffff" id="Icon"> <path d="M 10,5.54 A 2.59,2.59 0 1 0 12.58,8.12 2.58,2.58 0 0 0 10,5.54 Z m 0,3.84 A 1.26,1.26 0 1 1 11.25,8.12 1.25,1.25 0 0 1 10,9.38 Z" style="fill:#ffffff" id="path4" /> <path d="M 17.5,0 H 11.25 V 2.5 H 3.75 V 0 H 2.5 A 2.5,2.5 0 0 0 0,2.5 v 8.75 a 2.5,2.5 0 0 0 2.5,2.5 h 1.25 v 2.5 h 7.5 v -2.5 H 17.5 A 2.5,2.5 0 0 0 20,11.25 V 2.5 A 2.5,2.5 0 0 0 17.5,0 Z m -1.77,8.9 a 7.28,7.28 0 0 1 -5.73,3 7.28,7.28 0 0 1 -5.73,-3 1.25,1.25 0 0 1 0,-1.55 7.28,7.28 0 0 1 5.73,-3 7.28,7.28 0 0 1 5.73,3 1.25,1.25 0 0 1 0,1.55 z" style="fill:#ffffff" id="path6" /> </g> </g> </svg>',HIDEBLOCKSBUTTON=SHOWBLOCKSBUTTON,HIDEBLOCKSFADEDBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42" version="1.1" id="svg10" width="42" height="42"> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#ff2929" id="rect4" x="0" y="0" /> <g style="fill:#ffffff" id="_2" data-name=" 2" transform="matrix(1.8,0,0,1.8,3,6.375)"> <g style="fill:#ffffff" id="Icon"> <path d="M 10,5.54 A 2.59,2.59 0 1 0 12.58,8.12 2.58,2.58 0 0 0 10,5.54 Z m 0,3.84 A 1.26,1.26 0 1 1 11.25,8.12 1.25,1.25 0 0 1 10,9.38 Z" style="fill:#ffffff" id="path4" /> <path d="M 17.5,0 H 11.25 V 2.5 H 3.75 V 0 H 2.5 A 2.5,2.5 0 0 0 0,2.5 v 8.75 a 2.5,2.5 0 0 0 2.5,2.5 h 1.25 v 2.5 h 7.5 v -2.5 H 17.5 A 2.5,2.5 0 0 0 20,11.25 V 2.5 A 2.5,2.5 0 0 0 17.5,0 Z m -1.77,8.9 a 7.28,7.28 0 0 1 -5.73,3 7.28,7.28 0 0 1 -5.73,-3 1.25,1.25 0 0 1 0,-1.55 7.28,7.28 0 0 1 5.73,-3 7.28,7.28 0 0 1 5.73,3 1.25,1.25 0 0 1 0,1.55 z" style="fill:#ffffff" id="path6" /> </g> </g> </svg>',ENLARGEBLOCKSBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="42" width="42" id="svg8" version="1.1" viewBox="0 0 42 42"> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#292929" id="rect4" x="0" y="0" /> <g style="fill:#ffffff" id="_2" data-name=" 2" transform="matrix(1.8,0,0,1.8,3,6.375)"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 17.5,0 H 11.25 V 2.5 H 3.75 V 0 H 2.5 A 2.5,2.5 0 0 0 0,2.5 v 8.75 a 2.5,2.5 0 0 0 2.5,2.5 h 1.25 v 2.5 h 7.5 v -2.5 H 17.5 A 2.5,2.5 0 0 0 20,11.25 V 2.5 A 2.5,2.5 0 0 0 17.5,0 Z M 11,6.66 12.68,5 h -0.91 a 0.43,0.43 0 1 1 0,-0.85 h 1.91 a 0.44,0.44 0 0 1 0.44,0.43 v 0 1.89 A 0.43,0.43 0 0 1 13.7,6.91 0.43,0.43 0 0 1 13.28,6.47 V 5.55 l -1.69,1.7 a 0.43,0.43 0 0 1 -0.6,0 A 0.42,0.42 0 0 1 11,6.66 Z M 9.26,9.34 7.57,11 h 0.91 a 0.44,0.44 0 0 1 0.45,0.43 0.44,0.44 0 0 1 -0.45,0.42 H 6.57 A 0.43,0.43 0 0 1 6.13,11.43 V 9.52 A 0.43,0.43 0 0 1 6.55,9.08 0.43,0.43 0 0 1 7,9.52 v 0.92 l 1.69,-1.7 a 0.42426407,0.42426407 0 1 1 0.6,0.6 z m 0,-2.09 a 0.43,0.43 0 0 1 -0.6,0 L 7,5.55 V 6.47 A 0.43,0.43 0 0 1 6.58,6.91 0.43,0.43 0 0 1 6.16,6.47 V 4.59 c 0,0 0,0 0,0 v 0 A 0.44,0.44 0 0 1 6.6,4.16 h 1.88 a 0.43,0.43 0 1 1 0,0.85 H 7.57 l 1.69,1.65 a 0.42,0.42 0 0 1 0,0.59 z m 4.87,4.15 v 0 a 0.45,0.45 0 0 1 -0.45,0.42 h -1.91 a 0.44,0.44 0 0 1 -0.45,-0.42 0.44,0.44 0 0 1 0.45,-0.43 h 0.91 L 11,9.34 a 0.42426407,0.42426407 0 1 1 0.6,-0.6 l 1.69,1.7 V 9.52 a 0.43,0.43 0 0 1 0.42,-0.44 0.43,0.43 0 0 1 0.42,0.44 v 0 z" /> </g> </g> </svg>',COLLAPSEBLOCKSBUTTON=ENLARGEBLOCKSBUTTON,UTILITYBUTTONGEAR='<svg xmlns="http://www.w3.org/2000/svg" width="55" height="55"> <g transform="matrix(0.64,0,0,0.63959066,9.90448,9.9400384)" > <polygon points="26.891,12.363 17.238,16.369 14.659,4.975 20.555,2.531 " style="fill:#ffffff" /> <polygon points="42.646,26.88 38.649,17.228 50.04,14.654 52.477,20.55 " style="fill:#ffffff" /> <polygon points="28.117,42.645 37.775,38.645 40.349,50.029 34.453,52.471 " style="fill:#ffffff" /> <polygon points="37.824,16.315 28.171,12.309 34.394,2.439 40.295,4.882 " style="fill:#ffffff" /> <polygon points="38.628,37.791 42.623,28.139 52.493,34.365 50.055,40.258 " style="fill:#ffffff" /> <polygon points="16.385,37.76 12.391,28.105 2.515,34.34 4.953,40.234 " style="fill:#ffffff" /> <polygon points="12.319,26.875 16.32,17.216 4.936,14.643 2.493,20.539 " style="fill:#ffffff" /> <polygon points="26.939,42.623 17.287,38.629 14.719,50.018 20.609,52.461 " style="fill:#ffffff" /> <path d="m 39.925,22.352 c 2.845,6.863 -0.412,14.728 -7.274,17.574 -6.867,2.85 -14.734,-0.418 -17.578,-7.281 -2.84,-6.862 0.418,-14.733 7.279,-17.572 6.862,-2.845 14.734,0.417 17.573,7.279 z" style="fill:none;stroke:#ffffff;stroke-width:11.69439983" /> </g> </svg> ',UTILITYBUTTONSPANNER='<?xml version="1.0" ?><svg enable-background="new 0 0 55 55" height="55px" id="Layer_1" style="" version="1.1" viewBox="0 0 55 55" width="55px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"><g display="block" id="preferences-system" style=""> <path d="M51.103,50.895c-2.343,2.343-6.143,2.343-8.485,0L19.813,28.091c-2.343-2.343-2.343-6.143,0-8.485l0,0 c2.343-2.343,6.143-2.343,8.485,0l22.804,22.804C53.445,44.752,53.445,48.552,51.103,50.895L51.103,50.895z" fill="#ffffff" style=""/> <g style=""> <g style=""> <path d="M17.813,2.254c-0.804,0-1.587,0.081-2.358,0.2l10.557,10.558L13.22,25.804L2.662,15.246 c-0.119,0.771-0.2,1.555-0.2,2.36c0,8.479,6.873,15.352,15.351,15.352s15.351-6.873,15.351-15.352 C33.164,9.127,26.291,2.254,17.813,2.254z" fill="#ffffff" style=""/> </g> </g> </g></svg>',UTILITYBUTTON=UTILITYBUTTONGEAR,RESTORETRASHBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path style="fill:#ffffff" id="path2" d="m 19,4 h -3.5 l -1,-1 h -5 l -1,1 H 5 V 6 H 19 Z M 6,7 v 12 c 0,1.1 0.9,2 2,2 h 8 c 1.1,0 2,-0.9 2,-2 V 7 Z m 8,7 v 4 H 10 V 14 H 8 l 4,-4 4,4 z" /> <path id="path4" d="M0 0h24v24H0z" fill="none" /></svg>',MENUBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path style="fill:#ffffff" id="path2" d="m 2,15.5 v 2 h 20 v -2 z m 0,-5 v 2 h 20 v -2 z m 0,-5 v 2 h 20 v -2 z" /> <path id="path4" fill="none" d="M0 0h24v24H0z" /></svg>',GOHOMEFADEDBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="42" height="42" id="svg2" version="1.1"> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#292929" id="rect834" x="0" y="0" /> <g transform="matrix(0.82936636,0,0,0.82936636,-1.8075749,-1.8075749)" id="g830"> <rect style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:none;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:4.5, 4.5;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="rect4167" width="43.406631" height="43.406631" x="5.7966843" y="5.7966843" /> <g id="go-home" transform="matrix(0.75032224,0,0,0.75032224,6.5269987,7.2064703)"> <path id="path874" d="M 27.5,15.96256 8.48131,32.4005 8.55256,48.0374 17,48.0052 V 30.9243 h 9 v 17.0809 h 21.59 l -0.1679,-15.726 z m 4,14.96174 h 8 v 8 h -8 z" style="fill:#ffffff;stroke:none;stroke-width:3.5;stroke-linecap:round" /> <path id="path876" d="M 5.48131,27.4005 27.5,8.96256 l 11.3997,9.11494 -0.036,-8.81628 4.0299,0.01041 -0.0104,12.05297 7.5389,5.9546" style="fill:none;stroke:#ffffff;stroke-width:4.5;stroke-linecap:round" /> </g> </g> </svg>',GOHOMEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="42" height="42" id="svg2" version="1.1"> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#ff2929" id="rect834" x="0" y="0" /> <g transform="matrix(0.82936636,0,0,0.82936636,-1.8075749,-1.8075749)" id="g830"> <rect style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:none;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:4.5, 4.5;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="rect4167" width="43.406631" height="43.406631" x="5.7966843" y="5.7966843" /> <g id="go-home" transform="matrix(0.75032224,0,0,0.75032224,6.5269987,7.2064703)"> <path id="path874" d="M 27.5,15.96256 8.48131,32.4005 8.55256,48.0374 17,48.0052 V 30.9243 h 9 v 17.0809 h 21.59 l -0.1679,-15.726 z m 4,14.96174 h 8 v 8 h -8 z" style="fill:#ffffff;stroke:none;stroke-width:3.5;stroke-linecap:round" /> <path id="path876" d="M 5.48131,27.4005 27.5,8.96256 l 11.3997,9.11494 -0.036,-8.81628 4.0299,0.01041 -0.0104,12.05297 7.5389,5.9546" style="fill:none;stroke:#ffffff;stroke-width:4.5;stroke-linecap:round" /> </g> </g> </svg>',SAVEDARKBUTTON=SAVEBUTTON,UPLOADPLANETBUTTON='<svg width="55.000001" height="55.000001" xmlns="http://www.w3.org/2000/svg"> <g> <title>background</title> <rect fill="none" id="canvas_background" height="402" width="582" y="-1" x="-1"/> </g> <g> <title>Layer 1</title> <g id="layer1"> <path fill="#ffffff" id="path4214" d="m23.766615,3.567021c-11.002951,0 -19.93288,8.930108 -19.93288,19.932983c0,11.002991 8.92993,19.932861 19.93288,19.932861c11.002951,0 19.932882,-8.929871 19.932882,-19.932861c0,-11.002875 -8.929932,-19.932983 -19.932882,-19.932983zm-1.99329,35.739723c-7.873482,-0.976681 -13.953011,-7.674141 -13.953011,-15.80674c0,-1.23579 0.15946,-2.411934 0.418591,-3.567963l9.54785,9.547913l0,1.99324c0,2.192646 1.793961,3.986477 3.98657,3.986477l0,3.847073zm13.753691,-5.06292c-0.51825,-1.614544 -1.99329,-2.77063 -3.787251,-2.77063l-1.993279,0l0,-5.979836c0,-1.096439 -0.896982,-1.993355 -1.99329,-1.993355l-11.959732,0l0,-3.986599l3.98658,0c1.09631,0 1.99328,-0.896915 1.99328,-1.993298l0,-3.986478l3.98658,0c2.192621,0 3.986582,-1.794008 3.986582,-3.986714l0,-0.817154c5.840328,2.372054 9.966438,8.092779 9.966438,14.770243c0,4.146004 -1.594627,7.913311 -4.185909,10.74382z"/> </g> <polyline fill="none" points="11.386,18.559 20.773,18.559 20.773,9.173 " id="polyline3009"/> <line fill="none" stroke="#ffffff" stroke-width="2.9867" stroke-linecap="round" stroke-linejoin="round" x1="44.994993" x2="44.994993" y1="50.749995" y2="38.833995" id="line3011"/> <polyline transform="rotate(180, 44.995, 39.2853)" fill="none" stroke="#ffffff" stroke-width="2.9867" stroke-linecap="round" stroke-linejoin="round" points="50.1249942779541,36.243345975875854 44.99499320983887,42.32734560966492 39.8649959564209,36.243345975875854 " id="polyline3013"/> </g> </svg>',PLANETDISABLEDBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 55 55" height="55" width="55"> <path id="path2" fill="none" d="M0 0h24v24h-24z" /> <path style="fill:#e3e3e3" id="path4" transform="scale(2.29)" d="M12 2c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79l4.79 4.79v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1h-6v-2h2c.55 0 1-.45 1-1v-2h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" /> </svg> ',SAVESVGBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg18" version="1.1" viewBox="0 0 54.999998 54.999999"> <g transform="matrix(2.0347429,0,0,2.0347429,6.5319066,5.0321823)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 0.82,5.55 A 0.84,0.84 0 0 1 1.65,6.38 0.83,0.83 0 0 1 0.82,7.2 0.82,0.82 0 0 1 0,6.38 0.83,0.83 0 0 1 0.82,5.55 Z" /> <path id="path6" style="fill:#ffffff" d="M 2.5,6.12 2.86,5.5 A 0.23,0.23 0 0 1 3.2,5.43 3.31,3.31 0 0 0 4.71,6.05 0.83,0.83 0 0 0 5.62,5.28 C 5.62,4.77 5.19,4.42 4.35,4.08 3.51,3.74 2.47,3.08 2.47,1.92 A 2,2 0 0 1 4.72,0 3.52,3.52 0 0 1 6.72,0.67 0.25,0.25 0 0 1 6.78,1 L 6.4,1.57 A 0.26,0.26 0 0 1 6.05,1.69 3.29,3.29 0 0 0 4.66,1.14 0.8,0.8 0 0 0 3.78,1.84 c 0,0.47 0.37,0.79 1.18,1.12 1,0.39 2.09,1 2.09,2.26 a 2.11,2.11 0 0 1 -2.3,2 3.22,3.22 0 0 1 -2.2,-0.78 C 2.46,6.33 2.41,6.28 2.5,6.12 Z" /> <path id="path8" style="fill:#ffffff" d="M 7.42,0.36 A 0.18,0.18 0 0 1 7.59,0.1 h 1 a 0.18,0.18 0 0 1 0.17,0.11 l 1.92,4.3 h 0.07 l 1.94,-4.3 A 0.18,0.18 0 0 1 12.86,0.1 h 1 a 0.18,0.18 0 0 1 0.17,0.26 L 11,7.09 A 0.18,0.18 0 0 1 10.83,7.2 h -0.1 A 0.18,0.18 0 0 1 10.56,7.09 Z" /> <path id="path10" style="fill:#ffffff" d="m 18.05,0 a 3.78,3.78 0 0 1 2.44,0.93 0.19,0.19 0 0 1 0,0.28 l -0.62,0.65 a 0.17,0.17 0 0 1 -0.26,0 A 2.27,2.27 0 0 0 18.1,1.28 2.29,2.29 0 0 0 15.87,3.6 2.27,2.27 0 0 0 18.12,5.89 3.13,3.13 0 0 0 19.31,5.64 V 4.79 h -0.8 A 0.18,0.18 0 0 1 18.32,4.61 V 3.82 a 0.18,0.18 0 0 1 0.19,-0.19 h 1.92 a 0.19,0.19 0 0 1 0.18,0.19 v 2.56 a 0.19,0.19 0 0 1 -0.08,0.16 5.05,5.05 0 0 1 -2.48,0.65 3.6,3.6 0 0 1 0,-7.19 z" /> <path id="path12" style="fill:#ffffff" d="m 18.41,10.1 h -16 a 1,1 0 0 0 -1,1 v 10 a 1,1 0 0 0 1,1 h 16 a 1,1 0 0 0 1,-1 v -10 a 1,1 0 0 0 -1,-1 z m -4,4 -4.5,4.5 -0.5,-0.5 -2,-2 -4.71,4.7 A 1,1 0 0 1 2.41,20.1 v -8 a 1,1 0 0 1 1,-1 h 14 a 1,1 0 0 1 1,1 v 6 z" /> <circle id="circle14" style="fill:#ffffff" r="1" cy="13.6" cx="5.9099998" /> </g> </g> </svg>',SAVEPNGBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg18" version="1.1" viewBox="0 0 55.000002 54.999999"> <g transform="matrix(2.0361991,0,0,2.0361991,4.9184841,4.9999999)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 0.82,5.55 A 0.84,0.84 0 0 1 1.65,6.38 0.83,0.83 0 0 1 0.82,7.2 0.82,0.82 0 0 1 0,6.38 0.83,0.83 0 0 1 0.82,5.55 Z" /> <path id="path6" style="fill:#ffffff" d="M 2.91,0.29 A 0.19,0.19 0 0 1 3.1,0.1 H 5.45 A 2.24,2.24 0 0 1 7.69,2.31 2.25,2.25 0 0 1 5.46,4.56 H 4.21 V 6.91 A 0.2,0.2 0 0 1 4,7.1 H 3.1 A 0.19,0.19 0 0 1 2.91,6.91 Z m 2.46,3.05 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 H 4.21 v 2 z" /> <path id="path8" style="fill:#ffffff" d="M 8.83,0.18 A 0.19,0.19 0 0 1 9,0 h 0.25 l 4.16,4.42 v 0 -4.13 A 0.19,0.19 0 0 1 13.63,0.1 h 0.92 a 0.2,0.2 0 0 1 0.19,0.19 V 7 A 0.19,0.19 0 0 1 14.55,7.18 H 14.31 L 10.13,2.61 v 0 4.3 A 0.19,0.19 0 0 1 9.94,7.1 H 9 A 0.2,0.2 0 0 1 8.81,6.91 Z" /> <path id="path10" style="fill:#ffffff" d="m 19.65,0 a 3.78,3.78 0 0 1 2.44,0.93 0.19,0.19 0 0 1 0,0.28 l -0.62,0.65 a 0.17,0.17 0 0 1 -0.26,0 A 2.27,2.27 0 0 0 19.7,1.28 2.29,2.29 0 0 0 17.47,3.6 2.27,2.27 0 0 0 19.72,5.89 3.13,3.13 0 0 0 20.91,5.64 V 4.79 h -0.8 A 0.18,0.18 0 0 1 19.92,4.61 V 3.82 A 0.18,0.18 0 0 1 20.11,3.63 H 22 a 0.19,0.19 0 0 1 0.18,0.19 V 6.38 A 0.19,0.19 0 0 1 22.1,6.54 5.05,5.05 0 0 1 19.62,7.19 3.6,3.6 0 0 1 19.62,0 Z" /> <path id="path12" style="fill:#ffffff" d="m 19.21,10.1 h -16 a 1,1 0 0 0 -1,1 v 10 a 1,1 0 0 0 1,1 h 16 a 1,1 0 0 0 1,-1 v -10 a 1,1 0 0 0 -1,-1 z m -4,4 -4.5,4.5 -0.5,-0.5 -2,-2 -4.71,4.7 A 1,1 0 0 1 3.21,20.1 v -8 a 1,1 0 0 1 1,-1 h 14 a 1,1 0 0 1 1,1 v 6 z" /> <circle id="circle14" style="fill:#ffffff" r="1" cy="13.6" cx="6.71" /> </g> </g> </svg>',SAVEWAVBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg16" version="1.1" viewBox="0 0 54.999999 54.999999"> <g transform="matrix(2.0472243,0,0,2.0472243,2.6785688,5.0020095)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 0.82,5.55 A 0.84,0.84 0 0 1 1.65,6.38 0.83,0.83 0 0 1 0.82,7.2 0.82,0.82 0 0 1 0,6.38 0.83,0.83 0 0 1 0.82,5.55 Z" /> <path id="path6" style="fill:#ffffff" d="M 2.29,0.34 A 0.17,0.17 0 0 1 2.47,0.1 h 0.92 a 0.21,0.21 0 0 1 0.18,0.14 l 1,4 v 0 L 6.24,0.11 A 0.16,0.16 0 0 1 6.41,0 h 0.18 a 0.16,0.16 0 0 1 0.17,0.11 l 1.6,4.12 v 0 l 1,-4 A 0.21,0.21 0 0 1 9.6,0.1 h 0.92 A 0.17,0.17 0 0 1 10.7,0.34 L 8.81,7.06 A 0.19,0.19 0 0 1 8.63,7.2 H 8.47 A 0.17,0.17 0 0 1 8.3,7.09 L 6.51,2.56 v 0 L 4.69,7.09 A 0.17,0.17 0 0 1 4.52,7.2 H 4.36 A 0.19,0.19 0 0 1 4.18,7.06 Z" /> <path id="path8" style="fill:#ffffff" d="M 11,6.84 14.1,0.11 A 0.18,0.18 0 0 1 14.27,0 h 0.1 a 0.17,0.17 0 0 1 0.17,0.11 l 3.08,6.73 A 0.18,0.18 0 0 1 17.45,7.1 H 16.58 A 0.29,0.29 0 0 1 16.29,6.9 L 15.8,5.82 h -3 L 12.32,6.9 A 0.3,0.3 0 0 1 12.03,7.1 H 11.16 A 0.18,0.18 0 0 1 11,6.84 Z m 4.32,-2.13 -1,-2.2 v 0 l -1,2.2 z" /> <path id="path10" style="fill:#ffffff" d="M 17.62,0.36 A 0.18,0.18 0 0 1 17.79,0.1 h 1 A 0.18,0.18 0 0 1 19,0.21 l 1.92,4.3 H 21 l 1.89,-4.3 A 0.18,0.18 0 0 1 23.06,0.1 h 1 a 0.18,0.18 0 0 1 0.17,0.26 l -3.1,6.73 A 0.18,0.18 0 0 1 21,7.2 H 20.9 A 0.18,0.18 0 0 1 20.73,7.09 Z" /> <path id="path12" style="fill:#ffffff" d="M 17,9.22 H 8.17 V 17 A 2.72,2.72 0 0 0 6.51,16.44 2.77,2.77 0 1 0 9.28,19.2 V 13.64 H 17 V 17 a 2.76,2.76 0 1 0 1.1,2.2 v -10 z" /> </g> </g> </svg>',SAVELILYPONDBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg34" version="1.1" viewBox="0 0 55.000001 55"> <g transform="matrix(1.914129,0,0,1.914129,5.0281255,4.9999999)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 18.2,10 H 8.8 v 8.23 a 2.9,2.9 0 0 0 -1.8,-0.6 2.94,2.94 0 1 0 3,2.93 v -5.87 h 8.2 v 3.54 a 2.93,2.93 0 1 0 1.17,2.33 V 10 Z" /> <path id="path6" style="fill:#ffffff" d="m 23.48,11.76 a 0.58,0.58 0 0 0 -0.59,-0.59 h -2.35 v 1.17 h 2.35 a 0.58,0.58 0 0 0 0.59,-0.58 z" /> <path id="path8" style="fill:#ffffff" d="m 22.89,13.52 h -2.35 v 1.17 h 2.35 a 0.59,0.59 0 1 0 0,-1.17 z" /> <path id="path10" style="fill:#ffffff" d="M 22.89,15.87 H 20.54 V 17 h 2.35 a 0.59,0.59 0 1 0 0,-1.17 z" /> <path id="path12" style="fill:#ffffff" d="m 22.89,18.21 h -2.35 v 1.18 h 2.35 a 0.59,0.59 0 1 0 0,-1.18 z" /> <path id="path14" style="fill:#ffffff" d="m 22.89,20.56 h -2.35 v 1.18 h 2.35 a 0.59,0.59 0 0 0 0.59,-0.59 0.58,0.58 0 0 0 -0.59,-0.59 z" /> <path id="path16" style="fill:#ffffff" d="m 0.59,11.17 a 0.59,0.59 0 1 0 0,1.17 h 7 v -1.17 z" /> <path id="path18" style="fill:#ffffff" d="m 0,14.1 a 0.58,0.58 0 0 0 0.59,0.59 h 7 v -1.17 h -7 A 0.58,0.58 0 0 0 0,14.1 Z" /> <path id="path20" style="fill:#ffffff" d="M 0,16.45 A 0.58,0.58 0 0 0 0.59,17 h 7 v -1.13 h -7 A 0.58,0.58 0 0 0 0,16.45 Z" /> <path id="path22" style="fill:#ffffff" d="m 0,18.8 a 0.59,0.59 0 0 0 0.59,0.59 H 2.93 V 18.21 H 0.59 A 0.59,0.59 0 0 0 0,18.8 Z" /> <path id="path24" style="fill:#ffffff" d="m 0,21.15 a 0.59,0.59 0 0 0 0.59,0.59 H 2.93 V 20.56 H 0.59 A 0.58,0.58 0 0 0 0,21.15 Z" /> <path id="path26" style="fill:#ffffff" d="M 8.53,5.45 A 0.84,0.84 0 0 1 9.36,6.28 0.83,0.83 0 0 1 8.53,7.1 0.82,0.82 0 0 1 7.71,6.28 0.83,0.83 0 0 1 8.53,5.45 Z" /> <path id="path28" style="fill:#ffffff" d="M 10.31,0.19 A 0.2,0.2 0 0 1 10.5,0 h 0.84 a 0.2,0.2 0 0 1 0.19,0.19 V 6.81 A 0.2,0.2 0 0 1 11.34,7 H 10.5 A 0.2,0.2 0 0 1 10.31,6.81 Z" /> <path id="path30" style="fill:#ffffff" d="M 12.21,3.26 A 0.18,0.18 0 0 1 12.38,3 h 0.9 a 0.18,0.18 0 0 1 0.17,0.11 l 1,2.26 v 0 l 1,-2.26 C 15.45,3.01 15.57,3 15.69,3 h 0.8 a 0.17,0.17 0 0 1 0.17,0.26 L 13.62,9.87 A 0.2,0.2 0 0 1 13.45,9.99 H 12.59 A 0.18,0.18 0 0 1 12.42,9.72 l 1.42,-3 z" /> </g> </g> </svg>',SAVEABCBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg16" version="1.1" viewBox="0 0 55.000002 54.999999"> <g transform="matrix(2.0457978,0,0,2.0457978,5.7160355,5.0024652)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 0.82,5.55 A 0.84,0.84 0 0 1 1.65,6.38 0.83,0.83 0 0 1 0.82,7.2 0.82,0.82 0 0 1 0,6.38 0.83,0.83 0 0 1 0.82,5.55 Z" /> <path id="path6" style="fill:#ffffff" d="M 2,6.84 5.11,0.11 A 0.18,0.18 0 0 1 5.28,0 h 0.1 A 0.17,0.17 0 0 1 5.55,0.11 L 8.63,6.84 A 0.18,0.18 0 0 1 8.46,7.1 H 7.59 A 0.29,0.29 0 0 1 7.3,6.9 L 6.81,5.82 h -3 L 3.33,6.9 A 0.3,0.3 0 0 1 3,7.1 H 2.17 A 0.18,0.18 0 0 1 2,6.84 Z m 4.32,-2.13 -1,-2.2 v 0 l -1,2.2 z" /> <path id="path8" style="fill:#ffffff" d="M 9.54,0.29 A 0.19,0.19 0 0 1 9.73,0.1 H 12 A 2,2 0 0 1 14.13,2 1.9,1.9 0 0 1 13,3.54 1.8,1.8 0 0 1 14.3,5.17 2,2 0 0 1 12.15,7.1 H 9.73 A 0.19,0.19 0 0 1 9.54,6.91 Z M 11.9,3 A 0.86,0.86 0 0 0 12.76,2.1 0.82,0.82 0 0 0 11.9,1.25 H 10.83 V 3 Z M 12,5.92 a 0.89,0.89 0 0 0 0.9,-0.91 1,1 0 0 0 -1,-0.87 h -1.07 v 1.78 z" /> <path id="path10" style="fill:#ffffff" d="m 18.81,0 a 3.38,3.38 0 0 1 2.42,0.93 0.19,0.19 0 0 1 0,0.28 l -0.61,0.63 a 0.16,0.16 0 0 1 -0.25,0 2.37,2.37 0 0 0 -1.54,-0.59 2.27,2.27 0 0 0 -2.23,2.33 2.26,2.26 0 0 0 2.24,2.31 2.4,2.4 0 0 0 1.53,-0.57 0.18,0.18 0 0 1 0.25,0 l 0.62,0.64 a 0.19,0.19 0 0 1 0,0.27 3.43,3.43 0 0 1 -2.43,1 3.6,3.6 0 1 1 0,-7.2 z" /> <path id="path12" style="fill:#ffffff" d="M 15.7,9.22 H 6.86 V 17 A 2.76,2.76 0 1 0 8,19.17 v -5.53 h 7.7 V 17 a 2.72,2.72 0 0 0 -1.7,-0.59 2.77,2.77 0 1 0 2.77,2.76 v -10 z" /> </g> </g> </svg>',SAVEBLOCKARTWORKBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg16" version="1.1" viewBox="0 0 54.999998 55.000002"> <g transform="matrix(1.9551772,0,0,1.9551772,7.3518338,5.0309243)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 0.82,5.55 A 0.84,0.84 0 0 1 1.65,6.38 0.83,0.83 0 0 1 0.82,7.2 0.82,0.82 0 0 1 0,6.38 0.83,0.83 0 0 1 0.82,5.55 Z" /> <path id="path6" style="fill:#ffffff" d="M 2.5,6.12 2.86,5.5 A 0.23,0.23 0 0 1 3.2,5.43 3.31,3.31 0 0 0 4.71,6.05 0.83,0.83 0 0 0 5.62,5.28 C 5.62,4.77 5.19,4.42 4.35,4.08 3.51,3.74 2.47,3.08 2.47,1.92 A 2,2 0 0 1 4.72,0 3.52,3.52 0 0 1 6.72,0.67 0.25,0.25 0 0 1 6.78,1 L 6.4,1.57 A 0.26,0.26 0 0 1 6.05,1.69 3.29,3.29 0 0 0 4.66,1.14 0.8,0.8 0 0 0 3.78,1.84 c 0,0.47 0.37,0.79 1.18,1.12 1,0.39 2.09,1 2.09,2.26 a 2.11,2.11 0 0 1 -2.3,2 3.22,3.22 0 0 1 -2.2,-0.78 C 2.46,6.33 2.41,6.28 2.5,6.12 Z" /> <path id="path8" style="fill:#ffffff" d="M 7.42,0.36 A 0.18,0.18 0 0 1 7.59,0.1 h 1 a 0.18,0.18 0 0 1 0.17,0.11 l 1.92,4.3 h 0.07 l 1.94,-4.3 A 0.18,0.18 0 0 1 12.86,0.1 h 1 a 0.18,0.18 0 0 1 0.17,0.26 L 11,7.09 A 0.18,0.18 0 0 1 10.83,7.2 h -0.1 A 0.18,0.18 0 0 1 10.56,7.09 Z" /> <path id="path10" style="fill:#ffffff" d="m 18.05,0 a 3.78,3.78 0 0 1 2.44,0.93 0.19,0.19 0 0 1 0,0.28 l -0.62,0.65 a 0.17,0.17 0 0 1 -0.26,0 A 2.27,2.27 0 0 0 18.1,1.28 2.29,2.29 0 0 0 15.87,3.6 2.27,2.27 0 0 0 18.12,5.89 3.13,3.13 0 0 0 19.31,5.64 V 4.79 h -0.8 A 0.18,0.18 0 0 1 18.32,4.61 V 3.82 a 0.18,0.18 0 0 1 0.19,-0.19 h 1.92 a 0.19,0.19 0 0 1 0.18,0.19 v 2.56 a 0.19,0.19 0 0 1 -0.08,0.16 5.05,5.05 0 0 1 -2.48,0.65 3.6,3.6 0 0 1 0,-7.19 z" /> <path id="path12" style="fill:#ffffff" d="m 16.41,10 h -5 v 2 h -6 v -2 h -1 a 2,2 0 0 0 -2,2 v 7 a 2,2 0 0 0 2,2 h 1 v 2 h 6 v -2 h 5 a 2,2 0 0 0 2,-2 v -7 a 2,2 0 0 0 -2,-2 z" /> </g> </g> </svg>',BEGINNERBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg10" version="1.1" viewBox="0 0 54.999998 55.000001"> <g transform="translate(6.2944389,7.2345833)" id="_2" data-name=" 2"> <g id="Icon"> <path d="M 41.82,17.39 A 2,2 0 0 0 40.71,14 L 29.52,12.35 A 2,2 0 0 1 28,11.26 L 23,1.11 a 2,2 0 0 0 -3.59,0 l -5,10.15 a 2,2 0 0 1 -1.5,1.09 L 1.71,14 a 2,2 0 0 0 -1.1,3.41 l 8.1,7.9 a 2,2 0 0 1 0.57,1.77 L 7.37,38.2 a 2,2 0 0 0 2.9,2.11 l 10,-5.26 a 2,2 0 0 1 1.86,0 l 10,5.26 a 2,2 0 0 0 2.9,-2.11 L 33.15,27.06 a 2,2 0 0 1 0.57,-1.77 z m -10.19,5.75 a 5,5 0 0 0 -1.44,4.42 l 1.57,9.15 -8.22,-4.32 a 5,5 0 0 0 -4.65,0 l -8.22,4.32 1.57,-9.15 A 5,5 0 0 0 10.8,23.14 l -6.65,-6.48 9.19,-1.34 a 5,5 0 0 0 3.76,-2.73 l 4.11,-8.33 4.11,8.33 a 5,5 0 0 0 3.77,2.73 l 9.19,1.34 z" style="fill:#ffffff" id="path1015" /> </g> </g> </svg> ',ADVANCEDBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24" height="24" viewBox="0 0 24 24" version="1.1" id="svg6" sodipodi:docname="mode_change.svg" inkscape:version="0.92.3 (2405546, 2018-03-11)"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="785" inkscape:window-height="480" id="namedview8" showgrid="false" inkscape:zoom="9.8333333" inkscape:cx="12" inkscape:cy="12" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="svg6" /> <path d="M 22,9.24 14.81,8.62 12,2 9.19,8.63 2,9.24 7.46,13.97 5.82,21 12,17.27 18.18,21 16.55,13.97 Z m -10,6.16 -3.76,2.27 1,-4.28 -3.32,-2.88 4.38,-0.38 1.7,-4.03 1.71,4.04 4.38,0.38 -3.32,2.88 1,4.28 z" id="path2" style="fill:#ffffff" inkscape:connector-curvature="0" /> <path d="M0 0h24v24H0z" fill="none" id="path4" /></svg>',LANGUAGEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path id="path2" fill="none" d="M0 0h24v24H0z" /> <path style="fill:#ffffff" id="path4" d="m 12.87,15.07 -2.54,-2.51 0.03,-0.03 C 12.1,10.59 13.34,8.36 14.07,6 H 17 V 4 H 10 V 2 H 8 V 4 H 1 V 5.99 H 12.17 C 11.5,7.92 10.44,9.75 9,11.35 8.07,10.32 7.3,9.19 6.69,8 h -2 c 0.73,1.63 1.73,3.17 2.98,4.56 L 2.58,17.58 4,19 9,14 12.11,17.11 Z M 18.5,10 h -2 L 12,22 h 2 l 1.12,-3 h 4.75 L 21,22 h 2 z m -2.62,7 1.62,-4.33 1.62,4.33 z" /></svg>',SHORTCUTSBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg8" version="1.1" viewBox="0 0 14.552084 14.552085" height="14.552085mm" width="14.552084mm"> <defs id="defs2" /> <metadata id="metadata5"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <g transform="translate(-34.509229,-116.40298)" id="layer1"> <rect ry="2.2811759" y="117.47707" x="35.583324" height="12.403892" width="12.403891" id="rect815" style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:2.148;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <text id="text819" y="124.30835" x="36.994572" style="font-style:normal;font-weight:normal;font-size:7.16668034px;line-height:4.47917509px;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.179167px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" xml:space="preserve"><tspan style="stroke-width:0.179167px;fill:#ffffff;fill-opacity:1;" y="124.30835" x="36.994572" id="tspan817">D</tspan></text> </g> </svg>',SMALLERBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="42" height="42" id="svg2" version="1.1"> <metadata id="metadata824"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs822" /> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#292929" id="rect834" x="0" y="0" /> <g transform="matrix(0.78209352,0,0,0.78209352,-1.6688631,0.65371947)" id="g1554"> <g id="g1539"> <circle style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:4.5;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" cx="34.75" cy="20.25" r="15" id="circle1535" /> <path style="fill:none;stroke:#ffffff;stroke-width:6;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 23.870372,31.129628 9,46" id="path1537" /> </g> <path d="m 26.25,20.25 h 17" style="fill:none;stroke:#ffffff;stroke-width:4.5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path1541" /> </g> </svg>',SMALLERDISABLEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="42" height="42" id="svg2" version="1.1"> <metadata id="metadata824"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs822" /> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#FFB700" id="rect834" x="0" y="0" /> <g transform="matrix(0.78209352,0,0,0.78209352,-1.6688631,0.65371947)" id="g1554"> <g id="g1539"> <circle style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:4.5;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" cx="34.75" cy="20.25" r="15" id="circle1535" /> <path style="fill:none;stroke:#ffffff;stroke-width:6;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 23.870372,31.129628 9,46" id="path1537" /> </g> <path d="m 26.25,20.25 h 17" style="fill:none;stroke:#ffffff;stroke-width:4.5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path1541" /> </g> </svg>',BIGGERBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="42" height="42" id="svg2" version="1.1"> <metadata id="metadata824"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs822" /> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#292929" id="rect834" x="0" y="0" /> <circle style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:3.51942086;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" cx="25.508886" cy="16.491114" r="11.731402" id="circle1535" /> <path style="fill:none;stroke:#ffffff;stroke-width:4.69256115;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 17,25 5.3699786,36.630021" id="path1537" /> <path id="path1541" style="fill:none;stroke:#ffffff;stroke-width:3.51942086;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 18.861092,16.491113 h 13.29559" /> <path id="path1541-3" style="fill:none;stroke:#ffffff;stroke-width:3.51942086;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 25.508887,9.843318 v 13.29559" /> </svg>',BIGGERDISABLEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="42" height="42" id="svg2" version="1.1"> <metadata id="metadata824"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs822" /> <rect width="42" height="42" rx="5" ry="5" style="opacity:0.4;isolation:isolate;mix-blend-mode:multiply;fill:#FFB700" id="rect834" x="0" y="0" /> <circle style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:3.51942086;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" cx="25.508886" cy="16.491114" r="11.731402" id="circle1535" /> <path style="fill:none;stroke:#ffffff;stroke-width:4.69256115;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 17,25 5.3699786,36.630021" id="path1537" /> <path id="path1541" style="fill:none;stroke:#ffffff;stroke-width:3.51942086;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 18.861092,16.491113 h 13.29559" /> <path id="path1541-3" style="fill:none;stroke:#ffffff;stroke-width:3.51942086;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 25.508887,9.843318 v 13.29559" /> </svg>',STATSBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path style="fill:#ffffff" id="path2" d="M 19,3 H 5 C 3.9,3 3,3.9 3,5 v 14 c 0,1.1 0.9,2 2,2 h 14 c 1.1,0 2,-0.9 2,-2 V 5 C 21,3.9 20.1,3 19,3 Z M 9,17 H 7 v -7 h 2 z m 4,0 H 11 V 7 h 2 z m 4,0 h -2 v -4 h 2 z" /> <path id="path4" fill="none" d="M0 0h24v24H0z" /></svg>',PLUGINSBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg10" version="1.1" viewBox="0 0 54.999998 55"> <g transform="matrix(2.0102747,0,0,2.0102747,5.0000004,9.1530568)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 10.38,12.75 A 6.5,6.5 0 0 1 20,7.05 V 4 A 1,1 0 0 0 19,3 H 17.88 V 1 a 1,1 0 0 0 -1,-1 h -2.74 a 1,1 0 0 0 -1,1 V 3 H 6.88 V 1 a 1,1 0 0 0 -1,-1 H 3.14 a 1,1 0 0 0 -1,1 V 3 H 1 A 1,1 0 0 0 0,4 v 10.37 a 1,1 0 0 0 1,1 h 9.93 a 6.37,6.37 0 0 1 -0.55,-2.62 z" /> <path id="path6" style="fill:#ffffff" d="m 13,8.86 a 5.5,5.5 0 1 0 7.77,0 5.5,5.5 0 0 0 -7.77,0 z m 6.64,3.2 a 0.69,0.69 0 0 1 0,1.38 h -2.08 v 2.06 a 0.69,0.69 0 1 1 -1.37,0 v -2.06 h -2.07 a 0.69,0.69 0 0 1 0,-1.38 h 2.07 V 10 a 0.69,0.69 0 1 1 1.37,0 v 2.06 z" /> </g> </g> </svg>',PLUGINSDELETEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg6" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata12"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs10" /> <path id="path2" fill="none" d="M0 0h24v24H0z" /> <path style="fill:#ffffff" id="path4" d="M 12,2 C 6.48,2 2,6.48 2,12 2,17.52 6.48,22 12,22 17.52,22 22,17.52 22,12 22,6.48 17.52,2 12,2 Z m 5,11 H 7 v -2 h 10 z" /></svg>',SCROLLLOCKBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg8" version="1.1" viewBox="0 0 55 55"> <g transform="matrix(1.5221942,0,0,1.5221942,17.255633,15.120844)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="m 11.78,6.16 h -0.42 v -1.74 0 a 4.62,4.62 0 0 0 -9.23,0 v 0 1.74 H 1.68 A 1.68,1.68 0 0 0 0,7.84 v 5.05 a 3.37,3.37 0 0 0 3.36,3.36 h 6.73 a 3.37,3.37 0 0 0 3.37,-3.36 V 7.84 A 1.68,1.68 0 0 0 11.78,6.16 Z M 6.69,12.75 C 6,12.75 5.48,11.32 5.48,10.62 a 1.25,1.25 0 0 1 2.5,0 C 8,11.32 7.38,12.75 6.69,12.75 Z M 9.25,6.16 h -5 V 4.63 a 2.52,2.52 0 1 1 5,0 z" /> </g> </g> </svg>',SCROLLUNLOCKBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svg10" version="1.1" viewBox="0 0 24 24" height="24" width="24"> <metadata id="metadata14"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <defs id="defs3"> <path d="M0 0h24v24H0V0z" id="a" /> </defs> <clipPath id="b"> <use id="use5" overflow="visible" xlink:href="#a" /> </clipPath> <path style="fill:#ffffff" id="path8" d="M 9.01,14 H 2 v 2 h 7.01 v 3 L 13,15 9.01,11 Z m 5.98,-1 V 10 H 22 V 8 H 14.99 V 5 L 11,9 Z" clip-path="url(#b)" /></svg>',EMPTYTRASHCONFIRMBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg12" version="1.1" viewBox="0 0 55.000003 55"> <g transform="matrix(2.2499981,0,0,2.2499981,9.0725156,5.0000382)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 12.6,0.9 H 10.8 L 10.16,0.26 A 0.88,0.88 0 0 0 9.53,0 H 4 A 0.88,0.88 0 0 0 3.37,0.26 L 2.7,0.9 H 0.9 A 0.9,0.9 0 0 0 0,1.8 V 2.7 H 13.5 V 1.8 A 0.9,0.9 0 0 0 12.6,0.9 Z" /> <path id="path6" style="fill:#ffffff" d="M 4.38,14.5 A 6.47,6.47 0 0 1 12.6,8.24 V 3.6 H 0.9 V 17.1 A 0.9,0.9 0 0 0 1.8,18 H 5.41 A 6.44,6.44 0 0 1 4.38,14.5 Z" /> <path id="path8" style="fill:#ffffff" d="m 10.88,9 a 5.5,5.5 0 1 0 5.5,5.5 5.5,5.5 0 0 0 -5.5,-5.5 z m 2.43,7 a 0.70710678,0.70710678 0 0 1 -1,1 l -1.45,-1.46 -1.44,1.39 a 0.70710678,0.70710678 0 0 1 -1,-1 L 9.9,14.5 8.44,13 a 0.70710678,0.70710678 0 0 1 1,-1 L 10.9,13.46 12.35,12 a 0.70710678,0.70710678 0 0 1 1,1 l -1.5,1.5 z" /> </g> </g> </svg>',COPYBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg10" version="1.1" viewBox="0 0 55 55"> <title id="title2"> 52</title> <g transform="matrix(2.119632,0,0,2.119632,5.0000003,9.2711648)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="m 3,13.15 h 1 v -7 a 3,3 0 0 1 3,-3 h 2 v 2 h 4.07 v -2 h 3 V 2 a 2,2 0 0 0 -2,-2 H 9.11 V 2 H 3 V 0 H 2 A 2,2 0 0 0 0,2 v 7.11 a 2,2 0 0 0 2,2 h 1 v 2 z" /> <path id="path6" style="fill:#ffffff" d="m 19.23,4.1 h -5.06 v 2 H 8.1 v -2 h -1 a 2,2 0 0 0 -2,2 v 7.1 a 2,2 0 0 0 2,2 h 1 v 2 h 6.07 v -2 h 5.06 a 2,2 0 0 0 2,-2 V 6.12 a 2,2 0 0 0 -2,-2.02 z" /> </g> </g> </svg>',PASTEBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg10" version="1.1" viewBox="0 0 54.999998 55.000001"> <g transform="translate(2.2289291,14.370309)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="M 28.33,0 H 18.21 V 4.05 H 6.07 V 0 h -2 A 4,4 0 0 0 0,4.05 v 14.16 a 4,4 0 0 0 4.05,4.05 h 2 v 4 h 12.16 v -4 h 10.12 a 4,4 0 0 0 4.05,-4.05 V 4.05 A 4,4 0 0 0 28.33,0 Z" /> <path id="path6" style="fill:#ffffff" d="m 37,18.65 5.43,5.42 a 1.56,1.56 0 0 0 1.11,0.46 v 0 a 1.56,1.56 0 0 0 1.13,-0.5 L 50,18.64 a 1.56,1.56 0 1 0 -2.2,-2.2 L 45.08,19.2 V 9.74 a 1.56,1.56 0 1 0 -3.12,0 v 9.5 l -2.8,-2.79 a 1.56,1.56 0 0 0 -2.2,2.2 z" /> </g> </g> </svg>',EXTRACTBUTTON='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" height="55" width="55" id="svg12" version="1.1" viewBox="0 0 55 54.999999"> <g transform="matrix(0.69498069,0,0,0.69498069,5.0000002,11.397297)" data-name=" 2" id="_2"> <g id="Icon"> <path id="path4" style="fill:#ffffff" d="m 61.63,14.12 h -7.82 v 3.13 h -9.37 v -3.13 h -1.56 a 3.13,3.13 0 0 0 -3.13,3.13 v 10.94 a 3.13,3.13 0 0 0 3.13,3.12 h 1.56 v 3.13 h 9.37 v -3.13 h 7.82 a 3.12,3.12 0 0 0 3.12,-3.12 V 17.25 a 3.13,3.13 0 0 0 -3.12,-3.13 z" /> <path id="path6" style="fill:#ffffff" d="m 29.71,28 4.76,-4.76 a 1.29,1.29 0 0 0 0.4,-1 v 0 a 1.42,1.42 0 0 0 -0.44,-1 L 29.71,16.5 a 1.3647161,1.3647161 0 0 0 -1.93,1.93 l 2.42,2.42 h -8.3 a 1.37,1.37 0 1 0 0,2.74 h 8.34 L 27.78,26 a 1.37,1.37 0 0 0 0,1.93 1.35,1.35 0 0 0 1.93,0.07 z" /> <path id="path8" style="fill:#ffffff" d="M 31.38,11.6 V 2.05 a 2.05,2.05 0 0 0 -2.05,-2 H 10.74 V 2.73 H 3.92 V 0 H 2.05 A 2.05,2.05 0 0 0 0,2.05 v 39.56 a 2,2 0 0 0 2.05,2 h 1.87 v 2.73 h 6.82 v -2.69 h 11.77 a 2,2 0 0 0 2,-2 v -9.59 a 2,2 0 0 0 -2,-2.05 H 6.82 V 13.64 h 22.51 a 2,2 0 0 0 2.05,-2.04 z" /> </g> </g> </svg>';-1!==navigator.userAgent.search("Firefox")?(browser.browserAction.onClicked.addListener(function(t){browser.tabs.create({url:"index.html"})}),browser.runtime.onInstalled.addListener(function(t){browser.tabs.create({url:"index.html"})})):(chrome.browserAction.onClicked.addListener(function(t){window.open(chrome.runtime.getURL("index.html"))}),chrome.runtime.onInstalled.addListener(function(t){window.open(chrome.runtime.getURL("index.html"))}));var NAMEDICT={fullscreen:"vspace",fillscreen2:"fillscreen",sandwichclampcollapsed:"clamp",ifelse:"ifthenelse",xcor:"x",ycor:"y",seth:"setheading",remainder2:"mod",plus2:"plus",product2:"multiply",division2:"divide",minus2:"minus",stack:"do",hat:"action",stopstack:"break",clean:"clear",setxy2:"setxy",greater2:"greater",less2:"less",equal2:"equal",random2:"random",setvalue:"setshade",setchroma:"setgrey",setgray:"setgrey",gray:"grey",chroma:"grey",value:"shade",hue:"color",startfill:"beginfill",stopfill:"endfill",string:"text",shell:"turtleshell"};function initBasicProtoBlocks(t,e,i){e.palettes=t;var s=localStorage.languagePreference;void 0===s&&(s=navigator.language),console.log("language setting is "+s),(n=new ProtoBlock("rest")).palette=t.dict.pitch,(e.protoBlockDict.rest=n).valueBlock(),n.dockTypes[0]="textout",n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("square")).palette=t.dict.pitch,(e.protoBlockDict.square=n).staticLabels.push(_("square")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(440),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("triangle")).palette=t.dict.pitch,(e.protoBlockDict.triangle=n).staticLabels.push(_("triangle")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(440),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("sine")).palette=t.dict.pitch,(e.protoBlockDict.sine=n).staticLabels.push(_("sine")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(440),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("sawtooth")).palette=t.dict.pitch,(e.protoBlockDict.sawtooth=n).staticLabels.push(_("sawtooth")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(440),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("invertmode")).palette=t.dict.pitch,(e.protoBlockDict.invertmode=n).valueBlock(),n.dockTypes[0]="textout",n.extraWidth=50,n.hidden=!0,(n=new ProtoBlock("transpositionfactor")).palette=t.dict.pitch,(e.protoBlockDict.transpositionfactor=n).staticLabels.push(_("transposition")),n.adjustWidthToLabel(),n.parameterBlock(),n.hidden=!0,(n=new ProtoBlock("consonantstepsizedown")).palette=t.dict.pitch,(e.protoBlockDict.consonantstepsizedown=n).staticLabels.push(_("scalar step down")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("consonantstepsizedown")&&(n.hidden=!0),(n=new ProtoBlock("consonantstepsizeup")).palette=t.dict.pitch,(e.protoBlockDict.consonantstepsizeup=n).staticLabels.push(_("scalar step up")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("consonantstepsizeup")&&(n.hidden=!0),(n=new ProtoBlock("deltapitch")).palette=t.dict.pitch,(e.protoBlockDict.deltapitch=n).staticLabels.push(_("change in pitch")),n.parameterBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("deltapitch")&&(n.hidden=!0),(n=new ProtoBlock("deltapitch2")).palette=t.dict.pitch,(e.protoBlockDict.deltapitch2=n).staticLabels.push(_("scalar change in pitch")),n.parameterBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("deltapitch2")&&(n.hidden=!0),(n=new ProtoBlock("mypitch")).palette=t.dict.pitch,(e.protoBlockDict.mypitch=n).staticLabels.push(_("pitch number")),n.parameterBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("mypitch")&&(n.hidden=!0),(n=new ProtoBlock("pitchinhertz")).palette=t.dict.pitch,(e.protoBlockDict.pitchinhertz=n).staticLabels.push(_("pitch in hertz")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("pitchinhertz")&&(n.hidden=!0),(n=new ProtoBlock("midi")).palette=t.dict.pitch,(e.protoBlockDict.midi=n).staticLabels.push("MIDI"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("midi")&&(n.hidden=!0),(n=new ProtoBlock("setpitchnumberoffset")).palette=t.dict.pitch,(e.protoBlockDict.setpitchnumberoffset=n).staticLabels.push(_("set pitch number offset")),"ja"===s?(n.staticLabels.push(_("name2")),n.staticLabels.push(_("octave"))):n.staticLabels.push(_("name"),_("octave")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push("C"),n.defaults.push(4),n.dockTypes[1]="notein",n.dockTypes[2]="anyin",i&&!beginnerBlock("setpitchnumberoffset")&&(n.hidden=!0),(n=new ProtoBlock("number2pitch")).palette=t.dict.pitch,(e.protoBlockDict.number2pitch=n).staticLabels.push(_("number to pitch")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.defaults.push(55),i&&!beginnerBlock("number2pitch")&&(n.hidden=!0),(n=new ProtoBlock("number2octave")).palette=t.dict.pitch,(e.protoBlockDict.number2octave=n).staticLabels.push(_("number to octave")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.defaults.push(55),i&&!beginnerBlock("number2octave")&&(n.hidden=!0),(n=new ProtoBlock("accidentalname")).palette=t.dict.pitch,(e.protoBlockDict.accidentalname=n).valueBlock(),n.dockTypes[0]="textout",n.extraWidth=50,i&&!beginnerBlock("accidentalname")&&(n.hidden=!0),(n=new ProtoBlock("eastindiansolfege")).palette=t.dict.pitch,(e.protoBlockDict.eastindiansolfege=n).valueBlock(),n.dockTypes[0]="solfegeout",i&&!beginnerBlock("eastindiansolfege")&&(n.hidden=!0),(n=new ProtoBlock("notename")).palette=t.dict.pitch,(e.protoBlockDict.notename=n).valueBlock(),n.dockTypes[0]="noteout",i&&!beginnerBlock("notename")&&(n.hidden=!0),(n=new ProtoBlock("solfege")).palette=t.dict.pitch,(e.protoBlockDict.solfege=n).valueBlock(),n.dockTypes[0]="solfegeout",i&&!beginnerBlock("solfege")&&(n.hidden=!0),(n=new ProtoBlock("customNote")).palette=t.dict.pitch,(e.protoBlockDict.customNote=n).valueBlock(),n.hidden=!0,(n=new ProtoBlock("invert1")).palette=t.dict.pitch,(e.protoBlockDict.invert1=n).staticLabels.push(_("invert")),"ja"===s?(n.staticLabels.push(_("name2")),n.staticLabels.push(_("octave"))):n.staticLabels.push(_("name"),_("octave")),n.staticLabels.push(_("even")+"/"+_("odd")+"/"+_("scalar")),n.extraWidth=10,n.adjustWidthToLabel(),n.flowClampThreeArgBlock(),n.adjustWidthToLabel(),n.defaults.push("sol"),n.defaults.push(4),n.defaults.push(_("even")),n.dockTypes[1]="solfegein",n.dockTypes[2]="anyin",n.dockTypes[3]="anyin",i&&!beginnerBlock("invert1")&&(n.hidden=!0),(n=new ProtoBlock("invert2")).palette=t.dict.pitch,(e.protoBlockDict.invert2=n).staticLabels.push(_("invert (odd)")),n.staticLabels.push(_("note"),_("octave")),n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.adjustWidthToLabel(),n.defaults.push("sol"),n.defaults.push(4),n.dockTypes[1]="solfegein",n.dockTypes[2]="anyin",n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("invert")).palette=t.dict.pitch,(e.protoBlockDict.invert=n).staticLabels.push(_("invert (even)")),n.staticLabels.push(_("note"),_("octave")),n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.adjustWidthToLabel(),n.defaults.push("sol"),n.defaults.push(4),n.dockTypes[1]="solfegein",n.dockTypes[2]="anyin",n.hidden=!0,(n=new ProtoBlock("register")).palette=t.dict.pitch,(e.protoBlockDict.register=n).staticLabels.push(_("register")),n.defaults.push(0),n.oneArgBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("register")&&(n.hidden=!0),(n=new ProtoBlock("settransposition")).palette=t.dict.pitch,(e.protoBlockDict.settransposition=n).staticLabels.push(_("semi-tone transpose")),n.adjustWidthToLabel(),n.defaults.push("1"),n.flowClampOneArgBlock(),i&&!beginnerBlock("settransposition")&&(n.hidden=!0),(n=new ProtoBlock("octave")).palette=t.dict.pitch,(e.protoBlockDict.octave=n).staticLabels.push(_("octave")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("octave")&&(n.hidden=!0);var l=new ProtoBlock("custompitch");if(l.palette=t.dict.pitch,(e.protoBlockDict.custompitch=l).staticLabels.push(_("custom pitch")),l.adjustWidthToLabel(),l.zeroArgBlock(),l.hidden=!0,(n=new ProtoBlock("downsixth")).palette=t.dict.pitch,(e.protoBlockDict.downsixth=n).staticLabels.push(_("down sixth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downsixth")&&(n.hidden=!0),(n=new ProtoBlock("downthird")).palette=t.dict.pitch,(e.protoBlockDict.downthird=n).staticLabels.push(_("down third")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downthird")&&(n.hidden=!0),(n=new ProtoBlock("seventh")).palette=t.dict.pitch,(e.protoBlockDict.seventh=n).staticLabels.push(_("seventh")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("seventh")&&(n.hidden=!0),(n=new ProtoBlock("sixth")).palette=t.dict.pitch,(e.protoBlockDict.sixth=n).staticLabels.push(_("sixth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("sixth")&&(n.hidden=!0),(n=new ProtoBlock("fifth")).palette=t.dict.pitch,(e.protoBlockDict.fifth=n).staticLabels.push(_("fifth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("fifth")&&(n.hidden=!0),(n=new ProtoBlock("fourth")).palette=t.dict.pitch,(e.protoBlockDict.fourth=n).staticLabels.push(_("fourth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("fourth")&&(n.hidden=!0),(n=new ProtoBlock("third")).palette=t.dict.pitch,(e.protoBlockDict.third=n).staticLabels.push(_("third")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("third")&&(n.hidden=!0),(n=new ProtoBlock("second")).palette=t.dict.pitch,(e.protoBlockDict.second=n).staticLabels.push(_("second")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("second")&&(n.hidden=!0),(n=new ProtoBlock("unison")).palette=t.dict.pitch,(e.protoBlockDict.unison=n).staticLabels.push(_("unison")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("unison")&&(n.hidden=!0),(n=new ProtoBlock("setscalartransposition")).palette=t.dict.pitch,(e.protoBlockDict.setscalartransposition=n).staticLabels.push(_("scalar transpose")+" (+/)"),n.adjustWidthToLabel(),n.defaults.push("1"),n.flowClampOneArgBlock(),i&&beginnerBlock("setscalartransposition")||(n.hidden=!0),(n=new ProtoBlock("accidental")).palette=t.dict.pitch,(e.protoBlockDict.accidental=n).staticLabels.push(_("accidental")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="textin",i&&!beginnerBlock("accidental")&&(n.hidden=!0),(n=new ProtoBlock("flat")).palette=t.dict.pitch,(e.protoBlockDict.flat=n).staticLabels.push(_("flat")+" "),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("flat")&&(n.hidden=!0),(n=new ProtoBlock("sharp")).palette=t.dict.pitch,(e.protoBlockDict.sharp=n).staticLabels.push(_("sharp")+" "),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("sharp")&&(n.hidden=!0),(n=new ProtoBlock("hertz")).palette=t.dict.pitch,(e.protoBlockDict.hertz=n).staticLabels.push(_("hertz")),n.adjustWidthToLabel(),n.oneArgBlock(),"ja"===s?n.defaults.push(440):n.defaults.push(392),i&&!beginnerBlock("hertz")&&(n.hidden=!0),(n=new ProtoBlock("pitchnumber")).palette=t.dict.pitch,(e.protoBlockDict.pitchnumber=n).staticLabels.push(_("pitch number")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(7),n.dockTypes[1]="numberin",i&&!beginnerBlock("pitchnumber")&&(n.hidden=!0),(n=new ProtoBlock("scaledegree")).palette=t.dict.pitch,(e.protoBlockDict.scaledegree=n).staticLabels.push(_("scale degree")),n.staticLabels.push(_("number"),_("octave")),n.adjustWidthToLabel(),n.defaults.push(5),n.defaults.push(4),n.twoArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="anyin",i&&!beginnerBlock("scaledegree")&&(n.hidden=!0),(n=new ProtoBlock("steppitch")).palette=t.dict.pitch,(e.protoBlockDict.steppitch=n).staticLabels.push(_("scalar step")+" (+/)"),n.oneArgBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(1),i&&!beginnerBlock("steppitch")&&(n.hidden=!0),(n=new ProtoBlock("pitch2")).palette=t.dict.pitch,(e.protoBlockDict.pitch2=n).staticLabels.push(_("pitch")+" G4"),n.adjustWidthToLabel(),n.zeroArgBlock(),"ja"===s&&i&&!beginnerBlock("pitch2")&&(n.hidden=!0),(n=new ProtoBlock("pitch")).palette=t.dict.pitch,(e.protoBlockDict.pitch=n).staticLabels.push(_("pitch")),"ja"===s?(n.staticLabels.push(_("name2")),n.staticLabels.push(_("octave"))):n.staticLabels.push(_("name"),_("octave")),n.adjustWidthToLabel(),n.defaults.push("sol"),n.defaults.push(4),n.twoArgBlock(),n.dockTypes[1]="solfegein",n.dockTypes[2]="anyin",i&&!beginnerBlock("pitch")&&(n.hidden=!0),"ja"===s)var o="rhythm";else o="widgets";(n=new ProtoBlock("sixtyfourthNote")).palette=t.dict[o],(e.protoBlockDict.sixtyfourthNote=n).staticLabels.push(_("1/64 note")+" "),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("sixtyfourthNote")&&(n.hidden=!0),(n=new ProtoBlock("thirtysecondNote")).palette=t.dict[o],(e.protoBlockDict.thirtysecondNote=n).staticLabels.push(_("1/32 note")+" "),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("thirtysecondNote")&&(n.hidden=!0),(n=new ProtoBlock("sixteenthNote")).palette=t.dict[o],(e.protoBlockDict.sixteenthNote=n).staticLabels.push(_("1/16 note")+" "),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("sixteenthNote")&&(n.hidden=!0),(n=new ProtoBlock("eighthNote")).palette=t.dict[o],(e.protoBlockDict.eighthNote=n).staticLabels.push(_("eighth note")+" "),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("eighthNote")&&(n.hidden=!0),(n=new ProtoBlock("quarterNote")).palette=t.dict[o],(e.protoBlockDict.quarterNote=n).staticLabels.push(_("quarter note")+" "),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("quarterNote")&&(n.hidden=!0),(n=new ProtoBlock("halfNote")).palette=t.dict[o],(e.protoBlockDict.halfNote=n).staticLabels.push(_("half note")+" "),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("halfNote")&&(n.hidden=!0),(n=new ProtoBlock("wholeNote")).palette=t.dict[o],(e.protoBlockDict.wholeNote=n).staticLabels.push(_("whole note")+" "),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("wholeNote")&&(n.hidden=!0),(n=new ProtoBlock("tuplet2")).palette=t.dict[o],(e.protoBlockDict.tuplet2=n).staticLabels.push(_("tuplet")),n.staticLabels.push(_("number of notes")),n.staticLabels.push(_("note value")),n.extraWidth=20,n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.defaults.push(1),n.defaults.push(4),n.hidden=!0,(n=new ProtoBlock("tuplet3")).palette=t.dict[o],(e.protoBlockDict.tuplet3=n).staticLabels.push(_("tuplet")),n.staticLabels.push(_("number of notes"),_("note value")),n.extraWidth=20,n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.defaults.push(1),n.defaults.push(4),n.hidden=!0,(n=new ProtoBlock("tuplet4")).palette=t.dict[o],(e.protoBlockDict.tuplet4=n).staticLabels.push(_("tuplet")),n.staticLabels.push(_("note value")),n.extraWidth=20,n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(.25),i&&!beginnerBlock("tuplet4")&&(n.hidden=!0),(n=new ProtoBlock("stuplet7")).palette=t.dict[o],(e.protoBlockDict.stuplet7=n).staticLabels.push(_("septuplet")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("stuplet7")&&(n.hidden=!0),(n=new ProtoBlock("stuplet5")).palette=t.dict[o],(e.protoBlockDict.stuplet5=n).staticLabels.push(_("quintuplet")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("stuplet5")&&(n.hidden=!0),(n=new ProtoBlock("stuplet3")).palette=t.dict[o],(e.protoBlockDict.stuplet3=n).staticLabels.push(_("triplet")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("stuplet3")&&(n.hidden=!0),(n=new ProtoBlock("stuplet")).palette=t.dict[o],(e.protoBlockDict.stuplet=n).staticLabels.push(_("simple tuplet")),n.staticLabels.push(_("number of notes"),_("note value")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(3),n.defaults.push(.5),i&&!beginnerBlock("stuplet")&&(n.hidden=!0),(n=new ProtoBlock("rhythm")).palette=t.dict[o],e.protoBlockDict.rhythm=n,"ja"===s?n.staticLabels.push(_("rhythm1")):n.staticLabels.push(_("rhythm")),n.staticLabels.push(_("number of notes"),_("note value")),n.extraWidth=10,n.adjustWidthToLabel(),n.defaults.push(3),n.defaults.push(4),n.twoArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("rhythm2")).palette=t.dict[o],e.protoBlockDict.rhythm2=n,"ja"===s?n.staticLabels.push(_("rhythm1")):n.staticLabels.push(_("rhythm")),n.staticLabels.push(_("number of notes"),_("note value")),n.extraWidth=10,n.adjustWidthToLabel(),n.defaults.push(3),n.defaults.push(4),n.twoArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("rhythm2")&&(n.hidden=!0),(n=new ProtoBlock("mynotevalue")).palette=t.dict.rhythm,(e.protoBlockDict.mynotevalue=n).staticLabels.push(_("note value")),n.parameterBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("mynotevalue")&&(n.hidden=!0),(n=new ProtoBlock("skipfactor")).palette=t.dict.rhythm,(e.protoBlockDict.skipfactor=n).staticLabels.push("skip factor"),n.adjustWidthToLabel(),n.parameterBlock(),n.hidden=!0,(n=new ProtoBlock("osctime")).palette=t.dict.rhythm,(e.protoBlockDict.osctime=n).staticLabels.push(_("milliseconds")),n.extraWidth=40,n.adjustWidthToLabel(),n.labelOffset=15,n.flowClampOneArgBlock(),n.defaults.push(200),i&&!beginnerBlock("osctime")&&(n.hidden=!0),(n=new ProtoBlock("swing")).palette=t.dict.rhythm,(e.protoBlockDict.swing=n).staticLabels.push(_("swing")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(32),n.hidden=!0,(n=new ProtoBlock("newswing")).palette=t.dict.rhythm,(e.protoBlockDict.newswing=n).staticLabels.push(_("swing")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(1/24),n.hidden=!0,(n=new ProtoBlock("newswing2")).palette=t.dict.rhythm,(e.protoBlockDict.newswing2=n).staticLabels.push(_("swing")),n.staticLabels.push(_("swing value")),n.staticLabels.push(_("note value")),n.extraWidth=40,n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.defaults.push(1/24),n.defaults.push(1/8),i&&!beginnerBlock("newswing2")&&(n.hidden=!0),(n=new ProtoBlock("skipnotes")).palette=t.dict.rhythm,(e.protoBlockDict.skipnotes=n).staticLabels.push(_("skip notes")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(2),i&&!beginnerBlock("skipnotes")&&(n.hidden=!0),(n=new ProtoBlock("multiplybeatfactor")).palette=t.dict.rhythm,(e.protoBlockDict.multiplybeatfactor=n).staticLabels.push(_("multiply note value")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(2),i&&!beginnerBlock("multiplybeatfactor")&&(n.hidden=!0),(n=new ProtoBlock("tie")).palette=t.dict.rhythm,(e.protoBlockDict.tie=n).staticLabels.push(_("tie")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("tie")&&(n.hidden=!0),(n=new ProtoBlock("rhythmicdot")).palette=t.dict.rhythm,(e.protoBlockDict.rhythmicdot=n).staticLabels.push(_("dot")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("rhythmicdot2")).palette=t.dict.rhythm,(e.protoBlockDict.rhythmicdot2=n).staticLabels.push(_("dot")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(1),n.dockTypes[1]="numberin",i&&!beginnerBlock("rhythmicdot2")&&(n.hidden=!0),(n=new ProtoBlock("rest2")).palette=t.dict.rhythm,(e.protoBlockDict.rest2=n).staticLabels.push(_("silence")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("rest2")&&(n.hidden=!0),(n=new ProtoBlock("note4")).palette=t.dict.rhythm,e.protoBlockDict.note4=n,"ja"===s?n.staticLabels.push(_("note value drum")):n.staticLabels.push(_("note value")+" "+_("drum")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),i&&!beginnerBlock("note4")&&(n.hidden=!0),(n=new ProtoBlock("note3")).palette=t.dict.rhythm,(e.protoBlockDict.note3=n).staticLabels.push(_("note value")+" "+_("392 hertz")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),i&&!beginnerBlock("note3")&&(n.hidden=!0),(n=new ProtoBlock("note5")).palette=t.dict.rhythm,(e.protoBlockDict.note5=n).staticLabels.push(_("note value")+" 7"),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),i&&!beginnerBlock("note5")&&(n.hidden=!0),(n=new ProtoBlock("note7")).palette=t.dict.rhythm,(e.protoBlockDict.note7=n).staticLabels.push(_("note value")+" 5 4"),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),i&&!beginnerBlock("note7")&&(n.hidden=!0),(n=new ProtoBlock("note6")).palette=t.dict.rhythm,(e.protoBlockDict.note6=n).staticLabels.push(_("note value")+" +1"),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),i&&!beginnerBlock("note6")&&(n.hidden=!0),(n=new ProtoBlock("note2")).palette=t.dict.rhythm,(e.protoBlockDict.note2=n).staticLabels.push(_("note value")+" G4"),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),i&&!beginnerBlock("note2")&&(n.hidden=!0),(n=new ProtoBlock("note1")).palette=t.dict.rhythm,(e.protoBlockDict.note1=n).staticLabels.push(_("note value")+" "+i18nSolfege("sol")+"4"),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),i&&!beginnerBlock("note1")&&(n.hidden=!0),(n=new ProtoBlock("note")).palette=t.dict.rhythm,(e.protoBlockDict.note=n).staticLabels.push("deprecated note value"),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(4),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("newnote")).palette=t.dict.rhythm,(e.protoBlockDict.newnote=n).staticLabels.push(_("note")),"ja"===s?n.staticLabels.push(_("value2")):n.staticLabels.push(_("value")),n.extraWidth=40,n.adjustWidthToLabel(),n.labelOffset=15,n.flowClampOneArgBlock(),n.defaults.push(.25),i&&!beginnerBlock("newnote")&&(n.hidden=!0);var a=new ProtoBlock("definefrequency");(a.palette=t.dict.rhythm,(e.protoBlockDict.definefrequency=a).staticLabels.push(_("define frequency")),a.adjustWidthToLabel(),a.flowClampOneArgBlock(),a.hidden=!0,(n=new ProtoBlock("oscillator")).palette=t.dict.tone,(e.protoBlockDict.oscillator=n).staticLabels.push(_("oscillator")),n.staticLabels.push(_("type")),n.staticLabels.push(_("partials")),n.extraWidth=10,n.adjustWidthToLabel(),n.defaults.push(_("triangle")),n.defaults.push(6),n.twoArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="numberin",n.hidden=!0,(n=new ProtoBlock("filtertype")).palette=t.dict.tone,(e.protoBlockDict.filtertype=n).valueBlock(),n.dockTypes[0]="textout",n.hidden=!0,(n=new ProtoBlock("oscillatortype")).palette=t.dict.tone,(e.protoBlockDict.oscillatortype=n).valueBlock(),n.dockTypes[0]="textout",n.hidden=!0,(n=new ProtoBlock("envelope")).palette=t.dict.widgets,(e.protoBlockDict.envelope=n).staticLabels.push(_("envelope")),n.staticLabels.push(_("attack")),n.staticLabels.push(_("decay")),n.staticLabels.push(_("sustain")),n.staticLabels.push(_("release")),n.extraWidth=10,n.adjustWidthToLabel(),n.defaults.push(1),n.defaults.push(50),n.defaults.push(60),n.defaults.push(1),n.fourArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.dockTypes[3]="numberin",n.dockTypes[4]="numberin",n.hidden=!0,(n=new ProtoBlock("filter")).palette=t.dict.widgets,(e.protoBlockDict.filter=n).staticLabels.push(_("filter")),n.staticLabels.push(_("type")),n.staticLabels.push(_("rolloff")),n.staticLabels.push(_("frequency")),n.extraWidth=10,n.adjustWidthToLabel(),n.defaults.push(_("highpass")),n.defaults.push(-12),n.defaults.push(392),n.threeArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="numberin",n.dockTypes[3]="numberin",n.hidden=!0,(n=new ProtoBlock("temperament")).palette=t.dict.widgets,(e.protoBlockDict.temperament=n).staticLabels.push(_("temperament")),n.extraWidth=20,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampOneArgBlock(),i&&!beginnerBlock("temperament")&&(n.hidden=!0),(n=new ProtoBlock("timbre")).palette=t.dict.widgets,(e.protoBlockDict.timbre=n).staticLabels.push(_("timbre")),n.extraWidth=50,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampOneArgBlock(),n.defaults.push(_("custom")),i&&!beginnerBlock("timbre")&&(n.hidden=!0),(n=new ProtoBlock("meterwidget")).palette=t.dict.widgets,(e.protoBlockDict.meterwidget=n).staticLabels.push(_("meter")),n.extraWidth=20,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("meterwidget")&&(n.hidden=!0),(n=new ProtoBlock("modewidget")).palette=t.dict.widgets,(e.protoBlockDict.modewidget=n).staticLabels.push(_("custom mode")),n.extraWidth=20,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("modewidget")&&(n.hidden=!0),(n=new ProtoBlock("tempo")).palette=t.dict.widgets,(e.protoBlockDict.tempo=n).staticLabels.push(_("tempo")),n.extraWidth=40,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("tempo")&&(n.hidden=!0),(n=new ProtoBlock("pitchdrummatrix")).palette=t.dict.widgets,(e.protoBlockDict.pitchdrummatrix=n).staticLabels.push(_("pitch-drum mapper")),n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("pitchdrummatrix")&&(n.hidden=!0),(n=new ProtoBlock("pitchslider")).palette=t.dict.widgets,(e.protoBlockDict.pitchslider=n).staticLabels.push(_("pitch slider")),n.extraWidth=40,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("pitchslider")&&(n.hidden=!0),"ja"===s)?((n=new ProtoBlock("musickeyboardja")).palette=t.dict.widgets,(e.protoBlockDict.musickeyboardja=n).staticLabels.push(_("music keyboard")),n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("musickeyboard")&&(n.hidden=!0)):((n=new ProtoBlock("musickeyboard2")).palette=t.dict.widgets,(e.protoBlockDict.musickeyboard2=n).staticLabels.push(_("music keyboard")),n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("musickeyboard")&&(n.hidden=!0));(n=new ProtoBlock("musickeyboard")).palette=t.dict.widgets,(e.protoBlockDict.musickeyboard=n).staticLabels.push(_("music keyboard")),n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),n.hidden=!0,(n=new ProtoBlock("pitchstaircase")).palette=t.dict.widgets,(e.protoBlockDict.pitchstaircase=n).staticLabels.push(_("pitch staircase")),n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("pitchstaircase")&&(n.hidden=!0),i&&((n=new ProtoBlock("rhythmruler3")).palette=t.dict.widgets,(e.protoBlockDict.rhythmruler3=n).staticLabels.push(_("rhythm maker")),n.extraWidth=20,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock());(n=new ProtoBlock("rhythmruler2")).palette=t.dict.widgets,(e.protoBlockDict.rhythmruler2=n).staticLabels.push(_("rhythm maker")),n.extraWidth=20,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&(n.hidden=!0),(n=new ProtoBlock("matrixgmajor")).palette=t.dict.widgets,(e.protoBlockDict.matrixgmajor=n).staticLabels.push(_("G major scale")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("matrixgmajor")&&(n.hidden=!0),(n=new ProtoBlock("matrixcmajor")).palette=t.dict.widgets,(e.protoBlockDict.matrixcmajor=n).staticLabels.push(_("C major scale")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("matrixcmajor")&&(n.hidden=!0),(n=new ProtoBlock("matrix")).palette=t.dict.widgets,(e.protoBlockDict.matrix=n).staticLabels.push(_("phrase maker")),n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("matrix")&&(n.hidden=!0),(n=new ProtoBlock("status")).palette=t.dict.widgets,(e.protoBlockDict.status=n).staticLabels.push(_("status")),n.extraWidth=40,n.adjustWidthToLabel(),n.labelOffset=15,n.stackClampZeroArgBlock(),i&&!beginnerBlock("status")&&(n.hidden=!0),(n=new ProtoBlock("currentmeter")).palette=t.dict.meter,(e.protoBlockDict.currentmeter=n).staticLabels.push(_("current meter")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("currentmeter")&&(n.hidden=!0),(n=new ProtoBlock("beatfactor")).palette=t.dict.meter,(e.protoBlockDict.beatfactor=n).staticLabels.push(_("beat factor")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("beatfactor")&&(n.hidden=!0),(n=new ProtoBlock("bpmfactor")).palette=t.dict.meter,e.protoBlockDict.bpmfactor=n,"ja"===s?n.staticLabels.push(_("beats per minute2")):n.staticLabels.push(_("beats per minute")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("bpmfactor")&&(n.hidden=!0),(n=new ProtoBlock("measurevalue")).palette=t.dict.meter,(e.protoBlockDict.measurevalue=n).staticLabels.push(_("measure count")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("measurevalue")&&(n.hidden=!0),(n=new ProtoBlock("beatvalue")).palette=t.dict.meter,(e.protoBlockDict.beatvalue=n).staticLabels.push(_("beat count")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("beatvalue")&&(n.hidden=!0),(n=new ProtoBlock("notecounter")).palette=t.dict.meter,(e.protoBlockDict.notecounter=n).staticLabels.push(_("note counter")),n.argFlowClampBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("notecounter")&&(n.hidden=!0),(n=new ProtoBlock("elapsednotes")).palette=t.dict.meter,(e.protoBlockDict.elapsednotes=n).staticLabels.push(_("whole notes played")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("elapsednotes")&&(n.hidden=!0),(n=new ProtoBlock("elapsednotes2")).palette=t.dict.meter,(e.protoBlockDict.elapsednotes2=n).staticLabels.push(_("notes played")),n.adjustWidthToLabel(),n.oneArgMathBlock(),i&&!beginnerBlock("elapsednotes2")&&(n.hidden=!0),(n=new ProtoBlock("drift")).palette=t.dict.meter,(e.protoBlockDict.drift=n).staticLabels.push(_("no clock")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("drift")&&(n.hidden=!0),(n=new ProtoBlock("offbeatdo")).palette=t.dict.meter,(e.protoBlockDict.offbeatdo=n).staticLabels.push(_("on weak beat do")),n.oneArgBlock(),n.defaults.push(_("action")),n.dockTypes[1]="textin",n.adjustWidthToLabel(),i&&!beginnerBlock("offbeatdo")&&(n.hidden=!0),(n=new ProtoBlock("onbeatdo")).palette=t.dict.meter,e.protoBlockDict.onbeatdo=n,"ja"===s?(n.staticLabels.push(_("on strong beat"),_("beat")),n.staticLabels.push(_("do1"))):n.staticLabels.push(_("on strong beat"),_("beat"),_("do")),n.twoArgBlock(),n.defaults.push(1),n.defaults.push(_("action")),n.dockTypes[1]="numberin",n.dockTypes[2]="textin",n.adjustWidthToLabel(),i&&!beginnerBlock("onbeatdo")&&(n.hidden=!0),(n=new ProtoBlock("everybeatdo")).palette=t.dict.meter,(e.protoBlockDict.everybeatdo=n).staticLabels.push(_("on every note do")),n.oneArgBlock(),n.defaults.push(_("action")),n.adjustWidthToLabel(),n.dockTypes[1]="textin",i&&!beginnerBlock("everybeatdo")&&(n.hidden=!0),(n=new ProtoBlock("setmasterbpm2")).palette=t.dict.meter,(e.protoBlockDict.setmasterbpm2=n).staticLabels.push(_("master beats per minute")),n.staticLabels.push(_("bpm"),_("beat value")),n.extraWidth=15,n.adjustWidthToLabel(),n.defaults.push(90),n.defaults.push(.25),n.twoArgBlock(),i&&!beginnerBlock("setmasterbpm2")&&(n.hidden=!0),(n=new ProtoBlock("setmasterbpm")).palette=t.dict.meter,(e.protoBlockDict.setmasterbpm=n).staticLabels.push(_("master beats per minute")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(90),n.hidden=!0,(n=new ProtoBlock("setbpm3")).palette=t.dict.meter,(e.protoBlockDict.setbpm3=n).staticLabels.push(_("beats per minute")),n.staticLabels.push(_("bpm"),_("beat value")),n.adjustWidthToLabel(),n.defaults.push(90),n.defaults.push(.25),n.twoArgBlock(),i&&!beginnerBlock("setbpm3")&&(n.hidden=!0),(n=new ProtoBlock("setbpm2")).palette=t.dict.meter,(e.protoBlockDict.setbpm2=n).staticLabels.push(_("beats per minute")),n.staticLabels.push(_("bpm"),_("beat value")),n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.defaults.push(90),n.defaults.push(.25),n.hidden=!0,(n=new ProtoBlock("setbpm")).palette=t.dict.meter,(e.protoBlockDict.setbpm=n).staticLabels.push(_("beats per minute")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(90),n.hidden=!0,(n=new ProtoBlock("pickup")).palette=t.dict.meter,(e.protoBlockDict.pickup=n).staticLabels.push(_("pickup")),n.oneArgBlock(),n.defaults.push(0),n.extraWidth=15,i&&!beginnerBlock("pickup")&&(n.hidden=!0),(n=new ProtoBlock("meter")).palette=t.dict.meter,(e.protoBlockDict.meter=n).staticLabels.push(_("meter")),n.staticLabels.push(_("number of beats"),_("note value")),n.extraWidth=15,n.adjustWidthToLabel(),n.defaults.push(4),n.defaults.push(.25),n.twoArgBlock(),i&&!beginnerBlock("meter")&&(n.hidden=!0),(n=new ProtoBlock("staccatofactor")).palette=t.dict.ornament,(e.protoBlockDict.staccatofactor=n).staticLabels.push(_("staccato factor")),n.adjustWidthToLabel(),n.parameterBlock(),n.hidden=!0,(n=new ProtoBlock("slurfactor")).palette=t.dict.ornament,(e.protoBlockDict.slurfactor=n).staticLabels.push(_("slur factor")),n.adjustWidthToLabel(),n.parameterBlock(),n.hidden=!0,(n=new ProtoBlock("duosynth")).palette=t.dict.tone,(e.protoBlockDict.duosynth=n).staticLabels.push(_("duo synth")),n.staticLabels.push(_("vibrato rate"),_("vibrato intensity")),n.extraWidth=10,n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(10),n.defaults.push(5),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",i&&!beginnerBlock("duosynth")&&(n.hidden=!0),(n=new ProtoBlock("amsynth")).palette=t.dict.tone,(e.protoBlockDict.amsynth=n).staticLabels.push(_("AM synth")),n.extraWidth=10,n.adjustWidthToLabel(),n.defaults.push(1),n.oneArgBlock(),n.dockTypes[1]="numberin",i&&!beginnerBlock("amsynth")&&(n.hidden=!0),(n=new ProtoBlock("fmsynth")).palette=t.dict.tone,(e.protoBlockDict.fmsynth=n).staticLabels.push(_("FM synth")),n.extraWidth=10,n.adjustWidthToLabel(),n.defaults.push(10),n.oneArgBlock(),n.dockTypes[1]="numberin",i&&!beginnerBlock("fmsynth")&&(n.hidden=!0),(n=new ProtoBlock("partial")).palette=t.dict.tone,(e.protoBlockDict.partial=n).staticLabels.push(_("partial")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(1),i&&!beginnerBlock("partial")&&(n.hidden=!0),(n=new ProtoBlock("harmonic")).palette=t.dict.tone,(e.protoBlockDict.harmonic=n).staticLabels.push(_("weighted partials")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("harmonic")&&(n.hidden=!0),(n=new ProtoBlock("harmonic2")).palette=t.dict.tone,(e.protoBlockDict.harmonic2=n).staticLabels.push(_("harmonic")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="numberin",n.defaults.push(1),i&&!beginnerBlock("harmonic2")&&(n.hidden=!0),(n=new ProtoBlock("neighbor")).palette=t.dict.ornament,(e.protoBlockDict.neighbor=n).staticLabels.push(_("neighbor")+" (+/)"),n.staticLabels.push(_("semi-tone interval"),_("note value")),n.extraWidth=15,n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.defaults.push(1),n.defaults.push(1/16),i&&!beginnerBlock("neighbor")&&(n.hidden=!0),(n=new ProtoBlock("neighbor2")).palette=t.dict.ornament,(e.protoBlockDict.neighbor2=n).staticLabels.push(_("neighbor")+" (+/)"),n.staticLabels.push(_("scalar interval"),_("note value")),n.extraWidth=15,n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.defaults.push(1),n.defaults.push(1/16),i&&!beginnerBlock("neighbor2")&&(n.hidden=!0),(n=new ProtoBlock("dis")).palette=t.dict.tone,(e.protoBlockDict.dis=n).staticLabels.push(_("distortion")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="numberin",n.defaults.push(40),i&&!beginnerBlock("dis")&&(n.hidden=!0),(n=new ProtoBlock("tremolo")).palette=t.dict.tone,(e.protoBlockDict.tremolo=n).staticLabels.push(_("tremolo")),n.staticLabels.push(_("rate")),n.staticLabels.push(_("depth")),n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.defaults.push(10),n.defaults.push(50),i&&!beginnerBlock("tremolo")&&(n.hidden=!0),(n=new ProtoBlock("phaser")).palette=t.dict.tone,(e.protoBlockDict.phaser=n).staticLabels.push(_("phaser")),n.staticLabels.push(_("rate"),_("octaves"),_("base frequency")),n.extraWidth=10,n.adjustWidthToLabel(),n.flowClampThreeArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.dockTypes[3]="numberin",n.defaults.push(.5),n.defaults.push(3),n.defaults.push(392),i&&!beginnerBlock("phaser")&&(n.hidden=!0),(n=new ProtoBlock("chorus")).palette=t.dict.tone,(e.protoBlockDict.chorus=n).staticLabels.push(_("chorus")),n.staticLabels.push(_("rate"),_("delay")+" (MS)",_("depth")),n.adjustWidthToLabel(),n.flowClampThreeArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.dockTypes[3]="numberin",n.defaults.push(1.5),n.defaults.push(3.5),n.defaults.push(70),i&&!beginnerBlock("chorus")&&(n.hidden=!0),(n=new ProtoBlock("vibrato")).palette=t.dict.tone,(e.protoBlockDict.vibrato=n).staticLabels.push(_("vibrato")),n.staticLabels.push(_("intensity"),_("rate")),n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.defaults.push(5),n.defaults.push(1/16),i&&!beginnerBlock("vibrato")&&(n.hidden=!0),(n=new ProtoBlock("setvoice")).palette=t.dict.tone,(e.protoBlockDict.setvoice=n).staticLabels.push(_("set synth")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="textin",n.defaults.push("violin"),n.hidden=!0,n.deprecated=!0,i&&!beginnerBlock("setvoice")&&(n.hidden=!0),(n=new ProtoBlock("glide")).palette=t.dict.ornament,(e.protoBlockDict.glide=n).staticLabels.push(_("glide")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(1/16),n.hidden=!0,(n=new ProtoBlock("slur")).palette=t.dict.ornament,(e.protoBlockDict.slur=n).staticLabels.push(_("slur")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(16),n.hidden=!0,(n=new ProtoBlock("staccato")).palette=t.dict.ornament,(e.protoBlockDict.staccato=n).staticLabels.push(_("staccato")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(32),n.hidden=!0,(n=new ProtoBlock("newslur")).palette=t.dict.ornament,(e.protoBlockDict.newslur=n).staticLabels.push(_("slur")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(1/16),i&&!beginnerBlock("newslur")&&(n.hidden=!0),(n=new ProtoBlock("newstaccato")).palette=t.dict.ornament,(e.protoBlockDict.newstaccato=n).staticLabels.push(_("staccato")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(1/32),i&&!beginnerBlock("newstaccato")&&(n.hidden=!0),(n=new ProtoBlock("synthname")).palette=t.dict.tone,(e.protoBlockDict.synthname=n).staticLabels.push(_("synth name")),n.adjustWidthToLabel(),n.dockTypes[0]="textout",n.parameterBlock(),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("voicename")).palette=t.dict.tone,(e.protoBlockDict.voicename=n).valueBlock(),n.dockTypes[0]="textout",n.extraWidth=50,i&&!beginnerBlock("voicename")&&(n.hidden=!0),(n=new ProtoBlock("settimbre")).palette=t.dict.tone,(e.protoBlockDict.settimbre=n).staticLabels.push(_("set timbre")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="textin",n.defaults.push(_("custom")),i&&!beginnerBlock("settimbre")&&(n.hidden=!0),(n=new ProtoBlock("settemperament")).palette=t.dict.intervals,(e.protoBlockDict.settemperament=n).staticLabels.push(_("set temperament")),n.staticLabels.push(_("temperament")),n.staticLabels.push(_("pitch"),_("octave")),n.adjustWidthToLabel(),n.threeArgBlock(),i&&!beginnerBlock("settemperament")&&(n.hidden=!0),(n=new ProtoBlock("octavespace")).palette=t.dict.rhythm,(e.protoBlockDict.octavespace=n).staticLabels.push(_("octave space")),n.adjustWidthToLabel(),n.oneArgBlock(),n.hidden=!0,(n=new ProtoBlock("temperamentname")).palette=t.dict.tone,(e.protoBlockDict.temperamentname=n).valueBlock(),n.hidden=!0,n.extraWidth=50,n.dockTypes[0]="anyout",i&&!beginnerBlock("temperamentname")&&(n.hidden=!0),(n=new ProtoBlock("temperament1")).palette=t.dict.action,(e.protoBlockDict.temperament1=n).staticLabels.push(_("define temperament")),n.hidden=!0,n.extraWidth=20,n.adjustWidthToLabel(),n.stackClampOneArgBlock(),(n=new ProtoBlock("modename")).palette=t.dict.intervals,(e.protoBlockDict.modename=n).valueBlock(),n.dockTypes[0]="textout",n.extraWidth=50,n.hidden=!0,(n=new ProtoBlock("doubly")).palette=t.dict.intervals,(e.protoBlockDict.doubly=n).staticLabels.push(_("doubly")),n.oneArgMathBlock(),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",i&&!beginnerBlock("doubly")&&(n.hidden=!0),(n=new ProtoBlock("intervalname")).palette=t.dict.intervals,(e.protoBlockDict.intervalname=n).valueBlock(),n.extraWidth=50,n.adjustWidthToLabel(),n.dockTypes[0]="numberout",i&&!beginnerBlock("intervalname")&&(n.hidden=!0),(n=new ProtoBlock("measureintervalsemitones")).palette=t.dict.intervals,(e.protoBlockDict.measureintervalsemitones=n).staticLabels.push(_("semi-tone interval measure")),n.argFlowClampBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("measureintervalsemitones")&&(n.hidden=!0),(n=new ProtoBlock("measureintervalscalar")).palette=t.dict.intervals,(e.protoBlockDict.measureintervalscalar=n).staticLabels.push(_("scalar interval measure")),n.argFlowClampBlock(),n.adjustWidthToLabel(),i&&!beginnerBlock("measureintervalscalar")&&(n.hidden=!0),(n=new ProtoBlock("diminished8")).palette=t.dict.intervals,(e.protoBlockDict.diminished8=n).staticLabels.push(_("diminished")+" 8"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("diminished8")&&(n.hidden=!0),(n=new ProtoBlock("diminished7")).palette=t.dict.intervals,(e.protoBlockDict.diminished7=n).staticLabels.push(_("diminished")+" 7"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("diminished7")&&(n.hidden=!0),(n=new ProtoBlock("diminished6")).palette=t.dict.intervals,(e.protoBlockDict.diminished6=n).staticLabels.push(_("diminished")+" 6"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("diminished6")&&(n.hidden=!0),(n=new ProtoBlock("diminished5")).palette=t.dict.intervals,(e.protoBlockDict.diminished5=n).staticLabels.push(_("diminished")+" 5"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("diminished5")&&(n.hidden=!0),(n=new ProtoBlock("diminished4")).palette=t.dict.intervals,(e.protoBlockDict.diminished4=n).staticLabels.push(_("diminished")+" 4"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("diminished4")&&(n.hidden=!0),(n=new ProtoBlock("diminished3")).palette=t.dict.intervals,(e.protoBlockDict.diminished3=n).staticLabels.push(_("diminished")+" 3"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("diminished3")&&(n.hidden=!0),(n=new ProtoBlock("diminished2")).palette=t.dict.intervals,(e.protoBlockDict.diminished2=n).staticLabels.push(_("diminished")+" 2"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("diminished2")&&(n.hidden=!0),(n=new ProtoBlock("augmented8")).palette=t.dict.intervals,(e.protoBlockDict.augmented8=n).staticLabels.push(_("augmented")+" 8"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented8")&&(n.hidden=!0),(n=new ProtoBlock("augmented7")).palette=t.dict.intervals,(e.protoBlockDict.augmented7=n).staticLabels.push(_("augmented")+" 7"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented7")&&(n.hidden=!0),(n=new ProtoBlock("augmented6")).palette=t.dict.intervals,(e.protoBlockDict.augmented6=n).staticLabels.push(_("augmented")+" 6"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented6")&&(n.hidden=!0),(n=new ProtoBlock("augmented5")).palette=t.dict.intervals,(e.protoBlockDict.augmented5=n).staticLabels.push(_("augmented")+" 5"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented5")&&(n.hidden=!0),(n=new ProtoBlock("augmented4")).palette=t.dict.intervals,(e.protoBlockDict.augmented4=n).staticLabels.push(_("augmented")+" 4"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented4")&&(n.hidden=!0),(n=new ProtoBlock("augmented3")).palette=t.dict.intervals,(e.protoBlockDict.augmented3=n).staticLabels.push(_("augmented")+" 3"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented3")&&(n.hidden=!0),(n=new ProtoBlock("augmented2")).palette=t.dict.intervals,(e.protoBlockDict.augmented2=n).staticLabels.push(_("augmented")+" 2"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented2")&&(n.hidden=!0),(n=new ProtoBlock("augmented1")).palette=t.dict.intervals,(e.protoBlockDict.augmented1=n).staticLabels.push(_("augmented")+" 1"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("augmented1")&&(n.hidden=!0),(n=new ProtoBlock("perfect8")).palette=t.dict.intervals,(e.protoBlockDict.perfect8=n).staticLabels.push(_("perfect")+" 8"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("perfect8")&&(n.hidden=!0),(n=new ProtoBlock("perfect5")).palette=t.dict.intervals,(e.protoBlockDict.perfect5=n).staticLabels.push(_("perfect")+" 5"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("perfect5")&&(n.hidden=!0),(n=new ProtoBlock("perfect4")).palette=t.dict.intervals,(e.protoBlockDict.perfect4=n).staticLabels.push(_("perfect")+" 4"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("perfect4")&&(n.hidden=!0),(n=new ProtoBlock("perfect")).palette=t.dict.intervals,(e.protoBlockDict.perfect=n).staticLabels.push(_("perfect")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(5),n.hidden=!0,i&&!beginnerBlock("perfect")&&(n.hidden=!0),(n=new ProtoBlock("downminor6")).palette=t.dict.intervals,(e.protoBlockDict.downminor6=n).staticLabels.push(_("down minor")+" 6"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downminor6")&&(n.hidden=!0),(n=new ProtoBlock("downminor3")).palette=t.dict.intervals,(e.protoBlockDict.downminor3=n).staticLabels.push(_("down minor")+" 3"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downminor3")&&(n.hidden=!0),(n=new ProtoBlock("minor7")).palette=t.dict.intervals,(e.protoBlockDict.minor7=n).staticLabels.push(_("minor")+" 7"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("minor7")&&(n.hidden=!0),(n=new ProtoBlock("minor6")).palette=t.dict.intervals,(e.protoBlockDict.minor6=n).staticLabels.push(_("minor")+" 6"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("minor6")&&(n.hidden=!0),(n=new ProtoBlock("minor3")).palette=t.dict.intervals,(e.protoBlockDict.minor3=n).staticLabels.push(_("minor")+" 3"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("minor3")&&(n.hidden=!0),(n=new ProtoBlock("minor2")).palette=t.dict.intervals,(e.protoBlockDict.minor2=n).staticLabels.push(_("minor")+" 2"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("minor2")&&(n.hidden=!0),(n=new ProtoBlock("downmajor6")).palette=t.dict.intervals,(e.protoBlockDict.downmajor6=n).staticLabels.push(_("down major")+" 6"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downmajor6")&&(n.hidden=!0),(n=new ProtoBlock("downmajor3")).palette=t.dict.intervals,(e.protoBlockDict.downmajor3=n).staticLabels.push(_("down major")+" 3"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downmajor3")&&(n.hidden=!0),(n=new ProtoBlock("major7")).palette=t.dict.intervals,(e.protoBlockDict.major7=n).staticLabels.push(_("major")+" 7"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("major7")&&(n.hidden=!0),(n=new ProtoBlock("major6")).palette=t.dict.intervals,(e.protoBlockDict.major6=n).staticLabels.push(_("major")+" 6"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("major6")&&(n.hidden=!0),(n=new ProtoBlock("major3")).palette=t.dict.intervals,(e.protoBlockDict.major3=n).staticLabels.push(_("major")+" 3"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("major3")&&(n.hidden=!0),(n=new ProtoBlock("major2")).palette=t.dict.intervals,(e.protoBlockDict.major2=n).staticLabels.push(_("major")+" 2"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("major2")&&(n.hidden=!0),(n=new ProtoBlock("semitoneinterval")).palette=t.dict.intervals,(e.protoBlockDict.semitoneinterval=n).staticLabels.push(_("semi-tone interval")+" (+/)"),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(5),i&&!beginnerBlock("semitoneinterval")&&(n.hidden=!0),(n=new ProtoBlock("chordV")).palette=t.dict.intervals,e.protoBlockDict.chordV=n,"ja"===s?n.staticLabels.push(_("chord5")):n.staticLabels.push(_("chord")+" V"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("chordV")&&(n.hidden=!0),(n=new ProtoBlock("chordIV")).palette=t.dict.intervals,e.protoBlockDict.chordIV=n,"ja"===s?n.staticLabels.push(_("chord4")):n.staticLabels.push(_("chord")+" IV"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("chordIV")&&(n.hidden=!0),(n=new ProtoBlock("chordI")).palette=t.dict.intervals,e.protoBlockDict.chordI=n,"ja"===s?n.staticLabels.push(_("chord1")):n.staticLabels.push(_("chord")+" I"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("chordI")&&(n.hidden=!0),(n=new ProtoBlock("downsixthinterval")).palette=t.dict.intervals,(e.protoBlockDict.downsixthinterval=n).staticLabels.push(_("down sixth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downsixthinterval")&&(n.hidden=!0),(n=new ProtoBlock("downthirdinterval")).palette=t.dict.intervals,(e.protoBlockDict.downthirdinterval=n).staticLabels.push(_("down third")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("downthirdinterval")&&(n.hidden=!0),(n=new ProtoBlock("seventhinterval")).palette=t.dict.intervals,(e.protoBlockDict.seventhinterval=n).staticLabels.push(_("seventh")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("seventhinterval")&&(n.hidden=!0),(n=new ProtoBlock("sixthinterval")).palette=t.dict.intervals,(e.protoBlockDict.sixthinterval=n).staticLabels.push(_("sixth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("sixthinterval")&&(n.hidden=!0),(n=new ProtoBlock("fifthinterval")).palette=t.dict.intervals,(e.protoBlockDict.fifthinterval=n).staticLabels.push(_("fifth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("fifthinterval")&&(n.hidden=!0),(n=new ProtoBlock("fourthinterval")).palette=t.dict.intervals,(e.protoBlockDict.fourthinterval=n).staticLabels.push(_("fourth")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("fourthinterval")&&(n.hidden=!0),(n=new ProtoBlock("thirdinterval")).palette=t.dict.intervals,(e.protoBlockDict.thirdinterval=n).staticLabels.push(_("third")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("thirdinterval")&&(n.hidden=!0),(n=new ProtoBlock("secondinterval")).palette=t.dict.intervals,(e.protoBlockDict.secondinterval=n).staticLabels.push(_("second")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("secondinterval")&&(n.hidden=!0),(n=new ProtoBlock("unisoninterval")).palette=t.dict.intervals,(e.protoBlockDict.unisoninterval=n).staticLabels.push(_("unison")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("unisoninterval")&&(n.hidden=!0),(n=new ProtoBlock("interval")).palette=t.dict.intervals,(e.protoBlockDict.interval=n).staticLabels.push(_("scalar interval")+" (+/)"),n.labelOffset=15,n.extraWidth=40,n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(5),i&&!beginnerBlock("interval")&&(n.hidden=!0),(n=new ProtoBlock("definemode")).palette=t.dict.intervals,(e.protoBlockDict.definemode=n).staticLabels.push(_("define mode")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(_("custom")),n.dockTypes[1]="textin",i&&!beginnerBlock("definemode")&&(n.hidden=!0),(n=new ProtoBlock("movable")).palette=t.dict.intervals,(e.protoBlockDict.movable=n).staticLabels.push(_("moveable Do")),n.adjustWidthToLabel(),n.oneBooleanArgBlock(),"ja"===s&&i&&!beginnerBlock("movable")&&(n.hidden=!0),(n=new ProtoBlock("modelength")).palette=t.dict.intervals,(e.protoBlockDict.modelength=n).staticLabels.push(_("mode length")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("modelength")&&(n.hidden=!0),(n=new ProtoBlock("currentmode")).palette=t.dict.intervals,(e.protoBlockDict.currentmode=n).staticLabels.push(_("current mode")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("currentmode")&&(n.hidden=!0),(n=new ProtoBlock("key")).palette=t.dict.intervals,(e.protoBlockDict.key=n).staticLabels.push(_("current key")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("key")&&(n.hidden=!0),(n=new ProtoBlock("setkey")).palette=t.dict.intervals,(e.protoBlockDict.setkey=n).staticLabels.push(_("set key")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="textin",n.defaults.push("C"),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("setkey2")).palette=t.dict.intervals,(e.protoBlockDict.setkey2=n).staticLabels.push(_("set key")),n.staticLabels.push(_("key")),n.staticLabels.push(_("mode")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("setkey2")&&(n.hidden=!0),(n=new ProtoBlock("noisename")).palette=t.dict.drum,(e.protoBlockDict.noisename=n).valueBlock(),n.extraWidth=50,n.dockTypes[0]="textout",i&&!beginnerBlock("noisename")&&(n.hidden=!0),(n=new ProtoBlock("drumname")).palette=t.dict.drum,(e.protoBlockDict.drumname=n).valueBlock(),n.extraWidth=50,n.dockTypes[0]="textout",i&&!beginnerBlock("drumname")&&(n.hidden=!0),(n=new ProtoBlock("effectsname")).palette=t.dict.drum,(e.protoBlockDict.effectsname=n).valueBlock(),n.extraWidth=50,n.dockTypes[0]="textout",i&&!beginnerBlock("effectsname")&&(n.hidden=!0),(n=new ProtoBlock("playnoise")).palette=t.dict.drum,(e.protoBlockDict.playnoise=n).staticLabels.push(_("noise")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("white noise")),i&&!beginnerBlock("playnoise")&&(n.hidden=!0),(n=new ProtoBlock("duck")).palette=t.dict.drum,(e.protoBlockDict.duck=n).staticLabels.push(_("duck")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("duck")&&(n.hidden=!0),(n=new ProtoBlock("cat")).palette=t.dict.drum,(e.protoBlockDict.cat=n).staticLabels.push(_("cat")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("cat")&&(n.hidden=!0),(n=new ProtoBlock("cricket")).palette=t.dict.drum,(e.protoBlockDict.cricket=n).staticLabels.push(_("cricket")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("cricket")&&(n.hidden=!0),(n=new ProtoBlock("dog")).palette=t.dict.drum,(e.protoBlockDict.dog=n).staticLabels.push(_("dog")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("dog")&&(n.hidden=!0),(n=new ProtoBlock("bottle")).palette=t.dict.drum,(e.protoBlockDict.bottle=n).staticLabels.push(_("bottle")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("bottle")&&(n.hidden=!0),(n=new ProtoBlock("bubbles")).palette=t.dict.drum,(e.protoBlockDict.bubbles=n).staticLabels.push(_("bubbles")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("bubbles")&&(n.hidden=!0),(n=new ProtoBlock("chine")).palette=t.dict.drum,(e.protoBlockDict.chine=n).staticLabels.push(_("chime")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("chine")&&(n.hidden=!0),(n=new ProtoBlock("clang")).palette=t.dict.drum,(e.protoBlockDict.clang=n).staticLabels.push(_("clang")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("clang")&&(n.hidden=!0),(n=new ProtoBlock("clap")).palette=t.dict.drum,(e.protoBlockDict.clap=n).staticLabels.push(_("clap")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("clap")&&(n.hidden=!0),(n=new ProtoBlock("slap")).palette=t.dict.drum,(e.protoBlockDict.slap=n).staticLabels.push(_("slap")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("slap")&&(n.hidden=!0),(n=new ProtoBlock("crash")).palette=t.dict.drum,(e.protoBlockDict.crash=n).staticLabels.push(_("crash")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("crash")&&(n.hidden=!0),(n=new ProtoBlock("tom")).palette=t.dict.drum,(e.protoBlockDict.tom=n).staticLabels.push(_("splash")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("tom")&&(n.hidden=!0),(n=new ProtoBlock("cowbell")).palette=t.dict.drum,(e.protoBlockDict.cowbell=n).staticLabels.push(_("cow bell")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("cowbell")&&(n.hidden=!0),(n=new ProtoBlock("ridebell")).palette=t.dict.drum,(e.protoBlockDict.ridebell=n).staticLabels.push(_("ride bell")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("ridebell")&&(n.hidden=!0),(n=new ProtoBlock("fingercymbals")).palette=t.dict.drum,(e.protoBlockDict.fingercymbals=n).staticLabels.push(_("finger cymbals")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("fingercymbals")&&(n.hidden=!0),(n=new ProtoBlock("trianglebell")).palette=t.dict.drum,(e.protoBlockDict.trianglebell=n).staticLabels.push(_("triangle bell")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("trianglebell")&&(n.hidden=!0),(n=new ProtoBlock("hihat")).palette=t.dict.drum,(e.protoBlockDict.hihat=n).staticLabels.push(_("hi hat")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("hihat")&&(n.hidden=!0),(n=new ProtoBlock("darbuka")).palette=t.dict.drum,(e.protoBlockDict.darbuka=n).staticLabels.push(_("darbuka drum")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("darbuka")&&(n.hidden=!0),(n=new ProtoBlock("cup")).palette=t.dict.drum,(e.protoBlockDict.cup=n).staticLabels.push(_("cup drum")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("cup")&&(n.hidden=!0),(n=new ProtoBlock("floortom")).palette=t.dict.drum,(e.protoBlockDict.floortom=n).staticLabels.push(_("floor tom")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("floortom")&&(n.hidden=!0),(n=new ProtoBlock("tom")).palette=t.dict.drum,(e.protoBlockDict.tom=n).staticLabels.push(_("tom tom")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("tom")&&(n.hidden=!0),(n=new ProtoBlock("kick")).palette=t.dict.drum,(e.protoBlockDict.kick=n).staticLabels.push(_("kick drum")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("kick")&&(n.hidden=!0),(n=new ProtoBlock("snare")).palette=t.dict.drum,(e.protoBlockDict.snare=n).staticLabels.push(_("snare drum")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("snare")&&(n.hidden=!0);(n=new ProtoBlock("setdrum")).palette=t.dict.drum,(e.protoBlockDict.setdrum=n).staticLabels.push(_("set drum")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="anyin",i&&!beginnerBlock("setdrum")&&(n.hidden=!0),(n=new ProtoBlock("playeffect")).palette=t.dict.drum,(e.protoBlockDict.playeffect=n).staticLabels.push(_("sound effect")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",i&&!beginnerBlock("playeffect")&&(n.hidden=!0),(n=new ProtoBlock("playdrum")).palette=t.dict.drum,(e.protoBlockDict.playdrum=n).staticLabels.push(_("drum")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",i&&!beginnerBlock("playdrum")&&(n.hidden=!0),(n=new ProtoBlock("heading")).palette=t.dict.graphics,(e.protoBlockDict.heading=n).staticLabels.push(_("heading")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("heading")&&(n.hidden=!0),(n=new ProtoBlock("y")).palette=t.dict.graphics,e.protoBlockDict.y=n,"ja"===s?n.staticLabels.push(_("y3")):n.staticLabels.push(_("y")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("y")&&(n.hidden=!0),(n=new ProtoBlock("x")).palette=t.dict.graphics,e.protoBlockDict.x=n,"ja"===s?n.staticLabels.push(_("x3")):n.staticLabels.push(_("x")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("x")&&(n.hidden=!0),(n=new ProtoBlock("scrollxy")).palette=t.dict.graphics,(e.protoBlockDict.scrollxy=n).staticLabels.push(_("scroll xy")),"ja"===s?n.staticLabels.push(_("x2"),_("y2")):n.staticLabels.push(_("x"),_("y")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(100),n.defaults.push(0),n.dockTypes[1]="numberin",i&&!beginnerBlock("scrollxy")&&(n.hidden=!0),(n=new ProtoBlock("clear")).palette=t.dict.graphics,(e.protoBlockDict.clear=n).staticLabels.push(_("clear")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("clear")&&(n.hidden=!0),(n=new ProtoBlock("controlpoint2")).palette=t.dict.graphics,(e.protoBlockDict.controlpoint2=n).staticLabels.push(_("control point 2")),"ja"===s?n.staticLabels.push(_("x1"),_("y1")):n.staticLabels.push(_("x"),_("y")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(100),n.defaults.push(25),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",i&&!beginnerBlock("controlpoint2")&&(n.hidden=!0),(n=new ProtoBlock("controlpoint1")).palette=t.dict.graphics,(e.protoBlockDict.controlpoint1=n).staticLabels.push(_("control point 1")),"ja"===s?n.staticLabels.push(_("x1"),_("y1")):n.staticLabels.push(_("x"),_("y")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(100),n.defaults.push(75),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",i&&!beginnerBlock("controlpoint1")&&(n.hidden=!0),(n=new ProtoBlock("bezier")).palette=t.dict.graphics,(e.protoBlockDict.bezier=n).staticLabels.push(_("bezier")),"ja"===s?n.staticLabels.push(_("x1"),_("y1")):n.staticLabels.push(_("x"),_("y")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(0),n.defaults.push(100),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",i&&!beginnerBlock("bezier")&&(n.hidden=!0),(n=new ProtoBlock("arc")).palette=t.dict.graphics,(e.protoBlockDict.arc=n).staticLabels.push(_("arc")),n.staticLabels.push(_("angle"),_("radius")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(90),n.defaults.push(100),n.dockTypes[1]="numberin",i&&!beginnerBlock("arc")&&(n.hidden=!0),(n=new ProtoBlock("setheading")).palette=t.dict.graphics,(e.protoBlockDict.setheading=n).staticLabels.push(_("set heading")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(0),"ja"===s&&i&&!beginnerBlock("setheading")&&(n.hidden=!0),(n=new ProtoBlock("setxy")).palette=t.dict.graphics,(e.protoBlockDict.setxy=n).staticLabels.push(_("set xy")),"ja"===s?n.staticLabels.push(_("x1"),_("y1")):n.staticLabels.push(_("x"),_("y")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(0),n.defaults.push(0),n.dockTypes[1]="numberin",i&&!beginnerBlock("setxy")&&(n.hidden=!0),(n=new ProtoBlock("right")).palette=t.dict.graphics,e.protoBlockDict.right=n,"ja"===s?n.staticLabels.push(_("right1")):n.staticLabels.push(_("right")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(90),i&&!beginnerBlock("right")&&(n.hidden=!0),(n=new ProtoBlock("left")).palette=t.dict.graphics,e.protoBlockDict.left=n,"ja"===s?n.staticLabels.push(_("left1")):n.staticLabels.push(_("left")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(90),i&&!beginnerBlock("left")&&(n.hidden=!0),(n=new ProtoBlock("back")).palette=t.dict.graphics,(e.protoBlockDict.back=n).staticLabels.push(_("back")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(100),i&&!beginnerBlock("back")&&(n.hidden=!0),(n=new ProtoBlock("forward")).palette=t.dict.graphics,(e.protoBlockDict.forward=n).staticLabels.push(_("forward")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(100),i&&!beginnerBlock("forward")&&(n.hidden=!0),(n=new ProtoBlock("purple")).palette=t.dict.pen,(e.protoBlockDict.purple=n).staticLabels.push(_("purple")),n.zeroArgBlock(),i&&!beginnerBlock("purple")&&(n.hidden=!0),(n=new ProtoBlock("blue")).palette=t.dict.pen,(e.protoBlockDict.blue=n).staticLabels.push(_("blue")),n.zeroArgBlock(),i&&!beginnerBlock("blue")&&(n.hidden=!0),(n=new ProtoBlock("green")).palette=t.dict.pen,(e.protoBlockDict.green=n).staticLabels.push(_("green")),n.zeroArgBlock(),i&&!beginnerBlock("green")&&(n.hidden=!0),(n=new ProtoBlock("yellow")).palette=t.dict.pen,(e.protoBlockDict.yellow=n).staticLabels.push(_("yellow")),n.zeroArgBlock(),i&&!beginnerBlock("yellow")&&(n.hidden=!0),(n=new ProtoBlock("orange")).palette=t.dict.pen,(e.protoBlockDict.orange=n).staticLabels.push(_("orange")),n.zeroArgBlock(),i&&!beginnerBlock("orange")&&(n.hidden=!0),(n=new ProtoBlock("red")).palette=t.dict.pen,(e.protoBlockDict.red=n).staticLabels.push(_("red")),n.zeroArgBlock(),i&&!beginnerBlock("red")&&(n.hidden=!0),(n=new ProtoBlock("white")).palette=t.dict.pen,(e.protoBlockDict.white=n).staticLabels.push(_("white")),n.zeroArgBlock(),i&&!beginnerBlock("white")&&(n.hidden=!0),(n=new ProtoBlock("black")).palette=t.dict.pen,(e.protoBlockDict.black=n).staticLabels.push(_("black")),n.zeroArgBlock(),i&&!beginnerBlock("black")&&(n.hidden=!0),(n=new ProtoBlock("beginfill")).palette=t.dict.pen,(e.protoBlockDict.beginfill=n).staticLabels.push(_("begin fill")),n.adjustWidthToLabel(),n.zeroArgBlock(),n.hidden=!0,(n=new ProtoBlock("endfill")).palette=t.dict.pen,(e.protoBlockDict.endfill=n).staticLabels.push(_("end fill")),n.adjustWidthToLabel(),n.zeroArgBlock(),n.hidden=!0,(n=new ProtoBlock("fillscreen")).palette=t.dict.pen,(e.protoBlockDict.fillscreen=n).staticLabels.push(_("background")),n.adjustWidthToLabel(),n.threeArgBlock(),n.hidden=!0,(n=new ProtoBlock("grey")).palette=t.dict.pen,(e.protoBlockDict.grey=n).staticLabels.push(_("grey")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("grey")&&(n.hidden=!0),(n=new ProtoBlock("shade")).palette=t.dict.pen,(e.protoBlockDict.shade=n).staticLabels.push(_("shade")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("shade")&&(n.hidden=!0),(n=new ProtoBlock("color")).palette=t.dict.pen,(e.protoBlockDict.color=n).staticLabels.push(_("color")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("color")&&(n.hidden=!0),(n=new ProtoBlock("pensize")).palette=t.dict.pen,(e.protoBlockDict.pensize=n).staticLabels.push(_("pen size")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("pensize")&&(n.hidden=!0),(n=new ProtoBlock("setfont")).palette=t.dict.pen,(e.protoBlockDict.setfont=n).staticLabels.push(_("set font")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(DEFAULTFONT),n.dockTypes[1]="textin",i&&!beginnerBlock("setfont")&&(n.hidden=!0),(n=new ProtoBlock("background")).palette=t.dict.pen,(e.protoBlockDict.background=n).staticLabels.push(_("background")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("background")&&(n.hidden=!0),(n=new ProtoBlock("hollowline")).palette=t.dict.pen,(e.protoBlockDict.hollowline=n).staticLabels.push(_("hollow line")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("hollowline")&&(n.hidden=!0),(n=new ProtoBlock("fill")).palette=t.dict.pen,(e.protoBlockDict.fill=n).staticLabels.push(_("fill")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("fill")&&(n.hidden=!0),(n=new ProtoBlock("penup")).palette=t.dict.pen,(e.protoBlockDict.penup=n).staticLabels.push(_("pen up")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("penup")&&(n.hidden=!0),(n=new ProtoBlock("pendown")).palette=t.dict.pen,(e.protoBlockDict.pendown=n).staticLabels.push(_("pen down")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("pendown")&&(n.hidden=!0),(n=new ProtoBlock("setpensize")).palette=t.dict.pen,(e.protoBlockDict.setpensize=n).staticLabels.push(_("set pen size")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(5),i&&!beginnerBlock("setpensize")&&(n.hidden=!0),(n=new ProtoBlock("settranslucency")).palette=t.dict.pen,(e.protoBlockDict.settranslucency=n).staticLabels.push(_("set translucency")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(50),i&&!beginnerBlock("settranslucency")&&(n.hidden=!0),(n=new ProtoBlock("sethue")).palette=t.dict.pen,(e.protoBlockDict.sethue=n).staticLabels.push(_("set hue")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(0),i&&!beginnerBlock("sethue")&&(n.hidden=!0),(n=new ProtoBlock("setshade")).palette=t.dict.pen,(e.protoBlockDict.setshade=n).staticLabels.push(_("set shade")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(50),i&&!beginnerBlock("setshade")&&(n.hidden=!0),(n=new ProtoBlock("setgrey")).palette=t.dict.pen,(e.protoBlockDict.setgrey=n).staticLabels.push(_("set grey")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(100),i&&!beginnerBlock("setgrey")&&(n.hidden=!0),(n=new ProtoBlock("setcolor")).palette=t.dict.pen,(e.protoBlockDict.setcolor=n).staticLabels.push(_("set color")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(0),i&&!beginnerBlock("setcolor")&&(n.hidden=!0),(n=new ProtoBlock("int")).palette=t.dict.number,(e.protoBlockDict.int=n).staticLabels.push(_("int")),n.adjustWidthToLabel(),n.oneArgMathBlock(),n.defaults.push(100),i&&!beginnerBlock("int")&&(n.hidden=!0),(n=new ProtoBlock("not")).palette=t.dict.boolean,(e.protoBlockDict.not=n).extraWidth=30,n.staticLabels.push(_("not")),n.booleanOneBooleanArgBlock(),i&&!beginnerBlock("not")&&(n.hidden=!0),(n=new ProtoBlock("and")).palette=t.dict.boolean,(e.protoBlockDict.and=n).extraWidth=10,n.staticLabels.push(_("and")),n.booleanTwoBooleanArgBlock(),i&&!beginnerBlock("and")&&(n.hidden=!0),(n=new ProtoBlock("or")).palette=t.dict.boolean,(e.protoBlockDict.or=n).extraWidth=10,n.staticLabels.push(_("or")),n.booleanTwoBooleanArgBlock(),i&&!beginnerBlock("or")&&(n.hidden=!0),(n=new ProtoBlock("greater")).palette=t.dict.boolean,(e.protoBlockDict.greater=n).fontsize=14,n.staticLabels.push(">"),n.extraWidth=20,n.booleanTwoArgBlock(),i&&!beginnerBlock("greater")&&(n.hidden=!0),(n=new ProtoBlock("less")).palette=t.dict.boolean,(e.protoBlockDict.less=n).fontsize=14,n.staticLabels.push("<"),n.extraWidth=20,n.booleanTwoArgBlock(),i&&!beginnerBlock("less")&&(n.hidden=!0),(n=new ProtoBlock("equal")).palette=t.dict.boolean,(e.protoBlockDict.equal=n).fontsize=14,n.staticLabels.push("="),n.extraWidth=20,n.booleanTwoArgBlock(),n.dockTypes[0]="booleanout",n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("equal")&&(n.hidden=!0),(n=new ProtoBlock("boolean")).palette=t.dict.boolean,(e.protoBlockDict.boolean=n).booleanZeroArgBlock(),i&&!beginnerBlock("boolean")&&(n.hidden=!0),(n=new ProtoBlock("mod")).palette=t.dict.number,(e.protoBlockDict.mod=n).staticLabels.push(_("mod")),n.adjustWidthToLabel(),n.twoArgMathBlock(),n.defaults.push(100,10),i&&!beginnerBlock("mod")&&(n.hidden=!0),(n=new ProtoBlock("power")).palette=t.dict.number,(e.protoBlockDict.power=n).fontsize=14,n.staticLabels.push("^"),n.twoArgMathBlock(),n.defaults.push(2,4),i&&!beginnerBlock("power")&&(n.hidden=!0),(n=new ProtoBlock("sqrt")).palette=t.dict.number,(e.protoBlockDict.sqrt=n).staticLabels.push(_("sqrt")),n.adjustWidthToLabel(),n.oneArgMathBlock(),n.defaults.push(64),i&&!beginnerBlock("sqrt")&&(n.hidden=!0),(n=new ProtoBlock("abs")).palette=t.dict.number,(e.protoBlockDict.abs=n).staticLabels.push(_("abs")),n.adjustWidthToLabel(),n.oneArgMathBlock(),i&&!beginnerBlock("abs")&&(n.hidden=!0),(n=new ProtoBlock("divide")).palette=t.dict.number,(e.protoBlockDict.divide=n).fontsize=9,"ja"===s?n.staticLabels.push(""):n.staticLabels.push("/"),n.twoArgMathBlock(),n.defaults.push(1,4),i&&!beginnerBlock("divide")&&(n.hidden=!0),(n=new ProtoBlock("multiply")).palette=t.dict.number,(e.protoBlockDict.multiply=n).fontsize=14,n.staticLabels.push(""),n.twoArgMathBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.defaults.push(1,12),i&&!beginnerBlock("multiply")&&(n.hidden=!0),(n=new ProtoBlock("neg")).palette=t.dict.number,(e.protoBlockDict.neg=n).fontsize=14,n.staticLabels.push(""),n.oneArgMathBlock(),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",i&&!beginnerBlock("neg")&&(n.hidden=!0),(n=new ProtoBlock("minus")).palette=t.dict.number,(e.protoBlockDict.minus=n).fontsize=14,n.staticLabels.push(""),n.twoArgMathBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.defaults.push(8,4),i&&!beginnerBlock("minus")&&(n.hidden=!0),(n=new ProtoBlock("plus")).palette=t.dict.number,(e.protoBlockDict.plus=n).fontsize=14,n.staticLabels.push("+"),n.twoArgMathBlock(),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.defaults.push(2,2),i&&!beginnerBlock("plus")&&(n.hidden=!0),(n=new ProtoBlock("oneOf")).palette=t.dict.number,(e.protoBlockDict.oneOf=n).staticLabels.push(_("one of"),_("this"),_("that")),n.adjustWidthToLabel(),n.twoArgMathBlock(),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.defaults.push(-90,90),i&&!beginnerBlock("oneOf")&&(n.hidden=!0),(n=new ProtoBlock("random")).palette=t.dict.number,(e.protoBlockDict.random=n).staticLabels.push(_("random"),_("min"),_("max")),n.adjustWidthToLabel(),n.twoArgMathBlock(),n.defaults.push(0,12),i&&!beginnerBlock("random")&&(n.hidden=!0),(n=new ProtoBlock("number")).palette=t.dict.number,(e.protoBlockDict.number=n).valueBlock(),i&&!beginnerBlock("number")&&(n.hidden=!0),(n=new ProtoBlock("incrementOne")).palette=t.dict.boxes,(e.protoBlockDict.incrementOne=n).staticLabels.push(_("add 1 to")),n.adjustWidthToLabel(),n.oneArgBlock(),i&&!beginnerBlock("incrementOne")&&(n.hidden=!0),(n=new ProtoBlock("increment")).palette=t.dict.boxes,e.protoBlockDict.increment=n,"ja"===s?(n.staticLabels.push(_("add"),_("to")),n.staticLabels.push(_("value1"))):n.staticLabels.push(_("add"),_("to"),_("value")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("increment")&&(n.hidden=!0),(n=new ProtoBlock("box")).palette=t.dict.boxes,(e.protoBlockDict.box=n).staticLabels.push(_("box")),n.extraWidth=10,n.adjustWidthToLabel(),n.oneArgMathBlock(),n.defaults.push(_("box")),n.dockTypes[0]="anyout",n.parameter=!0,n.dockTypes[1]="anyin",i&&!beginnerBlock("box")&&(n.hidden=!0),(n=new ProtoBlock("namedbox")).palette=t.dict.boxes,(e.protoBlockDict.namedbox=n).staticLabels.push(_("box")),n.extraWidth=20,n.adjustWidthToLabel(),n.parameterBlock(),n.dockTypes[0]="anyout",i&&!beginnerBlock("namedbox")&&(n.hidden=!0),(n=new ProtoBlock("storein2")).palette=t.dict.boxes,(e.protoBlockDict.storein2=n).staticLabels.push(_("store in box")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(4),n.dockTypes[1]="anyin",i&&!beginnerBlock("storein2")&&(n.hidden=!0),(n=new ProtoBlock("storein")).palette=t.dict.boxes,(e.protoBlockDict.storein=n).staticLabels.push(_("store in")),"ja"===s?n.staticLabels.push(_("name1"),_("value1")):n.staticLabels.push(_("name"),_("value")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(_("box")),n.defaults.push(4),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("storein")&&(n.hidden=!0),(n=new ProtoBlock("box2")).palette=t.dict.boxes,(e.protoBlockDict.box2=n).staticLabels.push(_("box 2")),n.extraWidth=20,n.adjustWidthToLabel(),n.parameterBlock(),n.dockTypes[0]="anyout",i&&!beginnerBlock("box2")&&(n.hidden=!0),(n=new ProtoBlock("storebox2")).palette=t.dict.boxes,(e.protoBlockDict.storebox2=n).staticLabels.push(_("store in box 2")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(4),n.dockTypes[1]="anyin",i&&!beginnerBlock("storebox2")&&(n.hidden=!0),(n=new ProtoBlock("box1")).palette=t.dict.boxes,(e.protoBlockDict.box1=n).staticLabels.push(_("box 1")),n.extraWidth=20,n.adjustWidthToLabel(),n.parameterBlock(),n.dockTypes[0]="anyout",i&&!beginnerBlock("box1")&&(n.hidden=!0),(n=new ProtoBlock("storebox1")).palette=t.dict.boxes,(e.protoBlockDict.storebox1=n).staticLabels.push(_("store in box 1")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(4),n.dockTypes[1]="anyin",i&&!beginnerBlock("storebox1")&&(n.hidden=!0),(n=new ProtoBlock("do")).palette=t.dict.action,e.protoBlockDict.do=n,"ja"===s?n.staticLabels.push(_("do1")):n.staticLabels.push(_("do")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(_("action")),n.dockTypes[1]="anyin",i&&!beginnerBlock("do")&&(n.hidden=!0),(n=new ProtoBlock("return")).palette=t.dict.action,(e.protoBlockDict.return=n).staticLabels.push(_("return")),n.extraWidth=10,n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(100),n.dockTypes[1]="anyin",i&&!beginnerBlock("return")&&(n.hidden=!0),(n=new ProtoBlock("returnToUrl")).palette=t.dict.action,(e.protoBlockDict.returnToUrl=n).staticLabels.push(_("return to URL")),n.extraWidth=10,n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(_("100")),n.dockTypes[1]="anyin",i&&!beginnerBlock("returnToUrl")&&(n.hidden=!0),(n=new ProtoBlock("calc")).palette=t.dict.action,(e.protoBlockDict.calc=n).staticLabels.push(_("calculate")),n.adjustWidthToLabel(),n.oneArgMathBlock(),n.defaults.push(_("action")),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",i&&!beginnerBlock("calc")&&(n.hidden=!0),(n=new ProtoBlock("namedcalc")).palette=t.dict.action,(e.protoBlockDict.namedcalc=n).staticLabels.push(_("action")),n.extraWidth=10,n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("namedcalc")&&(n.hidden=!0),(n=new ProtoBlock("nameddoArg")).palette=t.dict.action,e.protoBlockDict.nameddoArg=n,"ja"===s?n.staticLabels.push(_("do1")):n.staticLabels.push(_("do")),n.adjustWidthToLabel(),n.argClampBlock(),n.dockTypes[1]="anyin",i&&!beginnerBlock("nameddoArg")&&(n.hidden=!0),(n=new ProtoBlock("namedcalcArg")).palette=t.dict.action,(e.protoBlockDict.namedcalcArg=n).staticLabels.push(_("calculate")),n.adjustWidthToLabel(),n.argClampMathBlock(),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",i&&!beginnerBlock("namedcalcArg")&&(n.hidden=!0),(n=new ProtoBlock("doArg")).palette=t.dict.action,e.protoBlockDict.doArg=n,"ja"===s?n.staticLabels.push(_("do1")):n.staticLabels.push(_("do")),n.adjustWidthToLabel(),n.argClampOneArgBlock(),n.defaults.push(_("action")),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("doArg")&&(n.hidden=!0),(n=new ProtoBlock("calcArg")).palette=t.dict.action,(e.protoBlockDict.calcArg=n).staticLabels.push(_("calculate")),n.adjustWidthToLabel(),n.argClampOneArgMathBlock(),n.defaults.push(_("action")),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("calcArg")&&(n.hidden=!0),(n=new ProtoBlock("arg")).palette=t.dict.action,(e.protoBlockDict.arg=n).staticLabels.push("arg"),n.adjustWidthToLabel(),n.oneArgMathBlock(),n.defaults.push(1),n.dockTypes[0]="anyout",n.dockTypes[1]="numberin",i&&!beginnerBlock("arg")&&(n.hidden=!0),(n=new ProtoBlock("namedarg")).palette=t.dict.action,(e.protoBlockDict.namedarg=n).staticLabels.push("arg 1"),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("namedarg")&&(n.hidden=!0),(n=new ProtoBlock("listen")).palette=t.dict.action,(e.protoBlockDict.listen=n).staticLabels.push(_("on")),"ja"===s?(n.staticLabels.push(_("event")),n.staticLabels.push(_("do1")),n.extraWidth=15):n.staticLabels.push(_("event"),_("do")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(_("event")),n.defaults.push(_("action")),n.dockTypes[1]="textin",n.dockTypes[2]="textin",i&&!beginnerBlock("listen")&&(n.hidden=!0),(n=new ProtoBlock("dispatch")).palette=t.dict.action,(e.protoBlockDict.dispatch=n).staticLabels.push(_("broadcast")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(_("event")),n.dockTypes[1]="textin",i&&!beginnerBlock("dispatch")&&(n.hidden=!0),(n=new ProtoBlock("startdrum")).palette=t.dict.action,(e.protoBlockDict.startdrum=n).staticLabels.push(_("start drum")),n.extraWidth=10,n.adjustWidthToLabel(),n.stackClampZeroArgBlock(),i&&!beginnerBlock("startdrum")&&(n.hidden=!0),(n=new ProtoBlock("drum")).palette=t.dict.extras,(e.protoBlockDict.drum=n).staticLabels.push(_("start drum")),n.extraWidth=10,n.adjustWidthToLabel(),n.stackClampZeroArgBlock(),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("start")).palette=t.dict.action,(e.protoBlockDict.start=n).staticLabels.push(_("start")),n.extraWidth=40,n.labelOffset=15,n.adjustWidthToLabel(),n.stackClampZeroArgBlock(),(n=new ProtoBlock("action")).palette=t.dict.action,(e.protoBlockDict.action=n).staticLabels.push(_("action")),n.extraWidth=48,n.labelOffset=15,n.adjustWidthToLabel(),n.stackClampOneArgBlock(),n.defaults.push(_("action")),(n=new ProtoBlock("nameddo")).palette=t.dict.action,(e.protoBlockDict.nameddo=n).staticLabels.push(_("action")),n.extraWidth=40,n.adjustWidthToLabel(),n.zeroArgBlock(),n.hidden=!0,(n=new ProtoBlock("loadHeapFromApp")).palette=t.dict.heap,(e.protoBlockDict.loadHeapFromApp=n).staticLabels.push(_("load heap from App")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="textin",n.dockTypes[2]="textin",n.defaults.push("appName"),n.defaults.push("localhost"),i&&!beginnerBlock("loadHeapFromApp")&&(n.hidden=!0),(n=new ProtoBlock("saveHeapToApp")).palette=t.dict.heap,(e.protoBlockDict.saveHeapToApp=n).staticLabels.push(_("save heap to App")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="textin",n.dockTypes[2]="textin",n.defaults.push("appName"),n.defaults.push("localhost"),i&&!beginnerBlock("saveHeapToApp")&&(n.hidden=!0),(n=new ProtoBlock("showHeap")).palette=t.dict.heap,(e.protoBlockDict.showHeap=n).staticLabels.push(_("show heap")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("showHeap")&&(n.hidden=!0),(n=new ProtoBlock("heapLength")).palette=t.dict.heap,(e.protoBlockDict.heapLength=n).staticLabels.push(_("heap length")),n.adjustWidthToLabel(),n.parameterBlock(),n.dockTypes[0]="numberout",i&&!beginnerBlock("heapLength")&&(n.hidden=!0),(n=new ProtoBlock("heapEmpty")).palette=t.dict.heap,(e.protoBlockDict.heapEmpty=n).staticLabels.push(_("heap empty?")),n.adjustWidthToLabel(),n.booleanZeroArgBlock(),i&&!beginnerBlock("heapEmpty")&&(n.hidden=!0),(n=new ProtoBlock("emptyHeap")).palette=t.dict.heap,(e.protoBlockDict.emptyHeap=n).staticLabels.push(_("empty heap")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("emptyHeap")&&(n.hidden=!0),(n=new ProtoBlock("saveHeap")).palette=t.dict.heap,(e.protoBlockDict.saveHeap=n).staticLabels.push(_("save heap")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push("heap.json"),n.dockTypes[1]="textin",i&&!beginnerBlock("saveHeap")&&(n.hidden=!0),(n=new ProtoBlock("loadHeap")).palette=t.dict.heap,(e.protoBlockDict.loadHeap=n).staticLabels.push(_("load heap")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="filein",n.defaults=[[null,null]],i&&!beginnerBlock("loadHeap")&&(n.hidden=!0),(n=new ProtoBlock("reverseHeap")).palette=t.dict.heap,(e.protoBlockDict.reverseHeap=n).staticLabels.push(_("reverse heap")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("reverseHeap")&&(n.hidden=!0),(n=new ProtoBlock("indexHeap")).palette=t.dict.heap,(e.protoBlockDict.indexHeap=n).staticLabels.push(_("index heap")),n.adjustWidthToLabel(),n.oneArgMathBlock(),n.dockTypes[1]="numberin",n.defaults.push(1),i&&!beginnerBlock("indexHeap")&&(n.hidden=!0),(n=new ProtoBlock("setHeapEntry")).palette=t.dict.heap,e.protoBlockDict.setHeapEntry=n,"ja"===s?(n.staticLabels.push(_("set heap"),_("index")),n.staticLabels.push(_("value1"))):n.staticLabels.push(_("set heap"),_("index"),_("value")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="anyin",n.defaults.push(1),n.defaults.push(100),i&&!beginnerBlock("setHeapEntry")&&(n.hidden=!0),(n=new ProtoBlock("pop")).palette=t.dict.heap,(e.protoBlockDict.pop=n).staticLabels.push(_("pop")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("pop")&&(n.hidden=!0),(n=new ProtoBlock("push")).palette=t.dict.heap,(e.protoBlockDict.push=n).staticLabels.push(_("push")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(1),i&&!beginnerBlock("push")&&(n.hidden=!0),(n=new ProtoBlock("rightpos")).palette=t.dict.media,e.protoBlockDict.rightpos=n,"ja"===s?n.staticLabels.push(_("right2")):n.staticLabels.push(_("right (screen)")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("rightpos")&&(n.hidden=!0),(n=new ProtoBlock("leftpos")).palette=t.dict.media,e.protoBlockDict.leftpos=n,"ja"===s?n.staticLabels.push(_("left2")):n.staticLabels.push(_("left (screen)")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("leftpos")&&(n.hidden=!0),(n=new ProtoBlock("toppos")).palette=t.dict.media,(e.protoBlockDict.toppos=n).staticLabels.push(_("top (screen)")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("toppos")&&(n.hidden=!0),(n=new ProtoBlock("bottompos")).palette=t.dict.media,(e.protoBlockDict.bottompos=n).staticLabels.push(_("bottom (screen)")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("bottompos")&&(n.hidden=!0),(n=new ProtoBlock("width")).palette=t.dict.media,(e.protoBlockDict.width=n).staticLabels.push(_("width")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("width")&&(n.hidden=!0),(n=new ProtoBlock("height")).palette=t.dict.media,(e.protoBlockDict.height=n).staticLabels.push(_("height")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("height")&&(n.hidden=!0),(n=new ProtoBlock("stopplayback")).palette=t.dict.media,(e.protoBlockDict.stopplayback=n).staticLabels.push(_("stop play")),n.adjustWidthToLabel(),n.zeroArgBlock(),n.hidden=!0,(n=new ProtoBlock("playback")).palette=t.dict.media,(e.protoBlockDict.playback=n).defaults.push(null),n.staticLabels.push(_("play back")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="mediain",n.hidden=!0,(n=new ProtoBlock("speak")).palette=t.dict.media,(e.protoBlockDict.speak=n).staticLabels.push(_("speak")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push("hello"),n.dockTypes[1]="textin",n.hidden=!0,(n=new ProtoBlock("camera")).palette=t.dict.media,(e.protoBlockDict.camera=n).image="images/camera.svg",n.mediaBlock(),i&&!beginnerBlock("camera")&&(n.hidden=!0),(n=new ProtoBlock("video")).palette=t.dict.media,(e.protoBlockDict.video=n).image="images/video.svg",n.mediaBlock(),i&&!beginnerBlock("video")&&(n.hidden=!0),(n=new ProtoBlock("loadFile")).palette=t.dict.media,(e.protoBlockDict.loadFile=n).staticLabels.push(""),n.parameterBlock(),n.dockTypes[0]="fileout",i&&!beginnerBlock("loadFile")&&(n.hidden=!0),(n=new ProtoBlock("stopvideocam")).palette=t.dict.media,(e.protoBlockDict.stopvideocam=n).staticLabels.push(_("stop media")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("stopvideocam")&&(n.hidden=!0),(n=new ProtoBlock("tone")).palette=t.dict.media,(e.protoBlockDict.tone=n).staticLabels.push(_("hertz"),_("frequency"),_("duration (ms)")),n.adjustWidthToLabel(),n.defaults.push(392,1e3/3),n.twoArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",i&&!beginnerBlock("tone")&&(n.hidden=!0),(n=new ProtoBlock("tofrequency")).palette=t.dict.media,e.protoBlockDict.tofrequency=n,"ja"===s?(n.staticLabels.push(_("note to frequency")),n.staticLabels.push(_("name2")),n.staticLabels.push(_("octave"))):n.staticLabels.push(_("note to frequency"),_("name"),_("octave")),n.adjustWidthToLabel(),n.defaults.push("G"),n.defaults.push(4),n.twoArgMathBlock(),n.dockTypes[1]="notein",n.dockTypes[2]="anyin",i&&!beginnerBlock("tofrequency")&&(n.hidden=!0),(n=new ProtoBlock("turtleshell")).palette=t.dict.media,(e.protoBlockDict.turtleshell=n).staticLabels.push(_("avatar"),_("size"),_("image")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(55),n.defaults.push(null),n.dockTypes[1]="numberin",n.dockTypes[2]="anyin",i&&!beginnerBlock("turtleshell")&&(n.hidden=!0),(n=new ProtoBlock("show")).palette=t.dict.media,e.protoBlockDict.show=n,"ja"===s?(n.staticLabels.push(_("show1")),n.staticLabels.push(_("size"),_("obj"))):n.staticLabels.push(_("show"),_("size"),_("obj")),n.adjustWidthToLabel(),n.twoArgBlock(),n.defaults.push(24),n.defaults.push(_("text")),n.dockTypes[1]="numberin",n.dockTypes[2]="anyin",i&&!beginnerBlock("show")&&(n.hidden=!0),(n=new ProtoBlock("media")).palette=t.dict.media,(e.protoBlockDict.media=n).image="images/load-media.svg",n.mediaBlock(),n.dockTypes[0]="mediaout",i&&!beginnerBlock("media")&&(n.hidden=!0),(n=new ProtoBlock("text")).palette=t.dict.media,(e.protoBlockDict.text=n).extraWidth=30,n.valueBlock(),n.dockTypes[0]="textout",i&&!beginnerBlock("text")&&(n.hidden=!0),(n=new ProtoBlock("duplicatefactor")).palette=t.dict.flow,(e.protoBlockDict.duplicatefactor=n).staticLabels.push(_("duplicate factor")),n.adjustWidthToLabel(),n.parameterBlock(),n.hidden=!0;(n=new ProtoBlock("hiddennoflow")).palette=t.dict.flow,(e.protoBlockDict.hiddennoflow=n).hiddenNoFlow=!0,n.hiddenBlockNoFlow(),n.hidden=!0,(n=new ProtoBlock("hidden")).palette=t.dict.flow,(e.protoBlockDict.hidden=n).hiddenBlockFlow(),n.hidden=!0,(n=new ProtoBlock("backward")).palette=t.dict.flow,(e.protoBlockDict.backward=n).staticLabels.push(_("backward")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("backward")&&(n.hidden=!0),(n=new ProtoBlock("duplicatenotes")).palette=t.dict.flow,(e.protoBlockDict.duplicatenotes=n).staticLabels.push(_("duplicate")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(2),i&&!beginnerBlock("duplicatenotes")&&(n.hidden=!0),(n=new ProtoBlock("defaultcase")).palette=t.dict.flow,(e.protoBlockDict.defaultcase=n).staticLabels.push(_("default")),n.adjustWidthToLabel(),n.flowClampBlock(),i&&!beginnerBlock("defaultcase")&&(n.hidden=!0),(n=new ProtoBlock("case")).palette=t.dict.flow,(e.protoBlockDict.case=n).staticLabels.push(_("case")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="anyin",i&&!beginnerBlock("case")&&(n.hidden=!0),(n=new ProtoBlock("switch")).palette=t.dict.flow,(e.protoBlockDict.switch=n).staticLabels.push(_("switch")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="anyin",i&&!beginnerBlock("switch")&&(n.hidden=!0),(n=new ProtoBlock("clamp")).palette=t.dict.flow,(e.protoBlockDict.clamp=n).flowClampBlock(),n.hidden=!0,i&&!beginnerBlock("clamp")&&(n.hidden=!0),(n=new ProtoBlock("break")).palette=t.dict.flow,(e.protoBlockDict.break=n).staticLabels.push(_("stop")),n.adjustWidthToLabel(),n.basicBlockNoFlow(),i&&!beginnerBlock("break")&&(n.hidden=!0),(n=new ProtoBlock("waitFor")).palette=t.dict.flow,(e.protoBlockDict.waitFor=n).staticLabels.push(_("wait for")),n.adjustWidthToLabel(),n.oneBooleanArgBlock(),i&&!beginnerBlock("waitFor")&&(n.hidden=!0),(n=new ProtoBlock("until")).palette=t.dict.flow,e.protoBlockDict.until=n,"ja"===s?(n.staticLabels.push(_("until")),n.staticLabels.push(_("do2"))):n.staticLabels.push(_("until"),_("do")),n.extraWidth=15,n.adjustWidthToLabel(),n.flowClampBooleanArgBlock(),i&&!beginnerBlock("until")&&(n.hidden=!0),(n=new ProtoBlock("while")).palette=t.dict.flow,e.protoBlockDict.while=n,"ja"===s?(n.staticLabels.push(_("while")),n.staticLabels.push(_("do2"))):n.staticLabels.push(_("while"),_("do")),n.extraWidth=15,n.adjustWidthToLabel(),n.flowClampBooleanArgBlock(),i&&!beginnerBlock("while")&&(n.hidden=!0),(n=new ProtoBlock("ifthenelse")).palette=t.dict.flow,(e.protoBlockDict.ifthenelse=n).staticLabels.push(_("if"),_("then"),_("else")),n.extraWidth=15,n.adjustWidthToLabel(),n.doubleFlowClampBooleanArgBlock(),i&&!beginnerBlock("ifthenelse")&&(n.hidden=!0),(n=new ProtoBlock("if")).palette=t.dict.flow,(e.protoBlockDict.if=n).staticLabels.push(_("if"),_("then")),n.extraWidth=15,n.adjustWidthToLabel(),n.flowClampBooleanArgBlock(),i&&!beginnerBlock("if")&&(n.hidden=!0),(n=new ProtoBlock("forever")).palette=t.dict.flow,(e.protoBlockDict.forever=n).staticLabels.push(_("forever")),n.adjustWidthToLabel(),n.flowClampZeroArgBlock(),i&&!beginnerBlock("forever")&&(n.hidden=!0),(n=new ProtoBlock("repeat")).palette=t.dict.flow,(e.protoBlockDict.repeat=n).staticLabels.push(_("repeat")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(4),i&&!beginnerBlock("repeat")&&(n.hidden=!0),(n=new ProtoBlock("nopValueBlock")).palette=t.dict.extras,(e.protoBlockDict.nopValueBlock=n).staticLabels.push(_("unknown")),n.adjustWidthToLabel(),n.valueBlock(),n.dockTypes[0]="anyout",n.hidden=!0,(n=new ProtoBlock("nopOneArgMathBlock")).palette=t.dict.extras,(e.protoBlockDict.nopOneArgMathBlock=n).oneArgMathBlock(),n.staticLabels.push(_("unknown")),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",n.hidden=!0,(n=new ProtoBlock("nopTwoArgMathBlock")).palette=t.dict.extras,(e.protoBlockDict.nopTwoArgMathBlock=n).twoArgMathBlock(),n.staticLabels.push(_("unknown")),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.hidden=!0,(n=new ProtoBlock("nopZeroArgBlock")).palette=t.dict.extras,(e.protoBlockDict.nopZeroArgBlock=n).staticLabels.push(_("unknown")),n.adjustWidthToLabel(),n.zeroArgBlock(),n.hidden=!0,(n=new ProtoBlock("nopOneArgBlock")).palette=t.dict.extras,(e.protoBlockDict.nopOneArgBlock=n).staticLabels.push(_("unknown")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.hidden=!0,(n=new ProtoBlock("nopTwoArgBlock")).palette=t.dict.extras,(e.protoBlockDict.nopTwoArgBlock=n).staticLabels.push(_("unknown")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.hidden=!0,(n=new ProtoBlock("nopThreeArgBlock")).palette=t.dict.extras,(e.protoBlockDict.nopThreeArgBlock=n).staticLabels.push(_("unknown")),n.adjustWidthToLabel(),n.threeArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.dockTypes[3]="anyin",n.hidden=!0,(n=new ProtoBlock("openpalette")).palette=t.dict.extras,(e.protoBlockDict.openpalette=n).staticLabels.push(_("open palette")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="textin",n.defaults.push(_("rhythm")),i&&!beginnerBlock("openpalette")&&(n.hidden=!0),(n=new ProtoBlock("deleteblock")).palette=t.dict.extras,(e.protoBlockDict.deleteblock=n).staticLabels.push(_("delete block")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="numberin",i&&!beginnerBlock("deleteblock")&&(n.hidden=!0),(n=new ProtoBlock("moveblock")).palette=t.dict.extras,(e.protoBlockDict.moveblock=n).staticLabels.push(_("move block"),_("block number"),_("x"),_("y")),n.adjustWidthToLabel(),n.threeArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.dockTypes[3]="numberin",i&&!beginnerBlock("moveblock")&&(n.hidden=!0),(n=new ProtoBlock("runblock")).palette=t.dict.extras,(e.protoBlockDict.runblock=n).staticLabels.push(_("run block")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="numberin",i&&!beginnerBlock("runblock")&&(n.hidden=!0),(n=new ProtoBlock("dockblock")).palette=t.dict.extras,(e.protoBlockDict.dockblock=n).staticLabels.push(_("connect blocks"),_("target block"),_("connection number"),_("block number")),n.adjustWidthToLabel(),n.threeArgBlock(),n.dockTypes[1]="numberin",n.dockTypes[2]="numberin",n.dockTypes[3]="numberin",i&&!beginnerBlock("dockblock")&&(n.hidden=!0),(n=new ProtoBlock("makeblock")).palette=t.dict.extras,(e.protoBlockDict.makeblock=n).staticLabels.push(_("make block")),n.adjustWidthToLabel(),n.argClampOneArgMathBlock(),n.defaults.push(_("note")),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",i&&!beginnerBlock("makeblock")&&(n.hidden=!0),(n=new ProtoBlock("saveabc")).palette=t.dict.extras,(e.protoBlockDict.saveabc=n).staticLabels.push(_("save as ABC")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(_("title")+".abc"),n.dockTypes[1]="textin",n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("savelilypond")).palette=t.dict.extras,(e.protoBlockDict.savelilypond=n).staticLabels.push(_("save as Lilypond")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(_("title")+".ly"),n.dockTypes[1]="textin",n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("savesvg")).palette=t.dict.extras,(e.protoBlockDict.savesvg=n).staticLabels.push(_("save as SVG")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(_("title")+".svg"),n.dockTypes[1]="textin",n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("nobackground")).palette=t.dict.extras,(e.protoBlockDict.nobackground=n).staticLabels.push(_("no background")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("nobackground")&&(n.hidden=!0),(n=new ProtoBlock("showblocks")).palette=t.dict.extras,(e.protoBlockDict.showblocks=n).staticLabels.push(_("show blocks")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("showblocks")&&(n.hidden=!0),(n=new ProtoBlock("hideblocks")).palette=t.dict.extras,(e.protoBlockDict.hideblocks=n).staticLabels.push(_("hide blocks")),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("hideblocks")&&(n.hidden=!0),(n=new ProtoBlock("openProject")).palette=t.dict.extras,(e.protoBlockDict.openProject=n).staticLabels.push(_("open project")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push("url"),n.dockTypes[1]="textin",i&&!beginnerBlock("openProject")&&(n.hidden=!0),(n=new ProtoBlock("vspace")).palette=t.dict.extras,(e.protoBlockDict.vspace=n).staticLabels.push(""),n.extraWidth=-10,n.zeroArgBlock(),"ja"===s&&i&&!beginnerBlock("vspace")&&(n.hidden=!0),(n=new ProtoBlock("hspace")).palette=t.dict.extras,(e.protoBlockDict.hspace=n).staticLabels.push(""),n.oneArgMathBlock(),n.dockTypes[0]="anyout",n.dockTypes[1]="anyin","ja"===s&&i&&!beginnerBlock("hspace")&&(n.hidden=!0),(n=new ProtoBlock("wait")).palette=t.dict.extras,(e.protoBlockDict.wait=n).staticLabels.push(_("wait")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(1),i&&!beginnerBlock("wait")&&(n.hidden=!0),(n=new ProtoBlock("comment")).palette=t.dict.extras,(e.protoBlockDict.comment=n).staticLabels.push(_("comment")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Music Blocks")),i&&!beginnerBlock("comment")&&(n.hidden=!0),(n=new ProtoBlock("print")).palette=i?t.dict.media:t.dict.extras,(e.protoBlockDict.print=n).staticLabels.push(_("print")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Music Blocks")),i&&!beginnerBlock("print")&&(n.hidden=!0),(n=new ProtoBlock("pitchness")).palette=t.dict.sensors,(e.protoBlockDict.pitchness=n).staticLabels.push(_("pitch")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("pitchness")&&(n.hidden=!0),n.hidden=!0,(n=new ProtoBlock("loudness")).palette=t.dict.sensors,(e.protoBlockDict.loudness=n).staticLabels.push(_("loudness")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("loudness")&&(n.hidden=!0),(n=new ProtoBlock("myclick")).palette=t.dict.sensors,(e.protoBlockDict.myclick=n).staticLabels.push(_("click")),n.adjustWidthToLabel(),n.parameterBlock(),n.dockTypes[0]="textout",i&&!beginnerBlock("myclick")&&(n.hidden=!0),(n=new ProtoBlock("getblue")).palette=t.dict.sensors,(e.protoBlockDict.getblue=n).staticLabels.push(_("blue")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("getblue")&&(n.hidden=!0),(n=new ProtoBlock("getgreen")).palette=t.dict.sensors,(e.protoBlockDict.getgreen=n).staticLabels.push(_("green")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("getgreen")&&(n.hidden=!0),(n=new ProtoBlock("getred")).palette=t.dict.sensors,(e.protoBlockDict.getred=n).staticLabels.push(_("red")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("getred")&&(n.hidden=!0),(n=new ProtoBlock("getcolorpixel")).palette=t.dict.sensors,(e.protoBlockDict.getcolorpixel=n).staticLabels.push(_("pixel color")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("getcolorpixel")&&(n.hidden=!0),(n=new ProtoBlock("time")).palette=t.dict.sensors,(e.protoBlockDict.time=n).staticLabels.push(_("time")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("time")&&(n.hidden=!0),(n=new ProtoBlock("mousey")).palette=t.dict.sensors,(e.protoBlockDict.mousey=n).staticLabels.push(_("cursor y")),n.extraWidth=15,n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("mousey")&&(n.hidden=!0),(n=new ProtoBlock("mousex")).palette=t.dict.sensors,(e.protoBlockDict.mousex=n).staticLabels.push(_("cursor x")),n.extraWidth=15,n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("mousex")&&(n.hidden=!0),(n=new ProtoBlock("mousebutton")).palette=t.dict.sensors,(e.protoBlockDict.mousebutton=n).staticLabels.push(_("mouse button")),n.adjustWidthToLabel(),n.booleanZeroArgBlock(),i&&!beginnerBlock("mousebutton")&&(n.hidden=!0),(n=new ProtoBlock("toascii")).palette=t.dict.sensors,(e.protoBlockDict.toascii=n).staticLabels.push(_("to ASCII")),n.defaults.push(65),n.oneArgMathBlock(),i&&!beginnerBlock("toascii")&&(n.hidden=!0),(n=new ProtoBlock("keyboard")).palette=t.dict.sensors,(e.protoBlockDict.keyboard=n).staticLabels.push(_("keyboard")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("keyboard")&&(n.hidden=!0),(n=new ProtoBlock("stopTurtle")).palette=t.dict.ensemble,(e.protoBlockDict.stopTurtle=n).staticLabels.push(_("stop mouse")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("stopTurtle")&&(n.hidden=!0),(n=new ProtoBlock("startTurtle")).palette=t.dict.ensemble,(e.protoBlockDict.startTurtle=n).staticLabels.push(_("start mouse")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("startTurtle")&&(n.hidden=!0),(n=new ProtoBlock("turtlecolor")).palette=t.dict.ensemble,(e.protoBlockDict.turtlecolor=n).staticLabels.push(_("mouse color")),n.adjustWidthToLabel(),n.oneArgMathBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("turtlecolor")&&(n.hidden=!0),(n=new ProtoBlock("turtleheading")).palette=t.dict.ensemble,(e.protoBlockDict.turtleheading=n).staticLabels.push(_("mouse heading")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("turtleheading")&&(n.hidden=!0),(n=new ProtoBlock("setxyturtle")).palette=t.dict.ensemble,e.protoBlockDict.setxyturtle=n,"ja"===s?(n.staticLabels.push(_("set mouse")),n.staticLabels.push(_("name1")),n.staticLabels.push(_("x"),_("y"))):n.staticLabels.push(_("set mouse"),_("name"),_("x"),_("y")),n.threeArgBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.dockTypes[2]="numberin",n.dockTypes[3]="numberin",n.defaults.push(_("Mr. Mouse"),0,0),n.hidden=!0,(n=new ProtoBlock("setturtle")).palette=t.dict.ensemble,(e.protoBlockDict.setturtle=n).staticLabels.push(_("set mouse")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("setturtle")&&(n.hidden=!0),(n=new ProtoBlock("yturtle")).palette=t.dict.ensemble,(e.protoBlockDict.yturtle=n).staticLabels.push(_("mouse y")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("yturtle")&&(n.hidden=!0),(n=new ProtoBlock("xturtle")).palette=t.dict.ensemble,(e.protoBlockDict.xturtle=n).staticLabels.push(_("mouse x")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("xturtle")&&(n.hidden=!0),(n=new ProtoBlock("turtleelapsednotes")).palette=t.dict.ensemble,(e.protoBlockDict.turtleelapsednotes=n).staticLabels.push(_("mouse notes played")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("turtleelapsednotes")&&(n.hidden=!0),(n=new ProtoBlock("turtlepitch")).palette=t.dict.ensemble,(e.protoBlockDict.turtlepitch=n).staticLabels.push(_("mouse pitch number")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("turtlepitch")&&(n.hidden=!0),(n=new ProtoBlock("turtlenote")).palette=t.dict.ensemble,(e.protoBlockDict.turtlenote=n).staticLabels.push(_("mouse note value")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.hidden=!0,n.defaults.push(_("Mr. Mouse")),n.hidden=!0,(n=new ProtoBlock("turtlenote2")).palette=t.dict.ensemble,(e.protoBlockDict.turtlenote2=n).staticLabels.push(_("mouse note value")),n.oneArgMathBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("turtlenote2")&&(n.hidden=!0),(n=new ProtoBlock("turtlesync")).palette=t.dict.ensemble,(e.protoBlockDict.turtlesync=n).staticLabels.push(_("mouse sync")),n.oneArgBlock(),n.adjustWidthToLabel(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("turtlesync")&&(n.hidden=!0),(n=new ProtoBlock("foundturtle")).palette=t.dict.ensemble,(e.protoBlockDict.foundturtle=n).staticLabels.push(_("found mouse")),n.adjustWidthToLabel(),n.extraWidth=50,n.booleanOneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("foundturtle")&&(n.hidden=!0),(n=new ProtoBlock("newturtle")).palette=t.dict.ensemble,(e.protoBlockDict.newturtle=n).staticLabels.push(_("new mouse")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("newturtle")&&(n.hidden=!0),(n=new ProtoBlock("turtlename")).palette=t.dict.ensemble,(e.protoBlockDict.turtlename=n).staticLabels.push(_("mouse name")),n.adjustWidthToLabel(),n.parameterBlock(),n.dockTypes[0]="textout",i&&!beginnerBlock("turtlename")&&(n.hidden=!0),(n=new ProtoBlock("setturtlename")).palette=t.dict.ensemble,(e.protoBlockDict.setturtlename=n).staticLabels.push(_("set name")),n.staticLabels.push(_("source")),n.staticLabels.push(_("target")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="anyin",n.dockTypes[2]="anyin",n.defaults.push(-1),n.defaults.push(_("Mr. Mouse")),n.hidden=!0,i&&!beginnerBlock("setturtlename")&&(n.hidden=!0),(n=new ProtoBlock("setturtlename2")).palette=t.dict.ensemble,(e.protoBlockDict.setturtlename2=n).staticLabels.push(_("set name")),n.adjustWidthToLabel(),n.oneArgBlock(),n.dockTypes[1]="anyin",n.defaults.push(_("Mr. Mouse")),i&&!beginnerBlock("setturtlename2")&&(n.hidden=!0),(n=new ProtoBlock("notevolumefactor")).palette=t.dict.volume,(e.protoBlockDict.notevolumefactor=n).staticLabels.push(_("master volume")),n.adjustWidthToLabel(),n.parameterBlock(),i&&!beginnerBlock("notevolumefactor")&&(n.hidden=!0),(n=new ProtoBlock("ppp")).palette=t.dict.volume,(e.protoBlockDict.ppp=n).staticLabels.push("ppp"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("ppp")&&(n.hidden=!0),(n=new ProtoBlock("pp")).palette=t.dict.volume,(e.protoBlockDict.pp=n).staticLabels.push("pp"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("pp")&&(n.hidden=!0),(n=new ProtoBlock("p")).palette=t.dict.volume,(e.protoBlockDict.p=n).staticLabels.push("p"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("p")&&(n.hidden=!0),(n=new ProtoBlock("mp")).palette=t.dict.volume,(e.protoBlockDict.mp=n).staticLabels.push("mp"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("mp")&&(n.hidden=!0),(n=new ProtoBlock("mf")).palette=t.dict.volume,(e.protoBlockDict.mf=n).staticLabels.push("mf"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("mf")&&(n.hidden=!0),(n=new ProtoBlock("f")).palette=t.dict.volume,(e.protoBlockDict.f=n).staticLabels.push("f"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("f")&&(n.hidden=!0),(n=new ProtoBlock("ff")).palette=t.dict.volume,(e.protoBlockDict.ff=n).staticLabels.push("ff"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("ff")&&(n.hidden=!0),(n=new ProtoBlock("fff")).palette=t.dict.volume,(e.protoBlockDict.fff=n).staticLabels.push("fff"),n.adjustWidthToLabel(),n.zeroArgBlock(),i&&!beginnerBlock("fff")&&(n.hidden=!0),(n=new ProtoBlock("setsynthvolume2")).palette=t.dict.volume,(e.protoBlockDict.setsynthvolume2=n).staticLabels.push(_("set synth volume"),_("synth"),_("volume")),n.adjustWidthToLabel(),n.flowClampTwoArgBlock(),n.dockTypes[1]="textin",n.defaults.push(DEFAULTVOICE),n.defaults.push(50),n.hidden=!0,(n=new ProtoBlock("setdrumvolume")).palette=t.dict.volume,(e.protoBlockDict.setdrumvolume=n).staticLabels.push(_("set drum volume"),_("drum"),_("volume")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="textin",n.defaults.push(DEFAULTDRUM),n.defaults.push(50),i&&!beginnerBlock("setdrumvolume")&&(n.hidden=!0),(n=new ProtoBlock("setsynthvolume")).palette=t.dict.volume,(e.protoBlockDict.setsynthvolume=n).staticLabels.push(_("set synth volume"),_("synth"),_("volume")),n.adjustWidthToLabel(),n.twoArgBlock(),n.dockTypes[1]="textin",n.defaults.push(DEFAULTVOICE),n.defaults.push(50),i&&!beginnerBlock("setsynthvolume")&&(n.hidden=!0),(n=new ProtoBlock("setnotevolume")).palette=t.dict.volume,(e.protoBlockDict.setnotevolume=n).staticLabels.push(_("set master volume")),n.adjustWidthToLabel(),n.oneArgBlock(),n.defaults.push(50),i&&!beginnerBlock("setnotevolume")&&(n.hidden=!0),(n=new ProtoBlock("setnotevolume2")).palette=t.dict.volume,(e.protoBlockDict.setnotevolume2=n).staticLabels.push(_("set master volume")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(50),n.hidden=!0,n.deprecated=!0,(n=new ProtoBlock("articulation")).palette=t.dict.volume,(e.protoBlockDict.articulation=n).staticLabels.push(_("set relative volume")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(25),i&&!beginnerBlock("articulation")&&(n.hidden=!0),(n=new ProtoBlock("decrescendo")).palette=t.dict.volume,(e.protoBlockDict.decrescendo=n).staticLabels.push(_("decrescendo")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(5),i&&!beginnerBlock("decrescendo")&&(n.hidden=!0);var n=new ProtoBlock("crescendo");for(var r in n.palette=t.dict.volume,(e.protoBlockDict.crescendo=n).staticLabels.push(_("crescendo")),n.adjustWidthToLabel(),n.flowClampOneArgBlock(),n.defaults.push(5),i&&!beginnerBlock("crescendo")&&(n.hidden=!0),e.protoBlockDict)null!=e.protoBlockDict[r].palette&&e.protoBlockDict[r].palette.add(e.protoBlockDict[r])}var TEXTWIDTH=240,STRINGLEN=9,LONGPRESSTIME=1500,INLINECOLLAPSIBLES=["newnote","interval","osctime"],COLLAPSIBLES=["drum","start","action","matrix","pitchdrummatrix","rhythmruler2","timbre","status","pitchstaircase","tempo","pitchslider","modewidget","newnote","musickeyboard","temperament","interval","osctime"],NOHIT=["hidden","hiddennoflow"],SPECIALINPUTS=["text","number","solfege","eastindiansolfege","notename","voicename","modename","drumname","effectsname","filtertype","oscillatortype","boolean","intervalname","invertmode","accidentalname","temperamentname","noisename","customNote"],WIDENAMES=["intervalname","accidentalname","drumname","effectsname","voicename","modename","temperamentname","modename","noisename"],EXTRAWIDENAMES=[],PIEMENUS=["solfege","eastindiansolfege","notename","voicename","drumname","effectsname","accidentalname","invertmode","boolean","filtertype","oscillatortype","intervalname","modename","temperamentname","noisename","customNote"];function Block(t,c,e){null!==t?(this.protoblock=t,this.name=t.name,this.overrideName=e,this.blocks=c,this.collapsed=!1,this.inCollapsed=!1,this.trash=!1,this.loadComplete=!1,this.label=null,this.labelattr=null,this.text=null,this.value=null,this.privateData=null,this.image=t.image,this.imageBitmap=null,this.container=null,this.bounds=null,this.width=0,this.height=0,this.hitHeight=0,this.bitmap=null,this.highlightBitmap=null,this.disconnectedBitmap=null,this.disconnectedHighlightBitmap=null,this.artwork=null,this.collapseArtwork=null,this.collapseButtonBitmap=null,this.expandButtonBitmap=null,this.collapseBlockBitmap=null,this.highlightCollapseBlockBitmap=null,this.collapseText=null,this.size=1,this.docks=[],this.connections=[],this.clampCount=[1,1],this.argClampSlots=[1],this.postProcess=null,(this.postProcessArg=this)._labelLock=!1,this._piemenuExitTime=null,this._triggerLongPress=!1,this._triggerLock=!1,this._check_meter_block=null,this.original={x:0,y:0},this.offset={x:0,y:0},this._createCache=function(a,n){var r=this;return new Promise(function(i,s){var l=0;function o(t){return e.apply(this,arguments)}function e(){return(e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void(t.prev=0)!==e&&(l=e),3<l)throw new Error("COULD NOT CREATE CACHE");t.next=4;break;case 4:if(r.bounds=r.container.getBounds(),null===r.bounds)return console.log("// Try regenerating the artwork"),r.regenerateArtwork(!0,[]),o(l+1),t.next=11,r.pause(100);t.next=13;break;case 11:t.next=16;break;case 13:r.container.cache(r.bounds.x,r.bounds.y,r.bounds.width,r.bounds.height),a(r,n),i();case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),s(t.t0);case 21:case"end":return t.stop()}},t,null,[[0,18]])}))).apply(this,arguments)}o()})},this.updateCache=function(t){var a=this;return new Promise(function(i,s){var l=0;function o(t){return e.apply(this,arguments)}function e(){return(e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void(t.prev=0)!==e&&(l=e),3<l)throw new Error("COULD NOT UPDATE CACHE");t.next=4;break;case 4:if(null==a.bounds)return console.log("UPDATE CACHE: BOUNDS NOT READY"),o(l+1),t.next=9,a.pause(200);t.next=11;break;case 9:t.next=14;break;case 11:a.container.updateCache(),a.blocks.refreshCanvas(),i();case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),s(t.t0);case 19:case"end":return t.stop()}},t,null,[[0,16]])}))).apply(this,arguments)}o()})},this.ignore=function(){if(null===this.bitmap)return!0;if("hidden"===this.name)return!0;if("hiddennoflow"===this.name)return!0;if(this.trash)return!0;if(this.inCollapsed)return!0;if(null!==this.disconnectedBitmap&&null!==this.disconnectedHighlightBitmap){if(!(this.bitmap.visible||this.highlightBitmap.visible||this.disconnectedBitmap.visible||this.disconnectedHighlightBitmap.visible)){if(null===this.collapseBlockBitmap)return!0;if(!this.collapseBlockBitmap.visible&&!this.highlightCollapseBlockBitmap.visible)return!0}}else if(!this.bitmap.visible&&!this.highlightBitmap.visible){if(null===this.collapseBlockBitmap)return!0;if(!this.collapseBlockBitmap.visible&&!this.highlightCollapseBlockBitmap.visible)return!0}return!1},this.offScreen=function(t){return!this.trash&&t.offScreen(this.container.x,this.container.y)},this.copySize=function(){this.size=this.protoblock.size},this.getInfo=function(){return this.name+" block"},this.isCollapsible=function(){return-1!==COLLAPSIBLES.indexOf(this.name)},this.isInlineCollapsible=function(){return-1!==INLINECOLLAPSIBLES.indexOf(this.name)},this.highlight=function(){if(!this.trash&&!this.inCollapsed&&this.container.visible){if(null!==this.disconnectedBitmap){if(!this.bitmap.visible&&!this.disconnectedBitmap.visible)return}else if(!this.bitmap.visible)return;this.container.visible=!0,this.bitmap.visible=!1,null!==this.disconnectedBitmap&&(this.disconnectedBitmap.visible=!1),this.collapsed?(null!==this.highlightCollapseBlockBitmap&&(this.highlightCollapseBlockBitmap.visible=!0),null!==this.collapseText&&(this.collapseText.visible=!0),null!==this.collapseBlockBitmap&&(this.collapseBlockBitmap.visible=!1),this.highlightBitmap.visible=!1,null!==this.disconnectedHighlightBitmap&&(this.disconnectedHighlightBitmap.visible=!1),this.highlightBitmap.visible=!1):(this.isDisconnected()?(this.disconnectedHighlightBitmap.visible=!0,this.highlightBitmap.visible=!1):(null!==this.disconnectedHighlightBitmap&&(this.disconnectedHighlightBitmap.visible=!1),this.highlightBitmap.visible=!0),this.isCollapsible()&&(null!==this.collapseText&&(this.collapseText.visible=!1),null!==this.collapseBlockBitmap&&(this.collapseBlockBitmap.visible=!1),null!==this.highlightCollapseBlockBitmap&&(this.highlightCollapseBlockBitmap.visible=!1))),this.container.updateCache()}},this.unhighlight=function(){this.trash||this.inCollapsed||(null!==this.bitmap?(this.highlightBitmap.visible=!1,null!==this.disconnectedHighlightBitmap&&(this.disconnectedHighlightBitmap.visible=!1),this.container.visible=!0,this.collapsed?(null!==this.collapseBlockBitmap&&(this.collapseBlockBitmap.visible=!0),null!==this.collapseText&&(this.collapseText.visible=!0),null!==this.highlightCollapseBlockBitmap&&(this.highlightCollapseBlockBitmap.visible=!1),this.bitmap.visible=!1):(this.isDisconnected()?(this.disconnectedBitmap.visible=!0,this.bitmap.visible=!1):(null!==this.disconnectedBitmap&&(this.disconnectedBitmap.visible=!1),this.bitmap.visible=!0),this.container.visible=!0,this.isCollapsible()&&(null!==this.collapseText&&(this.collapseText.visible=!1),null!==this.collapseBlockBitmap&&(this.collapseBlockBitmap.visible=!1),null!==this.highlightCollapseBlockBitmap&&(this.highlightCollapseBlockBitmap.visible=!1))),this.container.updateCache()):console.log("bitmap not ready"))},this.updateArgSlots=function(t){this.argClampSlots=t,this._newArtwork(),this.regenerateArtwork(!1)},this.updateSlots=function(t,e){this.clampCount[t]+=e,this._newArtwork(e),this.regenerateArtwork(!1)},this.resize=function(i){if(this.postProcess=function(t){if(null!==t.imageBitmap&&(t._positionMedia(t.imageBitmap,t.imageBitmap.image.width,t.imageBitmap.image.height,i),z=t.container.children.length-1,t.container.setChildIndex(t.imageBitmap,z)),"start"===t.name||"drum"===t.name){for(var e=0;e<t.blocks.turtles.turtleList.length;e++)if(t.blocks.turtles.turtleList[e].startBlock===t){t.blocks.turtles.turtleList[e].resizeDecoration(i,t.bitmap.image.width),t._ensureDecorationOnTop();break}}else t.isCollapsible()&&t._ensureDecorationOnTop();t.updateCache(),t._calculateBlockHitArea(),t.trash&&t.hide()},(this.postProcessArg=this).protoblock.scale=i,this._newArtwork(0),this.regenerateArtwork(!0,[]),null!==this.text&&this._positionText(i),null!==this.container){if(this.isCollapsible()){this._generateCollapseArtwork(function(t){t.collapseButtonBitmap.scaleX=t.collapseButtonBitmap.scaleY=t.collapseButtonBitmap.scale=i/3,t.expandButtonBitmap.scaleX=t.expandButtonBitmap.scaleY=t.expandButtonBitmap.scale=i/3,t.updateCache(),t._calculateBlockHitArea()});var t=10*i;this.collapseText.font=t+"px Sans",this._positionCollapseLabel(i)}}},this._newArtwork=function(t){if(this.isInlineCollapsible()){(i=new ProtoBlock("collapse-note")).scale=this.protoblock.scale,"interval"===this.name?i.extraWidth=80:i.extraWidth=40,i.zeroArgBlock();var e=i.generator();this.collapseArtwork=e[0];e=this.protoblock.generator(this.clampCount[0])}else if(this.isCollapsible()){var i;(i=new ProtoBlock("collapse")).scale=this.protoblock.scale,i.extraWidth=40,i.basicBlockCollapsed();e=i.generator();this.collapseArtwork=e[0];e=this.protoblock.generator(this.clampCount[0])}else if("ifthenelse"===this.name)e=this.protoblock.generator(this.clampCount[0],this.clampCount[1]);else if("clamp"===this.protoblock.style)e=this.protoblock.generator(this.clampCount[0]);else if("argflowclamp"===this.protoblock.style)e=this.protoblock.generator(this.clampCount[0]);else switch(this.name){case"equal":case"greater":case"less":e=this.protoblock.generator(this.clampCount[0]);break;case"makeblock":case"calcArg":case"doArg":case"namedcalcArg":case"nameddoArg":e=this.protoblock.generator(this.argClampSlots);this.size=2;for(var s=0;s<this.argClampSlots.length;s++)this.size+=this.argClampSlots[s];this.docks=[],this.docks.push([e[1][0][0],e[1][0][1],this.protoblock.dockTypes[0]]);break;default:if(this.isArgBlock())e=this.protoblock.generator(this.clampCount[0]);else if(this.isTwoArgBlock())e=this.protoblock.generator(this.clampCount[0]);else e=this.protoblock.generator();this.size+=t}switch(this.name){case"nameddoArg":for(s=1;s<e[1].length-1;s++)this.docks.push([e[1][s][0],e[1][s][1],"anyin"]);this.docks.push([e[1][2][0],e[1][2][1],"in"]);break;case"namedcalcArg":for(s=1;s<e[1].length;s++)this.docks.push([e[1][s][0],e[1][s][1],"anyin"]);break;case"doArg":this.docks.push([e[1][1][0],e[1][1][1],this.protoblock.dockTypes[1]]);for(s=2;s<e[1].length-1;s++)this.docks.push([e[1][s][0],e[1][s][1],"anyin"]);this.docks.push([e[1][3][0],e[1][3][1],"in"]);break;case"makeblock":case"calcArg":this.docks.push([e[1][1][0],e[1][1][1],this.protoblock.dockTypes[1]]);for(s=2;s<e[1].length;s++)this.docks.push([e[1][s][0],e[1][s][1],"anyin"])}this.artwork=e[0];for(s=0;s<this.docks.length;s++)this.docks[s][0]=e[1][s][0],this.docks[s][1]=e[1][s][1];this.width=e[2],this.height=e[3],this.hitHeight=e[4]},this.imageLoad=function(){var t=10*this.protoblock.scale;this.text=new createjs.Text("",t+"px Sans",platformColor.blockText),this.generateArtwork(!0,[])},this._addImage=function(){var e=new Image,i=this;e.onload=function(){var t=new createjs.Bitmap(e);t.name="media",i.container.addChild(t),i._positionMedia(t,e.width,e.height,i.protoblock.scale),i.imageBitmap=t,i.updateCache()},e.src=this.image},this.regenerateArtwork=function(t){null!=this.bitmap&&this.container.removeChild(this.bitmap),null!=this.highlightBitmap&&this.container.removeChild(this.highlightBitmap),null!=this.disconnectedBitmap&&this.container.removeChild(this.disconnectedBitmap),null!=this.disconnectedHighlightBitmap&&this.container.removeChild(this.disconnectedHighlightBitmap),t&&null!==this.collapseBlockBitmap&&(this.container.removeChild(this.collapseButtonBitmap),this.container.removeChild(this.expandButtonBitmap),this.container.removeChild(this.collapseBlockBitmap),this.container.removeChild(this.highlightCollapseBlockBitmap)),this.generateArtwork(!1)},this.generateArtwork=function(i){function l(t,e){null!=e.highlightBitmap&&e.container.removeChild(e.highlightBitmap),e.highlightBitmap=t,e.container.addChild(e.highlightBitmap),e.highlightBitmap.x=0,e.highlightBitmap.y=0,e.highlightBitmap.name="bmp_highlight_"+n,e.blocks.logo.runningLilypond||(e.highlightBitmap.cursor="pointer"),e.highlightBitmap.visible=!1,i||e.container.uncache(),__callback=function(t,e){t.blocks.refreshCanvas();var i=t.blocks.blockList.indexOf(t);e?(t._loadEventHandlers(),null!==t.image&&t._addImage(),t._finishImageLoad()):(t.isCollapsible&&t._ensureDecorationOnTop(),t.blocks.adjustDocks(i,!0),t._positionText(t.protoblock.scale),t.isCollapsible()&&(t.bitmap.visible=!t.collapsed,t.highlightBitmap.visible=!1,t.updateCache()),null!=t.postProcess&&(t.postProcess(t.postProcessArg),t.postProcess=null))},e._createCache(__callback,i)}function o(t,e){if(null!=e.disconnectedHighlightBitmap&&e.container.removeChild(e.disconnectedHighlightBitmap),e.disconnectedHighlightBitmap=t,e.container.addChild(e.disconnectedHighlightBitmap),e.disconnectedHighlightBitmap.x=0,e.disconnectedHighlightBitmap.y=0,e.disconnectedHighlightBitmap.name="bmp_disconnect_hightlight_"+n,e.blocks.logo.runningLilypond||(e.disconnectedHighlightBitmap.cursor="pointer"),e.disconnectedHighlightBitmap.visible=!1,e.protoblock.disabled)var i=e.artwork.replace(/fill_color/g,DISABLEDFILLCOLOR).replace(/stroke_color/g,DISABLEDSTROKECOLOR).replace("block_label",safeSVG(r));else i=e.artwork.replace(/fill_color/g,PALETTEHIGHLIGHTCOLORS[e.protoblock.palette.name]).replace(/stroke_color/g,HIGHLIGHTSTROKECOLORS[e.protoblock.palette.name]).replace("block_label",safeSVG(r));for(var s=1;s<e.protoblock.staticLabels.length;s++)i=i.replace("arg_label_"+s,e.protoblock.staticLabels[s]);_blockMakeBitmap(i,l,e)}function a(t,e){if(null!=e.disconnectedBitmap&&e.container.removeChild(e.disconnectedBitmap),e.disconnectedBitmap=t,e.container.addChild(e.disconnectedBitmap),e.disconnectedBitmap.x=0,e.disconnectedBitmap.y=0,e.disconnectedBitmap.name="bmp_disconnect_"+n,e.blocks.logo.runningLilypond||(e.disconnectedBitmap.cursor="pointer"),e.disconnectedBitmap.visible=!1,e.protoblock.disabled)var i=e.artwork.replace(/fill_color/g,DISABLEDFILLCOLOR).replace(/stroke_color/g,DISABLEDSTROKECOLOR).replace("block_label",safeSVG(r));else i=e.artwork.replace(/fill_color/g,platformColor.paletteColors[e.protoblock.palette.name][3]).replace(/stroke_color/g,HIGHLIGHTSTROKECOLORS[e.protoblock.palette.name]).replace("block_label",safeSVG(r));for(var s=1;s<e.protoblock.staticLabels.length;s++)i=i.replace("arg_label_"+s,e.protoblock.staticLabels[s]);_blockMakeBitmap(i,o,e)}var n=this.blocks.blockList.indexOf(this),r="";for(this.overrideName?-1!==["storein2","nameddo","nameddoArg","namedcalc","namedcalcArg"].indexOf(this.name)?getTextWidth(r=this.overrideName,"bold 20pt Sans")>TEXTWIDTH&&(r=" "+r.substr(0,STRINGLEN)+"..."):r=this.overrideName:0<this.protoblock.staticLabels.length&&!this.protoblock.image&&(r=this.protoblock.staticLabels[0]);this.protoblock.staticLabels.length<this.protoblock.args+1;)this.protoblock.staticLabels.push("");if(i){this.protoblock.scale=this.blocks.blockScale;var t=this.protoblock.generator();this.artwork=t[0];for(var e=0;e<t[1].length;e++)this.docks.push([t[1][e][0],t[1][e][1],this.protoblock.dockTypes[e]]);this.width=t[2],this.height=t[3],this.hitHeight=t[4]}if(this.protoblock.disabled)var s=this.artwork.replace(/fill_color/g,DISABLEDFILLCOLOR).replace(/stroke_color/g,DISABLEDSTROKECOLOR).replace("block_label",safeSVG(r));else s=this.artwork.replace(/fill_color/g,PALETTEFILLCOLORS[this.protoblock.palette.name]).replace(/stroke_color/g,PALETTESTROKECOLORS[this.protoblock.palette.name]).replace("block_label",safeSVG(r));for(e=1;e<this.protoblock.staticLabels.length;e++)s=s.replace("arg_label_"+e,this.protoblock.staticLabels[e]);_blockMakeBitmap(this.blocks.blockArt[this.blocks.blockList.indexOf(this)]=s,function(t,e){if(null!=e.bitmap&&e.container.removeChild(e.bitmap),e.bitmap=t,e.container.addChild(e.bitmap),e.bitmap.x=0,e.bitmap.y=0,e.bitmap.name="bmp_"+n,e.bitmap.cursor="pointer",e.blocks.refreshCanvas(),e.protoblock.disabled)var i=e.artwork.replace(/fill_color/g,DISABLEDFILLCOLOR).replace(/stroke_color/g,DISABLEDSTROKECOLOR).replace("block_label",safeSVG(r));else i=e.artwork.replace(/fill_color/g,platformColor.disconnected).replace(/stroke_color/g,HIGHLIGHTSTROKECOLORS[e.protoblock.palette.name]).replace("block_label",safeSVG(r));for(var s=1;s<e.protoblock.staticLabels.length;s++)i=i.replace("arg_label_"+s,e.protoblock.staticLabels[s]);_blockMakeBitmap(i,a,e)},this)},this._finishImageLoad=function(){this.blocks.blockList.indexOf(this);if(-1!==SPECIALINPUTS.indexOf(this.name)){if(null==this.value)switch(this.name){case"text":this.value="---";break;case"solfege":case"eastindiansolfege":this.value="sol";break;case"customNote":var t=this.blocks.logo.synth.startingPitch.length;this.value=this.blocks.logo.synth.startingPitch.substring(0,t-1)+"(+0)";break;case"notename":this.value="G";break;case"rest":this.value="rest";break;case"boolean":this.value=!0;break;case"number":this.value=NUMBERBLOCKDEFAULT;break;case"modename":this.value=DEFAULTMODE;break;case"accidentalname":this.value=DEFAULTACCIDENTAL;break;case"intervalname":this.value=DEFAULTINTERVAL;break;case"invertmode":this.value=DEFAULTINVERT;break;case"voicename":this.value=DEFAULTVOICE;break;case"noiseename":this.value=DEFAULTNOISE;break;case"drumname":this.value=DEFAULTDRUM;break;case"effectsname":this.value=DEFAULTEFFECT;break;case"filtertype":this.value=DEFAULTFILTERTYPE;break;case"oscillatortype":this.value=DEFAULTOSCILLATORTYPE;break;case"temperamentname":this.value="equal"}if("solfege"===this.name){var e=i18nSolfege((s=splitSolfege(this.value))[0]);""!==(i=s[1])&&(e+=i)}else if("eastindiansolfege"===this.name){var i,s=splitSolfege(this.value);e=WESTERN2EISOLFEGENAMES[s[0]];""!==(i=s[1])&&(e+=i)}else if(null!==this.value)e=this.value.toString();else e="???";-1===WIDENAMES.indexOf(this.name)&&getTextWidth(e,"bold 20pt Sans")>TEXTWIDTH&&(e=e.substr(0,STRINGLEN)+"..."),this.text.text=e,this.container.addChild(this.text),this._positionText(this.protoblock.scale)}else this.protoblock.parameter&&(this.container.addChild(this.text),this._positionText(this.protoblock.scale));if(this.isCollapsible()){var l;if(this.isInlineCollapsible())(l=new ProtoBlock("collapse-note")).scale=this.protoblock.scale,"interval"===this.name?l.extraWidth=80:l.extraWidth=40,l.zeroArgBlock();else(l=new ProtoBlock("collapse")).scale=this.protoblock.scale,l.extraWidth=40,l.basicBlockCollapsed();s=l.generator();this.collapseArtwork=s[0];this.isCollapsible()&&this._generateCollapseArtwork(function(t){t.loadComplete=!0,null!==t.postProcess&&(t.postProcess(t.postProcessArg),t.postProcess=null)})}else this.loadComplete=!0,null!==this.postProcess&&(this.postProcess(this.postProcessArg),this.postProcess=null),this.blocks.refreshCanvas(),this.blocks.cleanupAfterLoad(this.name)},this._generateCollapseArtwork=function(i){function l(t){var e=new Image;e.onload=function(){t.collapseButtonBitmap=new createjs.Bitmap(e),t.collapseButtonBitmap.scaleX=t.collapseButtonBitmap.scaleY=t.collapseButtonBitmap.scale=t.protoblock.scale/3,t.container.addChild(t.collapseButtonBitmap),t.collapseButtonBitmap.x=2*t.protoblock.scale,t.isInlineCollapsible()?t.collapseButtonBitmap.y=4*t.protoblock.scale:t.collapseButtonBitmap.y=10*t.protoblock.scale,t.collapseButtonBitmap.visible=!t.collapsed,function(t){null!==i&&i(t),t.blocks.refreshCanvas(),t.blocks.cleanupAfterLoad(t.name),t.trash&&(t.collapseText.visible=!1,t.collapseButtonBitmap.visible=!1,t.expandButtonBitmap.visible=!1)}(t)},e.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(COLLAPSEBUTTON)))}function s(t,e){if(e.highlightCollapseBlockBitmap=t,e.highlightCollapseBlockBitmap.name="highlight_collapse_"+o,e.container.addChild(e.highlightCollapseBlockBitmap),e.highlightCollapseBlockBitmap.visible=!1,null===e.collapseText){var i=10*e.protoblock.scale;switch(e.name){case"action":e.collapseText=new createjs.Text(_("action"),i+"px Sans",platformColor.blockText);break;case"start":e.collapseText=new createjs.Text(_("start"),i+"px Sans",platformColor.blockText);break;case"matrix":e.collapseText=new createjs.Text(_("matrix"),i+"px Sans",platformColor.blockText);break;case"status":e.collapseText=new createjs.Text(_("status"),i+"px Sans",platformColor.blockText);break;case"pitchdrummatrix":e.collapseText=new createjs.Text(_("drum mapper"),i+"px Sans",platformColor.blockText);break;case"rhythmruler":e.collapseText=new createjs.Text(_("ruler"),i+"px Sans",platformColor.blockText);break;case"timbre":e.collapseText=new createjs.Text(_("timbre"),i+"px Sans",platformColor.blockText);break;case"pitchstaircase":e.collapseText=new createjs.Text(_("stair"),i+"px Sans",platformColor.blockText);break;case"tempo":e.collapseText=new createjs.Text(_("tempo"),i+"px Sans",platformColor.blockText);break;case"modewidget":e.collapseText=new createjs.Text(_("mode"),i+"px Sans",platformColor.blockText);break;case"pitchslider":e.collapseText=new createjs.Text(_("slider"),i+"px Sans",platformColor.blockText);break;case"musickeyboard":e.collapseText=new createjs.Text(_("keyboard"),i+"px Sans",platformColor.blockText);break;case"drum":e.collapseText=new createjs.Text(_("drum"),i+"px Sans",platformColor.blockText);break;case"rhythmruler2":e.collapseText=new createjs.Text(_("rhythm maker"),i+"px Sans",platformColor.blockText);break;case"newnote":e.collapseText=new createjs.Text(_("note value"),i+"px Sans",platformColor.blockText);break;case"interval":e.collapseText=new createjs.Text(_("scalar interval"),i+"px Sans",platformColor.blockText);break;case"osctime":e.collapseText=new createjs.Text(_("milliseconds"),i+"px Sans",platformColor.blockText);break;case"temperament":e.collapseText=new createjs.Text(_("temperament"),i+"px Sans",platformColor.blockText);break;default:e.collapseText=new createjs.Text("foobar",i+"px Sans",platformColor.blockText)}e.collapseText.textAlign="left",e.collapseText.textBaseline="alphabetic",e.container.addChild(e.collapseText)}e._positionCollapseLabel(e.protoblock.scale),e.collapseText.visible=e.collapsed,e._ensureDecorationOnTop();var s=e.collapseArtwork.replace(/fill_color/g,PALETTEFILLCOLORS[e.protoblock.palette.name]).replace(/stroke_color/g,PALETTESTROKECOLORS[e.protoblock.palette.name]).replace("block_label",safeSVG(e.collapseText.text));e.blocks.blockCollapseArt[e.blocks.blockList.indexOf(e)]=s,function(t){var e=new Image;e.onload=function(){t.expandButtonBitmap=new createjs.Bitmap(e),t.expandButtonBitmap.scaleX=t.expandButtonBitmap.scaleY=t.expandButtonBitmap.scale=t.protoblock.scale/3,t.container.addChild(t.expandButtonBitmap),t.expandButtonBitmap.visible=t.collapsed,t.expandButtonBitmap.x=2*t.protoblock.scale,t.isInlineCollapsible()?t.expandButtonBitmap.y=4*t.protoblock.scale:t.expandButtonBitmap.y=10*t.protoblock.scale,l(t)},e.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(EXPANDBUTTON)))}(e)}var o=this.blocks.blockList.indexOf(this);_blockMakeBitmap(this.collapseArtwork.replace(/fill_color/g,PALETTEFILLCOLORS[this.protoblock.palette.name]).replace(/stroke_color/g,PALETTESTROKECOLORS[this.protoblock.palette.name]).replace("block_label",""),function(t,e){e.collapseBlockBitmap=t,e.collapseBlockBitmap.name="collapse_"+o,e.container.addChild(e.collapseBlockBitmap),e.collapseBlockBitmap.visible=e.collapsed,e.blocks.refreshCanvas(),_blockMakeBitmap(e.collapseArtwork.replace(/fill_color/g,PALETTEHIGHLIGHTCOLORS[e.protoblock.palette.name]).replace(/stroke_color/g,HIGHLIGHTSTROKECOLORS[e.protoblock.palette.name]).replace("block_label",""),s,e)},this)},this.hide=function(){this.container.visible=!1,this.isCollapsible()&&(this.collapseText.visible=!1,this.expandButtonBitmap.visible=!1,this.collapseButtonBitmap.visible=!1),this.updateCache(),this.blocks.refreshCanvas()},this.isDisconnected=function(){return null!==this.disconnectedBitmap&&(null===this.connections[0]&&((-1===COLLAPSIBLES.indexOf(this.name)||-1!==INLINECOLLAPSIBLES.indexOf(this.name))&&(!!this.isArgBlock()||(null===last(this.connections)||"hidden"===this.blocks.blockList[last(this.connections)].name&&null===last(this.blocks.blockList[last(this.connections)].connections)))))},this.show=function(){this.trash||this.inCollapsed||(this.container.visible=!0,this.isCollapsible()?this.collapsed?(this.bitmap.visible=!1,this.highlightBitmap.visible=!1,this.collapseBlockBitmap.visible=!0,this.highlightCollapseBlockBitmap.visible=!1,this.collapseText.visible=!0,this.expandButtonBitmap.visible=!0,this.collapseButtonBitmap.visible=!1,null!==this.disconnectedBitmap&&(this.disconnectedBitmap.visible=!1),null!==this.disconnectedHighlightBitmap&&(this.disconnectedHighlightBitmap.visible=!1)):(this.isDisconnected()?(this.disconnectedBitmap.visible=!0,this.bitmap.visible=!1):(null!==this.disconnectedBitmap&&(this.disconnectedBitmap.visible=!1),this.bitmap.visible=!0),this.highlightBitmap.visible=!1,null!==this.disconnectedHighlightBitmap&&(this.disconnectedHighlightBitmap.visible=!1),this.collapseBlockBitmap.visible=!1,this.highlightCollapseBlockBitmap.visible=!1,this.collapseText.visible=!1,this.expandButtonBitmap.visible=!1,this.collapseButtonBitmap.visible=!0):(this.isDisconnected()?(this.disconnectedBitmap.visible=!0,this.bitmap.visible=!1):(null!==this.disconnectedBitmap&&(this.disconnectedBitmap.visible=!1),this.bitmap.visible=!0),this.highlightBitmap.visible=!1,null!==this.disconnectedHighlightBitmap&&(this.disconnectedHighlightBitmap.visible=!1)),this.updateCache(),this.blocks.refreshCanvas())},this.isValueBlock=function(){return"value"===this.protoblock.style},this.isNoHitBlock=function(){return-1!==NOHIT.indexOf(this.name)},this.isArgBlock=function(){return"value"===this.protoblock.style||"arg"===this.protoblock.style},this.isTwoArgBlock=function(){return"twoarg"===this.protoblock.style},this.isTwoArgBooleanBlock=function(){return-1!==["equal","greater","less"].indexOf(this.name)},this.isClampBlock=function(){return"clamp"===this.protoblock.style||this.isDoubleClampBlock()||this.isArgFlowClampBlock()},this.isArgFlowClampBlock=function(){return"argflowclamp"===this.protoblock.style},this.isDoubleClampBlock=function(){return"doubleclamp"===this.protoblock.style},this.isNoRunBlock=function(){return"action"===this.name},this.isArgClamp=function(){return"argclamp"===this.protoblock.style||"argclamparg"===this.protoblock.style},this.isExpandableBlock=function(){return this.protoblock.expandable},this.getBlockId=function(){return"_"+blockBlocks.blockList.indexOf(this).toString()},this.removeChildBitmap=function(t){for(var e=0;e<this.container.children.length;e++)if(this.container.children[e].name===t){this.container.removeChild(this.container.children[e]);break}},this.loadThumbnail=function(t){var e=this.blocks.blockList.indexOf(this),s=this;if(null!==this.blocks.blockList[e].value||null!==t){var l=new Image;l.onload=function(){s.removeChildBitmap("media");var t=new createjs.Bitmap(l);t.name="media";var e=new createjs.Container;e.addChild(t);l.width>l.height?600<l.width&&(t.scaleX=t.scaleY=t.scale=600/l.width):450<l.height&&(t.scaleX=t.scaleY=t.scale=450/l.height);var i=e.getBounds();e.cache(i.x,i.y,i.width,i.height),s.value=e.bitmapCache.getCacheDataURL(),s.imageBitmap=t,s._positionMedia(t,t.image.width,t.image.height,s.protoblock.scale),s.container.addChild(t),s.updateCache()},l.src=null===t?this.value:t}},this._doOpenMedia=function(s){var l=docById("myOpenAll"),o=this;l.addEventListener("change",function t(e){window.scroll(0,0);var i=new FileReader;i.onloadend=function(){if(i.result){if("media"===o.name)return o.value=i.result,void o.loadThumbnail(null);o.value=[l.files[0].name,i.result],o.blocks.updateBlockText(s)}},"media"===o.name?i.readAsDataURL(l.files[0]):i.readAsText(l.files[0]),l.removeEventListener("change",t)},!1),l.focus(),l.click(),window.scroll(0,0)},this.setCollapsedState=function(){this.inCollapsed=!0,this.hide()},this.setUncollapsedState=function(t){null===t?(this.inCollapsed=!1,this.show()):this.blocks.blockList[t].collapsed||(this.inCollapsed=!1,this.show())},this.collapseToggle=function(){var t=this.blocks.blockList.indexOf(this);if(this.blocks.findDragGroup(t),null!==this.collapseBlockBitmap){var e=this.collapsed;if(this.collapsed=!e,this.collapseButtonBitmap.visible=e,this.expandButtonBitmap.visible=!e,this.collapseBlockBitmap.visible=!e,this.highlightCollapseBlockBitmap.visible=!1,this.collapseText.visible=!e,this.isInlineCollapsible()&&this.collapseText.visible)switch(this.name){case"newnote":this._newNoteLabel();break;case"interval":this._intervalLabel();break;case"osctime":this._oscTimeLabel();break;default:console.log("What do we do with a collapsed "+this.name+" block?")}if(this.bitmap.visible=this.collapsed,this.highlightBitmap.visible=!1,null!==this.disconnectedBitmap&&(this.disconnectedBitmap.visible=!1),null!==this.disconnectedHighlightBitmap&&(this.disconnectedHighlightBitmap.visible=!1),this.updateCache(),"action"===this.name)if(null!==this.connections[1]){var i=this.blocks.blockList[this.connections[1]].value;getTextWidth(i,"bold 20pt Sans")>TEXTWIDTH&&(i=i.substr(0,STRINGLEN)+"..."),this.collapseText.text=i}else this.collapseText.text="";var s=this.container.children.length-1;if(this.container.setChildIndex(this.collapseText,s),this.isInlineCollapsible())this._toggle_inline(t,e);else if(0<this.blocks.dragGroup.length)for(var l=1;l<this.blocks.dragGroup.length;l++){var o=this.blocks.dragGroup[l];this.collapsed?this.blocks.blockList[o].setCollapsedState():this.blocks.blockList[o].setUncollapsedState(this.blocks.insideInlineCollapsibleBlock(o))}this.updateCache(),this.unhighlight(),this.blocks.refreshCanvas()}else console.log("collapse bitmap not ready")},this._intervalLabel=function(){for(var t=DEGREES.split(" "),e={},i=0;i<t.length;i++)e[i]=t[i];for(var s=[],l=(i=0,this.blocks.blockList.indexOf(this));null!==l;){var o=l,a=this.blocks.blockList[l].connections[1],n=this.blocks.blockList[a];if("number"===n.name?Math.abs(n.value)in e?n.value<0?s.push("-"+e[-n.value]):s.push("+"+e[n.value]):n.value<0?s.push("-"+n.value):s.push("+"+n.value):s.push(""),5<(i+=1)){console.log("loop?");break}l=this.blocks.findNestedIntervalBlock(this.blocks.blockList[l].connections[2])}var r="";for(i=s.length;0<i;i--)r+=" "+s[i-1];var c="",h=this.blocks.findNoteBlock(o);if(null===h)this.collapseText.text=_("scalar interval")+r;else{if(null!==(l=this.blocks.blockList[h].connections[1])&&"divide"===this.blocks.blockList[l].name){var u=this.blocks.blockList[l].connections[1],d=this.blocks.blockList[l].connections[2];"number"===this.blocks.blockList[u].name&&"number"===this.blocks.blockList[d].name&&(c=this.blocks.blockList[u].value+"/"+this.blocks.blockList[d].value,_THIS_IS_MUSIC_BLOCKS_&&this.blocks.blockList[d].value in NSYMBOLS&&(c+=NSYMBOLS[this.blocks.blockList[d].value]))}l=this.blocks.findFirstPitchBlock(this.blocks.blockList[h].connections[2]);var f=this._getPitch(l);null===l||""===f?this.collapseText.text=_("scalar interval")+r:(l=this.blocks.findFirstPitchBlock(last(this.blocks.blockList[l].connections)),this.collapseText.text=null===l?f+" | "+c+r:f+"... | "+c+r)}},this._newNoteLabel=function(){var t="",e=this.connections[1],i=null;if(null!==e&&"divide"===this.blocks.blockList[e].name){var s=this.blocks.blockList[e].connections[1],l=this.blocks.blockList[e].connections[2];"number"===this.blocks.blockList[s].name&&"number"===this.blocks.blockList[l].name&&(t=this.blocks.blockList[s].value+"/"+this.blocks.blockList[l].value,_THIS_IS_MUSIC_BLOCKS_&&(i=this.blocks.blockList[l].value)in NSYMBOLS&&(t+=NSYMBOLS[i]))}e=this.connections[2],e=this.blocks.findFirstPitchBlock(e);var o=this._getPitch(e);null===e?(_THIS_IS_MUSIC_BLOCKS_&&null!==i&&i in NSYMBOLS&&(t=t.replace(NSYMBOLS[i],RSYMBOLS[i])),this.collapseText.text=_("silence")+" | "+t):""===o&&""===t?this.collapseText.text=_("note value"):(_THIS_IS_MUSIC_BLOCKS_&&o===_("silence")&&null!==i&&i in NSYMBOLS&&(t=t.replace(NSYMBOLS[i],RSYMBOLS[i])),e=this.blocks.findFirstPitchBlock(last(this.blocks.blockList[e].connections)),this.collapseText.text=null===e?o+" | "+t:o+"... | "+t)},this._oscTimeLabel=function(){var t="",e=this.connections[1];if(null!==e&&"divide"===this.blocks.blockList[e].name){var i=this.blocks.blockList[e].connections[1],s=this.blocks.blockList[e].connections[2];if(null!==i&&null!==s&&"divide"===this.blocks.blockList[s].name){var l=this.blocks.blockList[s].connections[1],o=this.blocks.blockList[s].connections[2];null!==l&&null!==o&&"number"===this.blocks.blockList[l].name&&"number"===this.blocks.blockList[o].name&&(t=this.blocks.blockList[i].value/this.blocks.blockList[l].value*this.blocks.blockList[o].value)}}e=this.connections[2],e=this.blocks.findFirstPitchBlock(e);var a=this._getPitch(e);null===e?this.collapseText.text=_("silence")+" | "+t:""===a&&""===t?this.collapseText.text=_("note value"):(e=this.blocks.findFirstPitchBlock(last(this.blocks.blockList[e].connections)),this.collapseText.text=""!==t?null===e?a+" | "+t.toFixed(0):a+"... | "+t.toFixed(0):a+"...")},this._getPitch=function(t){if(null===t)return"";switch(this.blocks.blockList[t].name){case"pitch":var e=this.blocks.blockList[t].connections[1],i=this.blocks.blockList[t].connections[2];if("number"===this.blocks.blockList[i].name){if("solfege"===this.blocks.blockList[e].name){var s=_("ti la sol fa mi re do").split(" "),l=this.blocks.blockList[e].value.replace(SHARP,"").replace(FLAT,"").replace(DOUBLESHARP,"").replace(DOUBLEFLAT,""),o=["ti","la","sol","fa","mi","re","do"].indexOf(l);return-1!==this.blocks.blockList[e].value.indexOf(SHARP)?s[o]+SHARP+" "+this.blocks.blockList[i].value:-1!==this.blocks.blockList[e].value.indexOf(FLAT)?s[o]+FLAT+" "+this.blocks.blockList[i].value:-1!==this.blocks.blockList[e].value.indexOf(DOUBLESHARP)?s[o]+DOUBLESHARP+" "+this.blocks.blockList[i].value:-1!==this.blocks.blockList[e].value.indexOf(DOUBLEFLAT)?s[o]+DOUBLEFLAT+" "+this.blocks.blockList[i].value:s[o]+" "+this.blocks.blockList[i].value}if("notename"===this.blocks.blockList[e].name)return this.blocks.blockList[e].value+" "+this.blocks.blockList[i].value}break;case"scaledegree":e=this.blocks.blockList[t].connections[1],i=this.blocks.blockList[t].connections[2];if("number"!==this.blocks.blockList[i].name||"number"!==this.blocks.blockList[e].name)break;var a=DEGREES.split(" ");return 0<(o=this.blocks.blockList[e].value-1)&&o<a.length?a[o]+" "+this.blocks.blockList[i].value:this.blocks.blockList[e].value+" "+this.blocks.blockList[i].value;case"hertz":e=this.blocks.blockList[t].connections[1];if("number"===this.blocks.blockList[e].name)return this.blocks.blockList[e].value+"HZ";break;case"steppitch":e=this.blocks.blockList[t].connections[1];return"number"===this.blocks.blockList[e].name&&this.blocks.blockList[e].value<0?_("down")+" "+Math.abs(this.blocks.blockList[e].value):_("up")+" "+this.blocks.blockList[e].value;case"pitchnumber":e=this.blocks.blockList[t].connections[1];if("number"===this.blocks.blockList[e].name)return _("pitch")+" "+this.blocks.blockList[e].value;break;case"playdrum":return _("drum");case"rest2":return _("silence");default:return""}},this._toggle_inline=function(t,e){if(null!==this.connections[1]){this.blocks.findDragGroup(this.connections[1]);for(var i=0;i<this.blocks.dragGroup.length;i++){var s=this.blocks.dragGroup[i];this.blocks.blockList[s].container.visible=e,this.blocks.blockList[s].inCollapsed=!e}}if(null!==this.connections[2]){this.blocks.findDragGroup(this.connections[2]);for(i=0;i<this.blocks.dragGroup.length;i++){s=this.blocks.dragGroup[i];var l=this.blocks.insideInlineCollapsibleBlock(s);null!==l&&this.blocks.blockList[l].collapsed?(this.blocks.blockList[s].container.visible=!1,this.blocks.blockList[s].inCollapsed=!0):(this.blocks.blockList[s].container.visible=e,this.blocks.blockList[s].inCollapsed=!e)}}if(null!=this.connections[3]){var o=this.docks.length;if(e)var a=this.blocks.blockList[t].docks[o-1][1]-this.blocks.blockList[t].docks[o-2][1];else a=this.blocks.blockList[t].docks[o-2][1]-this.blocks.blockList[t].docks[o-1][1];this.blocks.findDragGroup(this.connections[3]);for(i=0;i<this.blocks.dragGroup.length;i++){s=this.blocks.dragGroup[i];this.blocks.moveBlockRelative(s,0,a)}this.blocks.adjustDocks(t,!0)}clampList=[],this.blocks.findNestedClampBlocks(t,clampList),0<clampList.length&&(this.blocks.clampBlocksToCheck=clampList,this.blocks.adjustExpandableClampBlock()),this.blocks.refreshCanvas()},this._positionText=function(t){this.text.textBaseline="alphabetic",this.text.textAlign="right";var e=10*t;if(this.text.font=e+"px Sans",this.text.x=Math.floor(TEXTX*t/2+.5),this.text.y=Math.floor(TEXTY*t/2+.5),-1!==SPECIALINPUTS.indexOf(this.name))this.text.textAlign="center",this.text.x=Math.floor(VALUETEXTX*t/2+.5),-1!==EXTRAWIDENAMES.indexOf(this.name)?this.text.x*=3:-1!==WIDENAMES.indexOf(this.name)?this.text.x=Math.floor(1.75*this.text.x+.5):"text"===this.name&&(this.text.x=Math.floor(this.width/2+.5));else if("nameddo"===this.name)this.text.textAlign="center",this.text.x=Math.floor(this.width/2+.5);else if(0===this.protoblock.args){this.container.getBounds();this.text.x=Math.floor(this.width-25+.5)}else this.isCollapsible()?this.text.x+=Math.floor(15*t):(this.text.textAlign="left","booleanout"===this.docks[0][2]&&(this.text.y=Math.floor(this.docks[0][1]+.5)));z=this.container.children.length-1,this.container.setChildIndex(this.text,z),this.updateCache()},this._positionMedia=function(t,e,i,s){t.scaleX=t.scaleY=t.scale=i<e?MEDIASAFEAREA[2]/e*s/2:MEDIASAFEAREA[3]/i*s/2,t.x=(MEDIASAFEAREA[0]-10)*s/2,t.y=MEDIASAFEAREA[1]*s/2},this._positionCollapseLabel=function(t){this.isInlineCollapsible()?(this.collapseText.x=Math.floor((COLLAPSETEXTX+STANDARDBLOCKHEIGHT)*t/2+.5),this.collapseText.y=Math.floor((COLLAPSETEXTY-8)*t/2+.5)):(this.collapseText.x=Math.floor((COLLAPSETEXTX+30)*t/2+.5),this.collapseText.y=Math.floor(COLLAPSETEXTY*t/2+.5)),z=this.container.children.length-1,this.container.setChildIndex(this.collapseText,z)},this._calculateBlockHitArea=function(){var t=new createjs.Shape;t.graphics.beginFill("platformColor.hitAreaGraphicsBeginFill").drawRect(0,0,this.width,this.hitHeight),this.container.hitArea=t},this._loadEventHandlers=function(){var c=this,h=this.blocks.blockList.indexOf(this);this._calculateBlockHitArea(),this.container.on("mouseover",function(t){docById("contextWheelDiv").style.display="none",c.blocks.logo.runningLilypond||(document.body.style.cursor="pointer"),c.blocks.highlight(h,!0),c.blocks.activeBlock=h,c.blocks.refreshCanvas()});var i=!1,u=!1,s=!1,d=window.hasMouse;this.container.on("click",function(t){if("nativeEvent"in t){if("button"in t.nativeEvent&&2==t.nativeEvent.button)return c.blocks.stageClick=!0,console.log("loading context menu"),docById("wheelDiv").style.display="none",void c.piemenuBlockContext(h);if("ctrlKey"in t.nativeEvent&&t.nativeEvent.ctrlKey)return void c.piemenuBlockContext(h);if("shiftKey"in t.nativeEvent&&t.nativeEvent.shiftKey)return void(c.blocks.turtles.running()?(c.blocks.logo.doStopTurtle(),setTimeout(function(){c.blocks.logo.runLogoCommands(e)},250)):c.blocks.logo.runLogoCommands(e))}if(!c.blocks.getLongPressStatus()&&(c.blocks.activeBlock=h,i=!0,!s))if(s=!0,setTimeout(function(){s=!1},500),hideDOMLabel(),dx=t.stageX/c.blocks.getStageScale()-c.container.x,!u&&c.isCollapsible()&&dx<30/c.blocks.getStageScale())c.collapseToggle();else if(!window.hasMouse&&d||window.hasMouse&&!u){if("media"===c.name)c._doOpenMedia(h);else if("loadFile"===c.name)c._doOpenMedia(h);else if(-1!==SPECIALINPUTS.indexOf(c.name))c.trash||(c._triggerLongPress?c._triggerLongPress=!1:c._changeLabel());else if(!c.blocks.getLongPressStatus()&&!c.blocks.stageClick){var e=c.blocks.findTopBlock(h);console.log("running from "+c.blocks.blockList[e].name),_THIS_IS_MUSIC_BLOCKS_&&c.blocks.logo.synth.resume(),c.blocks.turtles.running()?(c.blocks.logo.doStopTurtle(),setTimeout(function(){c.blocks.logo.runLogoCommands(e)},250)):c.blocks.logo.runLogoCommands(e)}}else if(!u&&!c.blocks.getLongPressStatus()&&!c.blocks.stageClick){e=c.blocks.findTopBlock(h);console.log("running from "+c.blocks.blockList[e].name),_THIS_IS_MUSIC_BLOCKS_&&c.blocks.logo.synth.resume(),c.blocks.turtles.running()?(c.blocks.logo.doStopTurtle(),setTimeout(function(){c.blocks.logo.runLogoCommands(e)},250)):c.blocks.logo.runLogoCommands(e)}}),this.container.on("mousedown",function(t){docById("contextWheelDiv").style.display="none";var e=new Date;c.blocks.mouseDownTime=e.getTime(),c.blocks.longPressTimeout=setTimeout(function(){c.blocks.activeBlock=c.blocks.blockList.indexOf(c),c._triggerLongPress=!0,c.blocks.triggerLongPress()},LONGPRESSTIME),trashcan.show(),c.blocks.raiseStackToTop(h),null!=c.collapseContainer&&c.blocks.stage.setChildIndex(c.collapseContainer,c.blocks.stage.children.length-1),u=!1,c.original={x:t.stageX/c.blocks.getStageScale(),y:t.stageY/c.blocks.getStageScale()},c.offset={x:Math.round(c.container.x-c.original.x),y:Math.round(c.container.y-c.original.y)}}),this.container.on("pressmove",function(t){if(t.nativeEvent.preventDefault(),"rest2"!==c.name){window.hasMouse?u=!0:setTimeout(function(){u=20<Math.abs(t.stageX/c.blocks.getStageScale()-c.original.x)+Math.abs(t.stageY/c.blocks.getStageScale()-c.original.y)&&!window.hasMouse,d=!u},200);var e=c.container.x,i=c.container.y,s=Math.round(t.stageX/c.blocks.getStageScale()+c.offset.x-e),l=Math.round(t.stageY/c.blocks.getStageScale()+c.offset.y-i),o=i+l;if(0===c.blocks.stage.y&&o<45&&(l+=45-o),null!=c.blocks.longPressTimeout&&(clearTimeout(c.blocks.longPressTimeout),c.blocks.longPressTimeout=null,c.blocks.clearLongPress()),u||null==c.label||(c.label.style.display="none"),c.blocks.moveBlockRelative(h,s,l),trashcan.overTrashcan(t.stageX/c.blocks.getStageScale(),t.stageY/c.blocks.getStageScale())?trashcan.startHighlightAnimation():trashcan.stopHighlightAnimation(),c.isValueBlock()&&"media"!==c.name){var a=c.container.children.length-1;c.container.setChildIndex(c.text,a)}if(c.blocks.findDragGroup(h),0<c.blocks.dragGroup.length)for(var n=0;n<c.blocks.dragGroup.length;n++){var r=c.blocks.dragGroup[n];0!==n&&c.blocks.moveBlockRelative(r,s,l)}c.blocks.refreshCanvas()}}),this.container.on("mouseout",function(t){c.blocks.getLongPressStatus()?(clearTimeout(c.blocks.longPressTimeout),c.blocks.longPressTimeout=null,c.blocks.clearLongPress()):c._mouseoutCallback(t,u,i,!1),c.blocks.unhighlight(h,!0),c.blocks.activeBlock=null,u=!1}),this.container.on("pressup",function(t){c.blocks.getLongPressStatus()?(clearTimeout(c.blocks.longPressTimeout),c.blocks.longPressTimeout=null,c.blocks.clearLongPress()):c._mouseoutCallback(t,u,i,!1),c.blocks.unhighlight(h,!0),c.blocks.activeBlock=null,u=!1})},this._mouseoutCallback=function(t,e,i,s){var l=this.blocks.blockList.indexOf(this);if(this.blocks.logo.runningLilypond||(document.body.style.cursor="default"),trashcan.hide(),null!=this.blocks.longPressTimeout&&(clearTimeout(this.blocks.longPressTimeout),this.blocks.longPressTimeout=null,this.blocks.clearLongPress()),e)if(trashcan.overTrashcan(t.stageX/this.blocks.getStageScale(),t.stageY/this.blocks.getStageScale()))trashcan.isVisible&&this.blocks.sendStackToTrash(this);else{var o=new Date;this.blocks.mouseDownTime=o.getTime(),this.blocks.blockMoved(l),this.blocks.adjustDocks(this.blocks.blockList.indexOf(this),!0)}else if(-1!==SPECIALINPUTS.indexOf(this.name)||-1!==["media","loadFile"].indexOf(this.name)){if(!i)if((o=new Date).getTime()-this.blocks.mouseDownTime<500&&!this.trash){o=new Date;this.blocks.mouseDownTime=o.getTime(),"media"===this.name||"loadFile"===this.name?this._doOpenMedia(l):this._changeLabel()}}s&&((t.stageX/this.blocks.getStageScale()<this.container.x||t.stageX/this.blocks.getStageScale()>this.container.x+this.width||t.stageY<this.container.y||t.stageY>this.container.y+this.hitHeight)&&(this._usePiemenu()||(this._labelChanged(!0,!0),hideDOMLabel()),this.blocks.unhighlight(null),this.blocks.refreshCanvas()),this.blocks.activeBlock=null)},this._usePiemenu=function(){if(this._check_meter_block=null,-1!==PIEMENUS.indexOf(this.name))return!0;var t=this.blocks.blockList.indexOf(this);return!!this.blocks.octaveNumber(t)||(!!this.blocks.noteValueNumber(t,2)||(!!this.blocks.noteValueNumber(t,1)||(!!this.blocks.octaveModifierNumber(t)||(!!this.blocks.intervalModifierNumber(t)||(!!this._usePieNumberC3()||(!!this._usePieNumberC2()||!!this._usePieNumberC1()))))))},this._usePieNumberC1=function(){var t=this.connections[0];if(null===t)return!1;if(-1===["steppitch","pitchnumber","meter","register","scaledegree","rhythmicdot2","crescendo","decrescendo","harmonic2","interval","setscalartransposition","semitoneinterval","settransposition","setnotevolume","articulation","vibrato","dis","neighbor","neighbor2","tremolo","chorus","phaser","amsynth","fmsynth","duosynth","rhythm2","stuplet","duplicatenotes","setcolor","setshade","setgrey","sethue","setpensize","settranslucency","setheading","arc","onbeatdo"].indexOf(this.blocks.blockList[this.connections[0]].name))return!1;var e=this.blocks.blockList.indexOf(this);return this.blocks.blockList[t].connections[1]===e},this._usePieNumberC2=function(){var t=this.connections[0];if(null===t)return!1;if(-1===["setsynthvolume","tremolo","chorus","phaser","duosynth","arc"].indexOf(this.blocks.blockList[t].name))return!1;var e=this.blocks.blockList.indexOf(this);return this.blocks.blockList[t].connections[2]===e},this._usePieNumberC3=function(){var t=this.connections[0];if(null===t)return!1;if(-1===["chorus"].indexOf(this.blocks.blockList[t].name))return!1;var e=this.blocks.blockList.indexOf(this);return this.blocks.blockList[t].connections[3]===e},this._ensureDecorationOnTop=function(){for(var t=0;t<this.container.children.length;t++)if("decoration"===this.container.children[t].name){var e=0;if("drum"===this.name&&this.collapsed)e=25*this.protoblock.scale/2;for(var i=0;i<this.blocks.turtles.turtleList.length;i++)if(this.blocks.turtles.turtleList[i].startBlock===this){this.blocks.turtles.turtleList[i].decorationBitmap.x=this.width-e-30*this.protoblock.scale/2;break}this.container.setChildIndex(this.container.children[t],this.container.children.length-1);break}this.container.setChildIndex(this.bitmap,0),this.container.setChildIndex(this.highlightBitmap,0),null!==this.disconnectedBitmap&&this.container.setChildIndex(this.disconnectedBitmap,0),this.updateCache()},this._changeLabel=function(){var e=this,t=this.container.x,i=this.container.y,s=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,l=this.blocks.canvas.offsetTop+6*this.blocks.blockScale,o=!1;if(!window.hasMouse&&75<this.blocks.stage.y+i){o=!0;var a=this.blocks.stage.y;this.blocks.stage.y=75-i}if(null!=this.label)var n=this.label.value;else n=this.value;var r=docById("labelDiv");if("text"===this.name)r.innerHTML='<input id="textLabel" style="position: absolute; -webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="text" type="text" value="'+n+'" />',r.classList.add("hasKeyboard"),this.label=docById("textLabel");else if("solfege"===this.name){var c=splitSolfege(this.value),h=_("ti la sol fa mi re do").split(" ");this.piemenuOKtoLaunch()&&this._piemenuPitches(h,SOLFNOTES,SOLFATTRS,c[0],c[1])}else if("customNote"===this.name)if(this.blocks.logo.customTemperamentDefined){if(null!=this.value)this.value;else TEMPERAMENT.custom[0][1];var u=[],d=[];for(var f in TEMPERAMENT.custom)"pitchNumber"!==f&&(u.push(TEMPERAMENT.custom[f][1]),d.push(TEMPERAMENT.custom[f][1]));this._piemenuPitches(u,d,"",p,"",!0)}else{c=splitSolfege(this.value),h=_("ti la sol fa mi re do").split(" ");this.piemenuOKtoLaunch()&&this._piemenuPitches(h,SOLFNOTES,SOLFATTRS,c[0],c[1])}else if("eastindiansolfege"===this.name){var p=(c=splitSolfege(this.value))[0],b=c[1];this.piemenuOKtoLaunch()&&this._piemenuPitches(EASTINDIANSOLFNOTES,SOLFNOTES,SOLFATTRS,c[0],c[1])}else if("notename"===this.name){var m=["B","A","G","F","E","D","C"];if(null!=this.value){p=this.value[0];if(1===this.value.length)b="";else if(2===this.value.length)b=this.value[1];else b=this.value[1]+this.value[2]}else p="G",b="";""===b&&(b=""),this.piemenuOKtoLaunch()&&this._piemenuPitches(m,m,SOLFATTRS,p,b)}else if("modename"===this.name){if(null!=this.value)var g=this.value;else g=DEFAULTMODE;this._piemenuModes(g)}else if("accidentalname"===this.name){if(null!=this.value)var k=this.value;else k=DEFAULTACCIDENTAL;this.piemenuOKtoLaunch()&&this._piemenuAccidentals(ACCIDENTALLABELS,ACCIDENTALNAMES,k)}else if("intervalname"===this.name){if(null!=this.value)var v=this.value;else v=DEFAULTINTERVAL;this.piemenuOKtoLaunch()&&this._piemenuIntervals(v)}else if("invertmode"===this.name){if(null!=this.value)var y=this.value;else y=DEFAULTINVERT;for(var T=[],L=[],w=0;w<INVERTMODES.length;w++)T.push(_(INVERTMODES[w][1])),L.push(INVERTMODES[w][1]);this.piemenuOKtoLaunch()&&this._piemenuBasic(T,L,y)}else if("drumname"===this.name){if(null!=this.value)var B=this.value;else B=DEFAULTDRUM;var x=[],S=[],C=[],A=[];for(w=0;w<DRUMNAMES.length;w++){if(-1===EFFECTSNAMES.indexOf(DRUMNAMES[w][1]))400<getTextWidth(q=_(DRUMNAMES[w][1]),"bold 30pt Sans")?x.push(q.substr(0,8)+"..."):x.push(q),S.push(DRUMNAMES[w][1]),-1===A.indexOf(DRUMNAMES[w][4])&&A.push(DRUMNAMES[w][4]),C.push(A.indexOf(DRUMNAMES[w][4]))}this._piemenuVoices(x,S,C,B)}else if("effectsname"===this.name){if(null!=this.value)B=this.value;else var N=DEFAULTEFFECT;var P=[],I=[],M=[],E=[];for(w=0;w<DRUMNAMES.length;w++){if(-1!==EFFECTSNAMES.indexOf(DRUMNAMES[w][1]))400<getTextWidth(q=_(DRUMNAMES[w][1]),"Bold 30pt Sans")?P.push(q.substr(0,8)+"..."):P.push(q),I.push(DRUMNAMES[w][1]),-1===E.indexOf(DRUMNAMES[w][4])&&E.push(DRUMNAMES[w][4]),M.push(E.indexOf(DRUMNAMES[w][4]))}this._piemenuVoices(P,I,M,N)}else if("filtertype"===this.name){if(null!=this.value)var O=this.value;else O=DEFAULTFILTERTYPE;var D=[],R=[];for(w=0;w<FILTERTYPES.length;w++)D.push(_(FILTERTYPES[w][0])),R.push(FILTERTYPES[w][1]);this._piemenuBasic(D,R,O,platformColor.piemenuBasic)}else if("oscillatortype"===this.name){if(null!=this.value)O=this.value;else O=DEFAULTOSCILLATORTYPE;var W=[],H=[];for(w=0;w<OSCTYPES.length;w++)W.push(_(OSCTYPES[w][1])),H.push(OSCTYPES[w][1]);this._piemenuBasic(W,H,O,platformColor.piemenuBasic)}else if("voicename"===this.name){if(null!=this.value)var F=this.value;else F=DEFAULTVOICE;console.log(this.value+" "+DEFAULTVOICE+" "+F);var j=[],V=[];for(C=[],A=[],w=0;w<VOICENAMES.length;w++){if(!beginnerMode||"custom"!==VOICENAMES[w][1])400<getTextWidth(q=_(VOICENAMES[w][1]),"bold 30pt Sans")?j.push(q.substr(0,8)+"..."):j.push(q),V.push(VOICENAMES[w][1]),-1===A.indexOf(VOICENAMES[w][3])&&A.push(VOICENAMES[w][3]),C.push(A.indexOf(VOICENAMES[w][3]))}this._piemenuVoices(j,V,C,F)}else if("noisename"===this.name){if(null!=this.value)this.value;else var U=DEFAULTNOISE;console.log(this.value+" "+DEFAULTNOISE+" "+U);var G=[],z=[];for(C=[],A=[],w=0;w<NOISENAMES.length;w++){var q;600<getTextWidth(q=NOISENAMES[w][0],"bold 30pt Sans")?G.push(q.substr(0,16)+"..."):G.push(q),z.push(NOISENAMES[w][1]),-1===A.indexOf(NOISENAMES[w][3])&&A.push(NOISENAMES[w][3]),C.push(A.indexOf(NOISENAMES[w][3]))}this._piemenuVoices(G,z,C,U,90)}else if("temperamentname"===this.name){if(null!=this.value)var Y=this.value;else Y=DEFAULTTEMPERAMENT;var X=[],K=[];for(w=0;w<TEMPERAMENTS.length;w++)beginnerMode&&"custom"===TEMPERAMENTS[w][1]||(0===TEMPERAMENTS[w][0].length?X.push(TEMPERAMENTS[w][2]):X.push(TEMPERAMENTS[w][0]),K.push(TEMPERAMENTS[w][1]));this._piemenuBasic(X,K,Y,platformColor.piemenuBasic)}else if("boolean"===this.name){if(null!=this.value)var Q=this.value;else Q=!0;var Z=[_("true"),_("false")];this._piemenuBoolean(Z,[!0,!1],Q)}else{var J=this.blocks.blockList.indexOf(this);if(this.blocks.octaveNumber(J))this._piemenuNumber([8,7,6,5,4,3,2,1],this.value);else if(this.blocks.noteValueNumber(J,2)){null!==($=this.connections[0])&&null!==($=this.blocks.blockList[$].connections[0])&&-1!==["rhythm2","stuplet"].indexOf(this.blocks.blockList[$].name)?this._piemenuNumber([2,4,8,16],this.value):this._piemenuNoteValue(this.value)}else if(this.blocks.noteValueNumber(J,1)){var $,tt=this.blocks.noteValueValue(J);if(1===tt)var et=[8,7,6,5,4,3,2,1];else for(et=[],w=0;w<Math.min(tt,16);w++)et.push(w+1);if(null!==($=this.connections[0])&&null!==($=this.blocks.blockList[$].connections[0])&&-1!==["neighbor","neighbor2","rhythm2","stuplet"].indexOf(this.blocks.blockList[$].name))et=[3,2,1];this._piemenuNumber(et,this.value)}else if(this.blocks.octaveModifierNumber(J))this._piemenuNumber([-2,-1,0,1,2],this.value);else if(this.blocks.intervalModifierNumber(J)){switch(this.blocks.blockList[this.blocks.blockList[this.connections[0]].connections[0]].name){case"interval":case"setscalartransposition":this._piemenuNumber([-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7],this.value);break;case"semitoneinterval":case"settransposition":this._piemenuNumber([-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12],this.value)}}else if(this._usePieNumberC3())switch(this.blocks.blockList[this.connections[0]].name){case"chorus":this._piemenuNumber([0,10,20,30,40,50,60,70,80,90,100],this.value)}else if(this._usePieNumberC2())switch(this.blocks.blockList[this.connections[0]].name){case"duosynth":this._piemenuNumber([10,20,30,40,50,60,70,80,90,100],this.value);break;case"setsynthvolume":case"tremolo":this._piemenuNumber([0,10,20,30,40,50,60,70,80,90,100],this.value);break;case"chorus":this._piemenuNumber([2,2.5,3,3.5,4,4.5,5,6,7,8,9,10],this.value);break;case"phaser":this._piemenuNumber([1,2,3],this.value);break;case"arc":this._piemenuNumber([25,50,75,100,125,150,175,200,225,250,275,300],this.value)}else if(this._usePieNumberC1())switch(this.blocks.blockList[this.connections[0]].name){case"setpensize":this._piemenuNumber([1,2,3,5,10,15,25,50,100],this.value);break;case"setcolor":case"sethue":this._piemenuColor([0,10,20,30,40,50,60,70,80,90],this.value,this.blocks.blockList[this.connections[0]].name);break;case"setshade":case"settranslucency":case"setgrey":this._piemenuColor([100,90,80,70,60,50,40,30,20,10,0],this.value,this.blocks.blockList[this.connections[0]].name);break;case"duplicatenotes":this._piemenuNumber([2,3,4,5,6,7,8],this.value);break;case"setheading":this._piemenuNumber([0,30,45,60,90,120,135,150,180,210,225,240,270,300,315,330],this.value);break;case"rhythm2":this._piemenuNumber([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],this.value);break;case"stuplet":this._piemenuNumber([3,5,7,11],this.value);break;case"amsynth":this._piemenuNumber([1,2],this.value);break;case"fmsynth":this._piemenuNumber([1,5,10,15,20,25],this.value);break;case"chorus":this._piemenuNumber([.5,1,1.5,2,2.5,3,3.5,4,4.5,5],this.value);break;case"phaser":case"tremolo":this._piemenuNumber([.5,1,1.5,2,2.5,3,3.5,4,4.5,5,10,20],this.value);break;case"arc":this._piemenuNumber([15,30,45,60,75,90,105,120,135,150,165,180,195,210,225,240,255,270,285,300,315,330,345,360],this.value);break;case"rhythmicdot2":this._piemenuNumber([1,2,3],this.value);break;case"register":this._piemenuNumber([-3,-2,-1,0,1,2,3],this.value);break;case"scaledegree":this._piemenuScaleDegree([1,2,3,4,5,6,7],this.value);break;case"onbeatdo":case"meter":this._piemenuNumber([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],this.value);break;case"pitchnumber":for(w=0;w<this.blocks.blockList.length;w++)if("settemperament"==this.blocks.blockList[w].name&&null!==this.blocks.blockList[w].connections[0])var it=this.blocks.blockList[w].connections[1],st=this.blocks.blockList[it].value;if(void 0===st&&(st="equal"),"equal"===st)this._piemenuNumber([-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12],this.value);else{var lt=[];for(w=0;w<TEMPERAMENT[st].pitchNumber;w++)lt.push(w);this._piemenuNumber(lt,this.value)}break;case"neighbor":case"neighbor2":case"steppitch":case"interval":case"setscalartransposition":this._piemenuNumber([-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7],this.value);break;case"decrescendo":case"crescendo":this._piemenuNumber([1,2,3,4,5,10,15,20],this.value);break;case"harmonic2":this._piemenuNumber([1,2,3,4,5,6,7,8,9,10,11],this.value);break;case"vibrato":this._piemenuNumber([1,2,3,4,5,6,7,8,9,10],this.value);break;case"semitoneinterval":case"settransposition":this._piemenuNumber([-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12],this.value);break;case"setnotevolume":this._piemenuNumber([0,10,20,30,40,50,60,70,80,90,100],this.value);break;case"dis":case"duosynth":this._piemenuNumber([10,20,30,40,50,60,70,80,90,100],this.value);break;case"articulation":this._piemenuNumber([-25,-20,-15,-10,-5,0,5,10,15,20,25],this.value)}else console.log("NUMBER LABEL"),r.innerHTML='<input id="numberLabel" style="position: absolute; -webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="number" type="number" value="'+n+'" />',r.classList.add("hasKeyboard"),this.label=docById("numberLabel")}J=this.blocks.blockList.indexOf(this);if(!this._usePiemenu()){var ot=!1,at=function(t){ot&&(e._labelChanged(!1,!0),t.preventDefault(),r.classList.remove("hasKeyboard"),window.scroll(0,0),e.label.removeEventListener("keypress",nt),o&&(e.blocks.stage.y=a,e.blocks.updateStage()))};"text"!==this.name&&"number"!==this.name||(this.label.addEventListener("blur",at),this.label.addEventListener("input",function(t){e._labelChanged(!1,!0)}));var nt=function(t){-1!==[13,10,9].indexOf(t.keyCode)&&at(t)};this.label.addEventListener("keypress",nt),this.label.addEventListener("change",function(){e._labelChanged(!1,!0)}),this.label.style.left=Math.round((t+this.blocks.stage.x)*this.blocks.getStageScale()+s)+"px",this.label.style.top=Math.round((i+this.blocks.stage.y)*this.blocks.getStageScale()+l)+"px",this.label.style.width=Math.round(150*this.blocks.blockScale)*this.protoblock.scale/2+"px",this.label.style.fontSize=Math.round(20*this.blocks.blockScale*this.protoblock.scale/2)+"px",this.label.style.display="",this.label.focus(),null!=this.labelattr&&(this.labelattr.style.display=""),setTimeout(function(){e.label.style.display="",e.label.focus(),ot=!0},100)}},this._exitKeyPressed=function(t){-1!==[13,10,9].indexOf(t.keyCode)&&(this._labelChanged(!0,!1),t.preventDefault(),this.label.removeEventListener("keypress",this._exitKeyPressed))},this.piemenuOKtoLaunch=function(){return null===this._piemenuExitTime||200<(new Date).getTime()-this._piemenuExitTime},this._noteValueNumber=function(t){var e=this.connections[0];if("number"===this.name&&null!==e&&"divide"===this.blocks.blockList[e].name&&this.blocks.blockList[e].connections[t]===this.blocks.blockList.indexOf(this)&&(cblk=this.blocks.blockList[e].connections[0],null!==cblk))switch(this.blocks.blockList[cblk].name){case"newnote":case"pickup":case"tuplet4":case"newstaccato":case"newslur":case"elapsednotes2":return this.blocks.blockList[cblk].connections[1]===e;case"meter":this._check_meter_block=cblk;case"setbpm2":case"setmasterbpm2":case"stuplet":case"rhythm2":case"newswing2":case"vibrato":case"neighbor":case"neighbor2":return this.blocks.blockList[cblk].connections[2]===e;default:return!1}return!1},this._noteValueValue=function(){var t=this.connections[0];if(cblk=this.blocks.blockList[t].connections[0],null!==cblk)switch(this.blocks.blockList[cblk].name){case"newnote":case"pickup":case"tuplet4":case"newstaccato":case"newslur":case"elapsednotes2":return this.blocks.blockList[cblk].connections[1]===t?(cblk=this.blocks.blockList[t].connections[2],this.blocks.blockList[cblk].value):1;case"meter":this._check_meter_block=cblk;case"setbpm2":case"setmasterbpm2":case"stuplet":case"rhythm2":case"newswing2":case"vibrato":case"neighbor":case"neighbor2":return this.blocks.blockList[cblk].connections[2]===t&&this.blocks.blockList[cblk].connections[1]===t?(cblk=this.blocks.blockList[t].connections[2],this.blocks.blockList[cblk].value):1;default:return 1}return 1},this._octaveNumber=function(){return"number"===this.name&&null!==this.connections[0]&&-1!==["pitch","setpitchnumberoffset","invert1","tofrequency","scaledegree"].indexOf(this.blocks.blockList[this.connections[0]].name)&&this.blocks.blockList[this.connections[0]].connections[2]===this.blocks.blockList.indexOf(this)},this._piemenuPitches=function(c,h,t,e,i,u){var d=null;if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{void 0===u&&(u=!1);var f=null!==this.connections[0]&&-1!==["pitch","setpitchnumberoffset","invert1","tofrequency"].indexOf(this.blocks.blockList[this.connections[0]].name);if(null!==this.connections[0]&&-1!==["setkey","setkey2"].indexOf(this.blocks.blockList[this.connections[0]].name)&&(c=["C","G","D","A","E","B","F"],h=["C","G","D","A","E","B","F"]),docById("wheelDiv").style.display="",this._pitchWheel=new wheelnav("wheelDiv",null,600,600),u||(this._accidentalsWheel=new wheelnav("_accidentalsWheel",this._pitchWheel.raphael)),f&&(this._octavesWheel=new wheelnav("_octavesWheel",this._pitchWheel.raphael)),this._exitWheel=new wheelnav("_exitWheel",this._pitchWheel.raphael),wheelnav.cssMode=!0,this._pitchWheel.keynavigateEnabled=!1,this._pitchWheel.colors=platformColor.pitchWheelcolors,this._pitchWheel.slicePathFunction=slicePath().DonutSlice,this._pitchWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._pitchWheel.slicePathCustom.minRadiusPercent=.2,this._pitchWheel.slicePathCustom.maxRadiusPercent=u?.75:.5,this._pitchWheel.sliceSelectedPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.sliceInitPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.animatetime=0,this._pitchWheel.createWheel(c),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]),!u){this._accidentalsWheel.colors=platformColor.accidentalsWheelcolors,this._accidentalsWheel.slicePathFunction=slicePath().DonutSlice,this._accidentalsWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._accidentalsWheel.slicePathCustom.minRadiusPercent=.5,this._accidentalsWheel.slicePathCustom.maxRadiusPercent=.75,this._accidentalsWheel.sliceSelectedPathCustom=this._accidentalsWheel.slicePathCustom,this._accidentalsWheel.sliceInitPathCustom=this._accidentalsWheel.slicePathCustom;for(var s=[],l=0;l<t.length;l++)s.push(t[l]);for(l=0;l<9;l++)s.push(null),this._accidentalsWheel.colors.push(platformColor.accidentalsWheelcolorspush);this._accidentalsWheel.animatetime=0,this._accidentalsWheel.createWheel(s),this._accidentalsWheel.setTooltips([_("double sharp"),_("sharp"),_("natural"),_("flat"),_("double flat")])}if(f){this._octavesWheel.colors=platformColor.octavesWheelcolors,this._octavesWheel.slicePathFunction=slicePath().DonutSlice,this._octavesWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._octavesWheel.slicePathCustom.minRadiusPercent=.75,this._octavesWheel.slicePathCustom.maxRadiusPercent=.95,this._octavesWheel.sliceSelectedPathCustom=this._octavesWheel.slicePathCustom,this._octavesWheel.sliceInitPathCustom=this._octavesWheel.slicePathCustom;this._octavesWheel.animatetime=0,this._octavesWheel.createWheel(["8","7","6","5","4","3","2","1",null,null,null,null,null,null])}var o=this.container.x,a=this.container.y,n=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,r=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;if(docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-300,Math.max(0,Math.round((o+this.blocks.stage.x)*this.blocks.getStageScale()+n)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-350,Math.max(0,Math.round((a+this.blocks.stage.y)*this.blocks.getStageScale()+r)-200))+"px",-1===(l=h.indexOf(e))&&(l=4),d=l,this._pitchWheel.navigateWheel(l),!u)if(""===i)this._accidentalsWheel.navigateWheel(2);else switch(i){case DOUBLEFLAT:this._accidentalsWheel.navigateWheel(4);break;case FLAT:this._accidentalsWheel.navigateWheel(3);break;case NATURAL:this._accidentalsWheel.navigateWheel(2);break;case SHARP:this._accidentalsWheel.navigateWheel(1);break;case DOUBLESHARP:this._accidentalsWheel.navigateWheel(0);break;default:this._accidentalsWheel.navigateWheel(2)}if(f){var p=this.blocks.findPitchOctave(this.connections[0]);this._octavesWheel.navigateWheel(8-p),prevOctave=8-p}var b=this,m=function(){var t=b._pitchWheel.navItems[b._pitchWheel.selectedNavItemIndex].title,e=c.indexOf(t);null===d&&(d=e);var i=e-d;if(3<i)var s=i-7;else if(i<-3)s=7+i;else s=i;var l=0;6<d+s?l=-1:d+s<0&&(l=1);var o=h[d=e];if(!u){var a=b._accidentalsWheel.navItems[b._accidentalsWheel.selectedNavItemIndex].title;if(" "===t)return;""!==a&&(o+=a)}if(f)var n=Number(b._octavesWheel.navItems[b._octavesWheel.selectedNavItemIndex].title);else n=4;(n+=l)<1?n=1:8<n&&(n=8),f&&0!==l&&(b._octavesWheel.navigateWheel(8-n),b.blocks.setPitchOctave(b.connections[0],n));var r=getNote(o,n,0,"C major",!1,null,b.blocks.errorMsg,b.blocks.logo.synth.inTemperament);u||(r[0]=r[0].replace(SHARP,"#").replace(FLAT,"b")),void 0!==b.blocks.logo.instrumentNames[0]&&-1!==b.blocks.logo.instrumentNames[0].indexOf(DEFAULTVOICE)||(void 0===b.blocks.logo.instrumentNames[0]&&(b.blocks.logo.instrumentNames[0]=[]),b.blocks.logo.instrumentNames[0].push(DEFAULTVOICE),b.blocks.logo.synth.createDefaultSynth(0),b.blocks.logo.synth.loadSynth(0,DEFAULTVOICE)),b.blocks.logo.synth.setMasterVolume(PREVIEWVOLUME),b.blocks.logo.setSynthVolume(0,DEFAULTVOICE,PREVIEWVOLUME),b._triggerLock||(b._triggerLock=!0,b.blocks.logo.synth.trigger(0,[r[0]+r[1]],1/8,DEFAULTVOICE,null,null)),setTimeout(function(){b._triggerLock=!1},b.blocks.logo.defaultBPMFactor/8),function(){var t=b._pitchWheel.navItems[b._pitchWheel.selectedNavItemIndex].title,e=c.indexOf(t);if(b.value=h[e],!u){var i=b._accidentalsWheel.navItems[b._accidentalsWheel.selectedNavItemIndex].title;""!==i&&(t+=i,b.value+=i)}b.text.text=t;var s=b.container.children.length-1;if(b.container.setChildIndex(b.text,s),b.updateCache(),f){var l=Number(b._octavesWheel.navItems[b._octavesWheel.selectedNavItemIndex].title);b.blocks.setPitchOctave(b.connections[0],l)}if(null!==b.connections[0]&&-1!==["setkey","setkey2"].indexOf(this.blocks.blockList[b.connections[0]].name)){var o=b.blocks.blockList.indexOf(b);b.blocks.logo._modeBlock=o,"visible"===docById("modeDiv").style.visibility&&(parts=b.blocks.logo.keySignature[0].split(" "),b.blocks.logo.keySignature[0]=t+" "+parts[1],b.blocks.logo.modeWidget.init(b.blocks.logo,o))}}()};for(l=0;l<h.length;l++)this._pitchWheel.navItems[l].navigateFunction=m;if(!u)for(l=0;l<t.length;l++)this._accidentalsWheel.navItems[l].navigateFunction=m;if(f)for(l=0;l<8;l++)this._octavesWheel.navItems[l].navigateFunction=m;this._exitWheel.navItems[0].navigateFunction=function(){var t=new Date;b._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",b._pitchWheel.removeWheel(),u||b._accidentalsWheel.removeWheel(),b._exitWheel.removeWheel(),f&&b._octavesWheel.removeWheel()}}},this._piemenuScaleDegree=function(o,t){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{for(var a=[],e=0;e<o.length;e++)a.push(o[e].toString());docById("wheelDiv").style.display="",this._pitchWheel=new wheelnav("wheelDiv",null,600,600),this._octavesWheel=new wheelnav("_octavesWheel",this._pitchWheel.raphael),this._exitWheel=new wheelnav("_exitWheel",this._pitchWheel.raphael),wheelnav.cssMode=!0,this._pitchWheel.keynavigateEnabled=!1,this._pitchWheel.colors=platformColor.pitchWheelcolors,this._pitchWheel.slicePathFunction=slicePath().DonutSlice,this._pitchWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._pitchWheel.slicePathCustom.minRadiusPercent=.2,this._pitchWheel.slicePathCustom.maxRadiusPercent=.5,this._pitchWheel.sliceSelectedPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.sliceInitPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.animatetime=0,this._pitchWheel.createWheel(a),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]),this._octavesWheel.colors=platformColor.octavesWheelcolors,this._octavesWheel.slicePathFunction=slicePath().DonutSlice,this._octavesWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._octavesWheel.slicePathCustom.minRadiusPercent=.75,this._octavesWheel.slicePathCustom.maxRadiusPercent=.95,this._octavesWheel.sliceSelectedPathCustom=this._octavesWheel.slicePathCustom,this._octavesWheel.sliceInitPathCustom=this._octavesWheel.slicePathCustom;this._octavesWheel.animatetime=0,this._octavesWheel.createWheel(["8","7","6","5","4","3","2","1",null,null,null,null,null,null]);var i=this.container.x,s=this.container.y,l=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,n=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-300,Math.max(0,Math.round((i+this.blocks.stage.x)*this.blocks.getStageScale()+l)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-350,Math.max(0,Math.round((s+this.blocks.stage.y)*this.blocks.getStageScale()+n)-200))+"px",-1===(e=o.indexOf(t))&&(e=4),this._pitchWheel.navigateWheel(e);var r=this.blocks.findPitchOctave(this.connections[0]);this._octavesWheel.navigateWheel(8-r);var c=this,h=function(){var t=c._pitchWheel.navItems[c._pitchWheel.selectedNavItemIndex].title,e=a.indexOf(t),i=o[e],s=Number(c._octavesWheel.navItems[c._octavesWheel.selectedNavItemIndex].title),l=scaleDegreeToPitch("C major",i);void 0!==c.blocks.logo.instrumentNames[0]&&-1!==c.blocks.logo.instrumentNames[0].indexOf(DEFAULTVOICE)||(void 0===c.blocks.logo.instrumentNames[0]&&(c.blocks.logo.instrumentNames[0]=[]),c.blocks.logo.instrumentNames[0].push(DEFAULTVOICE),c.blocks.logo.synth.createDefaultSynth(0),c.blocks.logo.synth.loadSynth(0,DEFAULTVOICE)),c.blocks.logo.synth.setMasterVolume(DEFAULTVOLUME),c.blocks.logo.setSynthVolume(0,DEFAULTVOICE,DEFAULTVOLUME),c.blocks.logo.synth.trigger(0,[l.replace(SHARP,"#").replace(FLAT,"b")+s],1/8,DEFAULTVOICE,null,null),function(){var t=c._pitchWheel.navItems[c._pitchWheel.selectedNavItemIndex].title,e=a.indexOf(t);c.value=o[e],c.text.text=t;var i=c.container.children.length-1;c.container.setChildIndex(c.text,i),c.updateCache();var s=Number(c._octavesWheel.navItems[c._octavesWheel.selectedNavItemIndex].title);c.blocks.setPitchOctave(c.connections[0],s)}()};for(e=0;e<o.length;e++)this._pitchWheel.navItems[e].navigateFunction=h;for(e=0;e<8;e++)this._octavesWheel.navItems[e].navigateFunction=h;this._exitWheel.navItems[0].navigateFunction=function(){var t=new Date;c._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",c._pitchWheel.removeWheel(),c._exitWheel.removeWheel(),c._octavesWheel.removeWheel()}}},this._piemenuAccidentals=function(s,l,t){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{docById("wheelDiv").style.display="",this._accidentalWheel=new wheelnav("wheelDiv",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._accidentalWheel.raphael);for(var o=[],e=0;e<s.length;e++){var i=s[e].split(" ");o.push(last(i))}o.push(null),wheelnav.cssMode=!0,this._accidentalWheel.keynavigateEnabled=!1,this._accidentalWheel.colors=platformColor.accidentalsWheelcolors,this._accidentalWheel.slicePathFunction=slicePath().DonutSlice,this._accidentalWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._accidentalWheel.slicePathCustom.minRadiusPercent=.2,this._accidentalWheel.slicePathCustom.maxRadiusPercent=.6,this._accidentalWheel.sliceSelectedPathCustom=this._accidentalWheel.slicePathCustom,this._accidentalWheel.sliceInitPathCustom=this._accidentalWheel.slicePathCustom,this._accidentalWheel.titleRotateAngle=0,this._accidentalWheel.animatetime=0,this._accidentalWheel.createWheel(o),this._accidentalWheel.setTooltips(s),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]);var a=this,n=function(){var t=a._accidentalWheel.navItems[a._accidentalWheel.selectedNavItemIndex].title,e=o.indexOf(t);a.value=l[e],a.text.text=s[e];var i=a.container.children.length-1;a.container.setChildIndex(a.text,i),a.updateCache()},r=function(){var t=new Date;a._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",a._accidentalWheel.removeWheel(),a._exitWheel.removeWheel()},c=this.container.x,h=this.container.y,u=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,d=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-300,Math.max(0,Math.round((c+this.blocks.stage.x)*this.blocks.getStageScale()+u)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-350,Math.max(0,Math.round((h+this.blocks.stage.y)*this.blocks.getStageScale()+d)-200))+"px",-1===(e=l.indexOf(t))&&(e=2),this._accidentalWheel.navigateWheel(e);for(e=0;e<s.length;e++)this._accidentalWheel.navItems[e].navigateFunction=function(){n(),r()};this._exitWheel.navItems[0].navigateFunction=function(){r()}}},this._piemenuNoteValue=function(t){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{docById("wheelDiv").style.display="";var s=[3,2,7,5],l={2:[1,2,4,8,16,32],3:[1,3,6,9,12,27],5:[1,5,10,15,20,25],7:[1,7,14,21,28,35]},e=this.connections[0];if(null!==e&&null!==(e=this.blocks.blockList[e].connections[0])&&-1!==["neighbor","neighbor2"].indexOf(this.blocks.blockList[e].name))l={2:[8,16,32,64],3:[9,12,27,54],5:[10,15,20,25],7:[14,21,28,35]};this._noteValueWheel=new wheelnav("wheelDiv",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._noteValueWheel.raphael),this._tabsWheel=new wheelnav("_tabsWheel",this._noteValueWheel.raphael);for(var i=[],o=0;o<s.length;o++)i.push(s[o].toString());wheelnav.cssMode=!0,this._noteValueWheel.keynavigateEnabled=!1,this._noteValueWheel.colors=platformColor.noteValueWheelcolors,this._noteValueWheel.slicePathFunction=slicePath().DonutSlice,this._noteValueWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._noteValueWheel.slicePathCustom.minRadiusPercent=.2,this._noteValueWheel.slicePathCustom.maxRadiusPercent=.6,this._noteValueWheel.sliceSelectedPathCustom=this._noteValueWheel.slicePathCustom,this._noteValueWheel.sliceInitPathCustom=this._noteValueWheel.slicePathCustom,this._noteValueWheel.animatetime=0,this._noteValueWheel.clickModeRotate=!1,this._noteValueWheel.createWheel(i),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]);var a=[];for(o=0;o<s.length;o++)for(var n=0;n<l[s[o]].length;n++)a.push(l[s[o]][n].toString());this._tabsWheel.colors=platformColor.tabsWheelcolors,this._tabsWheel.slicePathFunction=slicePath().DonutSlice,this._tabsWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._tabsWheel.slicePathCustom.minRadiusPercent=.6,this._tabsWheel.slicePathCustom.maxRadiusPercent=.8,this._tabsWheel.sliceSelectedPathCustom=this._tabsWheel.slicePathCustom,this._tabsWheel.sliceInitPathCustom=this._tabsWheel.slicePathCustom,this._tabsWheel.clickModeRotate=!1,this._tabsWheel.navAngle=-180/s.length+180/(s.length*l[s[0]].length),this._tabsWheel.createWheel(a);var r=this,c=function(){r.text.text=r._tabsWheel.navItems[r._tabsWheel.selectedNavItemIndex].title,r.value=Number(r.text.text);var t=r.container.children.length-1;r.container.setChildIndex(r.text,t),r.updateCache()},h=function(){var t=new Date;r._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",r._noteValueWheel.removeWheel(),r._exitWheel.removeWheel(),r.label.style.display="none",null!==r._check_meter_block&&r.blocks.meter_block_changed(r._check_meter_block)},u=docById("labelDiv");u.innerHTML='<input id="numberLabel" style="position: absolute; -webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="number" type="number" value="'+t+'" />',u.classList.add("hasKeyboard"),this.label=docById("numberLabel"),this.label.addEventListener("keypress",this._exitKeyPressed.bind(this)),this.label.addEventListener("change",function(){r._labelChanged(!1,!1)});var d=this.container.x,f=this.container.y,p=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,b=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px";var m=Math.round((d+this.blocks.stage.x)*this.blocks.getStageScale()+p),g=Math.round((f+this.blocks.stage.y)*this.blocks.getStageScale()+b);this.label.style.left=m+"px",this.label.style.top=g+"px",docById("wheelDiv").style.left=Math.min(Math.max(m-75,0),this.blocks.turtles._canvas.width-300)+"px",docById("wheelDiv").style.top=g-300<0?g+40+"px":g-300+"px",this.label.style.width=Math.round(150*this.blocks.blockScale)*this.protoblock.scale/2+"px";var k=function(){r._noteValueWheel.selectedNavItemIndex;for(var t=0;t<s.length;t++)for(var e=0;e<l[s[0]].length;e++){var i=t*l[s[0]].length;r._noteValueWheel.selectedNavItemIndex===t?r._tabsWheel.navItems[i+e].navItem.show():r._tabsWheel.navItems[i+e].navItem.hide()}};for(o=0;o<i.length;o++)this._noteValueWheel.navItems[o].navigateFunction=k;if(1===t)this._noteValueWheel.navigateWheel(1),this._tabsWheel.navigateWheel(0);else{for(o=0;o<s.length;o++){for(n=0;n<l[s[o]].length;n++)if(l[s[o]][n]===t){this._noteValueWheel.navigateWheel(o),this._tabsWheel.navigateWheel(o*l[s[o]].length+n);break}if(n<l[s[o]].length)break}o===s.length&&(this._noteValueWheel.navigateWheel(1),this._tabsWheel.navigateWheel(2))}this.label.style.fontSize=Math.round(20*this.blocks.blockScale*this.protoblock.scale/2)+"px",this.label.style.display="",this.label.focus();for(o=0;o<a.length;o++)this._tabsWheel.navItems[o].navigateFunction=function(){c(),h()};this._exitWheel.navItems[0].navigateFunction=function(){h()}}},this._piemenuNumber=function(e,t){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{docById("wheelDiv").style.display="",this._numberWheel=new wheelnav("wheelDiv",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._numberWheel.raphael);for(var i=[],s=0;s<e.length;s++)i.push(e[s].toString());if(i.push(null),wheelnav.cssMode=!0,this._numberWheel.keynavigateEnabled=!1,this._numberWheel.colors=platformColor.numberWheelcolors,this._numberWheel.slicePathFunction=slicePath().DonutSlice,this._numberWheel.slicePathCustom=slicePath().DonutSliceCustomization(),16<e.length?(this._numberWheel.slicePathCustom.minRadiusPercent=.6,this._numberWheel.slicePathCustom.maxRadiusPercent=1):10<e.length?(this._numberWheel.slicePathCustom.minRadiusPercent=.5,this._numberWheel.slicePathCustom.maxRadiusPercent=.9):(this._numberWheel.slicePathCustom.minRadiusPercent=.2,this._numberWheel.slicePathCustom.maxRadiusPercent=.6),this._numberWheel.sliceSelectedPathCustom=this._numberWheel.slicePathCustom,this._numberWheel.sliceInitPathCustom=this._numberWheel.slicePathCustom,this._numberWheel.animatetime=0,this._numberWheel.createWheel(i),20<this._numberWheel.navItems.length){console.log("LOTS OF NUMBERS: "+this._numberWheel.navItems.length);for(s=0;s<this._numberWheel.navItems.length;s++)this._numberWheel.navItems[s].titleAttr.font="30 30px sans-serif",this._numberWheel.navItems[s].titleSelectedAttr.font="30 30px sans-serif"}this._exitWheel.colors=platformColor.exitWheelcolors2,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x","-","+"]);var l=this,o=function(){l.value=e[l._numberWheel.selectedNavItemIndex],l.text.text=i[l._numberWheel.selectedNavItemIndex];var t=l.container.children.length-1;l.container.setChildIndex(l.text,t),l.updateCache()},a=function(){var t=new Date;l._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",l._numberWheel.removeWheel(),l._exitWheel.removeWheel(),l.label.style.display="none",null!==l._check_meter_block&&l.blocks.meter_block_changed(l._check_meter_block)},n=docById("labelDiv");n.innerHTML='<input id="numberLabel" style="position: absolute; -webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="number" type="number" value="'+t+'" />',n.classList.add("hasKeyboard"),this.label=docById("numberLabel"),this.label.addEventListener("keypress",this._exitKeyPressed.bind(this)),this.label.addEventListener("change",function(){l._labelChanged(!1,!1)});var r=this.container.x,c=this.container.y,h=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,u=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px";var d=Math.round((r+this.blocks.stage.x)*this.blocks.getStageScale()+h),f=Math.round((c+this.blocks.stage.y)*this.blocks.getStageScale()+u);this.label.style.left=d+"px",this.label.style.top=f+"px",docById("wheelDiv").style.left=Math.min(Math.max(d-75,0),this.blocks.turtles._canvas.width-300)+"px",docById("wheelDiv").style.top=f-300<0?f+40+"px":f-300+"px",this.label.style.width=Math.round(150*this.blocks.blockScale)*this.protoblock.scale/2+"px",-1===(s=e.indexOf(t))&&(s=0),this._numberWheel.navigateWheel(s),this.label.style.fontSize=Math.round(20*this.blocks.blockScale*this.protoblock.scale/2)+"px",this.label.style.display="",this.label.focus();for(s=0;s<i.length;s++)this._numberWheel.navItems[s].navigateFunction=function(){o(),a()};this._exitWheel.navItems[0].navigateFunction=function(){a()},this._exitWheel.navItems[1].navigateFunction=function(){l.value-=1,l.text.text=l.value.toString();var t=l.container.children.length-1;l.container.setChildIndex(l.text,t),l.updateCache(),l.label.value=l.value},this._exitWheel.navItems[2].navigateFunction=function(){l.value+=1,l.text.text=l.value.toString();var t=l.container.children.length-1;l.container.setChildIndex(l.text,t),l.updateCache(),l.label.value=l.value}}},this._piemenuColor=function(e,t,i){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{docById("wheelDiv").style.display="",this._numberWheel=new wheelnav("wheelDiv",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._numberWheel.raphael);for(var s=[],l=0;l<e.length;l++)s.push(e[l].toString());if(wheelnav.cssMode=!0,this._numberWheel.keynavigateEnabled=!1,this._numberWheel.colors=[],"setcolor"===i)for(l=0;l<e.length;l++)this._numberWheel.colors.push(COLORS40[Math.floor(e[l]/2.5)][2]);else if("sethue"===i)for(l=0;l<e.length;l++)this._numberWheel.colors.push(getMunsellColor(e[l],50,50));else{if("setshade"===i)for(l=0;l<e.length;l++)this._numberWheel.colors.push(getMunsellColor(0,e[l],0));else if("settranslucency"===i)for(l=0;l<e.length;l++)this._numberWheel.colors.push(getMunsellColor(35,70,100-e[l]));else for(l=0;l<e.length;l++)this._numberWheel.colors.push(getMunsellColor(60,60,e[l]));for(l=0;l<e.length;l++)s.push(null)}this._numberWheel.slicePathFunction=slicePath().DonutSlice,this._numberWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._numberWheel.slicePathCustom.minRadiusPercent=.6,this._numberWheel.slicePathCustom.maxRadiusPercent=1,this._numberWheel.sliceSelectedPathCustom=this._numberWheel.slicePathCustom,this._numberWheel.sliceInitPathCustom=this._numberWheel.slicePathCustom,this._numberWheel.animatetime=0,this._numberWheel.createWheel(s),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]);var o=this,a=function(){o.value=e[o._numberWheel.selectedNavItemIndex],o.text.text=s[o._numberWheel.selectedNavItemIndex];var t=o.container.children.length-1;o.container.setChildIndex(o.text,t),o.updateCache()},n=function(){var t=new Date;o._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",o._numberWheel.removeWheel(),o._exitWheel.removeWheel(),o.label.style.display="none"},r=docById("labelDiv");r.innerHTML='<input id="numberLabel" style="position: absolute; -webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="number" type="number" value="'+t+'" />',r.classList.add("hasKeyboard"),this.label=docById("numberLabel"),this.label.addEventListener("keypress",this._exitKeyPressed.bind(this)),this.label.addEventListener("change",function(){o._labelChanged(!1,!1)});var c=this.container.x,h=this.container.y,u=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,d=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px";var f=Math.round((c+this.blocks.stage.x)*this.blocks.getStageScale()+u),p=Math.round((h+this.blocks.stage.y)*this.blocks.getStageScale()+d);this.label.style.left=f+"px",this.label.style.top=p+"px",docById("wheelDiv").style.left=Math.min(Math.max(f-75,0),this.blocks.turtles._canvas.width-300)+"px",docById("wheelDiv").style.top=p-300<0?p+40+"px":p-300+"px",this.label.style.width=Math.round(150*this.blocks.blockScale)*this.protoblock.scale/2+"px",-1===(l=e.indexOf(t))&&(l=0),this._numberWheel.navigateWheel(l),this.label.style.fontSize=Math.round(20*this.blocks.blockScale*this.protoblock.scale/2)+"px",this.label.style.display="",this.label.focus();for(l=0;l<s.length;l++)this._numberWheel.navItems[l].navigateFunction=function(){a(),n()};this._exitWheel.navItems[0].navigateFunction=function(){n()}}},this._piemenuBasic=function(s,l,t,e){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{void 0===e&&(e=platformColor.piemenuBasicundefined),docById("wheelDiv").style.display="",this._basicWheel=new wheelnav("wheelDiv",null,800,800);for(var o=[],i=0;i<s.length;i++)o.push(s[i]);wheelnav.cssMode=!0,this._basicWheel.keynavigateEnabled=!1,this._basicWheel.colors=e,this._basicWheel.slicePathFunction=slicePath().DonutSlice,this._basicWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._basicWheel.slicePathCustom.minRadiusPercent=0,this._basicWheel.slicePathCustom.maxRadiusPercent=.9,this._basicWheel.sliceSelectedPathCustom=this._basicWheel.slicePathCustom,this._basicWheel.sliceInitPathCustom=this._basicWheel.slicePathCustom,this._basicWheel.titleRotateAngle=0,this._basicWheel.animatetime=0,this._basicWheel.createWheel(o);var a=this,n=function(){var t=a._basicWheel.navItems[a._basicWheel.selectedNavItemIndex].title,e=o.indexOf(t);a.value=l[e],a.text.text=s[e];var i=a.container.children.length-1;a.container.setChildIndex(a.text,i),a.updateCache()},r=this.container.x,c=this.container.y,h=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,u=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-300,Math.max(0,Math.round((r+this.blocks.stage.x)*this.blocks.getStageScale()+h)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-350,Math.max(0,Math.round((c+this.blocks.stage.y)*this.blocks.getStageScale()+u)-200))+"px",-1===(i=l.indexOf(t))&&(i=1),this._basicWheel.navigateWheel(i);for(i=0;i<s.length;i++)this._basicWheel.navItems[i].navigateFunction=function(){var t;n(),t=new Date,a._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",a._basicWheel.removeWheel()}}},this._piemenuBoolean=function(s,l,t){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{docById("wheelDiv").style.display="",this._booleanWheel=new wheelnav("wheelDiv",null,600,600);for(var o=[],e=0;e<s.length;e++)o.push(s[e]);wheelnav.cssMode=!0,this._booleanWheel.keynavigateEnabled=!1,this._booleanWheel.colors=platformColor.booleanWheelcolors,this._booleanWheel.slicePathFunction=slicePath().DonutSlice,this._booleanWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._booleanWheel.slicePathCustom.minRadiusPercent=0,this._booleanWheel.slicePathCustom.maxRadiusPercent=.6,this._booleanWheel.sliceSelectedPathCustom=this._booleanWheel.slicePathCustom,this._booleanWheel.sliceInitPathCustom=this._booleanWheel.slicePathCustom,this._booleanWheel.animatetime=0,this._booleanWheel.createWheel(o);var a=this,i=function(){var t=a._booleanWheel.navItems[a._booleanWheel.selectedNavItemIndex].title,e=o.indexOf(t);a.value=l[e],a.text.text=s[e];var i=a.container.children.length-1;a.container.setChildIndex(a.text,i),a.updateCache()},n=function(){var t=new Date;a._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",a._booleanWheel.removeWheel()},r=this.container.x,c=this.container.y,h=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,u=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-300,Math.max(0,Math.round((r+this.blocks.stage.x)*this.blocks.getStageScale()+h)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-350,Math.max(0,Math.round((c+this.blocks.stage.y)*this.blocks.getStageScale()+u)-200))+"px",-1===(e=l.indexOf(t))&&(e=0),this._booleanWheel.navigateWheel(e),this._booleanWheel.navItems[0].navigateFunction=function(){i(),n()},this._booleanWheel.navItems[1].navigateFunction=function(){i(),n()}}},this._piemenuVoices=function(l,o,t,e,i){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{for(var s=platformColor.piemenuVoicesColors,a=[],n=0;n<l.length;n++)a.push(s[t[n]%s.length]);docById("wheelDiv").style.display="","kana"===localStorage.kanaPreference?this._voiceWheel=new wheelnav("wheelDiv",null,1200,1200):this._voiceWheel=new wheelnav("wheelDiv",null,800,800),this._exitWheel=new wheelnav("_exitWheel",this._voiceWheel.raphael),wheelnav.cssMode=!0,this._voiceWheel.keynavigateEnabled=!1,this._voiceWheel.colors=a,this._voiceWheel.slicePathFunction=slicePath().DonutSlice,this._voiceWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._voiceWheel.slicePathCustom.minRadiusPercent=.2,this._voiceWheel.slicePathCustom.maxRadiusPercent=1,this._voiceWheel.sliceSelectedPathCustom=this._voiceWheel.slicePathCustom,this._voiceWheel.sliceInitPathCustom=this._voiceWheel.slicePathCustom,this._voiceWheel.titleRotateAngle=void 0===i?0:i,this._voiceWheel.animatetime=0,this._voiceWheel.createWheel(l);for(localStorage.languagePreference,n=0;n<this._voiceWheel.navItems.length;n++)this._voiceWheel.navItems[n].titleAttr.font="30 30px sans-serif",this._voiceWheel.navItems[n].titleSelectedAttr.font="30 30px sans-serif";this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]);var r=this,c=function(){var t=r._voiceWheel.navItems[r._voiceWheel.selectedNavItemIndex].title,e=l.indexOf(t),i=o[e],s=0;if(void 0===r.blocks.logo.instrumentNames[0]||-1===r.blocks.logo.instrumentNames[0].indexOf(i)){void 0===r.blocks.logo.instrumentNames[0]&&(r.blocks.logo.instrumentNames[0]=[]),r.blocks.logo.instrumentNames[0].push(i),i===DEFAULTVOICE&&r.blocks.logo.synth.createDefaultSynth(0),r.blocks.logo.synth.loadSynth(0,i);s=500}setTimeout(function(){r.blocks.logo.synth.setMasterVolume(DEFAULTVOLUME),r.blocks.logo.setSynthVolume(0,i,DEFAULTVOLUME),r.blocks.logo.synth.trigger(0,"G4",.25,i,null,null,!1),r.blocks.logo.synth.start()},s),function(){var t=r._voiceWheel.navItems[r._voiceWheel.selectedNavItemIndex].title,e=l.indexOf(t);r.value=o[e],r.text.text=t,null===getDrumName(r.value)?r.blocks.logo.synth.loadSynth(0,getVoiceSynthName(r.value)):r.blocks.logo.synth.loadSynth(0,getDrumSynthName(r.value));var i=r.container.children.length-1;r.container.setChildIndex(r.text,i),r.updateCache()}()},h=this.container.x,u=this.container.y,d=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,f=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="400px",docById("wheelDiv").style.width="400px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-400,Math.max(0,Math.round((h+this.blocks.stage.x)*this.blocks.getStageScale()+d)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-450,Math.max(0,Math.round((u+this.blocks.stage.y)*this.blocks.getStageScale()+f)-200))+"px",-1===(n=o.indexOf(e))&&(n=0),this._voiceWheel.navigateWheel(n);for(n=0;n<o.length;n++)this._voiceWheel.navItems[n].navigateFunction=c;this._exitWheel.navItems[0].navigateFunction=function(){var t=new Date;r._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none"}}},this._piemenuIntervals=function(t){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{docById("wheelDiv").style.display="";var e=localStorage.languagePreference;this._intervalNameWheel="ja"===e?new wheelnav("wheelDiv",null,1500,1500):new wheelnav("wheelDiv",null,800,800),this._intervalWheel=new wheelnav("this._intervalWheel",this._intervalNameWheel.raphael),this._exitWheel=new wheelnav("_exitWheel",this._intervalNameWheel.raphael),wheelnav.cssMode=!0,this._intervalNameWheel.keynavigateEnabled=!1,this._intervalNameWheel.colors=platformColor.intervalNameWheelcolors,this._intervalNameWheel.slicePathFunction=slicePath().DonutSlice,this._intervalNameWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._intervalNameWheel.slicePathCustom.minRadiusPercent=.2,this._intervalNameWheel.slicePathCustom.maxRadiusPercent=.8,this._intervalNameWheel.sliceSelectedPathCustom=this._intervalNameWheel.slicePathCustom,this._intervalNameWheel.sliceInitPathCustom=this._intervalNameWheel.slicePathCustom,this._intervalNameWheel.titleRotateAngle=0,this._intervalNameWheel.clickModeRotate=!1;for(var l=[],i=0;i<INTERVALS.length;i++)l.push(_(INTERVALS[i][1]));this._intervalNameWheel.animatetime=0,this._intervalNameWheel.createWheel(l),this._intervalWheel.colors=platformColor.intervalWheelcolors,this._intervalWheel.slicePathFunction=slicePath().DonutSlice,this._intervalWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._intervalWheel.slicePathCustom.minRadiusPercent=.8,this._intervalWheel.slicePathCustom.maxRadiusPercent=1,this._intervalWheel.sliceSelectedPathCustom=this._intervalWheel.slicePathCustom,this._intervalWheel.sliceInitPathCustom=this._intervalWheel.slicePathCustom,this._intervalWheel.clickModeRotate=!1,this._intervalWheel.navAngle=-180/l.length+180/(8*l.length);var s=[];for(i=this._intervalWheel.animatetime=0;i<INTERVALS.length;i++)for(var o=1;o<9;o++)s.push(o.toString());this._intervalWheel.createWheel(s),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]);var a=this,n=this.container.x,r=this.container.y,c=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,h=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="400px",docById("wheelDiv").style.width="400px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-400,Math.max(0,Math.round((n+this.blocks.stage.x)*this.blocks.getStageScale()+c)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-450,Math.max(0,Math.round((r+this.blocks.stage.y)*this.blocks.getStageScale()+h)-200))+"px";var u=function(i,s){a._intervalNameWheel.navItems[i].navigateFunction=function(){for(var t=0;t<l.length;t++)for(var e=0;e<8;e++)t!==i?a._intervalWheel.navItems[8*t+e].navItem.hide():-1===s.indexOf(e+1)?a._intervalWheel.navItems[8*t+e].navItem.hide():a._intervalWheel.navItems[8*t+e].navItem.show()}};for(i=0;i<INTERVALS.length;i++)u(i,INTERVALS[i][2]);var d=t.split(" ");for(i=0;i<INTERVALS.length&&d[0]!==INTERVALS[i][1];i++);i===INTERVALS.length&&(i=0),this._intervalNameWheel.navigateWheel(i);o=Number(d[1]);-1!==INTERVALS[i][2].indexOf(o)?this._intervalWheel.navigateWheel(o-1):this._intervalWheel.navigateWheel(INTERVALS[i][2][0]-1);var f=function(){var t=a._intervalNameWheel.navItems[a._intervalNameWheel.selectedNavItemIndex].title,e=a._intervalWheel.navItems[a._intervalWheel.selectedNavItemIndex].title;a.value=INTERVALS[a._intervalNameWheel.selectedNavItemIndex][1]+" "+e,a.text.text="perfect 1"===t?_("unison"):t+" "+e;var i=a.container.children.length-1;a.container.setChildIndex(a.text,i),a.updateCache();var s=getNote("C",4,INTERVALVALUES[a.value][0],"C major",!1,null,null);s[0]=s[0].replace(SHARP,"#").replace(FLAT,"b"),void 0!==a.blocks.logo.instrumentNames[0]&&-1!==a.blocks.logo.instrumentNames[0].indexOf(DEFAULTVOICE)||(void 0===a.blocks.logo.instrumentNames[0]&&(a.blocks.logo.instrumentNames[0]=[]),a.blocks.logo.instrumentNames[0].push(DEFAULTVOICE),a.blocks.logo.synth.createDefaultSynth(0),a.blocks.logo.synth.loadSynth(0,DEFAULTVOICE)),a.blocks.logo.synth.setMasterVolume(DEFAULTVOLUME),a.blocks.logo.setSynthVolume(0,DEFAULTVOICE,DEFAULTVOLUME),a.blocks.logo.synth.trigger(0,["C4",s[0]+s[1]],1/8,DEFAULTVOICE,null,null)};for(i=0;i<8*l.length;i++)this._intervalWheel.navItems[i].navigateFunction=f;this._exitWheel.navItems[0].navigateFunction=function(){var t=new Date;a._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none"}}},this._piemenuModes=function(h){if(this.blocks.stageClick)console.log("stageClick: aborting piemenu display");else{var s="C",l="7",o=!1,t=this.connections[0];if(null!==t&&"setkey2"===this.blocks.blockList[t].name){var e=this.blocks.blockList[t].connections[1];if(null!==e&&"notename"===this.blocks.blockList[e].name)s=this.blocks.blockList[e].value}docById("wheelDiv").style.display="",this._modeWheel=new wheelnav("wheelDiv",null,1200,1200),this._modeGroupWheel=new wheelnav("_modeGroupWheel",this._modeWheel.raphael),this._modeNameWheel=null,this._exitWheel=new wheelnav("_exitWheel",this._modeWheel.raphael),wheelnav.cssMode=!0,this._modeWheel.colors=platformColor.modeWheelcolors,this._modeWheel.slicePathFunction=slicePath().DonutSlice,this._modeWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._modeWheel.slicePathCustom.minRadiusPercent=.85,this._modeWheel.slicePathCustom.maxRadiusPercent=1,this._modeWheel.sliceSelectedPathCustom=this._modeWheel.slicePathCustom,this._modeWheel.sliceInitPathCustom=this._modeWheel.slicePathCustom,this._modeWheel.clickModeRotate=!1,this._modeWheel.navAngle=-90,this._modeWheel.animatetime=0,this._modeWheel.createWheel(["0","1","2","3","4","5","6","7","8","9","10","11"]),this._modeGroupWheel.colors=platformColor.modeGroupWheelcolors,this._modeGroupWheel.slicePathFunction=slicePath().DonutSlice,this._modeGroupWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._modeGroupWheel.slicePathCustom.minRadiusPercent=.15,this._modeGroupWheel.slicePathCustom.maxRadiusPercent=.3,this._modeGroupWheel.sliceSelectedPathCustom=this._modeGroupWheel.slicePathCustom,this._modeGroupWheel.sliceInitPathCustom=this._modeGroupWheel.slicePathCustom,this._modeGroupWheel.navAngle=-90,this._modeGroupWheel.animatetime=0;var i=[];for(modegroup in MODE_PIE_MENUS)i.push(modegroup);this._modeGroupWheel.createWheel(i),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.15,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x",""]);var u=this,d=function(t,e){u._modeNameWheel.navItems[t].navigateFunction=function(){for(var t=0;t<12;t++)-1===e.indexOf(t)?u._modeWheel.navItems[t].navItem.hide():u._modeWheel.navItems[t].navItem.show();!function(){if(" "===u._modeNameWheel.navItems[u._modeNameWheel.selectedNavItemIndex].title)u._modeNameWheel.navigateWheel((u._modeNameWheel.selectedNavItemIndex+1)%u._modeNameWheel.navItems.length);else{if(u.text.text=u._modeNameWheel.navItems[u._modeNameWheel.selectedNavItemIndex].title,u.text.text===_("major")+" / "+_("ionian"))u.value="major";else if(u.text.text===_("minor")+" / "+_("aeolian"))u.value="aeolian";else for(var t=0;t<MODE_PIE_MENUS[l].length;t++){var e=MODE_PIE_MENUS[l][t];if(_(e)===u.text.text){u.value=e;break}}var i=u.container.children.length-1;u.container.setChildIndex(u.text,i),u.updateCache()}if("visible"===docById("modeDiv").style.visibility){var s=u.blocks.blockList.indexOf(u);u.blocks.logo._modeBlock=s,"visible"===docById("modeDiv").style.visibility&&(parts=u.blocks.logo.keySignature[0].split(" "),u.blocks.logo.keySignature[0]=parts[0]+" "+u.value,u.blocks.logo.modeWidget.init(u.blocks.logo,s))}}()}},a=function(){var t=0;if(o)t=12;var e=u._modeWheel.selectedNavItemIndex,i=getNote(s,4,e+t,s+" chromatic",!1,null,null);i[0]=i[0].replace(SHARP,"#").replace(FLAT,"b"),void 0!==u.blocks.logo.instrumentNames[0]&&-1!==u.blocks.logo.instrumentNames[0].indexOf(DEFAULTVOICE)||(void 0===u.blocks.logo.instrumentNames[0]&&(u.blocks.logo.instrumentNames[0]=[]),u.blocks.logo.instrumentNames[0].push(DEFAULTVOICE),u.blocks.logo.synth.createDefaultSynth(0),u.blocks.logo.synth.loadSynth(0,DEFAULTVOICE)),u.blocks.logo.synth.setMasterVolume(DEFAULTVOLUME),u.blocks.logo.setSynthVolume(0,DEFAULTVOICE,DEFAULTVOLUME),u.blocks.logo.synth.trigger(0,[i[0]+i[1]],1/12,DEFAULTVOICE,null,null)},n=this.container.x,r=this.container.y,c=this.blocks.canvas.offsetLeft+28*this.blocks.blockScale,f=this.blocks.canvas.offsetTop+6*this.blocks.blockScale;docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="600px",docById("wheelDiv").style.width="600px",docById("wheelDiv").style.left=Math.min(this.blocks.turtles._canvas.width-600,Math.max(0,Math.round((n+this.blocks.stage.x)*this.blocks.getStageScale()+c)-200))+"px",docById("wheelDiv").style.top=Math.min(this.blocks.turtles._canvas.height-650,Math.max(0,Math.round((r+this.blocks.stage.y)*this.blocks.getStageScale()+f)-200))+"px";for(var p=0;p<12;p++)u._modeWheel.navItems[p].navigateFunction=a;for(l in MODE_PIE_MENUS){for(var b=0;b<MODE_PIE_MENUS[l].length;b++){if(MODE_PIE_MENUS[l][b]===h)break}if(b<MODE_PIE_MENUS[l].length)break}"major"===h&&(l="7");var m=function(){var t=u._modeGroupWheel.selectedNavItemIndex;!function(t){var e=!1;null===u._modeNameWheel&&(u._modeNameWheel=new wheelnav("_modeNameWheel",u._modeWheel.raphael),e=!0),u._modeNameWheel.keynavigateEnabled=!1;for(var i=[],s=0;s<MODE_PIE_MENUS[t].length;s++){" "===(a=MODE_PIE_MENUS[t][s])?i.push(platformColor.modePieMenusIfColorPush):i.push(platformColor.modePieMenusElseColorPush)}u._modeNameWheel.colors=i,u._modeNameWheel.slicePathFunction=slicePath().DonutSlice,u._modeNameWheel.slicePathCustom=slicePath().DonutSliceCustomization(),u._modeNameWheel.slicePathCustom.minRadiusPercent=.3,u._modeNameWheel.slicePathCustom.maxRadiusPercent=.85,u._modeNameWheel.sliceSelectedPathCustom=u._modeNameWheel.slicePathCustom,u._modeNameWheel.sliceInitPathCustom=u._modeNameWheel.slicePathCustom,u._modeNameWheel.titleRotateAngle=0,u._modeNameWheel.navAngle=-90;var l=new Array;for(s=0;s<MODE_PIE_MENUS[t].length;s++){switch(a=MODE_PIE_MENUS[t][s]){case"ionian":case"major":l.push(_("major")+" / "+_("ionian"));break;case"aeolian":case"minor":l.push(_("minor")+" / "+_("aeolian"));break;default:" "===a?l.push(" "):l.push(_(a))}}if(u._modeNameWheel.animatetime=0,e)u._modeNameWheel.createWheel(l);else{for(s=0;s<u._modeNameWheel.navItems.length;s++)u._modeNameWheel.navItems[s].title=l[s],u._modeNameWheel.navItems[s].basicNavTitleMax.title=l[s],u._modeNameWheel.navItems[s].basicNavTitleMin.title=l[s],u._modeNameWheel.navItems[s].hoverNavTitleMax.title=l[s],u._modeNameWheel.navItems[s].hoverNavTitleMin.title=l[s],u._modeNameWheel.navItems[s].selectedNavTitleMax.title=l[s],u._modeNameWheel.navItems[s].selectedNavTitleMin.title=l[s],u._modeNameWheel.navItems[s].initNavTitle.title=l[s],u._modeNameWheel.navItems[s].fillAttr=i[s],u._modeNameWheel.navItems[s].sliceHoverAttr.fill=i[s],u._modeNameWheel.navItems[s].slicePathAttr.fill=i[s],u._modeNameWheel.navItems[s].sliceSelectedAttr.fill=i[s];u._modeNameWheel.refreshWheel()}if("ja"===localStorage.languagePreference)for(s=0;s<u._modeNameWheel.navItems.length;s++)u._modeNameWheel.navItems[s].titleAttr.font="30 30px sans-serif",u._modeNameWheel.navItems[s].titleSelectedAttr.font="30 30px sans-serif";s=0;for(var o=0;o<MODE_PIE_MENUS[t].length;o++){var a,n=[0];if(" "!==(a=MODE_PIE_MENUS[t][o]))for(var r=MUSICALMODES[a],c=0;c<r.length;c++)n.push(last(n)+r[c]);d(s,n),s+=1}for(s=0;s<MODE_PIE_MENUS[t].length&&MODE_PIE_MENUS[t][s]!==h;s++);s===l.length&&(s=0),u._modeNameWheel.navigateWheel(s)}(l=u._modeGroupWheel.navItems[t].title)};for(p=0;p<this._modeGroupWheel.navItems.length;p++)this._modeGroupWheel.navItems[p].navigateFunction=m;for(p=0;p<this._modeGroupWheel.navItems.length;p++)if(this._modeGroupWheel.navItems[p].title===l){this._modeGroupWheel.navigateWheel(p);break}this._exitWheel.navItems[0].navigateFunction=function(){var t=new Date;u._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",null!==u._modeNameWheel&&u._modeNameWheel.removeWheel()},this._exitWheel.navItems[1].navigateFunction=function(){for(var t=[0],e=MUSICALMODES[u.value],i=0;i<e.length-1;i++)t.push(last(t)+e[i]);t.push(12),t.push(12);for(i=e.length-1;0<=i;i--)t.push(last(t)-e[i]);!function t(e,i){i<e.length&&(e[i]<12?(o=!1,u._modeWheel.navigateWheel(e[i])):(o=!0,u._modeWheel.navigateWheel(0)),setTimeout(function(){t(e,i+1)},100))}(t,0)}}},this._labelChanged=function(t,e){if(console.log("LABEL CHANGED "+this.name),null!==this&&null!==this.label){this._labelLock=!0,t&&(this.label.style.display="none",null!=this.labelattr&&(this.labelattr.style.display="none"),docById("wheelDiv").style.display="none"),void 0===e&&(docById("wheelDiv").style.display="none");var i=this.value,s=this.label.value;if(null!=this.labelattr){var l=this.labelattr.value;switch(l){case"":case"":case"":case"":s+=l}}var o=this.connections[0];if(i!==s||(this._labelLock=!1,"text"===this.name&&null!==o&&"storein"===this.blocks.blockList[o].name)){o=this.connections[0];if("text"===this.name&&null!=o)switch((p=this.blocks.blockList[o]).name){case"action":if(this.blocks.palettes.removeActionPrototype(i),(a=this.blocks.findUniqueActionName(s))!==s)s=a,this.value=s,getTextWidth(c=this.value.toString(),"bold 20pt Sans")>TEXTWIDTH&&(c=c.substr(0,STRINGLEN)+"..."),this.text.text=c,this.label.value=s,this.updateCache();break;case"pitch":var a=this.blocks.findUniqueCustomName(s);for(var n in s=a,TEMPERAMENT.custom)"pitchNumber"!==n&&i==TEMPERAMENT.custom[n][1]&&(TEMPERAMENT.custom[n][1]=s);this.value=s,getTextWidth(c=this.value.toString(),"bold 20pt Sans")>TEXTWIDTH&&(c=c.substr(0,STRINGLEN)+"..."),this.text.text=c,this.label.value=s,this.updateCache()}if("number"===this.name){if("-"===this.value?this.value=-1:this.value=Number(s),isNaN(this.value)){var r=this.blocks.blockList.indexOf(this);this.blocks.errorMsg(s+": "+_("Not a number"),r),this.blocks.refreshCanvas(),this.value=i}}else this.value=s;if("solfege"===this.name){var c=i18nSolfege((u=splitSolfege(this.value))[0]);""!==(h=u[1])&&(c+=h)}else if("eastindiansolfege"===this.name){var h,u=splitSolfege(this.value);c=WESTERN2EISOLFEGENAMES[u[0]];""!==(h=u[1])&&(c+=h)}else if("modename"===this.name)c=this.value+" "+getModeNumbers(this.value);else c=this.value.toString();if(-1===WIDENAMES.indexOf(this.name)&&getTextWidth(c,"bold 20pt Sans")>TEXTWIDTH){for(var d=c.length-5,f=c.substr(0,d)+"...";getTextWidth(f,"bold 20pt Sans")>TEXTWIDTH;){d-=1;getTextWidth(f=c.substr(0,d)+"...","bold 20pt Sans");if(d<=STRINGLEN)break}c=f}this.text.text=c,t&&(this.label.style.display="none",docById("wheelDiv").style.display="none");var p,b=this.container.children.length-1;if(this.container.setChildIndex(this.text,b),this.updateCache(),"text"===this.name&&null!=o)switch((p=this.blocks.blockList[o]).name){case"action":this.blocks.renameDos(i,s),i===_("action")&&(this.blocks.newNameddoBlock(s,this.blocks.actionHasReturn(o),this.blocks.actionHasArgs(o)),this.blocks.setActionProtoVisiblity(!1)),this.blocks.newNameddoBlock(s,this.blocks.actionHasReturn(o),this.blocks.actionHasArgs(o));for(var m=this.blocks.palettes.dict.action,g=0;g<m.protoList.length;g++){var k=m.protoList[g];i===_("action")?"nameddo"===k.name&&0===k.defaults.length&&(k.hidden=!0):"nameddo"===k.name&&k.defaults[0]===i&&m.remove(k,i)}i===_("action")&&(this.blocks.newNameddoBlock(s,this.blocks.actionHasReturn(o),this.blocks.actionHasArgs(o)),this.blocks.setActionProtoVisiblity(!1)),this.blocks.renameNameddos(i,s),this.blocks.palettes.hide(),this.blocks.palettes.updatePalettes("action"),this.blocks.palettes.show();break;case"storein":g=this.blocks.blockList.indexOf(this),p.connections[1]===g&&t&&("box"!==this.value&&(this.blocks.newStoreinBlock(this.value),this.blocks.newStorein2Block(this.value),this.blocks.newNamedboxBlock(this.value)),this.blocks.renameBoxes(i,s),this.blocks.renameNamedboxes(i,s),this.blocks.renameStoreinBoxes(i,s),this.blocks.renameStorein2Boxes(i,s),this.blocks.palettes.hide(),this.blocks.palettes.updatePalettes("boxes"),this.blocks.palettes.show());break;case"setdrum":case"playdrum":_THIS_IS_MUSIC_BLOCKS_&&"http"===s.slice(0,4)&&this.blocks.logo.synth.loadSynth(0,s)}this._labelLock=!1,_THIS_IS_MUSIC_BLOCKS_&&("drumname"===this.name?this.blocks.logo.synth.loadSynth(0,getDrumSynthName(this.value)):"effectsname"===this.name?this.blocks.logo.synth.loadSynth(0,getDrumSynthName(this.value)):"voicename"===this.name?this.blocks.logo.synth.loadSynth(0,getVoiceSynthName(this.value)):"noisename"===this.name&&this.blocks.logo.synth.loadSynth(0,getNoiseSynthName(this.value)))}}else this._labelLock=!1},this.piemenuBlockContext=function(){var t=this,e=this.blocks.blockList.indexOf(this);console.log("Showing context menu for "+this.name),docById("contextWheelDiv").style.position="absolute";var i=this.blocks.blockList[e].container.x,s=this.blocks.blockList[e].container.y,l=this.blocks.canvas.offsetLeft+28*this.blocks.getStageScale(),o=this.blocks.canvas.offsetTop+6*this.blocks.getStageScale();docById("contextWheelDiv").style.left=Math.round((i+this.blocks.stage.x)*this.blocks.getStageScale()+l)-150+"px",docById("contextWheelDiv").style.top=Math.round((s+this.blocks.stage.y)*this.blocks.getStageScale()+o)-150+"px",docById("contextWheelDiv").style.display="",labels=["imgsrc:header-icons/copy-button.svg","imgsrc:header-icons/paste-disabled-button.svg","imgsrc:header-icons/extract-button.svg","imgsrc:header-icons/empty-trash-button.svg","imgsrc:header-icons/cancel-button.svg"];var a=this.blocks.findTopBlock(e);if("action"===this.name&&labels.push("imgsrc:header-icons/save-blocks-button.svg"),this.name in BLOCKHELP){labels.push("imgsrc:header-icons/help-button.svg");var n=labels.length-1}else n=null;var r=new wheelnav("contextWheelDiv",null,250,250);r.colors=platformColor.wheelcolors,r.slicePathFunction=slicePath().DonutSlice,r.slicePathCustom=slicePath().DonutSliceCustomization(),r.slicePathCustom.minRadiusPercent=.2,r.slicePathCustom.maxRadiusPercent=.6,r.sliceSelectedPathCustom=r.slicePathCustom,r.sliceInitPathCustom=r.slicePathCustom,r.clickModeRotate=!1,r.initWheel(labels),r.createWheel(),r.navItems[0].setTooltip(_("Copy")),r.navItems[1].setTooltip(_("Paste")),r.navItems[2].setTooltip(_("Extract")),r.navItems[3].setTooltip(_("Move to trash")),r.navItems[4].setTooltip(_("Close")),"action"===this.blocks.blockList[a].name&&r.navItems[5].setTooltip(_("Save stack")),null!==n&&r.navItems[n].setTooltip(_("Help")),r.navItems[0].selected=!1,r.navItems[0].navigateFunction=function(){t.blocks.activeBlock=e,t.blocks.prepareStackForCopy(),r.navItems[1].setTitle("imgsrc:header-icons/paste-button.svg"),r.navItems[1].refreshNavItem(!0),r.refreshWheel()},r.navItems[1].navigateFunction=function(){t.blocks.pasteStack()},r.navItems[2].navigateFunction=function(){t.blocks.activeBlock=e,t.blocks.extract(),docById("contextWheelDiv").style.display="none"},r.navItems[3].navigateFunction=function(){t.blocks.activeBlock=e,t.blocks.extract(),t.blocks.sendStackToTrash(t.blocks.blockList[e]),docById("contextWheelDiv").style.display="none"},r.navItems[4].navigateFunction=function(){docById("contextWheelDiv").style.display="none"},"action"===this.name&&(r.navItems[5].navigateFunction=function(){console.log("CALLING saveStack"),t.blocks.activeBlock=e,t.blocks.prepareStackForCopy(),t.blocks.saveStack()}),null!==n&&(r.navItems[n].navigateFunction=function(){t.blocks.activeBlock=e,(new HelpWidget).init(c),docById("contextWheelDiv").style.display="none"}),setTimeout(function(){console.log("Setting stage click to false."),t.blocks.stageClick=!1},500)}):console.log("null protoblock sent to Block")}function $(){for(var t=new Array,e=0;e<arguments.length;e++){var i=arguments[e];if("string"==typeof i&&(i=docById(i)),1===arguments.length)return i;t.push(i)}return t}function _blockMakeBitmap(t,e,i){var s=new Image;s.onload=function(){var t=new createjs.Bitmap(s);e(t,i)},s.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t)))}function SVG(){this.init=function(){this._x=0,this._y=0,this._minX=1e4,this._minY=1e4,this._maxX=-1e4,this._maxY=-1e4,this._width=0,this._height=0,this.docks=[],this._scale=1,this._orientation=0,this._radius=8,this._strokeWidth=1,this._innies=[],this._outie=!1,this._innieX1=(9-this._strokeWidth)/2,this._innieY1=3,this._innieX2=(9-this._strokeWidth)/2,this._innieY2=(9-this._strokeWidth)/2,this._inniesSpacer=9,this._padding=this._innieY1+this._strokeWidth,this._slot=!0,this._cap=!1,this._tab=!0,this._bool=!1,this._slotX=10,this._slotY=2,this._tail=!1,this._porch=!1,this._porchX=this._innieX1+this._innieX2+4*this._strokeWidth,this._porchY=this._innieY2,this._expandX=30,this._expandX2=0,this._expandY=0,this._expandY2=0,this._clampCount=1,this._clampSlots=[1],this._slotSize=21,this._arm=!0,this._else=!1,this._draw_inniess=!0,this._fill="fill_color",this._stroke="stroke_color",this.margins=[0,0,0,0],this._fontSize=10,this._labelOffset=0},this.setFontSize=function(t){this._fontSize=t},this.setLabelOffset=function(t){this._labelOffset=t},this.setDrawInniess=function(t){this._draw_inniess=t},this.getWidth=function(){return this._width},this.getHeight=function(){return this._height},this.clearDocks=function(){this.docks=[]},this.setScale=function(t){this._scale=t},this.setOrientation=function(t){this._orientation=t},this.setClampCount=function(t){this._clampCount=t;var e=this._clampSlots.length;if(e<t)for(var i=0;i<t-e;i++)this._clampSlots.push(1)},this.setClampSlots=function(t,e){t>this._clampCount.length-1&&this.setClampCount(t+1),this._clampSlots[t]=e},this.setExpand=function(t,e,i,s){this._expandX=t,this._expandY=e,this._expandX2=i,this._expandY2=s},this.setstrokeWidth=function(t){this._strokeWidth=t,this._calc_porch_params()},this.setColors=function(t){this._fill=t[0],this._stroke=t[1]},this.setFillColor=function(t){this._fill=t},this.setStrokeColor=function(t){this._stroke=t},this.setInnies=function(t){for(var e=0;e<t.length;e++)this._innies.push(t[e])},this.setOutie=function(t){this._outie=t},this.setSlot=function(t){(this._slot=t)&&(this._cap=!1)},this.setCap=function(t){(this._cap=t)&&(this._slot=!1)},this.setTab=function(t){(this._tab=t)&&(this._tail=!1)},this.setTail=function(t){(this._tail=t)&&(this._tab=!1)},this.setPorch=function(t){this._porch=t},this.setBoolean=function(t){this._bool=t},this.setElse=function(t){this._else=t},this.setArm=function(t){this._arm=t},this._resetMinMax=function(){this._minX=1e4,this._minY=1e4,this._maxX=-1e4,this._maxY=-1e4},this._checkMinMax=function(){this._x<this._minX&&(this._minX=this._x),this._y<this._minY&&(this._minY=this._y),this._x>this._maxX&&(this._maxX=this._x),this._y>this._maxY&&(this._maxY=this._y)},this._calculateXY=function(){var t=this._strokeWidth/2,e=this._strokeWidth/2+this._radius;return this.margins[0]=t+this._strokeWidth+.5,this.margins[1]=this._strokeWidth+.5,this._outie&&(t+=this._innieX1+this._innieX2,this.margins[0]+=this._innieX1+this._innieX2),this._cap?(e+=3*this._slotY,this.margins[1]+=3*this._slotY):this._slot&&(this.margins[1]+=this._slotY),this.margins[0]*=this._scale,this.margins[1]*=this._scale,this.margins[0]=Math.floor(this.margins[0]),this.margins[1]=Math.floor(this.margins[1]),[t,e]},this._calculateWH=function(t){this._width=t?(this._maxX-this._minX+this._strokeWidth)*this._scale:(this._maxX-this._minX)*this._scale,0===this.margins[2]?this.margins[2]=(this._strokeWidth+.5)*this._scale:this.margins[2]=this._width-this.margins[2],this._height=t?(this._maxY-this._minY+this._strokeWidth)*this._scale:(this._maxY-this._minY)*this._scale,0===this.margins[3]?this._tab?this.margins[3]=(this._slotY+this._strokeWidth+.5)*this._scale:this.margins[3]=(2*this._slotY+this._strokeWidth+.5)*this._scale:this.margins[3]=this._height-this.margins[3],this.margins[2]=Math.floor(this.margins[2]+.5),this.margins[3]=Math.floor(this.margins[3]+.5)},this._newPath=function(t,e){return'<path d="m'+(this._x=t)+" "+(this._y=e)+" "},this._closePath=function(){return'z" '},this.text=function(t,e,i,s,l,o){switch(this._x=t,this._y=e,this._checkMinMax(),this._x=t+s,this._y=e-i,this._checkMinMax(),l){case"left":case"start":var a="start";break;case"middle":case"center":a="middle";break;case"right":case"end":a="end"}for(var n=e,r=o.split("\n"),c='<text style="font-size:'+i+"px;fill:"+platformColor.blockText+";font-family:sans-serif;text-anchor:"+a+'">',h=0;h<r.length;h++)c+='<tspan x="'+Math.floor(t+.5)+'" y="'+Math.floor(n+.5)+'">'+r[h]+"</tspan>",n+=i;return c+="</text>"},this._lineTo=function(t,e){return this._checkMinMax(),this._x===t&&this._y===e?"":(this._x=t,this._y=e,this._checkMinMax(),"L "+t+" "+e+" ")},this._rLineTo=function(t,e){return 0===t&&0===e?"":this._lineTo(this._x+t,this._y+e)},this._arcTo=function(t,e,i,s,l,o){return this._checkMinMax(),0===i?this._lineTo(t,e):(this._x=t,this._y=e,this._checkMinMax(),"A "+i+" "+i+" "+s+" "+l+" "+o+" "+t+" "+e+" ")},this._rarcTo=function(t,e,i,s,l){if(0===this._radius)return"";var o=this._x+t*this._radius,a=this._y+e*this._radius;return this._arcTo(o,a,this._radius,i,s,l)},this._corner=function(t,e,i,s,l,o,a,n){var r="";if(0<this._radius){var c=this._radius/2;o&&(t*e==1?r+=this._rLineTo(t*c,0):n||(r+=this._rLineTo(0,e*c)));var h=this._x+t*c,u=this._y+e*c;r+=this._arcTo(h,u,c,i,s,l),a&&(t*e==1?r+=this._rLineTo(0,e*c):n||(r+=this._rLineTo(t*c,0)))}return r},this._iCorner=function(t,e,i,s,l,o,a){var n=this._strokeWidth+this._radius/2;if(o)if(t*e==-1)var r=this._rLineTo(t*(n-this._strokeWidth),0);else r=this._rLineTo(0,e*(n-this._strokeWidth));else r="";var c=this._x+t*n,h=this._y+e*n;return r+=this._arcTo(c,h,n,i,s,l),a&&(r+=t*e==-1?this._rLineTo(0,e*(n-this._strokeWidth)):this._rLineTo(t*(n-this._strokeWidth),0)),r},this._doInnie=function(){return this.docks.push([(this._x+this._strokeWidth)*this._scale,(this._y+this._innieY2)*this._scale]),0===this.margins[2]&&(this.margins[1]=(this._y-this._innieY1)*this._scale,this.margins[2]=(this._x-this._innieX1-this._innieX2-2*this._strokeWidth)*this._scale),this.margins[3]=(this._y+this._innieY2+this._innieY1)*this._scale,this._rLineTo(-this._innieX1,0)+this._rLineTo(0,-this._innieY1)+this._rLineTo(-this._innieX2,0)+this._rLineTo(0,this._innieY2+2*this._innieY1)+this._rLineTo(this._innieX2,0)+this._rLineTo(0,-this._innieY1)+this._rLineTo(this._innieX1,0)},this._doOutie=function(){return this._outie?(this.docks.unshift([this._x*this._scale,this._y*this._scale]),this._rLineTo(0,-this._strokeWidth)+this._rLineTo(-this._innieX1-2*this._strokeWidth,0)+this._rLineTo(0,this._innieY1)+this._rLineTo(-this._innieX2+2*this._strokeWidth,0)+this._rLineTo(0,-this._innieY2-2*this._innieY1+2*this._strokeWidth)+this._rLineTo(this._innieX2-2*this._strokeWidth,0)+this._rLineTo(0,this._innieY1)+this._rLineTo(this._innieX1+2*this._strokeWidth,0)+this._rLineTo(0,-this._strokeWidth)):this._rLineTo(0,-this._innieY2)},this._doSlot=function(){if(this._slot){var t=this._x+this._slotX/2;return this.docks.push([t*this._scale,this._y*this._scale]),this._rLineTo(0,this._slotY)+this._rLineTo(this._slotX,0)+this._rLineTo(0,-this._slotY)}if(this._cap){t=this._x+this._slotX/2;return this.docks.push([t*this._scale,this._y*this._scale]),this._rLineTo(this._slotX/2,3*-this._slotY)+this._rLineTo(this._slotX/2,3*this._slotY)}return this._rLineTo(this._slotX,0)},this._doTail=function(){if(this._outie)return this._rLineTo(-this._slotX,0);if(this._tail){var t=this._x+this._slotX/2;return this.docks.push([t*this._scale,this._y*this._scale]),this._rLineTo(-this._slotX/2,3*this._slotY)+this._rLineTo(-this._slotX/2,3*-this._slotY)}return this._rLineTo(-this._slotX,0)},this._doTab=function(){if(this._outie)return this._rLineTo(-this._slotX,0);var t=this._x-this._slotX/2;return this.docks.push([t*this._scale,(this._y+this._strokeWidth)*this._scale]),this._rLineTo(-this._strokeWidth,0)+this._rLineTo(0,this._slotY)+this._rLineTo(-this._slotX+2*this._strokeWidth,0)+this._rLineTo(0,-this._slotY)+this._rLineTo(-this._strokeWidth,0)},this._doPorch=function(t){return t?this._rLineTo(0,this._porchY+this._innieY1)+this._rLineTo(this._porchX-this._radius,0)+this._corner(1,1,90,0,1,!0,!0,!1):this._rLineTo(0,this._porchY-this._padding)+this._rLineTo(this._porchX-this._radius,0)+this._corner(1,1,90,0,1,!0,!0,!1)},this._startBoolean=function(t,e){var i=this._newPath(t,e);return this._radius-=this._strokeWidth,this.docks.push([this._x*this._scale,this._y*this._scale]),i+=this._rarcTo(1,-1,90,0,1),this._radius+=this._strokeWidth,i+=this._rLineTo(this._strokeWidth,0),i+=this._rLineTo(0,-this._expandY)},this._doBoolean=function(){return this.docks.push([(this._x-this._radius+this._strokeWidth)*this._scale,(this._y+this._radius)*this._scale]),this.margins[2]=(this._x-this._radius-this._strokeWidth)*this._scale,this._rarcTo(-1,1,90,0,0)+this._rarcTo(1,1,90,0,0)},this._endBoolean=function(t){if(t)e="";else var e=this._rLineTo(1.5*-this._radius,0);return e+=this._rLineTo(0,-this._strokeWidth),e+=this._rLineTo(-this._strokeWidth,0),this._radius-=this._strokeWidth,e+=this._rarcTo(-1,-1,90,0,1),this._radius+=this._strokeWidth,e+=this._closePath(),this._calculateWH(!0),e+=this._style()},this._header=function(t){var e=this._width+2*this._strokeWidth;return'<svg xmlns="http://www.w3.org/2000/svg" width="'+Math.floor(e+.5)+'" height="'+Math.floor(this._height+.5)+'">'+this._transform(t)+'<filter id="dropshadow" height="130%">   <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>   <feOffset dx="2" dy="2" result="offsetblur"/>   <feComponentTransfer xmlns="http://www.w3.org/2000/svg">     <feFuncA type="linear" slope="0.2"/>   </feComponentTransfer>   <feMerge>     <feMergeNode/>     <feMergeNode in="SourceGraphic"/>   </feMerge> </filter>'},this._transform=function(t){if(0!==this._orientation)var e=this._width/2,i=this._height/2,s='<g transform = "rotate('+this._orientation+" "+e+" "+i+')">';else s="";return t?'<g transform="translate('+-this._minX+", "+-this._minY+')">':'<g transform="scale('+this._scale+", "+this._scale+')">'+s},this._footer=function(){return 0!==this._orientation?"</g></g></svg>":"</g></svg>"},this._style=function(){return'style="fill:'+this._fill+";fill-opacity:1;stroke:"+this._stroke+";stroke-width:"+this._strokeWidth+';stroke-linecap:round;stroke-opacity:1;filter:url(#dropshadow);" />'},this.basicBlock=function(){this._resetMinMax();var t=this._calculateXY(),e=t[0],i=t[1];this.margins[2]=0,this.margins[3]=0;var s=this._newPath(e,i);if(s+=this._corner(1,-1,90,0,1,!0,!0,!1),s+=this._doSlot(),s+=this._rLineTo(this._expandX,0),xx=this._x,this._bool?(s+=this._rLineTo(3,0),s+=this._rLineTo(0,2)):s+=this._corner(1,1,90,0,1,!0,!0,!1),this._bool)s+=this._doBoolean();else if(0===this._innies.length)s+=this._rLineTo(0,this._padding);else for(var l=0;l<this._innies.length;l++)this._innies[l]&&(s+=this._doInnie()),0===l?s+=this._rLineTo(0,this._expandY):1===l&&0<this._expandY2&&(s+=this._rLineTo(0,this._expandY2)),0===l&&this._porch?s+=this._doPorch(!1):this._innies.length-1>l&&(s+=this._rLineTo(0,2*this._innieY2+this._inniesSpacer));this._bool?(s+=this._rLineTo(0,2),s+=this._rLineTo(-3,0)):s+=this._corner(-1,1,90,0,1,!0,!0,!1),s+=this._lineTo(xx,this._y),s+=this._rLineTo(-this._expandX,0),this._tab?s+=this._doTab():s+=this._doTail(),s+=this._corner(-1,-1,90,0,1,!0,!0,!1),s+=this._rLineTo(0,-this._expandY),-1!==this._innies.indexOf(!0)&&(s+=this._lineTo(e,this._radius+this._innieY2+this._strokeWidth/2),s+=this._doOutie()),this._calculateWH(!0),s+=this._closePath(),s+=this._style();var o=this._width-this._scale*(this._innieX1+this._innieX2)-4*this._strokeWidth+this._labelOffset*this._scale,a=this._height/2+this._fontSize/(5/this._scale),n=this._innies.length;if(2<n&&2*Math.round(n/2)!==n&&(a-=2*this._fontSize),s+=this.text(o/this._scale,a/this._scale,this._fontSize,this._width,"right","block_label"),this._slot||this._outie)var r=1;else r=0;var c=1;for(l=0;l<this._innies.length;l++)this._innies[l]&&(a=this.docks[r][1]-this._fontSize/(8/this._scale)+this._scale,s+=this.text(o/this._scale,a/this._scale,this._fontSize/1.5,this._width,"right","arg_label_"+c),c+=1,r+=1);return s+=this._footer(),this._header(!1)+s},this.basicBox=function(){this._resetMinMax(),this.setOutie(!0);var t=this._strokeWidth/2+this._innieX1+this._innieX2;this.margins[0]=(t+this._strokeWidth+.5)*this._scale,this.margins[1]=(this._strokeWidth+.5)*this._scale,this.margins[2]=0,this.margins[3]=0;var e=this._newPath(t,this._strokeWidth/2);e+=this._rLineTo(this._expandX,0),e+=this._rLineTo(0,2*this._radius+this._innieY2+this._expandY),e+=this._rLineTo(-this._expandX,0),e+=this._lineTo(t,this._radius+this._innieY2+this._strokeWidth/2),e+=this._doOutie(),e+=this._closePath(),this._calculateWH(!0),e+=this._style();var i=2*(this._innieX1+this._innieX2)+4*this._strokeWidth+this._labelOffset*this._scale,s=this._height/2+this._fontSize/2;return e+=this.text(i/this._scale,s/this._scale,this._fontSize,this._width,"left","block_label"),e+=this._footer(),this._header(!1)+e},this.booleanAndOr=function(){this._resetMinMax();var t=this._startBoolean(this._strokeWidth/2,5.5*this._radius+this._strokeWidth/2+this._innieY2+this._inniesSpacer+this._expandY);t+=this._rLineTo(0,3.5*-this._radius-this._innieY2-this._inniesSpacer-this._strokeWidth),t+=this._rarcTo(1,-1,90,0,1),t+=this._rLineTo(this._radius/2+this._expandX,0);var e=this._x;t+=this._rLineTo(0,this._radius/2),t+=this._doBoolean(),t+=this._rLineTo(0,1.5*this._radius+this._innieY2+this._inniesSpacer),t+=this._rLineTo(0,this._expandY),t+=this._doBoolean(),t+=this._rLineTo(0,this._radius/2),t+=this._lineTo(e,this._y),t+=this._rLineTo(-this._expandX,0),t+=this._endBoolean(!1),this.margins[0]=(this._radius+this._strokeWidth+.5)*this._scale,this.margins[1]=this._strokeWidth*this._scale,this.margins[2]=this._strokeWidth*this._scale,this.margins[3]=this._strokeWidth*this._scale;var i=this._width-this._scale*(this._innieX1+this._innieX2)-4*this._strokeWidth+this._labelOffset*this._scale,s=this._height/2+this._fontSize/2;return t+=this.text(i/this._scale,s/this._scale,this._fontSize,this._width,"right","block_label"),t+=this._footer(),this._header(!1)+t},this.booleanNot=function(t){if(this._resetMinMax(),this._innies[0])var e=this._startBoolean(this._strokeWidth/2,1.25*this._radius+this._strokeWidth/2);else if(t)e=this._startBoolean(this._strokeWidth/2,1.25*this._radius+this._strokeWidth/2);else var e=this._startBoolean(this._strokeWidth/2,2*this._radius+this._strokeWidth/2);e+=this._rLineTo(0,-this._strokeWidth),this._innies[0]?e+=this._rLineTo(0,-this._radius/4):e+=t?this._rLineTo(0,-this._radius/4):this._rarcTo(1,-1,90,0,1),e+=this._rLineTo(this._radius/2+this._expandX,0);var i=this._x;this._innies[0]?(e+=this._rLineTo(0,this._radius),e+=this._doInnie(),e+=this._rLineTo(0,this._radius)):t?e+=this._rLineTo(0,2*this._radius):(e+=this._rLineTo(0,this._radius/2),e+=this._doBoolean(),e+=this._rLineTo(0,this._radius/2)),e+=this._lineTo(i,this._y),0<this._expandY2&&(e+=this._rLineTo(0,this._expandY2)),this._innies[0]?(e+=this._rLineTo(-this._radius/2-this._expandX,0),e+=this._rLineTo(0,-this._radius/4)):e+=t?this._rLineTo(-this._radius/2-this._expandX,0):this._rLineTo(-this._expandX,0),0<this._expandY2&&!t?e+=this._rLineTo(0,-this._expandY2):t&&(e+=this._rLineTo(0,-2)),e+=this._endBoolean(t),t?(this.margins[0]=(this._radius+this._strokeWidth+.5)*this._scale,this.margins[2]=(this._radius+this._strokeWidth+.5)*this._scale):(this.margins[0]=(this._strokeWidth+.5)*this._scale,this.margins[2]=(this._strokeWidth+.5)*this._scale),this.margins[1]=this._strokeWidth*this._scale,this.margins[3]=this._strokeWidth*this._scale;var s=this._width-2*(this._innieX1+this._innieX2)-4*this._strokeWidth+this._labelOffset*this._scale,l=this._height/2+this._fontSize/2;return e+=this.text(s/this._scale,l/this._scale,this._fontSize,this._width,"right","block_label"),e+=this._footer(),this._header(!1)+e},this.booleanCompare=function(){this._resetMinMax();var t=2*this._radius+2*this._innieY2+this._inniesSpacer+this._strokeWidth/2+this._expandY,e=this._strokeWidth/2,i='<g transform="matrix(1,0,0,1,0,-'+2*this._radius+')"> ';i+=this._newPath(e,t+this._radius),this.docks.push([this._x*this._scale,(this._y-2*this._radius)*this._scale]),this._radius-=this._strokeWidth,i+=this._rarcTo(1,-1,90,0,1),this._radius+=this._strokeWidth,i+=this._rLineTo(this._strokeWidth,0),i+=this._rLineTo(0,-this._expandY),t=-2*this._innieY2-this._inniesSpacer-this._strokeWidth,i+=this._rLineTo(0,t+this._radius),i+=this._rarcTo(1,-1,90,0,1),i+=this._rLineTo(this._radius/2+this._expandX,0),i+=this._rLineTo(0,this._radius);var s=this._x;i+=this._doInnie(),this.docks[1][1]-=2*this._radius*this._scale,i+=this._rLineTo(0,this._expandY),this._porch?i+=this._doPorch(!1):i+=this._rLineTo(0,2*this._innieY2+this._inniesSpacer),i+=this._doInnie(),this.docks[2][1]-=2*this._radius*this._scale,i+=this._rLineTo(0,this._radius),i+=this._lineTo(s,this._y),i+=this._rLineTo(-this._expandX,0),i+=this._rLineTo(1.5*-this._radius,0),i+=this._rLineTo(0,-this._radius),i+=this._rLineTo(0,-this._strokeWidth),i+=this._rLineTo(-this._strokeWidth,0),this._radius-=this._strokeWidth,i+=this._rarcTo(-1,-1,90,0,1),this._radius+=this._strokeWidth,i+=this._closePath(),this._calculateWH(!0),i+=this._style(),i+="</g>",this.margins[0]=(this._radius+this._strokeWidth)*this._scale,this.margins[1]=this._strokeWidth*this._scale,this.margins[2]=this._strokeWidth*this._scale;var l=this._width-2*(this._innieX1+this._innieX2)-4*this._strokeWidth+this._labelOffset*this._scale,o=this._height/2+this._fontSize/2;return i+=this.text(l/this._scale,o/this._scale,this._fontSize,this._width,"right","block_label"),i+=this._footer(),this._header(!1)+i},this.basicClamp=function(){var t=this._cap,e=this._slot;if(this._resetMinMax(),this._outie)var i=this._strokeWidth/2+this._innieX1+this._innieX2;else i=this._strokeWidth/2;if(this._cap)var s=this._strokeWidth/2+this._radius+3*this._slotY;else s=this._strokeWidth/2+this._radius;this.margins[0]=(i+this._strokeWidth+.5)*this._scale,this.margins[1]=(this._strokeWidth+.5)*this._scale,this.margins[2]=0,this.margins[3]=0;var l=this._newPath(i,s);l+=this._corner(1,-1,90,0,1,!0,!0,!1),l+=this._doSlot(),this._cap&&(this._slot=!0,this._cap=!1),l+=this._rLineTo(this._radius+this._strokeWidth,0);var o=this._x;if(l+=this._rLineTo(this._expandX,0),l+=this._corner(1,1,90,0,1,!0,!0,!1),this._innies[0])for(var a=0;a<this._innies.length;a++)this._innies[a]&&(l+=this._doInnie()),0===a?l+=this._rLineTo(0,this._expandY):1===a&&0<this._expandY2&&(l+=this._rLineTo(0,this._expandY2)),0===a&&this._porch?l+=this._doPorch(!1):this._innies.length-1>a&&(l+=this._rLineTo(0,2*this._innieY2+this._inniesSpacer));else this._bool?(l+=this._rLineTo(0,2*this._padding+this._strokeWidth),l+=this._doBoolean()):l+=this._rLineTo(0,this._padding),this.margins[2]=(this._x-this._strokeWidth+.5)*this._scale;for(var n=0;n<this._clampCount;n++){0<n&&(l+=this._rLineTo(this._expandX,0),l+=this._rLineTo(0,3*this._padding)),l+=this._corner(-1,1,90,0,1,!0,!0,!1),l+=this._lineTo(o,this._y);var r=this._outie;if(this._outie=!1,l+=this._doTab(),this._outie=r,l+=this._iCorner(-1,1,90,0,0,!0,!0),l+=this._rLineTo(0,this._padding),1<this._clampSlots[n]){var c=this._slotSize*(this._clampSlots[n]-1);l+=this._rLineTo(0,c)}l+=this._rLineTo(0,this._expandY2),l+=this._iCorner(1,1,90,0,0,!0,!0);var h=this._slot;this._slot=!0,l+=this._doSlot(),this._slot=h,this.docks.pop(),l+=this._rLineTo(this._radius,0)}if(0<this._clampCount&&(l+=this._rLineTo(0,2*this._innieY1),l+=this._rLineTo(0,this._innieY1+3*this._strokeWidth)),l+=this._corner(-1,1,90,0,1,!0,!0,!1),0===this._clampCount&&(l+=this._lineTo(o,this._y)),l+=this._rLineTo(-this._radius-this._strokeWidth,0),this._tail?l+=this._doTail():l+=this._doTab(),this._cap=t,this._slot=e,l+=this._corner(-1,-1,90,0,1,!0,!0,!1),this._outie&&(l+=this._lineTo(i,this._radius+this._innieY2+this._strokeWidth/2),l+=this._doOutie()),l+=this._closePath(),this._calculateWH(!0),l+=this._style(),this._outie)var u=10*this._strokeWidth+this._innieX1+this._innieX2+this._labelOffset*this._scale;else u=8*this._strokeWidth+this._labelOffset*this._scale;if(this._cap)var d=(this._strokeWidth/2+this._radius+this._slotY)*this._scale;else if(1<this._innies.length){d=(this._strokeWidth/2+this._radius)*this._scale/2;d+=this._fontSize}else d=(this._strokeWidth/2+this._radius)*this._scale/2;if(d+=(this._fontSize+1)*this._scale,this._bool&&(d+=this._fontSize/2),l+=this.text(u/this._scale,d/this._scale,this._fontSize,this._width,"left","block_label"),this._bool){var f=1;for(u=this._width-this._radius,n=0;n<this._clampCount;n++)d=this.docks[n+2][1]-this._fontSize+3*this._strokeWidth,l+=this.text(u/this._scale,d/this._scale,this._fontSize/1.5,this._width,"right","arg_label_"+f),f+=1}if(this._slot||this._outie)var p=1;else p=0;for(f=1,u=this._width-this._scale*(this._innieX1+this._innieX2)-4*this._strokeWidth,a=0;a<this._innies.length;a++)this._innies[a]&&(d=this.docks[p][1]-this._fontSize/(8/this._scale)+this._scale,l+=this.text(u/this._scale,d/this._scale,this._fontSize/1.5,this._width,"right","arg_label_"+f),f+=1,p+=1);return l+=this._footer(),this._header(!1)+l},this.argClamp=function(){if(this._resetMinMax(),this._outie)var t=this._strokeWidth/2+this._innieX1+this._innieX2;else t=this._strokeWidth/2;var e=this._strokeWidth/2+this._radius;this.margins[0]=(t+this._strokeWidth+.5)*this._scale,this.margins[1]=(this._strokeWidth+.5)*this._scale,this.margins[2]=0,this.margins[3]=0;var i=this._newPath(t,e);i+=this._corner(1,-1,90,0,1,!0,!0,!1),i+=this._doSlot(),i+=this._rLineTo(this._radius+this._strokeWidth,0);var s=this._x;i+=this._rLineTo(this._expandX,0),i+=this._corner(1,1,90,0,1,!0,!0,!1),this._innies[0]?i+=this._doInnie():(i+=this._rLineTo(0,this._padding),this.margins[2]=(this._x-this._strokeWidth+.5)*this._scale),i+=this._corner(-1,1,90,0,1,!0,!0,!1),i+=this._lineTo(s,this._y),i+=this._iCorner(-1,1,90,0,0,!0,!0);var l=0;i+=this._doInnie(),0<(n=this._slotSize*(this._clampSlots[0][l]-1))&&(i+=this._rLineTo(0,n)),l+=1;for(var o=this._slotSize-this._innieY2,a=1;a<this._clampSlots[0].length;a++){var n;i+=this._rLineTo(0,o),i+=this._doInnie(),0<(n=this._slotSize*(this._clampSlots[0][l]-1))&&(i+=this._rLineTo(0,n)),l+=1}if(i+=this._rLineTo(0,this._expandY2),i+=this._iCorner(1,1,90,0,0,!0,!0),i+=this._rLineTo(this._radius,0),i+=this._rLineTo(0,2*this._innieY1),i+=this._rLineTo(0,this._innieY1+3*this._strokeWidth),i+=this._corner(-1,1,90,0,1,!0,!0,!1),i+=this._lineTo(s,this._y),i+=this._rLineTo(-this._radius-this._strokeWidth,0),this._tail?i+=this._doTail():i+=this._doTab(),i+=this._corner(-1,-1,90,0,1,!0,!0,!1),this._outie&&(i+=this._lineTo(t,this._radius+this._innieY2+this._strokeWidth/2),i+=this._doOutie()),i+=this._closePath(),this._calculateWH(!0),i+=this._style(),this._outie)var r=10*this._strokeWidth+this._innieX1+this._innieX2;else r=8*this._strokeWidth;if(this._cap)var c=(this._strokeWidth/2+this._radius+this._slotY)*this._scale;else c=(this._strokeWidth/2+this._radius)*this._scale/2;return c+=(this._fontSize+1)*this._scale,this._bool&&(c+=this._fontSize/2),i+=this.text(r/this._scale,c/this._scale,this._fontSize,this._width,"left","block_label"),i+=this._footer(),this._header(!1)+i},this.untilClamp=function(){this._resetMinMax();var t=this._strokeWidth/2,e=this._strokeWidth/2+this._radius;this.margins[0]=(t+this._strokeWidth+.5)*this._scale,this.margins[1]=(this._strokeWidth+.5)*this._scale,this.margins[2]=0,this.margins[3]=0;var i=this._newPath(t,e);i+=this._corner(1,-1,90,0,1,!0,!0,!1),i+=this._doSlot(),i+=this._rLineTo(this._radius+this._strokeWidth,0),i+=this._rLineTo(this._expandX,0);var s=this._x;i+=this._corner(1,1,90,0,1,!0,!0,!0),i+=this._rLineTo(0,2*this._innieY1),i+=this._corner(-1,1,90,0,1,!0,!0,!0),i+=this._lineTo(s,this._y),i+=this._rLineTo(-this._expandX,0),i+=this._doTab(),i+=this._iCorner(-1,1,90,0,0,!0,!0),i+=this._rLineTo(0,this._expandY),i+=this._iCorner(1,1,90,0,0,!0,!0),i+=this._doSlot(),this.docks.pop(),i+=this._rLineTo(this._radius,0),this._innies[0]?i+=this._doInnie():this.margins[2]=(this._x-this._strokeWidth+.5)*this._scale,i+=this._rLineTo(0,this._radius+this._expandY2),this._bool&&(i+=this._doBoolean()),i+=this._corner(-1,1,90,0,1,!0,!0,!1),i+=this._rLineTo(-this._radius-this._strokeWidth,0),i+=this._doTab(),i+=this._corner(-1,-1,90,0,1,!0,!0,!1),i+=this._closePath(),this._calculateWH(!0),i+=this._style();var l=4*this._strokeWidth,o=this.docks[2][1];if(i+=this.text(l/this._scale,o/this._scale,this._fontSize,this._width,"left","block_label"),this._bool){l=this._width-this._radius;o=this.docks[1][1]-this._fontSize,i+=this.text(l/this._scale,o/this._scale,this._fontSize/1.5,this._width,"right","arg_label_1")}if(this._bool){l=this.docks[1][0],o=this.docks[1][1];this.docks[1][0]=this.docks[2][0],this.docks[1][1]=this.docks[2][1],this.docks[2][0]=l,this.docks[2][1]=o}return i+=this._footer(),this._header(!1)+i},this.statusBlock=function(t){this._resetMinMax();var e=this._calculateXY(),i=e[0],s=e[1];this.margins[2]=0,this.margins[3]=0;var l=this._newPath(i,s);l+=this._corner(1,-1,90,0,1,!0,!0,!1),l+=this._rLineTo(this._expandX,0);var o=this._x;return l+=this._corner(1,1,90,0,1,!0,!0,!1),l+=this._rLineTo(0,this._expandY),l+=this._corner(-1,1,90,0,1,!0,!0,!1),l+=this._lineTo(o,this._y),l+=this._rLineTo(-this._expandX,0),l+=this._corner(-1,-1,90,0,1,!0,!0,!1),l+=this._rLineTo(0,-this._expandY),this._calculateWH(!0),l+=this._closePath(),l+=this._style(),l+=this._footer(),this._header(!1)+l}}window.hasMouse=!1,document.addEventListener("mousemove",function(t){window.hasMouse=!0});var MINIMUMDOCKDISTANCE=400,LONGSTACK=300,CAMERAVALUE="##__CAMERA__##",VIDEOVALUE="##__VIDEO__##",NOTEBLOCKS=["newnote","osctime"],PITCHBLOCKS=["pitch","steppitch","hertz","pitchnumber","scaledegree","playdrum"],MIDIOutput,guitarOutputHead,guitarOutputEnd;function Blocks(t){return sugarizerCompatibility.isInsideSugarizer()?storage=sugarizerCompatibility.data:storage=localStorage,this.canvas=null,this.stage=null,this.refreshCanvas=null,this.trashcan=null,this.updateStage=null,this.getStageScale=null,this.stageClick=!1,this.trashStacks=[],this.protoBlockDict={},this.blockList=[],this.blockArt={},this.blockCollapseArt={},this.mouseDownTime=0,this.longPressTimeout=null,this._pasteDX=0,this._pasteDY=0,this.selectedStack=null,this.selectedBlocksObj=null,this._loopCounter=0,this._sizeCounter=0,this._searchCounter=0,this.palettes=null,this.highlightedBlock=null,this.activeBlock=null,this.visible=!0,this.dragGroup=[],this.stackList=[],this._expandablesList=[],this._loadCounter=0,this._adjustTheseDocks=[],this.blocksToCollapse=[],this._checkTwoArgBlocks=[],this._checkArgClampBlocks=[],this.clampBlocksToCheck=[],this.noRunBlocks=[],this._homeButtonContainers=[],this.blockScale=DEFAULTBLOCKSCALE,this.inLongPress=!1,this.customTemperamentDefined=!1,this.deleteActionTimeout=0,this.getLongPressStatus=function(){return this.inLongPress},this.clearLongPress=function(){this.inLongPress=!1},this.setSetPlaybackStatus=function(t){return this.setPlaybackStatus=t,this},this.setCanvas=function(t){return this.canvas=t,this},this.setStage=function(t){return this.stage=t,this},this.setRefreshCanvas=function(t){return this.refreshCanvas=t,this},this.setTrashcan=function(t){return this.trashcan=t,this},this.setUpdateStage=function(t){return this.updateStage=t,this},this.setGetStageScale=function(t){return this.getStageScale=t,this},this.setBlockScale=function(t){console.log("New block scale is "+t),this.blockScale=t;for(var e=0;e<this.blockList.length;e++)this.blockList[e].resize(t);this.findStacks();for(var i=0;i<this.stackList.length;i++)this.adjustDocks(this.stackList[i],!0);for(e=0;e<this.blockList.length;e++)this.blockList[e].trash&&this.blockList[e].hide();for(var s in this.palettes.dict)for(e=0;e<this.palettes.dict[s].protoList.length;e++)this.palettes.dict[s].protoList[e].scale=t},this.setMsgText=function(t){this.msgText=t},this.setErrorMsg=function(t){return this.errorMsg=t,this},this.setMacroDictionary=function(t){return this.macroDict=t,this},this.setTurtles=function(t){return this.turtles=t,this},this.setLogo=function(t){return this.logo=t,this},this.setContextMenu=function(t){return this.contextMenu=t,this},this.setScale=function(t){return this},this.extract=function(){null!=this.activeBlock&&"rest2"!==this.blockList[this.activeBlock].name&&this._extractBlock(this.activeBlock,!0)},this._extractBlock=function(t,e){var i=this.blockList[t];if(-1===SPECIALINPUTS.indexOf(i.name)){var s=[];this.findNestedClampBlocks(t,s);var l=i.connections[0],o=last(i.connections);if(null!=l)var a=this.blockList[l].connections.indexOf(t);else a=null;i.connections[0]=null,(i.connections[i.connections.length-1]=null)!=l&&(this.blockList[l].connections[a]=o),null!=o&&(this.blockList[o].connections[0]=l),this.moveStackRelative(t,4*STANDARDBLOCKHEIGHT,0),this.blockMoved(t),e&&null!=l&&(this.blockMoved(l),this.adjustDocks(l,!0),0<s.length&&(this.clampBlocksToCheck=s,this.adjustExpandableClampBlock()))}else{if(null!=(l=i.connections[0])){a=this.blockList[l].connections.indexOf(t);this.blockList[l].connections[a]=null,i.connections[0]=null}this.moveStackRelative(t,4*STANDARDBLOCKHEIGHT,0),this.blockMoved(t)}},this.bottomMostBlock=function(){var t=-1e3;for(var e in this.blockList)if(this.blockList[e].container.y>t)t=this.blockList[e].container.y;return t},this.toggleCollapsibles=function(){var t=!0,e=!1;for(var i in this.blockList){"newnote"!==(s=this.blockList[i]).name&&"interval"!==s.name&&"osctime"!==s.name&&(-1===COLLAPSIBLES.indexOf(s.name)||s.trash||(s.collapsed?e=!0:t=!1))}if(t||!e)for(var i in this.blockList){"newnote"!==(s=this.blockList[i]).name&&"interval"!==s.name&&"osctime"!==s.name&&(-1===COLLAPSIBLES.indexOf(s.name)||s.trash||s.collapseToggle())}else for(var i in this.blockList){var s;"newnote"!==(s=this.blockList[i]).name&&"interval"!==s.name&&"osctime"!==s.name&&(-1===COLLAPSIBLES.indexOf(s.name)||s.trash||s.collapsed||s.collapseToggle())}},this.setHomeContainers=function(t,e){return this._setHomeButtonContainers=t,this.boundary=e,this},this._actionBlock=function(t){return-1!==["do","doArg","calc","calcArg"].indexOf(t)},this._namedActionBlock=function(t){return-1!==["nameddo","nameddoArg","namedcalc","namedcalcArg"].indexOf(t)},this._adjustBlockPositions=function(){this.dragGroup.length<2||this.adjustDocks(this.dragGroup[0],!0)},this.adjustExpandableClampBlock=function(){if(0!==this.clampBlocksToCheck.length){var a=this,t=this.clampBlocksToCheck.pop(),e=t[0],i=t[1],s=this.blockList[e];if(s.isArgFlowClampBlock());else{if(s.isArgBlock()||s.isTwoArgBlock())return;s.isArgClamp()&&this._adjustArgClampBlock([e])}!function(t,e,i){if(e.isArgFlowClampBlock())var s=1;else if(0===i)s=e.connections.length-2;else s=e.connections.length-3;var l=1;(a._sizeCounter=0)<s&&null!=e.connections[s]&&(this._sizeCounter=0,l=Math.max(a._getStackSize(e.connections[s]),1));var o=l-e.clampCount[i];0!=o&&(0===l&&1===e.clampCount[i]||e.updateSlots(i,o)),0<a.clampBlocksToCheck.length&&a.adjustExpandableClampBlock()}(0,s,i)}},this._getBlockSize=function(t){var e=this.blockList[t];return"newnote"!==e.name&&"interval"!==e.name&&"osctime"!==e.name||!e.collapsed?e.size:1},this._adjustArgClampBlock=function(t){if(0!==t.length){var e=t.pop(),i=this.blockList[e];if(-1!==["doArg","calcArg","makeblock"].indexOf(i.name))var s=2;else s=1;for(var l=i.argClampSlots,o=!1,a=0;a<l.length;a++){var n=i.connections[s+a],r=1;null!=n&&(r=Math.max(this._getBlockSize(n),1)),l[a]!==r&&(l[a]=r,o=!0)}o&&i.updateArgSlots(l)}},this._adjustExpandableTwoArgBlock=function(t){if(0!==t.length){var e=t.pop(),i=this.blockList[e],s=i.connections[1],l=1;null!=s&&(l=Math.max(this._getBlockSize(s),1));var o=l-i.clampCount[0];0!=o&&0!==l&&i.updateSlots(0,o)}},this._addRemoveVspaceBlock=function(t){var e=this.blockList[t],i=e.connections[e.connections.length-2],s=1;if(null!=i)s=Math.max(this._getBlockSize(i),1);var d=this,l=function t(e){var i=last(d.blockList[e].connections);return i&&"vspace"===d.blockList[i].name?1+t(i):0}(t);if(s<l+1)for(var o=Math.abs(s-l-1),a=0;a<o;a++){var n=e.connections.length-1,r=this.blockList[e.connections[n]],c=r.connections[1];null!=(e.connections[n]=c)&&(this.blockList[c].connections[0]=t),r.connections=[null,null],r.trash=!0,r.hide()}else if(l+1<s){o=s-l-1;var h=last(e.connections),u=e,f=this.blockList.length;d=this;this._makeNewBlockWithConnections("vspace",f,[null,null],function t(e){var i=e[0],s=e[1],l=e[2],o=e[3],a=e[4],n=d.blockList[l],r=last(i.docks),c=r[0]-n.docks[0][0],h=r[1]-n.docks[0][1];if(n.container.x=i.container.x+c,n.container.y=i.container.y+h,n.connections[0]=d.blockList.indexOf(i),n.connections[1]=s,i.connections[i.connections.length-1]=l,s&&(d.blockList[s].connections[0]=l),o+1<a){var u=d.blockList.length;s=last((i=last(d.blockList)).connections),d._makeNewBlockWithConnections("vspace",u,[null,null],t,[i,s,u,o+1,a])}},[u,h,f,0,o])}},this._getStackSize=function(t){var e=0;if(this._sizeCounter+=1,this._sizeCounter>2*this.blockList.length)return console.log("Infinite loop encountered detecting size of expandable block? "+t),e;if(null==t)return e;var i=this.blockList[t];if(null==i&&console.log("Something very broken in _getStackSize."),i.isClampBlock()){var s=0;if(0<(l=i.connections.length-2))null!=(o=i.connections[l])&&(s=this._getStackSize(o)),e=0===s?1:s;if(i.isDoubleClampBlock()){var l,o;s=0;if(0<(l=i.connections.length-3))null!=(o=i.connections[l])&&(s=this._getStackSize(o)),e+=0===s?1:s}e+=i.size}else e=i.size;-1!=this.blocksToCollapse.indexOf(t)?e=1:"newnote"!==i.name&&"interval"!==i.name&&"osctime"!==i.name||!i.collapsed||(e=1),1<i.connections.length&&(null!=(o=last(i.connections))&&(e+=this._getStackSize(o)));return e},this.adjustDocks=function(t,e){var i=this.blockList[t];if(null!=e&&(this._loopCounter=0),null!=i)if(null!=i.connections)if(0!==i.connections.length){if(1!==i.docks.length)if(this._loopCounter+=1,this._loopCounter>2*this.blockList.length)console.log("Infinite loop encountered while adjusting docks: "+t+" "+this.blockList);else{if(i.isTwoArgBooleanBlock())var s=0;else if(i.isInlineCollapsible()&&i.collapsed)s=i.connections.length-1;else s=1;for(var l=s;l<i.connections.length;l++){var o=i.docks[l],a=i.connections[l];if(null!==a)if(null!==this.blockList[a]){for(var n=!1,r=0;r<this.blockList[a].connections.length;r++)if(this.blockList[a].connections[r]===t){n=!0;break}if(!n){console.log("Did not find match for "+i.name+" ("+t+") and "+this.blockList[a].name+" ("+a+")"),console.log(i.connections),console.log(this.blockList[a].connections);break}var c=this.blockList[a].docks[r];if(0<l){var h=o[0]-c[0];if(i.isInlineCollapsible()&&i.collapsed)var u=i.docks.length,d=i.docks[u-1][1]-i.docks[u-2][1],f=o[1]-d-c[1];else f=o[1]-c[1];if(null==i.container)console.log("Does this ever happen any more?");else var p=i.container.x+h,b=i.container.y+f;this._moveBlock(a,p,b)}else{h=c[0]-o[0],f=c[1]-o[1],p=this.blockList[a].container.x+h,b=this.blockList[a].container.y+f;this._moveBlock(t,p,b)}0<l&&this.adjustDocks(a,!0)}else console.log("This is not good: we encountered a null block: "+a)}}}else console.log("Saw a block with [] connections: "+t);else console.log("Saw a block with null connections: "+t);else console.log("Saw a null block: "+t)},this.addDefaultBlock=function(t,e,r){if(null!=t)if("action"===this.blockList[t].name){if(null==(s=this.blockList[t].connections[1])){var c=this,i=function(t){var e=t[0],i=t[1],s=c.blockList.length-1;c.blockList[e].connections[1]=s,c.blockList[s].value=c.findUniqueActionName(_("action"));var l=c.blockList[s].value;if(getTextWidth(l,"bold 20pt Sans")>TEXTWIDTH&&(l=l.substr(0,STRINGLEN)+"..."),c.blockList[s].text.text=l,c.blockList[s].container.updateCache(),c.blockList[s].value!==c.blockList[i].value){c.newNameddoBlock(c.blockList[s].value,c.actionHasReturn(e),c.actionHasArgs(e));for(var o=c.palettes.dict.action,a=0;a<o.protoList.length;a++){var n=o.protoList[a];if("nameddo"===n.name&&n.defaults[0]===c.blockList[i].value){setTimeout(function(){o.remove(n,c.blockList[i].value),delete c.protoBlockDict["myDo_"+c.blockList[i].value],c.palettes.updatePalettes("action")},50);break}}c.renameNameddos(c.blockList[i].value,c.blockList[s].value),r?c.renameDos(c.blockList[i].value,c.blockList[s].value,i):c.renameDos(c.blockList[i].value,c.blockList[s].value)}c.adjustDocks(e,!0)};this._makeNewBlockWithConnections("text",0,[t],i,[t,e])}}else if("storein"===this.blockList[t].name){if(null==(s=this.blockList[t].connections[1])){c=this,i=function(t){var e=t[0],i=(t[1],c.blockList.length-1);c.blockList[e].connections[1]=i,c.blockList[i].value=_("box");var s=c.blockList[i].value;getTextWidth(s,"bold 20pt Sans")>TEXTWIDTH&&(s=s.substr(0,STRINGLEN)+"..."),c.blockList[i].text.text=s,c.blockList[i].container.updateCache(),c.adjustDocks(e,!0)};this._makeNewBlockWithConnections("text",0,[t],i,[t,e])}}else if(-1!==NOTEBLOCKS.indexOf(this.blockList[t].name)){var s;if(null==(s=this.blockList[t].connections[2])){var l="vspace",o=this.makeBlock(l,"__NOARG__");this.blockList[t].connections[2]=o,this.blockList[o].connections[0]=t;l="rest2";var a=this.makeBlock(l,"__NOARG__");this.blockList[a].connections[0]=o,this.blockList[a].connections[1]=null,this.blockList[o].connections[1]=a}else if("vspace"===this.blockList[s].name&&null==this.blockList[s].connections[1]){l="rest2",a=this.makeBlock(l,"__NOARG__");this.blockList[a].connections[0]=s,this.blockList[a].connections[1]=null,this.blockList[s].connections[1]=a}}},this._deletePitchBlocks=function(t){null===(i=this.blockList[t].connections[0])&&console.log("Silence block was not inside a note block");for(var e=0;-1===NOTEBLOCKS.indexOf(this.blockList[i].name);){var i;if(t=i,null===(i=this.blockList[i].connections[0])){console.log("Silence block was not inside a note block");break}if((e+=1)>this.blockList.length){console.log("Connection loop???");break}}for(e=0;null!=t;){if(this.blockList[t].connections.length<2){console.log("value block encountered??? "+t);break}var s=last(this.blockList[t].connections);if(-1!==PITCHBLOCKS.indexOf(this.blockList[t].name))this._extractBlock(t,!1);else if(-1!==["flat","sharp"].indexOf(this.blockList[t].name)){var l=this.blockList[t].connections[1];this._blockInStack(l,PITCHBLOCKS)&&this._extractBlock(t,!1)}if(t=s,(e+=1)>this.blockList.length){console.log("Connection loop???");break}}},this.deleteNextDefault=function(t){var e;if(null!=t&&"vspace"!==(e=this.blockList[t]).name)if("rest2"===(e=this.blockList[t]).name)this._deletePitchBlocks(t);else{if(e&&1===e.connections.length)return void console.log("Value block encountered? "+e.name);for(;null!=last(e.connections);){var i=e.connections.length-1,s=e.connections[i];if("rest2"===this.blockList[s].name){var l=s,o=this.blockList[l];o.hide(),o.trash=!0,e.connections[i]=o.connections[1];break}e=this.blockList[s]}}},this.deletePreviousDefault=function(t){var e=this.blockList[t];if(this._blockInStack(t,["rest2"]))return this._deletePitchBlocks(t),this.blockList[t].connections[0];for(;null!=e.connections[0];){var i=e.connections[0];if(-1!==NOTEBLOCKS.indexOf(this.blockList[i].name))break;if("rest2"===this.blockList[i].name){var s=i,l=this.blockList[s];l.hide(),l.trash=!0;for(var o=0;o<this.blockList[l.connections[0]].connections.length;o++)if(this.blockList[l.connections[0]].connections[o]===s){this.blockList[l.connections[0]].connections[o]=this.blockList.indexOf(e);break}e.connections[0]=l.connections[0];break}e=this.blockList[i]}return e.connections[0]},this.blockMoved=function(t){if(this.clampBlocksToCheck=[],null!=t){var e=0,i=null;null!=(E=this.insideExpandableBlock(t))&&(i=E);for(var s=!1;null!=E;){if((e+=1)>2*this.blockList.length){console.log("Infinite loop encountered checking for expandables?");break}this.clampBlocksToCheck.push([E,0]),E=this.insideExpandableBlock(E)}this._checkTwoArgBlocks=[];var l=[],o=this.blockList[t];if(null!=o){if(null!=(x=o.connections[0]))var a=this.blockList[x];if(o.isArgBlock()&&null!=x&&(this.blockList[x].isTwoArgBlock()||this.blockList[x].isArgClamp()?a.connections[1]===t&&this._checkTwoArgBlocks.push(x):(this.blockList[x].isArgBlock()&&this.blockList[x].isExpandableBlock()||this.blockList[x].isArgClamp())&&a.connections[1]===t&&this._checkTwoArgBlocks.push(x)),null!=x){for(var n=1;n<a.connections.length;n++)if(a.connections[n]===t){a.connections[n]=null;break}o.connections[0]=null,this.raiseStackToTop(t)}var r=o.container.x+o.docks[0][0],c=o.container.y+o.docks[0][1],h=null,u=null,d=MINIMUMDOCKDISTANCE/DEFAULTBLOCKSCALE*this.blockScale,f=o.docks[0][2],p=!0;console.log("moving "+this.blockList[t].name);for(var b=0;b<this.blockList.length;b++)if(b!==t&&!this.blockList[b].inCollapsed&&!(-1!==COLLAPSIBLES.indexOf(this.blockList[b].name)&&-1===INLINECOLLAPSIBLES.indexOf(this.blockList[b].name)&&this.blockList[b].collapsed||this.blockList[b].trash)){if(this.blockList[b].isInlineCollapsible()&&this.blockList[b].collapsed)var m=this.blockList[b].connections.length-1;else m=1;for(n=m;n<this.blockList[b].connections.length&&n!==this.blockList[b].docks.length;n++)if((n!==this.blockList[b].connections.length-1||null==this.blockList[b].connections[n]||!this.blockList[this.blockList[b].connections[n]].isNoHitBlock())&&(-1===["backward","status"].indexOf(this.blockList[b].name)||1!==n||null==this.blockList[b].connections[1]||!this.blockList[this.blockList[b].connections[1]].isNoHitBlock())&&("action"!==this.blockList[b].name||2!==n||null==this.blockList[b].connections[2]||!this.blockList[this.blockList[b].connections[2]].isNoHitBlock())&&this._testConnectionType(f,this.blockList[b].docks[n][2])){var g=this.blockList[b].container.x+this.blockList[b].docks[n][0],k=this.blockList[b].container.y+this.blockList[b].docks[n][1],v=(g-r)*(g-r)+(k-c)*(k-c);v<d&&(h=b,u=n,d=v)}}if(null!=h){var y=this._countBlocksInStack(this.findTopBlock(h));LONGSTACK<y&&this.errorMsg(_("Consider breaking this stack into parts.")),o.connections[0]=h;var T=this.blockList[h].connections[u];if(null==T){if(this.blockList[h].isArgClamp())if(-1!==["doArg","calcArg","makeblock"].indexOf(this.blockList[h].name)&&1===u);else if(-1!==["doArg","nameddoArg"].indexOf(this.blockList[h].name)&&u===this.blockList[h].connections.length-1);else{var L=this._getBlockSize(t),w=this.blockList[h].argClampSlots;if(-1!==["doArg","calcArg","makeblock"].indexOf(this.blockList[h].name))var B=u-2;else B=u-1;w[B]!==L&&(w[B]=L,this.blockList[h].updateArgSlots(w))}}else if(p=!1,this.blockList[h].isArgClamp())if(-1!==["doArg","calcArg","makeblock"].indexOf(this.blockList[h].name)&&1===u){this.blockList[T].connections[0]=null,this.findDragGroup(T);for(var x=0;x<this.dragGroup.length;x++)this.moveBlockRelative(this.dragGroup[x],40,40)}else if(-1!==["doArg","nameddoArg"].indexOf(this.blockList[h].name)&&u===this.blockList[h].connections.length-1){var S=this.findBottomBlock(t);this.blockList[T].connections[0]=S,this.blockList[S].connections[this.blockList[S].connections.length-1]=T}else{L=this._getBlockSize(t),w=this.blockList[h].argClampSlots;var C=this.blockList[h].connections.indexOf(T);if(-1!==["doArg","calcArg","makeblock"].indexOf(this.blockList[h].name))B=C-2;else B=C-1;var A=null,N=null;for(A=B;A<w.length;A++)if(null==this.blockList[h].connections[C+A-B]){N=C+A-B;break}if(null==N){w.push(1),"makeblock"!==this.blockList[h].name&&this._newLocalArgBlock(w.length),N=C+A-B,this.blockList[h].connections.push(null);for(n=w.length-1;B+1<n;n--)w[n]=w[n-1];for(n=this.blockList[h].connections.length-1;C+1<n;n--)this.blockList[h].connections[n]=this.blockList[h].connections[n-1]}u+=1,w[B+1]=L,this.blockList[h].updateArgSlots(w)}else if(o.isArgBlock()){if(this.blockList[T].connections[0]=null,"number"===this.blockList[T].name)this.sendStackToTrash(this.blockList[T]);else{this.findDragGroup(T);for(x=0;x<this.dragGroup.length;x++)this.moveBlockRelative(this.dragGroup[x],40,40)}if("action"===this.blockList[h].name){if(s=!0,o.value!==this.blockList[T].value){x=o.connections[0];o.connections[0]=null;var P=this.findUniqueActionName(o.value);if(o.connections[0]=x,P!==o.value)getTextWidth(M=o.value=P,"bold 20pt Sans")>TEXTWIDTH&&(M=M.substr(0,STRINGLEN)+"..."),o.text.text=M,o.container.updateCache();var I=this;setTimeout(function(){var t=I.blockList[T].value;null!=I.protoBlockDict["myDo_"+t]&&(delete I.protoBlockDict["myDo_"+t],I.palettes.dict.action.hideMenu(!0)),I.newNameddoBlock(o.value,I.actionHasReturn(h),I.actionHasArgs(h));for(var e=I.palettes.dict.action,i=0;i<e.protoList.length;i++){var s=e.protoList[i];if("nameddo"===s.name&&s.staticLabels[0]===I.blockList[T].value){setTimeout(function(){e.remove(s,I.blockList[T].value),delete I.protoBlockDict["myDo_"+I.blockList[T].value],I.palettes.hide(),I.palettes.updatePalettes("action"),setTimeout(function(){I.palettes.show()},500)},50);break}}I.renameNameddos(I.blockList[T].value,o.value),I.renameDos(I.blockList[T].value,o.value)},75)}}else if("storein"===this.blockList[h].name&&1===u&&"box"!==o.value){this.newStoreinBlock(o.value),this.newStorein2Block(o.value),this.newNamedboxBlock(o.value);I=this;setTimeout(function(){I.palettes.updatePalettes("boxes")},50)}}else if(!this.blockList[t].isArgFlowClampBlock()){S=this.findBottomBlock(t);this.blockList[T].connections[0]=S,this.blockList[S].connections[this.blockList[S].connections.length-1]=T}if(this.blockList[h].connections[u]=t,null!=this._insideNoteBlock(t)&&1<this.blockList[t].connections.length&&(p?h=this.deletePreviousDefault(t):S&&this.deleteNextDefault(S)),"action"===this.blockList[h].name&&!s)for(b=0;b<this.blockList.length;b++){var M;if(b!==h)if("action"===this.blockList[b].name)if(null!=this.blockList[b].connections[1])if(this.blockList[this.blockList[b].connections[1]].value===this.blockList[t].value)this.blockList[t].value=this.findUniqueActionName(this.blockList[t].value),getTextWidth(M=this.blockList[t].value,"bold 20pt Sans")>TEXTWIDTH&&(M=M.substr(0,STRINGLEN)+"..."),this.blockList[t].text.text=M,this.blockList[t].container.updateCache(),this.newNameddoBlock(this.blockList[t].value,this.actionHasReturn(b),this.actionHasArgs(b)),this.setActionProtoVisiblity(!1)}this.adjustDocks(h,!0)}if((o.isArgBlock()||-1!==["calcArg","namedcalcArg","makeblock"].indexOf(o.name))&&null!=h){this.blockList[h].isTwoArgBlock()?this.blockList[h].connections[1]===t&&-1===this._checkTwoArgBlocks.indexOf(h)&&this._checkTwoArgBlocks.push(h):this.blockList[h].isArgBlock()&&this.blockList[h].isExpandableBlock()&&this.blockList[h].connections[1]===t&&-1===this._checkTwoArgBlocks.indexOf(h)&&this._checkTwoArgBlocks.push(h);y=this.blockList[h].connections.length;this.blockList[h].connections[y-2]===t&&(this.blockList[h].isArgClamp()||"in"!==this.blockList[h].docks[y-1][2]||l.push(h))}if(this.addDefaultBlock(i,t,s),0<l.length)for(n=0;n<l.length;n++)this._addRemoveVspaceBlock(l[n]);0<this._checkTwoArgBlocks.length&&this._adjustExpandableTwoArgBlock(this._checkTwoArgBlocks);for(n=0;n<l.length;n++)this.adjustDocks(l[n],!0);var E=this.insideExpandableBlock(t);for(e=0;null!=E;){if((e+=1)>2*this.blockList.length){console.log("Infinite loop checking for expandables?"),console.log(this.blockList);break}"ifthenelse"===this.blockList[E].name?(this.clampBlocksToCheck.push([E,0]),this.clampBlocksToCheck.push([E,1])):this.clampBlocksToCheck.push([E,0]),E=this.insideExpandableBlock(E)}this.adjustExpandableClampBlock(),this.refreshCanvas()}else console.log("null block found in blockMoved method: "+t)}else console.log("blockMoved called with null block.")},this._testConnectionType=function(t,e){return"in"===t&&"out"===e||("out"===t&&"in"===e||("numberin"===t&&-1!==["numberout","anyout"].indexOf(e)||(-1!==["numberout","anyout"].indexOf(t)&&"numberin"===e||("textin"===t&&-1!==["textout","anyout"].indexOf(e)||(-1!==["textout","anyout"].indexOf(t)&&"textin"===e||("booleanout"===t&&"booleanin"===e||("booleanin"===t&&"booleanout"===e||("mediain"===t&&"mediaout"===e||("mediaout"===t&&"mediain"===e||("mediain"===t&&"textout"===e||("mediain"===e&&"textout"===t||("filein"===t&&"fileout"===e||("fileout"===t&&"filein"===e||("solfegein"===t&&-1!==["anyout","solfegeout","textout","noteout","numberout"].indexOf(e)||("solfegein"===e&&-1!==["anyout","solfegeout","textout","noteout","numberout"].indexOf(t)||("notein"===t&&-1!==["solfegeout","textout","noteout"].indexOf(e)||("notein"===e&&-1!==["solfegeout","textout","noteout"].indexOf(t)||("anyin"===t&&-1!==["textout","mediaout","numberout","anyout","fileout","solfegeout","noteout"].indexOf(e)||"anyin"===e&&-1!==["textout","mediaout","numberout","anyout","fileout","solfegeout","noteout"].indexOf(t)))))))))))))))))))},this.updateBlockPositions=function(){for(var t=0;t<this.blockList.length;t++)this._moveBlock(t,this.blockList[t].container.x,this.blockList[t].container.y)},this.bringToTop=function(){for(var t in this._adjustTheseStacks=[],this.blockList){null==this.blockList[t].connections[0]&&this._adjustTheseStacks.push(t)}for(t=0;t<this._adjustTheseStacks.length;t++)this.raiseStackToTop(this._adjustTheseStacks[t]);this.refreshCanvas()},this.checkBounds=function(){for(var t=!0,e=0;e<this.blockList.length;e++)if(null==this.blockList[e].connections[0]&&this.blockList[e].offScreen(this.boundary)){this._setHomeButtonContainers(!0,!1),t=!1;break}t&&(this._setHomeButtonContainers(!1,!0),this.boundary.hide())},this.moveBlock=function(t,e,i){this._moveBlock(t,e,i),this.adjustDocks(t,!0)},this._moveBlock=function(t,e,i){var s=this.blockList[t];null!=s.container?(s.container.x=Math.floor(e+.5),s.container.y=Math.floor(i+.5),this.checkBounds()):console.log("No container yet for block "+s.name)},this.moveBlockRelative=function(t,e,i){this.inLongPress=!1;var s=this.blockList[t];null!=s.container?(s.container.x+=e,s.container.y+=i,this.checkBounds()):console.log("No container yet for block "+s.name)},this.moveStackRelative=function(t,e,i){if(this.findDragGroup(t),0<this.dragGroup.length)for(var s=0;s<this.dragGroup.length;s++)this.moveBlockRelative(this.dragGroup[s],e,i)},this.updateBlockText=function(t){var e=this.blockList[t],i=8;if(null!=e.text){switch(e.name){case"loadFile":try{var s=e.value[0].toString()}catch(t){s=_("open file")}i=10;break;case"solfege":s=i18nSolfege((o=splitSolfege(e.value))[0]);""!==(l=o[1])&&(s+=l);break;case"customNote":s=_(e.value);break;case"eastindiansolfege":var l,o=splitSolfege(e.value);s=WESTERN2EISOLFEGENAMES[o[0]];""!==(l=o[1])&&(s+=l);break;case"modename":s=_(e.value);break;case"accidentalname":case"intervalname":s=_((o=e.value.split(" "))[0])+" "+o[1];break;case"filtertype":case"drumname":case"effectsname":case"voicename":case"oscillatortype":case"invertmode":s=_(e.value);break;case"noisename":s=getNoiseName(e.value);break;case"temperamentname":s=_(TEMPERAMENTS[0][1]);for(var a=0;a<TEMPERAMENTS.length;a++)if(TEMPERAMENTS[a][1]===e.value){s=0===TEMPERAMENTS[a][0].length?TEMPERAMENTS[a][2]:TEMPERAMENTS[a][0];break}break;case"boolean":if(e.value)s=_("true");else s=_("false");break;default:if(null==e.value)s="";else if("string"!=typeof e.value)s=e.value.toString();else s=e.value}-1===WIDENAMES.indexOf(e.name)&&s.length>i&&(s=s.substr(0,i-1)+"..."),e.text.text=s;var n=e.container.children.length-1;e.container.setChildIndex(e.text,n),e.loadComplete?e.container.updateCache():console.log("Load not yet complete for ("+t+") "+e.name)}},this.findTopBlock=function(t){if(null==t)return null;var e=this.blockList[t];if(null==e.connections)return t;if(0===e.connections.length)return t;if(1<e.connections.length&&null!=e.connections[0]&&e.connections[0]===last(e.connections))return console.log("WARNING: CORRUPTED BLOCK DATA. Block "+e.name+" ("+t+") is connected to the same block "+this.blockList[e.connections[0]].name+" ("+e.connections[0]+") twice."),t;for(var i=0;null!=e.connections[0];){if((i+=1)>2*this.blockList.length){console.log("infinite loop finding topBlock?"),console.log(this.blockList.indexOf(e)+" "+e.name);break}t=e.connections[0],e=this.blockList[t]}return t},this.sameGeneration=function(t,e){if(null==t||null==e)return!1;if(t===e)return!0;var i=this.blockList[t];if(null==i.connections)return!1;if(0===i.connections.length)return!1;for(var s=0;null!=last(i.connections);){if((s+=1)>2*this.blockList.length){console.log("infinite loop finding bottomBlock?");break}if(blk=last(i.connections),i=this.blockList[blk],blk===e)return!0}return!1},this._blockInStack=function(t,e){for(var i=0;null!=t;){if(-1!==e.indexOf(this.blockList[t].name))return!0;if(t=1<this.blockList[t].connections.length?last(this.blockList[t].connections):null,(i+=1)>this.blockList.length){console.log("infinite loop finding block name in stack");break}}return!1},this.findBottomBlock=function(t){if(null==t)return null;var e=this.blockList[t];if(null==e.connections)return t;if(0===e.connections.length)return t;for(var i=0;null!=last(e.connections);){if((i+=1)>2*this.blockList.length){console.log("infinite loop finding bottomBlock?");break}t=last(e.connections),e=this.blockList[t]}return t},this._countBlocksInStack=function(t){var e=0;if(null!==t){e+=1;for(var i=1;i<this.blockList[t].connections.length;i++)e+=this._countBlocksInStack(this.blockList[t].connections[i])}return e},this.findStacks=function(){this.stackList=[];for(var t=0;t<this.blockList.length;t++)null==this.blockList[t].connections[0]&&this.stackList.push(t)},this._findClamps=function(){this._expandablesList=[],this.findStacks();for(var t=0;t<this.stackList.length;t++)this._searchCounter=0,this._searchForExpandables(this.stackList[t]);this._searchForArgFlow()},this._findTwoArgs=function(){this._expandablesList=[];for(var t=0;t<this.blockList.length;t++)this.blockList[t].isArgBlock()&&this.blockList[t].isExpandableBlock()?this._expandablesList.push(t):this.blockList[t].isTwoArgBlock()&&this._expandablesList.push(t)},this._searchForArgFlow=function(){for(var t=0;t<this.blockList.length;t++)this.blockList[t].isArgFlowClampBlock()&&(this._searchCounter=0,this._searchForExpandables(t),this._expandablesList.push(t))},this._searchForExpandables=function(t){for(;null!=t&&null!=this.blockList[t]&&!this.blockList[t].isValueBlock();){if(this._searchCounter+=1,this._searchCounter>2*this.blockList.length){console.log("infinite loop searching for Expandables? "+this._searchCounter),console.log(t+" "+this.blockList[t].name);break}if(this.blockList[t].isClampBlock()){this._expandablesList.push(t);var e=this.blockList[t].connections.length-2;if(this._searchForExpandables(this.blockList[t].connections[e]),"ifthenelse"===this.blockList[t].name){e=2;this._searchForExpandables(this.blockList[t].connections[e])}}else this.blockList[t].isArgClamp()&&this._expandablesList.push(t);t=1<this.blockList[t].connections.length?last(this.blockList[t].connections):null}},this._expandTwoArgs=function(){this._findTwoArgs(),this._adjustExpandableTwoArgBlock(this._expandablesList),this.refreshCanvas()},this._expandClamps=function(){this._findClamps(),this.clampBlocksToCheck=[];for(var t=0;t<this._expandablesList.length;t++)"ifthenelse"===this.blockList[this._expandablesList[t]].name?(this.clampBlocksToCheck.push([this._expandablesList[t],0]),this.clampBlocksToCheck.push([this._expandablesList[t],1])):this.clampBlocksToCheck.push([this._expandablesList[t],0]);this.adjustExpandableClampBlock(),this.refreshCanvas()},this.changeDisabledStatus=function(t,e){for(var i in this.blockList){var s=this.blockList[i];s.name===t&&(s.protoblock.disabled=e,s.regenerateArtwork(!1))}},this.unhighlightAll=function(){for(var t in this.blockList)this.unhighlight(t)},this.unhighlight=function(t){if(this.visible){if(null!=t)var e=t;else e=this.highlightedBlock;null!=e&&this.blockList[e].unhighlight(),(this.highlightedBlock=e)&&(this.highlightedBlock=null)}},this.highlight=function(t,e){this.visible&&null!=t&&(e&&this.unhighlight(null),this.blockList[t].highlight(),this.highlightedBlock=t)},this.hide=function(){for(var t in this.blockList)this.blockList[t].hide();this.visible=!1},this.show=function(){for(var t in this.blockList)this.blockList[t].show();this.visible=!0},this._makeNewBlockWithConnections=function(t,e,i,s,l){if("undefined"==typeof collapsed&&(collapsed=!1),myBlock=this.makeNewBlock(t,s,l),null!=myBlock)for(var o=0;o<i.length&&o!==myBlock.docks.length;o++)null==i[o]?myBlock.connections.push(null):myBlock.connections.push(i[o]+e);else console.log("could not make block "+t)},this.makeNewBlock=function(t,e,i){if(!t in this.protoBlockDict)return console.log("makeNewBlock: no prototype for "+t),null;if(null==this.protoBlockDict[t])return console.log("makeNewBlock: no prototype for "+t),null;if(-1!==["sine","sawtooth","triangle","square"].indexOf(t)&&_THIS_IS_MUSIC_BLOCKS_&&this.logo.synth.loadSynth(0,t),-1!==["namedbox","nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(t)?this.blockList.push(new Block(this.protoBlockDict[t],this,i[1])):"namedarg"===t?this.blockList.push(new Block(this.protoBlockDict[t],this,"arg "+i[1])):this.blockList.push(new Block(this.protoBlockDict[t],this)),null==last(this.blockList))return console.log("failed to make protoblock for "+t),null;var s=last(this.blockList);return s.copySize(),s.postProcess=e,s.postProcessArg=i,s.container=new createjs.Container,this.stage.addChild(s.container),s.container.snapToPixelEnabled=!0,s.container.x=0,s.container.y=0,s.imageLoad(),s},this.makeBlock=function(t,e){var i=function(t){var e=t[0],i=t[1];switch(l.blockList[e].value=i,l.blockList[e].name){case"drumname":case"effectsname":case"voicename":case"oscillatortype":case"invertmode":case"filtertype":console.log(i+" "+_(i)),l.blockList[e].text.text=_(i);break;case"noisename":getNoiseName(i);break;case"temperamentname":l.blockList[e].text.text=_(TEMPERAMENTS[0][1]);for(var s=0;s<TEMPERAMENTS.length;s++)if(TEMPERAMENTS[s][1]===i){l.blockList[e].text.text=TEMPERAMENTS[s][0];break}break;case"boolean":l.blockList[e].text.text=_(i?"true":"false");break;default:l.blockList[e].text.text=i}l.blockList[e].container.updateCache()},s=null,l=this,o=this.blockList.length;if("start"===t){i=function(t){l.blockList[t].value=l.turtles.turtleList.length,l.turtles.addTurtle(l.blockList[t])};s=o}else if("drum"===t){i=function(t){l.blockList[t].value=l.turtles.turtleList.length,l.turtles.addDrum(l.blockList[t])};s=o}else if("text"===t)s=[o,_("text")];else if("boolean"===t)console.log("boolean "+!0),s=[o,!0];else if("solfege"===t)s=[o,"sol"];else if("customNote"===t){var a=this.logo.synth.startingPitch.length;s=[o,this.logo.synth.startingPitch.substring(0,a-1)+"(+0)"]}else if("notename"===t)s=[o,"G"];else if("drumname"===t)s=[o,DEFAULTDRUM];else if("effectsname"===t)s=[o,DEFAULTEFFECT];else if("filtertype"===t)s=[o,DEFAULTFILTER];else if("oscillatortype"===t)s=[o,DEFAULTOSCILLATORTYPE];else if("voicename"===t)s=[o,DEFAULTVOICE];else if("noisename"===t)s=[o,DEFAULTNOISE];else if("eastindiansolfege"===t){i=function(t){var e=t[0],i=t[1];l.blockList[e].value=i,l.blockList[e].text.text=WESTERN2EISOLFEGENAMES[i],l.blockList[e].container.updateCache()};s=[o,"sol"]}else if("modename"===t){i=function(t){var e=t[0],i=t[1];l.blockList[e].value=i,l.blockList[e].text.text=i,l.blockList[e].container.updateCache()};s=[o,DEFAULTMODE]}else if("accidentalname"===t){i=function(t){var e=t[0],i=t[1],s=(l.blockList[e].value=i).split(" ");l.blockList[e].text.text=_(s[0])+" "+s[1],l.blockList[e].container.updateCache()};s=[o,DEFAULTACCIDENTAL]}else if("intervalname"===t){i=function(t){var e=t[0],i=t[1],s=(l.blockList[e].value=i).split(" ");l.blockList[e].text.text=_(s[0])+" "+s[1],l.blockList[e].container.updateCache()};s=[o,DEFAULTINTERVAL]}else if("temperamentname"===t)s=[o,DEFAULTTEMPERAMENT];else if("invertmode"===t)s=[o,DEFAULTINVERT];else if("number"===t){i=function(t){var e=t[0],i=Number(t[1]);l.blockList[e].value=i,l.blockList[e].text.text=i.toString(),l.blockList[e].container.updateCache()};s=[o,NUMBERBLOCKDEFAULT]}else if("loudness"===t||"pitchness"===t)i=function(){l.logo.initMediaDevices()};else if("media"===t){i=function(t){var e=t[0],i=t[1];l.blockList[e].value=i,l.blockList[e].image=null==i?"images/load-media.svg":null};s=[o,null]}else if("camera"===t){i=function(t){console.log("post process camera "+t[1]);var e=t[0],i=t[1];l.blockList[e].value=CAMERAVALUE,l.blockList[e].image=null==i?"images/camera.svg":null};s=[o,null]}else if("video"===t){i=function(t){var e=t[0],i=t[1];l.blockList[e].value=VIDEOVALUE,l.blockList[e].image=null==i?"images/video.svg":null};s=[o,null]}else if("loadFile"===t){i=function(t){l.updateBlockText(t[0])};s=[o,null]}else if(-1!==["storein2","namedbox","nameddo","namedcalc","nameddoArg","namedcalcArg","namedarg"].indexOf(t)){i=function(t){l.blockList[o].value=null,l.blockList[o].privateData=t[1]};s=[o,e]}else if("newnote"===t){i=function(t){t[0]};s=[o,null]}else i=null;var n=!1;for(var r in l.protoBlockDict)if(l.protoBlockDict[r].name===t){if("__NOARG__"===e){l.makeNewBlock(r,i,s),n=!0;break}if(l.protoBlockDict[r].defaults[0]===e){l.makeNewBlock(r,i,s),n=!0;break}if(-1!==["namedbox","nameddo","namedcalc","nameddoArg","namedcalcArg","namedarg"].indexOf(t)){if(void 0===l.protoBlockDict[r].defaults[0]){l.makeNewBlock(r,i,s),n=!0;break}}else if("storein2"===t){i=function(t){var e=l.blockList[o].connections[0];t[1]===_("store in box")?l.blockList[e].privateData=_("box"):(l.blockList[e].privateData=t[1],l.blockList[e].overrideName=t[1],l.blockList[e].regenerateArtwork(!1))};s=[o,e],l.makeNewBlock(r,i,s),n=!0;break}}n||console.log(t+" not found!!");for(var c=this.blockList.length-1,h=this.blockList[c],u=0;u<h.docks.length;u++)h.connections.push(null);var d=1+c;for(u=0;u<h.protoblock.defaults.length;u++){var f=h.protoblock.defaults[u];console.log("=============="),console.log(f),"action"===h.name&&(f=this.findUniqueActionName(_("action")))!==_("action")&&(this.newNameddoBlock(f,!1,!1),this.palettes.updatePalettes("action"));l=this,o=this.blockList.length;if(h.docks.length>u&&"anyin"===h.docks[u+1][2])if(null==f)console.log("cannot set default value");else if("string"==typeof f){i=function(t){var e=t[0],i=t[1],s=(l.blockList[e].value=i).toString();-1===WIDENAMES.indexOf(l.blockList[e].name)&&getTextWidth(s,"bold 20pt Sans")>TEXTWIDTH&&(s=s.substr(0,STRINGLEN)+"..."),l.blockList[e].text.text=s,l.blockList[e].container.updateCache()};this.makeNewBlock("text",i,[o,f])}else{i=function(t){var e=t[0],i=Number(t[1]);l.blockList[e].value=i,l.blockList[e].text.text=i.toString()};this.makeNewBlock("number",i,[o,f])}else if("textin"===h.docks[u+1][2]){i=function(t){var e=t[0],i=t[1],s=(l.blockList[e].value=i).toString();-1===WIDENAMES.indexOf(l.blockList[e].name)&&getTextWidth(s,"bold 20pt Sans")>TEXTWIDTH&&(s=s.substr(0,STRINGLEN)+"..."),l.blockList[e].text.text=s};this.makeNewBlock("text",i,[o,f])}else if("solfegein"===h.docks[u+1][2]){i=function(t){var e=t[0],i=t[1],s=i18nSolfege((l.blockList[e].value=i).toString());l.blockList[e].text.text=s};this.makeNewBlock("solfege",i,[o,f])}else if("notein"===h.docks[u+1][2]){i=function(t){var e=t[0],i=t[1],s=(l.blockList[e].value=i).toString();l.blockList[e].text.text=s};this.makeNewBlock("notename",i,[o,f])}else if("mediain"===h.docks[u+1][2]){i=function(t){var e=t[0],i=t[1];l.blockList[e].value=i};this.makeNewBlock("media",i,[o,f])}else if("filein"===h.docks[u+1][2]){i=function(t){l.updateBlockText(t)};this.makeNewBlock("loadFile",i,o)}else{i=function(t){var e=t[0],i=t[1];l.blockList[e].value=i,l.blockList[e].text.text=i.toString()};this.makeNewBlock("number",i,[o,f])}var p=this.blockList[d+u];p.connections=[c],p.value=f,h.connections[u+1]=d+u}return this.updateBlockPositions(),this.adjustDocks(c,!0),this.refreshCanvas(),c},this.findDragGroup=function(t){null!=t?(this.dragLoopCounter=0,this.dragGroup=[],this._calculateDragGroup(t)):console.log("null block passed to findDragGroup")},this._calculateDragGroup=function(t){if(this.dragLoopCounter+=1,this.dragLoopCount>this.blockList.length)console.log("maximum loop counter exceeded in calculateDragGroup... this is bad. "+t);else if(null!=t){var e=this.blockList[t];if(null!=e)if(null!=e.connections)if(0!==e.connections.length){this.dragGroup.push(t);for(var i=1;i<e.connections.length;i++){var s=e.connections[i];null!=s&&this._calculateDragGroup(s)}}else this.dragGroup=[t];else this.dragGroup=[t];else console.log("null block encountered... this is bad. "+t)}else console.log("null block passed to calculateDragGroup")},this.setActionProtoVisiblity=function(t){for(var e=this.palettes.dict.action,i=!1,s=0;s<e.protoList.length;s++){var l=e.protoList[s];"nameddo"===l.name&&0===l.defaults.length&&l.hidden===t&&(l.hidden=!t,i=!0)}i&&this.palettes.updatePalettes("action")},this.findUniqueActionName=function(t){t===_("action")&&this.setActionProtoVisiblity(!0);for(var e=[],i=0;i<this.blockList.length;i++)if(("text"===this.blockList[i].name||"string"===this.blockList[i].name)&&!this.blockList[i].trash){var s=this.blockList[i].connections[0];null==s||"action"!==this.blockList[s].name||this.blockList[s].trash||e.push(this.blockList[i].value)}for(var l=1,o=t;-1!==e.indexOf(o);)o=t+l.toString(),l+=1;return o},this.findUniqueCustomName=function(t){for(var e=[],i=0;i<this.blockList.length;i++)if("text"===this.blockList[i].name&&!this.blockList[i].trash){var s=this.blockList[i].connections[0];null==s||"pitch"!==this.blockList[s].name||this.blockList[s].trash||e.push(this.blockList[i].value)}for(var l=1,o=t;-1!==e.indexOf(o);)o=t+l.toString(),l+=1;return o},this.findUniqueTemperamentName=function(t){for(var e=[],i=0;i<this.blockList.length;i++)if("text"===this.blockList[i].name&&!this.blockList[i].trash){var s=this.blockList[i].connections[0];null==s||"temperament1"!==this.blockList[s].name||this.blockList[s].trash||e.push(this.blockList[i].value)}for(var l=1,o=t;-1!==e.indexOf(o);)o=t+l.toString(),l+=1;return o},this._findDrumURLs=function(){for(var t=0;t<this.blockList.length;t++)if("text"===this.blockList[t].name||"string"===this.blockList[t].name){var e=this.blockList[t].connections[0];null!=e&&-1!==["playdrum","setdrum","playnoise","setvoice"].indexOf(this.blockList[e].name)&&"http"===this.blockList[t].value.slice(0,4)&&_THIS_IS_MUSIC_BLOCKS_&&this.logo.synth.loadSynth(0,this.blockList[t].value)}},this.renameBoxes=function(t,e){if(t!==e&&t!==_("box"))for(var i=0;i<this.blockList.length;i++)if("text"===this.blockList[i].name){var s=this.blockList[i].connections[0];if(null!=s&&"box"===this.blockList[s].name&&this.blockList[i].value===t){this.blockList[i].value=e,this.blockList[i].text.text=e;try{this.blockList[i].container.updateCache()}catch(t){console.log(t)}}}},this.renameStoreinBoxes=function(t,e){if(t!==e&&t!==_("box"))for(var i=0;i<this.blockList.length;i++)if("text"===this.blockList[i].name){var s=this.blockList[i].connections[0];if(null!=s&&"storein"===this.blockList[s].name&&this.blockList[i].value===t){this.blockList[i].value=e,this.blockList[i].text.text=e;try{this.blockList[i].container.updateCache()}catch(t){console.log(t)}}}else if("storein2"===this.blockList[i].name&&this.blockList[i].privateData===t){this.blockList[i].privateData=e,this.blockList[i].overrideName=e,this.blockList[i].regenerateArtwork();try{this.blockList[i].container.updateCache()}catch(t){console.log(t)}}},this.renameStorein2Boxes=function(t,e){if(t!==e&&t!==_("box"))for(var i=0;i<this.blockList.length;i++)if("storein2"===this.blockList[i].name&&this.blockList[i].privateData===t){this.blockList[i].privateData=e,this.blockList[i].overrideName=e,this.blockList[i].regenerateArtwork();try{this.blockList[i].container.updateCache()}catch(t){console.log(t)}}},this.renameNamedboxes=function(t,e){if(t!==e&&t!==_("box"))for(var i=0;i<this.blockList.length;i++)if("namedbox"===this.blockList[i].name&&this.blockList[i].privateData===t){this.blockList[i].privateData=e,this.blockList[i].overrideName=e,this.blockList[i].regenerateArtwork();try{this.blockList[i].container.updateCache()}catch(t){console.log(t)}}},this.renameDos=function(t,e,i){if(t!==e)for(var s=0;s<this.blockList.length;s++)if(s!==i){var l=this.blockList[s],o=this.blockList[l.connections[0]];if(null!=o)if(-1!==["do","calc","doArg","calcArg","action","offbeatdo","onbeatdo","listen"].indexOf(o.name))if("onbeatdo"!==o.name&&"listen"!==o.name||2===o.connections.indexOf(s))if(l.value===t){l.value=e;var a=l.value;getTextWidth(a,"bold 20pt Sans")>TEXTWIDTH&&(a=a.substr(0,STRINGLEN)+"..."),l.text.text=a,l.container.updateCache()}}},this.renameNameddos=function(t,e){if(t!==e){for(var i=0;i<this.blockList.length;i++)if(-1!==["nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(this.blockList[i].name)&&this.blockList[i].privateData===t){var s=this.blockList[i].privateData=e;getTextWidth(s,"bold 20pt Sans")>TEXTWIDTH&&(s=s.substr(0,STRINGLEN)+"..."),this.blockList[i].overrideName=s,this.blockList[i].regenerateArtwork()}for(var l=this.palettes.dict.action,o=!1,a=0;a<l.protoList.length;a++){var n=l.protoList[a];-1!==["nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(n.name)&&n.defaults[0]===t&&(n.defaults[0]=e,o=!0)}o&&this.palettes.updatePalettes("action")}},this.newStoreinBlock=function(t){if(null!=t)if(null!=t){if(!("myStorein_"+t in this.protoBlockDict)){var e=new ProtoBlock("storein");(this.protoBlockDict["myStorein_"+t]=e).palette=this.palettes.dict.boxes,e.defaults.push(t),e.defaults.push(NUMBERBLOCKDEFAULT),e.staticLabels.push(_("store in"),_("name"),_("value")),e.adjustWidthToLabel(),e.twoArgBlock(),e.dockTypes[1]="anyin",e.dockTypes[2]="anyin","box"!==t&&this.palettes.dict.boxes.add(e,!0)}}else console.log("undefined name passed to newStoreinBlock");else console.log("null name passed to newStoreinBlock")},this.newStorein2Block=function(t){if(null!=t)if(null!=t){if(!("yourStorein2_"+t in this.protoBlockDict)){var e=new ProtoBlock("storein2");(this.protoBlockDict["yourStorein2_"+t]=e).palette=this.palettes.dict.boxes,e.defaults.push(t),e.staticLabels.push(t),e.adjustWidthToLabel(),e.oneArgBlock(),e.dockTypes[1]="anyin","box"!==t&&this.palettes.dict.boxes.add(e,!0)}}else console.log("undefined name passed to newStorein2Block");else console.log("null name passed to newStorein2Block")},this.newNamedboxBlock=function(t){if(null!=t)if(null!=t){if(!("myBox_"+t in this.protoBlockDict)){var e=new ProtoBlock("namedbox");(this.protoBlockDict["myBox_"+t]=e).palette=this.palettes.dict.boxes,e.defaults.push(t),e.staticLabels.push(t),e.parameterBlock(),"box"!==t&&e.palette.add(e,!0)}}else console.log("undefined name passed to newNamedboxBlock");else console.log("null name passed to newNamedboxBlock")},this._newLocalArgBlock=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var i,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i="arg_"+e,"myArg_"+e in this.protoBlockDict)return t.abrupt("return");t.next=3;break;case 3:if(i in this.protoBlockDict)return t.abrupt("return");t.next=5;break;case 5:if(s=new ProtoBlock("namedarg"),(this.protoBlockDict["myArg_"+i]=s).palette=this.palettes.dict.action,s.defaults.push(e),s.staticLabels.push("arg "+e),s.parameterBlock(),"arg_1"===i)return t.abrupt("return");t.next=13;break;case 13:return s.palette.add(s,!0),l=this,t.next=17,delayExecution(100);case 17:l.palettes.updatePalettes("action");case 18:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this._removeNamedoEntries=function(t){this.protoBlockDict["myDo_"+t]?(this.protoBlockDict["myDo_"+t].hide=!0,delete this.protoBlockDict["myDo_"+t]):this.protoBlockDict["myCalc_"+t]?(this.protoBlockDict["myCalc_"+t].hide=!0,delete this.protoBlockDict["myCalc_"+t]):this.protoBlockDict["myDoArg_"+t]?(this.protoBlockDict["myDoArg_"+t].hide=!0,delete this.protoBlockDict["myDoArg_"+t]):this.protoBlockDict["myCalcArg_"+t]&&(this.protoBlockDict["myCalcArg_"+t].hide=!0,delete this.protoBlockDict["myCalcArg_"+t])},this.newNameddoBlock=function(t,e,i){if(t===_("action"))return!1;if(e&&i)return this.newNamedcalcArgBlock(t);if(!e&&i)return this.newNameddoArgBlock(t);if(e&&!i)return this.newNamedcalcBlock(t);if(void 0!==this.protoBlockDict["myDo_"+t])return!1;var s=new ProtoBlock("nameddo");return(this.protoBlockDict["myDo_"+t]=s).palette=this.palettes.dict.action,s.defaults.push(t),s.staticLabels.push(t),s.zeroArgBlock(),s.palette.add(s,!0),this.palettes.updatePalettes(),!0},this.newNamedcalcBlock=function(t){if(void 0!==this.protoBlockDict["myCalc_"+t])return!1;var e=new ProtoBlock("namedcalc");return(this.protoBlockDict["myCalc_"+t]=e).palette=this.palettes.dict.action,e.defaults.push(t),e.staticLabels.push(t),e.zeroArgBlock(),e.palette.add(e,!0),!0},this.newNameddoArgBlock=function(t){if(void 0!==this.protoBlockDict["myDoArg_"+t])return!1;var e=new ProtoBlock("nameddoArg");return(this.protoBlockDict["myDoArg_"+t]=e).palette=this.palettes.dict.action,e.defaults.push(t),e.staticLabels.push(t),e.zeroArgBlock(),e.palette.add(e,!0),!0},this.newNamedcalcArgBlock=function(t){if(void 0!==this.protoBlockDict["myCalcArg_"+t])return!1;var e=new ProtoBlock("namedcalcArg");return(this.protoBlockDict["myCalcArg_"+t]=e).palette=this.palettes.dict.action,e.defaults.push(t),e.staticLabels.push(t),e.zeroArgBlock(),e.palette.add(e,!0),!0},this._insideArgClamp=function(t){if(null==this.blockList[t])return console.log("null block in blockList? "+t),null;if(null==this.blockList[t].connections[0])return null;var e=this.blockList[t].connections[0];return this.blockList[e].isArgClamp()?e:null},this.findNestedClampBlocks=function(t,e){if(null==this.blockList[t])return console.log("null block in blockList? "+t),[];if(null==this.blockList[t].connections[0])return e;var i=this.blockList[t].connections[0];return this.blockList[i].isClampBlock()&&(this.blockList[i].isDoubleClampBlock()?(e.push([i,0]),e.push([i,1])):e.push([i,0])),this.findNestedClampBlocks(i,e)},this.insideExpandableBlock=function(t){if(null==this.blockList[t])return console.log("null block in blockList? "+t),null;if(null==this.blockList[t].connections[0])return null;var e=this.blockList[t].connections[0];return this.blockList[e].isExpandableBlock()?this.blockList[e].isArgFlowClampBlock()?e:t===last(this.blockList[e].connections)?this.insideExpandableBlock(e):e:this.insideExpandableBlock(e)},this._insideNoteBlock=function(t){if(null==this.blockList[t])return console.log("null block in blockList? "+t),null;if(null==this.blockList[t].connections[0])return null;var e=this.blockList[t].connections[0];return this.blockList[e].isExpandableBlock()?t===last(this.blockList[e].connections)?this._insideNoteBlock(e):t===this.blockList[e].connections[1]?null:-1!==NOTEBLOCKS.indexOf(this.blockList[e].name)?e:null:this._insideNoteBlock(e)},this.findBlockInstance=function(t){for(blk=0;blk<this.blockList.length;blk++)if(this.blockList[blk].name===t&&!this.blockList[blk].trash)return!0;return!1},this.insideInlineCollapsibleBlock=function(t){return null===t?null:(c0=this.blockList[t].connections[0],null===c0?null:this.blockList[c0].isInlineCollapsible()&&t!==last(this.blockList[c0].connections)?c0:this.insideInlineCollapsibleBlock(c0))},this.findNoteBlock=function(t){if(null===t)return null;if("newnote"===this.blockList[t].name)return t;if(this.blockList[t].isClampBlock())var e=this.blockList[t].connections.length-2,i=this.blockList[t].connections[e];else i=last(this.blockList[t].connections);return this.findNoteBlock(i)},this.findNestedIntervalBlock=function(t){if(null===t)return null;if("interval"===this.blockList[t].name)return t;if(this.blockList[t].isClampBlock())var e=this.blockList[t].connections.length-2,i=this.blockList[t].connections[e];else i=last(this.blockList[t].connections);return this.findNestedIntervalBlock(i)},this.findFirstPitchBlock=function(t){if(null===t)return null;if(-1!==PITCHBLOCKS.indexOf(this.blockList[t].name))return t;if("rest2"===this.blockList[t].name)return t;var e=last(this.blockList[t].connections);return this.findFirstPitchBlock(e)},this.findPitchOctave=function(t){if(null===t)return 4;if(-1===["pitch","setpitchnumberoffset","invert1","tofrequency","scaledegree"].indexOf(this.blockList[t].name))return 4;var e=this.blockList[t].connections[2];return null===e?4:"number"===this.blockList[e].name?this.blockList[e].value:4},this.setPitchOctave=function(t,e){if(null!==t&&-1!==["pitch","setpitchnumberoffset","invert1","tofrequency","scaledegree"].indexOf(this.blockList[t].name)){var i=this.blockList[t].connections[2];if(null!==i&&"number"===this.blockList[i].name){var s=this.blockList[i];s.value=e,s.text.text=e.toString();var l=s.container.children.length-1;s.container.setChildIndex(s.text,l),s.container.updateCache()}}},this.intervalModifierNumber=function(t){if(null===t)return!1;var e=this.blockList[t],i=e.connections[0];if("number"!==e.name||null===i||"plus"!==this.blockList[i].name)return!1;var s=this.blockList[i].connections[0];return null!==s&&-1!==["interval","setscalartransposition","semitoneinterval","settransposition"].indexOf(this.blockList[s].name)},this.octaveModifierNumber=function(t){if(null===t)return!1;var e=this.blockList[t],i=e.connections[0];if("number"===e.name&&null!==i&&"multiply"===this.blockList[i].name){if(this.blockList[i].connections[1]===t)var s=this.blockList[i].connections[2];else s=this.blockList[i].connections[1];if("modelength"===this.blockList[s].name)return!0;if("number"===this.blockList[s].name&&12===this.blockList[s].value)return!0}return!1},this.noteValueNumber=function(t,e){if(null===t)return!1;var i=this.blockList[t],s=i.connections[0];if("number"===i.name&&null!==s&&"divide"===this.blockList[s].name&&this.blockList[s].connections[e]===this.blockList.indexOf(i)&&(cblk=this.blockList[s].connections[0],null!==cblk))switch(this.blockList[cblk].name){case"newnote":case"pickup":case"tuplet4":case"newstaccato":case"newslur":case"elapsednotes2":return this.blockList[cblk].connections[1]===s;case"meter":this.blockList[t]._check_meter_block=cblk;case"setbpm2":case"setmasterbpm2":case"stuplet":case"rhythm2":case"newswing2":case"vibrato":case"neighbor":case"neighbor2":return this.blockList[cblk].connections[2]===s;default:return!1}return!1},this.noteValueValue=function(t){if(null===t)return 1;var e=this.blockList[t].connections[0];if(cblk=this.blockList[e].connections[0],null!==cblk)switch(this.blockList[cblk].name){case"newnote":case"pickup":case"tuplet4":case"newstaccato":case"newslur":case"elapsednotes2":return this.blockList[cblk].connections[1]===e?(cblk=this.blockList[e].connections[2],this.blockList[cblk].value):1;case"meter":this.blockList[t]._check_meter_block=cblk;case"setbpm2":case"setmasterbpm2":case"stuplet":case"rhythm2":case"newswing2":case"vibrato":case"neighbor":case"neighbor2":return this.blockList[cblk].connections[2]===e&&this.blockList[cblk].connections[1]===e?(cblk=this.blockList[e].connections[2],this.blockList[cblk].value):1;default:return 1}return 1},this.octaveNumber=function(t){if(null===t)return!1;var e=this.blockList[t];return"number"===e.name&&null!==e.connections[0]&&-1!==["pitch","setpitchnumberoffset","invert1","tofrequency","scaledegree"].indexOf(this.blockList[e.connections[0]].name)&&this.blockList[e.connections[0]].connections[2]===t},this.meter_block_changed=function(t){if(null!==t&&"meter"===this.blockList[t].name&&(console.log("METER BLOCK CHANGED"),null!==(n=this.blockList[t].connections[2])&&"divide"===this.blockList[n].name)){var e=this.blockList[n].connections[1];if(null!==e&&"number"===this.blockList[e].name){var i=this.blockList[e].value,s=this.blockList[n].connections[2];if(null!==s&&"number"===this.blockList[s].name)for(var l=this.blockList[s].value,o=0;o<this.blockList.length;o++)if(-1!==["setbpm3","setmasterbpm2"].indexOf(this.blockList[o].name)){var a=this.blockList[o].connections[1];if(null===a||"number"!==this.blockList[a].name)continue;var n,r=this.blockList[a].value;if(null===(n=this.blockList[o].connections[2])||"divide"!==this.blockList[n].name)continue;var c=this.blockList[n].connections[1];if(null===c||"number"!==this.blockList[c].name)continue;var h=this.blockList[c].value,u=this.blockList[n].connections[2];if(null===u||"number"!==this.blockList[u].name)continue;r*=h*l/this.blockList[u].value*i,this.blockList[a].value=r,this.updateBlockText(a),this.blockList[c].value=i,this.updateBlockText(c),this.blockList[u].value=l,this.updateBlockText(u)}}}},this.prepareStackForCopy=function(){if(null==this.activeBlock)return this.errorMsg(_("There is no block selected.")),void console.log("No active block to copy.");var t=this.findTopBlock(this.activeBlock);this.selectedStack=t,this.selectedBlocksObj=JSON.parse(JSON.stringify(this._copyBlocksToObj())),this._pasteDX=0,this._pasteDY=0},this.triggerLongPress=function(){null!=this.longPressTimeout&&(clearTimeout(this.longPressTimeout),this.longPressTimeout=null),this.inLongPress=!0,this.blockList[this.activeBlock].piemenuBlockContext()},this.pasteStack=function(){if(null!=this.selectedStack){for(var t in this.palettes.dict)this.palettes.dict[t].hideMenu(!0);console.log(this.selectedBlocksObj),null!=this.selectedBlocksObj&&(this.selectedBlocksObj[0][2]=175-this.stage.x+this._pasteDX,this.selectedBlocksObj[0][3]=75-this.stage.y+this._pasteDY,this._pasteDX+=21,this._pasteDY+=21,this.loadNewBlocks(this.selectedBlocksObj))}},this.saveStack=function(){if(console.log(this.selectedStack),null!=this.selectedStack){var t=this._copyBlocksToObj(),e=t[0][4][1];if(null==e)console.log("action not named... skipping");else{if(console.log(t[e][1][1]),"string"==typeof t[e][1][1])var i=t[e][1][1];else if("number"==typeof t[e][1][1])i=t[e][1][1].toString();else i=t[e][1][1].value;storage.macros=prepareMacroExports(i,t,this.macroDict),sugarizerCompatibility.isInsideSugarizer()?sugarizerCompatibility.saveLocally(function(){this.addToMyPalette(i,t)}):(this.addToMyPalette(i,t),this.palettes.updatePalettes("myblocks"))}}},this._copyBlocksToObj=function(){var t=[],e={};this.findDragGroup(this.selectedStack);for(var i=0;i<this.dragGroup.length;i++){if(myBlock=this.blockList[this.dragGroup[i]],0===i?(x=75-this.stage.x,y=75-this.stage.y):(x=0,y=0),myBlock.isValueBlock())switch(myBlock.name){case"media":blockItem=[i,[myBlock.name,null],x,y,[]];break;default:blockItem=[i,[myBlock.name,{value:myBlock.value}],x,y,[]]}else-1!==["storein2","namedbox","nameddo","namedcalc","nameddoArg","namedcalcArg","namedarg"].indexOf(myBlock.name)?blockItem=[i,[myBlock.name,{value:myBlock.privateData}],x,y,[]]:blockItem=[i,myBlock.name,x,y,[]];e[this.dragGroup[i]]=i,t.push(blockItem)}for(i=0;i<this.dragGroup.length;i++){myBlock=this.blockList[this.dragGroup[i]];for(var s=0;s<myBlock.connections.length;s++)null==myBlock.connections[s]?t[i][4].push(null):t[i][4].push(e[myBlock.connections[s]])}return t},this.addToMyPalette=function(t,e){var i=new ProtoBlock("macro_"+t),s="macro_"+t;this.protoBlockDict[s]=i,console.log("Adding "+t+" to myblocks palette"),"myblocks"in this.palettes.dict||this.palettes.add("myblocks"),i.palette=this.palettes.dict.myblocks,i.zeroArgBlock(),i.staticLabels.push(_(t)),this.protoBlockDict[s].palette.add(this.protoBlockDict[s])},this.findBlockInstance=function(t){for(var e=0;e<this.blockList.length;e++)if(this.blockList[e].name===t&&!this.blockList[e].trash)return!0;return!1},this.loadNewBlocks=function(t){for(var e=null,i=0;i<t.length;i++){if("number"==typeof(b=t[i])[1]){e=i;break}for(var s in b[4])if(b[4][s]===b[0])return console.log("Circular connection in block data: "+b),console.log("Punting loading of new blocks!"),void console.log(t)}if(null!=e){for(i=e;i<t.length;i++){var l=t[i][1];l in this.logo.playbackQueue?this.logo.playbackQueue[l].push(t[i][2]):this.logo.playbackQueue[l]=[t[i][2]]}var o=t.length;for(i=e;i<o;i++)t.pop()}var a=[],n=[];for(i=0;i<this.blockList.length;i++)this.blockList[i].trash||("action"===this.blockList[i].name?null!=this.blockList[i].connections[1]&&a.push(this.blockList[this.blockList[i].connections[1]].value):"storein"===this.blockList[i].name&&null!=this.blockList[i].connections[1]&&(console.log("found storein name: "+this.blockList[this.blockList[i].connections[1]].value),n.push(this.blockList[this.blockList[i].connections[1]].value)));this._checkTwoArgBlocks=[],this._checkArgClampBlocks=[];var r={},c={},h={},u={};this.blocksToCollapse=[];for(i=0;i<t.length;i++){if("string"==typeof(b=t[i])[1])var d=b[1];else d=b[1][0];if(!(d in this.protoBlockDict))switch(d){case"hat":d="action";break;case"string":d="text";break;default:console.log("skipping "+d);continue}switch(-1!==["arg","twoarg"].indexOf(this.protoBlockDict[d].style)&&this.protoBlockDict[d].expandable&&this._checkTwoArgBlocks.push(this.blockList.length+i),-1!==["clamp","argclamp","argclamparg","doubleclamp","argflowclamp"].indexOf(this.protoBlockDict[d].style)&&this._checkArgClampBlocks.push(this.blockList.length+i),d){case"text":var f=b[1][1];void 0===r[f]&&(r[f]=[]),r[f].push(i);break;case"action":case"hat":null!=b[4][1]&&(c[i]=b[4][1]);break;case"storein":null!=b[4][1]&&(h[i]=b[4][1]);break;case"nameddo":case"namedcalc":case"nameddoArg":case"namedcalcArg":u[i]=b[1][1].value;break;case"do":case"stack":null!=b[4][1]&&(u[i]=b[4][1])}-1!==COLLAPSIBLES.indexOf(d)&&"object"===_typeof(b[1])&&1<b[1].length&&"object"===_typeof(b[1][1])&&"collapsed"in b[1][1]&&b[1][1].collapsed&&this.blocksToCollapse.push(this.blockList.length+i)}var p=!1;for(var i in h){var b=t[h[i]];if(-1===n.indexOf(b[1][1])){if("string"==typeof b[1][1])d=b[1][1];else d=b[1][1].value;this.newStoreinBlock(d),this.newStorein2Block(d),this.newNamedboxBlock(d),p=!0}}for(var i in c){if("string"==typeof(b=t[c[i]])[1][1])d=b[1][1];else d=b[1][1].value;d===_("action")&&this.setActionProtoVisiblity(!0);for(var m=d,g=1;-1!==a.indexOf(d);)if(d=m+g.toString(),(g+=1)>this.blockList.length){console.log("Could not generate unique action name.");break}for(var k in a.push(d),m!==d&&(console.log("action "+m+" is being renamed "+d),b[1][1]={value:d}),u){var v=t[k];if("string"==typeof v[1])var y=v[1];else y=v[1][0];if(-1!==["nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(y))v[1][1].value===m&&(v[1][1]={value:d});else{var T=t[u[k]];"string"==typeof T[1][1]?T[1][1]===m&&(T[1][1]=d):T[1][1].value===m&&(T[1][1]={value:d})}}}p&&this.palettes.updatePalettes("action"),blockObjsLength=t.length;var L=0;for(i=0;i<blockObjsLength;i++){if("object"===_typeof(t[i][1]))d=t[i][1][0];else d=t[i][1];switch(d){case"articulation":case"backward":case"crescendo":case"drift":case"duplicatenotes":case"interval":case"invert1":case"fill":case"flat":case"hollowline":case"multiplybeatfactor":case"note":case"newnote":case"newslur":case"newstaccato":case"newswing":case"newswing2":case"osctime":case"pluck":case"rhythmicdot":case"semitoneinterval":case"setbpm":case"setnotevolume2":case"setscalartransposition":case"settransposition":case"setvoice":case"sharp":case"skipnotes":case"slur":case"staccato":case"swing":case"tie":case"tuplet2":case"vibrato":var w=t[i][4].length;if(null==last(t[i][4]))console.log("last connection of "+d+" is null: adding hidden block"),console.log(t[i][4]),t[i][4][w-1]=blockObjsLength+L,t.push([blockObjsLength+L,"hidden",0,0,[i,null]]),L+=1;else{if("object"===_typeof(t[C=t[i][4][w-1]][1]))var B=t[C][1][0];else B=t[C][1];"hidden"!==B&&(console.log("last connection of "+d+" is "+B+": adding hidden block"),t[i][4][w-1]=blockObjsLength+L,t[C][4][0]=blockObjsLength+L,t.push([blockObjsLength+L,"hidden",0,0,[i,C]]),L+=1)}if(-1!==["note","slur","staccato","swing"].indexOf(d)){var x=t[i][4][2];t[i][4][2]=blockObjsLength+L,null==x?t.push([blockObjsLength+L,"vspace",0,0,[i,null]]):(t[x][4][0]=blockObjsLength+L,t.push([blockObjsLength+L,"vspace",0,0,[i,x]])),L+=1;var S=t[i][4][1];t[i][4][1]=blockObjsLength+L,null==S?(t.push([blockObjsLength+L,"divide",0,0,[i,blockObjsLength+L+1,blockObjsLength+L+2]]),t.push([blockObjsLength+L+1,["number",{value:1}],0,0,[blockObjsLength+L]]),t.push([blockObjsLength+L+2,["number",{value:1}],0,0,[blockObjsLength+L]]),L+=3):(t[S][4][0]=blockObjsLength+L,t.push([blockObjsLength+L,"divide",0,0,[i,blockObjsLength+L+1,S]]),t.push([blockObjsLength+L+1,["number",{value:1}],0,0,[blockObjsLength+L]]),L+=2),"object"===_typeof(t[i][1])?t[i][1][0]="new"+d:t[i][1]="new"+d}break;case"action":w=t[i][4].length;if(null==t[i][4][2])console.log("last connection of "+d+" is null: adding hidden block"),t[i][4][2]=blockObjsLength+L,t.push([blockObjsLength+L,"hidden",0,0,[i,null]]),L+=1;else{var C;if("object"===_typeof(t[C=t[i][4][2]][1]))B=t[C][1][0];else B=t[C][1];"hidden"!==B&&(console.log("last connection of "+d+" is "+B+": adding hidden block"),t[i][4][2]=blockObjsLength+L,t[C][4][0]=blockObjsLength+L,t.push([blockObjsLength+L,"hidden",0,0,[i,C]]),L+=1)}}}this._adjustTheseStacks=[],this._adjustTheseDocks=[],this._loadCounter=t.length;var A=this.blockList.length,N=this.blockList.length;for(i=0;i<this._loadCounter;i++){var P=A+i;if("object"===_typeof((b=t[i])[1]))if(1===b[1].length)var I=[b[1][0],{value:null}];else if(-1!==["number","string"].indexOf(_typeof(b[1][1]))){I=[b[1][0],{value:b[1][1]}];-1!==COLLAPSIBLES.indexOf(b[1][0])&&(I[1].collapsed=!1)}else I=b[1];else{I=[b[1],{value:null}];-1!==COLLAPSIBLES.indexOf(b[1])&&(I[1].collapsed=!1)}d=I[0];if(-1!==COLLAPSIBLES.indexOf(d)&&I[1].collapsed,null==I[1])var M=null;else{M=I[1].value;null==I[1].text&&""}d in NAMEDICT&&(d=NAMEDICT[d]);var E=this;switch(this.findBlockInstance("temperament1")&&(this.customTemperamentDefined=!0),d){case"start":b[4][0]=null,b[4][2]=null;var O=function(t){var e=t[0],i=t[1];E.blockList[e].value=E.turtles.turtleList.length,E.turtles.addTurtle(E.blockList[e],i)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,I[1]]);break;case"drum":b[4][0]=null,b[4][2]=null;O=function(t){var e=t[0],i=t[1];E.blockList[e].value=E.turtles.turtleList.length,E.turtles.addDrum(E.blockList[e],i)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,I[1]]),_THIS_IS_MUSIC_BLOCKS_&&this.logo.synth.loadSynth(0,DEFAULTDRUM);break;case"action":case"hat":b[4][0]=null,b[4][3]=null,this._makeNewBlockWithConnections("action",A,b[4],null,null);break;case"temperament1":O=function(t){t[0];var e=t[1];void 0!==e.customTemperamentNotes&&(TEMPERAMENT.custom=e.customTemperamentNotes,TEMPERAMENT.custom.pitchNumber=e.customTemperamentNotes.length,E.logo.synth.startingPitch=e.startingPitch,OCTAVERATIO=e.octaveSpace,console.log(TEMPERAMENT.custom),E.logo.customTemperamentDefined=!0)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,I[1]]);break;case"storein2":O=function(t){var e=t[0],i=t[1];E.blockList[e].privateData=i,E.blockList[e].value=null,E.blockList[e].overrideName=i,E.blockList[e].regenerateArtwork()};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;case"namedbox":case"namedarg":case"namedcalc":case"nameddo":O=function(t){var e=t[0],i=t[1];E.blockList[e].privateData=i,E.blockList[e].value=null};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;case"doArg":O=function(t){var e=t[0],i=t[1].length-4;if(0<i){for(var s=E.blockList[e].argClampSlots,l=0;l<i;l++)s.push(1),E._newLocalArgBlock(s.length),E.blockList[e].connections.push(null);E.blockList[e].updateArgSlots(s);for(l=0;l<t[1].length;l++)null!=t[1][l]?E.blockList[e].connections[l]=t[1][l]+N:E.blockList[e].connections[l]=t[1][l]}E._checkArgClampBlocks.push(e)};this._makeNewBlockWithConnections("doArg",A,b[4],O,[P,b[4]]);break;case"nameddoArg":O=function(t){var e=t[0],i=t[1];E.blockList[e].privateData=i,E.blockList[e].value=null;var s=t[2].length-3;if(0<s){for(var l=E.blockList[e].argClampSlots,o=0;o<s;o++)l.push(1),E._newLocalArgBlock(l.length),E.blockList[e].connections.push(null);E.blockList[e].updateArgSlots(l);for(o=0;o<t[2].length;o++)null!=t[2][o]?E.blockList[e].connections[o]=t[2][o]+N:E.blockList[e].connections[o]=t[2][o]}E._checkArgClampBlocks.push(e)};this._makeNewBlockWithConnections("nameddoArg",A,b[4],O,[P,M,b[4]]);break;case"calcArg":O=function(t){var e=t[0],i=t[1].length-3;if(0<i){for(var s=E.blockList[e].argClampSlots,l=0;l<i;l++)s.push(1),E._newLocalArgBlock(s.length),E.blockList[e].connections.push(null);E.blockList[e].updateArgSlots(s);for(l=0;l<t[1].length;l++)null!=t[1][l]?E.blockList[e].connections[l]=t[1][l]+N:E.blockList[e].connections[l]=t[1][l]}E._checkArgClampBlocks.push(e)};this._makeNewBlockWithConnections("calcArg",A,b[4],O,[P,b[4]]);break;case"namedcalcArg":O=function(t){var e=t[0],i=t[1];E.blockList[e].privateData=i,E.blockList[e].value=null;var s=t[2].length-2;if(0<s){for(var l=E.blockList[e].argClampSlots,o=0;o<s;o++)l.push(1),E._newLocalArgBlock(l.length),E.blockList[e].connections.push(null);E.blockList[e].updateArgSlots(l);for(o=0;o<t[2].length;o++)null!=t[2][o]?E.blockList[e].connections[o]=t[2][o]+N:E.blockList[e].connections[o]=t[2][o]}E._checkArgClampBlocks.push(e)};this._makeNewBlockWithConnections("namedcalcArg",A,b[4],O,[P,M,b[4]]);break;case"makeblock":O=function(t){var e=t[0],i=t[1].length-3;if(0<i){for(var s=E.blockList[e].argClampSlots,l=0;l<i;l++)s.push(1),E.blockList[e].connections.push(null);E.blockList[e].updateArgSlots(s);for(l=0;l<t[1].length;l++)null!=t[1][l]?E.blockList[e].connections[l]=t[1][l]+N:E.blockList[e].connections[l]=t[1][l]}E._checkArgClampBlocks.push(e)};this._makeNewBlockWithConnections("makeblock",A,b[4],O,[P,b[4]]);break;case"number":O=function(t){var e=t[0],i=t[1];E.blockList[e].value=Number(i),E.updateBlockText(e)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;case"text":case"solfege":case"customNote":case"eastindiansolfege":case"notename":case"modename":case"temperamentname":case"invertmode":case"filtertype":case"oscillatortype":case"accidentalname":case"intervalname":case"boolean":O=function(t){var e=t[0],i=t[1];E.blockList[e].value=i,E.updateBlockText(e)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;case"drumname":O=function(t){var e=t[0],i=t[1];E.blockList[e].value=i,E.updateBlockText(e)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]),_THIS_IS_MUSIC_BLOCKS_&&this.logo.synth.loadSynth(0,getDrumSynthName(M));break;case"effectsname":O=function(t){var e=t[0],i=t[1];E.blockList[e].value=i,E.updateBlockText(e)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]),_THIS_IS_MUSIC_BLOCKS_&&this.logo.synth.loadSynth(0,getDrumSynthName(M));break;case"voicename":O=function(t){var e=t[0],i=t[1];-1!==["simple 1","simple 2","simple 3","simple 4"].indexOf(i)&&(i="sine"),E.blockList[e].value=i,E.updateBlockText(e)};if(this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]),_THIS_IS_MUSIC_BLOCKS_)try{this.logo.synth.loadSynth(0,getVoiceSynthName(M))}catch(t){console.log(t)}break;case"noisename":O=function(t){var e=t[0],i=t[1];E.blockList[e].value=i,E.updateBlockText(e)};if(this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]),_THIS_IS_MUSIC_BLOCKS_)try{this.logo.synth.loadSynth(0,getNoiseSynthName(M))}catch(t){console.log(t)}break;case"loudness":case"pitchness":this._makeNewBlockWithConnections(d,A,b[4],null,[]),this.logo.initMediaDevices();break;case"media":O=function(t){var e=t[0],i=t[1];null!=(E.blockList[e].value=i)&&E.blockList[e].loadThumbnail(null)};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;case"camera":O=function(t){var e=t[0];t[1];E.blockList[e].value=CAMERAVALUE};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;case"video":O=function(t){var e=t[0];t[1];E.blockList[e].value=VIDEOVALUE};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;case"red":case"black":O=function(t){E.blockList[t].value=0,E.updateBlockText(t)};this._makeNewBlockWithConnections("number",A,b[4],O,P);break;case"white":O=function(t){E.blockList[t].value=100,E.updateBlockText(t)};this._makeNewBlockWithConnections("number",A,b[4],O,P);break;case"orange":O=function(t){E.blockList[t].value=10,E.updateBlockText(t)};this._makeNewBlockWithConnections("number",A,b[4],O,P);break;case"yellow":O=function(t){E.blockList[t].value=20,E.updateBlockText(t)};this._makeNewBlockWithConnections("number",A,b[4],O,P);break;case"green":O=function(t){E.blockList[t].value=40,E.updateBlockText(t)};this._makeNewBlockWithConnections("number",A,b[4],O,P);break;case"blue":O=function(t){E.blockList[t].value=70,E.updateBlockText(t)};this._makeNewBlockWithConnections("number",A,b[4],O,P);break;case"loadFile":O=function(t){E.blockList[t[0]].value=t[1],E.updateBlockText(t[0])};this._makeNewBlockWithConnections(d,A,b[4],O,[P,M]);break;default:if(!d in this.protoBlockDict||null==this.protoBlockDict[d]){var D=d,R=(o=b[4].length,!0);if(null!==(s=b[4][0])){var W=t[s][4].indexOf(i);"string"==typeof t[s][1]?void 0!==this.protoBlockDict[t[s][1]]&&"in"!==this.protoBlockDict[t[s][1]].dockTypes[W]&&(R=!1):void 0!==this.protoBlockDict[t[s][1][0]]&&"in"!==this.protoBlockDict[t[s][1][0]].dockTypes[W]&&(R=!1)}else{if(null!==(s=last(b[4]))){W=t[s][4].indexOf(i);"string"==typeof t[s][1]&&(void 0!==this.protoBlockDict[t[s][1]]?"out"!==this.protoBlockDict[t[s][1]].dockTypes[W]&&(R=!1):void 0!==this.protoBlockDict[t[s][1][0]]&&"out"!==this.protoBlockDict[t[s][1][0]].dockTypes[W]&&(R=!1))}}switch(R?console.log(o+": substituting nop flow block for "+d):console.log(o+": substituting nop arg block for "+d),o){case 1:D="nopValueBlock";break;case 2:D=R?"nopZeroArgBlock":"nopOneArgMathBlock";break;case 3:D=R?"nopOneArgBlock":"nopTwoArgMathBlock";break;case 4:D="nopTwoArgBlock";break;case 5:default:5<o&&console.log("WARNING: arg count exceed."),D="nopThreeArgBlock"}this._makeNewBlockWithConnections(D,A,b[4],function(t){E.blockList[t[0]].privateData=t[1]},[P,d])}else this._makeNewBlockWithConnections(d,A,b[4],null)}P===this.blockList.length-1&&null==this.blockList[P].connections[0]&&(this.blockList[P].container.x=b[2],this.blockList[P].container.y=b[3],this._adjustTheseDocks.push(P),null==b[4][0]&&this._adjustTheseStacks.push(P),(b[2]<0||b[3]<0||b[2]>canvas.width||b[3]>canvas.height)&&this._setHomeButtonContainers(!0,!1))}if(null!=e){E=this;setTimeout(function(){for(var t=0;t<E.turtles.turtleList.length&&E.turtles.turtleList[t].trash;t++);if(t===E.turtles.turtleList.length&&(console.log("Cannot find a turtle"),t=0),!(t in E.logo.playbackQueue))for(l in E.logo.playbackQueue)console.log("playbackQueue: remapping from "+l+" to "+t),E.logo.playbackQueue[t]=E.logo.playbackQueue[l],delete E.logo.playbackQueue[l],t+=1;E.setPlaybackStatus()},1500)}},this.cleanupAfterLoad=function(t){if(this._loadCounter-=1,!(0<this._loadCounter)){this._findDrumURLs(),this.updateBlockPositions(),this._cleanupStacks();for(var e=0;e<this.blocksToCollapse.length;e++)this.blockList[this.blocksToCollapse[e]].collapseToggle();this.blocksToCollapse=[],this.refreshCanvas();for(var i=!1,s=0;s<this.blockList.length;s++)if(!this.blockList[s].trash&&"action"===this.blockList[s].name){null!=(l=this.blockList[s].connections[1])&&this.blockList[l].value!==_("action")&&this.newNameddoBlock(this.blockList[l].value,this.actionHasReturn(s),this.actionHasArgs(s))&&(i=!0)}i&&this.palettes.updatePalettes("action");for(i=!1,s=0;s<this.blockList.length;s++)if(!this.blockList[s].trash&&"storein"===this.blockList[s].name){var l;if(null!=(l=this.blockList[s].connections[1])&&this.blockList[l].value!==_("box"))null!==(t=this.blockList[l].value)&&(null!=this.protoBlockDict["myStorein_"+t]&&null!=this.protoBlockDict["yourStorein2_"+t]||(console.log("adding new storein block "+t),this.newStoreinBlock(this.blockList[l].value),this.newStorein2Block(this.blockList[l].value),this.newNamedboxBlock(this.blockList[l].value),i=!0))}if(i){var o=this;setTimeout(function(){o.palettes.updatePalettes("boxes")},150)}console.log("Finished block loading"),document.body.style.cursor="default";var a=new Event("finishedLoading");document.dispatchEvent(a)}},this._cleanupStacks=function(){if(0<this._checkArgClampBlocks.length)for(var t=0;t<this._checkArgClampBlocks.length;t++)for(var e=0;e<this._checkArgClampBlocks.length;e++)this._adjustArgClampBlock([this._checkArgClampBlocks[e]]);if(0<this._checkTwoArgBlocks.length)for(t=0;t<this._checkTwoArgBlocks.length;t++)for(e=0;e<this._checkTwoArgBlocks.length;e++)this._adjustExpandableTwoArgBlock([this._checkTwoArgBlocks[e]]);for(var i=0;i<this._adjustTheseDocks.length;i++)this.adjustDocks(this._adjustTheseDocks[i],!0),this._expandClamps();for(i=0;i<this._adjustTheseStacks.length;i++)this.raiseStackToTop(this._adjustTheseStacks[i])},this.actionHasReturn=function(t){if("action"!==this.blockList[t].name)return!1;this.findDragGroup(t);for(var e=0;e<this.dragGroup.length;e++)if("return"===this.blockList[this.dragGroup[e]].name)return!0;return!1},this.actionHasArgs=function(t){if("action"!==this.blockList[t].name)return!1;this.findDragGroup(t);for(var e=0;e<this.dragGroup.length;e++)if("arg"===this.blockList[this.dragGroup[e]].name||"namedarg"===this.blockList[this.dragGroup[e]].name)return!0;return!1},this.raiseStackToTop=function(t){var e=this.findTopBlock(t);this.findDragGroup(e);for(var i=this.stage.children.length-1,s=0;s<this.dragGroup.length;s++)this.stage.setChildIndex(this.blockList[this.dragGroup[s]].container,i),i-=1;this.refreshCanvas},this.deleteActionBlock=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var i,s,l,o,a,n,r,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=this.blockList[e.connections[1]])){t.next=41;break}s=i.value,l=0;case 4:if(!(l<this.blockList.length)){t.next=34;break}if(o=this.blockList[l],-1===["nameddo","namedcalcArg","nameddoArg","do","calc","calcArg","doArg"].indexOf(o.name))return t.abrupt("continue",31);t.next=8;break;case 8:if(null!==o.connections[0])return t.abrupt("continue",31);t.next=10;break;case 10:if("calc"===o.name){t.next=13;break}if(null!==last(o.connections))return t.abrupt("continue",31);t.next=13;break;case 13:if("calcArg"!==o.name){t.next=16;break}if(null!==o.connections[2])return t.abrupt("continue",31);t.next=16;break;case 16:if("doArg"!==o.name){t.next=19;break}if(null!==o.connections[2])return t.abrupt("continue",31);t.next=19;break;case 19:if("namedcalcArg"!==o.name){t.next=22;break}if(null!==o.connections[1])return t.abrupt("continue",31);t.next=22;break;case 22:t.t0=o.name,t.next="doArg"===t.t0?25:"calcArg"===t.t0?25:"calc"===t.t0?25:"do"===t.t0?25:"nameddoArg"===t.t0?27:"namedcalcArg"===t.t0?27:"nameddo"===t.t0?27:30;break;case 25:return null!==o.connections[1]&&(a=this.blockList[o.connections[1]],n=a.value),t.abrupt("break",30);case 27:return a=null,n=o.privateData,t.abrupt("break",30);case 30:n===s&&(o.trash=!0,null!==a&&(a.hide(),a.trash=!0));case 31:l++,t.next=4;break;case 34:return this.deleteActionTimeout+=50,r=this.deleteActionTimeout,c=this,t.next=39,delayExecution(r);case 39:c.deleteActionTimeout-=50,c.palettes.removeActionPrototype(s);case 41:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.sendStackToTrash=function(t){for(var e in this.palettes.dict)this.palettes.dict[e].hideMenu(!0);this.refreshCanvas();var i=this.blockList.indexOf(t);this.trashStacks.push(i);var s=t.connections[0];if(null!=s){for(var l in this.blockList[s].connections)if(this.blockList[s].connections[l]===i){this.blockList[s].connections[l]=null;break}t.connections[0]=null,this.addDefaultBlock(s,i)}if("start"===t.name||"drum"===t.name){turtle=t.value;for(var o=0,a=0;a<this.turtles.turtleList.length;a++)this.turtles.turtleList[a].trash||(o+=1);if(!(null!=turtle&&1<o))return this.errorMsg(_("You must always have at least one start block.")),void console.log("null turtle");console.log("putting turtle "+turtle+" in the trash"),this.turtles.turtleList[turtle].trash=!0,this.turtles.turtleList[turtle].container.visible=!1}else"action"===t.name&&(t.trash||this.deleteActionBlock(t));this.findDragGroup(i);for(var n=0;n<this.dragGroup.length;n++){var r=this.dragGroup[n];this.blockList[r].trash=!0,this.blockList[r].hide(),this.refreshCanvas()}if(null!=s){var c=this.findTopBlock(s);this.findDragGroup(c),this._checkTwoArgBlocks=[],this._checkArgClampBlocks=[];for(n=0;n<this.dragGroup.length;n++){r=this.dragGroup[n];(t=this.blockList[r]).isTwoArgBlock()?this._checkTwoArgBlocks.push(r):t.isArgBlock()&&t.isExpandableBlock()||t.isArgClamp()?this._checkTwoArgBlocks.push(r):-1!==["clamp","argclamp","argclamparg","doubleclamp","argflowclamp"].indexOf(t.protoblock.style)&&this._checkArgClampBlocks.push(r)}this._cleanupStacks(),this.refreshCanvas()}},this}function Boundary(){this._stage=null,this._container=null,this.setStage=function(t){return this._stage=t,this},this.resizeEvent=function(t){},this.init=function(){this._container=new createjs.Container,this._stage.addChild(this._container),this._stage.setChildIndex(this._container,0)},this.setScale=function(t,e,i){this.destroy(),this.create(t,e,i)},this.destroy=function(){0<this._container.children.length&&this._container.removeChild(this._container.children[0])},this.offScreen=function(t,e){return t<this.x||t>this.x+this.dx||e<this.y||e>this.y+this.dy},this.create=function(t,e,i){var s;this.w=t/i,this.x=68,this.dx=this.w-136,this.h=e/i,this.y=68,this.dy=this.h-81,that=this,(s=new Image).onload=function(){bitmap=new createjs.Bitmap(s),that._container.addChild(bitmap)},s.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(BOUNDARY.replace("HEIGHT",that.h).replace("WIDTH",that.w).replace("Y",that.y).replace("X",that.x).replace("DY",that.dy).replace("DX",that.dx).replace("stroke_color","#e08080"))))},this.hide=function(){this._container.visible=!1},this.show=function(){this._container.visible=!0}}function LanguageBox(){var e=localStorage.languagePreference;this._message=null,this.setMessage=function(t){return this._message=t,this},this.enUS_onclick=function(){e="enUS",this.hide()},this.enUK_onclick=function(){e="enUK",this.hide()},this.ja_onclick=function(){e="ja",localStorage.kanaPreference="kanji",this.hide()},this.kana_onclick=function(){e="ja",localStorage.kanaPreference="kana",this.hide()},this.es_onclick=function(){e="es",this.hide()},this.pt_onclick=function(){e="pt",this.hide()},this.zhCN_onclick=function(){e="zhCN",this.hide()},this.th_onclick=function(){e="th",this.hide()},this.hi_onclick=function(){e="hi",this.hide()},this.ibo_onclick=function(){e="ibo",this.hide()},this.ar_onclick=function(){e="ar",this.hide()},this.he_onclick=function(){e="he",this.hide()},this.ayc_onclick=function(){e="ayc",this.hide()},this.gug_onclick=function(){e="gug",this.hide()},this.hide=function(){var t={default:_("Refresh your browser to change your language preference."),enUS:"Refresh your browser to change your language preference.",enUK:"Refresh your browser to change your language preference.",ja:"",kana:"  ",es:"Actualice su navegador para cambiar su preferencia de idioma.",pt:"Atualize seu navegador para alterar sua preferncia de idioma.",zhCN:"",th:"",hi:"          ",ibo:"Mee ka nchghar g gbanwee mmas ass g.",ar:"    .",he:"        .",ayc:"Actualice su navegador para cambiar su preferencia de idioma.",gug:"Actualice su navegador para cambiar su preferencia de idioma."};localStorage.languagePreference=e,console.log(e),"ja"===e&&"kana"===localStorage.kanaPreference?this._message(t.kana):this._message(t[e])}}var LILYPONDHEADER='\\version "2.18.2"\n\n% ****************************************************************\n% \n% WHAT IS THIS? -- This is a LilyPond file generated from Music\n% Blocks software (Read about it at www.musicblocks.net).\n% \n% DOWNLOAD LILYPOND -- In order to create notation with this file,\n% you will need to download and install LilyPond software onto your\n% computer (http://lilypond.org/download.html). Frescobaldi\n% software is also handy for editing LilyPond files\n% (http://frescobaldi.org/download).\n% \n% LILYPOND INSTRUCTIONS -- For instructions on how to further\n% manipulate musical notation using LilyPond software, please\n% read the Introduction (http://lilypond.org/text-input.html) and\n% the Manual\n% (http://lilypond.org/doc/v2.18/Documentation/learning/index.html).\n% \n% GLOSSARY -- A glossary with helpful examples may be found here\n% (http://www.lilypond.org/doc/v2.19/Documentation/music-glossary/).\n% \n% MUTOPIA -- You may also benefit from studying scores from the\n% Mutopia Project website, which has freely sharable music notation\n% generated with LilyPond (http://www.mutopiaproject.org/).\n% \n% LILYBIN -- You can explore your Lilypond output in a web browser at\n% (http://lilybin.com/).\n% \n% COMMENTS -- Some of the code below is commented out. You can\n% enable it by deleting the % that precedes the text or, in the\n% case of a commented section, deleting the %{ and %} that surrounds\n% the section.\n% \n% ****************************************************************\n\n% Please add your own name, the title of your musical creation,\n% and the intended copyright below.\n% The copyright is great for sharing (and re-sharing)!\n% Read more about it here (http://creativecommons.org/licenses/by-sa/4.0/).\n% Of course, you can use any copyright you like -- you made it!\n\\header {\n   dedication = \\markup {\n      \\abs-fontsize #8 \\sans "Made with LilyPond and Music Blocks" \\with-url #"http://musicblocks.sugarlabs.org/" {\n         \\abs-fontsize #8 \\sans "(http://musicblocks.sugarlabs.org/)"\n      }\n   }\n   title = "My Music Blocks Creation"\n%   subtitle = "Subtitle"\n%   instrument = "Instrument"\n   composer = "Mr. Mouse"\n%   arranger = "Arranger"\n   copyright = "Mr. Mouse (c) 2017 -- CC-BY-SA"\n   tagline = "Made from Music Blocks v.2.2"\n   footer = \\markup {\n      \\with-url #"http://musicblocks.sugarlabs.org/" "Made with Music Blocks Software v.2.2" Engraved on \\simple #(strftime "%Y-%m-%d" (localtime (current-time)))\n   }\n   currentYear = \\markup {\n      \\simple #(strftime "%Y" (localtime (current-time)))\n   }\n   copyTag =  " free to distribute, modify, and perform"\n   copyType = \\markup {\n      \\with-url #"http://creativecommons.org/licenses/by-sa/3.0/" "Creative Commons Attribution ShareAlike 3.0 (Unported) License "\n   }\n   copyright = \\markup {\n      \\override #\'(baseline-skip . 0 ) \\right-column {\n         \\sans \\bold \\with-url #"http://musicblocks.net" {\n            \\abs-fontsize #9  "Music " \\concat {\n               \\abs-fontsize #12 \\with-color #white \\char ##x01C0 \\abs-fontsize #9 "Blocks "\n            }\n         }\n      }\n      \\override #\'(baseline-skip . 0 ) \\center-column {\n         \\abs-fontsize #11.9 \\with-color #grey \\bold {\n            \\char ##x01C0 \\char ##x01C0\n         }\n      }\n      \\override #\'(baseline-skip . 0 ) \\column {\n         \\abs-fontsize #8 \\sans \\concat {\n            " Typeset using " \\with-url #"http://www.lilypond.org" "LilyPond software " \\char ##x00A9 " " \\currentYear " by " \\composer " " \\char ##x2014 " " \\footer\n         }\n         \\concat {\n            \\concat {\n               \\abs-fontsize #8 \\sans {\n                  " " \\copyType \\char ##x2014 \\copyTag\n               }\n            }\n            \\abs-fontsize #13 \\with-color #white \\char ##x01C0\n         }\n      }\n   }\n   tagline = ##f\n}\n\n% To change the meter make adjustments in the following section.\n% You must also delete the % before \\meter everywhere it appears below.\nmeter = {\n%   \\time 3/4\n%   \\key c \\minor\n   \\numericTimeSignature\n%   \\partial 4 \n%   \\tempo "Andante" 4=90\n}\n\n',RODENTS=[_("mouse"),_("brown rat"),_("mole"),_("chipmunk"),_("red squirrel"),_("guinea pig"),_("capybara"),_("coypu"),_("black rat"),_("grey squirrel"),_("flying squirrel"),_("bat")],RODENTSEN=["mouse","brown rat","mole","chipmunk","red squirrel","guinea pig","capybara","coypu","black rat","grey squirrel","flying squirrel","bat"],CLEFS=["treble","bass","bass_8","percussion"];getLilypondHeader=function(){return LILYPONDHEADER},processLilypondNotes=function(t,e,i){function r(t){if("number"==typeof t){var e=frequencyToPitch(t);t=e[0]+e[1]}return t.replace(//g,"!").replace(//g,"is").replace(//g,"es").replace(/10/g,"''''''''").replace(/1/g,",, ").replace(/2/g,", ").replace(/3/g,"").replace(/4/g,"'").replace(/5/g,"''").replace(/6/g,"'''").replace(/7/g,"''''").replace(/8/g,"''''''").replace(/9/g,"'''''''").toLowerCase()}for(var s=0,l=!(e.notationNotes[i]="\\meter\n"),o=!1,a=0,n=0,c=!1,h=0;h<e.notationStaging[i].length;h++){if("string"==typeof(p=e.notationStaging[i][h]))switch(p){case"swing":e.notationNotes[i]+="\\tempo swing\n";break;case"tempo":e.notationNotes[i]+="\\tempo "+e.notationStaging[i][h+2]+" = "+e.notationStaging[i][h+1]+"\n",h+=2;break;case"markup":e.notationNotes[i]+="^\\markup { \\abs-fontsize #6 { "+e.notationStaging[i][h+1]+" } } ",h+=1;break;case"markdown":e.notationNotes[i]+="_\\markup { "+e.notationStaging[i][h+1]+" } ",h+=1;break;case"break":0<h&&(e.notationNotes[i]+="\n"),s=0;break;case"begin articulation":o=!0;break;case"end articulation":o=!1;break;case"begin crescendo":e.notationNotes[i]+="\\< ";break;case"begin decrescendo":e.notationNotes[i]+="\\> ";break;case"end crescendo":case"end decrescendo":e.notationNotes[i]+="\\! ";break;case"begin slur":l=!0;break;case"end slur":e.notationNotes[i]+=") ";break;case"begin harmonics":e.notationNotes[i]+="\\harmonicsOn ";break;case"end harmonics":e.notationNotes[i]+="\\harmonicsOff ";break;case"tie":e.notationNotes[i]+="~";break;case"key":var u=e.notationStaging[i][h+1]+" "+e.notationStaging[i][h+2],d=e.notationStaging[i][h+1].toLowerCase().replace(FLAT,"es").replace(SHARP,"is").replace(NATURAL,"").replace(DOUBLESHARP,"isis").replace(DOUBLEFLAT,"eses"),f=e.notationStaging[i][h+2];if(-1!==["major","minor","ionian","dorian","phrygian","lydian","mixolydian","aeolian","locrian"].indexOf(f))e.notationNotes[i]+=" \\key "+d+" \\"+f+"\n";else{for(var p=getScaleAndHalfSteps(u),b="\n"+f.replace(/ /g,"_")+" = #`(",m="",g=-1,k=0;k<p[1].length;k++)if(""!==p[1][k]){if(p[0][k].substr(0,1)===m){b="";break}m=p[0][k].substr(0,1);var v=["C","D","E","F","G","A","B"].indexOf(p[0][k].substr(0,1));if(g<v){if(1<v-g)for(var y=g+1;y<v;y++)b+="("+y+" . ,NATURAL) ";g=v,1===p[0][k].length?b+="("+v+" . ,NATURAL) ":p[0][k].substr(1,1)===FLAT?b+="("+v+" . ,FLAT) ":b+="("+v+" . ,SHARP) "}}if(""!==b){if(v<6)for(y=v+1;y<7;y++)b+="("+y+" . ,NATURAL) ";b+=")\n",console.log(b),t.freygish+=b,e.notationNotes[i]+=" \\key "+d+" \\"+f.replace(/ /g,"_")+"\n"}else e.errorMsg(_("Lilypond ignoring mode")+" "+f)}h+=2;break;case"meter":e.notationNotes[i]+=" \\time "+e.notationStaging[i][h+1]+"/"+e.notationStaging[i][h+2]+"\n",h+=2;break;case"pickup":e.notationNotes[i]+=" \\partial "+e.notationStaging[i][h+1]+"\n",h+=1;break;case"voice one":c?e.notationNotes[i]+="}\n\\new Voice { \\voiceOne ":(e.notationNotes[i]+="<< { \\voiceOne ",c=!0);break;case"voice two":c?e.notationNotes[i]+="}\n\\new Voice { \\voiceTwo ":(e.notationNotes[i]+="<< { \\voiceTwo ",c=!0);break;case"voice three":c?e.notationNotes[i]+="}\n\\new Voice { \\voiceThree ":(e.notationNotes[i]+="<< { \\voiceThree ",c=!0);break;case"voice four":c?e.notationNotes[i]+="}\n\\new Voice { \\voiceFour ":(e.notationNotes[i]+="<< { \\voiceFour ",c=!0);break;case"one voice":e.notationNotes[i]+="}\n>> \\oneVoice\n",c=!1;break;default:e.notationNotes[i]+=p}else{var T=function(t,e,i,s){for(var l=0,o=0;o<s;){t.notationStaging[e][i+l][NOTATIONDURATION];var a=t.notationStaging[e][i+l][NOTATIONNOTE];if("object"===_typeof(a)){for(1<a.length&&(t.notationNotes[e]+="<"),k=0;k<a.length;k++)t.notationNotes[e]+=r(a[k]),(1===a.length||k<a.length-1)&&(t.notationNotes[e]+=" ");p[NOTATIONSTACCATO]&&(t.notationNotes[e]+=" \\staccato "),1<a.length&&(t.notationNotes[e]+=">"),t.notationNotes[e]+=t.notationStaging[e][i+l][NOTATIONROUNDDOWN],l++,o++}else"tie"===t.notationStaging[e][i+l]?(console.log("adding a tie"),t.notationNotes[e]+="~"):console.log("ignoring "+a),l++,o++}if(i+l-1<t.notationStaging[e].length-1){var n=t.notationStaging[e][i+l];"string"==typeof n&&")"===n?(t.notationNotes[e]+=")} ",i+=1):"string"==typeof n&&"markup"===n?(t.notationNotes[e]+="^\\markup { \\abs-fontsize #6 { "+t.notationStaging[e][i+l+1]+" } } } ",l+=2):"string"==typeof n&&"markdown"===n?(t.notationNotes[e]+="_\\markup {"+t.notationStaging[e][i+l+1]+"} } ",l+=2):t.notationNotes[e]+="} "}else t.notationNotes[e]+="} ";return l};if(s%8==0&&0<s&&(e.notationNotes[i]+="\n"),s+=1,"string"==typeof p[NOTATIONNOTE])r(p[NOTATIONNOTE]);else{var L=p[NOTATIONNOTE];r(L[0])}var w=0,B=null,x=0,S=null,C=0;if(null!=p[NOTATIONTUPLETVALUE]){if(a=1/e.notationStaging[i][h][NOTATIONDURATION],n=1/e.notationStaging[i][h][NOTATIONROUNDDOWN],x=1/(p[NOTATIONTUPLETVALUE][0]*p[NOTATIONTUPLETVALUE][1]),null===S){S=p[NOTATIONROUNDDOWN];C=1}else if(p[NOTATIONROUNDDOWN]>S){var A=p[NOTATIONROUNDDOWN]/S;S=p[NOTATIONROUNDDOWN],C*=A,C+=1}null===B?B=p[NOTATIONTUPLETVALUE][1]:p[NOTATIONTUPLETVALUE][1]<B&&(B=p[NOTATIONTUPLETVALUE][1]);y=1;for(var N=1;N<p[NOTATIONTUPLETVALUE][0]*p[NOTATIONTUPLETVALUE][1];){if(h+y>=e.notationStaging[i].length){w=y;break}if("tie"===e.notationStaging[i][h+y])console.log("saw a tie"),N++,y++;else{if(-1!==[1,.5,.25,.125,.0625].indexOf(x)){w=y;break}if(null===e.notationStaging[i][h+y][NOTATIONTUPLETVALUE]){w=y;break}if(e.notationStaging[i][h+y][NOTATIONTUPLETVALUE][0]!==p[NOTATIONTUPLETVALUE][0]){w=y;break}if(e.notationStaging[i][h+y][NOTATIONROUNDDOWN]>S){A=e.notationStaging[i][h+y][NOTATIONROUNDDOWN]/S;S=e.notationStaging[i][h+y][NOTATIONROUNDDOWN],C*=A,C+=1}else if(e.notationStaging[i][h+y][NOTATIONROUNDDOWN]<S){C+=A=S/e.notationStaging[i][h+y][NOTATIONROUNDDOWN]}else C+=1;a+=1/e.notationStaging[i][h+y][NOTATIONDURATION],n+=1/e.notationStaging[i][h+y][NOTATIONROUNDDOWN],x+=1/(e.notationStaging[i][h+y][NOTATIONTUPLETVALUE][0]*e.notationStaging[i][h+y][NOTATIONTUPLETVALUE][1]),y++,N++}}}if(null!=p[NOTATIONTUPLETVALUE]&&0<p[NOTATIONTUPLETVALUE][0]*p[NOTATIONTUPLETVALUE][1]){if(0===w){var P=(M=toFraction(n/a))[0]*a,I=M[0]*M[1];if(Math.floor(P)!==P)P=(E=toFraction(P/1))[0],I=E[1];e.notationNotes[i]+="\\tuplet "+P+"/"+I+" { ",h+=T(e,i,h,p[NOTATIONTUPLETVALUE][0]*p[NOTATIONTUPLETVALUE][1])-1}else{var M,E;P=(M=toFraction(A=C/S/x))[0],I=M[1];if(Math.floor(P)!==P)P=(E=toFraction(P/1))[0],I=E[1];e.notationNotes[i]+="\\tuplet "+P+"/"+I+" { ",h+=T(e,i,h,w)-1}n=a=0}else{if("object"===_typeof(L)){for(1<L.length&&(e.notationNotes[i]+="<"),k=0;k<L.length;k++)e.notationNotes[i]+=r(L[k]),k<L.length-1&&(e.notationNotes[i]+=" ");1<L.length&&(e.notationNotes[i]+=">"),e.notationNotes[i]+=p[NOTATIONDURATION];for(var O=0;O<p[NOTATIONDOTCOUNT];O++)e.notationNotes[i]+=".";o&&(e.notationNotes[i]+="->"),e.notationNotes[i]+=" "}p[NOTATIONSTACCATO]&&(e.notationNotes[i]+="\\staccato"),n=a=0}e.notationNotes[i]+=" ",l&&(l=!1,e.notationNotes[i]+="(")}}},saveLilypondOutput=function(t){var e=["zero","one","two","three","four","five","six","seven","eight","nine"],i=0,s=[];for(var l in t.notationStaging)i+=1;var o=i;for(var l in t.notationDrumStaging){for(var a=!1,n=0;n<t.notationDrumStaging[l].length;n++){"object"===_typeof(f=t.notationDrumStaging[l][n])&&"object"===_typeof(f[0])&&"R"!==f[0][0]&&(a=!0)}t.notationStaging[i.toString()]=a?t.notationDrumStaging[l]:[],i+=1}console.log("saving as lilypond: "+i),t.notationOutput+="% You can change the MIDI instruments below to anything on this list:\n% (http://lilypond.org/doc/v2.18/documentation/notation/midi-instruments)\n\n";var r=0,c=[];for(var l in t.notationStaging){if(console.log("value of t: "+l),"string"==typeof l)var h=Number(l);else h=l;if(0<t.notationStaging[l].length){var u=0,d=0;for(n=0;n<t.notationStaging[l].length;n++){var f;if("object"===_typeof(f=t.notationStaging[l][n]))for(var p=0;p<f[0].length;p++){if("R"!==f[0][p])"string"==typeof f[0][p]?u+=Number(f[0][p].substr(-1)):u+=frequencyToPitch(f[0][p])[1],d+=1}}if(o-1<h)s.push("percussion");else if(0<d)switch(console.log(u+" "+d+" "+Math.floor(.5+u/d)),Math.floor(.5+u/d)){case 0:case 1:case 2:s.push("bass_8");break;case 3:s.push("bass");break;default:s.push("treble")}else s.push("treble");if(this.freygish="",processLilypondNotes(this,t,l),""!==this.freygish&&(t.notationOutput+=this.freygish),o-1<h)B=(B=_("drum")+e[h-o]).replace(/ /g,"_").replace(".",""),t.notationOutput+=B+" = {\n",t.notationOutput+="\\drummode {\n",t.notationOutput+=t.notationNotes[l],r===i-1&&(t.notationOutput+=' \\bar "|."'),t.notationOutput+="\n}\n",t.notationOutput+="\n}\n\n";else{if(l in t.turtles.turtleList){(B=t.turtles.turtleList[l].name)===_("start")||B===_("start drum")?B=RODENTS[h%12]:B===h.toString()&&(B=RODENTS[h%12])}""===B&&(B=RODENTSEN[h%12]),B=B.replace(/ /g,"_").replace(".",""),t.notationOutput+=B+" = {\n",t.notationOutput+=t.notationNotes[l],r===i-1&&(t.notationOutput+=' \\bar "|."'),t.notationOutput+="\n}\n\n";var b="",m="",g="",k="",v="",y="",T=0,L=B.indexOf("_");if(1===B.length)b=B,c[l]=b;else if(-1===L){for(var w=2;w<B.length;w++)if(2===w?m=B.slice(0,2):m+=B.charAt(w-1),-1===c.indexOf(m)){b=m,c[l]=b;break}}else if(g=B.slice(0,L),k=B.slice(L+1,B.length),m=(v=g.charAt(0))+(y=k.charAt(0)),-1===c.indexOf(m))b=m,c[l]=b,T=1;else if(1!==T){m="";for(;n<B.length;n++){if(m=v+(y+=k.charAt(1)),-1===c.indexOf(m)){b=m,c[l]=b;break}if(m=(v+=g.charAt(1))+y,-1===c.indexOf(m)){b=m,c[l]=b;break}}}console.log("instrumentName: "+B),console.log("shortInstrumentName: "+b)}t.notationOutput+=B.replace(/ /g,"_").replace(".","")+"Voice = ",t.notationOutput+=o-1<h?"\\new DrumStaff \\with {\n":"\\new Staff \\with {\n",t.notationOutput+='   \\clef "'+last(s)+'"\n',t.notationOutput+='   instrumentName = "'+B+'"\n',o-1<h?(t.notationOutput+='   shortInstrumentName = "d"\n',t.notationOutput+='   midiInstrument = "snare drum"\n'):(t.notationOutput+='   shortInstrumentName = "'+b+'"\n',t.notationOutput+='   midiInstrument = "acoustic grand"\n'),t.notationOutput+='\n} { \\clef "'+last(s)+'" \\'+B.replace(/ /g,"_").replace(".","")+" }\n\n"}else s.push("");r+=1}t.notationOutput+="\n\\score {\n",t.notationOutput+="   <<\n";for(r=0;r<CLEFS.length;r++){n=0;for(var l in t.notationNotes){if("string"==typeof l)h=Number(l);else h=l;if(s[h]===CLEFS[r]&&0<t.notationStaging[l].length){if(o-1<h)var B=_("drum")+e[h-o];else{if(l in t.turtles.turtleList)B=t.turtles.turtleList[l].name;else if(h in t.turtles.turtleList)B=t.turtles.turtleList[h].name;else B=_("mouse");B===_("start")||B===_("start drum")?B=RODENTS[h%12]:B===h.toString()&&(B=RODENTS[h%12])}B=B.replace(/ /g,"_").replace(".",""),t.notationOutput+="      \\"+B+"Voice\n"}}}t.notationOutput+=guitarOutputHead;for(r=0;r<CLEFS.length;r++){n=0;for(var l in t.notationNotes){if("string"==typeof l)h=Number(l);else h=l;if(s[n]===CLEFS[r]&&0<t.notationStaging[l].length){if(o-1<h)B=_("drum")+e[h-o];else{if(l in t.turtles.turtleList)B=t.turtles.turtleList[l].name;else if(h in t.turtles.turtleList)B=t.turtles.turtleList[h].name;else B=_("mouse");B===_("start")||B===_("start drum")?B=RODENTS[h%12]:B===h.toString()&&(B=RODENTS[h%12])}B=B.replace(/ /g,"_").replace(".",""),t.notationOutput+='         \\context TabVoice = "'+B+'" \\'+B.replace(/ /g,"_").replace(".","")+"\n"}}}t.notationOutput+=guitarOutputEnd,t.notationOutput+="\n   >>\n   \\layout {}\n\n",t.notationOutput+=MIDIOutput,t.notationOutput+="% MUSIC BLOCKS CODE\n",t.notationOutput+="% Below is the code for the Music Blocks project that generated this Lilypond file.\n%{\n\n";var x=prepareExport();return t.notationOutput+=x.replace(/]],/g,"]],\n"),t.notationOutput+="\n%}\n\n",t.notationOutput},requirejs.config({baseUrl:"lib",shim:{easel:{exports:"createjs"}},paths:{utils:"../js/utils",widgets:"../js/widgets",activity:"../js",easel:"../lib/easeljs",twewn:"../lib/tweenjs",prefixfree:"../bower_components/prefixfree/prefixfree.min",samples:"../sounds/samples",planet:"../js/planet"},packages:[]}),requirejs(["activity/activity"]);var DEFAULTVOLUME=50,PREVIEWVOLUME=80,TONEBPM=240,TARGETBPM=90,DEFAULTDELAY=500,TURTLESTEP=-1,NOTEDIV=8,OSCVOLUMEADJUSTMENT=1.5,NOMICERRORMSG="The microphone is not available.",NANERRORMSG="Not a number.",NOSTRINGERRORMSG="Not a string.",NOBOXERRORMSG="Cannot find box",NOACTIONERRORMSG="Cannot find action.",NOINPUTERRORMSG="Missing argument.",NOSQRTERRORMSG="Cannot take square root of negative number.",ZERODIVIDEERRORMSG="Cannot divide by zero.",EMPTYHEAPERRORMSG="empty heap.",INVALIDPITCH=_("Not a valid pitch name"),POSNUMBER="Argument must be a positive number",NOTATIONNOTE=0,NOTATIONDURATION=1,NOTATIONDOTCOUNT=2,NOTATIONTUPLETVALUE=3,NOTATIONROUNDDOWN=4,NOTATIONINSIDECHORD=5,NOTATIONSTACCATO=6;function Logo(){this.canvas=null,this.blocks=null,this.turtles=null,this.stage=null,this.refreshCanvas=null,this.textMsg=null,this.errorMsg=null,this.hideMsgs=null,this.onStopTurtle=null,this.onRunTurtle=null,this.getStageX=null,this.getStageY=null,this.getStageMouseDown=null,this.getCurrentKeyCode=null,this.clearCurrentKeyCode=null,this.meSpeak=null,this.saveLocally=null,this.showBlocksAfterRun=!1,this.pitchTimeMatrix=null,this.pitchDrumMatrix=null,this.rhythmRuler=null,this.timbre=null,this.pitchStaircase=null,this.temperament=null,this.tempo=null,this.pitchSlider=null,this.musicKeyboard=null,this.modeWidget=null,this.meterWidget=null,this.statusMatrix=null,this.playbackWidget=null,this.attack={},this.decay={},this.sustain={},this.release={},this.evalFlowDict={},this.evalArgDict={},this.evalParameterDict={},this.evalSetterDict={},this.evalOnStartList={},this.evalOnStopList={},this.eventList={},this.receivedArg=null,this.parentFlowQueue={},this.unhighlightQueue={},this.parameterQueue={},this.boxes={},this.actions={},this.returns=[],this.turtleHeaps={},this.invertList={},this.beatList={},this.factorList={},this.switchCases={},this.switchBlocks={},this.endOfClampSignals={},this.butNotThese={},this.lastNoteTimeout=null,this.alreadyRunning=!1,this.prematureRestart=!1,this.runningBlock=null,this.ignoringBlock=null,this.time=0,this.firstNoteTime=null,this.waitTimes={},this.turtleDelay=0,this.sounds=[],this.cameraID=null,this.stopTurtle=!1,this.lastKeyCode=null,this.saveTimeout=0,this.notesPlayed={},this.whichNoteToCount={},this.moveable={},this.playbackQueue={},this.playbackTime=0,beginnerMode?this.optimize=!0:this.optimize=!1,this.showPitchDrumMatrix=!1,this.inPitchDrumMatrix=!1,this.inRhythmRuler=!1,this.rhythmRulerMeasure=null,this.inPitchStaircase=!1,this.inTempo=!1,this.inPitchSlider=!1,this.inMusicKeyboard=!1,this._currentDrumlock=null,this.inTimbre=!1,this.insideModeWidget=!1,this.insideMeterWidget=!1,this.insideTemperament=!1,this.inSetTimbre={},this.inMatrix=!1,this.keySignature={},this.tupletRhythms=[],this.addingNotesToTuplet=!1,this.drumBlocks=[],this.pitchBlocks=[],this.inNoteBlock=[],this.multipleVoices=[],this.scalarTransposition={},this.scalarTranspositionValues={},this.transposition={},this.transpositionValues={},this._masterBPM=TARGETBPM,this.defaultBPMFactor=TONEBPM/this._masterBPM,this.register={},this.beatFactor={},this.dotCount={},this.noteBeat={},this.noteValue={},this.oscList={},this.noteDrums={},this.notePitches={},this.noteOctaves={},this.noteCents={},this.noteHertz={},this.noteBeatValues={},this.embeddedGraphics={},this.lastNotePlayed={},this.lastPitchPlayed={},this.previousNotePlayed={},this.noteStatus={},this.noteDirection={},this.pitchNumberOffset=[],this.currentOctave={},this.currentCalculatedOctave={},this.currentNote={},this.inHarmonic={},this.partials={},this.inNeighbor=[],this.neighborStepPitch={},this.neighborNoteValue={},this.inDefineMode={},this.defineMode={},this.pickup={},this.beatsPerMeasure={},this.noteValuePerBeat={},this.currentBeat={},this.currentMeasure={},this.bpm={},this.previousTurtleTime=[],this.turtleTime=[],this.noteDelay=0,this.playedNote={},this.playedNoteTimes={},this.pushedNote={},this.connectionStore={},this.connectionStoreLock=!1,this.duplicateFactor={},this.inDuplicate={},this.skipFactor={},this.skipIndex={},this.instrumentNames={},this.inCrescendo={},this.crescendoDelta={},this.crescendoInitialVolume={},this.intervals={},this.semitoneIntervals={},this.markup={},this.staccato={},this.glide={},this.glideOverride={},this.swing={},this.swingTarget={},this.swingCarryOver={},this.tie={},this.tieNotePitches={},this.tieNoteExtras={},this.tieCarryOver={},this.tieFirstDrums={},this.masterVolume=[],this.synthVolume={},this.validNote=!0,this.drift={},this.drumStyle={},this.voices={},this.backward={},this.vibratoIntensity={},this.vibratoRate={},this.distortionAmount={},this.tremoloFrequency={},this.tremoloDepth={},this.rate={},this.octaves={},this.baseFrequency={},this.chorusRate={},this.delayTime={},this.chorusDepth={},this.neighborArgNote1={},this.neighborArgNote2={},this.neighborArgBeat={},this.neighborArgCurrentBeat={},this.justCounting={},this.justMeasuring={},this.firstPitch={},this.lastPitch={},this.suppressOutput={},this.dispatchFactor={},this.tuplet=!1,this.tupletParams=[],this.pitchDrumTable={},this.notationStaging={},this.notationDrumStaging={},this.notationOutput="",this.notationNotes={},this.pickupPOW2={},this.pickupPoint={},this.runningLilypond=!1,this.runningAbc=!1,this.checkingCompletionState=!1,this.compiling=!1,this.recording=!1,this.lastNote={},this.restartPlayback=!0,this.progressBar=docById("myBar"),this.progressBarWidth=0,this.progressBarDivision,this.temperamentSelected=[],this.customTemperamentDefined=!1,this._saveX={},this._saveY={},this._saveColor={},this._saveValue={},this._saveChroma={},this._saveStroke={},this._saveCanvasAlpha={},this._saveOrientation={},this._savePenState={},this.blinkState=!0,this.optimize?createjs.Ticker.framerate=10:createjs.Ticker.framerate=30,_THIS_IS_MUSIC_BLOCKS_?(this.synth=new Synth,this.synth.changeInTemperament=!1):this.turtleOscs={},this._modeBlock=null,this._meterBlock=null,this.inStatusMatrix=!1,this.updatingStatusMatrix=!1,this.statusFields=[],this.stepQueue={},this.unhighlightStepQueue={},this.cp1x={},this.cp1y={},this.cp2x={},this.cp2y={},this.svgOutput="",this.svgBackground=!0,this.mic=null,this.volumeAnalyser=null,this.pitchAnalyser=null,this.setOptimize=function(t){t?(createjs.Ticker.framerate=10,this.optimize=!0):(createjs.Ticker.framerate=10,this.optimize=!1),this.blinkState=!0},this.setSetPlaybackStatus=function(t){return this.setPlaybackStatus=t,this},this.setCanvas=function(t){return this.canvas=t,this},this.setBlocks=function(t){return this.blocks=t,this},this.setTurtles=function(t){return this.turtles=t,this},this.setStage=function(t){return this.stage=t,this},this.setRefreshCanvas=function(t){return this.refreshCanvas=t,this},this.setTextMsg=function(t){return this.textMsg=t,this},this.setHideMsgs=function(t){return this.hideMsgs=t,this},this.setErrorMsg=function(t){return this.errorMsg=t,this},this.setOnStopTurtle=function(t){return this.onStopTurtle=t,this},this.setOnRunTurtle=function(t){return this.onRunTurtle=t,this},this.setGetStageX=function(t){return this.getStageX=t,this},this.setGetStageY=function(t){return this.getStageY=t,this},this.setGetStageMouseDown=function(t){return this.getStageMouseDown=t,this},this.setGetCurrentKeyCode=function(t){return this.getCurrentKeyCode=t,this},this.setClearCurrentKeyCode=function(t){return this.clearCurrentKeyCode=t,this},this.setMeSpeak=function(t){return this.meSpeak=t,this},this.setSaveLocally=function(t){return this.saveLocally=t,this},this.setTurtleDelay=function(t){this.turtleDelay=t,this.noteDelay=0},this.setNoteDelay=function(t){this.noteDelay=t,this.turtleDelay=0},this.step=function(){for(var t in this.stepQueue)if(0<this.stepQueue[t].length){t in this.unhighlightStepQueue&&null!=this.unhighlightStepQueue[t]&&(this.blocks.visible&&this.blocks.unhighlight(this.unhighlightStepQueue[t]),this.unhighlightStepQueue[t]=null);var e=this.stepQueue[t].pop();null!=e&&this._runFromBlockNow(this,t,e,0,null)}},this.stepNote=function(){var r={},c={},h={},u=this;!function t(){for(var e in u.stepQueue)if(!(e in u.playedNote&&u.playedNote[e])&&0<u.stepQueue[e].length){e in u.unhighlightStepQueue&&null!=u.unhighlightStepQueue[e]&&(u.blocks.visible&&u.blocks.unhighlight(u.unhighlightStepQueue[e]),u.unhighlightStepQueue[e]=null);var i=u.stepQueue[e].pop();if(null!=i&&i!==c[e]){var s=u.blocks.blockList[i];"newnote"===s.name&&(r[e]=i,c[e]=last(s.connections),null==c[e]&&(c[e]=last(u.turtles.turtleList[e].queue)&&last(u.turtles.turtleList[e].queue).blk),u.playedNoteTimes[e]=u.playedNoteTimes[e]||0,h[e]=Math.pow(u.parseArg(u,e,s.connections[1],i,u.receivedArg),-1),u.playedNoteTimes[e]+=h[e]),u._runFromBlockNow(u,e,i,0,null)}else u.playedNote[e]=!0}var l=!1;for(var e in u.stepQueue)if(0<u.stepQueue[e].length&&!u.playedNote[e]){l=!0;break}if(l)t();else{var o=[];for(var e in u.playedNote)u.playedNote[e]=!1,o.push(u.playedNoteTimes[e]);var a,n=Math.min.apply(null,o);for(var e in u.playedNoteTimes)u.playedNoteTimes[e]>n?(a=r[e],u.playedNoteTimes[e]-=h[e]):a=c[e],u._runFromBlock(u,e,a,0,null);n===Math.max.apply(null,o)&&(u.playedNoteTimes={})}}()},this.recordingStatus=function(){return this.recording||this.runningLilypond||this.runningAbc},this.doStopTurtle=function(){for(var t in this.stopTurtle=!0,this.turtles.markAsStopped(),this.playbackTime=0,this.sounds)this.sounds[t].stop();if(this.sounds=[],_THIS_IS_MUSIC_BLOCKS_){for(var e=0;e<this.turtles.turtleList.length;e++)for(var i in instruments[e])this.synth.stopSound(e,i);this.synth.stop()}null!=this.cameraID&&doStopVideoCam(this.cameraID,this.setCameraID),this.onStopTurtle(),this.blocks.bringToTop(),this.stepQueue={},this.unhighlightQueue={},this._restoreConnections(),document.body.style.cursor="default",this.showBlocksAfterRun&&(console.log("SHOW BLOCKS"),this.showBlocks(),document.getElementById("stop").style.color="white"),this.showBlocksAfterRun=!1},this._restoreConnections=function(){for(var t in this.connectionStore)for(var e in this.connectionStore[t])for(var i=this.connectionStore[t][e].length,s=0;s<i;s++){var l=this.connectionStore[t][e].pop();this.blocks.blockList[l[0]].connections[l[1]]=l[2],null!=l[2]&&(this.blocks.blockList[l[2]].connections[0]=l[0])}},this._clearParameterBlocks=function(){for(var t=0;t<this.blocks.blockList.length;t++)switch(this.blocks.blockList[t].name){case"and":case"or":case"not":case"less":case"greater":case"equal":case"random":case"mod":case"sqrt":case"abs":case"int":case"plus":case"minus":case"multiply":case"power":case"divide":case"namedbox":case"box":case"x":case"y":case"heading":case"color":case"hue":case"shade":case"grey":case"pensize":case"time":case"mousex":case"mousey":case"toppos":case"rightpos":case"leftpos":case"bottompos":case"width":case"height":case"keyboard":case"loudness":case"consonantstepsizeup":case"consonantstepsizedown":case"transpositionfactor":case"staccatofactor":case"slurfactor":case"beatfactor":case"elapsednotes":case"duplicatefactor":case"skipfactor":case"notevolumefactor":case"currentnote":case"currentoctave":case"bpmfactor":case"beatvalue":case"measurevalue":case"deltapitch":case"mypitch":case"mynotevalue":this.blocks.blockList[t].text.text="",this.blocks.blockList[t].container.updateCache()}this.refreshCanvas()},this._updateParameterBlock=function(that,turtle,blk){var logo=that;if(this.blocks.blockList[blk].protoblock.parameter){var name=this.blocks.blockList[blk].name,value=0;switch(name){case"and":case"or":case"not":case"less":case"greater":case"equal":value=this.blocks.blockList[blk].value?_("true"):_("false");break;case"random":case"mod":case"sqrt":case"abs":case"int":case"plus":case"minus":case"multiply":case"power":value=toFixed2(this.blocks.blockList[blk].value);break;case"divide":value=this.blocks.blockList[blk].value;break;case"namedbox":var name=this.blocks.blockList[blk].privateData;name in this.boxes?value=this.boxes[name]:this.errorMsg(NOBOXERRORMSG,blk,name);break;case"box":var cblk=this.blocks.blockList[blk].connections[1],boxname=this.parseArg(that,turtle,cblk,blk,this.receivedArg);boxname in this.boxes?value=this.boxes[boxname]:this.errorMsg(NOBOXERRORMSG,blk,boxname);break;case"x":value=toFixed2(this.turtles.turtleList[turtle].x);break;case"y":value=toFixed2(this.turtles.turtleList[turtle].y);break;case"heading":value=toFixed2(this.turtles.turtleList[turtle].orientation);break;case"color":case"hue":value=toFixed2(this.turtles.turtleList[turtle].color);break;case"shade":value=toFixed2(this.turtles.turtleList[turtle].value);break;case"grey":value=toFixed2(this.turtles.turtleList[turtle].chroma);break;case"pensize":value=toFixed2(this.turtles.turtleList[turtle].stroke);break;case"time":var d=new Date;value=(d.getTime()-this.time)/1e3;break;case"mousex":value=toFixed2(this.getStageX());break;case"mousey":value=toFixed2(this.getStageY());break;case"toppos":value=toFixed2(this.turtles._canvas.height/(2*this.turtles.scale));break;case"rightpos":value=toFixed2(this.turtles._canvas.width/(2*this.turtles.scale));break;case"leftpos":value=toFixed2(this.turtles._canvas.width/(2*this.turtles.scale)*-1);break;case"bottompos":value=toFixed2(this.turtles._canvas.height/(2*this.turtles.scale)*-1);break;case"width":value=toFixed2(that.turtles._canvas.width/that.turtles.scale);break;case"height":value=toFixed2(that.turtles._canvas.height/that.turtles.scale);break;case"keyboard":value=this.lastKeyCode;break;case"loudness":if(null==this.mic)this.errorMsg(NOMICERRORMSG),value=0;else if(_THIS_IS_TURTLE_BLOCKS)value=Math.round(1e3*this.mic.getLevel());else{null==this.volumeAnalyser&&(this.volumeAnalyser=new Tone.Analyser({type:"waveform",size:this.limit}),this.mic.connect(this.volumeAnalyser));for(var values=that.volumeAnalyser.getValue(),sum=0,k=0;k<that.limit;k++)sum+=values[k]*values[k];var rms=Math.sqrt(sum/that.limit);that.blocks.blockList[blk].value=Math.round(100*rms)}break;case"consonantstepsizeup":if(null!==this.lastNotePlayed[turtle]){var len=this.lastNotePlayed[turtle][0].length;value=getStepSizeUp(this.keySignature[turtle],this.lastNotePlayed[turtle][0].slice(0,len-1))}else value=getStepSizeUp(this.keySignature[turtle],"G");break;case"consonantstepsizedown":if(null!==this.lastNotePlayed[turtle]){var len=this.lastNotePlayed[turtle][0].length;value=getStepSizeDown(this.keySignature[turtle],this.lastNotePlayed[turtle][0].slice(0,len-1))}else value=getStepSizeDown(this.keySignature[turtle],"G");break;case"transpositionfactor":value=this.transposition[turtle];break;case"staccatofactor":value=last(this.staccato[turtle]);break;case"slurfactor":value=-last(this.staccato[turtle]);break;case"beatfactor":value=this.beatFactor[turtle];break;case"elapsednotes":value=this.notesPlayed[turtle];break;case"duplicatefactor":value=this.duplicateFactor[turtle];break;case"skipfactor":value=this.skipFactor[turtle];break;case"notevolumefactor":value=last(this.masterVolume);break;case"deltapitch":if(null!==this.lastNotePlayed[turtle]&&null!==this.previousNotePlayed[turtle]){var len=this.previousNotePlayed[turtle][0].length,pitch=this.previousNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(this.previousNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave],previousValue=pitchToNumber(obj[0],obj[1],this.keySignature[turtle]);len=this.lastNotePlayed[turtle][0].length,pitch=this.lastNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(this.lastNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave],value=pitchToNumber(obj[0],obj[1],this.keySignature[turtle])-previousValue}else value=0;value=value.toString();break;case"deltapitch2":if(null!==this.lastNotePlayed[turtle]&&null!==this.previousNotePlayed[turtle]){var len=this.previousNotePlayed[turtle][0].length,pitch=this.previousNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(this.previousNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave],previousValue=pitchToNumber(obj[0],obj[1],this.keySignature[turtle]);len=this.lastNotePlayed[turtle][0].length,pitch=this.lastNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(this.lastNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave];var delta=pitchToNumber(obj[0],obj[1],this.keySignature[turtle])-previousValue,scalarDelta=0,i=0;if(0<delta){for(;0<delta;){i+=1;var nhalf=getStepSizeUp(this.keySignature[turtle],pitch,0,"equal");if(delta-=nhalf,scalarDelta+=1,obj=getNote(pitch,octave,nhalf,this.keySignature[turtle],this.moveable[turtle],null,this.errorMsg,this.synth.inTemperament),pitch=obj[0],octave=obj[1],100<i)break}value=scalarDelta}else{for(;delta<0;){i+=1;var nhalf=getStepSizeDown(this.keySignature[turtle],pitch,0,"equal");if(delta-=nhalf,scalarDelta-=1,obj=getNote(pitch,octave,nhalf,this.keySignature[turtle],this.moveable[turtle],null,this.errorMsg,this.synth.inTemperament),pitch=obj[0],octave=obj[1],100<i)break}value=scalarDelta}}else value=0;value=value.toString();case"mypitch":if(null!==this.lastNotePlayed[turtle]){var len=this.lastNotePlayed[turtle][0].length;value=pitchToNumber(this.lastNotePlayed[turtle][0].slice(0,len-1),parseInt(this.lastNotePlayed[turtle][0].slice(len-1)),this.keySignature[turtle])-this.pitchNumberOffset[turtle]}else value=pitchToNumber("G",4,this.keySignature[turtle])-this.pitchNumberOffset;value=value.toString();break;case"bpmfactor":console.log(this.bpm[turtle]),value=0<this.bpm[turtle].length?last(this.bpm[turtle]):(this.bpm[turtle].push(this._masterBPM),this._masterBPM);break;case"beatvalue":value=this.currentBeat[turtle].toString();break;case"synthname":value=last(this.instrumentNames[turtle]);break;case"measurevalue":value=this.currentMeasure[turtle].toString();break;case"mynotevalue":value=null,value=null!==this.noteValue[turtle][last(this.inNoteBlock[turtle])]?1/this.noteValue[turtle][last(this.inNoteBlock[turtle])]:null!==this.lastNotePlayed[turtle]?this.lastNotePlayed[turtle][1]:0<this.notePitches[turtle][last(this.inNoteBlock[turtle])].length?this.noteBeat[turtle][last(this.inNoteBlock[turtle])]:-1,0!==value&&(value=mixedNumber(1/value));break;default:if(!(name in this.evalParameterDict))return;eval(this.evalParameterDict[name])}"string"==typeof value?(6<value.length&&(value=value.substr(0,5)+"..."),this.blocks.blockList[blk].text.text=value):this.blocks.blockList[blk].text.text="divide"===name?mixedNumber(value):value.toString(),this.blocks.blockList[blk].container.updateCache(),this.refreshCanvas()}},this.initMediaDevices=function(){var e=this;if(console.log("INIT MICROPHONE"),_THIS_IS_MUSIC_BLOCKS_){var i=new Tone.UserMedia;try{i.open()}catch(t){console.log("MIC NOT FOUND"),console.log(t.name+": "+t.message),console.log(i),e.errorMsg(NOMICERRORMSG),i=null}this.mic=i,this.limit=1024}else try{this.mic=new p5.AudioIn,e.mic.start()}catch(t){console.log(t),this.errorMsg(NOMICERRORMSG),this.mic=null}},this.initTurtle=function(t){this.previousTurtleTime[t]=0,this.turtleTime[t]=0,this.waitTimes[t]=0,this.endOfClampSignals[t]={},this.butNotThese[t]={},this.cp1x[t]=0,this.cp1y[t]=100,this.cp2x[t]=100,this.cp2y[t]=100,this.inNoteBlock[t]=[],this.multipleVoices[t]=!1,this.scalarTransposition[t]=0,this.scalarTranspositionValues[t]=[],this.transposition[t]=0,this.transpositionValues[t]=[],this.noteBeat[t]={},this.noteValue[t]={},this.noteCents[t]={},this.noteHertz[t]={},this.lastNotePlayed[t]=null,this.previousNotePlayed[t]=null,this.noteStatus[t]=null,this.noteDirection[t]=0,this.noteDrums[t]={},this.notePitches[t]={},this.noteOctaves[t]={},this.currentOctave[t]=4,this.register[t]=0,this.noteBeatValues[t]={},this.embeddedGraphics[t]={},this.embeddedGraphicsFinished[t]=!0,this.beatFactor[t]=1,this.dotCount[t]=0,this.invertList[t]=[],this.beatList[t]=[],this.factorList[t]=[],this.switchCases[t]={},this.switchBlocks[t]=[],this.connectionStore[t]={},this.connectionStoreLock=!1,this.duplicateFactor[t]=1,this.inDuplicate[t]=!1,this.skipFactor[t]=1,this.skipIndex[t]=0,this.notesPlayed[t]=[0,1],this.whichNoteToCount[t]=1,this.keySignature[t]="C major",this.pushedNote[t]=!1,this.oscList[t]={},this.bpm[t]=[],this.inSetTimbre[t]=!1,this.instrumentNames[t]=["electronic synth"],this.inCrescendo[t]=[],this.crescendoDelta[t]=[],this.crescendoInitialVolume[t]={"electronic synth":[DEFAULTVOLUME]},this.intervals[t]=[],this.semitoneIntervals[t]=[],this.markup[t]=[],this.staccato[t]=[],this.glide[t]=[],this.glideOverride[t]=0,this.swing[t]=[],this.swingTarget[t]=[],this.swingCarryOver[t]=0,this.tie[t]=!1,this.tieNotePitches[t]=[],this.tieNoteExtras[t]=[],this.tieCarryOver[t]=0,this.tieFirstDrums[t]=[],this.drift[t]=0,this.drumStyle[t]=[],this.voices[t]=[],this.pitchDrumTable[t]={},this.backward[t]=[],this.vibratoIntensity[t]=[],this.vibratoRate[t]=[],this.tremoloDepth[t]=[],this.tremoloFrequency[t]=[],this.distortionAmount[t]=[],this.attack[t]=[],this.decay[t]=[],this.sustain[t]=[],this.release[t]=[],this.rate[t]=[],this.octaves[t]=[],this.baseFrequency[t]=[],this.chorusRate[t]=[],this.delayTime[t]=[],this.chorusDepth[t]=[],this.neighborArgNote1[t]=[],this.neighborArgNote2[t]=[],this.neighborArgBeat[t]=[],this.neighborArgCurrentBeat[t]=[],this.inDefineMode[t]=!1,this.defineMode[t]=[],this.dispatchFactor[t]=1,this.pickup[t]=0,this.beatsPerMeasure[t]=4,this.noteValuePerBeat[t]=4,this.currentBeat[t]=0,this.currentMeasure[t]=0,this.justCounting[t]=[],this.justMeasuring[t]=[],this.notationStaging[t]=[],this.notationDrumStaging[t]=[],this.pickupPoint[t]=null,this.pickupPOW2[t]=!1,this.firstPitch[t]=[],this.lastPitch[t]=[],this.pitchNumberOffset[t]=39,this.suppressOutput[t]=this.runningLilypond||this.runningAbc||this.compiling,this.moveable[t]=!1,this.inNeighbor[t]=[],this.neighborStepPitch[t]=[],this.neighborNoteValue[t]=[],this.inHarmonic[t]=[],this.partials[t]=[],_THIS_IS_MUSIC_BLOCKS_?this.playbackQueue[t]=[]:!t in this.playbackQueue&&(this.playbackQueue[t]=[]),this.compiling&&(this._saveX[t]=this.turtles.turtleList[t].x,this._saveY[t]=this.turtles.turtleList[t].y,this._saveColor[t]=this.turtles.turtleList[t].color,this._saveValue[t]=this.turtles.turtleList[t].value,this._saveChroma[t]=this.turtles.turtleList[t].chroma,this._saveStroke[t]=this.turtles.turtleList[t].stroke,this._saveCanvasAlpha[t]=this.turtles.turtleList[t].canvasAlpha,this._saveOrientation[t]=this.turtles.turtleList[t].orientation,this._savePenState[t]=this.turtles.turtleList[t].penState)},this.runLogoCommands=function(startHere,env){for(var arg in this.prematureRestart=this.alreadyRunning,this.alreadyRunning&&null!==this.runningBlock?(this.ignoringBlock=this.runningBlock,console.log(this.alreadyRunning+" "+this.runningBlock)):this.ignoringBlock=null,null!=this.lastNoteTimeout&&(console.log("clearing lastNoteTimeout"),clearTimeout(this.lastNoteTimeout),this.lastNoteTimeout=null),this._restoreConnections(),this.saveLocally(),this.evalOnStartList)eval(this.evalOnStartList[arg]);this.stopTurtle=!1,this.blocks.unhighlightAll(),this.blocks.bringToTop(),this.hideMsgs();var d=new Date;this.time=d.getTime(),this.firstNoteTime=null,0===this.turtles.turtleList.length&&this.turtles.add(null),this._masterBPM=TARGETBPM,this.defaultBPMFactor=TONEBPM/this._masterBPM,this.masterVolume=[DEFAULTVOLUME],_THIS_IS_MUSIC_BLOCKS_&&(this.synth.changeInTemperament=!1),this.checkingCompletionState=!1,this.embeddedGraphicsFinished={},_THIS_IS_MUSIC_BLOCKS_&&this._prepSynths(),this.notationStaging={},this.notationDrumStaging={};for(var turtle=0;turtle<this.turtles.turtleList.length;turtle++)this.initTurtle(turtle);this.inPitchDrumMatrix=!1,this.inMatrix=!1,this.inMusicKeyboard=!1,this.inTimbre=!1,this.inRhythmRuler=!1,this.insideModeWidget=!1,this.insideMeterWidget=!1,this.insideTemperament=!1,this.rhythmRulerMeasure=null,this._currentDrumBlock=null,this.inStatusMatrix=!1,this.pitchBlocks=[],this.drumBlocks=[],this.tuplet=!1,this._modeBlock=null,this._meterBlock=null;for(var turtle=0;turtle<this.turtles.turtleList.length;turtle++){for(var listener in this.turtles.turtleList[turtle].listeners)this.stage.removeEventListener(listener,this.turtles.turtleList[turtle].listeners[listener],!1);this.turtles.turtleList[turtle].listeners={}}for(var turtle=0;turtle<this.turtles.turtleList.length;turtle++)this.turtles.turtleList[turtle].container.x=this.turtles.turtleX2screenX(this.turtles.turtleList[turtle].x),this.turtles.turtleList[turtle].container.y=this.turtles.turtleY2screenY(this.turtles.turtleList[turtle].y);"visible"===docById("statusDiv").style.visibility&&(null===this.statusMatrix&&(this.statusMatrix=new StatusMatrix),this.statusMatrix.init(this));var startBlocks=[];this.blocks.findStacks(),this.actions={};for(var blk=0;blk<this.blocks.stackList.length;blk++)if(-1!==["start","drum","status"].indexOf(this.blocks.blockList[this.blocks.stackList[blk]].name))this.blocks.blockList[this.blocks.stackList[blk]].trash||startBlocks.push(this.blocks.stackList[blk]);else if("action"===this.blocks.blockList[this.blocks.stackList[blk]].name){var c=this.blocks.blockList[this.blocks.stackList[blk]].connections[1],b=this.blocks.blockList[this.blocks.stackList[blk]].connections[2];null!=c&&null!=b&&(this.blocks.blockList[this.blocks.stackList[blk]].trash||(this.actions[this.blocks.blockList[c].value]=b))}this.svgOutput="",this.svgBackground=!0;for(var turtle=0;turtle<this.turtles.turtleList.length;turtle++)turtle in this.parentFlowQueue&&(this.parentFlowQueue[turtle]=[]),turtle in this.unhighlightQueue&&(this.unhighlightQueue[turtle]=[]),turtle in this.parameterQueue&&(this.parameterQueue[turtle]=[]);0===this.turtleDelay&&this._clearParameterBlocks(),this.onRunTurtle(),0===this.turtles.turtleList.length&&(console.log("No start block... adding a turtle"),this.turtles.addTurtle(null));for(var turtle=0;turtle<this.turtles.turtleList.length;turtle++)this.turtles.turtleList[turtle].running&&console.log("already running..."),this.turtles.turtleList[turtle].running=!1;if(null!=startHere){for(var turtle=0;this.turtles.turtleList[turtle].trash&&turtle<this.turtles.turtleList.length;)turtle+=1;-1!==["start","drum"].indexOf(this.blocks.blockList[startHere].name)&&(turtle=this.blocks.blockList[startHere].value),this.turtles.turtleList[turtle].queue=[],this.parentFlowQueue[turtle]=[],this.unhighlightQueue[turtle]=[],this.parameterQueue[turtle]=[],this.turtles.turtleList[turtle].running&&console.log("already running..."),this.turtles.turtleList[turtle].running=!0,this._runFromBlock(this,turtle,startHere,0,env)}else if(0<startBlocks.length){for(var delayStart=0,b=0;b<startBlocks.length;b++)if("status"===this.blocks.blockList[startBlocks[b]].name&&!this.blocks.blockList[startBlocks[b]].trash){var turtle=0;this.turtles.turtleList[turtle].queue=[],this.parentFlowQueue[turtle]=[],this.unhighlightQueue[turtle]=[],this.parameterQueue[turtle]=[],this.turtles.turtleList[turtle].running&&console.log("already running..."),this.turtles.turtleList[turtle].running=!0,delayStart=250,this._runFromBlock(this,turtle,startBlocks[b],0,env)}var that=this;setTimeout(function(){0!==delayStart&&that.onRunTurtle();for(var t=0;t<startBlocks.length;t++)if("status"!==that.blocks.blockList[startBlocks[t]].name){var e=that.blocks.blockList[startBlocks[t]].value;that.turtles.turtleList[e].queue=[],that.parentFlowQueue[e]=[],that.unhighlightQueue[e]=[],that.parameterQueue[e]=[],that.turtles.turtleList[e].trash||(that.turtles.turtleList[e].running&&console.log("already running..."),that.turtles.turtleList[e].running=!0,that._runFromBlock(that,e,startBlocks[t],0,env))}},delayStart)}else console.log("Empty start block: "+turtle+" "+this.suppressOutput[turtle]),!this.suppressOutput[turtle]&&null!=this.suppressOutput[turtle]||(this.suppressOutput[turtle]=!1,this.checkingCompletionState=!1,document.body.style.cursor="default");this.refreshCanvas()},this._runFromBlock=function(t,e,i,s,l){if(null!=(this.runningBlock=i)){this.receivedArg=l;var o=t.turtleDelay+t.waitTimes[e];t.waitTimes[e]=0,t.stopTurtle||(t.turtleDelay===TURTLESTEP?(e in t.stepQueue||(t.stepQueue[e]=[]),t.stepQueue[e].push(i)):setTimeout(function(){t._runFromBlockNow(t,e,i,s,l)},o))}},this._blockSetter=function(blk,value,turtle){var turtleObj=this.turtles.turtleList[turtle];switch(console.log(this.blocks.blockList[blk].name),this.blocks.blockList[blk].name){case"x":turtleObj.doSetXY(value,turtleObj.y),0===this.justCounting[turtle].length&&this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setxy",value,turtleObj.y]);break;case"y":turtleObj.doSetXY(turtleObj.x,value),0===this.justCounting[turtle].length&&this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setxy",turtleObj.x,value]);break;case"heading":turtleObj.doSetHeading(value),this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setheading",value]);break;case"color":turtleObj.doSetColor(value),0===this.justCounting[turtle].length&&this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setcolor",value]);break;case"shade":turtleObj.doSetValue(value),0===this.justCounting[turtle].length&&this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setshade",value]);break;case"grey":turtleObj.doSetChroma(value),0===this.justCounting[turtle].length&&this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setgrey",value]);break;case"pensize":turtleObj.doSetPensize(value),0===this.justCounting[turtle].length&&this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setpensize",value]);break;case"namedbox":var name=this.blocks.blockList[blk].privateData;name in this.boxes?this.boxes[name]=value:this.errorMsg(NOBOXERRORMSG,blk,name);break;case"box":var cblk=this.blocks.blockList[blk].connections[1],name=this.parseArg(this,turtle,cblk,blk,this.receivedArg);name in this.boxes?this.boxes[name]=value:this.errorMsg(NOBOXERRORMSG,blk,name);break;case"bpmfactor":var len=this.bpm[turtle].length;0<len?this.bpm[turtle][len-1]=value:this.bpm[turtle].push(value);break;case"transpositionfactor":var len=this.transposition[turtle].length;0<len&&(this.transposition[turtle][len-1]=value);break;case"staccatofactor":var len=this.staccato[turtle].length;0<len&&(this.staccato[turtle][len-1]=value);break;case"slurfactor":var len=this.staccato[turtle].length;0<len&&(this.staccato[turtle][len-1]=-value);break;case"beatfactor":this.beatFactor[turtle]=value;break;case"duplicatefactor":var len=this.duplicateFactor[turtle].length;0<len&&(this.duplicateFactor[turtle][len-1]=value);break;case"skipfactor":var len=this.skipFactor[turtle].length;0<len&&(this.skipFactor[turtle][len-1]=value);break;case"mypitch":this.previousNotePlayed[turtle]=this.lastNotePlayed[turtle];var obj=numberToPitch(value+this.pitchNumberOffset[turtle]);this.lastNotePlayed[turtle]=[obj[0]+obj[1],this.lastNotePlayed[turtle][1]];break;case"notevolumefactor":var len=this.masterVolume.length;this.masterVolume[len-1]=value,this.suppressOutput[turtle]||this._setMasterVolume(value),0===this.justCounting[turtle].length&&this._playbackPush(turtle,[this.previousTurtleTime[turtle],"setvolume",value]);break;default:if(this.blocks.blockList[blk].name in this.evalSetterDict){eval(this.evalSetterDict[this.blocks.blockList[blk].name]);break}this.errorMsg(_("Block does not support incrementing."),blk)}},this._runFromBlockNow=function(that,turtle,blk,isflow,receivedArg,queueStart){this.alreadyRunning=!0;var logo=that;this.receivedArg=receivedArg,void 0===queueStart&&(queueStart=0);var args=[];if(0<that.blocks.blockList[blk].protoblock.args)for(var i=1;i<that.blocks.blockList[blk].protoblock.args+1;i++)"in"===that.blocks.blockList[blk].protoblock.dockTypes[i]&&null==that.blocks.blockList[blk].connections[i]?console.log("skipping null inflow args"):args.push(that.parseArg(that,turtle,that.blocks.blockList[blk].connections[i],blk,receivedArg));if(that.blocks.blockList[blk].isValueBlock())var nextFlow=null;else{if(0<that.backward[turtle].length){if("backward"===that.blocks.blockList[last(that.backward[turtle])].name)var c=1;else var c=2;if(that.blocks.sameGeneration(that.blocks.blockList[last(that.backward[turtle])].connections[c],blk)){var nextFlow=that.blocks.blockList[blk].connections[0];if("action"===that.blocks.blockList[nextFlow].name||"backward"===that.blocks.blockList[nextFlow].name)nextFlow=null;else if(that.blocks.sameGeneration(that.blocks.blockList[last(that.backward[turtle])].connections[c],nextFlow))var nextFlow=that.blocks.blockList[blk].connections[0];else var nextFlow=last(that.blocks.blockList[blk].connections)}else var nextFlow=last(that.blocks.blockList[blk].connections)}else var nextFlow=last(that.blocks.blockList[blk].connections);-1===nextFlow&&(nextFlow=null);var queueBlock=new Queue(nextFlow,1,blk,receivedArg);null!=nextFlow&&that.turtles.turtleList[turtle].queue.push(queueBlock)}var childFlow=null,childFlowCount=0,actionArgs=[];switch(that.blocks.visible&&(that.suppressOutput[turtle]||0!==that.justCounting[turtle].length||that.blocks.highlight(blk,!1)),that.blocks.blockList[blk].name){case"dispatch":if(1===args.length){if(!(args[0]in that.eventList)){var event=new Event(args[0]);that.eventList[args[0]]=event}that.stage.dispatchEvent(args[0])}break;case"listen":if(2===args.length)if(args[1]in that.actions){var __listener=function(t){if(that.turtles.turtleList[turtle].running){var e=new Queue(that.actions[args[1]],1,blk);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(e)}else isflow?that._runFromBlockNow(that,turtle,that.actions[args[1]],isflow,receivedArg):that._runFromBlock(that,turtle,that.actions[args[1]],isflow,receivedArg)};that._setListener(turtle,args[0],__listener)}else that.errorMsg(NOACTIONERRORMSG,blk,args[1]);break;case"start":case"drum":1===args.length&&(childFlow=args[0],childFlowCount=1);break;case"nameddo":var name=that.blocks.blockList[blk].privateData;if(name in that.actions){if(0===that.justCounting[turtle].length&&that.notationLineBreak(turtle),0<that.backward[turtle].length){childFlow=that.blocks.findBottomBlock(that.actions[name]);var actionBlk=that.blocks.findTopBlock(that.actions[name]);that.backward[turtle].push(actionBlk);var listenerName="_backward_action_"+turtle+"_"+blk;that._setDispatchBlock(blk,turtle,listenerName);var nextBlock=that.blocks.blockList[actionBlk].connections[2];null==nextBlock?that.backward[turtle].pop():nextBlock in that.endOfClampSignals[turtle]?that.endOfClampSignals[turtle][nextBlock].push(listenerName):that.endOfClampSignals[turtle][nextBlock]=[listenerName];var __listener=function(t){that.backward[turtle].pop()};that._setListener(turtle,listenerName,__listener)}else childFlow=that.actions[name];childFlowCount=1}else that.errorMsg(NOACTIONERRORMSG,blk,name);break;case"action":case"do":0<args.length&&(args[0]in that.actions?(0===that.justCounting[turtle].length&&that.notationLineBreak(turtle),console.log("action: "+args[0]),childFlow=that.actions[args[0]],childFlowCount=1):(console.log("action "+args[0]+" not found"),that.errorMsg(NOACTIONERRORMSG,blk,args[0])));break;case"nameddoArg":for(var name=that.blocks.blockList[blk].privateData;0<actionArgs.length;)actionArgs.pop();if(0<that.blocks.blockList[blk].argClampSlots.length)for(var i=0;i<that.blocks.blockList[blk].argClampSlots.length;i++)if(null!=that.blocks.blockList[blk].connections[i+1]){var t=that.parseArg(that,turtle,that.blocks.blockList[blk].connections[i+1],blk,receivedArg);actionArgs.push(t)}else actionArgs.push(null);if(name in that.actions){if(0===that.justCounting[turtle].length&&that.notationLineBreak(turtle),0<that.backward[turtle].length){childFlow=that.blocks.findBottomBlock(that.actions[name]);var actionBlk=that.blocks.findTopBlock(that.actions[name]);that.backward[turtle].push(actionBlk);var listenerName="_backward_action_"+turtle+"_"+blk;that._setDispatchBlock(blk,turtle,listenerName);var nextBlock=that.blocks.blockList[actionBlk].connections[2];null==nextBlock?that.backward[turtle].pop():nextBlock in that.endOfClampSignals[turtle]?that.endOfClampSignals[turtle][nextBlock].push(listenerName):that.endOfClampSignals[turtle][nextBlock]=[listenerName];var __listener=function(t){that.backward[turtle].pop()};that._setListener(turtle,listenerName,__listener)}else childFlow=that.actions[name];childFlowCount=1}else that.errorMsg(NOACTIONERRORMSG,blk,name);break;case"doArg":for(;0<actionArgs.length;)actionArgs.pop();if(0<that.blocks.blockList[blk].argClampSlots.length)for(var i=0;i<that.blocks.blockList[blk].argClampSlots.length;i++)if(null!=that.blocks.blockList[blk].connections[i+2]){var t=that.parseArg(that,turtle,that.blocks.blockList[blk].connections[i+2],blk,receivedArg);actionArgs.push(t)}else actionArgs.push(null);1<=args.length&&(args[0]in that.actions?(0===that.justCounting[turtle].length&&that.notationLineBreak(turtle),actionName=args[0],childFlow=that.actions[args[0]],childFlowCount=1):that.errorMsg(NOACTIONERRORMSG,blk,args[0]));break;case"forever":1===args.length&&(childFlow=args[0],childFlowCount=that.suppressOutput[turtle]?20:-1);break;case"hidden":case"hiddennoflow":break;case"break":that._doBreak(turtle);var parentBlk=that.blocks.blockList[blk].connections[0];null!=parentBlk&&(that.suppressOutput[turtle]||0!==that.justCounting[turtle].length||that.unhighlightQueue[turtle].push(parentBlk));break;case"wait":if(1===args.length){if(0<that.bpm[turtle].length)var bpmFactor=TONEBPM/last(that.bpm[turtle]);else var bpmFactor=TONEBPM/that._masterBPM;var noteBeatValue=bpmFactor/(1/args[0]);this.previousTurtleTime[turtle]=this.turtleTime[turtle],this.turtleTime[turtle]+=noteBeatValue,that._doWait(turtle,args[0])}break;case"comment":null!==args[0]&&(console.log(args[0].toString()),!that.suppressOutput[turtle]&&0<that.turtleDelay&&that.textMsg(args[0].toString()));break;case"print":that.inStatusMatrix||1===args.length&&null!==args[0]&&(0<that.inNoteBlock[turtle].length?(that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk),that.markup[turtle].push(args[0].toString())):(that.suppressOutput[turtle]||that.textMsg(args[0].toString()),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"print",args[0]])));break;case"speak":1===args.length&&null!==that.meSpeak&&(0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.suppressOutput[turtle]||that._processSpeak(args[0]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"speak",args[0]])));break;case"newturtle":var cblk=that.blocks.blockList[blk].connections[1],turtleName=that.parseArg(that,turtle,cblk,blk,receivedArg);if(null===that._getTargetTurtle(turtleName)){var blockNumber=that.blocks.blockList.length,x=that.turtles.turtleX2screenX(that.turtles.turtleList[turtle].x),y=that.turtles.turtleY2screenY(that.turtles.turtleList[turtle].y),newBlock=[[0,"start",x,y,[null,1,null]],[1,"setturtlename2",0,0,[0,2,null]],[2,["text",{value:turtleName}],0,0,[1]]],__afterLoad=function t(){console.log("AFTERLOAD");var e=that.blocks.blockList[blockNumber].value;that.initTurtle(e),that.turtles.turtleList[e].queue=[],that.parentFlowQueue[e]=[],that.unhighlightQueue[e]=[],that.parameterQueue[e]=[],that.turtles.turtleList[e].running=!0,that._runFromBlock(that,e,blockNumber,0,receivedArg),that.stage.dispatchEvent(turtleName),document.removeEventListener("finishedLoading",t)};document.addEventListener?document.addEventListener("finishedLoading",__afterLoad):document.attachEvent("finishedLoading",__afterLoad),that.blocks.loadNewBlocks(newBlock)}else console.log("Turtle "+turtleName+" already exists."),that.stage.dispatchEvent(turtleName);break;case"setturtle":targetTurtle=that._getTargetTurtle(args[0]),null!==targetTurtle?that._runFromBlock(that,targetTurtle,args[1],isflow,receivedArg):_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+args[0],blk):that.errorMsg(_("Cannot find turtle")+" "+args[0],blk);break;case"repeat":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]||args[0]<1){that.errorMsg(NOINPUTERRORMSG,blk);var arg=1}else var arg=args[0];childFlow=args[1],childFlowCount=Math.floor(arg);break;case"clamp":1===args.length&&(childFlow=args[0],childFlowCount=1);break;case"until":if(2===args.length)if(childFlow=args[1],childFlowCount=1,args[0])for(var queueLength=that.turtles.turtleList[turtle].queue.length,i=queueLength-1;0<i;i--)that.turtles.turtleList[turtle].queue[i].parentBlk===blk&&that.turtles.turtleList[turtle].queue.pop();else{var queueLength=that.turtles.turtleList[turtle].queue.length;0<queueLength&&that.turtles.turtleList[turtle].queue[queueLength-1].parentBlk===blk&&that.turtles.turtleList[turtle].queue.pop();var parentBlk=that.blocks.blockList[blk].connections[0],queueBlock=new Queue(blk,1,parentBlk);that.parentFlowQueue[turtle].push(parentBlk),that.turtles.turtleList[turtle].queue.push(queueBlock)}break;case"movable":1===args.length&&(that.moveable[turtle]=args[0]);break;case"waitFor":if(1===args.length)if(args[0]){for(var queueLength=that.turtles.turtleList[turtle].queue.length,i=queueLength-1;0<i;i--)that.turtles.turtleList[turtle].queue[i].parentBlk===blk&&that.turtles.turtleList[turtle].queue.pop();if(null==that.firstNoteTime){var d=new Date;that.firstNoteTime=d.getTime()}var d=new Date,elapsedTime=(d.getTime()-this.firstNoteTime)/1e3;that.turtleTime[turtle]=elapsedTime,that.previousTurtleTime[turtle]=elapsedTime}else{var parentBlk=that.blocks.blockList[blk].connections[0],queueBlock=new Queue(blk,1,parentBlk);that.parentFlowQueue[turtle].push(parentBlk),that.turtles.turtleList[turtle].queue.push(queueBlock),that._doWait(.05)}break;case"if":2===args.length&&args[0]&&(childFlow=args[1],childFlowCount=1);break;case"ifthenelse":3===args.length&&(childFlowCount=(childFlow=args[0]?args[1]:args[2],1));break;case"while":if(2===args.length)if(args[0]){var queueLength=that.turtles.turtleList[turtle].queue.length;0<queueLength&&that.turtles.turtleList[turtle].queue[queueLength-1].parentBlk===blk&&that.turtles.turtleList[turtle].queue.pop();var parentBlk=that.blocks.blockList[blk].connections[0],queueBlock=new Queue(blk,1,parentBlk);that.parentFlowQueue[turtle].push(parentBlk),that.turtles.turtleList[turtle].queue.push(queueBlock),childFlow=args[1],childFlowCount=1}else for(var queueLength=that.turtles.turtleList[turtle].queue.length,i=queueLength-1;0<i;i--)that.turtles.turtleList[turtle].queue[i].parentBlk===blk&&that.turtles.turtleList[turtle].queue.pop();break;case"storein2":1===args.length&&(that.boxes[that.blocks.blockList[blk].privateData]=args[0]);break;case"storein":2===args.length&&(that.boxes[args[0]]=args[1]);break;case"incrementOne":var i=1;case"increment":if(2===args.length)var i=args[1];else var i=1;if(0<args.length){var cblk=that.blocks.blockList[blk].connections[1];if("text"===that.blocks.blockList[cblk].name){var name=this.blocks.blockList[cblk].value;if(name in this.boxes){this.boxes[name]=this.boxes[name]+i;break}}var settingBlk=that.blocks.blockList[blk].connections[1];that._blockSetter(settingBlk,args[0]+i,turtle)}break;case"clear":if(that.inMatrix);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doSetXY(0,0),that.turtles.turtleList[turtle].doSetHeading(0),that.turtles.turtleList[turtle].penState=savedPenState}else that.svgBackground=!0,that.turtles.turtleList[turtle].doClear(!0,!0,!0);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"clear"])}break;case"setxy":if(2===args.length)if("string"==typeof args[0]||"string"==typeof args[1])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push([args[0],args[1]]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doSetXY(args[0],args[1]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doSetXY(args[0],args[1]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setxy",args[0],args[1]])}break;case"scrollxy":if(2===args.length)if("string"==typeof args[0]||"string"==typeof args[1])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push([args[0],args[1]]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doScrollXY(args[0],args[1]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doScrollXY(args[0],args[1]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"scrollxy",args[0],args[1]])}break;case"arc":if(2===args.length)if("string"==typeof args[0]||"string"==typeof args[1])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push([args[0],args[1]]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doArc(args[0],args[1]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doArc(args[0],args[1]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"arc",args[0],args[1]])}break;case"bezier":if(2===args.length)if("string"==typeof args[0]||"string"==typeof args[1])that.errorMsg(NANERRORMSG,blk);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doBezier(that.cp1x[turtle],that.cp1y[turtle],that.cp2x[turtle],that.cp2y[turtle],args[0],args[1]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doBezier(that.cp1x[turtle],that.cp1y[turtle],that.cp2x[turtle],that.cp2y[turtle],args[0],args[1]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"bezier",args[0],args[1]])}break;case"controlpoint1":2===args.length&&("string"==typeof args[0]||"string"==typeof args[1]?that.errorMsg(NANERRORMSG,blk):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.cp1x[turtle]=args[0],that.cp1y[turtle]=args[1],0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"controlpoint1",args[0],args[1]])));break;case"controlpoint2":2===args.length&&("string"==typeof args[0]||"string"==typeof args[1]?that.errorMsg(NANERRORMSG,blk):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.cp2x[turtle]=args[0],that.cp2y[turtle]=args[1],0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"controlpoint2",args[0],args[1]])));break;case"return":1===args.length&&that.returns.push(args[0]);break;case"returnToUrl":var URL=window.location.href,urlParts,outurl;if(0<URL.indexOf("?")){var urlParts=URL.split("?");if(0<urlParts[1].indexOf("&"))for(var newUrlParts=urlParts[1].split("&"),i=0;i<newUrlParts.length;i++)if(0<newUrlParts[i].indexOf("=")){var tempargs=newUrlParts[i].split("=");switch(tempargs[0].toLowerCase()){case"outurl":outurl=tempargs[1]}}}if(1===args.length){var jsonRet={};jsonRet.result=args[0];var json=JSON.stringify(jsonRet),xmlHttp=new XMLHttpRequest;xmlHttp.open("POST",outurl,!0),xmlHttp.onreadystatechange=function(){4===xmlHttp.readyState&&200===xmlHttp.status&&alert(xmlHttp.responseText)},xmlHttp.send(json)}break;case"forward":if(1===args.length)if("string"==typeof args[0])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doForward(args[0]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doForward(args[0]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"forward",args[0]])}break;case"back":if(1===args.length)if("string"==typeof args[0])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doForward(-args[0]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doForward(-args[0]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"forward",-args[0]])}break;case"right":if(1===args.length)if("string"==typeof args[0])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doRight(args[0]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doRight(args[0]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"right",args[0]])}break;case"left":if(1===args.length)if("string"==typeof args[0])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doRight(-args[0]),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doRight(-args[0]);0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"right",-args[0]])}break;case"setheading":1===args.length&&("string"==typeof args[0]?that.errorMsg(NANERRORMSG,blk):that.inMatrix?(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0])):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doSetHeading(args[0]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setheading",args[0]])));break;case"show":2===args.length&&(0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.suppressOutput[turtle]||that._processShow(turtle,blk,args[0],args[1]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"show",args[0],args[1]])));break;case"turtleshell":2===args.length&&("string"==typeof args[0]?that.errorMsg(NANERRORMSG,blk):that.turtles.turtleList[turtle].doTurtleShell(args[0],args[1]));break;case"setturtlename":var foundTargetTurtle=!1;if(null===args[0]||null===args[1]){that.errorMsg(NOINPUTERRORMSG,blk);break}if(-1===args[0])that.turtles.turtleList[turtle].rename(args[1]),foundTargetTurtle=!0;else if("number"==typeof args[0]){var i=Math.floor(args[0]);0<=i&&i<that.turtles.turtleList.length&&(that.turtles.turtleList[i].rename(args[1]),foundTargetTurtle=!0)}else for(var i=0;i<that.turtles.turtleList.length;i++)if(that.turtles.turtleList[i].name===args[0]){that.turtles.turtleList[i].rename(args[1]),foundTargetTurtle=!0;break}foundTargetTurtle?that.turtles.turtleList[turtle].rename(args[1]):_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+args[0],blk):that.errorMsg(_("Cannot find turtle")+" "+args[0],blk);break;case"setturtlename2":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}that.turtles.turtleList[turtle].rename(args[0]);break;case"startTurtle":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}var targetTurtle=that._getTargetTurtle(args[0]);if(null==targetTurtle)_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+args[0],blk):that.errorMsg(_("Cannot find turtle")+" "+args[0],blk);else{if(that.turtles.turtleList[targetTurtle].running){_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Mouse is already running."),blk):that.errorMsg(_("Turtle is already running."),blk);break}that.turtles.turtleList[targetTurtle].queue=[],that.turtles.turtleList[targetTurtle].running=!0,that.parentFlowQueue[targetTurtle]=[],that.unhighlightQueue[targetTurtle]=[],that.parameterQueue[targetTurtle]=[];for(var foundStartBlock=!1,i=0;i<that.blocks.blockList.length;i++)if(that.blocks.blockList[i]===that.turtles.turtleList[targetTurtle].startBlock){foundStartBlock=!0;break}foundStartBlock?that._runFromBlock(that,targetTurtle,i,isflow,receivedArg):that.errorMsg(_("Cannot find start block")+" "+args[0],blk)}break;case"stopTurtle":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}var targetTurtle=that._getTargetTurtle(args[0]);null==targetTurtle?_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+args[0],blk):that.errorMsg(_("Cannot find turtle")+" "+args[0],blk):(that.turtles.turtleList[targetTurtle].queue=[],that.parentFlowQueue[targetTurtle]=[],that.unhighlightQueue[targetTurtle]=[],that.parameterQueue[targetTurtle]=[],console.log("stopping "+targetTurtle),that._doBreak(targetTurtle));break;case"turtlesync":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}var targetTurtle=that._getTargetTurtle(args[0]);null==targetTurtle?_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+args[0],blk):that.errorMsg(_("Cannot find turtle")+" "+args[0],blk):that.turtleTime[turtle]=that.turtleTime[targetTurtle];break;case"setcolor":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}"string"==typeof args[0]?that.errorMsg(NANERRORMSG,blk):that.inMatrix?(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0])):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doSetColor(args[0]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setcolor",args[0]]));break;case"setfont":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}"string"==typeof args[0]&&that.turtles.turtleList[turtle].doSetFont(args[0]);break;case"sethue":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}"string"==typeof args[0]?that.errorMsg(NANERRORMSG,blk):that.inMatrix?(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0])):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doSetHue(args[0]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"sethue",args[0]]));break;case"setshade":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}"string"==typeof args[0]?that.errorMsg(NANERRORMSG,blk):that.inMatrix?(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0])):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doSetValue(args[0]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setshade",args[0]]));break;case"settranslucency":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}if("string"==typeof args[0])that.errorMsg(NANERRORMSG,blk);else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0]);else if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{var arg=args[0]%101,alpha=1-arg/100;that.turtles.turtleList[turtle].doSetPenAlpha(alpha),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"settranslucency",arg])}break;case"setgrey":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}"string"==typeof args[0]?that.errorMsg(NANERRORMSG,blk):that.inMatrix?(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0])):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doSetChroma(args[0]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setgrey",args[0]]));break;case"setpensize":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}"string"==typeof args[0]?that.errorMsg(NANERRORMSG,blk):that.inMatrix?(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0])):0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doSetPensize(args[0]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setpensize",args[0]]));break;case"fill":if(void 0===args[0])break;if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var savedPenState=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doStartFill(),that.turtles.turtleList[turtle].penState=savedPenState}else that.turtles.turtleList[turtle].doStartFill();0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"fill"])}childFlow=args[0],childFlowCount=1;var listenerName="_fill_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){if(0<that.inNoteBlock[turtle].length)that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk);else{if(that.suppressOutput[turtle]){var e=that.turtles.turtleList[turtle].penState;that.turtles.turtleList[turtle].penState=!1,that.turtles.turtleList[turtle].doEndFill(),that.turtles.turtleList[turtle].penState=e}else that.turtles.turtleList[turtle].doEndFill();0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"fill"])}};that._setListener(turtle,listenerName,__listener);break;case"beginfill":that.turtles.turtleList[turtle].doStartFill();break;case"endfill":that.turtles.turtleList[turtle].doEndFill();break;case"hollowline":if(void 0===args[0])break;0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doStartHollowLine(),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"hollowline"])),childFlow=args[0],childFlowCount=1;var listenerName="_hollowline_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doEndHollowLine(),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"hollowline"]))};that._setListener(turtle,listenerName,__listener);break;case"beginhollowline":that.turtles.turtleList[turtle].doStartHollowLine();break;case"endhollowline":that.turtles.turtleList[turtle].doEndHollowLine();break;case"fillscreen":if(3===args.length){var hue=that.turtles.turtleList[turtle].color,value=that.turtles.turtleList[turtle].value,chroma=that.turtles.turtleList[turtle].chroma;that.turtles.turtleList[turtle].doSetHue(args[0]),that.turtles.turtleList[turtle].doSetValue(args[1]),that.turtles.turtleList[turtle].doSetChroma(args[2]),that.setBackgroundColor(turtle),that.turtles.turtleList[turtle].doSetHue(hue),that.turtles.turtleList[turtle].doSetValue(value),that.turtles.turtleList[turtle].doSetChroma(chroma)}break;case"nobackground":that.svgBackground=!1;break;case"background":that.setBackgroundColor(turtle);break;case"penup":0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doPenUp(),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"penup"]));break;case"pendown":0<that.inNoteBlock[turtle].length?that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])].push(blk):(that.turtles.turtleList[turtle].doPenDown(),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"pendown"]));break;case"openProject":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}url=args[0];var ValidURL=function(t){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.) {3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)||(that.errorMsg(_("Please enter a valid URL.")),!1)};if(ValidURL(url)){var win=window.open(url,"_blank");win?win.focus():alert("Please allow popups for this site")}break;case"vspace":break;case"playback":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}var sound=new Howl({urls:[args[0]]});that.sounds.push(sound),sound.play();break;case"stopplayback":for(var sound in that.sounds)that.sounds[sound].stop();that.sounds=[];break;case"stopvideocam":null!=cameraID&&doStopVideoCam(that.cameraID,that.setCameraID);break;case"showblocks":that.showBlocks(),that.setTurtleDelay(DEFAULTDELAY);break;case"hideblocks":that.hideBlocks(),that.setTurtleDelay(0);break;case"savesvg":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}1===args.length&&(that.svgBackground&&(that.svgOutput='<rect x="0" y="0" height="'+that.canvas.height+'" width="'+that.canvas.width+'" fill="'+body.style.background+'"/> '+that.svgOutput),save.saveSVG(args[0]));break;case"showHeap":turtle in that.turtleHeaps||(that.turtleHeaps[turtle]=[]),that.textMsg(JSON.stringify(that.turtleHeaps[turtle]));break;case"emptyHeap":that.turtleHeaps[turtle]=[];break;case"reverseHeap":that.turtleHeaps[turtle]=that.turtleHeaps[turtle].reverse();break;case"push":if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}turtle in that.turtleHeaps||(that.turtleHeaps[turtle]=[]),that.turtleHeaps[turtle].push(args[0]);break;case"saveHeap":null!==args[0]&&turtle in that.turtleHeaps&&save.download("json","data:text/json;charset-utf-8,"+JSON.stringify(that.turtleHeaps[turtle]),args[0]);break;case"loadHeap":var block=that.blocks.blockList[blk];if(turtle in that.turtleHeaps)var oldHeap=that.turtleHeaps[turtle];else var oldHeap=[];var c=block.connections[1];if(null!=c&&"loadFile"===that.blocks.blockList[c].name)if(1!==args.length)that.errorMsg(_("You must select a file."));else try{if(that.turtleHeaps[turtle]=JSON.parse(that.blocks.blockList[c].value[1]),!Array.isArray(that.turtleHeaps[turtle]))throw"is not array"}catch(t){that.turtleHeaps[turtle]=oldHeap,that.errorMsg(_("The file you selected does not contain a valid heap."))}else that.errorMsg(_("The loadHeap block needs a loadFile block."));break;case"loadHeapFromApp":if(null===args[0]||null===args[1]){that.errorMsg(NOINPUTERRORMSG,blk);break}var data=[],url=args[1],name=args[0],xmlHttp=new XMLHttpRequest;if(xmlHttp.open("GET",url,!1),xmlHttp.send(),4!==xmlHttp.readyState||200!==xmlHttp.status){if(4===xmlHttp.readyState&&200!==xmlHttp.status){console.log("fetched the wrong page or network error..."),that.errorMsg(_("404: Page not found"));break}that.errorMsg("xmlHttp.readyState: "+xmlHttp.readyState);break}console.log(xmlHttp.responseText);try{var data=JSON.parse(xmlHttp.responseText)}catch(t){console.log(t),that.errorMsg(_("Error parsing JSON data:")+t)}if(name in that.turtleHeaps)var oldHeap=turtleHeaps[turtle];else var oldHeap=[];that.turtleHeaps[name]=data;break;case"saveHeapToApp":if(null===args[0]||null===args[1]){that.errorMsg(NOINPUTERRORMSG,blk);break}var name=args[0],url=args[1];if(name in that.turtleHeaps){var data=JSON.stringify(that.turtleHeaps[name]),xmlHttp=new XMLHttpRequest;xmlHttp.open("POST",url,!0),xmlHttp.setRequestHeader("Content-Type","application/json;charset=UTF-8"),xmlHttp.send(data)}else that.errorMsg(_("Cannot find a valid heap for")+" "+name);break;case"setHeapEntry":if(null===args[0]||null===args[1]){that.errorMsg(NOINPUTERRORMSG,blk);break}if("number"!=typeof args[0]||"number"!=typeof args[1]){that.errorMsg(NANERRORMSG,blk);break}turtle in that.turtleHeaps||(that.turtleHeaps[turtle]=[]);var idx=Math.floor(args[0]);for(idx<1&&(that.errorMsg(_("Index must be > 0.")),idx=1),1e3<idx&&(that.errorMsg(_("Maximum heap size is 1000.")),idx=1e3);that.turtleHeaps[turtle].length<idx;)that.turtleHeaps[turtle].push(0);that.turtleHeaps[turtle][idx-1]=args[1];break;case"savelilypond":1===args.length&&save.afterSaveLilypond(args[0]);break;case"amsynth":var harmonicity;if(that.inTimbre&&(that.timbre.AMSynthParams=[],0!=that.timbre.osc.length&&that.errorMsg(_("Unable to use synth due to existing oscillator"))),null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=1}else var arg=args[0];harmonicity=arg<0?(that.errorMsg(_("The input cannot be negative.")),-arg):arg,that.inTimbre&&(that.timbre.amSynthParamvals.harmonicity=harmonicity,that.synth.createSynth(turtle,that.timbre.instrumentName,"amsynth",that.timbre.amSynthParamvals),that.timbre.AMSynthesizer.push(blk),that.timbre.AMSynthParams.push(harmonicity));break;case"fmsynth":var modulationIndex;if(that.inTimbre&&(that.timbre.FMSynthParams=[],0!=that.timbre.osc.length&&that.errorMsg(_("Unable to use synth due to existing oscillator"))),null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=10}else var arg=args[0];modulationIndex=arg<0?(that.errorMsg(_("The input cannot be negative.")),-arg):arg,that.inTimbre&&(that.timbre.fmSynthParamvals.modulationIndex=modulationIndex,that.synth.createSynth(turtle,that.timbre.instrumentName,"fmsynth",that.timbre.fmSynthParamvals),that.timbre.FMSynthesizer.push(blk),that.timbre.FMSynthParams.push(modulationIndex));break;case"duosynth":var synthVibratoRate,synthVibratoAmount;if(that.inTimbre&&(0!=that.timbre.osc.length&&that.errorMsg(_("Unable to use synth due to existing oscillator")),that.timbre.duoSynthParams=[]),null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0=10}else var arg0=args[0];if(null===args[1]||"number"!=typeof args[1]){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=50}else var arg1=args[1];synthVibratoRate=Math.abs(arg0),synthVibratoAmount=Math.abs(arg1)/100,that.inTimbre&&(that.timbre.duoSynthParamVals.vibratoRate=synthVibratoRate,that.timbre.duoSynthParamVals.vibratoAmount=synthVibratoAmount,that.synth.createSynth(turtle,that.timbre.instrumentName,"duosynth",that.timbre.duoSynthParamVals),that.timbre.duoSynthesizer.push(blk),that.timbre.duoSynthParams.push(synthVibratoRate),that.timbre.duoSynthParams.push(synthVibratoAmount));break;case"saveabc":1===args.length&&save.afterSaveAbc(args[0]);break;case"setkey":1===args.length&&(that.keySignature[turtle]=args[0]);break;case"setkey2":if(2===args.length){var modename="major";for(var mode in MUSICALMODES)if(mode===args[1]||_(mode)===args[1]){modename=mode,that._modeBlock=that.blocks.blockList[blk].connections[2];break}if(turtle in that.transposition){var noteObj=getNote(args[0],4,that.transposition[turtle],that.keySignature[turtle],!1,null,that.errorMsg,that.synth.inTemperament);that.keySignature[turtle]=noteObj[0]+" "+modename,that.notationKey(turtle,noteObj[0],modename)}else that.keySignature[turtle]=args[0]+" "+modename,that.notationKey(turtle,args[0],modename);that.insideModeWidget&&(that.keySignature[0]=args[0]+" "+modename,that.notationKey(0,args[0],modename))}break;case"definemode":if(void 0===args[1])break;if(that.inDefineMode[turtle]=!0,that.defineMode[turtle]=[],null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var modeName="custom"}else var modeName=args[0].toLowerCase();childFlow=args[1],childFlowCount=1;var listenerName="_definemode_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){MUSICALMODES[modeName]=[],-1===that.defineMode[turtle].indexOf(0)&&(that.defineMode[turtle].push(0),that.errorMsg(_("Adding missing pitch number 0.")));for(var e=that.defineMode[turtle].sort(function(t,e){return t[0]-e[0]}),i=0;i<e.length;i++)e[i]<0||11<e[i]?that.errorMsg(_("Ignoring pitch numbers less than zero or greater than eleven.")):0<i&&e[i]===e[i-1]?that.errorMsg(_("Ignoring duplicate pitch numbers.")):i<e.length-1?MUSICALMODES[modeName].push(e[i+1]-e[i]):MUSICALMODES[modeName].push(12-e[i]);var s=that.blocks.blockList[blk].connections[1];"modename"===that.blocks.blockList[s].name&&that.blocks.updateBlockText(s),that.inDefineMode[turtle]=!1};that._setListener(turtle,listenerName,__listener);break;case"rhythmruler2":case"rhythmruler":childFlow="rhythmruler"===that.blocks.blockList[blk].name?args[1]:args[0],childFlowCount=1,null==that.rhythmRuler&&(that.rhythmRuler=new RhythmRuler),that.rhythmRuler.Rulers=[],that.rhythmRuler.Drums=[],that.inRhythmRuler=!0;var listenerName="_rhythmruler_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.rhythmRuler.init(that)};that._setListener(turtle,listenerName,__listener);break;case"pitchstaircase":null==that.pitchStaircase&&(that.pitchStaircase=new PitchStaircase),that.pitchStaircase.Stairs=[],that.pitchStaircase.stairPitchBlocks=[],childFlow=args[0],childFlowCount=1,that.inPitchStaircase=!0;var listenerName="_pitchstaircase_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.pitchStaircase.init(that),that.inPitchStaircase=!1};that._setListener(turtle,listenerName,__listener);break;case"tempo":childFlow=args[0],childFlowCount=1,null==that.tempo&&(that.tempo=new Tempo),that.inTempo=!0,that.tempo.BPMBlocks=[],that.tempo.BPMs=[];var listenerName="_tempo_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.tempo.init(that)};that._setListener(turtle,listenerName,__listener);break;case"pitchslider":null==that.pitchSlider&&(that.pitchSlider=new PitchSlider),that.pitchSlider.Sliders=[],childFlow=args[0],childFlowCount=1,that.inPitchSlider=!0;var listenerName="_pitchslider_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.pitchSlider.init(that),that.inPitchSlider=!1};that._setListener(turtle,listenerName,__listener);break;case"musickeyboard":1===args.length&&(childFlow=args[0],childFlowCount=1),null===that.musicKeyboard&&(that.musicKeyboard=new MusicKeyboard),that.inMusicKeyboard=!0,that.musicKeyboard.noteNames=[],that.musicKeyboard.octaves=[];var listenerName="_musickeyboard_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.musicKeyboard.noteNames=that.musicKeyboard.noteNames.reverse(),that.musicKeyboard.octaves=that.musicKeyboard.octaves.reverse(),that.musicKeyboard.init(that)};that._setListener(turtle,listenerName,__listener);break;case"pitchdrummatrix":1===args.length&&(childFlow=args[0],childFlowCount=1),null==that.pitchDrumMatrix&&(that.pitchDrumMatrix=new PitchDrumMatrix),that.inPitchDrumMatrix=!0,that.pitchDrumMatrix.rowLabels=[],that.pitchDrumMatrix.rowArgs=[],that.pitchDrumMatrix.drums=[],that.pitchDrumMatrix.clearBlocks();var listenerName="_pitchdrummatrix_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){0===that.pitchDrumMatrix.drums.length||0===that.pitchDrumMatrix.rowLabels.length?that.errorMsg(_("You must have at least one pitch block and one drum block in the matrix."),blk):(that.pitchDrumMatrix.init(that),that.pitchDrumMatrix.makeClickable())};that._setListener(turtle,listenerName,__listener);break;case"timbre":null==that.timbre&&(that.timbre=new TimbreWidget),that.inTimbre=!0,"string"==typeof args[0]?that.timbre.instrumentName=args[0]:(that.timbre.instrumentName=DEFAULTVOICE,that.errorMsg(NOINPUTERRORMSG,blk)),instrumentsEffects[turtle][that.timbre.instrumentName]={},instrumentsEffects[turtle][that.timbre.instrumentName].vibratoActive=!1,instrumentsEffects[turtle][that.timbre.instrumentName].distortionActive=!1,instrumentsEffects[turtle][that.timbre.instrumentName].tremoloActive=!1,instrumentsEffects[turtle][that.timbre.instrumentName].phaserActive=!1,instrumentsEffects[turtle][that.timbre.instrumentName].chorusActive=!1,instrumentsFilters[turtle][that.timbre.instrumentName]=[],childFlow=args[1],childFlowCount=1,that.timbre.blockNo=blk,that.timbre.env=[],that.timbre.ENVs=[],that.timbre.fil=[],that.timbre.filterParams=[],that.timbre.osc=[],that.timbre.oscParams=[],that.timbre.tremoloEffect=[],that.timbre.tremoloParams=[],that.timbre.vibratoEffect=[],that.timbre.vibratoParams=[],that.timbre.chorusEffect=[],that.timbre.chorusParams=[],that.timbre.phaserEffect=[],that.timbre.phaserParams=[],that.timbre.distortionEffect=[],that.timbre.distortionParams=[],that.timbre.AMSynthesizer=[],that.timbre.AMSynthParams=[],that.timbre.FMSynthesizer=[],that.timbre.FMSynthParams=[],that.timbre.duoSynthesizer=[],that.timbre.duoSynthParams=[],that.timbre.notesToPlay=[];var listenerName="_timbre_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.timbre.init(that)};that._setListener(turtle,listenerName,__listener);break;case"modewidget":1===args.length&&(childFlow=args[0],childFlowCount=1),null==that.modeWidget&&(that.modeWidget=new ModeWidget),that.insideModeWidget=!0;var listenerName="_modewidget_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.modeWidget.init(that,that._modeBlock),that.insideModeWidget=!1};that._setListener(turtle,listenerName,__listener);break;case"meterwidget":1===args.length&&(childFlow=args[0],childFlowCount=1),null==that.meterWidget&&(that.meterWidget=new MeterWidget),that.insideMeterWidget=!0;var listenerName="_meterwidget_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.meterWidget.init(that,that._meterBlock),that.insideMeterWidget=!1};that._setListener(turtle,listenerName,__listener);break;case"temperament1":break;case"temperament":null==that.temperament&&(that.temperament=new TemperamentWidget),that.insideTemperament=!0,that.temperament.inTemperament=args[0];var scale=[];if("pitch"===that.blocks.blockList[that.blocks.blockList[blk].connections[2]].name){var pitchBlock=that.blocks.blockList[that.blocks.blockList[blk].connections[2]],note=that.blocks.blockList[pitchBlock.connections[1]].value,octave=that.blocks.blockList[pitchBlock.connections[2]].value,setKey=that.blocks.blockList[pitchBlock.connections[3]];scale[0]=that.blocks.blockList[setKey.connections[1]].value,scale[1]=that.blocks.blockList[setKey.connections[2]].value,that.synth.startingPitch=note+octave,that.temperament.scale=scale}var listenerName="_temperament_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.temperament.init(that)};that._setListener(turtle,listenerName,__listener);break;case"setmasterbpm":if(1===args.length&&"number"==typeof args[0]&&(args[0]<30?(that.errorMsg(_("Beats per minute must be > 30.")),that._masterBPM=30):1e3<args[0]?(that.errorMsg(_("Maximum beats per minute is 1000.")),that._masterBPM=1e3):that._masterBPM=args[0],that.defaultBPMFactor=TONEBPM/that._masterBPM),that.inTempo){that.tempo.BPMBlocks.push(blk);var bpmnumberblock=that.blocks.blockList[blk].connections[1];that.tempo.BPMs.push(that.blocks.blockList[bpmnumberblock].text.text)}break;case"setbpm":if(2===args.length&&"number"==typeof args[0]){if(args[0]<30){that.errorMsg(_("Beats per minute must be > 30."));var bpm=30}else if(1e3<args[0]){that.errorMsg(_("Maximum beats per minute is 1000."));var bpm=1e3}else var bpm=args[0];that.bpm[turtle].push(bpm),childFlow=args[1],childFlowCount=1;var listenerName="_bpm_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.bpm[turtle].pop()};that._setListener(turtle,listenerName,__listener)}break;case"setmasterbpm2":if(2===args.length&&"number"==typeof args[0]&&"number"==typeof args[1]){var bpm=args[0]*args[1]/.25;bpm<30?(that.errorMsg(_("Beats per minute must be > 30.")),that._masterBPM=30):1e3<bpm?(that.errorMsg(_("Maximum beats per minute is 1000.")),that._masterBPM=1e3):that._masterBPM=bpm,that.notationTempo(turtle,args[0],args[1]),that.defaultBPMFactor=TONEBPM/that._masterBPM}if(that.inTempo){that.tempo.BPMBlocks.push(blk);var bpmnumberblock=that.blocks.blockList[blk].connections[1];that.tempo.BPMs.push(that.blocks.blockList[bpmnumberblock].text.text)}break;case"setbpm3":if(2===args.length&&"number"==typeof args[0]&&"number"==typeof args[1]){var bpm=args[0]*args[1]/.25;bpm=bpm<30?(that.errorMsg(_("Beats per minute must be > 30.")),30):1e3<bpm?(that.errorMsg(_("Maximum beats per minute is 1000.")),1e3):bpm,that.notationTempo(turtle,args[0],args[1]),that.bpm[turtle].push(bpm)}if(that.inTempo){that.tempo.BPMBlocks.push(blk);var bpmnumberblock=that.blocks.blockList[blk].connections[1];that.tempo.BPMs.push(that.blocks.blockList[bpmnumberblock].text.text)}break;case"setbpm2":if(3===args.length&&"number"==typeof args[0]&&"number"==typeof args[1]){var bpm=args[0]*args[1]/.25;if(args[0]<30){that.errorMsg(_("Beats per minute must be > 30."));var bpm=30}else 1e3<args[0]&&(that.errorMsg(_("Maximum beats per minute is 1000.")),bpm=1e3);that.notationTempo(turtle,args[0],args[1]),that.bpm[turtle].push(bpm),childFlow=args[2],childFlowCount=1;var listenerName="_bpm_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.bpm[turtle].pop()};that._setListener(turtle,listenerName,__listener)}break;case"status":null==that.statusMatrix&&(that.statusMatrix=new StatusMatrix),that.statusMatrix.init(that),that.statusFields=[],1===args.length&&(childFlow=args[0],childFlowCount=1),that.inStatusMatrix=!0;var listenerName="_status_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.statusMatrix.init(that),that.inStatusMatrix=!1};that._setListener(turtle,listenerName,__listener);break;case"matrix":1===args.length&&(childFlow=args[0],childFlowCount=1),that.inMatrix=!0,null==that.pitchTimeMatrix&&(that.pitchTimeMatrix=new PitchTimeMatrix),that.pitchTimeMatrix._instrumentName=DEFAULTVOICE,that.pitchTimeMatrix.rowLabels=[],that.pitchTimeMatrix.rowArgs=[],that.pitchTimeMatrix.graphicsBlocks=[],that.pitchTimeMatrix.clearBlocks(),that.tupletRhythms=[],that.tupletParams=[],that.addingNotesToTuplet=!1;var listenerName="_matrix_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){if(0===that.tupletRhythms.length||0===that.pitchTimeMatrix.rowLabels.length)that.errorMsg(_("You must have at least one pitch block and one rhythm block in the matrix."),blk);else{that.pitchTimeMatrix.blockNo=blk,that.pitchTimeMatrix.sorted=!1,that.pitchTimeMatrix.init(that);for(var e=0;e<that.tupletRhythms.length;e++)switch(that.tupletRhythms[e][0]){case"notes":case"simple":var i=[that.tupletParams[e]];i.push([]);for(var s=2;s<that.tupletRhythms[e].length;s++)i[1].push(that.tupletRhythms[e][s]);that.pitchTimeMatrix.addTuplet(i);break;default:that.pitchTimeMatrix.addNotes(that.tupletRhythms[e][1],that.tupletRhythms[e][2])}that.pitchTimeMatrix.makeClickable()}};that._setListener(turtle,listenerName,__listener);break;case"envelope":var synth_source="sine";4===args.length&&"number"==typeof args[0]&&((args[0]<0||100<args[0])&&that.errorMsg(_("Attack value should be from 0 to 100.")),(args[1]<0||100<args[1])&&that.errorMsg(_("Decay value should be from 0 to 100.")),(args[2]<0||100<args[2])&&that.errorMsg(_("Sustain value should be from 0 to 100.")),(args[3]<0||100<args[3])&&that.errorMsg(_("Release value should be from 0-100.")),that.attack[turtle].push(args[0]/100),that.decay[turtle].push(args[1]/100),that.sustain[turtle].push(args[2]/100),that.release[turtle].push(args[3]/100)),that.inTimbre&&(that.timbre.synthVals.envelope.attack=last(that.attack[turtle]),that.timbre.synthVals.envelope.decay=last(that.decay[turtle]),that.timbre.synthVals.envelope.sustain=last(that.sustain[turtle]),that.timbre.synthVals.envelope.release=last(that.release[turtle]),0!=that.timbre.env.length?that.errorMsg(_("You are adding multiple envelope blocks.")):that.synth.createSynth(turtle,that.timbre.instrumentName,that.timbre.synthVals.oscillator.source,that.timbre.synthVals),that.timbre.env.push(blk),that.timbre.ENVs.push(Math.round(100*last(that.attack[turtle]))),that.timbre.ENVs.push(Math.round(100*last(that.decay[turtle]))),that.timbre.ENVs.push(Math.round(100*last(that.sustain[turtle]))),that.timbre.ENVs.push(Math.round(100*last(that.release[turtle]))));break;case"filter":var filtertype=DEFAULTFILTERTYPE,freq,rollOff;if(3===args.length&&"number"==typeof args[1]){for(var ftype in FILTERTYPES)FILTERTYPES[ftype][0]===args[0]?filtertype=FILTERTYPES[ftype][1]:FILTERTYPES[ftype][1]===args[0]&&(filtertype=args[0]);-1===[-12,-24,-48,-96].indexOf(args[1])&&that.errorMsg(_("Rolloff value should be either -12, -24, -48, or -96 decibels/octave.")),rollOff=args[1],freq=args[2],that.inTimbre&&(that.timbre.instrumentName in instrumentsFilters[turtle]||(instrumentsFilters[turtle][that.timbre.instrumentName]=[]),instrumentsFilters[turtle][that.timbre.instrumentName].push({filterType:filtertype,filterRolloff:rollOff,filterFrequency:freq}),that.timbre.fil.push(blk),that.timbre.filterParams.push(filtertype),that.timbre.filterParams.push(rollOff),that.timbre.filterParams.push(freq))}break;case"oscillator":var oscillatorType=DEFAULTOSCILLATORTYPE,partials=0;if(2===args.length&&"number"==typeof args[1]){for(var otype in OSCTYPES)OSCTYPES[otype][0]===args[0]?oscillatorType=OSCTYPES[otype][1]:OSCTYPES[otype][1]===args[0]&&(oscillatorType=args[0]);partials=args[1]}that.inTimbre&&(0!=that.timbre.osc.length?that.errorMsg(_("You are adding multiple oscillator blocks.")):(that.timbre.oscParams=[],that.synth.createSynth(turtle,that.timbre.instrumentName,oscillatorType,that.timbre.synthVals)),that.timbre.osc.push(blk),that.timbre.oscParams.push(oscillatorType),that.timbre.oscParams.push(partials));break;case"invert1":if(void 0===args[3])break;if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0="sol"}else var arg0=args[0];if(null===args[1]){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=4}else var arg1=args[1];if(null===args[2]){that.errorMsg(NOINPUTERRORMSG,blk);var arg2="even"}else var arg2=args[2];if("number"==typeof arg2&&(arg2=arg2%2==0?"even":"odd"),arg2===_("even")?args2="even":arg2===_("odd")?args2="odd":arg2===_("scalar")&&(args2="scalar"),"even"===arg2||"odd"===arg2||"scalar"===arg2){var octave=calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],arg0);that.invertList[turtle].push([arg0,octave,arg2])}childFlow=args[3],childFlowCount=1;var listenerName="_invert_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.invertList[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"switch":that.switchBlocks[turtle].push(blk),that.switchCases[turtle][blk]=[],childFlow=args[1],childFlowCount=1;var listenerName="_switch_"+blk+"_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){var e=last(that.switchBlocks[turtle]),i=that.blocks.blockList[e].connections[1];if(null==i)var s="__default__";else s=that.parseArg(that,turtle,i,that.receievedArg);for(var l=null,o=0;o<that.switchCases[turtle][e].length;o++){if(that.switchCases[turtle][e][o][0]===s){l=that.switchCases[turtle][e][o][1];break}"__default__"===that.switchCases[turtle][e][o][0]&&(l=that.switchCases[turtle][e][o][1])}if(null!=l){var a=new Queue(l,1,e,null);that.parentFlowQueue[turtle].push(e),that.turtles.turtleList[turtle].queue.push(a)}that.switchCases[turtle][e]=[],that.switchBlocks[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"defaultcase":case"case":var switchBlk=last(that.switchBlocks[turtle]);if(null===switchBlk){that.errorMsg(_("The Case Block must be used inside of a Switch Block."),blk),that.stopTurtle=!0;break}"defaultcase"===that.blocks.blockList[blk].name?that.switchCases[turtle][switchBlk].push(["__default__",args[0]]):that.switchCases[turtle][switchBlk].push([args[0],args[1]]);break;case"invert2":case"invert":"invert"===that.blocks.blockList[blk].name?that.invertList[turtle].push([args[0],args[1],"even"]):that.invertList[turtle].push([args[0],args[1],"odd"]),childFlow=args[2],childFlowCount=1;var listenerName="_invert_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.invertList[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"backward":that.backward[turtle].push(blk),childFlow=that.blocks.findBottomBlock(args[0]),childFlowCount=1;var listenerName="_backward_"+turtle+"_"+blk;that._setDispatchBlock(blk,turtle,listenerName);var nextBlock=that.blocks.blockList[blk].connections[2];null==nextBlock?that.backward[turtle].pop():nextBlock in that.endOfClampSignals[turtle]?that.endOfClampSignals[turtle][nextBlock].push(listenerName):that.endOfClampSignals[turtle][nextBlock]=[listenerName];var __listener=function(t){that.backward[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"rest2":0<that.inNoteBlock[turtle].length&&(that.notePitches[turtle][last(that.inNoteBlock[turtle])].push("rest"),that.noteOctaves[turtle][last(that.inNoteBlock[turtle])].push(4),that.noteCents[turtle][last(that.inNoteBlock[turtle])].push(0),that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(0),that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])].push(that.beatFactor[turtle]),that.pushedNote[turtle]=!0);break;case"steppitch":if(!that.inMatrix&&0===that.inNoteBlock[turtle].length){that.errorMsg(_("The Scalar Step Block must be used inside of a Note Block."),blk),that.stopTurtle=!0;break}if("number"!=typeof args[0]){that.errorMsg(NANERRORMSG,blk),that.stopTurtle=!0;break}if(0<that.justCounting[turtle].length&&null==that.lastNotePlayed[turtle]&&(console.log("Just counting, so spoofing last note played."),that.previousNotePlayed[turtle]=["G4",4],that.lastNotePlayed[turtle]=["G4",4]),null==that.lastNotePlayed[turtle]){that.errorMsg(_("The Scalar Step Block must be preceded by a Pitch Block."),blk),that.stopTurtle=!0;break}var addPitch=function(e,i,s,l){var o=getNote(e,i,t=transposition+12*that.register[turtle],that.keySignature[turtle],!0,l,that.errorMsg,that.synth.inTemperament);if(0<that.drumStyle[turtle].length){var a=last(that.drumStyle[turtle]);-1===EFFECTSNAMES.indexOf(a)?that.pitchDrumTable[turtle][o[0]+o[1]]=a:that.pitchDrumTable[turtle][o[0]+o[1]]=effectsname}return that.inMatrix||(that.notePitches[turtle][last(that.inNoteBlock[turtle])].push(o[0]),that.noteOctaves[turtle][last(that.inNoteBlock[turtle])].push(o[1]),that.noteCents[turtle][last(that.inNoteBlock[turtle])].push(s),0!==s?that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(pitchToFrequency(o[0],o[1],s,that.keySignature[turtle])):that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(0)),o},len=that.lastNotePlayed[turtle][0].length,noteObj=that._addScalarTransposition(turtle,that.lastNotePlayed[turtle][0].slice(0,len-1),parseInt(that.lastNotePlayed[turtle][0].slice(len-1)),args[0]),delta=0;0!==that.invertList[turtle].length&&(delta+=that._calculateInvert(turtle,noteObj[0],noteObj[1]));var transposition=2*delta;turtle in that.transposition&&(transposition+=that.transposition[turtle]);var noteObj1=addPitch(noteObj[0],noteObj[1],0);if(transposition=0,that.inMatrix&&(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(noteObj1[0]),that.pitchTimeMatrix.rowArgs.push(noteObj1[1]),that.previousNotePlayed[turtle]=that.lastNotePlayed[turtle],that.lastNotePlayed[turtle]=[noteObj1[0]+noteObj1[1],4]),turtle in that.intervals&&0<that.intervals[turtle].length)for(var i=0;i<that.intervals[turtle].length;i++){var ii=getInterval(that.intervals[turtle][i],that.keySignature[turtle],noteObj1[0]),noteObj2=getNote(noteObj1[0],noteObj1[1],ii,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);addPitch(noteObj2[0],noteObj2[1],0)}if(turtle in that.semitoneIntervals&&0<that.semitoneIntervals[turtle].length)for(var i=0;i<that.semitoneIntervals[turtle].length;i++){var noteObj2=getNote(noteObj1[0],noteObj1[1],that.semitoneIntervals[turtle][i][0],that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);addPitch(noteObj2[0],noteObj2[1],0,that.semitoneIntervals[turtle][i][1])}0<that.inNoteBlock[turtle].length&&that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])].push(that.beatFactor[turtle]),that.pushedNote[turtle]=!0;break;case"playnoise":if(1!==args.length||null==args[0]||"string"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg="noise1"}else var arg=args[0];var noisename=arg;for(var noise in NOISENAMES){if(NOISENAMES[noise][0]===arg){noisename=NOISENAMES[noise][1];break}if(NOISENAMES[noise][1]===arg){noisename=arg;break}}if(!(0<that.inNoteBlock[turtle].length)){that.errorMsg(_("Noise Block: Did you mean to use a Note block?"),blk);break}that.noteDrums[turtle][last(that.inNoteBlock[turtle])].push(noisename),null==that.synthVolume[turtle][noisename]&&(that.synthVolume[turtle][noisename]=[DEFAULTVOLUME],that.crescendoInitialVolume[turtle][noisename]=[DEFAULTVOLUME]),0<that.inNoteBlock[turtle].length&&that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])].push(that.beatFactor[turtle]),that.pushedNote[turtle]=!0;break;case"playdrum":if(1!==args.length||null==args[0]||"string"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=DEFAULTDRUM}else var arg=args[0];var drumname=DEFAULTDRUM;if("http"===arg.slice(0,4))drumname=arg;else for(var drum in DRUMNAMES){if(DRUMNAMES[drum][0]===arg){drumname=DRUMNAMES[drum][1];break}if(DRUMNAMES[drum][1]===arg){drumname=arg;break}}if(0<that.drumStyle[turtle].length&&(drumname=last(that.drumStyle[turtle])),that.inPitchDrumMatrix)that.pitchDrumMatrix.drums.push(drumname),that.pitchDrumMatrix.addColBlock(blk),-1===that.drumBlocks.indexOf(blk)&&that.drumBlocks.push(blk);else if(that.inMatrix)that.pitchTimeMatrix.rowLabels.push(drumname),that.pitchTimeMatrix.rowArgs.push(-1),that.pitchTimeMatrix.addRowBlock(blk),-1===that.drumBlocks.indexOf(blk)&&that.drumBlocks.push(blk);else if(0<that.inNoteBlock[turtle].length)that.noteDrums[turtle][last(that.inNoteBlock[turtle])].push(drumname),null==that.synthVolume[turtle][drumname]&&(that.synthVolume[turtle][drumname]=[DEFAULTVOLUME],that.crescendoInitialVolume[turtle][drumname]=[DEFAULTVOLUME]);else{if(null!=that.blocks.blockList[blk].connections[0]||null!=last(that.blocks.blockList[blk].connections)){that.errorMsg(_("Drum Block: Did you mean to use a Note block?"),blk);break}if(that.clearNoteParams(turtle,blk,[]),that.inNoteBlock[turtle].push(blk),that.noteDrums[turtle][last(that.inNoteBlock[turtle])].push(drumname),0<that.bpm[turtle].length)var bpmFactor=TONEBPM/last(that.bpm[turtle]);else var bpmFactor=TONEBPM/that._masterBPM;var noteBeatValue=4,beatValue=bpmFactor/noteBeatValue;__callback=function(){var t=that.inNoteBlock[turtle].indexOf(blk);that.inNoteBlock[turtle].splice(t,1)},that._processNote(noteBeatValue,blk,turtle,__callback)}0<that.inNoteBlock[turtle].length&&that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])].push(that.beatFactor[turtle]),that.pushedNote[turtle]=!0;break;case"setpitchnumberoffset":if(console.log(args[0]+" "+args[1]),null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0="C"}else var arg0=args[0];if(null===args[1]){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=4}else var arg1=args[1];var octave=Math.floor(calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],arg0));that.pitchNumberOffset[turtle]=pitchToNumber(arg0,octave,that.keySignature[turtle]);break;case"custompitch":if(null==args[0]||null==args[1]){that.errorMsg(NOINPUTERRORMSG,blk),that.stopTurtle=!0;break}note=args[0],octave=args[1];break;case"pitchnumber":case"scaledegree":case"pitch":var useSolfegeName=!1;if("pitchnumber"===that.blocks.blockList[blk].name){if(1!==args.length||null==args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0=7}else var arg0=args[0];if("number"!=typeof arg0&&(that.errorMsg(NANERRORMSG,blk),arg0=7),that.inDefineMode[turtle]){that.defineMode[turtle].push(Math.floor(arg0));break}var obj=numberToPitch(Math.floor(arg0+that.pitchNumberOffset[turtle]),that.synth.inTemperament,that.synth.startingPitch,that.pitchNumberOffset[turtle]);"custom"==that.synth.inTemperament&&that.scalarTransposition[turtle]+that.transposition[turtle]!==0&&that.errorMsg(_("Scalar transpositions are equal to Semitone transpositions for custom temperament.")),note=obj[0],octave=obj[1],cents=0,that.currentNote=note}else if("customNote"===that.blocks.blockList[blk].name){if(null==args[0]||null==args[1]){that.errorMsg(NOINPUTERRORMSG,blk),that.stopTurtle=!0;break}note=args[0],octave=args[1]}else{if(null===args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0="sol"}else var arg0=args[0];if(null===args[1]){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=4}else var arg1=args[1];if("number"==typeof arg0&&"pitch"===that.blocks.blockList[blk].name)if(arg0<13){arg0<1&&(console.log(arg0),that.errorMsg(INVALIDPITCH,blk),arg0=7),note=scaleDegreeToPitch(that.keySignature[turtle],Math.floor(arg0)),that.currentNote=note;var octave=Math.floor(calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],that.currentNote)),cents=0}else{(arg0<A0||C8<arg0)&&(that.errorMsg(INVALIDPITCH,blk),console.log(arg0),arg0=398);var obj=frequencyToPitch(arg0),note=obj[0];that.currentNote=note;var octave=obj[1],cents=obj[2]}else if("number"==typeof arg0&&"scaledegree"==that.blocks.blockList[blk].name){if(arg0<1&&(arg0-=2),arg0<0){var neg=!0;arg0=-arg0}else var neg=!1;0===arg0&&(console.log(arg0),that.errorMsg(INVALIDPITCH,blk),note=7);var obj=keySignatureToMode(that.keySignature[turtle]),modeLength=MUSICALMODES[obj[1]].length,scaleDegree=Math.floor(arg0-1)%modeLength;if(scaleDegree+=1,neg){1<scaleDegree&&(scaleDegree=modeLength-scaleDegree+2),note=scaleDegreeToPitch(that.keySignature[turtle],scaleDegree),that.currentNote=note;var deltaOctave=Math.floor((arg0+modeLength-2)/modeLength),octave=Math.floor(calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],that.currentNote))-deltaOctave}else{note=scaleDegreeToPitch(that.keySignature[turtle],scaleDegree),that.currentNote=note;var deltaOctave=Math.floor((arg0-1)/modeLength),octave=Math.floor(calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],that.currentNote))+deltaOctave}console.log("that.currentNote = "+that.currentNote);var cents=0}else{var cents=0,note=arg0;if(-1===SOLFEGENAMES.indexOf(arg0)&&-1===SOLFEGENAMES.indexOf(arg0)||(useSolfegeName=!0),that.currentNote=note,calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],that.currentNote)<0){console.log("minimum allowable octave is 0");var octave=0}else if(9<calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],that.currentNote)){console.log("clipping octave at 9");var octave=9}else var octave=Math.floor(calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],that.currentNote))}}if(0<that.inNeighbor[turtle].length){var noteObj=getNote(note,octave,that.scalarTransposition[turtle],that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);if(that.neighborArgNote1[turtle].push(noteObj[0]+noteObj[1]),"neighbor2"===that.blocks.blockList[last(that.inNeighbor[turtle])].name){var noteObj2=that._addScalarTransposition(turtle,note,octave,parseInt(that.neighborStepPitch[turtle]));0!==that.scalarTransposition[turtle]&&(noteObj2=getNote(noteObj2[0],noteObj2[1],that.scalarTransposition[turtle],that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament))}else var noteObj2=getNote(note,octave,that.scalarTransposition[turtle]+parseInt(that.neighborStepPitch[turtle]),that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);that.neighborArgNote2[turtle].push(noteObj2[0]+noteObj2[1])}var noteObj=that._addScalarTransposition(turtle,note,octave,that.scalarTransposition[turtle]);note=noteObj[0],that.currentNote=note,octave=noteObj[1];var delta=0;if(0<that.justMeasuring[turtle].length){var transposition=2*delta;turtle in that.transposition&&(transposition+=that.transposition[turtle]);var noteObj=getNote(note,octave,transposition,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);if(!that.validNote){that.errorMsg(INVALIDPITCH,blk),that.stopTurtle=!0;break}var n=that.justMeasuring[turtle].length,pitchNumber=pitchToNumber(noteObj[0],noteObj[1],that.keySignature[turtle])-that.pitchNumberOffset[turtle];that.firstPitch[turtle].length<n?that.firstPitch[turtle].push(pitchNumber):that.lastPitch[turtle].length<n&&that.lastPitch[turtle].push(pitchNumber)}else if(that.inPitchDrumMatrix){if("rest"!==note.toLowerCase()&&(that.pitchDrumMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk)),0!==that.invertList[turtle].length&&(delta+=that._calculateInvert(turtle,note,octave)),0<that.duplicateFactor[turtle].length)var duplicateFactor=that.duplicateFactor[turtle];else var duplicateFactor=1;for(var i=0;i<duplicateFactor;i++){var transposition=2*delta;turtle in that.transposition&&(transposition+=that.transposition[turtle]);var nnote=getNote(note,octave,transposition,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);noteIsSolfege(note)&&(nnote[0]=getSolfege(nnote[0])),0<that.drumStyle[turtle].length?that.pitchDrumMatrix.drums.push(last(that.drumStyle[turtle])):(that.pitchDrumMatrix.rowLabels.push(nnote[0]),that.pitchDrumMatrix.rowArgs.push(nnote[1]))}}else if(that.inMatrix){if("rest"!==note.toLowerCase()&&(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk)),0!==that.invertList[turtle].length&&(delta+=that._calculateInvert(turtle,note,octave)),0<that.duplicateFactor[turtle].length)var duplicateFactor=that.duplicateFactor[turtle];else var duplicateFactor=1;for(var i=0;i<duplicateFactor;i++){var transposition=2*delta;turtle in that.transposition&&(transposition+=that.transposition[turtle]);var noteObj=getNote(note,octave,transposition,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);that.previousNotePlayed[turtle]=that.lastNotePlayed[turtle],that.lastNotePlayed[turtle]=[noteObj[0]+noteObj[1],4],"C"===that.keySignature[turtle][0]&&"major"===that.keySignature[turtle][1].toLowerCase()&&noteIsSolfege(note)&&(noteObj[0]=getSolfege(noteObj[0])),0<that.drumStyle[turtle].length?(that.pitchTimeMatrix.rowLabels.push(last(that.drumStyle[turtle])),that.pitchTimeMatrix.rowArgs.push(-1)):(useSolfegeName&&noteObj[0]in SOLFEGECONVERSIONTABLE?that.pitchTimeMatrix.rowLabels.push(SOLFEGECONVERSIONTABLE[noteObj[0]]):that.pitchTimeMatrix.rowLabels.push(noteObj[0]),that.pitchTimeMatrix.rowArgs.push(noteObj[1]))}}else if(0<that.inNoteBlock[turtle].length){var _addPitch=function(e,i,s,l){var o=getNote(e,i,t=transposition+12*that.register[turtle],that.keySignature[turtle],that.moveable[turtle],l,that.errorMsg,that.synth.inTemperament);if(that.validNote||(that.errorMsg(INVALIDPITCH,blk),that.stopTurtle=!0),0<that.drumStyle[turtle].length){var a=last(that.drumStyle[turtle]);that.pitchDrumTable[turtle][o[0]+o[1]]=a}return that.notePitches[turtle][last(that.inNoteBlock[turtle])].push(o[0]),that.noteOctaves[turtle][last(that.inNoteBlock[turtle])].push(o[1]),that.noteCents[turtle][last(that.inNoteBlock[turtle])].push(s),0!==s?that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(pitchToFrequency(o[0],o[1],s,that.keySignature[turtle])):that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(0),o};0!==that.invertList[turtle].length&&(delta+=that._calculateInvert(turtle,note,octave));var transposition=2*delta;turtle in that.transposition&&(transposition+=that.transposition[turtle]);var noteObj1=_addPitch(note,octave,cents);if(transposition=0,turtle in that.intervals&&0<that.intervals[turtle].length)for(var i=0;i<that.intervals[turtle].length;i++){var ii=getInterval(that.intervals[turtle][i],that.keySignature[turtle],noteObj1[0]),noteObj2=getNote(noteObj1[0],noteObj1[1],ii,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);_addPitch(noteObj2[0],noteObj2[1],cents)}if(turtle in that.semitoneIntervals&&0<that.semitoneIntervals[turtle].length)for(var i=0;i<that.semitoneIntervals[turtle].length;i++){var noteObj2=getNote(noteObj1[0],noteObj1[1],that.semitoneIntervals[turtle][i][0],that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);_addPitch(noteObj2[0],noteObj2[1],cents,that.semitoneIntervals[turtle][i][1])}0<that.inNoteBlock[turtle].length&&that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])].push(that.beatFactor[turtle]),that.pushedNote[turtle]=!0}else if(0<that.drumStyle[turtle].length){var drumname=last(that.drumStyle[turtle]),noteObj1=getNote(note,octave,transposition,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg);that.pitchDrumTable[turtle][noteObj1[0]+noteObj1[1]]=drumname}else if(that.inPitchStaircase){for(var frequency=pitchToFrequency(arg0,calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],arg0),0,that.keySignature[turtle]),noteObj1=getNote(arg0,calcOctave(that.currentOctave[turtle],arg1,that.lastNotePlayed[turtle],arg0),0,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg),flag=0,i=0;i<that.pitchStaircase.Stairs.length;i++){if(that.pitchStaircase.Stairs[i][2]<parseFloat(frequency)){that.pitchStaircase.Stairs.splice(i,0,[noteObj1[0],noteObj1[1],parseFloat(frequency),1,1]),flag=1;break}if(that.pitchStaircase.Stairs[i][2]===parseFloat(frequency)){that.pitchStaircase.Stairs.splice(i,1,[noteObj1[0],noteObj1[1],parseFloat(frequency),1,1]),flag=1;break}}0===flag&&that.pitchStaircase.Stairs.push([noteObj1[0],noteObj1[1],parseFloat(frequency),1,1]),that.pitchStaircase.stairPitchBlocks.push(blk)}else if(that.inMusicKeyboard){0!==that.invertList[turtle].length&&(delta+=that._calculateInvert(turtle,note,octave));var transposition=2*delta;turtle in that.transposition&&(transposition+=that.transposition[turtle]);var nnote=getNote(note,octave,transposition,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg);noteIsSolfege(note)&&(nnote[0]=getSolfege(nnote[0])),0===that.drumStyle[turtle].length&&(that.musicKeyboard.noteNames.push(nnote[0]),that.musicKeyboard.octaves.push(nnote[1]))}else{if(that.clearNoteParams(turtle,blk,[]),null==that.currentCalculatedOctave[turtle]&&(that.currentCalculatedOctave[turtle]=4),"scaledegree"==that.blocks.blockList[blk].name)var noteObj=getNote(that.currentNote,calcOctave(that.currentCalculatedOctave[turtle],arg1,that.lastPitchPlayed[turtle],that.currentNote),0,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg);else var noteObj=getNote(arg0,calcOctave(that.currentCalculatedOctave[turtle],arg1,that.lastPitchPlayed[turtle],arg0),0,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg);if(that.validNote||(that.errorMsg(INVALIDPITCH,blk),that.stopTurtle=!0),that.inNoteBlock[turtle].push(blk),that.notePitches[turtle][last(that.inNoteBlock[turtle])].push(noteObj[0]),that.noteOctaves[turtle][last(that.inNoteBlock[turtle])].push(noteObj[1]),that.noteCents[turtle][last(that.inNoteBlock[turtle])].push(cents),0!==cents?that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(pitchToFrequency(noteObj[0],noteObj[1],cents,that.keySignature[turtle])):that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(0),0<that.bpm[turtle].length)var bpmFactor=TONEBPM/last(that.bpm[turtle]);else var bpmFactor=TONEBPM/that._masterBPM;var noteBeatValue=4,beatValue=bpmFactor/noteBeatValue;__callback=function(){var t=that.inNoteBlock[turtle].indexOf(blk);that.inNoteBlock[turtle].splice(t,1)},that._processNote(noteBeatValue,blk,turtle,__callback)}break;case"rhythm2":case"rhythm":if(null===args[0]||"number"!=typeof args[0]||args[0]<1){that.errorMsg(NOINPUTERRORMSG,blk);var arg0=3}else var arg0=args[0];if(null===args[1]||"number"!=typeof args[1]||args[1]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=.25}else var arg1=args[1];if("rhythm2"===that.blocks.blockList[blk].name)var noteBeatValue=1/arg1;else var noteBeatValue=arg1;if(that.inMatrix||that.tuplet){that.inMatrix&&that.pitchTimeMatrix.addColBlock(blk,arg0);for(var i=0;i<args[0];i++)that._processNote(noteBeatValue,blk,turtle)}else if(that.inRhythmRuler){null===that.rhythmRulerMeasure?that.rhythmRulerMeasure=arg0*arg1:that.rhythmRulerMeasure!=arg0*arg1&&that.textMsg(_("polyphonic rhythm"));for(var drumIndex=-1,i=0;i<that.rhythmRuler.Drums.length;i++){var j=that.rhythmRuler.Drums.length-i-1;if(that.rhythmRuler.Drums[j]===that._currentDrumBlock){drumIndex=j;break}}if(-1!==drumIndex)for(var i=0;i<arg0;i++)that.rhythmRuler.Rulers[drumIndex][0].push(noteBeatValue)}else{if(0<that.drumStyle[turtle].length?(that.clearNoteParams(turtle,blk,that.drumStyle[turtle]),that.inNoteBlock[turtle].push(blk)):(that.clearNoteParams(turtle,blk,[]),that.inNoteBlock[turtle].push(blk),that.notePitches[turtle][last(that.inNoteBlock[turtle])]=["G"],that.noteOctaves[turtle][last(that.inNoteBlock[turtle])]=[4],that.noteCents[turtle][last(that.inNoteBlock[turtle])]=[0]),0<that.bpm[turtle].length)var bpmFactor=TONEBPM/last(that.bpm[turtle]);else var bpmFactor=TONEBPM/that._masterBPM;var beatValue=bpmFactor/noteBeatValue;__rhythmPlayNote=function(t,e,i,s,l){setTimeout(function(){that._processNote(t,e,i,s)},l)};for(var i=0;i<arg0;i++)__callback=i===arg0-1?function(){delete that.noteDrums[turtle][blk];var t=that.inNoteBlock[turtle].indexOf(blk);that.inNoteBlock[turtle].splice(t,1)}:null,__rhythmPlayNote(noteBeatValue,blk,turtle,__callback,i*beatValue*1e3);that._doWait(turtle,(arg0-1)*beatValue)}break;case"wholeNote":that._processNote(1,blk,turtle);break;case"halfNote":that._processNote(2,blk,turtle);break;case"quarterNote":that._processNote(4,blk,turtle);break;case"eighthNote":that._processNote(8,blk,turtle);break;case"sixteenthNote":that._processNote(16,blk,turtle);break;case"thirtysecondNote":that._processNote(32,blk,turtle);break;case"sixtyfourthNote":that._processNote(64,blk,turtle);break;case"pickup":if(1!==args.length||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);break}var arg0=args[0];that.pickup[turtle]=arg0<0?0:arg0,that.notationPickup(turtle,that.pickup[turtle]);break;case"everybeatdo":if(args[0]in that.actions){var __listener=function(t){if(that.turtles.turtleList[turtle].running){var e=new Queue(that.actions[args[0]],1,blk);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(e)}else isflow?that._runFromBlockNow(that,turtle,that.actions[args[0]],isflow,receivedArg):that._runFromBlock(that,turtle,that.actions[args[0]],isflow,receivedArg)},eventName="__everybeat_"+turtle+"__";that._setListener(turtle,eventName,__listener),that.beatList[turtle].push("everybeat")}else that.errorMsg(NOACTIONERRORMSG,blk,args[1]);break;case"offbeatdo":if(args[0]in that.actions){var __listener=function(t){if(that.turtles.turtleList[turtle].running){var e=new Queue(that.actions[args[0]],1,blk);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(e)}else isflow?that._runFromBlockNow(that,turtle,that.actions[args[0]],isflow,receivedArg):that._runFromBlock(that,turtle,that.actions[args[0]],isflow,receivedArg)},eventName="__offbeat_"+turtle+"__";that._setListener(turtle,eventName,__listener),that.beatList[turtle].push("offbeat")}else that.errorMsg(NOACTIONERRORMSG,blk,args[1]);break;case"onbeatdo":if(2===args.length)if(args[1]in that.actions){var __listener=function(t){if(that.turtles.turtleList[turtle].running){var e=new Queue(that.actions[args[1]],1,blk);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(e)}else isflow?that._runFromBlockNow(that,turtle,that.actions[args[1]],isflow,receivedArg):that._runFromBlock(that,turtle,that.actions[args[1]],isflow,receivedArg)},eventName="__beat_"+args[0]+"_"+turtle+"__";that._setListener(turtle,eventName,__listener),args[0]>that.beatsPerMeasure[turtle]?that.factorList[turtle].push(args[0]):that.beatList[turtle].push(args[0])}else that.errorMsg(NOACTIONERRORMSG,blk,args[1]);break;case"meter":if(null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0=4}else var arg0=args[0];if(that.insideMeterWidget&&(that._meterBlock=blk),null===args[1]||"number"!=typeof args[1]){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=.25}else var arg1=args[1];that.beatsPerMeasure[turtle]=arg0<=0?4:arg0,that.noteValuePerBeat[turtle]=arg1<=0?4:1/arg1,that.notationMeter(turtle,that.beatsPerMeasure[turtle],that.noteValuePerBeat[turtle]);break;case"osctime":case"newnote":case"note":if(void 0===args[1])break;if(0===that.inNoteBlock[turtle].length){if(that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]<that.pickup[turtle])var beatValue=0,measureValue=0;else var beatValue=(that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]-that.pickup[turtle])*that.noteValuePerBeat[turtle]%that.beatsPerMeasure[turtle]+1,measureValue=Math.floor((that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]-that.pickup[turtle])*that.noteValuePerBeat[turtle]/that.beatsPerMeasure[turtle])+1;that.currentBeat[turtle]=beatValue,that.currentMeasure[turtle]=measureValue}if(childFlow=args[1],childFlowCount=1,0===that.inNoteBlock[turtle].length){if(-1!==that.beatList[turtle].indexOf("everybeat")){var queueBlock=new Queue(childFlow,childFlowCount,blk,receivedArg);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(queueBlock),childFlow=null;var eventName="__everybeat_"+turtle+"__";that.stage.dispatchEvent(eventName)}if(-1!==that.beatList[turtle].indexOf(beatValue)){var queueBlock=new Queue(childFlow,childFlowCount,blk,receivedArg);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(queueBlock),childFlow=null;var eventName="__beat_"+beatValue+"_"+turtle+"__";that.stage.dispatchEvent(eventName)}else if(1<beatValue&&-1!==that.beatList[turtle].indexOf("offbeat")){var queueBlock=new Queue(childFlow,childFlowCount,blk,receivedArg);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(queueBlock),childFlow=null;var eventName="__offbeat_"+turtle+"__";that.stage.dispatchEvent(eventName)}for(var thisBeat=beatValue+that.beatsPerMeasure[turtle]*(that.currentMeasure[turtle]-1),f=0;f<that.factorList[turtle].length;f++){var factor=thisBeat/that.factorList[turtle][f];if(factor===Math.floor(factor)){var queueBlock=new Queue(childFlow,childFlowCount,blk,receivedArg);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(queueBlock),childFlow=null;var eventName="__beat_"+that.factorList[turtle][f]+"_"+turtle+"__";that.stage.dispatchEvent(eventName)}}}if(that.clearNoteParams(turtle,blk,[]),null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=.25}else var arg=args[0];if(0<arg)if("newnote"===that.blocks.blockList[blk].name)var noteBeatValue=1/arg;else var noteBeatValue=arg;else{that.errorMsg(_("Note value must be greater than 0."),blk);var noteBeatValue=-arg}that.inNoteBlock[turtle].push(blk),1<that.inNoteBlock[turtle].length&&(that.multipleVoices[turtle]=!0),that.noteValue[turtle][last(that.inNoteBlock[turtle])]=1/(noteBeatValue*that.beatFactor[turtle]);var listenerName="_playnote_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){if(that.multipleVoices[turtle]&&that.notationVoices(turtle,that.inNoteBlock[turtle].length),0<that.inNoteBlock[turtle].length){if(0<that.inNeighbor[turtle].length){var e=that.neighborNoteValue[turtle];that.neighborArgBeat[turtle].push(that.beatFactor[turtle]*(1/e));var i=1/noteBeatValue-2*that.neighborNoteValue[turtle];that.neighborArgCurrentBeat[turtle].push(that.beatFactor[turtle]*(1/i))}that._processNote(1/that.noteValue[turtle][last(that.inNoteBlock[turtle])],last(that.inNoteBlock[turtle]),turtle)}delete that.oscList[turtle][last(that.inNoteBlock[turtle])],delete that.noteBeat[turtle][last(that.inNoteBlock[turtle])],delete that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])],delete that.noteValue[turtle][last(that.inNoteBlock[turtle])],delete that.notePitches[turtle][last(that.inNoteBlock[turtle])],delete that.noteOctaves[turtle][last(that.inNoteBlock[turtle])],delete that.noteCents[turtle][last(that.inNoteBlock[turtle])],delete that.noteHertz[turtle][last(that.inNoteBlock[turtle])],delete that.noteDrums[turtle][last(that.inNoteBlock[turtle])],delete that.embeddedGraphics[turtle][last(that.inNoteBlock[turtle])],that.inNoteBlock[turtle].splice(-1,1),that.multipleVoices[turtle]&&0===that.inNoteBlock[turtle].length&&(that.notationVoices(turtle,that.inNoteBlock[turtle].length),that.multipleVoices[turtle]=!1),that.pitchBlocks=[],that.drumBlocks=[]};that._setListener(turtle,listenerName,__listener);break;case"rhythmicdot":case"rhythmicdot2":if("rhythmicdot"===that.blocks.blockList[blk].name)var arg=1;else if(null==args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=0}else var arg=args[0];var currentDotFactor=2-1/Math.pow(2,that.dotCount[turtle]);that.beatFactor[turtle]*=currentDotFactor,0<=arg?that.dotCount[turtle]+=arg:-1===arg?(that.errorMsg(_("An argument of -1 results in a note value of 0."),blk),console.log("ignoring dot arg of -1"),arg=0):that.dotCount[turtle]+=1/arg;var newDotFactor=2-1/Math.pow(2,that.dotCount[turtle]);that.beatFactor[turtle]/=newDotFactor,childFlow="rhythmicdot"===that.blocks.blockList[blk].name?args[0]:args[1],childFlowCount=1;var listenerName="_dot_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){var e=2-1/Math.pow(2,that.dotCount[turtle]);that.beatFactor[turtle]*=e,that.dotCount[turtle]-=0<=arg?arg:1/arg;var i=2-1/Math.pow(2,that.dotCount[turtle]);that.beatFactor[turtle]/=i};that._setListener(turtle,listenerName,__listener);break;case"settimbre":if(null===args[0])that.errorMsg(NOINPUTERRORMSG,blk),childFlow=args[1],childFlowCount=1;else{that.inSetTimbre[turtle]=!0;var synth=args[0];for(var voice in VOICENAMES){if(VOICENAMES[voice][0]===args[0]){synth=VOICENAMES[voice][1];break}if(VOICENAMES[voice][1]===args[0]){synth=args[0];break}}that.inMatrix&&(that.pitchTimeMatrix._instrumentName=synth),-1===that.instrumentNames[turtle].indexOf(synth)&&(that.instrumentNames[turtle].push(synth),that.synth.loadSynth(turtle,synth),null==that.synthVolume[turtle][synth]&&(that.synthVolume[turtle][synth]=[DEFAULTVOLUME],that.crescendoInitialVolume[turtle][synth]=[DEFAULTVOLUME])),childFlow=args[1],childFlowCount=1;var listenerName="_settimbre_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.inSetTimbre[turtle]=!1,that.instrumentNames[turtle].pop()};that._setListener(turtle,listenerName,__listener),that.inRhythmRuler&&(that._currentDrumBlock=blk,that.rhythmRuler.Drums.push(blk),that.rhythmRuler.Rulers.push([[],[]]))}break;case"decrescendo":case"crescendo":if(1<args.length&&0!==args[0]){for(var synth in"crescendo"===that.blocks.blockList[blk].name?that.crescendoDelta[turtle].push(args[0]):that.crescendoDelta[turtle].push(-args[0]),that.synthVolume[turtle]){var vol=last(that.synthVolume[turtle][synth]);that.synthVolume[turtle][synth].push(vol),null==that.crescendoInitialVolume[turtle][synth]?that.crescendoInitialVolume[turtle][synth]=[vol]:that.crescendoInitialVolume[turtle][synth].push(vol)}that.inCrescendo[turtle].push(!0),childFlow=args[1],childFlowCount=1;var listenerName="_crescendo_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){for(var e in 0===that.justCounting[turtle].length&&that.notationEndCrescendo(turtle,last(that.crescendoDelta[turtle])),that.crescendoDelta[turtle].pop(),that.synthVolume[turtle]){var i=that.synthVolume[turtle][e].length;that.synthVolume[turtle][e][i-1]=last(that.crescendoInitialVolume[turtle][e]),that.crescendoInitialVolume[turtle][e].pop()}};that._setListener(turtle,listenerName,__listener)}break;case"darbuka":case"clang":case"bottle":case"duck":case"snare":case"hihat":case"tom":case"kick":case"pluck":case"triangle1":case"slap":case"frogs":case"fingercymbals":case"cup":case"cowbell":case"splash":case"ridebell":case"floortom":case"crash":case"chine":case"dog":case"cat":case"clap":case"bubbles":case"cricket":that.drumStyle[turtle].push(that.blocks.blockList[blk].name),childFlow=args[0],childFlowCount=1;var listenerName="_drum_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.drumStyle[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"setdrum":var drumname=DEFAULTDRUM;for(var drum in DRUMNAMES)DRUMNAMES[drum][0]===args[0]?drumname=DRUMNAMES[drum][1]:DRUMNAMES[drum][1]===args[0]&&(drumname=args[0]);that.drumStyle[turtle].push(drumname),childFlow=args[1],childFlowCount=1;var listenerName="_setdrum_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.drumStyle[turtle].pop()};that._setListener(turtle,listenerName,__listener),that.inRhythmRuler&&(that._currentDrumBlock=blk,that.rhythmRuler.Drums.push(blk),that.rhythmRuler.Rulers.push([[],[]]));break;case"setvoice":var voicename=null;for(var voice in VOICENAMES)VOICENAMES[voice][0]===args[0]?voicename=VOICENAMES[voice][1]:VOICENAMES[voice][1]===args[0]&&(voicename=args[0]);if(null==voicename)for(var drum in DRUMNAMES)DRUMNAMES[drum][0]===args[0]?voicename=DRUMNAMES[drum][1]:DRUMNAMES[drum][1]===args[0]&&(voicename=args[0]);if(null==voicename)that.errorMsg(NOINPUTERRORMSG,blk),childFlow=args[1],childFlowCount=1;else{that.voices[turtle].push(voicename),childFlow=args[1],childFlowCount=1;var listenerName="_setvoice_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.voices[turtle].pop()};that._setListener(turtle,listenerName,__listener)}break;case"vibrato":var intensity=args[0],rate=args[1];(intensity<1||100<intensity)&&(that.errorMsg(_("Vibrato intensity must be between 1 and 100."),blk),that.stopTurtle=!0),rate<=0&&(that.errorMsg(_("Vibrato rate must be greater than 0."),blk),that.stopTurtle=!0),childFlow=args[2],childFlowCount=1,that.vibratoIntensity[turtle].push(intensity/100),that.vibratoRate[turtle].push(1/rate);var listenerName="_vibrato_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.vibratoIntensity[turtle].pop(),that.vibratoRate[turtle].pop()};that._setListener(turtle,listenerName,__listener),that.inTimbre&&(instrumentsEffects[turtle][that.timbre.instrumentName].vibratoActive=!0,that.timbre.vibratoEffect.push(blk),that.timbre.vibratoParams.push(100*last(that.vibratoIntensity[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].vibratoIntensity=that.vibratoIntensity[turtle],that.timbre.vibratoParams.push(last(that.vibratoRate[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].vibratoFrequency=rate);break;case"dis":var distortion=args[0]/100;(distortion<0||1<distortion)&&(that.errorMsg(_("Distortion must be from 0 to 100."),blk),that.stopTurtle=!0),childFlow=args[1],childFlowCount=1,that.distortionAmount[turtle].push(distortion);var listenerName="_distortion_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.distortionAmount[turtle].pop()};that._setListener(turtle,listenerName,__listener),that.inTimbre&&(instrumentsEffects[turtle][that.timbre.instrumentName].distortionActive=!0,that.timbre.distortionEffect.push(blk),that.timbre.distortionParams.push(100*last(that.distortionAmount[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].distortionAmount=distortion);break;case"tremolo":var frequency=args[0],depth=args[1]/100;(depth<0||1<depth)&&(that.errorMsg(_("Depth is out of range."),blk),that.stopTurtle=!0),childFlow=args[2],childFlowCount=1,that.tremoloFrequency[turtle].push(frequency),that.tremoloDepth[turtle].push(depth);var listenerName="_tremolo_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.tremoloFrequency[turtle].pop(),that.tremoloDepth[turtle].pop()};that._setListener(turtle,listenerName,__listener),that.inTimbre&&(instrumentsEffects[turtle][that.timbre.instrumentName].tremoloActive=!0,that.timbre.tremoloEffect.push(blk),that.timbre.tremoloParams.push(last(that.tremoloFrequency[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].tremoloFrequency=frequency,that.timbre.tremoloParams.push(100*last(that.tremoloDepth[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].tremoloDepth=depth);break;case"phaser":var rate=args[0],octaves=args[1],baseFrequency=args[2];childFlow=args[3],childFlowCount=1,that.rate[turtle].push(rate),that.octaves[turtle].push(octaves),that.baseFrequency[turtle].push(baseFrequency);var listenerName="_phaser_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.rate[turtle].pop(),that.octaves[turtle].pop(),that.baseFrequency[turtle].pop()};that._setListener(turtle,listenerName,__listener),that.inTimbre&&(instrumentsEffects[turtle][that.timbre.instrumentName].phaserActive=!0,that.timbre.phaserEffect.push(blk),that.timbre.phaserParams.push(last(that.rate[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].rate=rate,that.timbre.phaserParams.push(last(that.octaves[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].octaves=octaves,that.timbre.phaserParams.push(last(that.baseFrequency[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].baseFrequency=baseFrequency);break;case"chorus":var chorusRate=args[0],delayTime=args[1],chorusDepth=args[2]/100;(chorusDepth<0||1<chorusDepth)&&(that.errorMsg(_("Depth is out of range."),blk),that.stopTurtle=!0),childFlow=args[3],childFlowCount=1,that.chorusRate[turtle].push(chorusRate),that.delayTime[turtle].push(delayTime),that.chorusDepth[turtle].push(chorusDepth);var listenerName="_chorus_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.chorusRate[turtle].pop(),that.delayTime[turtle].pop(),that.chorusDepth[turtle].pop()};that._setListener(turtle,listenerName,__listener),that.inTimbre&&(instrumentsEffects[turtle][that.timbre.instrumentName].chorusActive=!0,that.timbre.chorusEffect.push(blk),that.timbre.chorusParams.push(last(that.chorusRate[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].chorusRate=chorusRate,that.timbre.chorusParams.push(last(that.delayTime[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].delayTime=delayTime,that.timbre.chorusParams.push(100*last(that.chorusDepth[turtle])),instrumentsEffects[turtle][that.timbre.instrumentName].chorusDepth=chorusDepth);break;case"harmonic2":if("number"!=typeof args[0]||args[0]<0){that.errorMsg(_("Partial must be greater than or equal to 0.")),that.stopTurtle=!0;break}that.inHarmonic[turtle].push(blk),that.partials[turtle].push([]);for(var n=that.partials[turtle].length-1,i=0;i<args[0];i++)that.partials[turtle][n].push(0);that.partials[turtle][n].push(1),that.notationBeginHarmonics(turtle),childFlow=args[1],childFlowCount=1;var listenerName="_harmonic_"+turtle+"_"+blk;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.inHarmonic[turtle].pop(),that.partials[turtle].pop(),that.notationEndHarmonics(turtle)};that._setListener(turtle,listenerName,__listener);break;case"harmonic":that.inHarmonic[turtle].push(blk),that.partials[turtle].push([]),childFlow=args[0],childFlowCount=1;var listenerName="_harmonic_"+turtle+"_"+blk;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.inHarmonic[turtle].pop(),that.partials[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"partial":if("number"!=typeof args[0]||1<args[0]||args[0]<0){that.errorMsg(_("Partial weight must be between 0 and 1.")),that.stopTurtle=!0;break}if(0<that.inHarmonic[turtle].length){var n=that.inHarmonic[turtle].length-1;that.partials[turtle][n].push(args[0])}else that.errorMsg(_("Partial block should be used inside of a Weighted-partials block."));break;case"neighbor":case"neighbor2":if("number"!=typeof args[0]||"number"!=typeof args[1]){that.errorMsg(NANERRORMSG,blk),that.stopTurtle=!0;break}that.inNeighbor[turtle].push(blk),that.neighborStepPitch[turtle].push(args[0]),that.neighborNoteValue[turtle].push(args[1]),childFlow=args[2],childFlowCount=1;var listenerName="_neighbor_"+turtle+"_"+blk;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.inNeighbor[turtle].pop(),that.neighborStepPitch[turtle].pop(),that.neighborNoteValue[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"interval":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=1}else var arg=args[0];if(0<args)var i=Math.floor(arg);else var i=Math.ceil(arg);that.intervals[turtle].push(i);var listenerName="_interval_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.intervals[turtle].pop()};that._setListener(turtle,listenerName,__listener),childFlow=args[1],childFlowCount=1;break;case"semitoneinterval":if(void 0===args[1])break;if(arg=null===args[0]||"number"!=typeof args[0]?(that.errorMsg(NOINPUTERRORMSG,blk),1):args[0],0<arg)var i=Math.floor(arg);else var i=Math.ceil(arg);if(0!==i){that.semitoneIntervals[turtle].push([i,that.noteDirection[turtle]]),that.noteDirection[turtle]=0;var listenerName="_semitone_interval_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.semitoneIntervals[turtle].pop()};that._setListener(turtle,listenerName,__listener)}childFlow=args[1],childFlowCount=1;break;case"newstaccato":case"staccato":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=1/32}else var arg=args[0];"newstaccato"===that.blocks.blockList[blk].name?that.staccato[turtle].push(1/arg):that.staccato[turtle].push(arg),childFlow=args[1],childFlowCount=1;var listenerName="_staccato_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.staccato[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"newslur":case"slur":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=1/16}else var arg=args[0];"slur"===that.blocks.blockList[blk].name?that.staccato[turtle].push(-arg):that.staccato[turtle].push(-1/arg),0===that.justCounting[turtle].length&&that.notationBeginSlur(turtle),childFlow=args[1],childFlowCount=1;var listenerName="_staccato_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.staccato[turtle].pop(),0===that.justCounting[turtle].length&&that.notationEndSlur(turtle)};that._setListener(turtle,listenerName,__listener);break;case"glide":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=1/16}else var arg=args[0];that.glide[turtle].push(arg),0===that.justCounting[turtle].length&&that.notationBeginSlur(turtle),childFlow=args[1],childFlowCount=1,that.glideOverride[turtle]=that._noteCounter(turtle,childFlow),console.log("length of glide "+that.glideOverride[turtle]);var listenerName="_glide_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){0===that.justCounting[turtle].length&&that.notationEndSlur(turtle),that.glide[turtle].pop()};that._setListener(turtle,listenerName,__listener);break;case"drift":if(void 0===args[0])break;that.drift[turtle]+=1,childFlow=args[0],childFlowCount=1;var listenerName="_drift_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.drift[turtle]-=1};that._setListener(turtle,listenerName,__listener);break;case"tie":if(void 0===args[0])break;that.tie[turtle]=!0,that.tieNotePitches[turtle]=[],that.tieNoteExtras[turtle]=[],that.tieCarryOver[turtle]=0,that.tieFirstDrums[turtle]=[],childFlow=args[0],childFlowCount=1;var listenerName="_tie_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){if(that.tie[turtle]=!1,0<that.tieCarryOver[turtle]){if(0===that.justCounting[turtle].length){var e=last(that.inNoteBlock[turtle]);if(null!=e&&e in that.notePitches[turtle])for(var i=0;i<that.notePitches[turtle][last(that.inNoteBlock[turtle])].length;i++)that.notationRemoveTie(turtle)}var s=that.tieNoteExtras[turtle][0],l=that.tieCarryOver[turtle];that.tieCarryOver[turtle]=0,that.inNoteBlock[turtle].push(s),that.notePitches[turtle][s]=[],that.noteOctaves[turtle][s]=[],that.noteCents[turtle][s]=[],that.noteHertz[turtle][s]=[];for(i=0;i<that.tieNotePitches[turtle].length;i++)that.notePitches[turtle][s].push(that.tieNotePitches[turtle][i][0]),that.noteOctaves[turtle][s].push(that.tieNotePitches[turtle][i][1]),that.noteCents[turtle][s].push(that.tieNotePitches[turtle][i][2]),that.noteHertz[turtle][s].push(that.tieNotePitches[turtle][i][3]);if(that.oscList[turtle][s]=that.tieNoteExtras[turtle][1],that.noteBeat[turtle][s]=that.tieNoteExtras[turtle][2],that.noteBeatValues[turtle][s]=that.tieNoteExtras[turtle][3],that.noteDrums[turtle][s]=that.tieNoteExtras[turtle][4],that.embeddedGraphics[turtle][s]=[],that._processNote(l,s,turtle),0<that.bpm[turtle].length)var o=TONEBPM/last(that.bpm[turtle]);else o=TONEBPM/that._masterBPM;that._doWait(turtle,o/l),that.inNoteBlock[turtle].pop(),delete that.notePitches[turtle][s],delete that.noteOctaves[turtle][s],delete that.noteCents[turtle][s],delete that.noteHertz[turtle][s],delete that.oscList[turtle][s],delete that.noteBeat[turtle][s],delete that.noteBeatValues[turtle][s],delete that.noteDrums[turtle][s],delete that.embeddedGraphics[turtle][s],that.notationStaging[turtle].pop()}that.tieNotePitches[turtle]=[],that.tieNoteExtras[turtle]=[]};that._setListener(turtle,listenerName,__listener);break;case"newswing":case"newswing2":case"swing":if("newswing2"===that.blocks.blockList[blk].name){if(void 0===args[2])break;if(null===args[0]||"number"!=typeof args[0]||args[0]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var arg0=1/24}else var arg0=args[0];if(null===args[1]||"number"!=typeof args[1]||args[1]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=1/8}else var arg1=args[1];that.suppressOutput[turtle]?that.notationSwing(turtle):(that.swing[turtle].push(1/arg0),that.swingTarget[turtle].push(1/arg1)),childFlow=args[2]}else childFlow=("newswing"===that.blocks.blockList[blk].name?that.swing[turtle].push(1/args[0]):that.swing[turtle].push(args[0]),that.swingTarget[turtle].push(null),args[1]);that.swingCarryOver[turtle]=0,childFlowCount=1;var listenerName="_swing_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.suppressOutput[turtle]||(that.swingTarget[turtle].pop(),that.swing[turtle].pop()),that.swingCarryOver[turtle]=0};that._setListener(turtle,listenerName,__listener);break;case"duplicatenotes":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]||args[0]<1){that.errorMsg(NOINPUTERRORMSG,blk);var arg0=2}else var arg0=args[0];var factor=Math.floor(arg0);if(factor<1)that.errorMsg(ZERODIVIDEERRORMSG,blk),that.stopTurtle=!0;else{that.duplicateFactor[turtle]*=factor;var listenerName="_duplicate_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __lookForOtherTurtles=function(t,e){for(var i in that.connectionStore)if(i!==e.toString())for(var s in that.connectionStore[i])if(s===t.toString())return i;return null};that.inDuplicate[turtle]=!0;var __listener=function(t){if(that.inDuplicate[turtle]=!1,that.duplicateFactor[turtle]/=factor,that.connectionStoreLock&&console.log("LOCKED"),that.connectionStoreLock=!0,null==__lookForOtherTurtles(blk,turtle))for(var e=that.connectionStore[turtle][blk].length,i=0;i<e;i++){var s=that.connectionStore[turtle][blk].pop();that.blocks.blockList[s[0]].connections[s[1]]=s[2],null!=s[2]&&(that.blocks.blockList[s[2]].connections[0]=s[0])}else delete that.connectionStore[turtle][blk];that.connectionStoreLock=!1};that._setListener(turtle,listenerName,__listener),that.connectionStoreLock&&console.log("LOCKED"),that.connectionStoreLock=!0;var otherTurtle=__lookForOtherTurtles(blk,turtle);if(null!=otherTurtle){that.connectionStore[turtle][blk]=[];for(var i=that.connectionStore[otherTurtle][blk].length;0<i;i--){var obj=[that.connectionStore[otherTurtle][blk][i-1][0],that.connectionStore[otherTurtle][blk][i-1][1],that.connectionStore[otherTurtle][blk][i-1][2]];that.connectionStore[turtle][blk].push(obj);var child=obj[0];"hidden"===that.blocks.blockList[child].name&&(child=that.blocks.blockList[child].connections[0]);var queueBlock=new Queue(child,factor,blk,receivedArg);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(queueBlock)}}else{for(var child=that.blocks.findBottomBlock(args[1]);child!=blk;){if("hidden"!==that.blocks.blockList[child].name){var queueBlock=new Queue(child,factor,blk,receivedArg);that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(queueBlock)}child=that.blocks.blockList[child].connections[0]}that.connectionStore[turtle][blk]=[];for(var child=args[1];null!=child;){var lastConnection=that.blocks.blockList[child].connections.length-1,nextBlk=that.blocks.blockList[child].connections[lastConnection];null!=nextBlk&&"hidden"===that.blocks.blockList[nextBlk].name?(that.connectionStore[turtle][blk].push([nextBlk,1,that.blocks.blockList[nextBlk].connections[1]]),child=that.blocks.blockList[nextBlk].connections[1],that.blocks.blockList[nextBlk].connections[1]=null):(that.connectionStore[turtle][blk].push([child,lastConnection,nextBlk]),that.blocks.blockList[child].connections[lastConnection]=null,child=nextBlk),null!=child&&(that.blocks.blockList[child].connections[0]=null)}}that.connectionStoreLock=!1}break;case"skipnotes":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]||args[0]<1){that.errorMsg(NOINPUTERRORMSG,blk);var factor=2}else var factor=args[0];that.skipFactor[turtle]*=factor,childFlow=args[1],childFlowCount=1;var listenerName="_skip_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.skipFactor[turtle]/=factor,1===that.skipFactor[turtle]&&(that.skipIndex[turtle]=0)};that._setListener(turtle,listenerName,__listener);break;case"multiplybeatfactor":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]||args[0]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var factor=2}else var factor=args[0];that.beatFactor[turtle]/=factor,childFlow=args[1],childFlowCount=1;var listenerName="_multiplybeat_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.beatFactor[turtle]*=factor};that._setListener(turtle,listenerName,__listener);break;case"setscalartransposition":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var transValue=0}else var transValue=args[0];0!==that.invertList[turtle].length?that.scalarTransposition[turtle]-=transValue:that.scalarTransposition[turtle]+=transValue,that.scalarTranspositionValues[turtle].push(transValue),childFlow=args[1],childFlowCount=1;var listenerName="_scalar_transposition_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){var e=that.scalarTranspositionValues[turtle].pop();0!==that.invertList[turtle].length?that.scalarTransposition[turtle]+=e:that.scalarTransposition[turtle]-=e};that._setListener(turtle,listenerName,__listener);break;case"register":null!==args[0]&&"number"==typeof args[0]&&(that.register[turtle]=Math.floor(args[0]));break;case"settransposition":if(void 0===args[1])break;if(null!==args[0]&&"number"==typeof args[0]){var transValue=args[0];0!==that.invertList[turtle].length?that.transposition[turtle]-=transValue:that.transposition[turtle]+=transValue,that.transpositionValues[turtle].push(transValue),childFlow=args[1],childFlowCount=1;var listenerName="_transposition_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){var e=that.transpositionValues[turtle].pop();0!==that.invertList[turtle].length?that.transposition[turtle]+=e:that.transposition[turtle]-=e};that._setListener(turtle,listenerName,__listener)}break;case"sharp":if(void 0===args[0])break;0!==that.invertList[turtle].length?that.transposition[turtle]-=1:that.transposition[turtle]+=1,childFlow=args[0],childFlowCount=1;var listenerName="_sharp_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){0!==that.invertList[turtle].length?that.transposition[turtle]+=1:that.transposition[turtle]-=1};that._setListener(turtle,listenerName,__listener);break;case"flat":if(void 0===args[0])break;0!==that.invertList[turtle].length?that.transposition[turtle]+=1:that.transposition[turtle]-=1,childFlow=args[0],childFlowCount=1;var listenerName="_flat_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){0!==that.invertList[turtle].length?that.transposition[turtle]-=1:that.transposition[turtle]+=1};that._setListener(turtle,listenerName,__listener);break;case"accidental":if(void 0===args[1])break;if(null===args[0]||"string"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg="sharp"}else var arg=args[0];var i=ACCIDENTALNAMES.indexOf(arg);if(-1===i)switch(arg){case _("sharp"):value=1;break;case _("flat"):value=-1;break;default:value=0}else value=ACCIDENTALVALUES[i];0!==that.invertList[turtle].length?that.transposition[turtle]-=value:that.transposition[turtle]+=value,childFlow=args[1],childFlowCount=1;var listenerName="_accidental_"+turtle+"_"+blk;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){0!==that.invertList[turtle].length?that.transposition[turtle]+=value:that.transposition[turtle]-=value};that._setListener(turtle,listenerName,__listener);break;case"articulation":if(void 0===args[1])break;if(null===args[0]||_typeof("number"!==args[0])){that.errorMsg(NOINPUTERRORMSG,blk);var arg=0}else var arg=args[0];for(var synth in that.synthVolume[turtle]){var newVolume=last(that.synthVolume[turtle][synth])*(100+arg)/100;100<newVolume?(console.log("articulated volume exceeds 100%. clipping"),newVolume=100):newVolume<-100&&(console.log("articulated volume exceeds 100%. clipping"),newVolume=-100),null==that.synthVolume[turtle][synth]?that.synthVolume[turtle][synth]=[newVolume]:that.synthVolume[turtle][synth].push(newVolume),this.suppressOutput[turtle]||that.setSynthVolume(turtle,synth,newVolume)}0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setsynthvolume",synth,newVolume]),0===that.justCounting[turtle].length&&that.notationBeginArticulation(turtle),childFlow=args[1],childFlowCount=1;var listenerName="_articulation_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){for(var e in that.synthVolume[turtle])that.synthVolume[turtle][e].pop(),that.setSynthVolume(turtle,e,last(that.synthVolume[turtle][e])),that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setsynthvolume",e,last(that.synthVolume[turtle][e])]);0===that.justCounting[turtle].length&&that.notationEndArticulation(turtle)};that._setListener(turtle,listenerName,__listener);break;case"setnotevolume":if(1===args.length)if("number"!=typeof args[0])that.errorMsg(NANERRORMSG,blk);else{if(args[0]<0)var arg=0;else if(100<args[0])var arg=100;else var arg=args[0];0===arg&&that.errorMsg(_("Setting volume to 0."),blk),that.masterVolume.push(arg),this.suppressOutput[turtle]||that._setMasterVolume(arg),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setvolume",arg])}break;case"settemperament":that.synth.inTemperament=args[0],that.synth.startingPitch=args[1]+""+args[2],that.temperamentSelected.push(args[0]);var len=that.temperamentSelected.length;that.temperamentSelected[len-1]!==that.temperamentSelected[len-2]&&(that.synth.changeInTemperament=!0);break;case"setnotevolume2":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg=50}else{if(args[0]<0)var arg=0;else if(100<args[0])var arg=100;else var arg=args[0];0===arg&&that.errorMsg(_("Setting volume to 0."),blk)}that.masterVolume.push(arg),this.suppressOutput[turtle]||that._setMasterVolume(arg),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setvolume",arg]),childFlow=args[1],childFlowCount=1;var listenerName="_volume_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.masterVolume.pop(),0===that.justCounting[turtle].length&&0<that.masterVolume.length&&that._setMasterVolume(last(that.masterVolume))};that._setListener(turtle,listenerName,__listener);break;case"setsynthvolume":if(null===args[0]||"string"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0="electronic synth"}else var arg0=args[0];if(null===args[1]||"number"!=typeof args[1]){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=50}else{if(args[1]<0)var arg1=0;else if(100<args[1])var arg1=100;else var arg1=args[1];0===arg1&&that.errorMsg(_("Setting volume to 0."),blk)}var synth=null;if("electronic synth"===arg0||arg0===_("electronic synth")?synth="electronic synth":"custom"!==arg0&&arg0!==_("custom")||(synth="custom"),null===synth)for(var voice in VOICENAMES){if(VOICENAMES[voice][0]===arg0){synth=VOICENAMES[voice][1];break}if(VOICENAMES[voice][1]===arg0){synth=arg0;break}}if(null===synth)for(var drum in DRUMNAMES){if(DRUMNAMES[drum][0].replace("-"," ")===arg0){synth=DRUMNAMES[drum][1];break}if(DRUMNAMES[drum][1].replace("-"," ")===arg0){synth=arg0;break}}null===synth&&(that.errorMsg(synth+"not found",blk),synth="electronic synth"),-1===that.instrumentNames[turtle].indexOf(synth)&&(that.instrumentNames[turtle].push(synth),that.synth.loadSynth(turtle,synth),void 0===that.synthVolume[turtle][synth]&&(that.synthVolume[turtle][synth]=[DEFAULTVOLUME],that.crescendoInitialVolume[turtle][synth]=[DEFAULTVOLUME])),that.synthVolume[turtle][synth].push(args[1]),this.suppressOutput[turtle]||that.setSynthVolume(turtle,synth,args[1]),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setsynthvolume",synth,arg1]);break;case"setsynthvolume2":if(void 0===args[2])break;if(null===args[0]||"string"!=typeof args[0]){that.errorMsg(NOINPUTERRORMSG,blk);var arg0="electronic synth"}else var arg0=args[0];if(null===args[1]||"number"!=typeof args[1]){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=50}else{if(args[1]<0)var arg1=0;else if(100<args[1])var arg1=100;else var arg1=args[1];0===arg1&&that.errorMsg(_("Setting volume to 0."),blk)}var synth=null;if("electronic synth"===arg0||arg0===_("electronic synth")?synth="electronic synth":"custom"!==arg0&&args[0]!==_("custom")||(synth="custom"),null===synth)for(var voice in VOICENAMES){if(VOICENAMES[voice][0]===arg0){synth=VOICENAMES[voice][1];break}if(VOICENAMES[voice][1]===arg0){synth=arg0;break}}if(null===synth)for(var drum in DRUMNAMES){if(DRUMNAMES[drum][0].replace("-"," ")===arg0){synth=DRUMNAMES[drum][1];break}if(DRUMNAMES[drum][1].replace("-"," ")===arg0){synth=arg0;break}}null===synth&&(that.errorMsg(_("Synth not found"),blk),synth="electronic synth"),-1===that.instrumentNames[turtle].indexOf(synth)&&(that.instrumentNames[turtle].push(synth),that.synth.loadSynth(turtle,synth),null==that.synthVolume[turtle][synth]&&(that.synthVolume[turtle][synth]=[DEFAULTVOLUME],that.crescendoInitialVolume[turtle][synth]=[DEFAULTVOLUME])),that.synthVolume[turtle][synth].push(arg1),this.suppressOutput[turtle]||that.setSynthVolume(turtle,synth,arg1),0===that.justCounting[turtle].length&&that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setsynthvolume",synth,arg1]),childFlow=args[2],childFlowCount=1;var listenerName="_synthvolume_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.synthVolume[turtle][synth].pop(),0===that.justCounting[turtle].length&&0<that.synthVolume[turtle][synth].length&&(that.setSynthVolume(turtle,synth,last(that.synthVolume[turtle][synth])),that._playbackPush(turtle,[that.previousTurtleTime[turtle],"setsynthvolume",synth,last(that.synthVolume[turtle][synth])]))};that._setListener(turtle,listenerName,__listener);break;case"tone":break;case"tone2":_THIS_IS_TURTLE_BLOCKS_&&(void 0===that.turtleOscs[turtle]&&(that.turtleOscs[turtle]=new p5.TriOsc),osc=that.turtleOscs[turtle],osc.stop(),osc.start(),osc.amp(0),osc.freq(args[0]),osc.fade(.5,.2),setTimeout(function(t){t.fade(0,.2)},args[1],osc));break;case"hertz":if(null===args[0]||"number"!=typeof args[0]||args[0]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var arg=392}else var arg=args[0];var obj=frequencyToPitch(arg),note=obj[0],octave=obj[1],cents=obj[2],delta=0;if("?"===note)that.errorMsg(INVALIDPITCH,blk),that.stopTurtle=!0;else if(0<that.justMeasuring[turtle].length){var noteObj=getNote(note,octave,0,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg),n=that.justMeasuring[turtle].length,pitchNumber=pitchToNumber(noteObj[0],noteObj[1],that.keySignature[turtle])-that.pitchNumberOffset[turtle];that.firstPitch[turtle].length<n?that.firstPitch[turtle].push(pitchNumber):that.lastPitch[turtle].length<n&&that.lastPitch[turtle].push(pitchNumber)}else if(that.inMatrix)that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(arg);else if(that.inMusicKeyboard)that.musicKeyboard.noteNames.push("hertz"),that.musicKeyboard.octaves.push(arg);else if(0<that.inNoteBlock[turtle].length){var _addPitch2=function(e,i,s,l,o){var a=getNote(e,i,t=transposition+12*that.register[turtle],that.keySignature[turtle],that.moveable[turtle],o,that.errorMsg,that.synth.inTemperament);if(0<that.drumStyle[turtle].length){var n=last(that.drumStyle[turtle]);that.pitchDrumTable[turtle][a[0]+a[1]]=n}return that.notePitches[turtle][last(that.inNoteBlock[turtle])].push(a[0]),that.noteOctaves[turtle][last(that.inNoteBlock[turtle])].push(a[1]),that.noteCents[turtle][last(that.inNoteBlock[turtle])].push(s),that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(l),a};0!==that.invertList[turtle].length&&(delta+=that._calculateInvert(turtle,note,octave));var noteObj1=_addPitch2(note,octave,cents,arg);if(turtle in that.intervals&&0<that.intervals[turtle].length)for(var i=0;i<that.intervals[turtle].length;i++){var ii=getInterval(that.intervals[turtle][i],that.keySignature[turtle],noteObj1[0]),noteObj2=getNote(noteObj1[0],noteObj1[1],ii,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);_addPitch2(noteObj2[0],noteObj2[1],cents,0)}if(turtle in that.semitoneIntervals&&0<that.semitoneIntervals[turtle].length)for(var i=0;i<that.semitoneIntervals[turtle].length;i++){var noteObj2=getNote(noteObj1[0],noteObj1[1],that.semitoneIntervals[turtle][i][0],that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);_addPitch2(noteObj2[0],noteObj2[1],cents,0,that.semitoneIntervals[turtle][i][1])}that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])].push(that.beatFactor[turtle]),that.pushedNote[turtle]=!0}else if(that.inPitchStaircase){for(var frequency=arg,note=frequencyToPitch(arg),flag=0,i=0;i<that.pitchStaircase.Stairs.length;i++){if(that.pitchStaircase.Stairs[i][2]<parseFloat(frequency)){that.pitchStaircase.Stairs.splice(i,0,[note[0],note[1],parseFloat(frequency)]),flag=1;break}if(that.pitchStaircase.Stairs[i][2]===parseFloat(frequency)){that.pitchStaircase.Stairs.splice(i,1,[note[0],note[1],parseFloat(frequency)]),flag=1;break}}0===flag&&that.pitchStaircase.Stairs.push([note[0],note[1],parseFloat(frequency)]),that.pitchStaircase.stairPitchBlocks.push(blk)}else that.inPitchSlider?that.pitchSlider.Sliders.push([args[0],0,0]):that.errorMsg(_("Hertz Block: Did you mean to use a Note block?"),blk);break;case"triangle":case"sine":case"square":case"sawtooth":if(1===args.length){var obj=frequencyToPitch(args[0]);that.inMatrix?(that.pitchTimeMatrix.addRowBlock(blk),-1===that.pitchBlocks.indexOf(blk)&&that.pitchBlocks.push(blk),that.pitchTimeMatrix.rowLabels.push(that.blocks.blockList[blk].name),that.pitchTimeMatrix.rowArgs.push(args[0])):that.inPitchSlider?that.pitchSlider.Sliders.push([args[0],0,0]):(that.oscList[turtle][last(that.inNoteBlock[turtle])].push(that.blocks.blockList[blk].name),that.notePitches[turtle][last(that.inNoteBlock[turtle])].push(obj[0]),that.noteOctaves[turtle][last(that.inNoteBlock[turtle])].push(obj[1]),that.noteCents[turtle][last(that.inNoteBlock[turtle])].push(obj[2]),0!==obj[2]?that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(pitchToFrequency(obj[0],obj[1],obj[2],that.keySignature[turtle])):that.noteHertz[turtle][last(that.inNoteBlock[turtle])].push(0),that.noteBeatValues[turtle][last(that.inNoteBlock[turtle])].push(that.beatFactor[turtle]),that.pushedNote[turtle]=!0)}break;case"playfwd":that.pitchTimeMatrix.playDirection=1,that._runFromBlock(that,turtle,args[0]);break;case"playbwd":that.pitchTimeMatrix.playDirection=-1,that._runFromBlock(that,turtle,args[0]);break;case"stuplet":if(null===args[0]||"number"!=typeof args[0]||args[0]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var arg0=3}else var arg0=args[0];if(null===args[1]||"number"!=typeof args[1]||args[1]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var arg1=.5}else var arg1=args[1];var noteBeatValue=1/arg1*that.beatFactor[turtle];if(that.inMatrix||that.tuplet)if(that.pitchTimeMatrix.addColBlock(blk,arg0),that.tuplet)for(var i=0;i<arg0;i++)that.addingNotesToTuplet||(that.tupletRhythms.push(["notes",0]),that.addingNotesToTuplet=!0),that._processNote(noteBeatValue,blk,turtle);else{that.tupletParams.push([1,noteBeatValue]);for(var obj=["simple",0],i=0;i<arg0;i++)obj.push(1/arg1*that.beatFactor[turtle]);that.tupletRhythms.push(obj)}else{if(0<that.drumStyle[turtle].length?that.clearNoteParams(turtle,blk,that.drumStyle[turtle]):that.clearNoteParams(turtle,blk,[DEFAULTDRUM]),that.inNoteBlock[turtle].push(blk),0<that.bpm[turtle].length)var bpmFactor=TONEBPM/last(that.bpm[turtle]);else var bpmFactor=TONEBPM/that._masterBPM;var beatValue=bpmFactor/noteBeatValue/arg0;__rhythmPlayNote=function(t,e,i,s,l){setTimeout(function(){that._processNote(t,e,i,s)},l)};for(var i=0;i<arg0;i++)__callback=i===arg0-1?function(){delete that.noteDrums[turtle][blk];var t=that.inNoteBlock[turtle].indexOf(blk);that.inNoteBlock[turtle].splice(t,1)}:null,__rhythmPlayNote(noteBeatValue*arg0,blk,turtle,__callback,i*beatValue*1e3);that._doWait(turtle,(arg0-1)*beatValue)}break;case"tuplet2":case"tuplet3":that.inMatrix&&("tuplet3"===that.blocks.blockList[blk].name?that.tupletParams.push([args[0],1/args[1]*that.beatFactor[turtle]]):that.tupletParams.push([args[0],args[1]*that.beatFactor[turtle]]),that.tuplet=!0,that.addingNotesToTuplet=!1),childFlow=args[2],childFlowCount=1;var listenerName="_tuplet_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){that.inMatrix&&(that.tuplet=!1,that.addingNotesToTuplet=!1)};that._setListener(turtle,listenerName,__listener);break;case"tuplet4":if(void 0===args[1])break;if(null===args[0]||"number"!=typeof args[0]||args[0]<=0){that.errorMsg(NOINPUTERRORMSG,blk);var arg=.5}else var arg=args[0];that.inMatrix||(that.tupletRhythms=[],that.tupletParams=[]),that.tuplet=!0,that.addingNotesToTuplet=!1,that.tupletParams.push([1,1/arg*that.beatFactor[turtle]]),childFlow=args[1],childFlowCount=1;var listenerName="_tuplet_"+turtle;that._setDispatchBlock(blk,turtle,listenerName);var __listener=function(t){if(that.tuplet=!1,that.addingNotesToTuplet=!1,!that.inMatrix){for(var e=[],i=0;i<that.tupletRhythms.length;i++){var s=[that.tupletParams[that.tupletRhythms[i][1]]];s.push([]);for(var l=0,o=2;o<that.tupletRhythms[i].length;o++)l+=1/that.tupletRhythms[i][o],s[1].push(that.tupletRhythms[i][o]);var a=s[0][0]/(s[0][1]*l);for(o=2;o<that.tupletRhythms[i].length;o++)e.push(that.tupletRhythms[i][o]/a)}if(0<that.drumStyle[turtle].length?that.clearNoteParams(turtle,blk,that.drumStyle[turtle]):that.clearNoteParams(turtle,blk,[DEFAULTDRUM]),that.inNoteBlock[turtle].push(blk),0<that.bpm[turtle].length)var n=TONEBPM/last(that.bpm[turtle]);else n=TONEBPM/that._masterBPM;var r=0;__tupletPlayNote=function(t,e,i,s,l){setTimeout(function(){that._processNote(t,e,i,s)},l)};var c=0;for(i=0;i<e.length;i++){var h=e[i],u=n/h;i===e.length-1?__callback=function(){delete that.noteDrums[turtle][blk];var t=that.inNoteBlock[turtle].indexOf(blk);that.inNoteBlock[turtle].splice(t,1)}:__callback=null,__tupletPlayNote(h,blk,turtle,__callback,c),c+=1e3*u,r+=u}that._doWait(turtle,r-u)}};that._setListener(turtle,listenerName,__listener);break;case"deleteblock":if(args.length<1){that.errorMsg(NOINPUTERRORMSG,blk),that.stopTurtle=!0;break}if(args[0]<0||args[0]>that.blocks.blockList.length-1){that.errorMsg(NOINPUTERRORMSG,blk);break}if(that.blocks.blockList[args[0]].trash)break;var c=that.blocks.blockList[args[0]].connections[0];if(that.blocks.blockList[args[0]].connections[0]=null,null!==c)for(var i=0;i<that.blocks.blockList[c].connections.length;i++)that.blocks.blockList[c].connections[i]===args[0]&&(that.blocks.blockList[c].connections[i]=null);that.blocks.sendStackToTrash(that.blocks.blockList[args[0]]),that.blocks.adjustDocks(c,!0);break;case"moveblock":if(args.length<3){that.errorMsg(NOINPUTERRORMSG,blk);break}if(args[0]<0||args[0]>that.blocks.blockList.length-1){that.errorMsg(NOINPUTERRORMSG,blk);break}var x=that.turtles.turtleX2screenX(args[1]),y=that.turtles.turtleY2screenY(args[2]);that.blocks.moveBlock(args[0],x,y);break;case"runblock":if(args.length<1){that.errorMsg(NOINPUTERRORMSG,blk);break}if(args[0]<0||args[0]>that.blocks.blockList.length-1){that.errorMsg(NOINPUTERRORMSG,blk);break}if("start"===that.blocks.blockList[args[0]].name){var thisTurtle=that.blocks.blockList[args[0]].value;console.log("run start "+thisTurtle),that.initTurtle(thisTurtle),that.turtles.turtleList[thisTurtle].queue=[],that.parentFlowQueue[thisTurtle]=[],that.unhighlightQueue[thisTurtle]=[],that.parameterQueue[thisTurtle]=[],that.turtles.turtleList[thisTurtle].running=!0,that._runFromBlock(that,thisTurtle,args[0],0,receivedArg)}else childFlow=args[0],childFlowCount=1;break;case"dockblock":if(args.length<3){console.log(args.length+" < 3"),that.errorMsg(NOINPUTERRORMSG,blk);break}if(args[0]<0||args[0]>that.blocks.blockList.length-1){console.log(args[0]+" > "+that.blocks.blockList.length-1),that.errorMsg(NOINPUTERRORMSG,blk);break}if(args[0]===args[2]){console.log(args[0]+" == "+args[2]),that.errorMsg(NOINPUTERRORMSG,blk);break}if(args[2]<0||args[2]>that.blocks.blockList.length-1){console.log(args[2]+" > "+that.blocks.blockList.length-1),that.errorMsg(NOINPUTERRORMSG,blk);break}if(-1===args[1])args[1]=that.blocks.blockList[args[0]].connections.length-1;else if(args[1]<1||args[1]>that.blocks.blockList[args[0]].connections.length-1){console.log(args[1]+" out of bounds"),that.errorMsg(NOINPUTERRORMSG,blk);break}var c=that.blocks.blockList[args[0]].connections[args[1]];if(null!==c)if("hidden"===that.blocks.blockList[c].name)args[0]=c,args[1]=1;else{for(var i=0;i<that.blocks.blockList[c].connections.length;i++)if(that.blocks.blockList[c].connections[i]===args[0]){that.blocks.blockList[c].connections[i]=null;break}that.blocks.blockList[args[0]].connections[args][1]=null}that.blocks.blockList[args[0]].connections[args[1]]=args[2],that.blocks.blockList[args[2]].connections[0]=args[0],that.blocks.adjustDocks(args[0],!0);break;case"openpalette":if(args.length<1){that.errorMsg(NOINPUTERRORMSG,blk);break}for(var p in that.blocks.palettes.dict)if(_(that.blocks.palettes.dict[p].name)===args[0].toLowerCase()){that.blocks.palettes.hide(),that.blocks.palettes.dict[p].show(),that.blocks.palettes.show();break}break;case"setxyturtle":var targetTurtle=that._getTargetTurtle(args[0]);null===targetTurtle?_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+args[0],blk):that.errorMsg(_("Cannot find turtle")+" "+args[0],blk):3===args.length&&("string"==typeof args[1]||"string"==typeof args[2]?(that.errorMsg(NANERRORMSG,blk),that.stopTurtle=!0):that.turtles.turtleList[targetTurtle].doSetXY(args[1],args[2]));break;default:that.blocks.blockList[blk].name in that.evalFlowDict?eval(that.evalFlowDict[that.blocks.blockList[blk].name]):(that.blocks.blockList[blk].isArgBlock()||-1!==["anyout","numberout","textout"].indexOf(that.blocks.blockList[blk].protoblock.dockTypes[0])?(args.push(that.parseArg(that,turtle,blk,that.receievedArg)),null==that.blocks.blockList[blk].value?that.textMsg("null block value"):that.textMsg(that.blocks.blockList[blk].value.toString())):that.errorMsg("I do not know how to "+that.blocks.blockList[blk].name+".",blk),that.stopTurtle=!0)}if(blk!==that.ignoringBlock){if(blk in that.endOfClampSignals[turtle])for(var n=that.endOfClampSignals[turtle][blk].length,i=0;i<n;i++){var signal=that.endOfClampSignals[turtle][blk].pop();null!=signal&&that.stage.dispatchEvent(signal)}}else console.log("Ignoring block on overlapped start.");if("visible"===docById("statusDiv").style.visibility&&(that.inStatusMatrix||that.statusMatrix.updateAll()),null!=childFlow){if("doArg"===that.blocks.blockList[blk].name||"nameddoArg"===that.blocks.blockList[blk].name)var queueBlock=new Queue(childFlow,childFlowCount,blk,actionArgs);else var queueBlock=new Queue(childFlow,childFlowCount,blk,receivedArg);null!=that.parentFlowQueue[turtle]?(that.parentFlowQueue[turtle].push(blk),that.turtles.turtleList[turtle].queue.push(queueBlock)):console.log("cannot find queue for turtle "+turtle)}var nextBlock=null,parentBlk=null,qV;if(that.turtles.turtleList[turtle].queue.length>queueStart&&(nextBlock=last(that.turtles.turtleList[turtle].queue).blk,parentBlk=last(that.turtles.turtleList[turtle].queue).parentBlk,passArg=last(that.turtles.turtleList[turtle].queue).args,1===last(that.turtles.turtleList[turtle].queue).count?that.turtles.turtleList[turtle].queue.pop():last(that.turtles.turtleList[turtle].queue).count-=1),null!=nextBlock){if(parentBlk!==blk&&(that.turtleDelay===TURTLESTEP?that.unhighlightStepQueue[turtle]=blk:that.suppressOutput[turtle]||0!==that.justCounting[turtle].length||setTimeout(function(){that.blocks.visible&&that.blocks.unhighlight(blk)},that.turtleDelay+that.waitTimes[turtle])),(0<that.backward[turtle].length&&null==that.blocks.blockList[blk].connections[0]||0===that.backward[turtle].length&&null==last(that.blocks.blockList[blk].connections))&&(that.suppressOutput[turtle]||0!==that.justCounting[turtle].length||(void 0===that.unhighlightQueue[turtle]?console.log("cannot find highlight queue for turtle "+turtle):0<that.parentFlowQueue[turtle].length&&0<that.turtles.turtleList[turtle].queue.length&&last(that.turtles.turtleList[turtle].queue).parentBlk!==last(that.parentFlowQueue[turtle])?that.unhighlightQueue[turtle].push(last(that.parentFlowQueue[turtle])):0<that.unhighlightQueue[turtle].length&&setTimeout(function(){!turtle in that.unhighlightQueue?console.log("turtle "+turtle+" not found in unhighlightQueue"):that.blocks.visible?that.blocks.unhighlight(that.unhighlightQueue[turtle].pop()):that.unhighlightQueue[turtle].pop()},that.turtleDelay))),0!==that.turtleDelay)for(var pblk in that.parameterQueue[turtle])that._updateParameterBlock(that,turtle,that.parameterQueue[turtle][pblk]);isflow?that._runFromBlockNow(that,turtle,nextBlock,isflow,passArg,queueStart):that._runFromBlock(that,turtle,nextBlock,isflow,passArg)}else{if(that.alreadyRunning=!1,!that.prematureRestart){for(var b in that.endOfClampSignals[turtle])for(var i=0;i<that.endOfClampSignals[turtle][b].length;i++)null!=that.endOfClampSignals[turtle][b][i]&&(null!=that.butNotThese[turtle][b]&&-1!==that.butNotThese[turtle][b].indexOf(i)||that.stage.dispatchEvent(that.endOfClampSignals[turtle][b][i]));that.turtles.turtleList[turtle].closeSVG(),that.turtles.turtleList[turtle].running=!1,that.turtles.running()||0!==queueStart||that.onStopTurtle()}if(__checkCompletionState=(qV=function(){if(that.turtles.running()||0!==queueStart||0!==that.justCounting[turtle].length)that.suppressOutput[turtle]&&setTimeout(function(){__checkCompletionState()},250);else{if(that.runningLilypond)console.log("saving lilypond output:"),save.afterSaveLilypond(),that.runningLilypond=!1;else if(that.runningAbc)console.log("saving abc output:"),save.afterSaveAbc(),that.runningAbc=!1;else if(that.suppressOutput[turtle])for(t in console.log("finishing compiling"),that.recording||that.errorMsg(_("Playback is ready.")),that.setPlaybackStatus(),that.compiling=!1,that.turtles.turtleList)that.turtles.turtleList[t].doPenUp(),that.turtles.turtleList[t].doSetXY(that._saveX[t],that._saveY[t]),that.turtles.turtleList[t].color=that._saveColor[t],that.turtles.turtleList[t].value=that._saveValue[t],that.turtles.turtleList[t].chroma=that._saveChroma[t],that.turtles.turtleList[t].stroke=that._saveStroke[t],that.turtles.turtleList[t].canvasAlpha=that._saveCanvasAlpha[t],that.turtles.turtleList[t].doSetHeading(that._saveOrientation[t]),that.turtles.turtleList[t].penState=that._savePenState[t];console.log("SETTING LAST NOTE TIMEOUT: "+that.recording+" "+that.suppressOutput[turtle]),that.lastNoteTimeout=setTimeout(function(){console.log("LAST NOTE PLAYED"),that.lastNoteTimeout=null,that.suppressOutput[turtle]&&that.recording?(that.suppressOutput[turtle]=!1,that.checkingCompletionState=!1,that.saveLocally(),console.log("PLAYBACK FOR RECORD"),that.playback(-1,!0)):(that.suppressOutput[turtle]=!1,that.checkingCompletionState=!1,document.body.style.cursor="default",that.saveLocally())},1e3)}},rV.toString=function(){return qV.toString()},rV),that.turtles.running()||0!==queueStart||0!==that.justCounting[turtle].length||that.checkingCompletionState||(that.checkingCompletionState=!0,setTimeout(function(){__checkCompletionState()},250)),!that.suppressOutput[turtle]&&0===that.justCounting[turtle].length){for(var b in 0!==that.turtles.turtleList[turtle].queue.length&&blk===last(that.turtles.turtleList[turtle].queue).parentBlk||setTimeout(function(){that.blocks.visible&&that.blocks.unhighlight(blk)},that.turtleDelay),that.parentFlowQueue[turtle])that.blocks.visible&&that.blocks.unhighlight(that.parentFlowQueue[turtle][b]);var i=that.stage.children.length-1;that.stage.setChildIndex(that.turtles.turtleList[turtle].container,i),that.refreshCanvas()}for(var arg in that.evalOnStopList)eval(that.evalOnStopList[arg]);that.turtles.running()||0!==queueStart||(that.showBlocksAfterRun&&(null!==blk&&null!==that.blocks.blockList[blk].connections[0]&&"status"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?console.log("running status block"):(that.showBlocks(),that.showBlocksAfterRun=!1)),document.getElementById("stop").style.color="white",console.log("fin"))}function rV(){return qV.apply(this,arguments)}},this._setMasterVolume=function(t){100<t?t=100:t<0&&(t=0),_THIS_IS_MUSIC_BLOCKS_&&this.synth.setMasterVolume(t)},this.setSynthVolume=function(t,e,i){if(100<i?i=100:i<0&&(i=0),_THIS_IS_MUSIC_BLOCKS_)switch(e){case"noise1":case"noise2":case"noise3":this.synth.setVolume(t,e,i/25);break;default:this.synth.setVolume(t,e,i)}},this._processNote=function(N,P,I,t){if(0<this.bpm[I].length)var M=TONEBPM/last(this.bpm[I]);else M=TONEBPM/this._masterBPM;if("osctime"===this.blocks.blockList[P].name)if(0==N)var E=0;else E=1e3*M/N;else E=N;var O=0,D=0,R=0,W=0,H=0,F=0,V=0,U=0,G=0,z=0,q=0,Y=0,X=[],K=[],Q=[],Z=0,J=0,$=!1,tt=!1,et=!1,it=!1,st=!1,lt=!1,ot=null;if(this.inSetTimbre[I]&&I in this.instrumentNames&&last(this.instrumentNames[I])){var e=last(this.instrumentNames[I]);if(e in instrumentsEffects[I]){var i=instrumentsEffects[I][e];i.vibratoActive&&(O=i.vibratoRate,R=i.vibratoIntensity,$=!0),i.distortionActive&&(W=i.distortionAmount,tt=!0),i.tremoloActive&&(H=i.tremoloFrequency,F=i.tremoloDepth,et=!0),i.phaserActive&&(V=i.rate,U=i.octaves,G=i.baseFrequency,it=!0),i.chorusActive&&(z=i.chorusRate,q=i.delayTime,Y=i.chorusDepth,st=!0)}e in instrumentsFilters[I]&&(ot=instrumentsFilters[I][e])}if(0<this.vibratoRate[I].length&&(O=last(this.vibratoRate[I]),R=last(this.vibratoIntensity[I]),$=!0),0<this.distortionAmount[I].length&&(W=last(this.distortionAmount[I]),tt=!0),0<this.tremoloDepth[I].length&&(H=last(this.tremoloFrequency[I]),F=last(this.tremoloDepth[I]),et=!0),0<this.rate[I].length&&(V=last(this.rate[I]),U=last(this.octaves[I]),G=last(this.baseFrequency[I]),it=!0),0<this.chorusRate[I].length&&(z=last(this.chorusRate[I]),q=last(this.delayTime[I]),Y=last(this.chorusDepth[I]),st=!0),X=[1],0<this.inHarmonic[I].length&&(0===X.length?this.errorMsg(_("You must have at least one Partial block inside of a Weighted-partial block")):X=last(this.partials[I])),0<this.inNeighbor[I].length){for(var s=this.neighborArgNote1[I].length,l=0;l<s;l++)K.push(this.neighborArgNote1[I].pop()),Q.push(this.neighborArgNote2[I].pop());Z=M/last(this.neighborArgBeat[I]),J=M/last(this.neighborArgCurrentBeat[I]),lt=!0}var at=0;if(0<this.inCrescendo[I].length&&0===this.crescendoDelta[I].length)for(var o in this.inCrescendo[I].pop(),this.synthVolume[I])this.setSynthVolume(I,"electronic synth",last(this.synthVolume[I][o])),this._playbackPush(I,[this.previousTurtleTime[I],"setsynthvolume",o,last(this.synthVolume[I][o])]);else if(0<this.crescendoDelta[I].length)for(var o in last(this.synthVolume[I]["electronic synth"])===last(this.crescendoInitialVolume[I]["electronic synth"])&&0===this.justCounting[I].length&&this.notationBeginCrescendo(I,last(this.crescendoDelta[I])),this.synthVolume[I]){s=this.synthVolume[I][o].length;this.synthVolume[I][o][s-1]+=last(this.crescendoDelta[I]),console.log(o+"= "+this.synthVolume[I][o][s-1]),this._playbackPush(I,[this.previousTurtleTime[I],"setsynthvolume",o,last(this.synthVolume[I][o])]),this.suppressOutput[I]||this.setSynthVolume(I,o,last(this.synthVolume[I][o]))}if(this.inTimbre){var a=getNote(this.notePitches[I][last(this.inNoteBlock[I])][0],this.noteOctaves[I][last(this.inNoteBlock[I])][0],0,this.keySignature[I],this.moveable[I],null,this.errorMsg);this.timbre.notesToPlay.push([a[0]+a[1],1/E]),this.previousNotePlayed[I]=this.lastNotePlayed[I],this.lastNotePlayed[I]=[a[0]+a[1],E]}else if(this.inMatrix||this.tuplet){if(0<this.inNoteBlock[I].length){this.pitchTimeMatrix.addColBlock(P,1);for(l=0;l<this.pitchBlocks.length;l++)this.pitchTimeMatrix.addNode(this.pitchBlocks[l],P,0);for(l=0;l<this.drumBlocks.length;l++)this.pitchTimeMatrix.addNode(this.drumBlocks[l],P,0)}if(E*=this.beatFactor[I],this.tuplet)if(this.addingNotesToTuplet){l=this.tupletRhythms.length-1;this.tupletRhythms[l].push(E)}else this.tupletRhythms.push(["notes",this.tupletParams.length-1,E]),this.addingNotesToTuplet=!0;else this.tupletRhythms.push(["",1,E])}else{if(null==this.firstNoteTime){var n=new Date;this.firstNoteTime=n.getTime()}var r=((n=new Date).getTime()-this.firstNoteTime)/1e3;if(0===this.drift[I])var c=Math.max(r-this.turtleTime[I],0);else c=0;if(this.tie[I])var nt=this.tieCarryOver[I];else nt=0;if(this.tie[I]){var h=last(this.inNoteBlock[I]);if(0<this.tieCarryOver[I]){var u=!0;if(this.tieNotePitches[I].length!==this.notePitches[I][last(this.inNoteBlock[I])].length)u=!1;else for(l=0;l<this.tieNotePitches[I].length;l++){if(this.tieNotePitches[I][l][0]!=this.notePitches[I][last(this.inNoteBlock[I])][l]){u=!1;break}if(this.tieNotePitches[I][l][1]!=this.noteOctaves[I][last(this.inNoteBlock[I])][l]){u=!1;break}}if(!u){this.errorMsg(_("You can only tie notes of the same pitch. Did you mean to use slur?"),h);var d,f=[];for(l=0;l<this.notePitches[I][last(this.inNoteBlock[I])].length;l++)f.push([this.notePitches[I][h][l],this.noteOctaves[I][h][l],this.noteCents[I][h][l],this.noteHertz[I][h][l],h]);d=[h,this.oscList[I][h],this.noteBeat[I][h],this.noteBeatValues[I][h],this.noteDrums[I][h],this.embeddedGraphics[I][h]],h=this.tieNoteExtras[I][0],this.inNoteBlock[I].push(h),this.notePitches[I][h]=[],this.noteOctaves[I][h]=[],this.noteCents[I][h]=[],this.noteHertz[I][h]=[];for(l=0;l<this.tieNotePitches[I].length;l++)this.notePitches[I][h].push(this.tieNotePitches[I][l][0]),this.noteOctaves[I][h].push(this.tieNotePitches[I][l][1]),this.noteCents[I][h].push(this.tieNotePitches[I][l][2]),this.noteHertz[I][h].push(this.tieNotePitches[I][l][3]);if(this.oscList[I][h]=this.tieNoteExtras[I][1],this.noteBeat[I][h]=this.tieNoteExtras[I][2],this.noteBeatValues[I][h]=this.tieNoteExtras[I][3],this.noteDrums[I][h]=this.tieNoteExtras[I][4],this.embeddedGraphics[I][h]=this.tieNoteExtras[I][5],0===this.justCounting[I].length)for(l=0;l<this.notePitches[I][h].length;l++)this.notationRemoveTie(I);this.tie[I]=!1,nt=0,this._processNote(this.tieCarryOver[I],h,I),this.inNoteBlock[I].pop(),this.suppressOutput[I]||this._doWait(I,Math.max(M/this.tieCarryOver[I]+this.noteDelay/1e3-c,0)),nt=this.tieCarryOver[I],this.tieCarryOver[I]=0,this.tie[I]=!0,h=d[0],this.notePitches[I][h]=[],this.noteOctaves[I][h]=[],this.noteCents[I][h]=[],this.noteHertz[I][h]=[];for(l=0;l<f.length;l++)this.notePitches[I][h].push(f[l][0]),this.noteOctaves[I][h].push(f[l][1]),this.noteCents[I][h].push(f[l][2]),this.noteHertz[I][h].push(f[l][3]);this.oscList[I][h]=d[1],this.noteBeat[I][h]=d[2],this.noteBeatValues[I][h]=d[3],this.noteDrums[I][h]=d[4],this.embeddedGraphics[I][h]=d[5]}}if(0===this.tieCarryOver[I]){this.tieNotePitches[I]=[],this.tieCarryOver[I]=E;for(l=0;l<this.notePitches[I][h].length;l++)this.tieNotePitches[I].push([this.notePitches[I][h][l],this.noteOctaves[I][h][l],this.noteCents[I][h][l],this.noteHertz[I][h][l]]);this.tieNoteExtras[I]=[h,this.oscList[I][h],this.noteBeat[I][h],this.noteBeatValues[I][h],this.noteDrums[I][h],[]],this.tieFirstDrums[I]=this.noteDrums[I][h],E=0}else at=this.tieCarryOver[I],E=1/(1/E+1/this.tieCarryOver[I]),this.tieCarryOver[I]=0}if(0<this.swing[I].length){null==last(this.swingTarget[I])&&(this.swingTarget[I][this.swingTarget[I].length-1]=E);var p=last(this.swing[I]);E===last(this.swingTarget[I])&&(0===this.swingCarryOver[I]?(E=1/(1/E+1/p),this.swingCarryOver[I]=p):(E=E===p?0:1/(1/E-1/p),this.swingCarryOver[I]=0),E<0&&(E=0))}var rt=E;0<rt&&(this.previousTurtleTime[I]=this.turtleTime[I],1===this.inNoteBlock[I].length&&(this.turtleTime[I]+=M/rt+this.noteDelay/1e3,this.suppressOutput[I]||this._doWait(I,Math.max(M/rt+this.noteDelay/1e3-c,0))));var ct=!1;1<this.skipFactor[I]&&(0<this.skipIndex[I]%this.skipFactor[I]&&(ct=!0),this.skipIndex[I]+=1);var ht=[],ut=[],dt=this;__playnote=function(){var t=last(dt.inNoteBlock[I]);if(void 0!==dt.notePitches[I][t]){if(1<dt.notePitches[I][t].length)for(;-1!==dt.notePitches[I][t].indexOf("rest");)dt.notePitches[I][t].splice(dt.notePitches[I][t].indexOf("rest"),1);if(0===dt.notePitches[I][t].length&&dt.notePitches[I][dt.inNoteBlock[I][dt.inNoteBlock[I].length-1]].push("rest"),!dt.stopTurtle){dt.inNoteBlock[I].length===dt.whichNoteToCount[I]&&(dt.notesPlayed[I]=rationalSum(dt.notesPlayed[I],[1,N]));var e=[],i=[];if(1<dt.notePitches[I][t].length+dt.oscList[I][t].length)if(I in dt.notationStaging&&0===dt.justCounting[I].length)dt.notationStaging[I].length;else;if(dt.noteBeat[I][P]=E,isFinite(rt)){if(0<dt.glide[I].length)var s=last(dt.glide[I]);else s=0;if(0<dt.staccato[I].length){var l=last(dt.staccato[I]);if(l<0)var o=M*(1/E-1/l);else if(E<l)o=M/l;else o=M/E}else o=M/E;$&&(D=o*(rt/O));for(var a=[],n=0;n<dt.notePitches[I][t].length;n++){var r=dt.notePitches[I][t][n],c=!1;if(1===r.length)for(j=0;j<dt.notePitches[I][t].length;j++)n!==j&&dt.noteOctaves[I][t][n]===dt.noteOctaves[I][t][j]&&(r+""!==dt.notePitches[I][t][j]&&r+""!==dt.notePitches[I][t][j]||(c=!0));a.push(c)}if(0<dt.notePitches[I][t].length){for(n=0;n<dt.notePitches[I][t].length;n++){if("rest"===dt.notePitches[I][t][n]||ct)u="R",dt.previousNotePlayed[I]=dt.lastNotePlayed[I];else{var h=getNote(dt.notePitches[I][t][n],dt.noteOctaves[I][t][n],0,dt.keySignature[I],dt.moveable[I],null,dt.errorMsg,dt.synth.inTemperament);if(0!==dt.noteCents[I][t][n])if(0!==dt.noteHertz[I][t][n])var u=dt.noteHertz[I][t][n];else u=Math.floor(pitchToFrequency(h[0],h[1],dt.noteCents[I][t][n],dt.keySignature[I]));else u=h[0]+h[1]}if("R"!==u){var d=X.indexOf(1);0<d&&(u=noteToFrequency(u,dt.keySignature[I])*(d+1)),e.push(u)}if(0<rt){if(0<at){0===n&&0===dt.justCounting[I].length&&dt.notationInsertTie(I)}else;0===dt.justCounting[I].length&&(0<dt.noteDrums[I][t].length?(-1===ht.indexOf(u)&&ht.push(u),-1===ut.indexOf(dt.noteDrums[I][t][0])&&ut.push(dt.noteDrums[I][t][0])):a[n]?-1===ht.indexOf(u+"")&&ht.push(u+""):-1===ht.indexOf(u)&&ht.push(u))}else 0<dt.tieCarryOver[I]&&0===dt.justCounting[I].length&&(a[n],-1===ht.indexOf(u)&&ht.push(u));if(n===dt.notePitches[I][t].length-1){if(0<rt)if(0<at)var f=1/(1/rt-1/at);else f=rt;else if(0<dt.tieCarryOver[I])f=dt.tieCarryOver[I];dt.runningLilypond&&dt.updateNotation(ht,f,I,-1,ut)}}if("custom"===dt.synth.inTemperament)var p=dt.synth.getCustomFrequency(e);else p=dt.synth.getFrequency(e,dt.synth.changeInTemperament);for(var b=dt.synth.startingPitch,m=pitchToFrequency(b.substring(0,b.length-1),Number(b.slice(-1)),0,null),g=TEMPERAMENT[dt.synth.inTemperament].pitchNumber,k=[],v=[],y=[],T=[],L=0;L<p.length;L++)void 0!==p[L]&&(k[L]=p[L]/m,v[L]=g*(Math.log10(k[L])/Math.log10(OCTAVERATIO)),v[L]=v[L].toFixed(0),y[L]=rationalToFraction(k[L])[0],T[L]=rationalToFraction(k[L])[1]);if(0<(B=rationalToFraction(1/E))[0]&&(0===dt.justCounting[I].length?0===e.length?console.log("notes to play: R "+B[0]+"/"+B[1]):console.log("notes to play: "+e+" "+B[0]+"/"+B[1]):0===e.length?console.log("notes to count: R "+B[0]+"/"+B[1]):console.log("notes to count: "+e+" "+B[0]+"/"+B[1])),!dt.suppressOutput[I]&&dt.blinkState&&dt.turtles.turtleList[I].blink(rt,last(dt.masterVolume)),0<e.length){var w=e[0].length;if("number"==typeof e[0]){var B=frequencyToPitch(e[0]);dt.currentOctave[I]=B[1]}else dt.currentOctave[I]=parseInt(e[0].slice(w-1));if(dt.currentCalculatedOctave[I]=dt.currentOctave[I],dt.turtles.turtleList[I].drum)for(n=0;n<e.length;n++)e[n]=e[n].replace(//g,"b").replace(//g,"#");else for(n=0;n<e.length;n++)"string"==typeof e[n]&&(e[n]=e[n].replace(//g,"b").replace(//g,"#"));if(0<rt){var x=function(t){return t.doVibrato||t.doDistortion||t.doTremolo||t.doPhaser||t.Chorus||1!==t.partials.length||1!==t.partials[1]?t:null};if(_THIS_IS_MUSIC_BLOCKS_&&!ct){var S={doVibrato:$,doDistortion:tt,doTremolo:et,doPhaser:it,doChorus:st,doPartials:!0,doPortamento:!0,doNeighbor:lt,vibratoIntensity:R,vibratoFrequency:D,distortionAmount:W,tremoloFrequency:H,tremoloDepth:F,rate:V,octaves:U,baseFrequency:G,chorusRate:z,delayTime:q,chorusDepth:Y,partials:X,portamento:s,neighborArgNote1:K,neighborArgNote2:Q,neighborArgBeat:Z,neighborArgCurrentBeat:J};if(0<dt.oscList[I][t].length)1<e.length&&dt.errorMsg(last(dt.oscList[I][t])+": "+_("synth cannot play chords."),P),dt.suppressOutput[I]||dt.synth.trigger(I,e,o,last(dt.oscList[I][t]),S,null,!1),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",e,o,last(dt.oscList[I][t]),x(S),null]);else if(0<dt.drumStyle[I].length)dt.suppressOutput[I]||dt.synth.trigger(I,e,o,last(dt.drumStyle[I]),null,null,!1),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",e,o,dt.drumStyle[I],null,null]);else if(dt.turtles.turtleList[I].drum)dt.suppressOutput[I]||dt.synth.trigger(I,e,o,"drum",null,null,!1),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",e,o,"drum",null,null]);else for(f=0;f<e.length;f++)if(e[f]in dt.pitchDrumTable[I])dt.suppressOutput[I]||(console.log(dt.glide[I].length),dt.synth.trigger(I,e[f],o,dt.pitchDrumTable[I][e[f]],null,null,!1)),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",e[f],o,dt.pitchDrumTable[I][e[f]],null,null]);else if(I in dt.instrumentNames&&last(dt.instrumentNames[I])){if(!dt.suppressOutput[I])if(0<dt.glide[I].length)if(0===dt.glideOverride[I])console.log("glide note "+o),dt.synth.trigger(I,e[f],o,last(dt.instrumentNames[I]),S,ot,!0);else{var C=M/dt.glideOverride[I];console.log("first glide note: "+dt.glideOverride[I]+" "+C),dt.synth.trigger(I,e[f],C,last(dt.instrumentNames[I]),S,ot,!1),dt.glideOverride[I]=0}else dt.synth.trigger(I,e[f],o,last(dt.instrumentNames[I]),S,ot,!1);0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",e[f],o,last(dt.instrumentNames[I]),x(S),ot])}else I in dt.voices&&last(dt.voices[I])?(dt.suppressOutput[I]||(console.log(dt.glide[I].length),dt.synth.trigger(I,e[f],o,last(dt.voices[I]),S,null,!1)),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",e[f],o,last(dt.voices[I]),x(S),null])):(dt.suppressOutput[I]||dt.synth.trigger(I,e[f],o,"electronic synth",S,null,!1),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",e[f],o,"electronic synth",x(S),null]))}}dt.previousNotePlayed[I]=dt.lastNotePlayed[I],dt.lastNotePlayed[I]=[e[0],E],dt.noteStatus[I]=[e,E],dt.lastPitchPlayed[I]=dt.lastNotePlayed[I]}}if(0<dt.noteDrums[I][t].length){for(n=0;n<dt.noteDrums[I][t].length;n++)i.push(dt.noteDrums[I][t][n]);for(n=0;n<dt.tieFirstDrums[I].length;n++)-1===i.indexOf(dt.tieFirstDrums[I][n])&&i.push(dt.tieFirstDrums[I][n]);if(0===dt.notePitches[I][t].length)0<(B=rationalToFraction(1/E))[0]&&(0===dt.justCounting[I].length?console.log("drums to play "+e+" "+B[0]+"/"+B[1]):console.log("drums to count "+e+" "+B[0]+"/"+B[1])),!dt.suppressOutput[I]&&dt.blinkState&&dt.turtles.turtleList[I].blink(rt,last(dt.masterVolume));if(dt.tie[I]&&0<dt.tieCarryOver[I]||0<rt){if(dt.tie[I]&&0===E)var A=0;else{A=o;0<nt&&(dt.tieFirstDrums[I]=[])}if(0<A&&_THIS_IS_MUSIC_BLOCKS_&&!ct)for(n=0;n<i.length;n++)0<dt.drumStyle[I].length?(dt.suppressOutput[I]||dt.synth.trigger(I,["C2"],A,last(dt.drumStyle[I]),null,null,!1),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",["C2"],A,last(dt.drumStyle[I]),null,null])):(dt.suppressOutput[I]||dt.synth.trigger(I,["C2"],A,i[n],null,null,!1),0===dt.justCounting[I].length&&dt._playbackPush(I,[dt.previousTurtleTime[I],"notes",["C2"],A,i[n],null,null]))}}dt.suppressOutput[I]||_THIS_IS_MUSIC_BLOCKS_&&!ct&&dt.synth.start(),dt.tie[I]&&0===E?0<nt?dt._dispatchTurtleSignals(I,M/dt.tieCarryOver[I],P,M/nt):dt._dispatchTurtleSignals(I,M/dt.tieCarryOver[I],P,0):0<nt?dt._dispatchTurtleSignals(I,o-M/nt,P,M/nt):dt._dispatchTurtleSignals(I,o,P,0),dt.embeddedGraphics[I][P]=[],setTimeout(function(){dt.blocks.visible&&dt.blocks.unhighlight(P)},1e3*o)}}}else console.log("no note found")},null!=last(dt.inNoteBlock[I])&&(0!==this.noteDelay&&this.suppressOutput[I]?setTimeout(function(){__playnote()},this.noteDelay):__playnote())}this.pushedNote[I]=!1,null!=t&&t()},this._playbackPush=function(t,e){this.recordingStatus()&&_THIS_IS_MUSIC_BLOCKS_&&!this.optimize&&this.playbackQueue[t].push(e)},this.playback=function(e,o){var a=this;if(this.restartPlayback&&(this.progressBarWidth=0),void 0===o&&(o=!1),(this.recording=o)&&(this.playbackTime=0),this.turtles.running())return console.log(this.turtles.running()+" PUNTING"),0===this.playbackTime?void 0:void(this.stopTurtle=!0);if(0===this.playbackTime){var n=!1,r=!1;this.hideBlocks(),this.showBlocksAfterRun=!0}if(0<this.turtles.turtleList.length)for(t in this.turtles.turtleList)if(t in this.playbackQueue){for(var i=[],s=0;s<this.playbackQueue[t].length;s++)i.push([s,this.playbackQueue[t][s]]);i.sort(function(t,e){return t[1][0]===e[1][0]?t[0]-e[0]:t[1][0]-e[1][0]})}console.log(i.length);var l=new Date;this.firstNoteTime=l.getTime()-1e3*this.playbackTime;var c=0;for(var h in 100<=this.progressBarWidth&&(this.progressBarWidth=0),this.playbackQueue)c+=this.playbackQueue[h].length;t in this.playbackQueue&&0<c?this.progressBarDivision=100/this.playbackQueue[t].length:this.progressBarDivision=100;var u,d=0,f=0;function p(t,e){return u.apply(this,arguments)}if(__playbackLoop=(u=function(t,e){if(f++,a.playbackTime=a.playbackQueue[t][e][0],0===d&&(d=1),a.progressBarWidth=a.progressBarWidth+a.progressBarDivision/d,(f===c||100<a.progressBarWidth)&&(a.progressBarWidth=100),NaN===a.progressBarWidth&&(a.progressBar.style.visibility="hidden"),a.progressBar.style.width=a.progressBarWidth+"%",a.progressBar.innerHTML=parseInt(1*a.progressBarWidth)+"%",a.stopTurtle)a.turtles.turtleList[t].running=!1,a.showBlocks(),a.showBlocksAfterRun=!1;else{switch(a.playbackQueue[t][e][1]){case"fill":n=n?(a.turtles.turtleList[t].doEndFill(),!1):(a.turtles.turtleList[t].doStartFill(),!0);break;case"hollowline":r=r?(a.turtles.turtleList[t].doEndHollowLine(),!1):(a.turtles.turtleList[t].doStartHollowLine(),!0);break;case"notes":_THIS_IS_MUSIC_BLOCKS_&&(a.blinkState&&a.turtles.turtleList[t].blink(a.playbackQueue[t][e][3],50),a.lastNote[t]=a.playbackQueue[t][e][3],a.synth.trigger(t,a.playbackQueue[t][e][2],a.playbackQueue[t][e][3],a.playbackQueue[t][e][4],a.playbackQueue[t][e][5],a.playbackQueue[t][e][6]));break;case"controlpoint1":a.cp1x[t]=a.playbackQueue[t][e][2],a.cp1y[t]=a.playbackQueue[t][e][3];break;case"controlpoint2":a.cp2x[t]=a.playbackQueue[t][e][2],a.cp2y[t]=a.playbackQueue[t][e][3];break;case"bezier":a.turtles.turtleList[t].doBezier(a.cp1x[t],a.cp1y[t],a.cp2x[t],a.cp2y[t],a.playbackQueue[t][e][2],a.playbackQueue[t][e][3]);break;case"show":a._processShow(t,null,a.playbackQueue[t][e][2],a.playbackQueue[t][e][3]);break;case"speak":a._processSpeak(a.playbackQueue[t][e][2]);break;case"print":a.textMsg(a.playbackQueue[t][e][2].toString());break;case"setvolume":a._setMasterVolume(a.playbackQueue[t][e][2]);break;case"setsynthvolume":a.setSynthVolume(t,a.playbackQueue[t][e][2],a.playbackQueue[t][e][3]);break;case"arc":a.turtles.turtleList[t].doArc(a.playbackQueue[t][e][2],a.playbackQueue[t][e][3]);break;case"setxy":case"scrollxy":a.turtles.turtleList[t].doSetXY(a.playbackQueue[t][e][2],a.playbackQueue[t][e][3]);break;case"forward":a.turtles.turtleList[t].doForward(a.playbackQueue[t][e][2]);break;case"right":a.turtles.turtleList[t].doRight(a.playbackQueue[t][e][2]);break;case"setheading":a.turtles.turtleList[t].doSetHeading(a.playbackQueue[t][e][2]);break;case"clear":a.svgBackground=!0,a.turtles.turtleList[t].penState=!1,a.turtles.turtleList[t].doSetHeading(0),a.turtles.turtleList[t].doSetXY(0,0),a.turtles.turtleList[t].penState=!0;break;case"setcolor":a.turtles.turtleList[t].doSetColor(a.playbackQueue[t][e][2]);break;case"sethue":a.turtles.turtleList[t].doSetHue(a.playbackQueue[t][e][2]);break;case"setshade":a.turtles.turtleList[t].doSetValue(a.playbackQueue[t][e][2]);break;case"settranslucency":a.turtles.turtleList[t].doSetPenAlpha(a.playbackQueue[t][e][2]);break;case"setgrey":a.turtles.turtleList[t].doSetChroma(a.playbackQueue[t][e][2]);break;case"setpensize":a.turtles.turtleList[t].doSetPensize(a.playbackQueue[t][e][2]);break;case"penup":a.turtles.turtleList[t].doPenUp();break;case"pendown":a.turtles.turtleList[t].doPenDown();break;default:console.log(a.playbackQueue[t][e][1])}var i=(new Date).getTime()-a.firstNoteTime;if(e+=1,a.playbackQueue[t].length>e){var s=1e3*a.playbackQueue[t][e][0]-i;s<0&&(s=0),setTimeout(function(){__playbackLoop(t,e)},s)}else{if(t<a.turtles.turtleList.length&&(a.turtles.turtleList[t].running=!1),!a.turtles.running()&&(a.onStopTurtle(),a.playbackTime=0,o)){var l=0;for(var t in a.playbackQueue)a.lastNote[t]>l&&(l=a.lastNote[t]);setTimeout(function(){console.log("FINISHING RECORDING"),a.synth.recorder.stop(),a.synth.recorder.exportWAV(save.afterSaveWAV.bind(save)),a.recording=!1},Math.max(2e3,1e3*l))}a.showBlocks(),a.showBlocksAfterRun=!1}}},p.toString=function(){return u.toString()},p),__playback=function(t){d++,setTimeout(function(){__playbackLoop(t,0)},1e3*a.playbackQueue[t][0][0])},__resumePlayback=function(t){d++;for(var e=0;e<a.playbackQueue[t].length&&!(a.playbackQueue[t][e][0]>=a.playbackTime);e++);console.log("resume index: "+e),e<a.playbackQueue[t].length&&__playbackLoop(t,e)},_THIS_IS_MUSIC_BLOCKS_&&this._prepSynths(),this.onRunTurtle(),this.stopTurtle=!1,o&&(console.log("RECORDING"),this.synth.recorder.clear(),this.synth.recorder.record()),console.log(this.playbackQueue),e<0)for(var h in this.playbackQueue)(this.lastNote[h]=0)<this.playbackQueue[h].length&&(h<this.turtles.turtleList.length&&(this.turtles.turtleList[h].running=!0),o?(console.log("recording"),__playback(h)):0<this.playbackTime?(console.log("resuming play at "+this.playbackTime),__resumePlayback(h)):(console.log("play"),__playback(h)));else e<this.turtles.turtleList.length&&(this.turtles.turtleList[e].running=!0,__playback(e))},this._dispatchTurtleSignals=function(t,e,i,s){if(!t in this.embeddedGraphics)console.log("Could not find turtle "+t+"in embeddedGraphics.");else if(!i in this.embeddedGraphics[t])console.log("Could not find blk "+i+"in embeddedGraphics.");else if(0!==this.embeddedGraphics[t][i].length){this.embeddedGraphicsFinished[t]||(s+=.1),this.embeddedGraphicsFinished[t]=!1;for(var o=this,l=!1,a=!1,n=this.suppressOutput[t],r=0,c=0;c<this.embeddedGraphics[t][i].length;c++){var h=this.embeddedGraphics[t][i][c];switch(this.blocks.blockList[h].name){case"forward":case"back":case"right":case"left":case"arc":r+=1}}if((u=850*(e-s)/NOTEDIV)<0&&(u=0),0<r)var u=u/r;var d=1e3*s;this.dispatchFactor[t]=200<u?NOTEDIV/32:100<u?NOTEDIV/16:50<u?NOTEDIV/8:25<u?NOTEDIV/4:12.5<u?NOTEDIV/2:NOTEDIV,setTimeout(function(){o.embeddedGraphicsFinished[t]=!0},1e3*e);for(c=0;c<this.embeddedGraphics[t][i].length;c++){h=this.embeddedGraphics[t][i][c];var f=this.blocks.blockList[h].name;switch(f){case"setcolor":case"sethue":case"setshade":case"settranslucency":case"setgrey":case"setpensize":var p=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg);y(t,f,p,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,f,p]);break;case"penup":case"pendown":n||y(t,f,null,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,f]);break;case"clear":_(t),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"clear"]);break;case"fill":E(t,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"fill"]);break;case"hollowline":O(t,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"hollowline"]);break;case"controlpoint1":var b=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),m=this.parseArg(this,t,this.blocks.blockList[h].connections[2],h,this.receivedArg);P(t,b,m,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"controlpoint1",b,m]);break;case"controlpoint2":b=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),m=this.parseArg(this,t,this.blocks.blockList[h].connections[2],h,this.receivedArg);I(t,b,m,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"controlpoint2",b,m]);break;case"bezier":b=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),m=this.parseArg(this,t,this.blocks.blockList[h].connections[2],h,this.receivedArg);M(t,b,m,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"bezier",b,m]);break;case"setheading":p=o.parseArg(o,t,o.blocks.blockList[h].connections[1],h,o.receivedArg);L(t,p,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"setheading",p]);break;case"right":p=o.parseArg(o,t,o.blocks.blockList[h].connections[1],h,o.receivedArg);for(var g=0;g<NOTEDIV/this.dispatchFactor[t];g++){var k=d+g*u*this.dispatchFactor[t],v=p/(NOTEDIV/o.dispatchFactor[t]);T(t,v,k),o.playbackQueue[t].push([o.previousTurtleTime[t]+k/1e3,"right",v])}d+=NOTEDIV*u;break;case"left":for(p=o.parseArg(o,t,o.blocks.blockList[h].connections[1],h,o.receivedArg),g=0;g<NOTEDIV/this.dispatchFactor[t];g++){k=d+g*u*this.dispatchFactor[t],v=p/(NOTEDIV/o.dispatchFactor[t]);T(t,-v,k),o.playbackQueue[t].push([o.previousTurtleTime[t]+k/1e3,"right",-v])}d+=NOTEDIV*u;break;case"forward":for(p=o.parseArg(o,t,o.blocks.blockList[h].connections[1],h,o.receivedArg),g=0;g<NOTEDIV/this.dispatchFactor[t];g++){k=d+g*u*this.dispatchFactor[t],v=p/(NOTEDIV/o.dispatchFactor[t]);w(t,v,k),o.playbackQueue[t].push([o.previousTurtleTime[t]+k/1e3,"forward",v])}d+=NOTEDIV*u;break;case"back":for(p=o.parseArg(o,t,o.blocks.blockList[h].connections[1],h,o.receivedArg),g=0;g<NOTEDIV/this.dispatchFactor[t];g++){k=d+g*u*this.dispatchFactor[t],v=p/(NOTEDIV/o.dispatchFactor[t]);w(t,-v,k),o.playbackQueue[t].push([o.previousTurtleTime[t]+k/1e3,"forward",-v])}d+=NOTEDIV*u;break;case"setxy":b=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),m=this.parseArg(this,t,this.blocks.blockList[h].connections[2],h,this.receivedArg);x(t,b,m,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"setxy",b,m]);break;case"scrollxy":b=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),m=this.parseArg(this,t,this.blocks.blockList[h].connections[2],h,this.receivedArg);B(t,b,m,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"scrollxy",b,m]);break;case"show":b=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),m=this.parseArg(this,t,this.blocks.blockList[h].connections[2],h,this.receivedArg);S(t,b,m,d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"show",b,m]);break;case"speak":C(0,p=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"speak",p]);break;case"print":A(p=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),d),o.playbackQueue[t].push([o.previousTurtleTime[t]+d/1e3,"print",p]);break;case"arc":for(b=this.parseArg(this,t,this.blocks.blockList[h].connections[1],h,this.receivedArg),m=this.parseArg(this,t,this.blocks.blockList[h].connections[2],h,this.receivedArg),g=0;g<NOTEDIV/this.dispatchFactor[t];g++){k=d+g*u*this.dispatchFactor[t],v=b/(NOTEDIV/o.dispatchFactor[t]);N(t,v,m,k),o.playbackQueue[t].push([o.previousTurtleTime[t]+k/1e3,"arc",v,m])}d+=NOTEDIV*u;break;default:console.log(f+" is not supported inside of Note Blocks")}}}function y(e,t,i,s){function l(t){switch(t){case"penup":o.turtles.turtleList[e].doPenUp();break;case"pendown":o.turtles.turtleList[e].doPenDown();break;case"setcolor":o.turtles.turtleList[e].doSetColor(i);break;case"sethue":o.turtles.turtleList[e].doSetHue(i);break;case"setshade":o.turtles.turtleList[e].doSetValue(i);break;case"settranslucency":o.turtles.turtleList[e].doSetPenAlpha(i);break;case"setgrey":o.turtles.turtleList[e].doSetChroma(i);break;case"setpensize":o.turtles.turtleList[e].doSetPensize(i)}}n?l(t):setTimeout(function(){l(t)},s)}function _(t){if(o.suppressOutput[t]){var e=o.turtles.turtleList[t].penState;o.turtles.turtleList[t].penState=!1,o.turtles.turtleList[t].doSetXY(0,0),o.turtles.turtleList[t].doSetHeading(0),o.turtles.turtleList[t].penState=e,o.svgBackground=!0}else o.turtles.turtleList[t].penState=!1,o.turtles.turtleList[t].doSetHeading(0),o.turtles.turtleList[t].doSetXY(0,0),o.turtles.turtleList[t].penState=!0}function T(t,e,i){if(n){var s=o.turtles.turtleList[t].penState;o.turtles.turtleList[t].penState=!1,o.turtles.turtleList[t].doRight(e),o.turtles.turtleList[t].penState=s}else setTimeout(function(){o.turtles.turtleList[t].doRight(e)},i)}function L(t,e,i){n?o.turtles.turtleList[t].doSetHeading(e):setTimeout(function(){o.turtles.turtleList[t].doSetHeading(e)},i)}function w(t,e,i){if(n){var s=o.turtles.turtleList[t].penState;o.turtles.turtleList[t].penState=!1,o.turtles.turtleList[t].doForward(e),o.turtles.turtleList[t].penState=s}else setTimeout(function(){o.turtles.turtleList[t].doForward(e)},i)}function B(t,e,i,s){n?o.turtles.turtleList[t].doScrollXY(e,i):setTimeout(function(){o.turtles.turtleList[t].doScrollXY(e,i)},s)}function x(t,e,i,s){if(n){var l=o.turtles.turtleList[t].penState;o.turtles.turtleList[t].penState=!1,o.turtles.turtleList[t].doSetXY(e,i),o.turtles.turtleList[t].penState=l}else setTimeout(function(){o.turtles.turtleList[t].doSetXY(e,i)},s)}function S(t,e,i,s){n||setTimeout(function(){o._processShow(t,null,e,i)},s)}function C(t,e,i){n||setTimeout(function(){o._processSpeak(e)},i)}function A(t,e){n||setTimeout(function(){o.textMsg(t.toString())},e)}function N(t,e,i,s){if(n){var l=o.turtles.turtleList[t].penState;o.turtles.turtleList[t].penState=!1,o.turtles.turtleList[t].doArc(e,i),o.turtles.turtleList[t].penState=l}else setTimeout(function(){o.turtles.turtleList[t].doArc(e,i)},s)}function P(t,e,i,s){n?(o.cp1x[t]=e,o.cp1y[t]=i):setTimeout(function(){o.cp1x[t]=e,o.cp1y[t]=i},s)}function I(t,e,i,s){n?(o.cp2x[t]=e,o.cp2y[t]=i):setTimeout(function(){o.cp2x[t]=e,o.cp2y[t]=i},s)}function M(t,e,i,s){if(n){var l=o.turtles.turtleList[t].penState;o.turtles.turtleList[t].penState=!1,o.turtles.turtleList[t].doBezier(o.cp1x[t],o.cp1y[t],o.cp2x[t],o.cp2y[t],e,i),o.turtles.turtleList[t].penState=l}else setTimeout(function(){o.turtles.turtleList[t].doBezier(o.cp1x[t],o.cp1y[t],o.cp2x[t],o.cp2y[t],e,i)},s)}function E(t,e){if(n){var i=o.turtles.turtleList[t].penState;o.turtles.turtleList[t].penState=!1,l=l?(o.turtles.turtleList[t].doEndFill(),!1):(o.turtles.turtleList[t].doStartFill(),!0),o.turtles.turtleList[t].penState=i}else setTimeout(function(){l=l?(o.turtles.turtleList[t].doEndFill(),!1):(o.turtles.turtleList[t].doStartFill(),!0)},e)}function O(t,e){n?a=a?(o.turtles.turtleList[t].doEndHollowLine(),!1):(o.turtles.turtleList[t].doStartHollowLine(),!0):setTimeout(function(){a=a?(o.turtles.turtleList[t].doEndHollowLine(),!1):(o.turtles.turtleList[t].doStartHollowLine(),!0)},e)}},this._setListener=function(t,e,i){e in this.turtles.turtleList[t].listeners&&this.stage.removeEventListener(e,this.turtles.turtleList[t].listeners[e],!1),this.turtles.turtleList[t].listeners[e]=i,this.stage.addEventListener(e,i,!1)},this._setDispatchBlock=function(t,e,i){if(!this.inDuplicate[e]&&0<this.backward[e].length){if("backward"===this.blocks.blockList[last(this.backward[e])].name)var s=1;else s=2;if(this.blocks.sameGeneration(this.blocks.blockList[last(this.backward[e])].connections[s],t))(l=this.blocks.blockList[t].connections[0])in this.endOfClampSignals[e]?this.endOfClampSignals[e][l].push(i):this.endOfClampSignals[e][l]=[i];else null!=(l=last(this.blocks.blockList[t].connections))&&(l in this.endOfClampSignals[e]?this.endOfClampSignals[e][l].push(i):this.endOfClampSignals[e][l]=[i])}else{var l;null!=(l=last(this.blocks.blockList[t].connections))&&(l in this.endOfClampSignals[e]?this.endOfClampSignals[e][l].push(i):this.endOfClampSignals[e][l]=[i])}},this.resetSynth=function(t){for(var e in"electronic synth"in instruments[t]||this.synth.createDefaultSynth(t),this._setMasterVolume(DEFAULTVOLUME),this.synthVolume[t])this.setSynthVolume(t,e,DEFAULTVOLUME);this.synth.start()},this._processSpeak=function(t){var e="";for(var i in t)new RegExp("^[A-Za-z,. ]$").test(t[i])&&(e+=t[i]);null!==this.meSpeak&&this.meSpeak.speak(e)},this._processShow=function(t,e,i,s){if("string"==typeof s){var l=s.length;14===l&&s.substr(0,14)===CAMERAVALUE?doUseCamera([i],this.turtles,t,!1,this.cameraID,this.setCameraID,this.errorMsg):13===l&&s.substr(0,13)===VIDEOVALUE?doUseCamera([i],this.turtles,t,!0,this.cameraID,this.setCameraID,this.errorMsg):10<l&&"data:image"===s.substr(0,10)?this.turtles.turtleList[t].doShowImage(i,s):8<l&&"https://"===s.substr(0,8)?this.turtles.turtleList[t].doShowURL(i,s):7<l&&"http://"===s.substr(0,7)?this.turtles.turtleList[t].doShowURL(i,s):7<l&&"file://"===s.substr(0,7)?this.turtles.turtleList[t].doShowURL(i,s):this.turtles.turtleList[t].doShowText(i,s)}else"object"===_typeof(s)&&null!==e&&"loadFile"===this.blocks.blockList[this.blocks.blockList[e].connections[2]].name?s?this.turtles.turtleList[t].doShowText(i,s[1]):this.errorMsg(_("You must select a file.")):this.turtles.turtleList[t].doShowText(i,s)},this._getTargetTurtle=function(t){"number"==typeof t&&(t=t.toString());for(var e=0;e<this.turtles.turtleList.length;e++)if(!this.turtles.turtleList[e].trash){var i=this.turtles.turtleList[e].name;if("number"==typeof i&&(i=i.toString()),i===t)return e}return null},this._loopBlock=function(t){return-1!==["forever","repeat","while","until"].indexOf(t)},this._doBreak=function(t){for(var e=null,i=-1,s=this.turtles.turtleList[t].queue.length-1;-1<s;s--){if(this._loopBlock(this.blocks.blockList[this.turtles.turtleList[t].queue[s].blk].name)){i=this.turtles.turtleList[t].queue[s].blk,e=this.blocks.blockList[i],this.turtles.turtleList[t].queue.pop();break}if(this._loopBlock(this.blocks.blockList[this.turtles.turtleList[t].queue[s].parentBlk].name)){i=this.turtles.turtleList[t].queue[s].parentBlk,e=this.blocks.blockList[i],this.turtles.turtleList[t].queue.pop();break}}if(null!=e){if("while"===e.name||"until"===e.name){var l=last(e.connections);if(null!=l){var o=new Queue(l,1,i);this.parentFlowQueue[t].push(i),this.turtles.turtleList[t].queue.push(o)}}}else this.turtles.turtleList[t].queue.pop()},this.parseArg=function(that,turtle,blk,parentBlk,receivedArg){var logo=that;if(null==blk)return that.errorMsg(NOINPUTERRORMSG,parentBlk),null;if(that.blocks.blockList[blk].protoblock.parameter&&turtle in that.parameterQueue&&-1===that.parameterQueue[turtle].indexOf(blk)&&that.parameterQueue[turtle].push(blk),"intervalname"===that.blocks.blockList[blk].name)return"string"==typeof that.blocks.blockList[blk].value?(that.noteDirection[turtle]=getIntervalDirection(that.blocks.blockList[blk].value),getIntervalNumber(that.blocks.blockList[blk].value)):0;if(that.blocks.blockList[blk].isValueBlock()){if("number"===that.blocks.blockList[blk].name&&"string"==typeof that.blocks.blockList[blk].value)try{that.blocks.blockList[blk].value=Number(that.blocks.blockList[blk].value)}catch(t){console.log(t)}return that.blocks.blockList[blk].name in that.evalArgDict&&eval(that.evalArgDict[that.blocks.blockList[blk].name]),that.blocks.blockList[blk].value}if("boolean"===that.blocks.blockList[blk].name)return"string"==typeof that.blocks.blockList[blk].value?that.blocks.blockList[blk].value===_("true")||"true"===that.blocks.blockList[blk].value:that.blocks.blockList[blk].value;if(that.blocks.blockList[blk].isArgBlock()||that.blocks.blockList[blk].isArgClamp()||that.blocks.blockList[blk].isArgFlowClampBlock()||-1!==["anyout","numberout","textout"].indexOf(that.blocks.blockList[blk].protoblock.dockTypes[0])){switch(that.blocks.blockList[blk].name){case"pitchness":if(null===this.mic||_THIS_IS_TURTLE_BLOCKS_)that.blocks.blockList[blk].value=440;else{null==this.pitchAnalyser&&(this.pitchAnalyser=new Tone.Analyser({type:"fft",size:this.limit}),this.mic.connect(this.pitchAnalyser));for(var values=that.pitchAnalyser.getValue(),max=0,idx=0,i=0;i<this.limit;i++){var v2=values[i]*values[i];max<v2&&(max=v2,idx=i)}that.blocks.blockList[blk].value=idx}break;case"loudness":if(null===this.mic)that.blocks.blockList[blk].value=0;else if(_THIS_IS_TURTLE_BLOCKS_)that.blocks.blockList[blk].value=Math.round(1e3*that.mic.getLevel());else{null==this.volumeAnalyser&&(this.volumeAnalyser=new Tone.Analyser({type:"waveform",size:this.limit}),this.mic.connect(this.volumeAnalyser));for(var values=that.volumeAnalyser.getValue(),sum=0,k=0;k<that.limit;k++)sum+=values[k]*values[k];var rms=Math.sqrt(sum/that.limit);that.blocks.blockList[blk].value=Math.round(100*rms)}break;case"arg":var cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var name=that.parseArg(that,turtle,cblk,blk,receivedArg),action_args=receivedArg;if(action_args&&action_args.length>=Number(name)){var value=action_args[Number(name)-1];that.blocks.blockList[blk].value=value}else that.errorMsg(_("Invalid argument"),blk),that.blocks.blockList[blk].value=0}break;case"box":var cblk=that.blocks.blockList[blk].connections[1];null===cblk&&(that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0);var name=that.parseArg(that,turtle,cblk,blk,receivedArg);name in that.boxes?that.blocks.blockList[blk].value=that.boxes[name]:(that.errorMsg(NOBOXERRORMSG,blk,name),that.blocks.blockList[blk].value=0);break;case"turtlename":that.blocks.blockList[blk].value=that.turtles.turtleList[turtle].name;break;case"namedbox":var name=that.blocks.blockList[blk].privateData;that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,that.blocks.blockList[blk].name]):that.updatingStatusMatrix||(name in that.boxes?that.blocks.blockList[blk].value=that.boxes[name]:(that.errorMsg(NOBOXERRORMSG,blk,name),that.blocks.blockList[blk].value=0));break;case"namedarg":var name=that.blocks.blockList[blk].privateData,actionArgs=receivedArg;if(null==actionArgs&&(that.errorMsg(_("Invalid argument"),blk),that.blocks.blockList[blk].value=0),actionArgs.length>=Number(name)){var value=actionArgs[Number(name)-1];that.blocks.blockList[blk].value=value}else that.errorMsg(_("Invalid argument"),blk),that.blocks.blockList[blk].value=0;break;case"sqrt":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,that.blocks.blockList[blk].name]);else{var cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk,blk,receivedArg);"number"==typeof a?(a<0&&(that.errorMsg(NOSQRTERRORMSG,blk),a=-a),that.blocks.blockList[blk].value=that._doSqrt(a)):(that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value=0)}}break;case"abs":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,that.blocks.blockList[blk].name]);else{var cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk,blk,receivedArg);"number"==typeof a?that.blocks.blockList[blk].value=Math.abs(a):(that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value=0)}}break;case"int":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"int"]);else{var cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk,blk,receivedArg);if("number"==typeof a)that.blocks.blockList[blk].value=Math.floor(a);else try{that.blocks.blockList[blk].value=Math.floor(Number(a))}catch(t){console.log(t),that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value=0}}}break;case"mod":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"mod"]);else{var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);"number"==typeof a&&"number"==typeof b?that.blocks.blockList[blk].value=that._doMod(a,b):(that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value=0)}}break;case"not":var cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1;else{var a=that.parseArg(that,turtle,cblk,blk,receivedArg);try{that.blocks.blockList[blk].value=!a}catch(t){console.log(t),that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1}}break;case"greater":var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);try{that.blocks.blockList[blk].value=Number(a)>Number(b)}catch(t){console.log(t),that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1}}break;case"equal":var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);try{that.blocks.blockList[blk].value=a===b}catch(t){console.log(t),that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1}}break;case"less":var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);try{that.blocks.blockList[blk].value=Number(a)<Number(b)}catch(t){console.log(t),that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1}}break;case"random":var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);"number"==typeof a&&"number"==typeof b?that.blocks.blockList[blk].value=that._doRandom(a,b):(that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1)}break;case"oneOf":var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)if(that.errorMsg(NOINPUTERRORMSG,blk),null!==cblk1){var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);that.blocks.blockList[blk].value=a}else if(null!==cblk2){var b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=b}else that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=that._doOneOf(a,b)}break;case"plus":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"plus"]);else{var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)if(that.errorMsg(NOINPUTERRORMSG,blk),null!==cblk1){var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);that.blocks.blockList[blk].value=a}else if(null!==cblk2){var b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=b}else that.blocks.blockList[blk].value=0;else{var cblk0=that.blocks.blockList[blk].connections[0];if(null!==cblk0&&"pitch"===that.blocks.blockList[cblk0].name){var noteBlock=that.blocks.blockList[cblk0].connections[1];if("string"==typeof that.blocks.blockList[cblk1].value)var a=calcOctave(that.currentOctave[turtle],that.blocks.blockList[cblk1].value,that.lastNotePlayed[turtle],that.blocks.blockList[noteBlock].value);else var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);if("string"==typeof that.blocks.blockList[cblk2].value)var b=calcOctave(that.currentOctave[turtle],that.blocks.blockList[cblk2].value,that.lastNotePlayed[turtle],that.blocks.blockList[noteBlock].value);else var b=that.parseArg(that,turtle,cblk2,blk,receivedArg)}else var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=that._doPlus(a,b)}}break;case"multiply":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"multiply"]);else{var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2],cblk0=that.blocks.blockList[blk].connections[0],noteBlock=that.blocks.blockList[cblk0].connections[1];if(null===cblk1||null===cblk2)if(that.errorMsg(NOINPUTERRORMSG,blk),null!==cblk1){var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);that.blocks.blockList[blk].value=a}else if(null!==cblk2){var b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=b}else that.blocks.blockList[blk].value=0;else{if("string"==typeof that.blocks.blockList[cblk1].value)var a=calcOctave(that.currentOctave[turtle],that.blocks.blockList[cblk1].value,that.lastNotePlayed[turtle],that.blocks.blockList[noteBlock].value);else var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);if("string"==typeof that.blocks.blockList[cblk2].value)var b=calcOctave(that.currentOctave[turtle],that.blocks.blockList[cblk2].value,that.lastNotePlayed[turtle],that.blocks.blockList[noteBlock].value);else var b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=that._doMultiply(a,b)}}break;case"power":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"power"]);else{var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)if(that.errorMsg(NOINPUTERRORMSG,blk),null!==cblk1){var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);that.blocks.blockList[blk].value=a}else that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);"number"==typeof a&&"number"==typeof b?that.blocks.blockList[blk].value=that._doPower(a,b):(that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value=0)}}break;case"divide":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"divide"]);else{var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)if(that.errorMsg(NOINPUTERRORMSG,blk),null!==cblk1){var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);that.blocks.blockList[blk].value=a}else that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);"number"==typeof a&&"number"==typeof b?that.blocks.blockList[blk].value=that._doDivide(a,b):(that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value=0)}}break;case"minus":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"minus"]);else{var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2],cblk0=that.blocks.blockList[blk].connections[0],noteBlock=that.blocks.blockList[cblk0].connections[1];if(null===cblk1||null===cblk2)if(that.errorMsg(NOINPUTERRORMSG,blk),null!==cblk1){var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);that.blocks.blockList[blk].value=a}else if(null!==cblk2){var b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=-b}else that.blocks.blockList[blk].value=0;else{if("string"==typeof that.blocks.blockList[cblk1].value)var a=calcOctave(that.currentOctave[turtle],that.blocks.blockList[cblk1].value,that.lastNotePlayed[turtle],that.blocks.blockList[noteBlock].value);else var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);if("string"==typeof that.blocks.blockList[cblk2].value)var b=calcOctave(that.currentOctave[turtle],that.blocks.blockList[cblk2].value,that.lastNotePlayed[turtle],that.blocks.blockList[noteBlock].value);else var b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=that._doMinus(a,b)}}break;case"doubly":var cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else for(var currentblock=cblk;;){var blockToCheck=that.blocks.blockList[currentblock];if("intervalname"===blockToCheck.name){"a"===blockToCheck.value[0]?that.blocks.blockList[blk].value=that.parseArg(that,turtle,cblk,blk,receivedArg)+1:"d"===blockToCheck.value[0]?that.blocks.blockList[blk].value=that.parseArg(that,turtle,cblk,blk,receivedArg)-1:that.blocks.blockList[blk].value=that.parseArg(that,turtle,cblk,blk,receivedArg);break}if("doubly"!==blockToCheck.name){var value=that.parseArg(that,turtle,cblk,blk,receivedArg);that.blocks.blockList[blk].value="number"==typeof value?2*value:"string"==typeof value?value+value:value;break}if(currentblock=that.blocks.blockList[currentblock].connections[1],null==currentblock){that.blocks.blockList[blk].value=0;break}}break;case"neg":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"neg"]);else{var cblk=that.blocks.blockList[blk].connections[1];if(null!==cblk){var a=that.parseArg(that,turtle,cblk,blk,receivedArg);if("number"==typeof a)that.blocks.blockList[blk].value=that._doMinus(0,a);else if("string"==typeof a){var obj=a.split("");that.blocks.blockList[blk].value=obj.reverse().join("")}else that.blocks.blockList[blk].value=a}else that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0}break;case"toascii":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"toascii"]);else{var cblk1=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value="A";else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg);"number"==typeof a?that.blocks.blockList[blk].value=String.fromCharCode(a):(that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value="A")}}break;case"myclick":that.blocks.blockList[blk].value="click"+that.turtles.turtleList[turtle].name;break;case"heading":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"heading"]):that.blocks.blockList[blk].value=that.turtles.turtleList[turtle].orientation;break;case"x":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"x"]):that.blocks.blockList[blk].value=that.turtles.screenX2turtleX(that.turtles.turtleList[turtle].container.x);break;case"y":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"y"]):that.blocks.blockList[blk].value=that.turtles.screenY2turtleY(that.turtles.turtleList[turtle].container.y);break;case"turtleheading":case"xturtle":case"yturtle":for(var cblk=that.blocks.blockList[blk].connections[1],targetTurtle=that.parseArg(that,turtle,cblk,blk,receivedArg),i=0;i<that.turtles.turtleList.length;i++){var thisTurtle=that.turtles.turtleList[i];if(targetTurtle===thisTurtle.name){"yturtle"===that.blocks.blockList[blk].name?that.blocks.blockList[blk].value=that.turtles.screenY2turtleY(thisTurtle.container.y):"xturtle"===that.blocks.blockList[blk].name?that.blocks.blockList[blk].value=that.turtles.screenX2turtleX(thisTurtle.container.x):that.blocks.blockList[blk].value=thisTurtle.orientation;break}}if(i===that.turtles.turtleList.length){_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+targetTurtle,blk):that.errorMsg(_("Cannot find turtle")+" "+targetTurtle,blk);var thisTurtle=that.turtles.turtleList[turtle];"yturtle"===that.blocks.blockList[blk].name?that.blocks.blockList[blk].value=that.turtles.screenY2turtleY(thisTurtle.container.y):"xturtle"===that.blocks.blockList[blk].name?that.blocks.blockList[blk].value=that.turtles.screenX2turtleX(thisTurtle.container.x):that.blocks.blockList[blk].value=thisTurtle.orientation}break;case"synthname":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"synthname"]):that.blocks.blockList[blk].value=last(that.instrumentNames[turtle]);break;case"bpmfactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"bpm"]):0<that.bpm[turtle].length?that.blocks.blockList[blk].value=last(that.bpm[turtle]):that.blocks.blockList[blk].value=that._masterBPM;break;case"staccatofactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"staccato"]):0<that.staccato[turtle].length?that.blocks.blockList[blk].value=last(that.staccato[turtle]):that.blocks.blockList[blk].value=0;break;case"slurfactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"slur"]):0<that.staccato[turtle].length?that.blocks.blockList[blk].value=-last(that.staccato[turtle]):that.blocks.blockList[blk].value=0;break;case"key":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"key"]):that.blocks.blockList[blk].value=that.keySignature[turtle][0];break;case"currentmode":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"currentmode"]);else{var obj=that.keySignature[turtle].split(" ");that.blocks.blockList[blk].value=obj[1]}break;case"currentmeter":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"currentmeter"]):that.blocks.blockList[blk].value=that.beatsPerMeasure[turtle]+":"+that.noteValuePerBeat[turtle];break;case"modelength":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"modelength"]):that.blocks.blockList[blk].value=getModeLength(that.keySignature[turtle]);break;case"consonantstepsizeup":if(null!==that.lastNotePlayed[turtle]){var len=that.lastNotePlayed[turtle][0].length;that.blocks.blockList[blk].value=getStepSizeUp(that.keySignature[turtle],that.lastNotePlayed[turtle][0].slice(0,len-1))}else that.blocks.blockList[blk].value=getStepSizeUp(that.keySignature[turtle],"A");break;case"consonantstepsizedown":if(null!==that.lastNotePlayed[turtle]){var len=that.lastNotePlayed[turtle][0].length;that.blocks.blockList[blk].value=getStepSizeDown(that.keySignature[turtle],that.lastNotePlayed[turtle][0].slice(0,len-1))}else that.blocks.blockList[blk].value=getStepSizeDown(that.keySignature[turtle],"A");break;case"transpositionfactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"transposition"]):that.blocks.blockList[blk].value=that.transposition[turtle];break;case"duplicatefactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"duplicate"]):that.blocks.blockList[blk].value=that.duplicateFactor[turtle];break;case"skipfactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"skip"]):that.blocks.blockList[blk].value=that.skipFactor[turtle];break;case"notevolumefactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"volume"]):that.blocks.blockList[blk].value=last(that.masterVolume);break;case"elapsednotes2":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"elapsednotes2"]);else{var cblk=that.blocks.blockList[blk].connections[1],notevalue=that.parseArg(that,turtle,cblk,blk,receivedArg);that.blocks.blockList[blk].value=null==notevalue||0===notevalue?0:that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]/notevalue}break;case"elapsednotes":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"elapsednotes"]):that.blocks.blockList[blk].value=that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1];break;case"pitchinhertz":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"pitchinhertz"]):null!==that.lastNotePlayed[turtle]&&(that.blocks.blockList[blk].value=that.synth._getFrequency(that.lastNotePlayed[turtle][0],that.synth.changeInTemperament));break;case"turtleelapsednotes":for(var value=null,cblk=that.blocks.blockList[blk].connections[1],targetTurtle=that.parseArg(that,turtle,cblk,blk,receivedArg),i=0;i<that.turtles.turtleList.length;i++){var thisTurtle=that.turtles.turtleList[i];if(targetTurtle===thisTurtle.name){value=that.notesPlayed[i][0]/that.notesPlayed[i][1],that.blocks.blockList[blk].value=value;break}}null==value&&(_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+targetTurtle,blk):that.errorMsg(_("Cannot find turtle")+" "+targetTurtle,blk),that.blocks.blockList[blk].value=that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]);break;case"beatfactor":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"beatfactor"]):that.blocks.blockList[blk].value=that.beatFactor[turtle];break;case"number2pitch":case"number2octave":var cblk=that.blocks.blockList[blk].connections[1],num=that.parseArg(that,turtle,cblk,blk,receivedArg);if(null!=num&&"number"==typeof num){var obj=numberToPitch(num+that.pitchNumberOffset[turtle]);"number2pitch"===that.blocks.blockList[blk].name?that.blocks.blockList[blk].value=obj[0]:that.blocks.blockList[blk].value=obj[1]}else that.errorMsg(NOINPUTERRORMSG,blk),that.stopTurtle=!0;break;case"turtlepitch":for(var value=null,cblk=that.blocks.blockList[blk].connections[1],targetTurtle=that.parseArg(that,turtle,cblk,blk,receivedArg),i=0;i<that.turtles.turtleList.length;i++){var thisTurtle=that.turtles.turtleList[i];if(targetTurtle===thisTurtle.name){if(null!==that.lastNotePlayed[i])var len=that.lastNotePlayed[i][0].length,pitch=that.lastNotePlayed[i][0].slice(0,len-1),octave=parseInt(that.lastNotePlayed[i][0].slice(len-1)),obj=[pitch,octave];else if(0<that.notePitches[i].length)var obj=getNote(that.notePitches[i][0],that.noteOctaves[i][0],0,that.keySignature[i],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);else{console.log("Cannot find a note for mouse "+turtle),that.errorMsg(INVALIDPITCH,blk);var obj=["G",4]}value=pitchToNumber(obj[0],obj[1],that.keySignature[i])-that.pitchNumberOffset[turtle],that.blocks.blockList[blk].value=value;break}}if(null==value){if(_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+targetTurtle,blk):that.errorMsg(_("Cannot find turtle")+" "+targetTurtle,blk),null!==that.lastNotePlayed[turtle])var len=that.lastNotePlayed[turtle][0].length,pitch=that.lastNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(that.lastNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave];else if(0<that.notePitches[turtle].length)var obj=getNote(that.notePitches[turtle][last(that.inNoteBlock[turtle])][0],that.noteOctaves[turtle][last(that.inNoteBlock[turtle])][0],0,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament);else{console.log("Cannot find a note for mouse "+turtle),that.errorMsg(INVALIDPITCH,blk);var obj=["G",4]}value=pitchToNumber(obj[0],obj[1],that.keySignature[turtle])-that.pitchNumberOffset[turtle],that.blocks.blockList[blk].value=value}break;case"deltapitch":case"deltapitch2":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"mypitch"]);else if(null==that.previousNotePlayed[turtle])that.blocks.blockList[blk].value=0;else{var len=that.previousNotePlayed[turtle][0].length,pitch=that.previousNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(that.previousNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave],previousValue=pitchToNumber(obj[0],obj[1],that.keySignature[turtle]);len=that.lastNotePlayed[turtle][0].length,pitch=that.lastNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(that.lastNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave];var delta=pitchToNumber(obj[0],obj[1],that.keySignature[turtle])-previousValue;if("deltapitch"===that.blocks.blockList[blk].name)that.blocks.blockList[blk].value=delta;else{var scalarDelta=0,i=0;if(0<delta){for(;0<delta;){i+=1;var nhalf=getStepSizeUp(that.keySignature[turtle],pitch,0,"equal");if(delta-=nhalf,scalarDelta+=1,obj=getNote(pitch,octave,nhalf,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament),pitch=obj[0],octave=obj[1],100<i)break}that.blocks.blockList[blk].value=scalarDelta}else{for(;delta<0;){i+=1;var nhalf=getStepSizeDown(that.keySignature[turtle],pitch,0,"equal");if(delta-=nhalf,scalarDelta-=1,obj=getNote(pitch,octave,nhalf,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg,that.synth.inTemperament),pitch=obj[0],octave=obj[1],100<i)break}that.blocks.blockList[blk].value=scalarDelta}}}break;case"mypitch":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"mypitch"]);else{var value=null;if(null!==that.lastNotePlayed[turtle])if("string"==typeof that.lastNotePlayed[turtle][0])var len=that.lastNotePlayed[turtle][0].length,pitch=that.lastNotePlayed[turtle][0].slice(0,len-1),octave=parseInt(that.lastNotePlayed[turtle][0].slice(len-1)),obj=[pitch,octave];else var obj=frequencyToPitch(that.lastNotePlayed[turtle][0]);else if(that.inNoteBlock[turtle]in that.notePitches[turtle]&&0<that.notePitches[turtle][last(that.inNoteBlock[turtle])].length)var obj=getNote(that.notePitches[turtle][last(that.inNoteBlock[turtle])][0],that.noteOctaves[turtle][last(that.inNoteBlock[turtle])][0],0,that.keySignature[turtle],that.moveable[turtle],null,that.errorMsg);else{null!==that.lastNotePlayed[turtle]&&(console.log("Cannot find a note "),that.errorMsg(INVALIDPITCH,blk));var obj=["G",4]}value=pitchToNumber(obj[0],obj[1],that.keySignature[turtle])-that.pitchNumberOffset[turtle],that.blocks.blockList[blk].value=value}break;case"beatvalue":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"beatvalue"]):that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]<that.pickup[turtle]?that.blocks.blockList[blk].value=0:that.blocks.blockList[blk].value=(that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]-that.pickup[turtle])*that.noteValuePerBeat[turtle]%that.beatsPerMeasure[turtle]+1;break;case"measurevalue":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"measurevalue"]):that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]<that.pickup[turtle]?that.blocks.blockList[blk].value=0:that.blocks.blockList[blk].value=Math.floor((that.notesPlayed[turtle][0]/that.notesPlayed[turtle][1]-that.pickup[turtle])*that.noteValuePerBeat[turtle]/that.beatsPerMeasure[turtle])+1;break;case"mynotevalue":if(that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name)that.statusFields.push([blk,"mynotevalue"]);else{var value=0;value=null!==that.noteValue[turtle][last(that.inNoteBlock[turtle])]&&void 0!==that.noteValue[turtle][last(that.inNoteBlock[turtle])]?0!==that.noteValue[turtle][last(that.inNoteBlock[turtle])]?1/that.noteValue[turtle][last(that.inNoteBlock[turtle])]:0:null!==that.lastNotePlayed[turtle]?that.lastNotePlayed[turtle][1]:void 0!==that.notePitches[turtle][last(that.inNoteBlock[turtle])]&&0<that.notePitches[turtle][last(that.inNoteBlock[turtle])].length?that.noteBeat[turtle][last(that.inNoteBlock[turtle])]:(console.log("Cannot find a note for turtle "+turtle),0),that.blocks.blockList[blk].value=0!==value?1/value:0}break;case"turtlenote":case"turtlenote2":for(var value=null,cblk=that.blocks.blockList[blk].connections[1],targetTurtle=that.parseArg(that,turtle,cblk,blk,receivedArg),i=0;i<that.turtles.turtleList.length;i++){var thisTurtle=that.turtles.turtleList[i];if(targetTurtle===thisTurtle.name){value=0<that.inNoteBlock[i].length&&last(that.inNoteBlock[i])in that.noteValue[i]?1/that.noteValue[i][last(that.inNoteBlock[i])]:null!==that.lastNotePlayed[i]?that.lastNotePlayed[i][1]:0<that.notePitches[i].length?that.noteBeat[i][last(that.inNoteBlock[i])]:-1,"turtlenote"===that.blocks.blockList[blk].name?that.blocks.blockList[blk].value=value:that.blocks.blockList[blk].value=0!==value?1/value:0;break}}null==value&&(_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+targetTurtle,blk):that.errorMsg(_("Cannot find turtle")+" "+targetTurtle,blk),that.blocks.blockList[blk].value=-1);break;case"color":case"hue":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"color"]):that.blocks.blockList[blk].value=that.turtles.turtleList[turtle].color;break;case"turtlecolor":for(var cblk=that.blocks.blockList[blk].connections[1],targetTurtle=that.parseArg(that,turtle,cblk,blk,receivedArg),i=0;i<that.turtles.turtleList.length;i++){var thisTurtle=that.turtles.turtleList[i];if(targetTurtle===thisTurtle.name){that.blocks.blockList[blk].value=thisTurtle.color;break}}if(i===that.turtles.turtleList.length){_THIS_IS_MUSIC_BLOCKS_?that.errorMsg(_("Cannot find mouse")+" "+targetTurtle,blk):that.errorMsg(_("Cannot find turtle")+" "+targetTurtle,blk);var thisTurtle=that.turtles.turtleList[turtle];that.blocks.blockList[blk].value=thisTurtle.color}break;case"shade":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"shade"]):that.blocks.blockList[blk].value=that.turtles.turtleList[turtle].value;break;case"grey":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"grey"]):that.blocks.blockList[blk].value=that.turtles.turtleList[turtle].chroma;break;case"pensize":that.inStatusMatrix&&"print"===that.blocks.blockList[that.blocks.blockList[blk].connections[0]].name?that.statusFields.push([blk,"pensize"]):that.blocks.blockList[blk].value=that.turtles.turtleList[turtle].stroke;break;case"and":var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=a&&b}break;case"or":var cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=!1;else{var a=that.parseArg(that,turtle,cblk1,blk,receivedArg),b=that.parseArg(that,turtle,cblk2,blk,receivedArg);that.blocks.blockList[blk].value=a||b}break;case"time":var d=new Date;that.blocks.blockList[blk].value=(d.getTime()-that.time)/1e3;break;case"hspace":var cblk=that.blocks.blockList[blk].connections[1],v=that.parseArg(that,turtle,cblk,blk,receivedArg);that.blocks.blockList[blk].value=v;break;case"mousex":that.blocks.blockList[blk].value=that.getStageX();break;case"mousey":that.blocks.blockList[blk].value=that.getStageY();break;case"toppos":that.blocks.blockList[blk].value=that.turtles._canvas.height/(2*that.turtles.scale);break;case"rightpos":that.blocks.blockList[blk].value=that.turtles._canvas.width/(2*that.turtles.scale);break;case"leftpos":that.blocks.blockList[blk].value=that.turtles._canvas.width/(2*that.turtles.scale)*-1;break;case"bottompos":that.blocks.blockList[blk].value=that.turtles._canvas.height/(2*that.turtles.scale)*-1;break;case"width":that.blocks.blockList[blk].value=that.turtles._canvas.width/that.turtles.scale;break;case"height":that.blocks.blockList[blk].value=that.turtles._canvas.height/that.turtles.scale;break;case"mousebutton":that.blocks.blockList[blk].value=that.getStageMouseDown();break;case"foundturtle":var cblk=that.blocks.blockList[blk].connections[1],targetTurtle=that.parseArg(that,turtle,cblk,blk,receivedArg);that.blocks.blockList[blk].value=null!==that._getTargetTurtle(targetTurtle);break;case"keyboard":that.lastKeyCode=that.getCurrentKeyCode(),that.blocks.blockList[blk].value=that.lastKeyCode,that.clearCurrentKeyCode();break;case"getred":case"getgreen":case"getblue":var colorString=that.turtles.turtleList[turtle].canvasColor;"#"===colorString[0]&&(colorString=hex2rgb(colorString.split("#")[1]));var obj=colorString.split("("),obj=obj[1].split(",");switch(that.blocks.blockList[blk].name){case"getred":that.blocks.blockList[blk].value=parseInt(Number(obj[0])/2.55);break;case"getgreen":that.blocks.blockList[blk].value=parseInt(Number(obj[1])/2.55);break;case"getblue":that.blocks.blockList[blk].value=parseInt(Number(obj[2])/2.55)}break;case"getcolorpixel":var wasVisible=that.turtles.turtleList[turtle].container.visible;that.turtles.turtleList[turtle].container.visible=!1;var x=that.turtles.turtleList[turtle].container.x,y=that.turtles.turtleList[turtle].container.y;that.refreshCanvas();var canvas=docById("overlayCanvas"),ctx=canvas.getContext("2d"),imgData=ctx.getImageData(Math.floor(x),Math.floor(y),1,1).data,color=searchColors(imgData[0],imgData[1],imgData[2]);0===imgData[3]&&(color=body.style.background.substring(body.style.background.indexOf("(")+1,body.style.background.lastIndexOf(")")).split(/,\s*/),color=searchColors(color[0],color[1],color[2])),that.blocks.blockList[blk].value=color,wasVisible&&(that.turtles.turtleList[turtle].container.visible=!0);break;case"loadFile":break;case"tofrequency":if(_THIS_IS_MUSIC_BLOCKS_){var block=that.blocks.blockList[blk],cblk1=that.blocks.blockList[blk].connections[1],cblk2=that.blocks.blockList[blk].connections[2];if(null===cblk1||null===cblk2)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=392;else{var note=that.parseArg(that,turtle,cblk1,blk,receivedArg),octave=Math.floor(calcOctave(that.currentOctave[turtle],that.parseArg(that,turtle,cblk2,blk,receivedArg),that.lastNotePlayed[turtle],note));block.value=Math.round(pitchToFrequency(note,octave,0,that.keySignature[turtle]))}}else{var NOTENAMES=["A","B","B","C","D","D","E","E","F","G","G","A"],NOTECONVERSION={"A":"B","C":"D","D":"E","F":"G","G":"A"},block=that.blocks.blockList[blk],cblk=block.connections[1];if(null===cblk){that.errorMsg(NOINPUTERRORMSG,blk);var noteName="G"}else var noteName=that.parseArg(that,turtle,cblk,blk,receivedArg);if("string"==typeof noteName){noteName=noteName.replace("b",""),noteName=noteName.replace("#",""),noteName in NOTECONVERSION&&(noteName=NOTECONVERSION[noteName]);var idx=NOTENAMES.indexOf(noteName);if(-1===idx)this.errorMsg(_("Note name must be one of A, A, B, B, C, C, D, D, D, E, E, F, F, G, G, G or A.")),block.value=440;else{var cblk=block.connections[2];if(null===cblk){that.errorMsg(NOINPUTERRORMSG,blk);var octave=4}else var octave=Math.floor(that.parseArg(that,turtle,cblk,blk,receivedArg));octave<1&&(octave=1),2<idx&&(octave-=1);var i=12*octave+idx;block.value=27.5*Math.pow(1.05946309435929,i)}}else block.value=440*Math.pow(2,(noteName-69)/12)}break;case"pop":var block=that.blocks.blockList[blk];turtle in that.turtleHeaps&&0<that.turtleHeaps[turtle].length?block.value=that.turtleHeaps[turtle].pop():(that.errorMsg(_("empty heap")),block.value=0);break;case"indexHeap":var block=that.blocks.blockList[blk],cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var a=that.parseArg(that,turtle,cblk,blk,receivedArg);if("number"==typeof a){turtle in that.turtleHeaps||(that.turtleHeaps[turtle]=[]),a<1&&(a=1,that.errorMsg(_("Index must be > 0."))),1e3<a&&(a=1e3,that.errorMsg(_("Maximum heap size is 1000.")));for(;that.turtleHeaps[turtle].length<a;)that.turtleHeaps[turtle].push(0);block.value=that.turtleHeaps[turtle][a-1]}else that.errorMsg(NANERRORMSG,blk),that.blocks.blockList[blk].value=0}break;case"heapLength":var block=that.blocks.blockList[blk];turtle in that.turtleHeaps||(that.turtleHeaps[turtle]=[]),block.value=that.turtleHeaps[turtle].length;break;case"heapEmpty":var block=that.blocks.blockList[blk];turtle in that.turtleHeaps?block.value=0===that.turtleHeaps[turtle].length:block.value=!0;break;case"notecounter":var cblk=that.blocks.blockList[blk].connections[1];null===cblk?(that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0):that.blocks.blockList[blk].value=that._noteCounter(turtle,cblk);break;case"measureintervalsemitones":var cblk=that.blocks.blockList[blk].connections[1];if(null==cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var saveSuppressStatus=that.suppressOutput[turtle],saveBoxes=JSON.stringify(that.boxes),saveTurtleHeaps=JSON.stringify(that.turtleHeaps[turtle]),saveX=that.turtles.turtleList[turtle].x,saveY=that.turtles.turtleList[turtle].y,saveColor=that.turtles.turtleList[turtle].color,saveValue=that.turtles.turtleList[turtle].value,saveChroma=that.turtles.turtleList[turtle].chroma,saveStroke=that.turtles.turtleList[turtle].stroke,saveCanvasAlpha=that.turtles.turtleList[turtle].canvasAlpha,saveOrientation=that.turtles.turtleList[turtle].orientation,savePenState=that.turtles.turtleList[turtle].penState;for(var b in that.suppressOutput[turtle]=!0,that.justCounting[turtle].push(!0),that.justMeasuring[turtle].push(!0),that.endOfClampSignals[turtle]){that.butNotThese[turtle][b]=[];for(var i=0;i<that.endOfClampSignals[turtle][b].length;i++)that.butNotThese[turtle][b].push(i)}var actionArgs=[],saveNoteCount=that.notesPlayed[turtle];that.turtles.turtleList[turtle].running=!0,that._runFromBlockNow(that,turtle,cblk,!0,actionArgs,that.turtles.turtleList[turtle].queue.length),0<that.firstPitch[turtle].length&&0<that.lastPitch[turtle].length?(that.blocks.blockList[blk].value=last(that.lastPitch[turtle])-last(that.firstPitch[turtle]),that.firstPitch[turtle].pop(),that.lastPitch[turtle].pop()):(that.blocks.blockList[blk].value=0,that.errorMsg(_("You must use two pitch blocks when measuring an interval."))),that.notesPlayed[turtle]=saveNoteCount,that.boxes=JSON.parse(saveBoxes),that.turtleHeaps[turtle]=JSON.parse(saveTurtleHeaps),that.turtles.turtleList[turtle].doPenUp(),that.turtles.turtleList[turtle].doSetXY(saveX,saveY),that.turtles.turtleList[turtle].color=saveColor,that.turtles.turtleList[turtle].value=saveValue,that.turtles.turtleList[turtle].chroma=saveChroma,that.turtles.turtleList[turtle].stroke=saveStroke,that.turtles.turtleList[turtle].canvasAlpha=saveCanvasAlpha,that.turtles.turtleList[turtle].doSetHeading(saveOrientation),that.turtles.turtleList[turtle].penState=savePenState,that.justCounting[turtle].pop(),that.justMeasuring[turtle].pop(),that.suppressOutput[turtle]=saveSuppressStatus,that.butNotThese[turtle]={}}break;case"measureintervalscalar":var cblk=that.blocks.blockList[blk].connections[1];if(null==cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var saveSuppressStatus=that.suppressOutput[turtle],saveBoxes=JSON.stringify(that.boxes),saveTurtleHeaps=JSON.stringify(that.turtleHeaps[turtle]),saveX=that.turtles.turtleList[turtle].x,saveY=that.turtles.turtleList[turtle].y,saveColor=that.turtles.turtleList[turtle].color,saveValue=that.turtles.turtleList[turtle].value,saveChroma=that.turtles.turtleList[turtle].chroma,saveStroke=that.turtles.turtleList[turtle].stroke,saveCanvasAlpha=that.turtles.turtleList[turtle].canvasAlpha,saveOrientation=that.turtles.turtleList[turtle].orientation,savePenState=that.turtles.turtleList[turtle].penState;for(var b in that.suppressOutput[turtle]=!0,that.justCounting[turtle].push(!0),that.justMeasuring[turtle].push(!0),that.endOfClampSignals[turtle]){that.butNotThese[turtle][b]=[];for(var i=0;i<that.endOfClampSignals[turtle][b].length;i++)that.butNotThese[turtle][b].push(i)}var actionArgs=[],saveNoteCount=that.notesPlayed[turtle];that.turtles.turtleList[turtle].running=!0,that._runFromBlockNow(that,turtle,cblk,!0,actionArgs,that.turtles.turtleList[turtle].queue.length),0<that.firstPitch[turtle].length&&0<that.lastPitch[turtle].length?(that.blocks.blockList[blk].value=that._scalarDistance(turtle,last(that.firstPitch[turtle]),last(that.lastPitch[turtle])),that.firstPitch[turtle].pop(),that.lastPitch[turtle].pop()):(that.blocks.blockList[blk].value=0,that.errorMsg(_("You must use two pitch blocks when measuring an interval."))),that.notesPlayed[turtle]=saveNoteCount,that.boxes=JSON.parse(saveBoxes),that.turtleHeaps[turtle]=JSON.parse(saveTurtleHeaps),that.turtles.turtleList[turtle].doPenUp(),that.turtles.turtleList[turtle].doSetXY(saveX,saveY),that.turtles.turtleList[turtle].color=saveColor,that.turtles.turtleList[turtle].value=saveValue,that.turtles.turtleList[turtle].chroma=saveChroma,that.turtles.turtleList[turtle].stroke=saveStroke,that.turtles.turtleList[turtle].canvasAlpha=saveCanvasAlpha,that.turtles.turtleList[turtle].doSetHeading(saveOrientation),that.turtles.turtleList[turtle].penState=savePenState,that.justCounting[turtle].pop(),that.justMeasuring[turtle].pop(),that.suppressOutput[turtle]=saveSuppressStatus,that.butNotThese[turtle]={}}break;case"calc":var actionArgs=[],cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var name=that.parseArg(that,turtle,cblk,blk,receivedArg);actionArgs=receivedArg,name in that.actions?(that.turtles.turtleList[turtle].running=!0,that._runFromBlockNow(that,turtle,that.actions[name],!0,actionArgs,that.turtles.turtleList[turtle].queue.length),that.blocks.blockList[blk].value=that.returns.shift()):(that.errorMsg(NOACTIONERRORMSG,blk,name),that.blocks.blockList[blk].value=0)}break;case"namedcalc":var name=that.blocks.blockList[blk].privateData,actionArgs=[];actionArgs=receivedArg,name in that.actions?(that.turtles.turtleList[turtle].running=!0,that._runFromBlockNow(that,turtle,that.actions[name],!0,actionArgs,that.turtles.turtleList[turtle].queue.length),that.blocks.blockList[blk].value=that.returns.shift()):(that.errorMsg(NOACTIONERRORMSG,blk,name),that.blocks.blockList[blk].value=0);break;case"calcArg":var actionArgs=[];if(0<that.blocks.blockList[blk].argClampSlots.length)for(var i=0;i<that.blocks.blockList[blk].argClampSlots.length;i++){var t=that.parseArg(that,turtle,that.blocks.blockList[blk].connections[i+2],blk,receivedArg);actionArgs.push(t)}var cblk=that.blocks.blockList[blk].connections[1];if(null===cblk)that.errorMsg(NOINPUTERRORMSG,blk),that.blocks.blockList[blk].value=0;else{var name=that.parseArg(that,turtle,cblk,blk,receivedArg);name in that.actions?(that.turtles.turtleList[turtle].running=!0,that._runFromBlockNow(that,turtle,that.actions[name],!0,actionArgs,that.turtles.turtleList[turtle].queue.length),that.blocks.blockList[blk].value=that.returns.pop()):(that.errorMsg(NOACTIONERRORMSG,blk,name),that.blocks.blockList[blk].value=0)}break;case"namedcalcArg":var name=that.blocks.blockList[blk].privateData,actionArgs=[];if(0<that.blocks.blockList[blk].argClampSlots.length)for(var i=0;i<that.blocks.blockList[blk].argClampSlots.length;i++){var t=that.parseArg(that,turtle,that.blocks.blockList[blk].connections[i+1],blk,receivedArg);actionArgs.push(t)}name in that.actions?(that.turtles.turtleList[turtle].running=!0,that._runFromBlockNow(that,turtle,that.actions[name],!0,actionArgs,that.turtles.turtleList[turtle].queue.length),that.blocks.blockList[blk].value=that.returns.pop()):(that.errorMsg(NOACTIONERRORMSG,blk,name),that.blocks.blockList[blk].value=0);break;case"doArg":case"nameddoArg":return blk;case"returnValue":0<that.returns.length?that.blocks.blockList[blk].value=that.returns.pop():(console.log("WARNING: No return value."),that.blocks.blockList[blk].value=0);break;case"makeblock":that.showBlocks();var blockArgs=[null];if(0<that.blocks.blockList[blk].argClampSlots.length)for(var i=0;i<that.blocks.blockList[blk].argClampSlots.length;i++){var t=that.parseArg(that,turtle,that.blocks.blockList[blk].connections[i+2],blk,receivedArg);blockArgs.push(t)}var cblk=that.blocks.blockList[blk].connections[1],name=that.parseArg(that,turtle,cblk,blk,receivedArg),blockNumber=that.blocks.blockList.length,x=that.turtles.turtleX2screenX(that.turtles.turtleList[turtle].x),y=that.turtles.turtleY2screenY(that.turtles.turtleList[turtle].y);if(name===_("note")){switch(blockArgs.length){case 1:var p="sol",o=4,v=4;break;case 2:var p=blockArgs[1],o=4,v=4;break;case 3:var p=blockArgs[1],o=blockArgs[2],v=4;break;default:var p=blockArgs[1],o=blockArgs[2],v=blockArgs[3]}var newNote=[[0,"newnote",x,y,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:v}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:p}],0,0,[5]],[7,["number",{value:o}],0,0,[5]],[8,"hidden",0,0,[0,null]]];that.blocks.loadNewBlocks(newNote),that.blocks.blockList[blk].value=blockNumber}else if(name===_("start")){var newBlock=[[0,"start",x,y,[null,null,null]]];that.blocks.loadNewBlocks(newBlock),that.blocks.blockList[blk].value=blockNumber}else if(name===_("silence")){var newBlock=[[0,"rest2",x,y,[null,null]]];that.blocks.loadNewBlocks(newBlock),that.blocks.blockList[blk].value=blockNumber}else{var obj=that.blocks.palettes.getProtoNameAndPalette(name),protoblk=obj[0],protoName=obj[2];if(null===protoblk)that.errorMsg(_("Cannot find block")+" "+name);else{for(var newBlock=[[0,protoName,x,y,[null]]],i=1;i<that.blocks.protoBlockDict[protoblk].dockTypes.length;i++)i<blockArgs.length?("number"==typeof blockArgs[i]?(-1===["anyin","numberin"].indexOf(that.blocks.protoBlockDict[protoblk].dockTypes[i])&&that.errorMsg(_("Warning: block argument type mismatch")),newBlock.push([i,["number",{value:blockArgs[i]}],0,0,[0]])):"string"==typeof blockArgs[i]?(-1===["anyin","textin"].indexOf(that.blocks.protoBlockDict[protoblk].dockTypes[i])&&that.errorMsg(_("Warning: block argument type mismatch")),newBlock.push([i,["string",{value:blockArgs[i]}],0,0,[0]])):newBlock[0][4].push(null),newBlock[0][4].push(i)):newBlock[0][4].push(null);console.log(newBlock),that.blocks.loadNewBlocks(newBlock),that.blocks.blockList[blk].value=blockNumber}}break;default:that.blocks.blockList[blk].name in that.evalArgDict?eval(that.evalArgDict[that.blocks.blockList[blk].name]):console.log("ERROR: I do not know how to "+that.blocks.blockList[blk].name)}return that.blocks.blockList[blk].value}return blk},this._noteCounter=function(t,e){if(null==e)return 0;var i=this.suppressOutput[t],s=JSON.stringify(this.boxes),l=JSON.stringify(this.turtleHeaps[t]),o=this.turtles.turtleList[t].x,a=this.turtles.turtleList[t].y,n=this.turtles.turtleList[t].color,r=this.turtles.turtleList[t].value,c=this.turtles.turtleList[t].chroma,h=this.turtles.turtleList[t].stroke,u=this.turtles.turtleList[t].canvasAlpha,d=this.turtles.turtleList[t].orientation,f=this.turtles.turtleList[t].penState,p=this.whichNoteToCount[t],b=this.previousTurtleTime[t],m=this.turtleTime[t];for(var g in this.suppressOutput[t]=!0,this.justCounting[t].push(!0),this.endOfClampSignals[t]){this.butNotThese[t][g]=[];for(var k=0;k<this.endOfClampSignals[t][g].length;k++)this.butNotThese[t][g].push(k)}var v=this.notesPlayed[t];this.turtles.turtleList[t].running=!0,this.inNoteBlock[t]&&(this.whichNoteToCount[t]+=this.inNoteBlock[t].length),this._runFromBlockNow(this,t,e,!0,[],this.turtles.turtleList[t].queue.length);var y=rationalSum(this.notesPlayed[t],[-v[0],v[1]]);return this.notesPlayed[t]=v,this.boxes=JSON.parse(s),this.turtleHeaps[t]=JSON.parse(l),this.turtles.turtleList[t].doPenUp(),this.turtles.turtleList[t].doSetXY(o,a),this.turtles.turtleList[t].color=n,this.turtles.turtleList[t].value=r,this.turtles.turtleList[t].chroma=c,this.turtles.turtleList[t].stroke=h,this.turtles.turtleList[t].canvasAlpha=u,this.turtles.turtleList[t].doSetHeading(d),this.turtles.turtleList[t].penState=f,this.previousTurtleTime[t]=b,this.turtleTime[t]=m,this.whichNoteToCount[t]=p,this.justCounting[t].pop(),this.suppressOutput[t]=i,this.butNotThese[t]={},y},this._doWait=function(t,e){this.waitTimes[t]=1e3*Number(e)},this._doRandom=function(t,e){if("string"==typeof t||"string"==typeof e)return this.errorMsg(NANERRORMSG),this.stopTurtle=!0,0;if(e<t){var i=t;t=e,e=i}return Math.floor(Math.random()*(Number(e)-Number(t)+1)+Number(t))},this._doOneOf=function(t,e){return Math.random()<.5?t:e},this._doMod=function(t,e){return"string"==typeof t||"string"==typeof e?(this.errorMsg(NANERRORMSG),this.stopTurtle=!0,0):Number(t)%Number(e)},this._doSqrt=function(t){return"string"==typeof t?(this.errorMsg(NANERRORMSG),this.stopTurtle=!0,0):Math.sqrt(Number(t))},this._doPlus=function(t,e){if("string"!=typeof t&&"string"!=typeof e)return Number(t)+Number(e);if("string"==typeof t)var i=t;else i=t.toString();if("string"==typeof e)var s=e;else s=e.toString();return i+s},this._doMinus=function(t,e){return"string"==typeof t||"string"==typeof e?(this.errorMsg(NANERRORMSG),this.stopTurtle=!0,0):Number(t)-Number(e)},this._doMultiply=function(t,e){return"string"==typeof t||"string"==typeof e?(this.errorMsg(NANERRORMSG),this.stopTurtle=!0,0):Number(t)*Number(e)},this._doPower=function(t,e){return"string"==typeof t||"string"==typeof e?(this.errorMsg(NANERRORMSG),this.stopTurtle=!0,0):Math.pow(t,e)},this._doDivide=function(t,e){return"string"==typeof t||"string"==typeof e?(this.errorMsg(NANERRORMSG),this.stopTurtle=!0,0):0===Number(e)?(this.errorMsg(ZERODIVIDEERRORMSG),this.stopTurtle=!0,0):Number(t)/Number(e)},this.setBackgroundColor=function(t){if(-1===t)var e=platformColor.background;else e=this.turtles.turtleList[t].canvasColor;this.turtles.backgroundColor=e,this.turtles.makeBackground(this.turtles.isShrunk),this.svgOutput=""},this.setCameraID=function(t){this.cameraID=t},this.hideBlocks=function(t){this.blocks.palettes.hide(),this.blocks.hide(),this.refreshCanvas(),this.showBlocksAfterRun=void 0!==t&&t},this.showBlocks=function(){this.blocks.palettes.show(),this.blocks.show(),this.blocks.bringToTop(),this.refreshCanvas()},this._calculateInvert=function(t,e,i){for(var s=0,l=this.invertList[t].length,o=getNote(e,i,0,this.keySignature[t],this.moveable[t],null,this.errorMsg),a=pitchToNumber(o[0],o[1],this.keySignature[t])-this.pitchNumberOffset[t],n=l-1;-1<n;n--){var r=getNote(this.invertList[t][n][0],this.invertList[t][n][1],0,this.keySignature[t],this.moveable[t],null,this.errorMsg),c=pitchToNumber(r[0],r[1],this.keySignature[t])-this.pitchNumberOffset[t];if("even"===this.invertList[t][n][2])a+=2*(s+=c-a);else if("odd"===this.invertList[t][n][2])a+=2*(s+=c-a+.5);else{var h=this._scalarDistance(t,c,a),u=this._addScalarTransposition(t,r[0],r[1],-h),d=pitchToNumber(u[0],u[1],this.keySignature[t])-this.pitchNumberOffset[t];s+=(d-a)/2,a=d}}return s},this._addScalarTransposition=function(t,e,i,s){if(0<s){var l=getNote(e,i,0,this.keySignature[t],this.moveable[t],null,this.errorMsg,this.synth.inTemperament);if("custom"==this.synth.inTemperament){var o=getStepSizeUp(this.keySignature[t],l[0],s,this.synth.inTemperament);l=getNote(l[0],l[1],o,this.keySignature[t],this.moveable[t],null,this.errorMsg,this.synth.inTemperament)}else for(var a=0;a<s;a++){o=getStepSizeUp(this.keySignature[t],l[0]);l=getNote(l[0],l[1],o,this.keySignature[t],this.moveable[t],null,this.errorMsg,this.synth.inTemperament)}}else if(s<0){(l=getNote(e,i,0,this.keySignature[t],this.moveable[t],null,this.errorMsg,this.synth.inTemperament))[0];if("custom"==this.synth.inTemperament){o=getStepSizeDown(this.keySignature[t],l[0],s,this.synth.inTemperament);l=getNote(l[0],l[1],o,this.keySignature[t],this.moveable[t],null,this.errorMsg,this.synth.inTemperament)}else for(a=0;a<-s;a++){o=getStepSizeDown(this.keySignature[t],l[0]);l=getNote(l[0],l[1],o,this.keySignature[t],this.moveable[t],null,this.errorMsg,this.synth.inTemperament)}}else l=[e,i];return l},this._scalarDistance=function(t,e,i){if(i===e)return 0;if(e<i){for(var s=numberToPitch(e+this.pitchNumberOffset[t]),l=0,o=e+this.pitchNumberOffset[t];l<100&&(l+=1,!((o+=getStepSizeUp(this.keySignature[t],s[0]))>=i+this.pitchNumberOffset[t]));)s=numberToPitch(o);return l}for(s=numberToPitch(i+this.pitchNumberOffset[t]),l=0,o=i+this.pitchNumberOffset[t];l<100&&(l+=1,!((o+=getStepSizeUp(this.keySignature[t],s[0]))>=e+this.pitchNumberOffset[t]));)s=numberToPitch(o);return-l},this._prepSynths=function(){for(var t=0;t<this.turtles.turtleList.length;t++){for(var e in t in instruments||(instruments[t]={},instrumentsFilters[t]={},instrumentsEffects[t]={}),"electronic synth"in instruments[t]||this.synth.createDefaultSynth(t),instruments[0])e in instruments[t]||(this.synth.loadSynth(t,e),e in instrumentsFilters[0]&&(instrumentsFilters[t][e]=instrumentsFilters[0][e]),e in instrumentsEffects[0]&&(instrumentsEffects[t][e]=instrumentsEffects[0][e]));this.synthVolume[t]={"electronic synth":[DEFAULTVOLUME],noise1:[DEFAULTVOLUME],noise2:[DEFAULTVOLUME],noise3:[DEFAULTVOLUME]}}if(!this.suppressOutput[t]){this._setMasterVolume(DEFAULTVOLUME);for(t=0;t<this.turtles.turtleList.length;t++)for(var i in this.synthVolume[t])this.setSynthVolume(t,i,DEFAULTVOLUME)}},this.clearNoteParams=function(t,e,i){this.oscList[t][e]=[],this.noteBeat[t][e]=[],this.noteBeatValues[t][e]=[],this.noteValue[t][e]=null,this.notePitches[t][e]=[],this.noteOctaves[t][e]=[],this.noteCents[t][e]=[],this.noteHertz[t][e]=[],this.embeddedGraphics[t][e]=[],this.noteDrums[t][e]=null!==i?i:[]},this.updateNotation=function(t,e,i,s,l,o){if(!this.optimize){null==o&&(o=!0);var a=1/e,n=(this.notesPlayed[i][0]/this.notesPlayed[i][1]-this.pickup[i]-a)*this.noteValuePerBeat[i]%this.beatsPerMeasure[i]/this.noteValuePerBeat[i],r=this.beatsPerMeasure[i]/this.noteValuePerBeat[i]-n;if(o&&r<a){var c=a-r,h=r,u=this.beatsPerMeasure[i]/this.noteValuePerBeat[i];console.log("splitting note across measure boundary.");var d=rationalToFraction(c);if(0<h){for(var f=0;u<h;)f+=1,h-=u;var p=rationalToFraction(h);if(this.updateNotation(t,p[1]/p[0],i,s,l,!1),0<f||0<d[0]){"R"!==t[0]&&(this.notationInsertTie(i),this.notationDrumStaging[i].push("tie"));p=rationalToFraction(1/u)}for(;0<f;)f-=1,this.updateNotation(t,p[1]/p[0],i,s,l,!1),0<d[0]&&"R"!==t[0]&&(this.notationInsertTie(i),this.notationDrumStaging[i].push("tie"))}0<d[0]&&this.updateNotation(t,d[1]/d[0],i,s,l,!1)}else{d=durationToNoteValue(e);if(this.turtles.turtleList[i].drum&&(t="c2"),this.notationStaging[i].push([t,d[0],d[1],d[2],d[3],s,0<this.staccato[i].length&&0<last(this.staccato[i])]),0===l.length)this.notationDrumStaging[i].push([["R"],d[0],d[1],d[2],d[3],s,!1]);else if(-1===["noise1","noise2","noise3"].indexOf(l[0])){var b=getDrumSymbol(l[0]);this.notationDrumStaging[i].push([[b],d[0],d[1],d[2],d[3],s,!1])}if(this.pickupPoint[i]=null,0<this.markup[i].length){var m="";for(f=0;f<this.markup[i].length;f++)m+=this.markup[i][f],f<this.markup[i].length-1&&(m+=" ");this.notationMarkup(i,m,!0),this.markup[i]=[]}if("object"===_typeof(t)){m="";try{for(f=0;f<t.length;f++)if("number"==typeof t[f]&&(m="")){m=toFixed2(t[f]);break}0<m.length&&this.notationMarkup(i,m,!1)}catch(t){console.log(t)}}}}},this.notationVoices=function(t,e){switch(e){case 1:this.notationStaging[t].push("voice one");break;case 2:this.notationStaging[t].push("voice two");break;case 3:this.notationStaging[t].push("voice three");break;case 4:this.notationStaging[t].push("voice four");break;default:this.notationStaging[t].push("one voice")}this.pickupPoint[t]=null},this.notationMarkup=function(t,e,i){i?this.notationStaging[t].push("markdown",e):this.notationStaging[t].push("markup",e),this.pickupPoint[t]=null},this.notationKey=function(t,e,i){this.notationStaging[t].push("key",e,i),this.pickupPoint[t]=null},this.notationMeter=function(t,e,i){if(null!=this.pickupPoint[t]){var s=this.notationStaging[t].length-this.pickupPoint[t],l=[];for(var o in s)l.push(this.notationStaging[t].pop());for(var o in this.notationStaging[t].push("meter",e,i),s)this.notationStaging[t].push(l.pop())}else this.notationStaging[t].push("meter",e,i);this.pickupPoint[t]=null},this.notationSwing=function(t){this.notationStaging[t].push("swing")},this.notationTempo=function(t,e,i){var s=convertFactor(i);null!==s?this.notationStaging[t].push("tempo",e,s):(obj=rationalToFraction(factor),this.errorMsg(_("Lilypond cannot process tempo of ")+obj[0]+"/"+obj[1]+" = "+e))},this.notationPickup=function(t,e){if(0!==e){var i=this.notationStaging[t].length,s=convertFactor(e);if(null!==s)this.notationStaging[t].push("pickup",s),this.pickupPOW2[t]=!0;else{this.runningLilypond&&(obj=rationalToFraction(e),this.errorMsg(_("Lilypond cannot process pickup of ")+obj[0]+"/"+obj[1])),obj=rationalToFraction(1-e);for(var l=0;l<obj[0];l++)this.updateNotation(["R"],obj[1],t,!1,"")}this.pickupPoint[t]=i}else console.log("ignoring pickup of 0")},this.notationHarmonic=function(t){this.notationStaging.push("harmonic"),this.pickupPoint[t]=null},this.notationLineBreak=function(t){this.pickupPoint[t]=null},this.notationBeginArticulation=function(t){this.notationStaging[t].push("begin articulation"),this.pickupPoint[t]=null},this.notationEndArticulation=function(t){this.notationStaging[t].push("end articulation"),this.pickupPoint[t]=null},this.notationBeginCrescendo=function(t,e){0<e?this.notationStaging[t].push("begin crescendo"):this.notationStaging[t].push("begin decrescendo"),this.pickupPoint[t]=null},this.notationEndCrescendo=function(t,e){0<e?this.notationStaging[t].push("end crescendo"):this.notationStaging[t].push("end decrescendo"),this.pickupPoint[t]=null},this.notationBeginSlur=function(t){this.notationStaging[t].push("begin slur"),this.pickupPoint[t]=null},this.notationEndSlur=function(t){this.notationStaging[t].push("end slur"),this.pickupPoint[t]=null},this.notationInsertTie=function(t){this.notationStaging[t].push("tie"),this.pickupPoint[t]=null},this.notationRemoveTie=function(t){this.notationStaging[t].pop(),this.pickupPoint[t]=null},this.notationBeginHarmonics=function(t){this.notationStaging[t].push("begin harmonics"),this.pickupPoint[t]=null},this.notationEndHarmonics=function(t){this.notationStaging[t].push("end harmonics"),this.pickupPoint[t]=null}}function blockIsMacro(t){return-1<["accidental","action","actionhelp","amsynthhelp","archelp","articulation","articulationhelp","augmented1","augmented2","augmented3","augmented4","augmented5","augmented6","augmented7","augmented8","backward","beatvaluehelp","bottle","bottomposhelp","box1","box1help","box2","box2help","bpmhelp","broadcasthelp","bubbles","cat","chine","chordI","chordIV","chordV","chorushelp","clang","clap","clickhelp","cowbell","crash","crescendo","cricket","cup","custompitch","darbuka","decrescendo","decrescendohelp","definemode","deltapitchhelp","diminished2","diminished3","diminished4","diminished5","diminished6","diminished7","diminished8","dishelp","dohelp","dog","dothelp","doublyhelp","downsixthinterval","downthirdinterval","downmajor3","downmajor6","downminor3","downminor6","downsixth","downthird","drift","duck","duplicatenotes","duphelp","effectshelp","eihelp","eighthNote","elapsedhelp","elapsednotes2","elifhelp","everybeathelp","f","ff","fff","fill","fillhelp","fingercymbals","fifth",,"fifthinterval","flat","floortom","fmsynthhelp","foreverhelp","forwardhelp","fourth","fourthinterval","glide","halfNote","harmonic","harmonic2","harmonichelp","hihat","hollowline","ifhelp","interval","intervalhelp","invert","invert1","inverthelp","kick","lrhelp","major2","major3","major6","major7","matrix","matrixcmajor","matrixgmajor","meter","meterwidget","mf","midi","minor2","minor3","minor6","minor7","mousebuttonhelp","movable","movablehelp","mp","multiplybeatfactor","multiplybeathelp","musickeyboard2","musickeyboardja","neighbor","neighbor2","neighborhelp","neighbor2help","newnote","newslur","newstaccato","newswing","newswing2","swinghelp","note","note1","note2","note3","note4","note5","note6","note7","notecounterhelp","octave","oneOf","oneofhelp","osctime","osctimehelp","p","perfect4","perfect5","perfect8","phaserhelp","pickup","pitch2","pitchdrummatrix","pitchnumberhelp","pitchslider","pitchstaircase","playdrum","playeffect","playnoise","pp","ppp","quarterNote","randomhelp","registerhelp","repeathelp","rest2","rhythm2","rhythmicdot","rhythmicdot2","rhythmruler2","rhythmruler3","ridebell","sawtooth","second","secondinterval","semitoneinterval","setbpm","setbpm2","setbpm3","setdrum","setdrumhelp","setdrumvolume","setkey2","setnotevolume2","setsynthvolume","setmasterbpm","setmasterbpm2","settimbre","settimbrehelp","settemperament","setscalartransposition","scalartranshelp","settransposition","setvoice","seventh","seventhinterval","sharp","sine","sixteenthNote","sixth","sixthinterval","sixtyfourthNote","skipnotes","skiphelp","slap","slur","slurhelp","snare","splash","square","staccato","staccatohelp","startdrum","status","storebox1","storebox2","stuplet","stuplet3","stuplet5","stuplet7","swing","switch","switchhelp","temperament","tempo","third","thirtysecondNote","tie","tiehelp","timbre","tom","tone","tremolo","tremolohelp","triangle","trianglebell","tuplet3","tuplet4","turtleshell","unison","unisoninterval","untilhelp","vibrato","vibratohelp","waitforhelp","whilehelp","wholeNote","black","white","xyhelp","red","orange","yellow","green","blue","purple"].indexOf(t)}function getMacroExpansion(t,e,i){var s=[[0,"accidental",e,i,[null,11,1,10]],[1,"newnote",e,i,[0,2,5,9]],[2,"divide",0,0,[1,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[1,6]],[6,"pitch",0,0,[5,7,8,null]],[7,["solfege",{value:"sol"}],0,0,[6]],[8,["number",{value:4}],0,0,[6]],[9,"hidden",0,0,[1,null]],[10,"hidden",0,0,[0,null]],[11,["accidentalname",{value:"natural "}],0,0,[0]]],l=[[0,"action",e,i,[null,1,2,null]],[1,["text",{value:_("action")}],0,0,[0]],[2,"hidden",0,0,[0,null]]],o=[[0,"action",e,i,[null,31,1,null]],[1,"settimbre",0,0,[0,2,4,3]],[2,["voicename",{value:"guitar"}],0,0,[1]],[3,"hidden",0,0,[1,null]],[4,"newnote",0,0,[1,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"sol"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,13]],[13,"newnote",0,0,[12,14,17,21]],[14,"divide",0,0,[13,15,16]],[15,["number",{value:1}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"vspace",0,0,[13,18]],[18,"pitch",0,0,[17,19,20,null]],[19,["solfege",{value:"mi"}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"hidden",0,0,[13,22]],[22,"newnote",0,0,[21,23,26,30]],[23,"divide",0,0,[22,24,25]],[24,["number",{value:1}],0,0,[23]],[25,["number",{value:2}],0,0,[23]],[26,"vspace",0,0,[22,27]],[27,"pitch",0,0,[26,28,29,null]],[28,["solfege",{value:"sol"}],0,0,[27]],[29,["number",{value:4}],0,0,[27]],[30,"hidden",0,0,[22,null]],[31,["text",{value:_("action")}],0,0,[0]]],a=[[0,"everybeatdo",e,i,[null,1,null]],[1,["text",{value:"action"}],0,0,[0]],[2,["action",{collapsed:!1}],e,i+100,[null,3,4,null]],[3,["text",{value:"action"}],0,0,[2]],[4,"hidden",0,0,[2,5]],[5,"arc",0,0,[4,8,7,null]],[6,["number",{value:360}],0,0,[8]],[7,["number",{value:100}],0,0,[5]],[8,"multiply",0,0,[5,9,6]],[9,"mynotevalue",0,0,[8]]],n=[[0,["newnote",{collapsed:!1}],0,0,[9,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:2}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]],[9,"settimbre",e,i+200,[null,10,0,11]],[10,["voicename",{value:"custom"}],0,0,[9]],[11,"hidden",0,0,[9,null]],[12,["timbre",{collapsed:!1}],e,i,[null,13,15,14]],[13,["text",{value:"custom"}],0,0,[12]],[14,"hiddennoflow",0,0,[12,null]],[15,"amsynth",0,0,[12,16,null]],[16,["number",{value:1}],0,0,[15]]],r=[[0,"articulation",e,i,[null,1,null,2]],[1,["number",{value:25}],0,0,[0]],[2,"hidden",0,0,[0,null]]],c=[[0,"articulation",e,i,[null,31,1,null]],[1,"settimbre",0,0,[0,2,4,3]],[2,["voicename",{value:"guitar"}],0,0,[1]],[3,"hidden",0,0,[1,null]],[4,"newnote",0,0,[1,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"sol"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,13]],[13,"newnote",0,0,[12,14,17,21]],[14,"divide",0,0,[13,15,16]],[15,["number",{value:1}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"vspace",0,0,[13,18]],[18,"pitch",0,0,[17,19,20,null]],[19,["solfege",{value:"mi"}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"hidden",0,0,[13,22]],[22,"newnote",0,0,[21,23,26,30]],[23,"divide",0,0,[22,24,25]],[24,["number",{value:1}],0,0,[23]],[25,["number",{value:2}],0,0,[23]],[26,"vspace",0,0,[22,27]],[27,"pitch",0,0,[26,28,29,null]],[28,["solfege",{value:"sol"}],0,0,[27]],[29,["number",{value:4}],0,0,[27]],[30,"hidden",0,0,[22,null]],[31,["number",{value:25}],0,0,[0]]],h=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 1"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],u=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 2"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],d=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 3"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],f=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 4"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],p=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 5"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],b=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 6"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],m=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 7"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],g=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"augmented 8"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],k=[[0,"backward",e,i,[null,1,null]],[1,"hidden",0,0,[0,null]]],v=[[0,"setheading",e,i,[null,2,null]],[1,"beatvalue",0,0,[2]],[2,"multiply",0,0,[0,1,3]],[3,["number",{value:90}],0,0,[2]]],y=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"bottle"}],0,0,[0]]],T=[[0,"setheading",e,i,[2,1,14]],[1,["number",{value:0}],0,0,[0]],[2,["start",{collapsed:!1}],e,i,[null,0,null]],[3,"if",0,0,[4,13,8,null]],[4,"forward",0,0,[14,5,3]],[5,["number",{value:10}],0,0,[4]],[6,"setxy",0,0,[8,7,10,9]],[7,["number",{value:0}],0,0,[6]],[8,"penup",0,0,[3,6]],[9,"pendown",0,0,[6,null]],[10,"bottompos",0,0,[6]],[11,"toppos",0,0,[13]],[12,"y",0,0,[13]],[13,"greater",0,0,[3,12,11]],[14,"forever",0,0,[0,4,null]]],L=[[0,["namedbox",{value:_("box1")}],e,i,[null]]],w=[[0,["storein2",{value:"box1"}],e,i,[null,1,null]],[1,["number",{value:1}],0,0,[0]],[2,["namedbox",{value:"box1"}],0,0,[11]],[3,"incrementOne",0,0,[10,4,null]],[4,["namedbox",{value:"box1"}],0,0,[3]],[5,["nameddo",{value:_("action")}],0,0,[10,null]],[6,["nameddo",{value:_("action")}],0,0,[8,null]],[7,"backward",0,0,[10,8,9]],[8,"hidden",0,0,[7,6]],[9,"hidden",0,0,[7,null]],[10,"ifthenelse",e,i+100,[null,11,5,7,3]],[11,"equal",0,0,[10,2,12]],[12,["number",{value:1}],0,0,[11]]],B=[[0,["namedbox",{value:_("box2")}],e,i,[null]]],x=[[0,["nameddo",{value:_("action")}],e,i,[1,null]],[1,"if",e,i+100,[null,7,0,2]],[2,"increment",0,0,[1,3,5,null]],[3,["namedbox",{value:"box2"}],0,0,[2]],[4,["namedbox",{value:"box2"}],0,0,[7]],[5,["number",{value:4}],0,0,[2]],[6,["number",{value:4}],0,0,[7]],[7,"greater",0,0,[1,4,6]],[8,["storein2",{value:"box2"}],e,i,[null,9,null]],[9,["number",{value:1}],0,0,[8]]],S=[[0,"setbpm",e,i,[null,1,null,2]],[1,["number",{value:90}],0,0,[0]],[2,"hidden",0,0,[0,null]]],C=[[0,"setbpm2",e,i,[null,1,3,2,6]],[1,["number",{value:90}],0,0,[0]],[2,"vspace",0,0,[0,null]],[3,"divide",0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"hidden",0,0,[0,null]]],A=[[0,"setbpm3",e,i,[null,1,2,5]],[1,["number",{value:90}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[0,null]]],N=[[0,["start",{collapsed:!1}],e,i,[null,1,null]],[1,"setbpm3",0,0,[0,2,3,6]],[2,["number",{value:30}],0,0,[1]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"vspace",0,0,[1,7]],[7,["newnote",{collapsed:!1}],0,0,[6,8,11,15]],[8,"divide",0,0,[7,9,10]],[9,["number",{value:1}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"vspace",0,0,[7,12]],[12,"pitch",0,0,[11,13,14,null]],[13,["solfege",{value:"sol"}],0,0,[12]],[14,["number",{value:4}],0,0,[12]],[15,"hidden",0,0,[7,null]]],P=[[0,"listen",e,i,[null,7,1,null]],[1,["text",{value:"action"}],0,0,[0]],[2,"listen",e,i+100,[null,3,4,null]],[3,["text",{value:"event"}],0,0,[2]],[4,["text",{value:"action"}],0,0,[2]],[5,"dispatch",e,i+200,[null,6,null]],[6,["text",{value:"event"}],0,0,[5]],[7,"myclick",0,0,[0]]],I=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"bubbles"}],0,0,[0]]],M=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"cat"}],0,0,[0]]],E=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"chime"}],0,0,[0]]],O=[[0,"interval",e,i,[null,1,3,2]],[1,["number",{value:4}],0,0,[0]],[2,"hidden",0,0,[0,null]],[3,"interval",0,0,[0,4,6,5]],[4,["number",{value:2}],0,0,[3]],[5,"hidden",0,0,[3,null]],[6,["newnote",{collapsed:!1}],0,0,[3,7,10,14]],[7,"divide",0,0,[6,8,9]],[8,["number",{value:1}],0,0,[7]],[9,["number",{value:1}],0,0,[7]],[10,"vspace",0,0,[6,11]],[11,"pitch",0,0,[10,12,13,null]],[12,["solfege",{value:"do"}],0,0,[11]],[13,["number",{value:4}],0,0,[11]],[14,"hidden",0,0,[6,null]]],D=[[0,"interval",e,i,[null,1,3,2]],[1,["number",{value:5}],0,0,[0]],[2,"hidden",0,0,[0,null]],[3,"interval",0,0,[0,4,6,5]],[4,["number",{value:3}],0,0,[3]],[5,"hidden",0,0,[3,null]],[6,["newnote",{collapsed:!1}],0,0,[3,7,10,14]],[7,"divide",0,0,[6,8,9]],[8,["number",{value:1}],0,0,[7]],[9,["number",{value:1}],0,0,[7]],[10,"vspace",0,0,[6,11]],[11,"pitch",0,0,[10,12,13,null]],[12,["solfege",{value:"do"}],0,0,[11]],[13,["number",{value:4}],0,0,[11]],[14,"hidden",0,0,[6,null]]],R=[[0,"interval",e,i,[null,1,3,2]],[1,["number",{value:3}],0,0,[0]],[2,"hidden",0,0,[0,null]],[3,"interval",0,0,[0,4,6,5]],[4,["number",{value:2}],0,0,[3]],[5,"hidden",0,0,[3,null]],[6,["newnote",{collapsed:!1}],0,0,[3,7,10,14]],[7,"divide",0,0,[6,8,9]],[8,["number",{value:1}],0,0,[7]],[9,["number",{value:1}],0,0,[7]],[10,"vspace",0,0,[6,11]],[11,"pitch",0,0,[10,12,13,null]],[12,["solfege",{value:"re"}],0,0,[11]],[13,["number",{value:4}],0,0,[11]],[14,"hidden",0,0,[6,null]]],W=[[0,"chorus",e,i,[null,1,2,3,4,null]],[1,["number",{value:1.5}],0,0,[0]],[2,["number",{value:3.5}],0,0,[0]],[3,["number",{value:70}],0,0,[0]],[4,["newnote",{collapsed:!1}],0,0,[0,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"sol"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,null]]],H=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"clang"}],0,0,[0]]],F=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"clap"}],0,0,[0]]],j=[[0,["start",{collapsed:!1}],e,i,[null,1,null]],[1,"setturtlename2",0,0,[0,2,3]],[2,["text",{value:"snare drum"}],0,0,[1]],[3,"listen",0,0,[1,5,4,null]],[4,["text",{value:"action"}],0,0,[3]],[5,"myclick",0,0,[3]],[6,["action",{collapsed:!1}],e,i+200,[null,7,8,null]],[7,["text",{value:"action"}],0,0,[6]],[8,"hidden",0,0,[6,9]],[9,["newnote",{collapsed:!1}],0,0,[8,10,13,15]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"playdrum",0,0,[13,16,null]],[15,"hidden",0,0,[9,null]],[16,"turtlename",0,0,[14]]],V=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"cow bell"}],0,0,[0]]],U=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"crash"}],0,0,[0]]],G=[[0,"crescendo",e,i,[null,1,null,2]],[1,["number",{value:5}],0,0,[0]],[2,"hidden",0,0,[0,null]]],z=[[0,"crescendo",e,i,[null,31,1,null]],[1,"settimbre",0,0,[0,2,4,3]],[2,["voicename",{value:"guitar"}],0,0,[1]],[3,"hidden",0,0,[1,null]],[4,"newnote",0,0,[1,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"sol"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,13]],[13,"newnote",0,0,[12,14,17,21]],[14,"divide",0,0,[13,15,16]],[15,["number",{value:1}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"vspace",0,0,[13,18]],[18,"pitch",0,0,[17,19,20,null]],[19,["solfege",{value:"mi"}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"hidden",0,0,[13,22]],[22,"newnote",0,0,[21,23,26,30]],[23,"divide",0,0,[22,24,25]],[24,["number",{value:1}],0,0,[23]],[25,["number",{value:2}],0,0,[23]],[26,"vspace",0,0,[22,27]],[27,"pitch",0,0,[26,28,29,null]],[28,["solfege",{value:"sol"}],0,0,[27]],[29,["number",{value:4}],0,0,[27]],[30,"hidden",0,0,[22,null]],[31,["number",{value:5}],0,0,[0]]],q=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"cricket"}],0,0,[0]]],Y=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"cup drum"}],0,0,[0]]],X=[[0,"pitch",e,i,[null,1,2,null]],[1,["customNote",{value:"C(+0)"}],0,0,[0]],[2,["number",{value:4}],0,0,[0]]],K=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"darbuka drum"}],0,0,[0]]],Q=[[0,"decrescendo",e,i,[null,1,null,2]],[1,["number",{value:5}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Z=[[0,"decrescendo",e,i,[null,31,1,null]],[1,"settimbre",0,0,[0,2,4,3]],[2,["voicename",{value:"guitar"}],0,0,[1]],[3,"hidden",0,0,[1,null]],[4,"newnote",0,0,[1,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"sol"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,13]],[13,"newnote",0,0,[12,14,17,21]],[14,"divide",0,0,[13,15,16]],[15,["number",{value:1}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"vspace",0,0,[13,18]],[18,"pitch",0,0,[17,19,20,null]],[19,["solfege",{value:"mi"}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"hidden",0,0,[13,22]],[22,"newnote",0,0,[21,23,26,30]],[23,"divide",0,0,[22,24,25]],[24,["number",{value:1}],0,0,[23]],[25,["number",{value:2}],0,0,[23]],[26,"vspace",0,0,[22,27]],[27,"pitch",0,0,[26,28,29,null]],[28,["solfege",{value:"sol"}],0,0,[27]],[29,["number",{value:4}],0,0,[27]],[30,"hidden",0,0,[22,null]],[31,["number",{value:5}],0,0,[0]]],J=[[0,"definemode",e,i,[null,1,2,16]],[1,["modename",{value:"custom"}],0,0,[0]],[2,"pitchnumber",0,0,[0,3,4]],[3,["number",{value:0}],0,0,[2]],[4,"pitchnumber",0,0,[2,5,6]],[5,["number",{value:2}],0,0,[4]],[6,"pitchnumber",0,0,[4,7,8]],[7,["number",{value:4}],0,0,[6]],[8,"pitchnumber",0,0,[6,9,10]],[9,["number",{value:5}],0,0,[8]],[10,"pitchnumber",0,0,[8,11,12]],[11,["number",{value:7}],0,0,[10]],[12,"pitchnumber",0,0,[10,13,14]],[13,["number",{value:9}],0,0,[12]],[14,"pitchnumber",0,0,[12,15,null]],[15,["number",{value:11}],0,0,[14]],[16,"hidden",0,0,[0,null]]],$=[[0,["action",{collapsed:!1}],e,i+100,[null,1,2,null]],[1,["text",{value:"action"}],0,0,[0]],[2,"hidden",0,0,[0,3]],[3,"forward",533,361,[2,6,null]],[4,"everybeatdo",e,i,[null,5,null]],[5,["text",{value:"action"}],0,0,[4]],[6,"deltapitch",0,0,[3]]],tt=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"diminished 2"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],et=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"diminished 3"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],it=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"diminished 4"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],st=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"diminished 5"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],lt=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"diminished 6"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ot=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"diminished 7"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],at=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"diminished 8"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],nt=[[0,"dis",e,i,[null,11,1,10]],[1,"newnote",e,i,[0,2,5,9]],[2,"divide",0,0,[1,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[1,6]],[6,"pitch",0,0,[5,7,8,null]],[7,["solfege",{value:"sol"}],0,0,[6]],[8,["number",{value:4}],0,0,[6]],[9,"hidden",0,0,[1,null]],[10,"hidden",0,0,[0,null]],[11,["number",{value:40}],0,0,[0]]],rt=[[0,"do",e,i,[null,2,3]],[1,["text",{value:"part 2"}],790,122,[2]],[2,"oneOf",0,0,[0,4,1]],[3,"vspace",0,0,[0,null]],[4,["text",{value:"part 1"}],0,0,[2]]],ct=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"dog"}],0,0,[0]]],ht=[[0,["newnote",{collapsed:!1}],0,0,[18,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]],[9,["newnote",{collapsed:!1}],0,0,[20,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:3}],0,0,[10]],[12,["number",{value:8}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"sol"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,"rhythmicdot2",e,i,[null,19,0,20]],[19,["number",{value:1}],0,0,[18]],[20,"hidden",0,0,[18,9]]],ut=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,8,3]],[2,["intervalname",{value:"augmented 5"}],0,0,[8]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,9]],[7,"hidden",0,0,[0,18]],[8,"doubly",0,0,[1,2]],[9,["newnote",{collapsed:!1}],0,0,[6,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"sol"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,["newnote",{collapsed:!1}],0,0,[7,19,22,26]],[19,"divide",0,0,[18,20,21]],[20,["number",{value:1}],0,0,[19]],[21,["number",{value:4}],0,0,[19]],[22,"vspace",0,0,[18,23]],[23,"pitch",0,0,[22,24,25,27]],[24,["solfege",{value:"sol"}],0,0,[23]],[25,["number",{value:4}],0,0,[23]],[26,"hidden",0,0,[18,null]],[27,"pitch",0,0,[23,28,29,null]],[28,["solfege",{value:"mi"}],0,0,[27]],[29,["number",{value:5}],0,0,[27]]],dt=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"minus",0,0,[0,8,3]],[2,["intervalname",{value:"major 3"}],0,0,[8]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]],[8,"neg",0,0,[1,2]]],ft=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"minus",0,0,[0,8,3]],[2,["intervalname",{value:"major 6"}],0,0,[8]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]],[8,"neg",0,0,[1,2]]],pt=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"minus",0,0,[0,8,3]],[2,["intervalname",{value:"minor 3"}],0,0,[8]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]],[8,"neg",0,0,[1,2]]],bt=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"minus",0,0,[0,8,3]],[2,["intervalname",{value:"minor 6"}],0,0,[8]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]],[8,"neg",0,0,[1,2]]],mt=[[0,"interval",e,i,[null,1,6,8]],[1,"minus",0,0,[0,2,3]],[2,["number",{value:-5}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],gt=[[0,"interval",e,i,[null,1,6,8]],[1,"minus",0,0,[0,2,3]],[2,["number",{value:-2}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],kt=[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"minus",0,0,[0,2,3]],[2,["number",{value:-5}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],vt=[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"minus",0,0,[0,2,3]],[2,["number",{value:-2}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],yt=[[0,"rhythmicdot",e,i,[null,null,1]],[1,"hidden",0,0,[0,null]]],_t=[[0,"rhythmicdot2",e,i,[null,1,null,2]],[1,["number",{value:1}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Tt=[[0,"drift",e,i,[null,null,1]],[1,"hidden",0,0,[0,null]]],Lt=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"duck"}],0,0,[0]]],wt=[[0,"duosynth",e,i,[15,1,2,null]],[1,["number",{value:10}],0,0,[0]],[2,["number",{value:5}],0,0,[0]],[3,["newnote",{collapsed:!1}],0,0,[12,4,7,11]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:2}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"pitch",0,0,[7,9,10,null]],[9,["solfege",{value:"sol"}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"hidden",0,0,[3,null]],[12,"settimbre",e,i+200,[null,13,3,14]],[13,["voicename",{value:"custom"}],0,0,[12]],[14,"hidden",0,0,[12,null]],[15,["timbre",{collapsed:!1}],e,i,[null,16,0,17]],[16,["text",{value:"custom"}],0,0,[15]],[17,"hiddennoflow",0,0,[15,null]]],Bt=[[0,"duplicatenotes",e,i,[null,1,null,2]],[1,["number",{value:2}],0,0,[0]],[2,"hidden",0,0,[0,null]]],xt=[[0,["newnote",{collapsed:!1}],0,0,[18,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,9]],[9,["newnote",{collapsed:!1}],0,0,[8,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"mi"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,"duplicatenotes",e,i,[null,19,0,20]],[19,["number",{value:2}],0,0,[18]],[20,"hidden",0,0,[18,null]],[21,["newnote",{collapsed:!1}],e,i+400,[null,22,25,29]],[22,"divide",0,0,[21,23,24]],[23,["number",{value:1}],0,0,[22]],[24,["number",{value:4}],0,0,[22]],[25,"vspace",0,0,[21,26]],[26,"pitch",0,0,[25,27,28,null]],[27,["solfege",{value:"sol"}],0,0,[26]],[28,["number",{value:4}],0,0,[26]],[29,"hidden",0,0,[21,30]],[30,["newnote",{collapsed:!1}],0,0,[29,31,34,38]],[31,"divide",0,0,[30,32,33]],[32,["number",{value:1}],0,0,[31]],[33,["number",{value:4}],0,0,[31]],[34,"vspace",0,0,[30,35]],[35,"pitch",0,0,[34,36,37,null]],[36,["solfege",{value:"sol"}],0,0,[35]],[37,["number",{value:4}],0,0,[35]],[38,"hidden",0,0,[30,39]],[39,["newnote",{collapsed:!1}],0,0,[38,40,43,47]],[40,"divide",0,0,[39,41,42]],[41,["number",{value:1}],0,0,[40]],[42,["number",{value:4}],0,0,[40]],[43,"vspace",0,0,[39,44]],[44,"pitch",0,0,[43,45,46,null]],[45,["solfege",{value:"mi"}],0,0,[44]],[46,["number",{value:4}],0,0,[44]],[47,"hidden",0,0,[39,48]],[48,["newnote",{collapsed:!1}],0,0,[47,49,52,56]],[49,"divide",0,0,[48,50,51]],[50,["number",{value:1}],0,0,[49]],[51,["number",{value:4}],0,0,[49]],[52,"vspace",0,0,[48,53]],[53,"pitch",0,0,[52,54,55,null]],[54,["solfege",{value:"mi"}],0,0,[53]],[55,["number",{value:4}],0,0,[53]],[56,"hidden",0,0,[48,null]]],St=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"playdrum",0,0,[4,6,null]],[6,["drumname",{value:_("duck")}],0,0,[5]],[7,"hidden",0,0,[0,null]]],Ct=[[0,"newnote",e,i,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["eastindiansolfege",{value:"pa"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]]],At=[[0,["newnote",{collapsed:!1}],0,0,[6,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,8]],[5,"hidden",0,0,[0,null]],[6,"repeat",0,0,[19,7,0,null]],[7,["number",{value:400}],0,0,[6]],[8,"playdrum",0,0,[4,9,null]],[9,["drumname",{value:"kick drum"}],0,0,[8]],[10,["action",{collapsed:!1}],e,i+200,[null,11,12,null]],[11,["text",{value:"action"}],0,0,[10]],[12,"hidden",0,0,[10,13]],[13,"setshade",0,0,[12,18,14]],[14,"forward",0,0,[13,15,16]],[15,["number",{value:100}],0,0,[14]],[16,"right",0,0,[14,17,null]],[17,["number",{value:90}],0,0,[16]],[18,"elapsednotes",0,0,[13]],[19,"everybeatdo",e,i,[null,20,6]],[20,["text",{value:"action"}],0,0,[19]]],Nt=[[0,"elapsednotes2",e,i,[null,1]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]]],Pt=[[0,["newnote",{collapsed:!1}],0,0,[16,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,6]],[5,"hidden",0,0,[0,null]],[6,"playdrum",0,0,[4,7,null]],[7,["drumname",{value:"kick drum"}],0,0,[6]],[8,["newnote",{collapsed:!1}],0,0,[16,9,12,15]],[9,"divide",0,0,[8,10,11]],[10,["number",{value:1}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"vspace",0,0,[8,13]],[13,"playdrum",0,0,[12,14,null]],[14,["drumname",{value:"snare drum"}],0,0,[13]],[15,"hidden",0,0,[8,null]],[16,"ifthenelse",0,0,[17,18,8,0,null]],[17,"forever",e,i,[null,16,null]],[18,"mousebutton",0,0,[16]]],It=[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:8}],0,0,[2]],[5,"vspace",0,0,[0,null]]],Mt=[[0,["action",{collapsed:!1}],e,i+100,[null,1,2,null]],[1,["text",{value:"action"}],0,0,[0]],[2,"hidden",0,0,[0,3]],[3,"ifthenelse",0,0,[2,4,5,7,16]],[4,"equal",0,0,[3,13,12]],[5,"setcolor",0,0,[3,8,null]],[6,["number",{value:0}],0,0,[7]],[7,"setshade",0,0,[3,6,null]],[8,"elapsednotes2",0,0,[5,9]],[9,"divide",0,0,[8,10,11]],[10,["number",{value:1}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,["number",{value:1}],0,0,[4]],[13,"beatvalue",0,0,[4]],[14,"mynotevalue",0,0,[22]],[15,"deltapitch",0,0,[19]],[16,"forward",0,0,[3,19,21]],[17,"scrollxy",0,0,[21,22,18,null]],[18,["number",{value:0}],0,0,[17]],[19,"multiply",0,0,[16,15,20]],[20,["number",{value:10}],0,0,[19]],[21,"vspace",0,0,[16,17]],[22,"multiply",0,0,[17,14,23]],[23,["number",{value:25}],0,0,[22]],[24,"everybeatdo",e,i,[null,25,null]],[25,["text",{value:"action"}],0,0,[24]]],Et=[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:4}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],Ot=[[0,"interval",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:4}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],Dt=[[0,"fill",e,i,[null,null,1]],[1,"hidden",0,0,[0,null]]],Rt=[[0,"fill",e,i,[null,2,1]],[1,"hidden",0,0,[0,null]],[2,"repeat",0,0,[0,3,4,null]],[3,["number",{value:4}],0,0,[2]],[4,"forward",0,0,[2,5,6]],[5,["number",{value:100}],0,0,[4]],[6,"right",0,0,[4,7,null]],[7,["number",{value:90}],0,0,[6]]],Wt=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"finger cymbals"}],0,0,[0]]],Ht=[[0,"accidental",e,i,[null,11,1,10]],[1,"newnote",e,i,[0,2,5,9]],[2,"divide",0,0,[1,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[1,6]],[6,"pitch",0,0,[5,7,8,null]],[7,["solfege",{value:"sol"}],0,0,[6]],[8,["number",{value:4}],0,0,[6]],[9,"hidden",0,0,[1,null]],[10,"hidden",0,0,[0,null]],[11,["accidentalname",{value:"flat "}],0,0,[0]]],Ft=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"floor tom tom"}],0,0,[0]]],jt=[[0,["newnote",{collapsed:!1}],0,0,[9,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:2}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]],[9,"settimbre",e,i+200,[null,10,0,11]],[10,["voicename",{value:"custom"}],0,0,[9]],[11,"hidden",0,0,[9,null]],[12,["timbre",{collapsed:!1}],e,i,[null,13,15,14]],[13,["text",{value:"custom"}],0,0,[12]],[14,"hiddennoflow",0,0,[12,null]],[15,"fmsynth",0,0,[12,16,null]],[16,["number",{value:1}],0,0,[15]]],Vt=[[0,"forever",e,i,[null,1,null]],[1,["nameddo",{value:_("action")}],0,0,[0,null]]],Ut=[[0,"repeat",e,i,[null,1,6,null]],[1,["number",{value:4}],0,0,[0]],[2,"forward",0,0,[11,3,4]],[3,["number",{value:100}],0,0,[2]],[4,"right",0,0,[2,5,null]],[5,["number",{value:90}],0,0,[4]],[6,["newnote",{collapsed:!1}],0,0,[0,7,10,14]],[7,"divide",0,0,[6,8,9]],[8,["number",{value:1}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"vspace",0,0,[6,11]],[11,"pitch",0,0,[10,12,13,2]],[12,["solfege",{value:"sol"}],0,0,[11]],[13,["number",{value:4}],0,0,[11]],[14,"hidden",0,0,[6,null]]],Gt=[[0,"setscalartransposition",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:3}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],zt=[[0,"interval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:3}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],qt=[[0,"glide",e,i,[null,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:16}],0,0,[1]],[4,"vspace",0,0,[0,null]],[5,"hidden",0,0,[0,null]]],Yt=[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:2}],0,0,[2]],[5,"vspace",0,0,[0,null]]],Xt=[[0,"harmonic",e,i,[null,2,1]],[1,"hidden",0,0,[0,null]],[2,"partial",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,"partial",0,0,[2,5,6]],[5,["number",{value:.2}],0,0,[4]],[6,"partial",0,0,[4,7,null]],[7,["number",{value:.01}],0,0,[6]]],Kt=[[0,"harmonic2",e,i,[null,2,null,1]],[1,"hidden",0,0,[0,null]],[2,["number",{value:1}],0,0,[0]]],Qt=[[0,"harmonic2",e,i,[null,11,1,10]],[1,"newnote",e,i,[0,2,5,9]],[2,"divide",0,0,[1,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[1,6]],[6,"pitch",0,0,[5,7,8,null]],[7,["solfege",{value:"sol"}],0,0,[6]],[8,["number",{value:4}],0,0,[6]],[9,"hidden",0,0,[1,null]],[10,"hidden",0,0,[0,null]],[11,["number",{value:1}],0,0,[0]]],Zt=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"hi hat"}],0,0,[0]]],Jt=[[0,"hollowline",e,i,[null,null,1]],[1,"hidden",0,0,[0,null]]],$t=[[0,"forever",e,i,[null,1,null]],[1,"if",0,0,[0,2,3,null]],[2,"mousebutton",0,0,[1]],[3,["newnote",{collapsed:!1}],0,0,[1,4,7,10]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"playdrum",0,0,[7,9,null]],[9,["drumname",{value:"kick drum"}],0,0,[8]],[10,"hidden",0,0,[3,null]]],te=[[0,["interval",{collapsed:!1}],e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:2}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,9]],[8,"hidden",0,0,[0,18]],[9,["newnote",{collapsed:!1}],0,0,[7,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"sol"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,["newnote",{collapsed:!1}],0,0,[8,19,22,26]],[19,"divide",0,0,[18,20,21]],[20,["number",{value:1}],0,0,[19]],[21,["number",{value:4}],0,0,[19]],[22,"vspace",0,0,[18,23]],[23,"pitch",0,0,[22,24,25,27]],[24,["solfege",{value:"sol"}],0,0,[23]],[25,["number",{value:4}],0,0,[23]],[26,"hidden",0,0,[18,null]],[27,"pitch",0,0,[23,28,29,null]],[28,["solfege",{value:"ti"}],0,0,[27]],[29,["number",{value:4}],0,0,[27]]],ee=[[0,"interval",e,i,[null,1,null,2]],[1,["number",{value:5}],0,0,[0]],[2,"hidden",0,0,[0,null]]],ie=[[0,"invert",e,i,[null,1,2,null,3]],[1,["solfege",{value:"sol"}],0,0,[0]],[2,["number",{value:4}],0,0,[0]],[3,"hidden",0,0,[0,null]]],se=[[0,"invert1",e,i,[null,1,2,3,null,4]],[1,["solfege",{value:"sol"}],0,0,[0]],[2,["number",{value:4}],0,0,[0]],[3,["invertmode",{value:"even"}],0,0,[0]],[4,"hidden",0,0,[0,null]]],le=[[0,"invert1",e,i,[null,1,2,3,5,4]],[1,["solfege",{value:"do"}],0,0,[0]],[2,["number",{value:5}],0,0,[0]],[3,["invertmode",{value:"even"}],0,0,[0]],[4,"hidden",0,0,[0,14]],[5,["newnote",{collapsed:!1}],0,0,[0,6,9,13]],[6,"divide",0,0,[5,7,8]],[7,["number",{value:1}],0,0,[6]],[8,["number",{value:4}],0,0,[6]],[9,"vspace",0,0,[5,10]],[10,"pitch",0,0,[9,11,12,null]],[11,["solfege",{value:"fa"}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"hidden",0,0,[5,null]],[14,["newnote",{collapsed:!1}],0,0,[4,15,18,22]],[15,"divide",0,0,[14,16,17]],[16,["number",{value:1}],0,0,[15]],[17,["number",{value:4}],0,0,[15]],[18,"vspace",0,0,[14,19]],[19,"pitch",0,0,[18,20,21,null]],[20,["solfege",{value:"sol"}],0,0,[19]],[21,["number",{value:5}],0,0,[19]],[22,"hidden",0,0,[14,null]]],oe=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"kick drum"}],0,0,[0]]],ae=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"major 2"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ne=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"major 3"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],re=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"major 6"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ce=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"major 7"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],he=[[0,"matrix",e,i,[null,1,33]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"ti"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"la"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"sol"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"pitch",0,0,[7,11,12,13]],[11,["solfege",{value:"mi"}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"pitch",0,0,[10,14,15,16]],[14,["solfege",{value:"re"}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"playdrum",0,0,[13,17,18]],[17,["drumname",{value:"snare drum"}],0,0,[16]],[18,"forward",0,0,[16,19,20]],[19,["number",{value:100}],0,0,[18]],[20,"right",0,0,[18,21,22]],[21,["number",{value:90}],0,0,[20]],[22,"rhythm2",0,0,[20,23,24,27]],[23,["number",{value:6}],0,0,[22]],[24,"divide",0,0,[22,25,26]],[25,["number",{value:1}],0,0,[24]],[26,["number",{value:4}],0,0,[24]],[27,"vspace",0,0,[22,28]],[28,"rhythm2",0,0,[27,29,30,null]],[29,["number",{value:1}],0,0,[28]],[30,"divide",0,0,[28,31,32]],[31,["number",{value:1}],0,0,[30]],[32,["number",{value:2}],0,0,[30]],[33,"hiddennoflow",0,0,[0,null]]],ue=[[0,["matrix",{collapsed:!1}],e,i,[null,5,21]],[1,["solfege",{value:"do"}],0,0,[10]],[2,["number",{value:5}],0,0,[10]],[3,"steppitch",0,0,[8,4,null]],[4,["number",{value:-1}],0,0,[3]],[5,"setkey2",0,0,[0,6,7,10]],[6,["notename",{value:"C"}],0,0,[5]],[7,["modename",{value:"major"}],0,0,[5]],[8,"repeat",0,0,[10,9,3,11]],[9,"modelength",0,0,[8]],[10,"pitch",0,0,[5,1,2,8]],[11,"rhythm2",0,0,[8,12,14,22]],[12,["number",{value:6}],0,0,[11]],[13,["number",{value:1}],0,0,[14]],[14,"divide",0,0,[11,13,15]],[15,["number",{value:4}],0,0,[14]],[16,"rhythm2",0,0,[22,17,19,null]],[17,["number",{value:1}],0,0,[16]],[18,["number",{value:1}],0,0,[19]],[19,"divide",0,0,[16,18,20]],[20,["number",{value:2}],0,.5,[19]],[21,"hiddennoflow",0,0,[0,null]],[22,"vspace",0,0,[11,16]]],de=[[0,["matrix",{collapsed:!1}],e,i,[null,5,21]],[1,["solfege",{value:"sol"}],0,0,[10]],[2,["number",{value:5}],0,0,[10]],[3,"steppitch",0,0,[8,4,null]],[4,["number",{value:-1}],0,0,[3]],[5,"setkey2",0,0,[0,6,7,10]],[6,["notename",{value:"G"}],0,0,[5]],[7,["modename",{value:"major"}],0,0,[5]],[8,"repeat",0,0,[10,9,3,11]],[9,"modelength",0,0,[8]],[10,"pitch",0,0,[5,1,2,8]],[11,"rhythm2",0,0,[8,12,14,22]],[12,["number",{value:6}],0,0,[11]],[13,["number",{value:1}],0,0,[14]],[14,"divide",0,0,[11,13,15]],[15,["number",{value:4}],0,0,[14]],[16,"rhythm2",0,0,[22,17,19,null]],[17,["number",{value:1}],0,0,[16]],[18,["number",{value:1}],0,0,[19]],[19,"divide",0,0,[16,18,20]],[20,["number",{value:2}],0,.5,[19]],[21,"hiddennoflow",0,0,[0,null]],[22,"vspace",0,0,[11,16]]],fe=[[0,"meter",e,i,[null,1,2,5]],[1,["number",{value:4}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[0,null]]],pe=[[0,["meterwidget",{collapsed:!1}],e,i,[null,1,7]],[1,"meter",0,0,[0,2,3,6]],[2,["number",{value:4}],0,0,[1]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"vspace",0,0,[1,null]],[7,"hidden",0,0,[0,null]]],be=[[0,"setpitchnumberoffset",e,i,[null,1,2,null]],[1,["notename",{value:"C"}],0,0,[0]],[2,["number",{value:-1}],0,0,[0]]],me=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"minor 2"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ge=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"minor 3"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ke=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"minor 6"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ve=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"minor 7"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ye=[[0,"modewidget",e,i,[null,1,4]],[1,"setkey2",0,0,[0,2,3,null]],[2,["notename",{value:"C"}],0,0,[1]],[3,["modename",{value:DEFAULTMODE}],0,0,[1]],[4,"hiddennoflow",0,0,[0,null]]],_e=[[0,["start",{collapsed:!1}],e,i,[null,1,null]],[1,"forever",0,0,[0,2,null]],[2,"ifthenelse",0,0,[1,8,7,6,3]],[3,"setxy",0,0,[2,4,5,null]],[4,"mousex",0,0,[3]],[5,"mousey",0,0,[3]],[6,"penup",0,0,[2,null]],[7,"pendown",0,0,[2,null]],[8,"mousebutton",0,0,[2]]],Te=[[0,"movable",e,i,[null,1,null]],[1,["boolean",{value:!0}],0,0,[0]]],Le=[[0,["start",{collapsed:!1}],e,i,[null,1,null]],[1,"setkey2",0,0,[0,2,3,4]],[2,["notename",{value:"B"}],0,0,[1]],[3,["modename",{value:"aeolian"}],0,0,[1]],[4,"movable",0,0,[1,5,7]],[5,["boolean",{value:!0}],0,0,[4]],[6,"repeat",0,0,[15,16,17,null]],[7,["newnote",{collapsed:!1}],0,0,[4,8,11,15]],[8,"divide",0,0,[7,9,10]],[9,["number",{value:1}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"vspace",0,0,[7,12]],[12,"pitch",0,0,[11,13,14,null]],[13,["solfege",{value:"do"}],0,0,[12]],[14,["number",{value:4}],0,0,[12]],[15,"hidden",0,0,[7,6]],[16,"modelength",0,0,[6]],[17,["newnote",{collapsed:!1}],0,0,[6,18,21,24]],[18,"divide",0,0,[17,19,20]],[19,["number",{value:1}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"vspace",0,0,[17,22]],[22,"steppitch",0,0,[21,23,null]],[23,["number",{value:1}],0,0,[22]],[24,"hidden",0,0,[17,null]]],we=[[0,"multiplybeatfactor",e,i,[null,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:2}],0,0,[1]],[4,"vspace",0,0,[0,null]],[5,"hidden",0,0,[0,null]]],Be=[[0,"multiplybeatfactor",e,i,[null,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:2}],0,0,[1]],[4,"vspace",0,0,[0,12]],[5,"hidden",0,0,[0,21]],[6,"multiplybeatfactor",0,0,[29,7,10,11]],[7,"divide",0,0,[6,9,8]],[8,["number",{value:1}],0,0,[7]],[9,["number",{value:2}],0,0,[7]],[10,"vspace",0,0,[6,30]],[11,"hidden",0,0,[6,39]],[12,["newnote",{collapsed:!1}],0,0,[4,13,16,20]],[13,"divide",0,0,[12,14,15]],[14,["number",{value:1}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"vspace",0,0,[12,17]],[17,"pitch",0,0,[16,18,19,null]],[18,["solfege",{value:"sol"}],0,0,[17]],[19,["number",{value:4}],0,0,[17]],[20,"hidden",0,0,[12,null]],[21,["newnote",{collapsed:!1}],0,0,[5,22,25,29]],[22,"divide",0,0,[21,23,24]],[23,["number",{value:1}],0,0,[22]],[24,["number",{value:8}],0,0,[22]],[25,"vspace",0,0,[21,26]],[26,"pitch",0,0,[25,27,28,null]],[27,["solfege",{value:"sol"}],0,0,[26]],[28,["number",{value:4}],0,0,[26]],[29,"hidden",0,0,[21,6]],[30,["newnote",{collapsed:!1}],0,0,[10,31,34,38]],[31,"divide",0,0,[30,32,33]],[32,["number",{value:1}],0,0,[31]],[33,["number",{value:4}],0,0,[31]],[34,"vspace",0,0,[30,35]],[35,"pitch",0,0,[34,36,37,null]],[36,["solfege",{value:"sol"}],0,0,[35]],[37,["number",{value:4}],0,0,[35]],[38,"hidden",0,0,[30,null]],[39,["newnote",{collapsed:!1}],0,0,[11,40,43,47]],[40,"divide",0,0,[39,41,42]],[41,["number",{value:1}],0,0,[40]],[42,["number",{value:2}],0,0,[40]],[43,"vspace",0,0,[39,44]],[44,"pitch",0,0,[43,45,46,null]],[45,["solfege",{value:"sol"}],0,0,[44]],[46,["number",{value:4}],0,0,[44]],[47,"hidden",0,0,[39,null]]],xe=[[0,"musickeyboard",e,i,[null,1,16]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"sol"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"fa"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"mi"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"pitch",0,0,[7,11,12,13]],[11,["solfege",{value:"re"}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"pitch",0,0,[10,14,15,null]],[14,["solfege",{value:"do"}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"hiddennoflow",0,0,[0,null]]],Se=[[0,"musickeyboard",e,i,[null,1,16]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"la"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"sol"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"mi"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"pitch",0,0,[7,11,12,13]],[11,["solfege",{value:"re"}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"pitch",0,0,[10,14,15,null]],[14,["solfege",{value:"do"}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"hiddennoflow",0,0,[0,null]]],Ce=[[0,"neighbor",e,i,[null,1,3,2,6]],[1,["number",{value:1}],0,0,[0]],[2,"vspace",0,0,[0,null]],[3,"divide",0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:16}],0,0,[3]],[6,"hidden",0,0,[0,null]]],Ae=[[0,"neighbor2",e,i,[null,1,3,2,6]],[1,["number",{value:1}],0,0,[0]],[2,"vspace",0,0,[0,null]],[3,"divide",0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:16}],0,0,[3]],[6,"hidden",0,0,[0,null]]],Ne=[[0,"neighbor",e,i,[null,1,3,2,6]],[1,["number",{value:1}],0,0,[0]],[2,"vspace",0,0,[0,7]],[3,"divide",0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:16}],0,0,[3]],[6,"hidden",0,0,[0,null]],[7,["newnote",{collapsed:!1}],0,0,[2,8,11,15]],[8,"divide",0,0,[7,9,10]],[9,["number",{value:1}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"vspace",0,0,[7,12]],[12,"pitch",0,0,[11,13,14,null]],[13,["solfege",{value:"sol"}],0,0,[12]],[14,["number",{value:4}],0,0,[12]],[15,"hidden",0,0,[7,null]]],Pe=[[0,"neighbor2",e,i,[null,1,3,2,6]],[1,["number",{value:1}],0,0,[0]],[2,"vspace",0,0,[0,7]],[3,"divide",0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:16}],0,0,[3]],[6,"hidden",0,0,[0,null]],[7,["newnote",{collapsed:!1}],0,0,[2,8,11,15]],[8,"divide",0,0,[7,9,10]],[9,["number",{value:1}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"vspace",0,0,[7,12]],[12,"pitch",0,0,[11,13,14,null]],[13,["solfege",{value:"sol"}],0,0,[12]],[14,["number",{value:4}],0,0,[12]],[15,"hidden",0,0,[7,null]]],Ie=[[0,"newnote",e,i,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]]],Me=[[0,"newslur",e,i,[null,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:16}],0,0,[1]],[4,"vspace",0,0,[0,null]],[5,"hidden",0,0,[0,null]]],Ee=[[0,"newstaccato",e,i,[null,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:32}],0,0,[1]],[4,"vspace",0,0,[0,null]],[5,"hidden",0,0,[0,null]]],Oe=[[0,"newswing2",e,i,[null,1,6,9,10]],[1,"hspace",0,0,[0,2]],[2,"hspace",0,0,[1,3]],[3,"divide",0,0,[2,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:24}],0,0,[3]],[6,"divide",0,0,[0,7,8]],[7,["number",{value:1}],0,0,[6]],[8,["number",{value:8}],0,0,[6]],[9,"vspace",0,0,[0,null]],[10,"hidden",0,0,[0,null]]],De=[[0,"newswing",e,i,[null,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:16}],0,0,[1]],[4,"vspace",0,0,[0,null]],[5,"hidden",0,0,[0,null]]],Re=[[0,"newnote",e,i,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]]],We=[[0,"newnote",e,i,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["notename",{value:"G"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]]],He=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"hertz",0,0,[4,6,null]],[6,["number",{value:392}],0,0,[5]],[7,"hidden",0,0,[0,null]]],Fe=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"playdrum",0,0,[4,6,null]],[6,["drumname",{value:DEFAULTDRUM}],0,0,[5]],[7,"hidden",0,0,[0,null]]],je=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitchnumber",0,0,[4,6,null]],[6,["number",{value:7}],0,0,[5]],[7,"hidden",0,0,[0,null]]],Ve=[[0,"setpitchnumberoffset",e,i,[null,1,2,3]],[1,["notename",{value:"C"}],0,0,[0]],[2,["number",{value:4}],0,0,[0]],[3,["newnote",{collapsed:!1}],0,0,[0,4,7,10]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"pitchnumber",0,0,[7,9,null]],[9,["number",{value:7}],0,0,[8]],[10,"hidden",0,0,[3,11]],[11,["newnote",{collapsed:!1}],0,0,[10,12,15,19]],[12,"divide",0,0,[11,13,14]],[13,["number",{value:1}],0,0,[12]],[14,["number",{value:4}],0,0,[12]],[15,"vspace",0,0,[11,16]],[16,"pitch",0,0,[15,17,18,null]],[17,["solfege",{value:"sol"}],0,0,[16]],[18,["number",{value:4}],0,0,[16]],[19,"hidden",0,0,[11,null]]],Ue=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"steppitch",0,0,[4,6,null]],[6,["number",{value:1}],0,0,[5]],[7,"hidden",0,0,[0,null]]],Ge=[[0,"newnote",e,i,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"scaledegree",0,0,[4,6,7,null]],[6,["number",{value:5}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]]],ze=[[0,"newnote",e,i,[null,1,2,5]],[1,["number",{value:8}],0,0,[0]],[2,"pitch",0,0,[0,3,4,null]],[3,["solfege",{value:"sol"}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"hidden",0,0,[0,null]]],qe=[[0,"notecounter",e,i,[null,1]],[1,["newnote",{collapsed:!1}],0,0,[0,2,5,9]],[2,"divide",0,0,[1,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[1,6]],[6,"pitch",0,0,[5,7,8,null]],[7,["solfege",{value:"sol"}],0,0,[6]],[8,["number",{value:4}],0,0,[6]],[9,"hidden",0,0,[1,10]],[10,["newnote",{collapsed:!1}],0,0,[9,11,14,18]],[11,"divide",0,0,[10,12,13]],[12,["number",{value:1}],0,0,[11]],[13,["number",{value:4}],0,0,[11]],[14,"vspace",0,0,[10,15]],[15,"pitch",0,0,[14,16,17,null]],[16,["solfege",{value:"sol"}],0,0,[15]],[17,["number",{value:4}],0,0,[15]],[18,"hidden",0,0,[10,null]]],Ye=[[0,"settransposition",e,i,[null,1,4,5]],[1,"multiply",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:12}],0,0,[1]],[4,"vspace",0,0,[0,null]],[5,"hidden",0,0,[0,null]]],Xe=[[0,"oneOf",e,i,[null,1,2,null]],[1,["solfege",{value:"do"}],0,0,[0]],[2,["solfege",{value:"re"}],0,0,[0]]],Ke=[[0,["newnote",{collapsed:!1}],e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,8,6,null]],[6,["number",{value:4}],0,0,[5]],[7,"hidden",0,0,[0,null]],[8,"oneOf",0,0,[5,9,10]],[9,["solfege",{value:"sol"}],0,0,[8]],[10,["solfege",{value:"la"}],0,0,[8]]],Qe=[[0,"osctime",e,i,[null,2,1,7]],[1,"vspace",0,0,[0,5]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1e3}],0,0,[2]],[4,"divide",0,0,[2,8,9]],[5,"hertz",0,0,[1,6,null]],[6,["number",{value:392}],0,0,[5]],[7,"hidden",0,0,[0,null]],[8,["number",{value:3}],0,0,[4]],[9,["number",{value:2}],0,0,[4]]],Ze=[[0,"osctime",e,i,[null,2,1,7]],[1,"vspace",0,0,[0,5]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1e3}],0,0,[2]],[4,"divide",0,0,[2,8,9]],[5,"hertz",0,0,[1,6,null]],[6,["number",{value:392}],0,0,[5]],[7,"hidden",0,0,[0,10]],[8,["number",{value:3}],0,0,[4]],[9,["number",{value:2}],0,0,[4]],[10,"setmasterbpm2",0,0,[7,11,12,15]],[11,["number",{value:90}],0,0,[10]],[12,"divide",0,0,[10,13,14]],[13,["number",{value:1}],0,0,[12]],[14,["number",{value:4}],0,0,[12]],[15,"vspace",0,0,[10,16]],[16,["newnote",{collapsed:!1}],0,0,[15,17,20,24]],[17,"divide",0,0,[16,18,19]],[18,["number",{value:1}],0,0,[17]],[19,["number",{value:4}],0,0,[17]],[20,"vspace",0,0,[16,21]],[21,"pitch",0,0,[20,22,23,null]],[22,["solfege",{value:"sol"}],0,0,[21]],[23,["number",{value:4}],0,0,[21]],[24,"hidden",0,0,[16,null]]],Je=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"perfect 4"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],$e=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"perfect 5"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ti=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["intervalname",{value:"perfect 8"}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],ei=[[0,"phaser",e,i,[null,1,2,3,4,null]],[1,["number",{value:.5}],0,0,[0]],[2,["number",{value:3}],0,0,[0]],[3,["number",{value:392}],0,0,[0]],[4,["newnote",{collapsed:!1}],0,0,[0,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"sol"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,null]]],ii=[[0,"pickup",e,i,[null,1,4]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:0}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,null]]],si=[[0,"pitch",e,i,[null,1,2,null]],[1,["notename",{value:"G"}],0,0,[0]],[2,["number",{value:4}],0,0,[0]]],li=[[0,"pitchdrummatrix",e,i,[null,1,16]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"sol"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"mi"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"re"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"playdrum",0,0,[7,11,12]],[11,["drumname",{value:"kick drum"}],0,0,[10]],[12,"playdrum",0,0,[10,13,14]],[13,["drumname",{value:"snare drum"}],0,0,[12]],[14,"playdrum",0,0,[12,15,null]],[15,["drumname",{value:"ride bell"}],0,0,[14]],[16,"hiddennoflow",0,0,[0,null]]],oi=[[0,"pitchslider",e,i,[null,1,3]],[1,"hertz",0,0,[0,2,null]],[2,["number",{value:392}],0,0,[1]],[3,"hiddennoflow",0,0,[0,null]]],ai=[[0,"pitchstaircase",e,i,[null,1,4]],[1,"pitch",0,0,[0,2,3,null]],[2,["solfege",{value:"sol"}],0,0,[1]],[3,["number",{value:3}],0,0,[1]],[4,"hiddennoflow",0,0,[0,null]]],ni=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:DEFAULTDRUM}],0,0,[0]]],ri=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:DEFAULTEFFECT}],0,0,[0]]],ci=[[0,"playnoise",e,i,[null,1,null]],[1,["noisename",{value:DEFAULTNOISE}],0,0,[0]]],hi=[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[0,null]]],ui=[[0,["newnote",{collapsed:!1}],e,i,[null,1,3,7]],[1,"divide",0,0,[0,2,8]],[2,["number",{value:1}],0,0,[1]],[3,"vspace",0,0,[0,4]],[4,"pitch",0,0,[3,5,6,null]],[5,["solfege",{value:"sol"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"hidden",0,0,[0,null]],[8,"random",0,0,[1,9,10]],[9,["number",{value:1}],0,0,[8]],[10,["number",{value:16}],0,0,[8]]],di=[[0,["newnote",{collapsed:!1}],e,i,[null,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:5}],0,0,[5]],[8,"hidden",0,0,[0,18]],[9,["newnote",{collapsed:!1}],0,0,[18,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:2}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"sol"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,"register",0,0,[8,19,9]],[19,["number",{value:1}],0,0,[18]]],fi=[[0,"newnote",e,i,[null,1,4,6]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"rest2",0,0,[4,null]],[6,"hidden",0,0,[0,null]]],pi=[[0,["newnote",{collapsed:!1}],0,0,[9,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]],[9,"repeat",e,i,[null,10,0,null]],[10,["number",{value:4}],0,0,[9]]],bi=[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:3}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[0,null]]],mi=[[0,"rhythmruler2",e,i,[null,1,17]],[1,"setdrum",0,0,[0,2,3,8]],[2,["drumname",{value:"snare drum"}],0,0,[1]],[3,"rhythm2",0,0,[1,4,5,null]],[4,["number",{value:1}],0,0,[3]],[5,"divide",0,0,[3,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:1}],0,0,[5]],[8,"hidden",0,0,[1,9]],[9,"setdrum",0,0,[8,10,11,16]],[10,["drumname",{value:"kick drum"}],0,0,[9]],[11,"rhythm2",0,0,[9,12,13,null]],[12,["number",{value:1}],0,0,[11]],[13,"divide",0,0,[11,14,15]],[14,["number",{value:1}],0,0,[13]],[15,["number",{value:1}],0,0,[13]],[16,"hidden",0,0,[9,null]],[17,"hiddennoflow",0,0,[0,null]]],gi=[[0,"rhythmruler2",e,i,[null,1,9]],[1,"setdrum",0,0,[0,2,3,8]],[2,["drumname",{value:"snare drum"}],0,0,[1]],[3,"rhythm2",0,0,[1,4,5,null]],[4,["number",{value:1}],0,0,[3]],[5,"divide",0,0,[3,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:1}],0,0,[5]],[8,"hidden",0,0,[1,null]],[9,"hiddennoflow",0,0,[0,null]]],ki=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"ride bell"}],0,0,[0]]],vi=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"sawtooth",0,0,[4,6,null]],[6,["number",{value:392}],0,0,[5]],[7,"hidden",0,0,[0,null]]],yi=[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],_i=[[0,"interval",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],Ti=[[0,"semitoneinterval",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:5}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],Li=[[0,["newnote",{collapsed:!1}],0,0,[9,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]],[9,"setdrum",e,i,[null,10,0,11]],[10,["drumname",{value:"kick drum"}],0,0,[9]],[11,"hidden",0,0,[9,12]],[12,["newnote",{collapsed:!1}],0,0,[11,13,16,20]],[13,"divide",0,0,[12,14,15]],[14,["number",{value:1}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"vspace",0,0,[12,17]],[17,"pitch",0,0,[16,18,19,null]],[18,["solfege",{value:"sol"}],0,0,[17]],[19,["number",{value:4}],0,0,[17]],[20,"hidden",0,0,[12,21]],[21,["newnote",{collapsed:!1}],0,0,[20,22,25,29]],[22,"divide",0,0,[21,23,24]],[23,["number",{value:1}],0,0,[22]],[24,["number",{value:4}],0,0,[22]],[25,"vspace",0,0,[21,26]],[26,"pitch",0,0,[25,27,28,null]],[27,["solfege",{value:"la"}],0,0,[26]],[28,["number",{value:4}],0,0,[26]],[29,"hidden",0,0,[21,null]]],wi=[[0,"setdrum",e,i,[null,1,2,7]],[1,["drumname",{value:DEFAULTDRUM}],0,0,[0]],[2,"rhythm2",0,0,[0,3,4,null]],[3,["number",{value:1}],0,0,[2]],[4,"divide",0,0,[2,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:1}],0,0,[4]],[7,"hidden",0,0,[0,null]]],Bi=[[0,"setsynthvolume",e,i,[null,1,2,null]],[1,["drumname",{value:DEFAULTDRUM}],0,0,[0]],[2,["number",{value:50}],0,0,[0,null]]],xi=[[0,"setkey2",e,i,[null,1,2,null]],[1,["notename",{value:"C"}],0,0,[0]],[2,["modename",{value:"major"}],0,0,[0]]],Si=[[0,"setscalartransposition",e,i,[null,1,null,2]],[1,["number",{value:1}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Ci=[[0,["newnote",{collapsed:!1}],0,0,[15,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,null]],[9,"setscalartransposition",e,i,[null,10,15,16]],[10,"plus",0,0,[9,11,12]],[11,["number",{value:3}],0,0,[10]],[12,"multiply",0,0,[10,13,14]],[13,["number",{value:0}],0,0,[12]],[14,"modelength",0,0,[12]],[15,"vspace",0,0,[9,0]],[16,"hidden",0,0,[9,17]],[17,["newnote",{collapsed:!1}],0,0,[16,18,21,25]],[18,"divide",0,0,[17,19,20]],[19,["number",{value:1}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"vspace",0,0,[17,22]],[22,"pitch",0,0,[21,23,24,null]],[23,["solfege",{value:"do"}],0,0,[22]],[24,["number",{value:5}],0,0,[22]]],Ai=[[0,"setsynthvolume",e,i,[null,1,2,null]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:50}],0,0,[0,null]]],Ni=[[0,"settimbre",e,i,[null,1,3,2]],[1,["voicename",{value:"guitar"}],0,0,[0]],[2,"hidden",0,0,[0,null]],[3,["newnote",{collapsed:!1}],0,0,[0,4,7,11]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"pitch",0,0,[7,9,10,null]],[9,["solfege",{value:"sol"}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"hidden",0,0,[3,null]]],Pi=[[0,"settimbre",e,i,[null,1,null,2]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Ii=[[0,"settemperament",e,i,[null,1,2,3,null]],[1,["temperamentname",{value:"equal"}],0,0,[0]],[2,["notename",{value:"C"}],0,0,[0]],[3,["number",{value:4}],0,0,[0]]],Mi=[[0,"settransposition",e,i,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],Ei=[[0,"setvoice",e,i,[null,1,null,2]],[1,["voicename",{value:"violin"}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Oi=[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:6}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],Di=[[0,"interval",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:6}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],Ri=[[0,"accidental",e,i,[null,11,1,10]],[1,"newnote",e,i,[0,2,5,9]],[2,"divide",0,0,[1,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[1,6]],[6,"pitch",0,0,[5,7,8,null]],[7,["solfege",{value:"sol"}],0,0,[6]],[8,["number",{value:4}],0,0,[6]],[9,"hidden",0,0,[1,null]],[10,"hidden",0,0,[0,null]],[11,["accidentalname",{value:"sharp "}],0,0,[0]]],Wi=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"sine",0,0,[4,6,null]],[6,["number",{value:392}],0,0,[5]],[7,"hidden",0,0,[0,null]]],Hi=[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:16}],0,0,[2]],[5,"vspace",0,0,[0,null]]],Fi=[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:5}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],ji=[[0,"interval",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:5}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],Vi=[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:64}],0,0,[2]],[5,"vspace",0,0,[0,null]]],Ui=[[0,"skipnotes",e,i,[null,1,null,2]],[1,["number",{value:2}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Gi=[[0,["newnote",{collapsed:!1}],0,0,[18,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,9]],[9,["newnote",{collapsed:!1}],0,0,[8,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"sol"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,21]],[18,"skipnotes",e,i,[null,19,0,20]],[19,["number",{value:2}],0,0,[18]],[20,"hidden",0,0,[18,39]],[21,["newnote",{collapsed:!1}],0,0,[17,22,25,29]],[22,"divide",0,0,[21,23,24]],[23,["number",{value:1}],0,0,[22]],[24,["number",{value:4}],0,0,[22]],[25,"vspace",0,0,[21,26]],[26,"pitch",0,0,[25,27,28,null]],[27,["solfege",{value:"mi"}],0,0,[26]],[28,["number",{value:4}],0,0,[26]],[29,"hidden",0,0,[21,30]],[30,["newnote",{collapsed:!1}],0,0,[29,31,34,38]],[31,"divide",0,0,[30,32,33]],[32,["number",{value:1}],0,0,[31]],[33,["number",{value:4}],0,0,[31]],[34,"vspace",0,0,[30,35]],[35,"pitch",0,0,[34,36,37,null]],[36,["solfege",{value:"mi"}],0,0,[35]],[37,["number",{value:4}],0,0,[35]],[38,"hidden",0,0,[30,null]],[39,["newnote",{collapsed:!1}],0,0,[20,40,43,47]],[40,"divide",0,0,[39,41,42]],[41,["number",{value:1}],0,0,[40]],[42,["number",{value:4}],0,0,[40]],[43,"vspace",0,0,[39,44]],[44,"pitch",0,0,[43,45,46,null]],[45,["solfege",{value:"sol"}],0,0,[44]],[46,["number",{value:4}],0,0,[44]],[47,"hidden",0,0,[39,48]],[48,["newnote",{collapsed:!1}],0,0,[47,49,52,56]],[49,"divide",0,0,[48,50,51]],[50,["number",{value:1}],0,0,[49]],[51,["number",{value:4}],0,0,[49]],[52,"vspace",0,0,[48,53]],[53,"pitch",0,0,[52,54,55,null]],[54,["solfege",{value:"mi"}],0,0,[53]],[55,["number",{value:4}],0,0,[53]],[56,"hidden",0,0,[48,null]]],zi=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"slap"}],0,0,[0]]],qi=[[0,"slur",e,i,[null,1,null,2]],[1,["number",{value:16}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Yi=[[0,["newnote",{collapsed:!1}],0,0,[22,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,9]],[9,["newnote",{collapsed:!1}],0,0,[8,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"mi"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,"newslur",e,i,[null,19,22,23]],[19,"divide",0,0,[18,20,21]],[20,["number",{value:1}],0,0,[19]],[21,["number",{value:16}],0,0,[19]],[22,"vspace",0,0,[18,0]],[23,"hidden",0,0,[18,null]]],Xi=[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"snare drum"}],0,0,[0]]],Ki=[[0,"playdrum",e,i,[null,1,null]],[1,["effectsname",{value:"splash"}],0,0,[0]]],Qi=[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"square",0,0,[4,6,null]],[6,["number",{value:392}],0,0,[5]],[7,"hidden",0,0,[0,null]]],Zi=[[0,"staccato",e,i,[null,1,null,2]],[1,["number",{value:32}],0,0,[0]],[2,"hidden",0,0,[0,null]]],Ji=[[0,["newnote",{collapsed:!1}],0,0,[22,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,9]],[9,["newnote",{collapsed:!1}],0,0,[8,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"mi"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,"newstaccato",e,i,[null,19,22,23]],[19,"divide",0,0,[18,20,21]],[20,["number",{value:1}],0,0,[19]],[21,["number",{value:32}],0,0,[19]],[22,"vspace",0,0,[18,0]],[23,"hidden",0,0,[18,null]]],$i=[[0,"start",e,i,[null,1,null]],[1,"setdrum",0,0,[0,2,null,3]],[2,["drumname",{value:"kick drum"}],0,0,[1]],[3,"hidden",0,0,[1,null]]],ts=[[0,"status",e,i,[null,1,12]],[1,"hidden",0,0,[0,10]],[2,"print",0,0,[10,3,4]],[3,"beatvalue",0,0,[2]],[4,"print",0,0,[2,5,6]],[5,"measurevalue",0,0,[4]],[6,"print",0,0,[4,7,8]],[7,"elapsednotes",0,0,[6]],[8,"print",0,0,[6,9,null]],[9,"bpmfactor",0,0,[8]],[10,"print",0,0,[1,11,2]],[11,"pitchinhertz",0,0,[10]],[12,"hiddennoflow",0,0,[0,null]]],es=[[0,["storein2",{value:_("box1")}],e,i,[null,1,null]],[1,["number",{value:4}],e,i,[0]]],is=[[0,["storein2",{value:_("box2")}],e,i,[null,1,null]],[1,["number",{value:4}],e,i,[0]]],ss=[[0,"stuplet",e,i,[null,1,2,5]],[1,["number",{value:3}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:2}],0,0,[2]],[5,"vspace",0,0,[0,null]]],ls=[[0,"stuplet",e,i,[null,1,2,5]],[1,["number",{value:3}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:2}],0,0,[2]],[5,"vspace",0,0,[0,null]]],os=[[0,"stuplet",e,i,[null,1,2,5]],[1,["number",{value:5}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:2}],0,0,[2]],[5,"vspace",0,0,[0,null]]],as=[[0,"stuplet",e,i,[null,1,2,5]],[1,["number",{value:7}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:2}],0,0,[2]],[5,"vspace",0,0,[0,null]]],ns=[[0,"swing",e,i,[null,1,null,2]],[1,["number",{value:32}],0,0,[0]],[2,"hidden",0,0,[0,null]]],rs=[[0,"newswing2",e,i,[null,1,6,9,10]],[1,"hspace",0,0,[0,2]],[2,"hspace",0,0,[1,3]],[3,"divide",0,0,[2,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:24}],0,0,[3]],[6,"divide",0,0,[0,7,8]],[7,["number",{value:1}],0,0,[6]],[8,["number",{value:8}],0,0,[6]],[9,"vspace",0,0,[0,11]],[10,"hidden",0,0,[0,29]],[11,["newnote",{collapsed:!1}],0,0,[9,12,15,19]],[12,"divide",0,0,[11,13,14]],[13,["number",{value:1}],0,0,[12]],[14,["number",{value:8}],0,0,[12]],[15,"vspace",0,0,[11,16]],[16,"pitch",0,0,[15,17,18,null]],[17,["solfege",{value:"sol"}],0,0,[16]],[18,["number",{value:4}],0,0,[16]],[19,"hidden",0,0,[11,20]],[20,["newnote",{collapsed:!1}],0,0,[19,21,24,28]],[21,"divide",0,0,[20,22,23]],[22,["number",{value:1}],0,0,[21]],[23,["number",{value:8}],0,0,[21]],[24,"vspace",0,0,[20,25]],[25,"pitch",0,0,[24,26,27,null]],[26,["solfege",{value:"sol"}],0,0,[25]],[27,["number",{value:4}],0,0,[25]],[28,"hidden",0,0,[20,null]],[29,["newnote",{collapsed:!1}],0,0,[10,30,33,37]],[30,"divide",0,0,[29,31,32]],[31,["number",{value:1}],0,0,[30]],[32,["number",{value:6}],0,0,[30]],[33,"vspace",0,0,[29,34]],[34,"pitch",0,0,[33,35,36,null]],[35,["solfege",{value:"sol"}],0,0,[34]],[36,["number",{value:4}],0,0,[34]],[37,"hidden",0,0,[29,38]],[38,["newnote",{collapsed:!1}],0,0,[37,39,42,46]],[39,"divide",0,0,[38,40,41]],[40,["number",{value:1}],0,0,[39]],[41,["number",{value:12}],0,0,[39]],[42,"vspace",0,0,[38,43]],[43,"pitch",0,0,[42,44,45,null]],[44,["solfege",{value:"sol"}],0,0,[43]],[45,["number",{value:4}],0,0,[43]],[46,"hidden",0,0,[38,null]]],cs=[[0,"switch",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"case",0,0,[0,3,null,4]],[3,["number",{value:1}],0,0,[2]],[4,"defaultcase",0,0,[2,null,null]],[5,"hidden",0,0,[0,null]]],hs=[[0,"switch",e,i,[null,5,8,4]],[1,"case",0,0,[8,2,9,3]],[2,["number",{value:1}],0,0,[1]],[3,"defaultcase",0,0,[1,18,null]],[4,"hidden",0,0,[0,null]],[5,"random",0,0,[0,6,7]],[6,["number",{value:0}],0,0,[5]],[7,["number",{value:1}],0,0,[5]],[8,"vspace",0,0,[0,1]],[9,["newnote",{collapsed:!1}],0,0,[1,10,13,17]],[10,"divide",0,0,[9,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"vspace",0,0,[9,14]],[14,"pitch",0,0,[13,15,16,null]],[15,["solfege",{value:"sol"}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"hidden",0,0,[9,null]],[18,["newnote",{collapsed:!1}],0,0,[3,19,22,26]],[19,"divide",0,0,[18,20,21]],[20,["number",{value:1}],0,0,[19]],[21,["number",{value:4}],0,0,[19]],[22,"vspace",0,0,[18,23]],[23,"pitch",0,0,[22,24,25,null]],[24,["solfege",{value:"mi"}],0,0,[23]],[25,["number",{value:4}],0,0,[23]],[26,"hidden",0,0,[18,null]]],us=[[0,"temperament",e,i,[null,1,2,8]],[1,["temperamentname",{value:"equal"}],0,0,[0]],[2,"pitch",0,0,[0,3,4,5]],[3,["notename",{value:"C"}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"setkey2",0,0,[2,6,7,null]],[6,["notename",{value:"C"}],0,0,[5]],[7,["modename",{value:DEFAULTMODE}],0,0,[5]],[8,"hiddennoflow",0,0,[0,null]]],ds=[[0,"tempo",e,i,[null,1,6]],[1,"setmasterbpm2",0,0,[0,2,3,7]],[2,["number",{value:90}],0,0,[1]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"hiddennoflow",0,0,[0,null]],[7,"vspace",0,0,[1,null]]],fs=[[0,"setmasterbpm2",e,i,[null,1,2,5]],[1,["number",{value:90}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[0,null]]],ps=[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:2}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],bs=[[0,"interval",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:2}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],ms=[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:32}],0,0,[2]],[5,"vspace",0,0,[0,null]]],gs=[[0,"tie",e,i,[null,null,1]],[1,"hidden",0,0,[0,null]]],ks=[[0,["newnote",{collapsed:!1}],0,0,[19,1,4,8]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"pitch",0,0,[4,6,7,null]],[6,["solfege",{value:"sol"}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"hidden",0,0,[0,9]],[9,"hidden",0,0,[8,10]],[10,["newnote",{collapsed:!1}],0,0,[9,11,14,18]],[11,"divide",0,0,[10,12,13]],[12,["number",{value:1}],0,0,[11]],[13,["number",{value:2}],0,0,[11]],[14,"vspace",0,0,[10,15]],[15,"pitch",0,0,[14,16,17,null]],[16,["solfege",{value:"sol"}],0,0,[15]],[17,["number",{value:4}],0,0,[15]],[18,"hidden",0,0,[10,null]],[19,"tie",e,i,[null,0,20]],[20,"hidden",0,0,[19,null]]],vs=[[0,"timbre",e,i,[null,1,3,2]],[1,["text",{value:_("custom")}],0,0,[0]],[2,"hiddennoflow",0,0,[0,null]],[3,"newnote",0,0,[0,4,7,11]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"pitch",0,0,[7,9,10,null]],[9,["solfege",{value:"sol"}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"hidden",0,0,[3,12]],[12,"newnote",0,0,[11,13,16,20]],[13,"divide",0,0,[12,14,15]],[14,["number",{value:1}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"vspace",0,0,[12,17]],[17,"pitch",0,0,[16,18,19,null]],[18,["solfege",{value:"mi"}],0,0,[17]],[19,["number",{value:4}],0,0,[17]],[20,"hidden",0,0,[12,21]],[21,"newnote",0,0,[20,22,25,29]],[22,"divide",0,0,[21,23,24]],[23,["number",{value:1}],0,0,[22]],[24,["number",{value:2}],0,0,[22]],[25,"vspace",0,0,[21,26]],[26,"pitch",0,0,[25,27,28,null]],[27,["solfege",{value:"sol"}],0,0,[26]],[28,["number",{value:4}],0,0,[26]],[29,"hidden",0,0,[21,null]]],ys={accidental:s,action:l,actionhelp:o,archelp:a,amsynthhelp:n,articulation:r,acticulationhelp:c,augmented1:h,augmented2:u,augmented3:d,augmented4:f,augmented5:p,augmented6:b,augmented7:m,augmented8:g,backward:k,beatvaluehelp:v,bottle:y,bottomposhelp:T,box1:L,box1help:w,box2:B,box2help:x,bpmhelp:N,broadcasthelp:P,bubbles:I,cat:M,chine:E,chordI:O,chordIV:D,chordV:R,chorushelp:W,clang:H,clap:F,clickhelp:j,cowbell:V,crash:U,crescendo:G,crescendohelp:z,cricket:q,cup:Y,custompitch:X,darbuka:K,decrescendo:Q,decrescendohelp:Z,definemode:J,deltapitchhelp:$,diminished2:tt,diminished3:et,diminished4:it,diminished5:st,diminished6:lt,diminished7:ot,diminished8:at,dishelp:nt,dohelp:rt,dog:ct,dothelp:ht,doublyhelp:ut,downmajor3:dt,downmajor6:ft,downminor3:pt,downminor6:bt,downsixthinterval:mt,downthirdinterval:gt,downsixth:kt,downthird:vt,drift:Tt,duck:Lt,duosynthhelp:wt,duplicatenotes:Bt,duphelp:xt,effectshelp:St,eihelp:Ct,eighthNote:It,elifhelp:Pt,elapsedhelp:At,elapsednotes2:Nt,everybeathelp:Mt,f:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:60}],0,0,[0]],[3,"hidden",0,0,[0,null]]],ff:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:80}],0,0,[0]],[3,"hidden",0,0,[0,null]]],fff:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:100}],0,0,[0]],[3,"hidden",0,0,[0,null]]],fifth:Et,fifthinterval:Ot,fill:Dt,fillhelp:Rt,fingercymbals:Wt,flat:Ht,floortom:Ft,fmsynthhelp:jt,foreverhelp:Vt,forwardhelp:Ut,fourth:Gt,fourthinterval:zt,glide:qt,halfNote:Yt,harmonic:Xt,harmonic2:Kt,harmonichelp:Qt,hihat:Zt,hollowline:Jt,ifhelp:$t,interval:ee,intervalhelp:te,invert:ie,invert1:se,inverthelp:le,kick:oe,lrhelp:[[0,["start",{collapsed:!1}],0,0,[null,3,null]],[1,"forever",0,0,[3,5,null]],[2,"if",0,0,[5,7,8,null]],[3,"setheading",0,0,[0,4,1]],[4,["number",{value:90}],0,0,[3]],[5,"forward",0,0,[1,6,2]],[6,["number",{value:10}],0,0,[5]],[7,"greater",0,0,[2,12,14]],[8,"penup",0,0,[2,10]],[9,"pendown",0,0,[10,null]],[10,"setxy",0,0,[8,13,11,9]],[11,"y",0,0,[10]],[12,"x",0,0,[7]],[13,"leftpos",0,0,[10]],[14,"rightpos",0,0,[7]]],major2:ae,major3:ne,major6:re,major7:ce,matrix:he,matrixcmajor:ue,matrixgmajor:de,meter:fe,meterwidget:pe,mf:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:50}],0,0,[0]],[3,"hidden",0,0,[0,null]]],midi:be,minor2:me,minor3:ge,minor6:ke,minor7:ve,modewidget:ye,mousebuttonhelp:_e,movable:Te,movablehelp:Le,mp:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:40}],0,0,[0]],[3,"hidden",0,0,[0,null]]],multiplybeatfactor:we,multiplybeathelp:Be,neighbor:Ce,neighbor2:Ae,neighborhelp:Ne,neighbor2help:Pe,newnote:Ie,newslur:Me,newstaccato:Ee,newswing2:Oe,newswing:De,note1:Re,note2:We,note3:He,note4:Fe,note5:je,note6:Ue,note7:Ge,note:ze,notecounterhelp:qe,octave:Ye,oneOf:Xe,oneofhelp:Ke,osctime:Qe,osctimehelp:Ze,perfect4:Je,perfect5:$e,perfect8:ti,phaserhelp:ei,pickup:ii,pitch2:si,pitchdrummatrix:li,pitchnumberhelp:Ve,pitchslider:oi,musickeyboard2:xe,musickeyboardja:Se,pitchstaircase:ai,playdrum:ni,playeffect:ri,playnoise:ci,ppp:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:10}],0,0,[0]],[3,"hidden",0,0,[0,null]]],pp:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:20}],0,0,[0]],[3,"hidden",0,0,[0,null]]],p:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:30}],0,0,[0]],[3,"hidden",0,0,[0,null]]],quarterNote:hi,randomhelp:ui,registerhelp:di,repeathelp:pi,rest2:fi,rhythm2:bi,rhythmicdot:yt,rhythmicdot2:_t,rhythmruler2:mi,rhythmruler3:gi,ridebell:ki,sawtooth:vi,second:yi,secondinterval:_i,semitoneinterval:Ti,setbpm:S,setbpm2:C,setbpm3:A,setdrumhelp:Li,setdrum:wi,setdrumvolume:Bi,setkey2:xi,setnotevolume2:[[0,"setsynthvolume2",e,i,[null,1,2,null,3]],[1,["voicename",{value:DEFAULTVOICE}],0,0,[0]],[2,["number",{value:50}],0,0,[0]],[3,"hidden",0,0,[0,null]]],setsynthvolume:Ai,setscalartransposition:Si,scalartranshelp:Ci,settransposition:Mi,settimbre:Pi,settimbrehelp:Ni,settemperament:Ii,setvoice:Ei,seventh:Oi,seventhinterval:Di,sharp:Ri,sine:Wi,sixteenthNote:Hi,sixth:Fi,sixthinterval:ji,sixtyfourthNote:Vi,skipnotes:Ui,skiphelp:Gi,slap:zi,slur:qi,slurhelp:Yi,snare:Xi,splash:Ki,square:Qi,staccato:Zi,staccatohelp:Ji,startdrum:$i,status:ts,storebox1:es,storebox2:is,stuplet:ss,stuplet3:ls,stuplet5:os,stuplet7:as,swing:ns,switch:cs,switchhelp:hs,swinghelp:rs,setmasterbpm2:fs,temperament:us,tempo:ds,third:ps,thirdinterval:bs,thirtysecondNote:ms,tie:gs,tiehelp:ks,timbre:vs,tom:[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"tom tom"}],0,0,[0]]],tone:[[0,"drift",e,i,[null,1,null]],[1,"osctime",0,0,[0,3,2,null]],[2,"vspace",0,0,[1,6]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:1e3}],0,0,[3]],[5,["number",{value:3}],0,0,[3]],[6,"hertz",0,0,[2,7,null]],[7,["number",{value:392}],0,0,[6]]],tremolo:[[0,"tremolo",0,0,[null,1,2,null,3]],[1,["number",{value:10}],0,0,[0]],[2,["number",{value:50}],0,0,[0]],[3,"hidden",0,0,[0,null]]],tremolohelp:[[0,"tremolo",0,0,[null,1,2,3,12]],[1,["number",{value:10}],0,0,[0]],[2,["number",{value:50}],0,0,[0]],[3,["newnote",{collapsed:!1}],0,0,[0,4,7,11]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"pitch",0,0,[7,9,10,null]],[9,["solfege",{value:"sol"}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"hidden",0,0,[3,null]],[12,"hidden",0,0,[0,null]]],triangle:[[0,"newnote",e,i,[null,1,4,7]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"triangle",0,0,[4,6,null]],[6,["number",{value:392}],0,0,[5]],[7,"hidden",0,0,[0,null]]],trianglebell:[[0,"playdrum",e,i,[null,1,null]],[1,["drumname",{value:"triangle bell"}],0,0,[0]]],tuplet3:[[0,"tuplet3",e,i,[null,1,10,9,7]],[1,["number",{value:1}],0,0,[0]],[2,"rhythm2",0,0,[9,3,4,8]],[3,["number",{value:3}],0,0,[2]],[4,"divide",0,0,[2,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"hidden",0,0,[0,null]],[8,"vspace",0,0,[2,null]],[9,"vspace",0,0,[0,2]],[10,"divide",0,0,[0,11,12]],[11,["number",{value:1}],0,0,[10]],[12,["number",{value:4}],0,0,[10]]],tuplet4:[[0,"tuplet4",e,i,[null,1,4,17]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:1}],0,0,[1]],[3,["number",{value:2}],0,0,[1]],[4,"vspace",0,0,[0,5]],[5,"rhythm2",0,0,[4,6,7,10]],[6,["number",{value:6}],0,0,[5]],[7,"divide",0,0,[5,8,9]],[8,["number",{value:1}],0,0,[7]],[9,["number",{value:16}],0,0,[7]],[10,"vspace",0,0,[5,11]],[11,"rhythm2",0,0,[10,12,13,16]],[12,["number",{value:1}],0,0,[11]],[13,"divide",0,0,[11,14,15]],[14,["number",{value:1}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"vspace",0,0,[11,null]],[17,"hidden",0,0,[0,18]],[18,"hidden",0,0,[17,null]]],turtleshell:[[0,"turtleshell",e,i,[null,1,2,3]],[1,["number",{value:55}],0,0,[0]],[2,"media",0,0,[0]],[3,"vspace",0,0,[0,null]]],unison:[[0,"setscalartransposition",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:0}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],unisoninterval:[[0,"interval",e,i,[null,1,6,8]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:0}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,"modelength",0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,null]],[8,"hidden",0,0,[0,null]]],untilhelp:[[0,"until",e,i,[null,1,2,null]],[1,"mousebutton",0,0,[0]],[2,["newnote",{collapsed:!1}],0,0,[0,3,6,10]],[3,"divide",0,0,[2,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"vspace",0,0,[2,7]],[7,"pitch",0,0,[6,8,9,null]],[8,["solfege",{value:"sol"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"hidden",0,0,[2,null]]],vibrato:[[0,"vibrato",e,i,[null,1,3,2,6]],[1,["number",{value:5}],0,0,[0]],[2,"vspace",0,0,[0,null]],[3,"divide",0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:16}],0,0,[3]],[6,"hidden",0,0,[0,null]]],vibratohelp:[[0,"vibrato",e,i,[null,1,3,2,6]],[1,["number",{value:5}],0,0,[0]],[2,"vspace",0,0,[0,7]],[3,"divide",0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:16}],0,0,[3]],[6,"hidden",0,0,[0,null]],[7,["newnote",{collapsed:!1}],0,0,[2,8,11,15]],[8,"divide",0,0,[7,9,10]],[9,["number",{value:1}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"vspace",0,0,[7,12]],[12,"pitch",0,0,[11,13,14,null]],[13,["solfege",{value:"sol"}],0,0,[12]],[14,["number",{value:4}],0,0,[12]],[15,"hidden",0,0,[7,null]]],waitforhelp:[[0,"waitFor",0,0,[null,1,2]],[1,"mousebutton",0,0,[0]],[2,["newnote",{collapsed:!1}],0,0,[0,3,6,10]],[3,"divide",0,0,[2,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"vspace",0,0,[2,7]],[7,"pitch",0,0,[6,8,9,null]],[8,["solfege",{value:"sol"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"hidden",0,0,[2,null]]],whilehelp:[[0,"mousebutton",0,0,[1]],[1,"while",e,i,[null,0,2,null]],[2,["newnote",{collapsed:!1}],0,0,[1,3,6,9]],[3,"divide",0,0,[2,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"vspace",0,0,[2,7]],[7,"playdrum",0,0,[6,8,null]],[8,["drumname",{value:"kick drum"}],0,0,[7]],[9,"hidden",0,0,[2,null]]],wholeNote:[[0,"rhythm2",e,i,[null,1,2,5]],[1,["number",{value:1}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:1}],0,0,[2]],[5,"vspace",0,0,[0,null]]],xyhelp:[[0,"forever",0,0,[null,1,null]],[1,["newnote",{collapsed:!1}],0,0,[0,2,5,7]],[2,"divide",0,0,[1,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:8}],0,0,[2]],[5,"vspace",0,0,[1,6]],[6,"hertz",0,0,[5,17,14]],[7,"hidden",0,0,[1,null]],[8,"hertz",0,0,[14,18,13]],[9,"minus",0,0,[17,15,11]],[10,"minus",0,0,[18,16,12]],[11,"x",0,0,[9]],[12,"y",0,0,[10]],[13,"vspace",0,0,[8,null]],[14,"vspace",0,0,[6,8]],[15,"mousex",0,0,[9]],[16,"mousey",0,0,[10]],[17,"abs",0,0,[6,9]],[18,"abs",0,0,[8,10]]],black:[[0,"setshade",e,i,[null,1,null]],[1,["number",{value:0}],0,0,[0]]],white:[[0,"setshade",e,i,[null,1,null]],[1,["number",{value:100}],0,0,[0]]],red:[[0,"setcolor",e,i,[null,1,null]],[1,["number",{value:0}],0,0,[0]]],orange:[[0,"setcolor",e,i,[null,1,null]],[1,["number",{value:10}],0,0,[0]]],yellow:[[0,"setcolor",e,i,[null,1,null]],[1,["number",{value:20}],0,0,[0]]],green:[[0,"setcolor",e,i,[null,1,null]],[1,["number",{value:40}],0,0,[0]]],blue:[[0,"setcolor",e,i,[null,1,null]],[1,["number",{value:70}],0,0,[0]]],purple:[[0,"setcolor",e,i,[null,1,null]],[1,["number",{value:90}],0,0,[0]]]};return console.log(t),-1===["namedbox","nameddo","namedcalc","namedarg","nameddoArg"].indexOf(t)&&t in ys?ys[t]:null}var PROTOBLOCKSCALE=.75,PALETTELEFTMARGIN=Math.floor(10*PROTOBLOCKSCALE),PALETTE_SCALE_FACTOR=.5,PALETTE_WIDTH_FACTOR=3;function maxPaletteHeight(t,e){var i=windowHeight()/e-2*t;return i-i%STANDARDBLOCKHEIGHT+STANDARDBLOCKHEIGHT/2}function paletteBlockButtonPush(t,e,i){return t.makeBlock(e,i)}var NPALETTES=3;function Palettes(){return this.canvas=null,this.blocks=null,this.refreshCanvas=null,this.stage=null,this.cellSize=null,this.paletteWidth=55*PALETTE_WIDTH_FACTOR,this.scrollDiff=0,this.originalSize=55,this.trashcan=null,this.firstTime=!0,this.background=null,this.circles={},this.paletteText=new createjs.Text("","20px Sans",platformColor.paletteText),this.mouseOver=!1,this.activePalette=null,this.paletteObject=null,this.paletteVisible=!1,this.pluginsDeleteStatus=!1,this.visible=!0,this.scale=1,this.mobile=!1,this.top=75+LEADING,this.current=DEFAULTPALETTE,this.x=[],this.y=[],this.showSearchWidget=null,this.hideSearchWidget=null,this.pluginMacros={},sugarizerCompatibility.isInsideSugarizer()?storage=sugarizerCompatibility.data:storage=localStorage,this.dict={},this.selectorButtonsOff=[],this.selectorButtonsOn=[],this.buttons={},this.labels={},this.pluginPalettes=[],this.init=function(){this.halfCellSize=Math.floor(this.cellSize/2);for(var t=0;t<MULTIPALETTES.length;t++)this._makeSelectorButton(t),this.x.push(0),this.y.push((this.top+LEADING)/PALETTE_SCALE_FACTOR)},this.deltaY=function(t){for(var e=0;e<this.selectorButtonsOff.length;e++)this.selectorButtonsOff[e].y+=t,this.selectorButtonsOn[e].y+=t;for(var i in this.buttons)this.buttons[i].y+=t;for(var s in this.labels)this.labels[s].y+=t;for(var l in this.dict)this.dict[l]._moveMenuRelative(0,t),t<0&&this.dict[l].visible&&(this.dict[l]._resetLayout(),this.dict[l].showMenu(),this.dict[l]._showMenuItems());this.background.y+=t},this._makeSelectorButton=function(o){console.log("makeSelectorButton "+o),__processSelectButtonOff=function(e,t,i,s){var l=1.5*e.cellSize/e.originalSize;i.x=s*l*55,i.y=e.top,i.scaleX=l,i.scaleY=l,e.stage.addChild(i),e.selectorButtonsOff.push(i),e.selectorButtonsOff[o].on("click",function(t){e.showSelection(o)}),e.selectorButtonsOff[o].on("mouseover",function(t){e.showSelection(o)})},__processSelectButtonOn=function(t,e,i,s){var l=1.5*t.cellSize/t.originalSize;i.x=s*l*55,i.y=t.top,i.scaleX=l,i.scaleY=l,t.stage.addChild(i),t.selectorButtonsOn.push(i)},makePaletteBitmap(this,PALETTEICONS[MULTIPALETTEICONS[o]].replace("background_fill_color",platformColor.selectorBackground).replace(/stroke_color/g,platformColor.ruleColor).replace(/fill_color/g,platformColor.background),MULTIPALETTENAMES[o],__processSelectButtonOff,o),makePaletteBitmap(this,PALETTEICONS[MULTIPALETTEICONS[o]].replace("background_fill_color",platformColor.selectorSelected).replace(/stroke_color/g,platformColor.ruleColor).replace(/fill_color/g,platformColor.background),MULTIPALETTENAMES[o],__processSelectButtonOn,o)},this.showSelection=function(t){for(var e=0;e<this.selectorButtonsOn.length;e++)this.selectorButtonsOn[e].visible=e===t;for(var i in this.buttons)if(void 0!==this.buttons[i]&&void 0!==this.labels[i])if("search"===i)this.buttons[i].visible=!0,this.labels[i].visible=!0;else if(-1===MULTIPALETTES[t].indexOf(i))this.buttons[i].visible=!1,this.labels[i].visible=!1,t===MULTIPALETTES.length-1&&-1<this.pluginPalettes.indexOf(i)&&(console.log("Showing "+i),this.buttons[i].visible=!0,this.labels[i].visible=!0);else{if("myblocks"===i)0===palettes.countProtoBlocks("myblocks")?(this.buttons[i].visible=!1,this.labels[i].visible=!1):(this.buttons[i].visible=!0,this.labels[i].visible=!0);else this.buttons[i].visible=!0,this.labels[i].visible=!0}this.refreshCanvas()},this.setCanvas=function(t){return this.canvas=t,this},this.setStage=function(t){return this.stage=t,this},this.setRefreshCanvas=function(t){return this.refreshCanvas=t,this},this.setTrashcan=function(t){return this.trashcan=t,this},this.setSize=function(t){return this.cellSize=Math.floor(t*PALETTE_SCALE_FACTOR+.5),this},this.setMobile=function(t){return(this.mobile=t)&&this._hideMenus(),this},this.setScale=function(t){for(var e in this.scale=t,this._updateButtonMasks(),this.dict)this.dict[e]._resizeEvent();return null!=this.downIndicator&&(this.downIndicator.y=windowHeight()/t-27),this},this.setMacroDictionary=function(t){return this.macroDict=t,this},this.setSearch=function(t,e){return this.showSearchWidget=t,this.hideSearchWidget=e,this},this.getSearchPos=function(){return[this.cellSize,this.top+1.75*this.cellSize]},this.getPluginMacroExpansion=function(t,e,i){console.log(this.pluginMacros[t]);var s=this.pluginMacros[t];return null!=s&&(s[0][2]=e,s[0][3]=i),s},this.countProtoBlocks=function(t){var e=0;for(var i in this.blocks.protoBlockDict)null!==this.blocks.protoBlockDict[i].palette&&this.blocks.protoBlockDict[i].palette.name===t&&(e+=1);return e},this._updateButtonMasks=function(){for(var t in this.buttons){var e=new createjs.Shape;e.graphics.r(0,0,this.cellSize,windowHeight()/this.scale),e.x=0,e.y=this.cellSize/2,this.buttons[t].mask=e}},this.hidePaletteIconCircles=function(){sugarizerCompatibility.isInsideSugarizer()||hidePaletteNameDisplay(this.paletteText,this.stage),hideButtonHighlight(this.circles,this.stage)},this.getProtoNameAndPalette=function(t){for(var e in this.blocks.protoBlockDict){if(t===this.blocks.protoBlockDict[e].staticLabels[0]&&!this.blocks.protoBlockDict[e].hidden)return[e,this.blocks.protoBlockDict[e].palette.name,this.blocks.protoBlockDict[e].name];if(t===e&&!this.blocks.protoBlockDict[e].hidden)return[e,this.blocks.protoBlockDict[e].palette.name,this.blocks.protoBlockDict[e].name]}return[null,null,null]},this.makePalettes=function(t){if(this.firstTime){var e=new createjs.Shape;e.graphics.f(platformColor.ruleColor).r(0,this.top,Math.max(3,MULTIPALETTES.length)*STANDARDBLOCKHEIGHT,8*STANDARDBLOCKHEIGHT).ef().f(platformColor.paletteBackground).r(2,this.top+2,Math.max(3,MULTIPALETTES.length)*STANDARDBLOCKHEIGHT-4,8*STANDARDBLOCKHEIGHT-4).ef(),e.width=this.paletteWidth,e.height=windowHeight(),this.stage.addChild(e),this.background=e}this.firstTime=!1;var a=this;function i(t,e,i,s){a.buttons[e].addChild(i),a.cellSize!=a.originalSize&&(i.scaleX=a.cellSize/a.originalSize,i.scaleY=a.cellSize/a.originalSize);var l=new createjs.Shape;l.graphics.beginFill("#FFF").drawEllipse(0,0,a.cellSize*PALETTE_WIDTH_FACTOR,a.cellSize),a.buttons[e].hitArea=l,a.buttons[e].visible=!1,a.dict[e].makeMenu(!0),a.dict[e]._moveMenu(Math.max(3,MULTIPALETTES.length)*STANDARDBLOCKHEIGHT,a.top),a.dict[e]._updateMenu(!1),"kana"===localStorage.kanaPreference?a.labels[e]=new createjs.Text(toTitleCase(_(e)),"12px Sans",platformColor.paletteText):a.labels[e]=new createjs.Text(toTitleCase(_(e)),"16px Sans",platformColor.paletteText);var o=a.cellSize/2;a.labels[e].x=Math.floor(a.buttons[e].x+2.2*o),a.labels[e].y=Math.floor(a.buttons[e].y+o/2),a.stage.addChild(a.labels[e]),a._loadPaletteButtonHandler(e)}for(var s in this.dict)if(s in this.buttons)this.dict[s]._updateMenu(t);else{if(this.buttons[s]=new createjs.Container,this.buttons[s].snapToPixelEnabled=!0,this.stage.addChild(this.buttons[s]),"search"===s)this.buttons[s].x=0,this.buttons[s].y=this.top+1.75*this.cellSize;else if(!beginnerMode||-1===SKIPPALETTES.indexOf(s)){for(var l=0;l<MULTIPALETTES.length;l++)if(-1!==MULTIPALETTES[l].indexOf(s)){this.buttons[s].x=this.x[l],this.buttons[s].y=this.y[l]+this.scrollDiff,this.y[l]+=this.cellSize;break}l===MULTIPALETTES.length&&(l=MULTIPALETTES.length-1,console.log("We didn't find a multipalette for "+s),this.buttons[s].x=this.x[l],this.buttons[s].y=this.y[l]+this.scrollDiff,this.y[l]+=this.cellSize,-1===this.pluginPalettes.indexOf(s)&&this.pluginPalettes.push(s))}makePaletteBitmap(this,PALETTEICONS[s],s,i,null)}},this.showPalette=function(t){if(!this.mobile){if("search"==t&&null!==this.showSearchWidget){for(var e in this.dict)this.dict[e].visible&&(this.dict[e].hideMenu(),this.dict[e]._hideMenuItems());return console.log("searching"),this.dict[t].visible=!0,void this.showSearchWidget(!0)}for(var e in this.hideSearchWidget(!0),this.dict)this.dict[e]===this.dict[t]?(this.dict[t]._resetLayout(),this.dict[t].showMenu(),this.dict[t]._showMenuItems()):this.dict[e].visible&&(this.dict[e].hideMenu(),this.dict[e]._hideMenuItems())}},this._showMenus=function(){if(!this.mobile){for(var t=0;t<this.selectorButtonsOff.length;t++)this.selectorButtonsOff[t].visible=!0;this.showSelection(0),null!=this.background&&(this.background.visible=!0),this.refreshCanvas()}},this._hideMenus=function(){for(var t in this.buttons)this.buttons[t].visible=!1,this.labels[t].visible=!1;for(var t in this.dict)this.dict[t].hideMenu();this.hideSearchWidget(!0),null!==this.background&&(this.background.visible=!1);for(var e=0;e<this.selectorButtonsOff.length;e++)this.selectorButtonsOn[e].visible=!1,this.selectorButtonsOff[e].visible=!1;this.refreshCanvas()},this.getInfo=function(){for(var t in this.dict)console.log(this.dict[t].getInfo())},this.updatePalettes=function(t){if(null!=t){this.makePalettes(!1);var e=this;setTimeout(function(){e.dict[t]._resetLayout(),e.dict[t].hideMenu(),e.dict[t]._hideMenuItems(),e.refreshCanvas()},100)}else this.makePalettes(!0),this.refreshCanvas();if(this.mobile){var i=this;setTimeout(function(){for(var t in i.hide(),i.dict)i.dict[t].visible&&(i.dict[t].hideMenu(),i.dict[t]._hideMenuItems())},500)}},this.hide=function(){this._hideMenus(),this.visible=!1},this.show=function(){this.mobile?(this._hideMenus(),this.visible=!1):(this._showMenus(),this.visible=!0)},this.setBlocks=function(t){return this.blocks=t,this},this.add=function(t){return this.dict[t]=new Palette(this,t),this},this.remove=function(t){if(t in this.buttons){console.log(this.labels[t]),this.labels[t].visible=!1,this.stage.removeChild(this.labels[t]),this.buttons[t].visible=!1,this.buttons[t].removeAllChildren(),this.stage.removeChild(this.buttons[t]);for(var e=Object.keys(this.dict),i=e.indexOf(t)+1;i<e.length;i++)this.buttons[e[i]].y-=this.cellSize;delete this.buttons[t],delete this.labels[t],delete this.dict[t],this.y-=this.cellSize,this.makePalettes(!0)}else console.log("Palette.remove: Cannot find palette "+t)},this.bringToTop=function(){for(var t in this.dict)for(var e in this.stage.removeChild(this.dict[t].menuContainer),this.stage.addChild(this.dict[t].menuContainer),this.dict[t].protoContainers)this.stage.removeChild(this.dict[t].protoContainers[e]),this.stage.addChild(this.dict[t].protoContainers[e]);this.refreshCanvas()},this.findPalette=function(t,e){for(var i in this.dict){var s=this.dict[i].menuContainer.x,l=this.dict[i].menuContainer.y,o=Math.min(maxPaletteHeight(this.cellSize,this.scale),this.dict[i].y);if(this.dict[i].menuContainer.visible&&s<t&&t<s+MENUWIDTH*PROTOBLOCKSCALE&&l<e&&e<l+o)return this.dict[i]}return null},this._loadPaletteButtonHandler=function(e){var i=!1,s=!1,l=this;this.buttons[e].on("mouseover",function(t){document.body.style.cursor="pointer",l.mouseOver=!0;l.circles=showButtonHighlight(l.buttons[e].x+1,l.buttons[e].y+1,1,t,l.scale,l.stage),l.paletteHighlight=new createjs.Shape,l.paletteHighlight.graphics.f(platformColor.paletteSelected).r(l.buttons[e].x+2,l.buttons[e].y+2,Math.max(3,MULTIPALETTES.length)*STANDARDBLOCKHEIGHT-4,l.cellSize).ef(),"search"===e?l.stage.addChildAt(l.paletteHighlight,1):l.stage.addChildAt(l.paletteHighlight,2)}),this.buttons[e].on("pressup",function(t){document.body.style.cursor="default",l.mouseOver=!1,hideButtonHighlight(l.circles,l.stage)}),this.buttons[e].on("mouseout",function(t){document.body.style.cursor="default",l.mouseOver=!1,hideButtonHighlight(l.circles,l.stage),l.stage.removeChild(l.paletteHighlight)}),this.buttons[e].on("click",function(t){if("search"===e)s=!0,document.addEventListener("click",function t(e){setTimeout(function(){s=!1},500),!l.dict.search.visible&&s?l.showPalette("search"):(document.removeEventListener("click",t),l.dict.search.hide()),l.refreshCanvas()});else{if(i)return;s=!(i=!0),setTimeout(function(){i=!1},500),l.dict[e].visible||"search"===e?l.dict[e].hide():(l.dict.search.hide(),s||l.showPalette(e)),l.refreshCanvas()}})},this.removeActionPrototype=function(t){for(var e=!1,i=0;i<this.dict.action.protoList.length;i++){var s=this.dict.action.protoList[i];if(-1!==["nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(s.name)&&s.defaults[0]===t){this.dict.action.remove(s,t),this.blocks.protoBlockDict["myDo_"+t]?delete this.blocks.protoBlockDict["myDo_"+t]:this.blocks.protoBlockDict["myCalc_"+t]?delete this.blocks.protoBlockDict["myCalc_"+t]:this.blocks.protoBlockDict["myDoArg_"+t]?delete this.blocks.protoBlockDict["myDoArg_"+t]:this.blocks.protoBlockDict["myCalcArg_"+t]&&delete this.blocks.protoBlockDict["myCalcArg_"+t],e=!(this.dict.action.y=0);break}}e&&this.updatePalettes("action")},this}function PaletteModel(t,e,i){this.palette=t,this.palettes=e,this.name=i,this.blocks=[],this.update=function(){for(var t in this.blocks=[],this.palette.protoList){var e=this.palette.protoList[t],i=e.name,s=i;switch(i){case"storein":s="store in "+e.defaults[0];var l=e.defaults[0];break;case"storein2":s="store in2 "+e.staticLabels[0];l=e.staticLabels[0];break;case"box":s=e.defaults[0];l=e.defaults[0];break;case"namedbox":if(void 0===e.defaults[0]){s="namedbox";l=_("box")}else{s=e.defaults[0];l=e.defaults[0]}break;case"namedarg":if(void 0===e.defaults[0]){s="namedarg";l="1"}else{s=e.defaults[0];l=e.defaults[0]}break;case"nameddo":if(void 0===e.defaults[0]){s="nameddo";l=_("action")}else{s=e.defaults[0];l=e.defaults[0]}break;case"nameddoArg":if(void 0===e.defaults[0]){s="nameddoArg";l=_("action")}else{s=e.defaults[0];l=e.defaults[0]}break;case"namedcalc":if(void 0===e.defaults[0]){s="namedcalc";l=_("action")}else{s=e.defaults[0];l=e.defaults[0]}break;case"namedcalcArg":if(void 0===e.defaults[0]){s="namedcalcArg";l=_("action")}else{s=e.defaults[0];l=e.defaults[0]}}var o=this.palettes.blocks.protoBlockDict[i];if(null!==o){var a="";switch(o.name){case"text":a=_("text");break;case"drumname":a=_("drum");break;case"effectsname":a=_("effect");break;case"solfege":a=i18nSolfege("sol");break;case"eastindiansolfege":a="sargam";break;case"modename":a=_("mode name");break;case"invertmode":a=_("invert mode");break;case"voicename":a=_("voice name");break;case"temperamentname":a=_("temperament");break;case"accidentalname":a=_("accidental");break;case"notename":a="G";break;case"intervalname":a=_("interval name");break;case"boolean":a=_("true");break;case"number":a=NUMBERBLOCKDEFAULT.toString();break;case"less":case"greater":case"equal":a=o.staticLabels[0];break;case"namedarg":a="arg "+l;break;default:i!=s?a="storein"===i&&e.defaults[0]===_("box")?_("store in"):"storein2"===i?e.staticLabels[0]===_("store in box")?_("store in box"):_("store in")+" "+e.staticLabels[0]:e.defaults[0]:0<o.staticLabels.length?""===(a=o.staticLabels[0])&&(a="loadFile"===i?_("open file"):i):a=i}-1!=["do","nameddo","namedbox","namedcalc","doArg","calcArg","nameddoArg","namedcalcArg"].indexOf(o.name)&&null!=a&&getTextWidth(a,"bold 20pt Sans")>TEXTWIDTH&&(a=a.substr(0,STRINGLEN)+"..."),o.image&&(a="");var n=o.scale;switch(o.scale=DEFAULTBLOCKSCALE,o.name){case"namedbox":case"namedarg":(u=new SVG).init(),u.setScale(o.scale),u.setExpand(60,0,0,0),u.setOutie(!0);var r=u.basicBox(),c=u.docks,h=u.getHeight();break;case"nameddo":var u;(u=new SVG).init(),u.setScale(o.scale),u.setExpand(60,0,0,0);r=u.basicBlock(),c=u.docks,h=u.getHeight();break;default:var d=o.generator();r=d[0],c=d[1],h=d[3]}o.scale=n,r=o.disabled?r.replace(/fill_color/g,DISABLEDFILLCOLOR).replace(/stroke_color/g,DISABLEDSTROKECOLOR).replace("block_label",safeSVG(a)):r.replace(/fill_color/g,PALETTEFILLCOLORS[o.palette.name]).replace(/stroke_color/g,PALETTESTROKECOLORS[o.palette.name]).replace("block_label",safeSVG(a));for(var f=0;f<=o.args;f++)r=r.replace("arg_label_"+f,o.staticLabels[f]||"");this.blocks.push({blk:t,blkname:i,modname:s,height:STANDARDBLOCKHEIGHT,actualHeight:h,label:a,artwork:r,artwork64:"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(r))),docks:c,image:e.image,scale:e.scale,palettename:this.palette.name,hidden:e.hidden})}else console.log("Could not find block "+i)}}}function PopdownPalette(t){for(var e in this.palettes=t,this.models={},this.palettes.dict)this.models[e]=new PaletteModel(this.palettes.dict[e],this.palettes,e);this.update=function(){var t="<div>"+_("Click to select a block.")+'</div><div class="back"><h2>'+_("back")+"</h2></div>";for(var e in this.models){t+='<div class="palette">';var i=PALETTEICONS[e].replace(/#f{3,6}/gi,PALETTEFILLCOLORS[e]);t+=format("ja"===localStorage.languagePreference?'<h2 data-name="{n}">                                 {i}<span>{n}</span>                                 <img class="hide-button" src="header-icons/hide.svg"                                      alt="{'+_("hide")+'}"                                      title="{'+_("hide")+'}" />                                 <img class="show-button" src="header-icons/show.svg"                                      alt="{'+_("show2")+'}"                                      title="{'+_("show2")+'}" />                                 <img class="popout-button" src="header-icons/popout.svg"                                      alt="{'+_("popout")+'}"                                      title="{'+_("popout")+'}" />                             </h2>':'<h2 data-name="{n}">                                 {i}<span>{n}</span>                                 <img class="hide-button" src="header-icons/hide.svg"                                      alt="{'+_("hide")+'}"                                      title="{'+_("hide")+'}" />                                 <img class="show-button" src="header-icons/show.svg"                                      alt="{'+_("show")+'}"                                      title="{'+_("show")+'}" />                                 <img class="popout-button" src="header-icons/popout.svg"                                      alt="{'+_("popout")+'}"                                      title="{'+_("popout")+'}" />                             </h2>',{i:i,n:toTitleCase(_(e))}),t+="<ul>",this.models[e].update();var s=this.models[e].blocks;for(var l in-1<BUILTINPALETTES.indexOf(e)&&s.reverse(),s)t+=format('<li title="{label}"                                     data-blk="{blk}"                                     data-palettename="{palettename}"                                     data-modname="{modname}">                                     <img src="{artwork64}" alt="{label}" />                                 </li>',s[l]);t+="</div>"}document.querySelector("#popdown-palette").innerHTML=t;var o=this;document.querySelector("#popdown-palette .back").addEventListener("click",function(){o.popup()});var a=document.querySelectorAll("#popdown-palette > .palette");Array.prototype.forEach.call(a,function(t){t.querySelector("h2").addEventListener("click",function(){t.classList.contains("show")?t.classList.remove("show"):t.classList.add("show")}),t.querySelector(".popout-button").addEventListener("click",function(){o.popup(),o.palettes.showPalette(t.querySelector("h2").dataset.name)})});a=document.querySelectorAll("#popdown-palette li");Array.prototype.forEach.call(a,function(i){i.addEventListener("click",function(t){o.popup();var e=o.palettes.dict[i.dataset.palettename];e.protoContainers[i.dataset.modname],e._makeBlockFromPalette(e.protoList[i.dataset.blk],i.dataset.modname,function(t){for(var e in o.palettes.blocks._moveBlock(t,Math.floor(75-o.palettes.blocks.stage.x),Math.floor(75-o.palettes.blocks.stage.y)),o.palettes.blocks.findDragGroup(t),o.palettes.blocks.dragGroup)o.palettes.blocks.moveBlockRelative(o.palettes.blocks.dragGroup[e],0,0)})})})},this.popdown=function(){this.update(),document.querySelector("#popdown-palette").classList.add("show")},this.popup=function(){document.querySelector("#popdown-palette").classList.remove("show")}}function Palette(t,a){return this.palettes=t,this.name=a,this.model=new PaletteModel(this,t,a),this.visible=!1,this.menuContainer=null,this.protoList=[],this.protoContainers={},this.protoHeights={},this.background=null,this.scrollDiff=0,this.y=0,this.size=0,this.columns=0,this.draggingProtoBlock=!1,this.mouseHandled=!1,this.upButton=null,this.downButton=null,this.fadedUpButton=null,this.fadedDownButton=null,this.count=0,this.makeMenu=function(t){var o=this;function l(t,e,i,s){i.scaleX=i.scaleY=i.scale=.6,i.y=6,o.menuContainer.addChild(i)}function a(t,e,i,s){i.scaleX=i.scaleY=i.scale=.5,o.menuContainer.addChild(i),i.x=d-2*STANDARDBLOCKHEIGHT/3,i.y=8;var l=new createjs.Shape;l.graphics.beginFill("#FFF").drawEllipse(0,0,1*d/4,STANDARDBLOCKHEIGHT),l.x=d-STANDARDBLOCKHEIGHT,l.y=0,o.menuContainer.hitArea=l,o.menuContainer.visible=!1,o.mouseHandled||(o._loadPaletteMenuHandler(),o.mouseHandled=!0)}function n(t,e,i,s){i.scaleX=i.scaleY=i.scale=.7,o.palettes.stage.addChild(i),i.x=o.menuContainer.x+d,i.y=o.menuContainer.y+STANDARDBLOCKHEIGHT,u(i);new createjs.Shape;i.visible=!1,o.upButton=i,o.upButton.on("click",function(t){o.scrollEvent(STANDARDBLOCKHEIGHT,10)})}function r(t,e,i,s){i.scaleX=i.scaleY=i.scale=.7,o.palettes.stage.addChild(i),i.x=o.menuContainer.x+d,i.y=o._getDownButtonY()-STANDARDBLOCKHEIGHT,u(i),o.downButton=i,o.downButton.on("click",function(t){o.scrollEvent(-STANDARDBLOCKHEIGHT,10)})}function c(t,e,i,s){i.scaleX=i.scaleY=i.scale=.7,o.palettes.stage.addChild(i),i.x=o.menuContainer.x+d,i.y=o._getDownButtonY(),u(i),o.fadedDownButton=i,o.fadedDownButton.on("click",function(t){})}function h(t,e,i,s){i.scaleX=i.scaleY=i.scale=.7,o.palettes.stage.addChild(i),i.x=o.menuContainer.x+d,i.y=o.menuContainer.y+STANDARDBLOCKHEIGHT,u(i),o.fadedUpButton=i,o.fadedUpButton.on("click",function(t){})}function u(t){var e=new createjs.Shape;e.graphics.beginFill("#FFF").drawRect(0,0,STANDARDBLOCKHEIGHT,STANDARDBLOCKHEIGHT),e.x=0,e.y=0,t.hitArea=e,t.visible=!1}if(null===this.menuContainer&&(this.menuContainer=new createjs.Container,this.menuContainer.snapToPixelEnabled=!0),t){var d=MENUWIDTH*PROTOBLOCKSCALE+this._getOverflowWidth();this.menuContainer.removeAllChildren(),makePaletteBitmap(this,PALETTEHEADER.replace("fill_color",platformColor.selectorSelected).replace("palette_label",toTitleCase(_(this.name))).replace(/header_width/g,d),this.name,function(t,e,i,s){o.menuContainer.addChild(i),makePaletteBitmap(t,DOWNICON,e,r,null),makePaletteBitmap(t,FADEDDOWNICON,e,c,null),makePaletteBitmap(t,FADEDUPICON,e,h,null),makePaletteBitmap(t,UPICON,e,n,null),makePaletteBitmap(t,CLOSEICON.replace("fill_color",platformColor.selectorSelected),e,a,null),makePaletteBitmap(t,PALETTEICONS[e],e,l,null)},null)}},this._getDownButtonY=function(){return maxPaletteHeight(this.palettes.cellSize,this.palettes.scale)+STANDARDBLOCKHEIGHT/2},this._resizeEvent=function(){this.hide(),this._updateBackground(),this._updateBlockMasks(),null!==this.downButton&&(this.downButton.y=this._getDownButtonY(),this.fadedDownButton.y=this.downButton.y)},this._updateBlockMasks=function(){var t=Math.min(maxPaletteHeight(this.palettes.cellSize,this.palettes.scale),this.y),e=MENUWIDTH*PROTOBLOCKSCALE+this._getOverflowWidth();for(var i in this.protoContainers){var s=new createjs.Shape;s.graphics.r(0,0,e,t),s.x=this.background.x,s.y=this.background.y,this.protoContainers[i].mask=s}},this._getOverflowWidth=function(){var t=0;for(var e in this.protoList)this.protoList[e].hidden||(t=Math.max(t,this.protoList[e].textWidth));return 100<t?(t-30)*PROTOBLOCKSCALE:0},this._updateBackground=function(){if(null!==this.menuContainer){null!==this.background?this.background.removeAllChildren():(this.background=new createjs.Container,this.background.snapToPixelEnabled=!0,this.background.visible=!1,this.palettes.stage.addChild(this.background),this._setupBackgroundEvents());var t=maxPaletteHeight(this.palettes.cellSize,this.palettes.scale),e=new createjs.Shape;e.graphics.f(platformColor.ruleColor).r(0,0,MENUWIDTH*PROTOBLOCKSCALE+this._getOverflowWidth(),t).ef().f(platformColor.paletteBackground).r(2,2,MENUWIDTH*PROTOBLOCKSCALE+this._getOverflowWidth()-4,t-4).ef(),e.width=MENUWIDTH*PROTOBLOCKSCALE+this._getOverflowWidth(),e.height=t,this.background.addChild(e),this.background.x=this.menuContainer.x,this.background.y=this.menuContainer.y+STANDARDBLOCKHEIGHT/2}},this._resetLayout=function(){if(null!==this.menuContainer){for(var t in this.protoContainers)this.protoContainers[t].y-=this.scrollDiff;this.y=this.menuContainer.y+50;var e=[],i=[];for(var t in this.protoContainers)e.push(this.protoContainers[t]),i.push(this.protoHeights[t]);for(var s=e.length,l=0;l<s;l++){t=e.pop();var o=i.pop();t.x=this.menuContainer.x,void 0===o?o=STANDARDBLOCKHEIGHT*PROTOBLOCKSCALE:o*=PROTOBLOCKSCALE,t.y=this.y,this.y+=Math.floor(o+STANDARDBLOCKHEIGHT*PROTOBLOCKSCALE*.1)}for(var t in this.protoContainers)this.protoContainers[t].y+=this.scrollDiff}else console.log("menuContainer is null")},this._updateMenu=function(t){var n=this;function r(t,e,i,s){var l=n.protoContainers[i].getBounds();n.protoContainers[i].cache(l.x,l.y,Math.ceil(l.width),Math.ceil(l.height));var o=new createjs.Shape;for(var a in o.graphics.beginFill("#FFF").drawRect(0,0,Math.ceil(l.width),Math.ceil(.75*l.height)),n.protoContainers[i].hitArea=o,n._loadPaletteMenuItemHandler(s,i),n.palettes.refreshCanvas(),n.model.blocks)n.model.blocks[a].modname===i&&void 0===n.protoHeights[i]&&(n.protoHeights[i]=n.model.blocks[a].actualHeight)}function o(t,e,i,s){var l=s[0],o=(s[1],s[2]);if(void 0!==n.protoContainers[e])if(n.protoContainers[e].addChild(i),i.x=PALETTELEFTMARGIN,i.y=0,i.scaleX=PROTOBLOCKSCALE,i.scaleY=PROTOBLOCKSCALE,i.scale=PROTOBLOCKSCALE,l.image){var a=new Image;a.onload=function(){var t=new createjs.Bitmap(a);a.width>a.height?t.scaleX=t.scaleY=t.scale=MEDIASAFEAREA[2]/a.width*(l.scale/2)*PROTOBLOCKSCALE:t.scaleX=t.scaleY=t.scale=MEDIASAFEAREA[3]/a.height*(l.scale/2)*PROTOBLOCKSCALE,n.protoContainers[e].addChild(t),t.x=Math.floor(MEDIASAFEAREA[0]*(l.scale/2)+.5)*PROTOBLOCKSCALE,t.y=Math.floor(MEDIASAFEAREA[1]*(l.scale/2)+.5)*PROTOBLOCKSCALE,r(0,0,e,o)},a.src=l.image}else r(0,0,e,o);else console.log("no protoContainer for "+e)}function e(t,e,i,s){var l=s[0];makePaletteBitmap(t,l.artwork,l.modname,o,s)}null===this.menuContainer?this.makeMenu(!0):t?this.hide():this.palettes.mobile&&this.hide(),this.y=0,this.model.update();var i=this.model.blocks;for(var s in-1===BUILTINPALETTES.indexOf(a)&&i.reverse(),i){var l=i[s];l.hidden||(this.protoContainers[l.modname]?(this.protoContainers[l.modname].x=Math.floor(this.menuContainer.x+.5),this.protoContainers[l.modname].y=Math.floor(this.menuContainer.y+this.y+this.scrollDiff+STANDARDBLOCKHEIGHT*PROTOBLOCKSCALE+.5),this.protoHeights[l.modname]=l.actualHeight,this.y+=Math.ceil(l.actualHeight*PROTOBLOCKSCALE)):(this.protoContainers[l.modname]=new createjs.Container,this.protoContainers[l.modname].snapToPixelEnabled=!0,this.protoContainers[l.modname].x=Math.floor(this.menuContainer.x+.5),this.protoContainers[l.modname].y=Math.floor(this.menuContainer.y+this.y+this.scrollDiff+STANDARDBLOCKHEIGHT*PROTOBLOCKSCALE+.5),this.palettes.stage.addChild(this.protoContainers[l.modname]),this.protoContainers[l.modname].visible=!1,this.size+=Math.ceil(l.height*PROTOBLOCKSCALE),this.y+=Math.ceil(l.height*PROTOBLOCKSCALE),this._updateBackground(),makePaletteBitmap(this,PALETTEFILLER.replace(/filler_height/g,l.height.toString()),l.modname,e,[l,s,this.protoList[s]])))}this.makeMenu(!1),this.palettes.mobile&&this.hide()},this._moveMenu=function(t,e){if(null!==this.menuContainer){var i=t-this.menuContainer.x,s=e-this.menuContainer.y;this.menuContainer.x=t,this.menuContainer.y=e,this._moveMenuItemsRelative(i,s)}},this._moveMenuRelative=function(t,e){this.menuContainer.x+=t,this.menuContainer.y+=e,this._moveMenuItemsRelative(t,e)},this.hide=function(){this.hideMenu()},this.show=function(){for(var t in this.palettes.mobile?this.hideMenu():this.showMenu(),this.protoContainers)this.protoContainers[t].visible=!0;this._updateBlockMasks(),null!==this.background&&(this.background.visible=!0)},this.hideMenu=function(){"search"===this.name&&null!==this.palettes.hideSearchWidget&&this.palettes.hideSearchWidget(!0),this.palettes.paletteVisible=!1,null!=this.menuContainer&&(this.menuContainer.visible=!1,this._hideMenuItems()),this.palettes.pluginsDeleteStatus=!1},this.showMenu=function(){this.palettes.paletteVisible=!0,this.palettes.mobile?this.menuContainer.visible=!1:this.menuContainer.visible=!0,-1===BUILTINPALETTES.indexOf(this.name)?(this.palettes.pluginsDeleteStatus=!0,this.palettes.paletteObject=this):(this.palettes.pluginsDeleteStatus=!1,this.palettes.paletteObject=null)},this._hideMenuItems=function(){for(var t in"search"===this.name&&null!==this.palettes.hideSearchWidget&&this.palettes.hideSearchWidget(!0),this.protoContainers)this.protoContainers[t].visible=!1;null!==this.background&&(this.background.visible=!1),null!=this.fadedDownButton&&(this.upButton.visible=!1,this.downButton.visible=!1,this.fadedUpButton.visible=!1,this.fadedDownButton.visible=!1),this.visible=!1},this._showMenuItems=function(){for(var t in 0===this.scrollDiff&&(this.count=0),this.protoContainers)this.protoContainers[t].visible=!0;this._updateBlockMasks(),null!==this.background&&(this.background.visible=!0),this.scrollEvent(0,10),this.visible=!0},this._moveMenuItems=function(t,e){for(var i in this.protoContainers)this.protoContainers[i].x=t,this.protoContainers[i].y=e;null!==this.background&&(this.background.x=t,this.background.y=e)},this._moveMenuItemsRelative=function(t,e){for(var i in this.protoContainers)this.protoContainers[i].x+=t,this.protoContainers[i].y+=e;null!==this.background&&(this.background.x+=t,this.background.y+=e),null!==this.fadedDownButton&&(this.upButton.x+=t,this.upButton.y+=e,this.downButton.x+=t,this.downButton.y+=e,this.fadedUpButton.x+=t,this.fadedUpButton.y+=e,this.fadedDownButton.x+=t,this.fadedDownButton.y+=e)},this.scrollEvent=function(t,e){var i=t*e,s=Math.min(maxPaletteHeight(this.palettes.cellSize,this.palettes.scale),this.y);if(this.y<maxPaletteHeight(this.palettes.cellSize,this.palettes.scale))return this.upButton.visible=!1,this.downButton.visible=!1,this.fadedUpButton.visible=!1,void(this.fadedDownButton.visible=!1);if(0<this.scrollDiff+i&&0<t){if(0===(o=-this.scrollDiff))return this.downButton.visible=!0,this.upButton.visible=!1,this.fadedUpButton.visible=!0,void(this.fadedDownButton.visible=!1);for(var l in this.scrollDiff+=o,this.fadedDownButton.visible=!1,this.downButton.visible=!0,this.protoContainers)this.protoContainers[l].y+=o,this.protoContainers[l].visible=!0,0===this.scrollDiff&&(this.downButton.visible=!0,this.upButton.visible=!1,this.fadedUpButton.visible=!0,this.fadedDownButton.visible=!1)}else if(this.y+this.scrollDiff+i<s&&t<0){var o;if(0===(o=-this.y+s-this.scrollDiff))return this.upButton.visible=!0,this.downButton.visible=!1,this.fadedDownButton.visible=!0,void(this.fadedUpButton.visible=!1);for(var l in this.scrollDiff+=-this.y+s-this.scrollDiff,this.fadedUpButton.visible=!1,this.upButton.visible=!0,this.protoContainers)this.protoContainers[l].y+=o,this.protoContainers[l].visible=!0;-this.y+s-this.scrollDiff==0&&(this.upButton.visible=!0,this.downButton.visible=!1,this.fadedDownButton.visible=!0,this.fadedUpButton.visible=!1)}else if(0===this.count)this.fadedUpButton.visible=!0,this.fadedDownButton.visible=!1,this.upButton.visible=!1,this.downButton.visible=!0;else for(var l in this.scrollDiff+=i,this.fadedUpButton.visible=!1,this.fadedDownButton.visible=!1,this.upButton.visible=!0,this.downButton.visible=!0,this.protoContainers)this.protoContainers[l].y+=i,this.protoContainers[l].visible=!0;this._updateBlockMasks();var a=this.palettes.stage;a.setChildIndex(this.menuContainer,a.children.length-1),this.palettes.refreshCanvas(),this.count+=1},this.getInfo=function(){var t=this.name+" palette:";for(var e in this.protoList)t+=" "+this.protoList[e].name;return t},this.remove=function(t,e){-1!==(i=this.protoList.indexOf(t))&&this.protoList.splice(i,1);for(var i=0;i<this.model.blocks.length;i++){if(-1!==["nameddo","nameddoArg","namedcalc","namedcalcArg"].indexOf(this.model.blocks[i].blkname)&&this.model.blocks[i].modname===e){this.model.blocks.splice(i,1);break}if(-1!==["storein"].indexOf(this.model.blocks[i].blkname)&&this.model.blocks[i].modname===_("store in")+" "+e){this.model.blocks.splice(i,1);break}}this.palettes.stage.removeChild(this.protoContainers[e]),delete this.protoContainers[e]},this.add=function(t,e){return-1===this.protoList.indexOf(t)&&(void 0===e?this.protoList.push(t):this.protoList.splice(0,0,t)),this},this._setupBackgroundEvents=function(){var s=this,l=!1;this.background.removeAllEventListeners("mouseover"),this.background.removeAllEventListeners("mouseout"),this.background.removeAllEventListeners("mousedown"),this.background.on("mouseover",function(t){s.palettes.activePalette=s}),this.background.on("mouseout",function(t){s.palettes.activePalette=null}),this.background.on("mousedown",function(t){l=!0;var i=t.stageY;s.background.removeAllEventListeners("pressmove"),s.background.on("pressmove",function(t){if(l){var e=t.stageY-i;s.scrollEvent(e,10),i=t.stageY}}),s.background.removeAllEventListeners("pressup"),s.background.on("pressup",function(t){s.palettes.activePalette=null,l=!1},null,!0)})},this._loadPaletteMenuHandler=function(){var i=this,s=!1,l=(this.palettes.trashcan,MENUWIDTH*PROTOBLOCKSCALE+this._getOverflowWidth());this.menuContainer.on("click",function(t){if(Math.round(t.stageX/i.palettes.scale)>i.menuContainer.x+l-STANDARDBLOCKHEIGHT)return i.hide(),void i.palettes.refreshCanvas();if(!s){for(var e in s=!0,setTimeout(function(){s=!1},500),i.palettes.dict)i.name!=e&&i.palettes.dict[e].visible&&i.palettes.dict[e]._hideMenuItems();i.visible?i._hideMenuItems():i._showMenuItems(),i.palettes.refreshCanvas()}}),this.menuContainer.on("mouseover",function(t){document.body.style.cursor="pointer"}),this.menuContainer.on("mouseout",function(t){document.body.style.cursor="default"})},this._loadPaletteMenuItemHandler=function(e,r){var c=this,i=!1,s=!1,h=!1,u=this.protoContainers[r].x,d=this.protoContainers[r].y;this.protoContainers[r].on("mouseover",function(t){document.body.style.cursor="pointer",c.palettes.activePalette=c}),this.protoContainers[r].on("mousedown",function(t){var e=c.palettes.stage;e.setChildIndex(c.protoContainers[r],e.children.length-1);var i=Math.min(maxPaletteHeight(c.palettes.cellSize,c.palettes.scale),c.palettes.y);t.stageY,c.palettes.scale,c.menuContainer.y;c.protoContainers[r].mask=null,s=!(h=!1),u=c.protoContainers[r].x,d=c.protoContainers[r].y-c.scrollDiff;var l=t.stageX,o=t.stageY,a=t.stageY;if(!c.draggingProtoBlock){var n=window.hasMouse?MODEDRAG:MODEUNSURE;c.protoContainers[r].removeAllEventListeners("pressmove"),c.protoContainers[r].on("pressmove",function(t){if(n===MODEDRAG)return h=!0,c.draggingProtoBlock=!0,c.protoContainers[r].x=Math.round(t.stageX/c.palettes.scale)-PALETTELEFTMARGIN,c.protoContainers[r].y=Math.round(t.stageY/c.palettes.scale),void c.palettes.refreshCanvas();if(n===MODESCROLL){var e=t.stageY-a;return c.scrollEvent(e,10),void(a=t.stageY)}var i=Math.abs(t.stageX-l),s=Math.abs(t.stageY-o);e=Math.sqrt(i*i+s*s);n===MODEUNSURE&&DECIDEDISTANCE<e&&(n=i<s?MODESCROLL:MODEDRAG)})}}),this.protoContainers[r].on("mouseout",function(t){document.body.style.cursor="default",c.palettes.activePalette=null,s&&h&&(c._restoreProtoblock(r,u,d+c.scrollDiff),h=s=!1)}),this.protoContainers[r].on("pressup",function(t){document.body.style.cursor="default",c.palettes.activePalette=null,i||(i=!0,setTimeout(function(){i=!1},1e3),c._makeBlockFromProtoblock(e,h,r,t,u,d))})},this._restoreProtoblock=function(t,e,i){this.protoContainers[t].x=e,this.protoContainers[t].y=i,this._resetLayout()},this.promptPaletteDelete=function(){console.log(this.name);var t=_('Do you want to remove all the stacks from your "%s" palette?').replace("%s",_(this.name));if(confirm(t)){this.palettes.remove(this.name),delete pluginObjs.PALETTEHIGHLIGHTCOLORS[this.name],delete pluginObjs.PALETTESTROKECOLORS[this.name],delete pluginObjs.PALETTEFILLCOLORS[this.name],delete pluginObjs.PALETTEPLUGINS[this.name],"GLOBALS"in pluginObjs&&delete pluginObjs.GLOBALS[this.name],"IMAGES"in pluginObjs&&delete pluginObjs.IMAGES[this.name],"ONLOAD"in pluginObjs&&delete pluginObjs.ONLOAD[this.name],"ONSTART"in pluginObjs&&delete pluginObjs.ONSTART[this.name],"ONSTOP"in pluginObjs&&delete pluginObjs.ONSTOP[this.name];for(var e=0;e<this.protoList.length;e++){var i=this.protoList[e].name;delete pluginObjs.FLOWPLUGINS[i],delete pluginObjs.ARGPLUGINS[i],delete pluginObjs.BLOCKPLUGINS[i]}if("MACROPLUGINS"in pluginObjs)for(i in pluginObjs.MACROPLUGINS)delete pluginObjs.MACROPLUGINS[i];storage.plugins=preparePluginExports({}),sugarizerCompatibility.isInsideSugarizer()&&sugarizerCompatibility.saveLocally(),this.menuContainer.visible=!1,this._hideMenuItems()}},this.promptMacrosDelete=function(){var t=_('Do you want to remove all the stacks from your "%s" palette?').replace("%s",_("myblocks"));if(confirm(t)){for(var e=0;e<this.protoList.length;e++){var i=this.protoList[e].name;this.protoContainers[i].visible=!1,delete this.protoContainers[i],this.protoList.splice(e,1)}this.palettes.updatePalettes("myblocks"),storage.macros=prepareMacroExports(null,null,{}),sugarizerCompatibility.isInsideSugarizer()&&sugarizerCompatibility.saveLocally()}},this.makeBlockFromSearch=function(t,e,i){this._makeBlockFromPalette(t,e,i)},this._makeBlockFromPalette=function(t,e,i){if(null!==t){switch(t.name){case"do":e="do "+t.defaults[0];var s=t.name,l=t.defaults[0];break;case"storein":e="store in "+t.defaults[0];s=t.name,l=t.defaults[0];break;case"storein2":console.log("storein2 "+t.defaults[0]+" "+t.staticLabels[0]),e="store in2 "+t.defaults[0];s=t.name,l=t.staticLabels[0];break;case"box":e=t.defaults[0];s=t.name,l=t.defaults[0];break;case"namedbox":if(void 0===t.defaults[0]){e="namedbox";l=_("box")}else{console.log(t.defaults[0]),e=t.defaults[0];l=t.defaults[0]}s=t.name;break;case"namedarg":if(void 0===t.defaults[0]){e="namedarg";l="1"}else{e=t.defaults[0];l=t.defaults[0]}s=t.name;break;case"nameddo":if(void 0===t.defaults[0]){e="nameddo";l=_("action")}else{e=t.defaults[0];l=t.defaults[0]}s=t.name;break;case"nameddoArg":if(void 0===t.defaults[0]){e="nameddoArg";l=_("action")}else{e=t.defaults[0];l=t.defaults[0]}s=t.name;break;case"namedcalc":if(void 0===t.defaults[0]){e="namedcalc";l=_("action")}else{e=t.defaults[0];l=t.defaults[0]}s=t.name;break;case"namedcalcArg":if(void 0===t.defaults[0]){e="namedcalcArg";l=_("action")}else{e=t.defaults[0];l=t.defaults[0]}s=t.name;break;default:if(console.log(e),"nameddo"===e)l=_("action");else l="__NOARG__";s=e}var o=this.palettes.blocks.blockList.length;if(-1===["namedbox","nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(t.name)&&blockIsMacro(e))moved=!0,saveX=this.protoContainers[e].x,saveY=this.protoContainers[e].y,this._makeBlockFromProtoblock(t,moved,e,null,saveX,saveY),i(o);else if(-1===["namedbox","nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(t.name)&&e in this.palettes.pluginMacros)moved=!0,saveX=this.protoContainers[e].x,saveY=this.protoContainers[e].y,this._makeBlockFromProtoblock(t,moved,e,null,saveX,saveY),i(o);else{i(paletteBlockButtonPush(this.palettes.blocks,s,l))}}else console.log("null protoblk?")},this.cleanup=function(){this._resetLayout(),this._updateBlockMasks(),this.palettes.refreshCanvas()},this._makeBlockFromProtoblock=function(t,e,i,s,l,o){var a=this;if(e){e=!1,this.draggingProtoBlock=!1;var n=null;if(-1===["namedbox","nameddo","namedcalc","nameddoArg","namedcalcArg"].indexOf(t.name))if(null===(n=getMacroExpansion(i,this.protoContainers[i].x-this.palettes.blocks.stage.x,this.protoContainers[i].y-this.palettes.blocks.stage.y))&&i in this.palettes.pluginMacros)n=this.palettes.getPluginMacroExpansion(i,this.protoContainers[i].x-this.palettes.blocks.stage.x,this.protoContainers[i].y-this.palettes.blocks.stage.y);if(null!=n){this.palettes.blocks.loadNewBlocks(n);var r=this.palettes.blocks.blockList.length-1,c=this.palettes.blocks.findTopBlock(r)}else if("myblocks"===this.name){for(var h=i.replace("macro_",""),u=[],d=0;d<this.palettes.macroDict[h].length;d++){var f=this.palettes.macroDict[h][d][1],p=[];p="string"==typeof f?f:"string"==typeof f[1]?"number"===f[0]?[f[0],Number(f[1])]:[f[0],f[1]]:"number"==typeof f[1]?"number"===f[0]?[f[0],f[1]]:[f[0],f[1].toString()]:"number"===f[0]?[f[0],Number(f[1].value)]:[f[0],{value:f[1].value}];var b=[this.palettes.macroDict[h][d][0],p,this.palettes.macroDict[h][d][2],this.palettes.macroDict[h][d][3],this.palettes.macroDict[h][d][4]];u.push(b)}u[0][2]=this.protoContainers[i].x-this.palettes.blocks.stage.x,u[0][3]=this.protoContainers[i].y-this.palettes.blocks.stage.y,this.palettes.blocks.loadNewBlocks(u);r=this.palettes.blocks.blockList.length-1,c=this.palettes.blocks.findTopBlock(r);setTimeout(function(){this.palettes.blocks.blockList[c].collapseToggle()},500)}else b=this._makeBlockFromPalette(t,i,function(t){for(var e in a.palettes.blocks.findDragGroup(t),a.palettes.blocks.dragGroup)a.palettes.blocks.moveBlockRelative(a.palettes.blocks.dragGroup[e],Math.round(s.stageX/a.palettes.scale)-a.palettes.blocks.stage.x,Math.round(s.stageY/a.palettes.scale)-a.palettes.blocks.stage.y);a.palettes.blocks.blockMoved(t),a.palettes.blocks.checkBounds()},b);this.cleanup()}},this}function initPalettes(t){return _initPalettes.apply(this,arguments)}function _initPalettes(){return(_initPalettes=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=0;i<BUILTINPALETTES.length;i++)e.add(BUILTINPALETTES[i]);return e.makePalettes(!0),t.next=4,delayExecution(1e3);case 4:e.show(),e.bringToTop(),e.showSelection(0);case 7:case"end":return t.stop()}},t)}))).apply(this,arguments)}var MODEUNSURE=0,MODEDRAG=1,MODESCROLL=2,DECIDEDISTANCE=20;function makePaletteBitmap(e,t,i,s,l){var o=new Image;o.onload=function(){var t=new createjs.Bitmap(o);s(e,i,t,l)},o.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t)))}function PasteBox(){this._canvas=null,this._stage=null,this._refreshCanvas=null,this._paste=null,this._container=null,this.save=null,this.close=null,this._scale=1,this.setCanvas=function(t){return this._canvas=t,this},this.setStage=function(t){return this._stage=t,this},this.setPaste=function(t){return this._paste=t,this},this.setRefreshCanvas=function(t){return this._refreshCanvas=t,this},this.hide=function(){null!=this._container&&(this._container.visible=!1,this._refreshCanvas(),docById("paste").style.visibility="hidden")},this.createBox=function(t,e,i){if(null==this._container){this._scale=t,this._container=new createjs.Container,this._stage.addChild(this._container),this._container.x=e,this._container.y=i,this._makeBoxBitmap('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="280" height="55"> <rect width="280" height="55" x="0" y="-3.5762787e-06" style="fill:#f0f0f0;fill-opacity:1;fill-rule:nonzero;stroke:none" /> <g transform="translate(225,0)" style="fill:#000000;display:block"> <path d="m 27.557,5.053 c -12.43,0 -22.5,10.076 -22.5,22.497 0,12.432 10.07,22.503 22.5,22.503 12.431,0 22.5,-10.071 22.5,-22.503 0,-12.421 -10.07,-22.497 -22.5,-22.497 z m 10.199,28.159 c 1.254,1.256 1.257,3.291 0,4.545 -0.628,0.629 -1.451,0.943 -2.274,0.943 -0.822,0 -1.644,-0.314 -2.27,-0.94 l -5.76,-5.761 -5.76,5.761 c -0.627,0.626 -1.449,0.94 -2.271,0.94 -0.823,0 -1.647,-0.314 -2.275,-0.943 -1.254,-1.254 -1.254,-3.289 0.004,-4.545 l 5.758,-5.758 -5.758,-5.758 c -1.258,-1.254 -1.258,-3.292 -0.004,-4.546 1.255,-1.254 3.292,-1.259 4.546,0 l 5.76,5.759 5.76,-5.759 c 1.252,-1.259 3.288,-1.254 4.544,0 1.257,1.254 1.254,3.292 0,4.546 l -5.758,5.758 5.758,5.758 z" style="fill:#000000;display:inline" /> </g></svg>',"box",function(t,e,i,s){t._container.addChild(i),t._loadClearContainerHandler(),t._container.visible=!0,t._refreshCanvas()},null)}},this.show=function(){this._container.visible=!0,this._refreshCanvas(),docById("paste").style.visibility="visible"},this.getPos=function(){return[this._container.x,this._container.y]},this._loadClearContainerHandler=function(){var t=new createjs.Shape;this.bounds=this._container.getBounds(),t.graphics.beginFill("#FFF").drawRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.x=0,t.y=0,this._container.hitArea=t;var s=!1,l=this;this._container.on("click",function(t){if(s)console.log("debouncing click");else{s=!0,setTimeout(function(){s=!1},500);var e=t.stageX/l._scale-l._container.x,i=t.stageY/l._scale-l._container.y;125<e&&i<55&&l.hide()}})},this._makeBoxBitmap=function(t,e,i,s){var l=new Image,o=this;l.onload=function(){var t=new createjs.Bitmap(l);i(o,e,t,s)},l.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t)))}}function PlaybackWidget(){docById("playbackDiv").style.visibility="hidden",this.init=function(t){console.log("INITIALIZING PLAYBACK WIDGET"),this._logo=t;var e=window.innerWidth;this._cellScale=e/1200;var i=32*this._cellScale,s=docById("myCanvas"),l=docById("playbackDiv");l.style.visibility="visible",l.setAttribute("draggable","true"),l.style.left="200px",l.style.top="150px";var o=docById("playbackButtonsDiv");o.style.display="inline",o.style.visibility="visible",o.style.width=128,o.innerHTML='<table cellpadding="0px" id="playbackButtonTable"></table>';var a=docById("playbackButtonTable").createTHead().insertRow(0),n=this;this._playcell=this._addButton(a,"play-button.svg",32,_("Play all")),this._playcell.onclick=function(){n._logo.playback(-1)},(m=this._addButton(a,"close-button.svg",32,_("Close"))).onclick=function(){c.style.visibility="hidden",o.style.visibility="hidden",l.style.visibility="hidden",n._logo.stopTurtle=!0};var r=this._addButton(a,"grab.svg",32,_("Drag"));r.style.cursor="move",this._dx=r.getBoundingClientRect().left-l.getBoundingClientRect().left,this._dy=r.getBoundingClientRect().top-l.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=r.innerHTML,r.onmouseover=function(t){r.innerHTML=""},r.onmouseout=function(t){n._dragging||(r.innerHTML=n._dragCellHTML)},s.ondragover=function(t){n._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",r.innerHTML=n._dragCellHTML}},l.ondragover=function(t){n._dragging=!0,t.preventDefault()},l.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",r.innerHTML=n._dragCellHTML}},l.onmousedown=function(t){n._target=t.target},l.ondragstart=function(t){r.contains(n._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};var c=docById("playbackTableDiv");c.style.display="inline",c.style.visibility="visible",c.style.border="0px",c.innerHTML='<div id="playbackOuterDiv"><div id="playbackInnerDiv"><table cellpadding="0px" id="playbackTable"></table></div></div>';var h=Math.max(Math.floor(.5*window.innerHeight/100),8),u=docById("playbackOuterDiv");if(this._logo.turtles.turtleList.length>h){u.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(h+2)+"px";e=53*this._cellScale*2+20;u.style.width=e+"px"}else{u.style.height=this._cellScale*(MATRIXBUTTONHEIGHT2+(2+MATRIXSOLFEHEIGHT)*this._logo.turtles.turtleList.length)+"px";e=53*this._cellScale*2;u.style.width=e+"px"}e=53*this._cellScale*2;var d=docById("playbackInnerDiv");d.style.width=e+"px",d.style.marginLeft="0px";for(var f=docById("playbackTable"),p=0,b=0;b<this._logo.turtles.turtleList.length;b++)if(!this._logo.turtles.turtleList[b].trash){a=f.insertRow();var m,g=_("mouse")+p;(m=a.insertCell(-1)).innerHTML='&nbsp;&nbsp;<img src="images/mouse.svg" title="'+g+'" alt="'+g+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',m.style.width="53px",m.style.minWidth=m.style.width,m.style.maxWidth=m.style.width,m.style.height=m.style.width,m.style.minHeight=m.style.height,m.style.maxHeight=m.style.height,m.style.backgroundColor=MATRIXLABELCOLOR,m.style.left="1px";var k=this._addButton(a,"play-button.svg",i,_("Play"));k.setAttribute("id",p),k.onclick=function(){var t=Number(this.getAttribute("id"));n._logo.playback(t)},p+=1}},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=MATRIXBUTTONCOLOR,l.onmouseover=function(){this.style.backgroundColor=MATRIXBUTTONCOLORHOVER},l.onmouseout=function(){this.style.backgroundColor=MATRIXBUTTONCOLOR},l}}function PlaybackBox(){this._stage=null,this._refreshCanvas=null,this._doCompile=null,this._doPlay=null,this._doPause=null,this._doRewind=null,this._getQueueStatus=null,this._container=null,this._scale=1,this.setStage=function(t){return this._stage=t,this},this.setRefreshCanvas=function(t){return this._refreshCanvas=t,this},this.setQueueStatus=function(t){return this._getQueueStatus=t,this},this.setCompile=function(t){return this._doCompile=t,this},this.setPlay=function(t){return this._doPlay=t,this},this.setPause=function(t){return this._doPause=t,this},this.setRewind=function(t){return this._doRewind=t,this},this.getPos=function(){return[this._container.x,this._container.y]},this.init=function(t,e,i,s,l){if(this._logo=l,null===this._container){this._createBox(t,e,i);var o=this,a=55;this.playButton=s("media-playback-start",_("playback music")+" [Alt-P]",this._container.x+a,this._container.y+85,55,0,this._stage),this.playButton.visible=!0,this._positionHoverText(this.playButton),this.playButton.on("click",function(t){o._doPlay()}),this.noplayButton=s("media-playback-start-insensitive",_("playback music"),this._container.x+a,this._container.y+85,55,0,this._stage),this.noplayButton.visible=!0,this._positionHoverText(this.playButton),this.pauseButton=s("media-playback-pause",_("pause playback"),this._container.x+a,this._container.y+85,55,0,this._stage),this.pauseButton.visible=!1,this._positionHoverText(this.pauseButton),this.pauseButton.on("click",function(t){o._doPause()}),a+=65,this.rewindButton=s("media-playlist-repeat",_("restart playback"),this._container.x+a,this._container.y+85,55,0,this._stage),this.rewindButton.visible=!1,this._positionHoverText(this.rewindButton),this.rewindButton.on("click",function(t){o._doRewind()}),this.norewindButton=s("media-playlist-repeat-insensitive",_("restart playback"),this._container.x+a,this._container.y+85,55,0,this._stage),this.norewindButton.visible=!0,this._positionHoverText(this.norewindButton),a+=65,this._compileButton=s("compile-button",_("prepare music for playback"),this._container.x+a,this._container.y+85,55,0,this._stage),this._compileButton.visible=!0,this._positionHoverText(this._compileButton);for(var n=0;n<this._compileButton.children.length;n++)if(null!=this._compileButton.children[n].text){this._compileButton.children[n].x=10-a;break}this._compileButton.on("click",function(t){o._doCompile()})}else this._show();this.setPlaybackStatus()},this.setPlaybackStatus=function(){null!=this._container&&(this._container.visible?this._getQueueStatus()?(this.noplayButton.visible=!1,this.playButton.visible=!0,this.pauseButton.visible=!1,0===this._logo.playbackTime?(this.norewindButton.visible=!0,this.rewindButton.visible=!1):(this.norewindButton.visible=!1,this.rewindButton.visible=!0)):(this.noplayButton.visible=!0,this.playButton.visible=!1,this.pauseButton.visible=!1,this.norewindButton.visible=!0,this.rewindButton.visible=!1):(this.noplayButton.visible=!1,this.playButton.visible=!1,this.pauseButton.visible=!1,this.norewindButton.visible=!1,this.rewindButton.visible=!1))},this._positionHoverText=function(t){for(var e=0;e<t.children.length;e++)if(null!=t.children[e].text){t.children[e].textAlign="left",t.children[e].x=-27,t.children[e].y=27;break}},this.hide=function(){null!==this._container&&(this.playButton.visible=!1,this.noplayButton.visible=!1,this.pauseButton.visible=!1,this.rewindButton.visible=!1,this.norewindButton.visible=!1,this._compileButton.visible=!1,this._container.visible=!1,docById("myProgress").style.visibility="hidden",this._refreshCanvas())},this._show=function(){null!==this._container&&(this._logo.playbackQueue==={}?(this.playButton.visible=!1,this.noplayButton.visible=!0):(this.playButton.visible=!0,this.noplayButton.visible=!1),this.rewindButton.visible=!1,this.norewindButton.visible=!0,this._compileButton.visible=!0,this.pauseButton.visible=!1,this._container.visible=!0,this._refreshCanvas())},this._createBox=function(t,e,i){if(this._scale=t,null==this._container){this._container=new createjs.Container,this._stage.addChild(this._container),this._container.x=e-225,this._container.y=i-55;this._makeBoxBitmap('<svg xmlns="http://www.w3.org/2000/svg" height="133" width="225" version="1.1"> <rect style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" y="0" x="0" height="133" width="225" /> <g style="fill:#000000;display:block" transform="translate(170,-1)"> <path style="fill:#000000;display:inline" d="m 27.5,5.0 c -12.43,0 -22.5,10.0 -22.5,22.5 0,12.5 10.0,22.5 22.5,22.5 12.5,0 22.5,-10.0 22.5,-22.5 0,-12.5 -10.0,-22.5 -22.5,-22.5 z m 10.0,28.0 c 1.25,1.25 1.25,3.25 0,4.5 -0.5,0.5 -1.5,1.0 -2.25,1.0 -1.0,0 -1.5,-0.25 -2.25,-1.0 l -5.75,-5.75 -5.75,5.75 c -0.5,0.5 -1.5,1.0 -2.25,1.0 -1.0,0 -1.5,-0.25 -2.25,-1.0 -1.25,-1.25 -1.25,-3.25 0.0,-4.5 l 5.75,-5.75 -5.75,-5.75 c -1.25,-1.25 -1.25,-3.25 -0.0,-4.5 1.25,-1.25 3.25,-1.25 4.5,0 l 5.75,5.75 5.75,-5.75 c 1.25,-1.25 3.25,-1.25 4.5,0 1.25,1.25 1.25,3.25 0,4.5 l -5.75,5.75 5.75,5.75 z" /> </g> <rect style="fill:#92b5c8;fill-opacity:1;stroke:none" y="51" x="0" height="82" width="225" /> <rect y="0.75" x="0.75" height="131.5" width="223.5" style="display:inline;visibility:visible;opacity:1;fill:none;fill-opacity:1;stroke:#000000;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;" /></svg>',"pbox",function(t,e,i,s){t._container.addChild(i),t._loadPlaybackContainerHandler(),t.bounds=t._container.getBounds(),t._container.cache(t.bounds.x,t.bounds.y,t.bounds.width,t.bounds.height);var l=new createjs.Shape;l.graphics.beginFill("#FFF").drawRect(t.bounds.x,t.bounds.y,t.bounds.width,t.bounds.height),l.x=0,l.y=0,t._container.hitArea=l},null)}},this._makeBoxBitmap=function(t,e,i,s){var l=new Image,o=this;l.onload=function(){bitmap=new createjs.Bitmap(l),i(o,e,bitmap,s)},l.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t)))},this._loadPlaybackContainerHandler=function(){var e=!1,i=this;i._container.on("click",function(t){if(e)console.log("debouncing click");else{e=!0,setTimeout(function(){e=!1},500);t.stageX,i._scale,i._container.x;t.stageY/i._scale-i._container.y<55&&i.hide()}})}}function PluginsViewer(t,e,i,s,l){this.canvas=t,this.stage=e,this.refreshCanvas=i,this.closeViewer=s,this.loadPlugin=l,this.dict={},this.pluginFiles=[],this.container=null,this.prev=null,this.next=null,this.page=0,this.server=!0,this.setServer=function(t){this.server=t},this.hide=function(){null!==this.container&&(this.container.visible=!1,this.refreshCanvas())},this.show=function(t){if(this.scale=t,this.page=0,this.server)try{var e=httpGet(),i=JSON.parse(e);for(var s in i)if("svg"===fileExt(i[s])){var l=fileBasename(i[s]);-1===this.pluginFiles.indexOf(l)&&this.pluginFiles.push(l)}for(var s in this.pluginFiles){!(this.pluginFiles[s]+".json")in i&&this.pluginFiles.remove(this.pluginFiles[s])}}catch(t){return console.log(t),!1}else this.pluginFiles=SAMPLEPLUGINS;if(console.log("found these projects: "+this.pluginFiles.sort()),null!==this.container)return this.container.visible=!0,this.refreshCanvas(),this.completeInit(),!0;this.container=new createjs.Container,this.stage.addChild(this.container),this.container.x=Math.floor((this.canvas.width/t-650)/2),this.container.y=27,makeViewerBitmap(this,BACKGROUND,"viewer",function(t,e,i,s){t.container.addChild(i),makeViewerBitmap(t,PREVBUTTON,"viewer",function(t,e,i,s){t.prev=i,t.container.addChild(t.prev),t.prev.x=270,t.prev.y=535,makeViewerBitmap(t,NEXTBUTTON,"viewer",function(t,e,i,s){return t.next=i,t.container.addChild(t.next),t.next.x=325,t.next.y=535,t.container.visible=!0,t.refreshCanvas(),t.completeInit(),loadThumbnailContainerHandler(t),!0},null)},null)},null)},this.downloadImage=function(t,e){var i="data:image/svg+xml;utf8,",s=this.pluginFiles[t]+".svg";if(this.server)var l=i+httpGet(s);else l=i+SAMPLESSVG[s];var o=new Image,a=this;o.onload=function(){bitmap=new createjs.Bitmap(l),bitmap.scaleX=.5,bitmap.scaleY=.5,a.container.addChild(bitmap),lastChild=last(a.container.children),a.container.swapChildren(bitmap,lastChild),a.dict[a.pluginFiles[t]]=bitmap,x=5+t%4*160,y=55+120*Math.floor(t%16/4),a.dict[a.pluginFiles[t]].x=x,a.dict[a.pluginFiles[t]].y=y,a.dict[a.pluginFiles[t]].visible=!0,a.refreshCanvas(),null!==e&&e(a,t+1)},o.src=l},this.completeInit=function(){this.prepareNextImage(this,0)},this.prepareNextImage=function(t,e){e<t.pluginFiles.length&&e<16*t.page+16?t.pluginFiles[e]in t.dict?(x=5+e%4*160,y=55+120*Math.floor(e%16/4),t.dict[t.pluginFiles[e]].x=x,t.dict[t.pluginFiles[e]].y=y,t.dict[t.pluginFiles[e]].visible=!0,t.prepareNextImage(t,e+1)):t.downloadImage(e,t.prepareNextImage):(0===t.page&&(t.prev.visible=!1),16*(t.page+1)<t.pluginFiles.length&&(t.next.visible=!0),t.refreshCanvas())}}function hideCurrentPage(t){for(var e=16*t.page,i=Math.min(t.pluginFiles.length,16*(t.page+1)),s=e;s<i;s++)t.dict[t.pluginFiles[s]].visible=!1;t.page-=1,0===t.page&&(t.prev.visible=!1),16*(t.page+1)<t.pluginFiles.length&&(t.next.visible=!0);for(e=16*t.page,i=Math.min(t.pluginFiles.length,16*(t.page+1)),s=e;s<i;s++)t.dict[t.pluginFiles[s]].visible=!0;t.refreshCanvas()}function showNextPage(t){for(var e=16*t.page,i=Math.min(t.pluginFiles.length,16*(t.page+1)),s=e;s<i;s++)t.dict[t.pluginFiles[s]].visible=!1;t.page+=1,t.prev.visible=!0,16*(t.page+1)+1>t.pluginFiles.length&&(t.next.visible=!1),t.prepareNextImage(t,i),t.refreshCanvas()}function viewerClicked(t,e){var i=e.stageX/t.scale-t.container.x,s=e.stageY/t.scale-t.container.y;if(600<i&&s<55)t.hide(),t.closeViewer();else if(535<s)t.prev.visible&&i<325?hideCurrentPage(t):t.next.visible&&325<i&&showNextPage(t);else{var l=Math.floor((i-5)/160),o=4*Math.floor((s-55)/120)+l+16*t.page;o<t.pluginFiles.length&&(t.hide(),t.closeViewer(),t.loadPlugin(t.pluginFiles[o]+".json"))}}function loadThumbnailContainerHandler(e){var i,s,l,o,t=new createjs.Shape;t.graphics.beginFill("#FFF").drawRect(0,0,650,590),t.x=0,t.y=0,e.container.hitArea=t;var a=!1;e.container.on("click",function(t){a?console.log("debouncing click"):(a=!0,setTimeout(function(){a=!1},500),viewerClicked(e,t))}),e.container.on("mousedown",function(t){i=t.stageX,s=t.stageY,a=!0}),e.container.on("pressup",function(t){l=t.stageX,o=t.stageY,s+30<o||i+30<l?e.next.visible&&showNextPage(e):o<s-30||l<i-30?e.prev.visible&&hideCurrentPage(e):(a=!1,viewerClicked(e,t))})}function makeViewerBitmap(t,e,i,s,l){var o=new Image;o.onload=function(){bitmap=new createjs.Bitmap(o),s(t,i,bitmap,l)},o.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e)))}function ProtoBlock(t){this.name=t,this.palette=null,this.style=null,this.generator=null,this.expandable=!1,this.parameter=!1,this.args=0,this.defaults=[],this.size=1,this.dockTypes=[],this.staticLabels=[],this.fontsize=null,this.extraWidth=0,this.scale=DEFAULTBLOCKSCALE,this.image=null,this.hidden=!1,this.disabled=!1,this.deprecated=!1,this.textWidth=0,this.labelOffset=0,this.adjustWidthToLabel=function(){if(0!==this.staticLabels.length){var t=new createjs.Container,e=new createjs.Text(this.staticLabels[0],this.fontSize+"px Sans","#000000");t.addChild(e);var i=t.getBounds();this.textWidth=i.width,this.extraWidth+=Math.max(i.width-30,0)}},this.zeroArgBlock=function(){this.args=0,this.dockTypes.push("out"),this.dockTypes.push("in"),this.generator=this.zeroArgBlockGenerator},this.zeroArgBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setTab(!0),t.setSlot(!0),this.fontsize&&t.setFontSize(this.fontsize),t.setExpand(30+this.extraWidth,0,0,0),[t.basicBlock(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.hiddenBlockFlow=function(){this.args=0,this.size=0,this.dockTypes.push("out"),this.dockTypes.push("in"),this.generator=this.hiddenBlockFlowGenerator},this.hiddenBlockNoFlow=function(){this.args=0,this.size=0,this.dockTypes.push("out"),this.dockTypes.push("unavailable"),this.generator=this.hiddenBlockFlowGenerator},this.hiddenBlockFlowGenerator=function(){var t=new SVG;t.init(),t.setScale(this.scale),t.setSlot(!0),t.setTab(!0),this.fontsize&&t.setFontSize(this.fontsize);t.basicBlock();return t.docks[1][1]=t.docks[0][1],['<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><text style="font-size:10px;fill:#000000;font-family:sans-serif;text-anchor:end"><tspan x="46.333333333333336" y="13.5">block_label</tspan></text></svg>',t.docks,0,0,0]},this.basicBlockNoFlow=function(){this.args=0,this.dockTypes.push("out"),this.dockTypes.push("unavailable"),this.generator=this.basicBlockNoFlowGenerator},this.basicBlockNoFlowGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setSlot(!0),t.setTail(!0),this.fontsize&&t.setFontSize(this.fontsize),t.setExpand(30+this.extraWidth,0,0,0),[t.basicBlock(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.basicBlockCollapsed=function(){this.args=0,this.dockTypes.push("unavailable"),this.dockTypes.push("unavailable"),this.generator=this.basicBlockCollapsedGenerator},this.basicBlockCollapsedGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setCap(!0),t.setTail(!0),this.fontsize&&t.setFontSize(this.fontsize),t.setExpand(30+this.extraWidth,0,0,0),[t.basicBlock(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.oneArgBlock=function(){this.args=1,this.dockTypes.push("out"),this.dockTypes.push("numberin"),this.dockTypes.push("in"),this.generator=this.oneArgBlockGenerator},this.oneArgBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setTab(!0),t.setInnies([!0]),t.setSlot(!0),this.fontsize&&t.setFontSize(this.fontsize),t.setExpand(30+this.extraWidth,0,0,0),[t.basicBlock(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.oneBooleanArgBlock=function(){this.args=1,this.size=1,this.dockTypes.push("out"),this.dockTypes.push("booleanin"),this.dockTypes.push("in"),this.generator=this.oneBooleanArgBlockGenerator},this.oneBooleanArgBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setTab(!0),t.setSlot(!0),t.setBoolean(!0),t.setClampCount(0),this.fontsize&&t.setFontSize(this.fontsize),t.setExpand(30+this.extraWidth,0,0,0),[t.basicBlock(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.twoArgBlock=function(){this.expandable=!0,this.style="twoarg",this.size=2,this.args=2,this.dockTypes.push("out"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("in"),this.generator=this.twoArgBlockGenerator},this.twoArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setInnies([!0,!0]),e.setSlot(!0),t?e.setExpand(30+this.extraWidth,(t-1)*STANDARDBLOCKHEIGHT/2,0,0):e.setExpand(30+this.extraWidth,0,0,0),this.fontsize&&e.setFontSize(this.fontsize),[e.basicBlock(),e.docks,e.getWidth(),e.getHeight(),e.getHeight()]},this.threeArgBlock=function(){this.expandable=!0,this.style="twoarg",this.size=3,this.args=3,this.dockTypes.push("out"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("in"),this.generator=this.threeArgBlockGenerator},this.threeArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setInnies([!0,!0,!0]),e.setSlot(!0),t?e.setExpand(30+this.extraWidth,(t-1)*STANDARDBLOCKHEIGHT/2,0,0):e.setExpand(30+this.extraWidth,0,0,0),this.fontsize&&e.setFontSize(this.fontsize),[e.basicBlock(),e.docks,e.getWidth(),e.getHeight(),e.getHeight()]},this.fourArgBlock=function(){this.expandable=!0,this.style="twoarg",this.size=4,this.args=4,this.dockTypes.push("out"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("in"),this.generator=this.fourArgBlockGenerator},this.fourArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setInnies([!0,!0,!0,!0]),e.setSlot(!0),t?e.setExpand(30+this.extraWidth,(t-1)*STANDARDBLOCKHEIGHT/2,0,0):e.setExpand(30+this.extraWidth,0,0,0),this.fontsize&&e.setFontSize(this.fontsize),[e.basicBlock(),e.docks,e.getWidth(),e.getHeight(),e.getHeight()]},this.oneArgMathBlock=function(){this.style="arg",this.size=1,this.args=1,this.parameter=!0,this.dockTypes.push("numberout"),this.dockTypes.push("numberin"),this.generator=this.oneArgMathBlockGenerator},this.oneArgMathBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setSlot(!1),t.setInnies([!0]),t.setOutie(!0),t.setTab(!1),this.fontsize&&t.setFontSize(this.fontsize),t.setExpand(30+this.extraWidth,0,0,0),[t.basicBlock(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.twoArgMathBlock=function(){this.expandable=!0,this.style="arg",this.size=2,this.args=2,this.parameter=!0,this.dockTypes.push("numberout"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.generator=this.twoArgMathBlockGenerator},this.twoArgMathBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setSlot(!1),e.setInnies([!0,!0]),e.setOutie(!0),e.setTab(!1),t?e.setExpand(30+this.extraWidth,(t-1)*STANDARDBLOCKHEIGHT/2,0,0):e.setExpand(30+this.extraWidth,0,0,0),this.fontsize&&e.setFontSize(this.fontsize),[e.basicBlock(),e.docks,e.getWidth(),e.getHeight(),e.getHeight()]},this.threeArgMathBlock=function(){this.expandable=!0,this.style="arg",this.size=3,this.args=3,this.parameter=!0,this.dockTypes.push("numberout"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.generator=this.threeArgMathBlockGenerator},this.threeArgMathBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setSlot(!1),e.setInnies([!0,!0,!0]),e.setOutie(!0),e.setTab(!1),t?e.setExpand(30+this.extraWidth,(t-1)*STANDARDBLOCKHEIGHT/2,0,0):e.setExpand(30+this.extraWidth,0,0,0),this.fontsize&&e.setFontSize(this.fontsize),[e.basicBlock(),e.docks,e.getWidth(),e.getHeight(),e.getHeight()]},this.valueBlock=function(){this.style="value",this.size=1,this.args=0,this.dockTypes.push("numberout"),this.generator=this.valueBlockGenerator},this.valueBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setExpand(60+this.extraWidth,0,0,0),t.setOutie(!0),this.fontsize&&t.setFontSize(this.fontsize),[t.basicBox(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.mediaBlock=function(){this.style="value",this.size=2,this.args=0,this.dockTypes.push("mediaout"),this.generator=this.mediaBlockGenerator},this.mediaBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setExpand(60+this.extraWidth,23,0,0),t.setOutie(!0),this.fontsize&&t.setFontSize(this.fontsize),[t.basicBox(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.stackClampZeroArgBlock=function(){this.style="clamp",this.expandable=!0,this.size=3,this.args=1,this.dockTypes.push("unavailable"),this.dockTypes.push("in"),this.dockTypes.push("unavailable"),this.generator=this.stackClampZeroArgBlockGenerator},this.stackClampZeroArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setCap(!0),e.setTail(!0),e.setExpand(20+this.extraWidth,0,0,0),e.setLabelOffset(this.labelOffset),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[1][1]]},this.flowClampBlock=function(){this.style="clamp",this.expandable=!0,this.size=2,this.args=1,this.dockTypes.push("out"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.generator=this.flowClampBlockGenerator},this.flowClampBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setSlot(!0),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[1][1]]},this.flowClampOneArgBlock=function(){this.style="clamp",this.expandable=!0,this.size=2,this.args=2,this.dockTypes.push("out"),this.dockTypes.push("numberin"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.generator=this.flowClampOneArgBlockGenerator},this.flowClampOneArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setSlot(!0),e.setInnies([!0]),e.setLabelOffset(this.labelOffset),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[2][1]]},this.flowClampTwoArgBlock=function(){this.style="clamp",this.expandable=!0,this.size=3,this.args=3,this.dockTypes.push("out"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.generator=this.flowClampTwoArgBlockGenerator},this.flowClampTwoArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setSlot(!0),e.setInnies([!0,!0]),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[3][1]]},this.flowClampThreeArgBlock=function(){this.style="clamp",this.expandable=!0,this.size=4,this.args=4,this.dockTypes.push("out"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.dockTypes.push("textin"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.generator=this.flowClampThreeArgBlockGenerator},this.flowClampThreeArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setSlot(!0),e.setInnies([!0,!0,!0]),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[4][1]]},this.argClampOneArgBlock=function(){this.style="argclamp",this.expandable=!0,this.size=3,this.args=2,this.dockTypes.push("out"),this.dockTypes.push("textin"),this.dockTypes.push("anyin"),this.dockTypes.push("in"),this.generator=this.argClampOneArgBlockGenerator},this.argClampOneArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setSlot(!0),e.setInnies([!0]),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,[1]),this.fontsize&&e.setFontSize(this.fontsize),[e.argClamp(),e.docks,e.getWidth(),e.getHeight(),(e.docks[1][1]+e.docks[2][1])/2]},this.argClampOneArgMathBlock=function(){this.style="argclamparg",this.expandable=!0,this.size=3,this.args=2,this.dockTypes.push("anyout"),this.dockTypes.push("textin"),this.dockTypes.push("anyin"),this.generator=this.argClampOneArgMathBlockGenerator},this.argClampOneArgMathBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setInnies([!0]),e.setOutie(!0),e.setTab(!1),e.setSlot(!1),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,[1]),this.fontsize&&e.setFontSize(this.fontsize),[e.argClamp(),e.docks,e.getWidth(),e.getHeight(),(e.docks[1][1]+e.docks[2][1])/2]},this.argClampBlock=function(){this.style="argclamp",this.expandable=!0,this.size=3,this.args=1,this.dockTypes.push("out"),this.dockTypes.push("anyin"),this.dockTypes.push("in"),this.generator=this.argClampBlockGenerator},this.argClampBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setSlot(!0),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,[1]),this.fontsize&&e.setFontSize(this.fontsize),[e.argClamp(),e.docks,e.getWidth(),e.getHeight(),2*e.docks[1][1]/3]},this.argClampMathBlock=function(){this.style="argclamparg",this.expandable=!0,this.size=3,this.args=1,this.dockTypes.push("anyout"),this.dockTypes.push("anyin"),this.generator=this.argClampMathBlockGenerator},this.argClampMathBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setOutie(!0),e.setTab(!1),e.setSlot(!1),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,[1]),this.fontsize&&e.setFontSize(this.fontsize),[e.argClamp(),e.docks,e.getWidth(),e.getHeight(),2*e.docks[1][1]/3]},this.flowClampBooleanArgBlock=function(){this.style="clamp",this.expandable=!0,this.size=3,this.args=2,this.dockTypes.push("out"),this.dockTypes.push("booleanin"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.generator=this.flowClampBooleanArgBlockGenerator},this.flowClampBooleanArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setBoolean(!0),e.setSlot(!0),e.setExpand(this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[2][1]]},this.doubleFlowClampBooleanArgBlock=function(){this.style="doubleclamp",this.expandable=!0,this.size=4,this.args=3,this.dockTypes.push("out"),this.dockTypes.push("booleanin"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.generator=this.doubleFlowClampBooleanArgBlockGenerator},this.doubleFlowClampBooleanArgBlockGenerator=function(t,e){var i=new SVG;return i.init(),i.setScale(this.scale),i.setTab(!0),i.setSlot(!0),i.setBoolean(!0),i.setClampCount(2),e?i.setClampSlots(0,e):i.setClampSlots(0,1),t?i.setClampSlots(1,t):i.setClampSlots(1,1),i.setExpand(this.extraWidth,0,0,0),this.fontsize&&i.setFontSize(this.fontsize),[i.basicClamp(),i.docks,i.getWidth(),i.getHeight(),i.docks[2][1]]},this.flowClampZeroArgBlock=function(){this.style="clamp",this.expandable=!0,this.size=2,this.args=1,this.dockTypes.push("out"),this.dockTypes.push("in"),this.dockTypes.push("in"),this.generator=this.flowClampZeroArgBlockGenerator},this.flowClampZeroArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setTab(!0),e.setSlot(!0),e.setExpand(10+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[1][1]]},this.argFlowClampBlock=function(){this.style="argflowclamp",this.expandable=!0,this.size=3,this.args=1,this.dockTypes.push("anyout"),this.dockTypes.push("in"),this.generator=this.argFlowClampGenerator},this.argFlowClampGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setSlot(!1),e.setOutie(!0),e.setExpand(20+this.extraWidth,0,0,0),t?e.setClampSlots(0,t):e.setClampSlots(0,[1]),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[1][1]]},this.stackClampOneArgBlock=function(){this.style="clamp",this.expandable=!0,this.size=3,this.args=2,this.dockTypes.push("unavailable"),this.dockTypes.push("anyin"),this.dockTypes.push("in"),this.dockTypes.push("unavailable"),this.generator=this.stackClampOneArgBlockGenerator},this.stackClampOneArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),e.setCap(!0),e.setTail(!0),e.setInnies([!0]),e.setExpand(10+this.extraWidth,0,0,0),e.setLabelOffset(this.labelOffset),t?e.setClampSlots(0,t):e.setClampSlots(0,1),this.fontsize&&e.setFontSize(this.fontsize),[e.basicClamp(),e.docks,e.getWidth(),e.getHeight(),e.docks[2][1]]},this.booleanZeroArgBlock=function(){this.style="arg",this.size=1,this.args=0,this.dockTypes.push("booleanout"),this.generator=this.booleanZeroArgBlockGenerator},this.booleanZeroArgBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setExpand(60+this.extraWidth,0,0,4),this.fontsize&&t.setFontSize(this.fontsize),[t.booleanNot(!0),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.booleanOneArgBlock=function(){this.style="arg",this.size=2,this.args=1,this.parameter=!0,this.dockTypes.push("booleanout"),this.dockTypes.push("textin"),this.generator=this.booleanOneArgBlockGenerator},this.booleanOneArgBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setExpand(20+this.extraWidth,0,0,0),this.fontsize&&t.setFontSize(this.fontsize),t.setInnies([!0]),[t.booleanNot(!0),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.booleanOneBooleanArgBlock=function(){this.style="arg",this.size=2,this.args=1,this.parameter=!0,this.dockTypes.push("booleanout"),this.dockTypes.push("booleanin"),this.generator=this.booleanOneBooleanArgBlockGenerator},this.booleanOneBooleanArgBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setExpand(20+this.extraWidth,0,0,0),this.fontsize&&t.setFontSize(this.fontsize),[t.booleanNot(!1),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.booleanTwoBooleanArgBlock=function(){this.style="arg",this.size=3,this.args=2,this.parameter=!0,this.dockTypes.push("booleanout"),this.dockTypes.push("booleanin"),this.dockTypes.push("booleanin"),this.generator=this.booleanTwoBooleanArgBlockGenerator},this.booleanTwoBooleanArgBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setExpand(20+this.extraWidth,0,0,0),this.fontsize&&t.setFontSize(this.fontsize),[t.booleanAndOr(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]},this.booleanTwoArgBlock=function(){this.style="arg",this.size=2,this.args=2,this.parameter=!0,this.expandable=!0,this.dockTypes.push("booleanout"),this.dockTypes.push("numberin"),this.dockTypes.push("numberin"),this.generator=this.booleanTwoArgBlockGenerator},this.booleanTwoArgBlockGenerator=function(t){var e=new SVG;return e.init(),e.setScale(this.scale),t?e.setExpand(10+this.extraWidth,(t-1)*STANDARDBLOCKHEIGHT/2,0,0):e.setExpand(10+this.extraWidth,0,0,0),this.fontsize&&e.setFontSize(this.fontsize),[e.booleanCompare(),e.docks,e.getWidth(),e.getHeight(),e.getHeight()]},this.parameterBlock=function(){this.style="arg",this.parameter=!0,this.size=1,this.args=0,this.dockTypes.push("numberout"),this.generator=this.parameterBlockGenerator},this.parameterBlockGenerator=function(){var t=new SVG;return t.init(),t.setScale(this.scale),t.setExpand(70+this.extraWidth,0,0,0),t.setOutie(!0),this.fontsize&&t.setFontSize(this.fontsize),[t.basicBox(),t.docks,t.getWidth(),t.getHeight(),t.getHeight()]}}var TACAT=(_TACAT={rest:"ignore",square:"ignore",triangle:"ignore",sine:"ignore",sawtooth:"ignore",invert2:"ignore",invert:"ignore",rhythm:"ignore",rhythmruler:"ignore",swing:"ignore",newswing:"ignore",rhythmicdot:"ignore",note:"ignore",harmonic:"ignore",neighbor:"ignore",setvoice:"ignore",synthname:"ignore",setkey:"ignore",drum:"ignore",saveabc:"ignore",savelilypond:"ignore",savesvg:"ignore",flat:"ignore",sharp:"ignore",diminished:"ignore",augmented:"ignore",perfect:"ignore",minor:"ignore",major:"ignore",invertmode:"pitchfactor",transpositionfactor:"pitchfactor",consonantstepsizedown:"pitchfactor",consonantstepsizeup:"pitchfactor",deltapitch:"pitchfactor",mypitch:"pitchfactor",setpitchnumberoffset:"pitchfactor",number2pitch:"pitchfactor",number2octave:"pitchfactor",accidentalname:"ignore",eastindiansolfege:"ignore",notename:"ignore",solfege:"ignore",invert1:"transpose",register:"transpose",settransposition:"transpose",interval:"pitch",accidental:"pitch",hertz:"pitch",pitchnumber:"pitch",scaledegree:"pitch",steppitch:"pitch",pitch:"pitch",oscillator:"ignore",filtertype:"ignore",oscillatortype:"ignore",envelope:"ignore",filter:"ignore",tuplet2:"rhythm",tuplet3:"rhythm",tuplet4:"rhythm",stuplet:"rhythm",rhythm2:"rhythm",timbre:"ignore",modewidget:"ignore",tempo:"ignore",temperament:"ignore",pitchdrummatrix:"ignore",pitchslider:"ignore",musickeyboard:"ignore",pitchstaircase:"ignore",rhythmruler2:"ignore",matrix:"ignore",status:"ignore",mynotevalue:"rhythmfactor",duplicatefactor:"rhythmfactor",skipfactor:"rhythmfactor",osctime:"rhythm",newswing2:"rhythm",backward:"rhythm",skipnotes:"rhythm",duplicatenotes:"rhythm",multiplybeatfactor:"rhythm",tie:"rhythm",rhythmicdot2:"rhythm",rest2:"note",newnote:"note",beatfactor:"rhythmfactor",bpmfactor:"rhythmfactor",measurevalue:"rhythmfactor",beatvalue:"rhythmfactor",notecounter:"rhythmfactor",elapsednotes:"rhythmfactor",elapsednotes2:"rhythmfactor",drift:"rhythmfactor",offbeatdo:"rhythm",onbeatdo:"rhythm",setmasterbpm2:"rhythm",setmasterbpm:"rhythm",setbpm2:"rhythm",setbpm:"rhythm",pickup:"rhythm",meter:"rhythm",staccatofactor:"tonefactor",slurfactor:"tonefactor",amsynth:"ignore",fmsynth:"ignore",duosynth:"ignore",partial:"tone",harmonic2:"tone",neighbor2:"tone",dis:"tone",tremolo:"tone",phaser:"tone",chorus:"tone",vibrato:"tone"},_defineProperty(_TACAT,"setvoice","tone"),_defineProperty(_TACAT,"glide","tone"),_defineProperty(_TACAT,"slur","tone"),_defineProperty(_TACAT,"staccato","tone"),_defineProperty(_TACAT,"newslur","tone"),_defineProperty(_TACAT,"newstaccato","tone"),_defineProperty(_TACAT,"synthname","tone"),_defineProperty(_TACAT,"voicename","tone"),_defineProperty(_TACAT,"settimbre","tone"),_defineProperty(_TACAT,"settemperament","tone"),_defineProperty(_TACAT,"modename","ignore"),_defineProperty(_TACAT,"doubly","pitchchord"),_defineProperty(_TACAT,"intervalname","ignore"),_defineProperty(_TACAT,"measureintervalsemitones","pitchfactor"),_defineProperty(_TACAT,"measureintervalscalar","pitchfactor"),_defineProperty(_TACAT,"semitoneinterval","pitchchord"),_defineProperty(_TACAT,"interval","pitchchord"),_defineProperty(_TACAT,"definemode","pitchchord"),_defineProperty(_TACAT,"movable","pitchchord"),_defineProperty(_TACAT,"modelength","pitchfactor"),_defineProperty(_TACAT,"key","pitchchord"),_defineProperty(_TACAT,"setkey2","pitchchord"),_defineProperty(_TACAT,"drumname","ignore"),_defineProperty(_TACAT,"effectsname","ignore"),_defineProperty(_TACAT,"setdrum","tone"),_defineProperty(_TACAT,"playdrum","tone"),_defineProperty(_TACAT,"heading","coord"),_defineProperty(_TACAT,"y","coord"),_defineProperty(_TACAT,"x","coord"),_defineProperty(_TACAT,"clear","forward"),_defineProperty(_TACAT,"controlpoint2","ignore"),_defineProperty(_TACAT,"controlpoint1","ignore"),_defineProperty(_TACAT,"bezier","arc"),_defineProperty(_TACAT,"arc","arc"),_defineProperty(_TACAT,"setheading","setxy"),_defineProperty(_TACAT,"setxy","setxy"),_defineProperty(_TACAT,"right","forward"),_defineProperty(_TACAT,"left","forward"),_defineProperty(_TACAT,"back","forward"),_defineProperty(_TACAT,"forward","forward"),_defineProperty(_TACAT,"beginfill","fill"),_defineProperty(_TACAT,"endfill","fill"),_defineProperty(_TACAT,"fillscreen","fill"),_defineProperty(_TACAT,"grey","pen"),_defineProperty(_TACAT,"shade","pen"),_defineProperty(_TACAT,"color","pen"),_defineProperty(_TACAT,"pensize","pen"),_defineProperty(_TACAT,"setfont","pen"),_defineProperty(_TACAT,"background","fill"),_defineProperty(_TACAT,"hollowline","fill"),_defineProperty(_TACAT,"fill","fill"),_defineProperty(_TACAT,"penup","pen"),_defineProperty(_TACAT,"pendown","pen"),_defineProperty(_TACAT,"setpensize","pen"),_defineProperty(_TACAT,"settranslucency","pen"),_defineProperty(_TACAT,"sethue","pen"),_defineProperty(_TACAT,"setshade","pen"),_defineProperty(_TACAT,"setgrey","pen"),_defineProperty(_TACAT,"setcolor","pen"),_defineProperty(_TACAT,"int","boolean"),_defineProperty(_TACAT,"not","boolean"),_defineProperty(_TACAT,"and","boolean"),_defineProperty(_TACAT,"or","boolean"),_defineProperty(_TACAT,"greater","boolean"),_defineProperty(_TACAT,"less","boolean"),_defineProperty(_TACAT,"equal","boolean"),_defineProperty(_TACAT,"boolean","boolean"),_defineProperty(_TACAT,"eval","ignore"),_defineProperty(_TACAT,"mod","number"),_defineProperty(_TACAT,"power","number"),_defineProperty(_TACAT,"sqrt","number"),_defineProperty(_TACAT,"abs","number"),_defineProperty(_TACAT,"divide","number"),_defineProperty(_TACAT,"multiply","number"),_defineProperty(_TACAT,"neg","number"),_defineProperty(_TACAT,"minus","number"),_defineProperty(_TACAT,"plus","number"),_defineProperty(_TACAT,"oneOf","random"),_defineProperty(_TACAT,"random","random"),_defineProperty(_TACAT,"number","ignore"),_defineProperty(_TACAT,"incrementOne","box"),_defineProperty(_TACAT,"increment","box"),_defineProperty(_TACAT,"box","ignore"),_defineProperty(_TACAT,"namedbox","ignore"),_defineProperty(_TACAT,"storein2","box"),_defineProperty(_TACAT,"storein","box"),_defineProperty(_TACAT,"do","action"),_defineProperty(_TACAT,"return","action"),_defineProperty(_TACAT,"returnToUrl","action"),_defineProperty(_TACAT,"calc","action"),_defineProperty(_TACAT,"namedcalc","action"),_defineProperty(_TACAT,"nameddoArg","action"),_defineProperty(_TACAT,"namedcalcArg","action"),_defineProperty(_TACAT,"doArg","action"),_defineProperty(_TACAT,"calcArg","action"),_defineProperty(_TACAT,"arg","action"),_defineProperty(_TACAT,"namedarg","action"),_defineProperty(_TACAT,"listen","action"),_defineProperty(_TACAT,"dispatch","action"),_defineProperty(_TACAT,"start","ignore"),_defineProperty(_TACAT,"action","action"),_defineProperty(_TACAT,"nameddo","action"),_defineProperty(_TACAT,"loaHeapFromApp","box"),_defineProperty(_TACAT,"saveHeapToApp","box"),_defineProperty(_TACAT,"showHeap","box"),_defineProperty(_TACAT,"heapLength","box"),_defineProperty(_TACAT,"heapEmpty","box"),_defineProperty(_TACAT,"emptyHeap","box"),_defineProperty(_TACAT,"saveHeap","programming"),_defineProperty(_TACAT,"loadHeap","programming"),_defineProperty(_TACAT,"indexHeap","box"),_defineProperty(_TACAT,"setHeapEntry","box"),_defineProperty(_TACAT,"pop","box"),_defineProperty(_TACAT,"push","box"),_defineProperty(_TACAT,"leftpos","ignore"),_defineProperty(_TACAT,"rightpos","ignore"),_defineProperty(_TACAT,"toppos","ignore"),_defineProperty(_TACAT,"bottompos","ignore"),_defineProperty(_TACAT,"width","ignore"),_defineProperty(_TACAT,"height","ignore"),_defineProperty(_TACAT,"stopplayback","ignore"),_defineProperty(_TACAT,"playback","ignore"),_defineProperty(_TACAT,"speak","media"),_defineProperty(_TACAT,"camera","ignore"),_defineProperty(_TACAT,"video","ignore"),_defineProperty(_TACAT,"loadFile","ignore"),_defineProperty(_TACAT,"stopvideocam","ignore"),_defineProperty(_TACAT,"tone","media"),_defineProperty(_TACAT,"tofrequency","media"),_defineProperty(_TACAT,"turtleshell","media"),_defineProperty(_TACAT,"show","media"),_defineProperty(_TACAT,"media","ignore"),_defineProperty(_TACAT,"text","ignore"),_defineProperty(_TACAT,"hiddennoflow","ignore"),_defineProperty(_TACAT,"hidden","ignore"),_defineProperty(_TACAT,"defaultcase","ignore"),_defineProperty(_TACAT,"case","ignore"),_defineProperty(_TACAT,"switch","iften"),_defineProperty(_TACAT,"clamp","ignore"),_defineProperty(_TACAT,"break","ignore"),_defineProperty(_TACAT,"waitFor","ifthen"),_defineProperty(_TACAT,"until","ifthen"),_defineProperty(_TACAT,"while","ifthen"),_defineProperty(_TACAT,"ifthenelse","ifthen"),_defineProperty(_TACAT,"if","ifthen"),_defineProperty(_TACAT,"forever","repeat"),_defineProperty(_TACAT,"repeat","repeat"),_defineProperty(_TACAT,"nopValueBlock","ignore"),_defineProperty(_TACAT,"nopOneArgMathBlock","ignore"),_defineProperty(_TACAT,"nopTwoArgMathBlock","ignore"),_defineProperty(_TACAT,"nopZeroArgBlock","ignore"),_defineProperty(_TACAT,"nopOneArgBlock","ignore"),_defineProperty(_TACAT,"nopTwoArgBlock","ignore"),_defineProperty(_TACAT,"nopThreeArgBlock","ignore"),_defineProperty(_TACAT,"openpalette","programming"),_defineProperty(_TACAT,"deleteblock","programming"),_defineProperty(_TACAT,"moveblock","programming"),_defineProperty(_TACAT,"runblock","programming"),_defineProperty(_TACAT,"dockblock","programming"),_defineProperty(_TACAT,"makeblock","programming"),_defineProperty(_TACAT,"saveabc","ignore"),_defineProperty(_TACAT,"savelilypond","ignore"),_defineProperty(_TACAT,"savesvg","ignore"),_defineProperty(_TACAT,"nobackground","ignore"),_defineProperty(_TACAT,"showblocks","ignore"),_defineProperty(_TACAT,"hideblocks","ignore"),_defineProperty(_TACAT,"openProject","ignore"),_defineProperty(_TACAT,"vspace","ignore"),_defineProperty(_TACAT,"hspace","ignore"),_defineProperty(_TACAT,"wait","ignore"),_defineProperty(_TACAT,"comment","ignore"),_defineProperty(_TACAT,"print","ignore"),_defineProperty(_TACAT,"pitchness","sensor"),_defineProperty(_TACAT,"loudness","sensor"),_defineProperty(_TACAT,"myclick","sensor"),_defineProperty(_TACAT,"getblue","sensor"),_defineProperty(_TACAT,"getgreen","sensor"),_defineProperty(_TACAT,"getred","sensor"),_defineProperty(_TACAT,"getcolorpixel","sensor"),_defineProperty(_TACAT,"time","sensor"),_defineProperty(_TACAT,"mousey","sensor"),_defineProperty(_TACAT,"mousex","sensor"),_defineProperty(_TACAT,"mousebutton","sensor"),_defineProperty(_TACAT,"toascii","sensor"),_defineProperty(_TACAT,"keyboard","sensor"),_defineProperty(_TACAT,"stopTurtle","mice"),_defineProperty(_TACAT,"startTurtle","mice"),_defineProperty(_TACAT,"turtlecolor","mice"),_defineProperty(_TACAT,"turtleheading","mice"),_defineProperty(_TACAT,"setxyturtle","mice"),_defineProperty(_TACAT,"yturtle","mice"),_defineProperty(_TACAT,"xturtle","mice"),_defineProperty(_TACAT,"turtleelapsednotes","mice"),_defineProperty(_TACAT,"turtlepitch","mice"),_defineProperty(_TACAT,"turtlenote","mice"),_defineProperty(_TACAT,"turtlenote2","mice"),_defineProperty(_TACAT,"turtlesync","mice"),_defineProperty(_TACAT,"turtlename","ignore"),_defineProperty(_TACAT,"setturtlename","mice"),_defineProperty(_TACAT,"setturtlename2","mice"),_defineProperty(_TACAT,"notevolumefactor","tone"),_defineProperty(_TACAT,"setsynthvolume2","tone"),_defineProperty(_TACAT,"setsynthvolume","tone"),_defineProperty(_TACAT,"setnotevolume","tone"),_defineProperty(_TACAT,"setnotevolume2","tone"),_defineProperty(_TACAT,"articulation","tone"),_defineProperty(_TACAT,"crescendo","tone"),_TACAT),TAPAL=(_TAPAL={beat:"notesp",note:"notesp",rhythm:"notesp",rhythmfactor:"notesp"},_defineProperty(_TAPAL,"rhythmfactor","notesp"),_defineProperty(_TAPAL,"pitch","pitchp"),_defineProperty(_TAPAL,"pitchchord","pitchp"),_defineProperty(_TAPAL,"transpose","pitchp"),_defineProperty(_TAPAL,"pitchfactor","pitchp"),_defineProperty(_TAPAL,"tone","tonep"),_defineProperty(_TAPAL,"forward","turtlep"),_defineProperty(_TAPAL,"arc","turtlep"),_defineProperty(_TAPAL,"coord","turtlep"),_defineProperty(_TAPAL,"setxy","turtlep"),_defineProperty(_TAPAL,"pen","penp"),_defineProperty(_TAPAL,"fill","penp"),_defineProperty(_TAPAL,"random","numberp"),_defineProperty(_TAPAL,"boolean","numberp"),_defineProperty(_TAPAL,"repeat","flowp"),_defineProperty(_TAPAL,"ifthen","flowp"),_defineProperty(_TAPAL,"action","boxp"),_defineProperty(_TAPAL,"box","boxp"),_defineProperty(_TAPAL,"sensor","sensorp"),_defineProperty(_TAPAL,"media","mediap"),_defineProperty(_TAPAL,"mice","micep"),_defineProperty(_TAPAL,"number","numberp"),_defineProperty(_TAPAL,"programming","numberp"),_defineProperty(_TAPAL,"ignore","numberp"),_TAPAL),TASCORE=(_TASCORE={note:1,rhythmfactor:1,beat:10,rhythm:5},_defineProperty(_TASCORE,"rhythmfactor",5),_defineProperty(_TASCORE,"pitchchord",3),_defineProperty(_TASCORE,"pitch",1),_defineProperty(_TASCORE,"transpose",5),_defineProperty(_TASCORE,"pitchfactor",5),_defineProperty(_TASCORE,"tone",5),_defineProperty(_TASCORE,"forward",3),_defineProperty(_TASCORE,"arc",3),_defineProperty(_TASCORE,"setxy",2.5),_defineProperty(_TASCORE,"coord",4),_defineProperty(_TASCORE,"turtlep",5),_defineProperty(_TASCORE,"pen",2.5),_defineProperty(_TASCORE,"fill",2.5),_defineProperty(_TASCORE,"penp",5),_defineProperty(_TASCORE,"number",.5),_defineProperty(_TASCORE,"boolean",2.5),_defineProperty(_TASCORE,"random",2.5),_defineProperty(_TASCORE,"repeat",2.5),_defineProperty(_TASCORE,"ifthen",5),_defineProperty(_TASCORE,"flowp",2.5),_defineProperty(_TASCORE,"box",2.5),_defineProperty(_TASCORE,"action",2.5),_defineProperty(_TASCORE,"boxp",0),_defineProperty(_TASCORE,"media",5),_defineProperty(_TASCORE,"mediap",0),_defineProperty(_TASCORE,"programming",5),_defineProperty(_TASCORE,"mice",7.5),_defineProperty(_TASCORE,"micep",2.5),_defineProperty(_TASCORE,"ignore",0),_defineProperty(_TASCORE,"sensor",5),_defineProperty(_TASCORE,"sensorp",0),_TASCORE),PALS=["notesp","pitchp","tonep","turtlep","penp","numberp","flowp","boxp","sensorp","mediap","micep"],PALLABELS=[_("rhythm"),_("pitch"),_("tone"),_("mouse"),_("pen"),_("number"),_("flow"),_("action"),_("sensors"),_("media"),_("mice")];function analyzeProject(t){for(var e=[],i=0;i<t.blockList.length;i++)if(!t.blockList[i].trash){switch(t.blockList[i].name){case"rhythmicdot":case"tie":case"drift":case"osctime":case"sharp":case"flat":case"fill":case"hollowline":case"start":if(null==t.blockList[i].connections[1])continue;break;case"note":case"multiplybeatfactor":case"duplicatenotes":case"skipnotes":case"setbpm":case"settransposition":case"staccato":case"slur":case"swing":case"crescendo":case"setnotevolume2":case"vibrato":case"tremolo":case"dis":case"chorus":case"phaser":case"action":if(null==t.blockList[i].connections[2])continue;break;case"tuplet2":if(null==t.blockList[i].connections[3])continue;break;case"invert":if(null==t.blockList[i].connections[4])continue;break;default:if(null==t.blockList[i].connections[0]&&null==last(t.blockList[i].connections))continue}e.push(t.blockList[i].name)}scores=[];for(var s=0;s<PALS.length;s++)scores.push(0);cats=[],pals=[];for(var l=0;l<e.length;l++)e[l]in TACAT?TACAT[e[l]]in cats||cats.push(TACAT[e[l]]):console.log(e[l]+" not in catalog");for(var o=0;o<cats.length;o++)cats[o]in TAPAL&&(TAPAL[cats[o]]in pals||pals.push(TAPAL[cats[o]]));for(o=0;o<cats.length;o++)cats[o]in TASCORE&&(scores[PALS.indexOf(TAPAL[cats[o]])]+=TASCORE[cats[o]]);for(var a=0;a<pals.length;a++)pals[a]in TASCORE&&(scores[PALS.indexOf(pals[a])]+=TASCORE[pals[a]]);return scores}function scoreToChartData(t){for(var e=[],i=0,s=0;s<t.length;s++)t[s]>i&&(i=t[s]);if(0<i)var l=100/i;else l=1;1<l&&(l=1);for(s=0;s<t.length;s++)e.push(t[s]*l);return{labels:PALLABELS,datasets:[{label:"",fillColor:"rgba(220,220,220,0.4)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:e}]}}function getChartOptions(t){return{onAnimationComplete:t,scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.2)",angleLineWidth:10,pointLabelFontFamily:"Arial",pointLabelFontStyle:"normal",pointLabelFontSize:30,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:18,pointDotStrokeWidth:6,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:12,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'}}function Toolbar(){var n=jQuery.noConflict(),s="#ea174c",i=localStorage.languagePreference;void 0===i&&(i=navigator.language);var r=!1;if(this.renderLogoIcon=function(t){var e=docById("mb-logo");"ja"===i&&(e.innerHTML='<img style="width: 100%;" src="images/logo-ja.svg">'),e.onmouseenter=function(){document.body.style.cursor="pointer"},e.onmouseleave=function(){document.body.style.cursor="default"},e.onclick=function(){t()}},this.renderPlayIcon=function(t){var e=docById("play"),i=docById("stop");e.onclick=function(){t(),i.style.color=s}},this.renderStopIcon=function(t){var e=docById("stop");e.onclick=function(){t(),e.style.color="white"}},this.renderNewProjectIcon=function(t){docById("new-project").onclick=function(){t()}},this.renderLoadIcon=function(t){docById("load").onclick=function(){t()}},this.renderSaveIcons=function(s,l,o,a,n,r,c,h){var t=docById("saveButton"),e=docById("saveButtonAdvanced");beginnerMode?(e.style.display="block",e.style.display="none",t.onclick=function(){s()}):(t.style.display="none",e.style.display="block",e.onclick=function(){docById("save-html").onclick=function(){s()};var t=docById("save-svg"),e=docById("save-png");if(""==l(canvas,logo,turtles,canvas.width,canvas.height,1)?(t.disabled=!0,e.disabled=!0,t.className="grey-text inactiveLink",e.className="grey-text inactiveLink"):(t.disabled=!1,e.disabled=!1,t.className="",e.className="",t.onclick=function(){o()},e.onclick=function(){a()}),_THIS_IS_MUSIC_BLOCKS_){var i=docById("save-wav");platform.FF?(i.disabled=!0,i.className="grey-text inactiveLink"):i.onclick=function(){n()},docById("save-ly").onclick=function(){r()},docById("save-abc").onclick=function(){c()}}docById("save-blockartwork-svg").onclick=function(){h()}})},this.renderPlanetIcon=function(t,e){var i=docById("planetIcon"),s=docById("planetIconDisabled");t?i.onclick=function(){docById("toolbars").style.display="none",docById("wheelDiv").style.display="none",docById("helpDiv").style.display="none",docById("contextWheelDiv").style.display="none",e()}:(i.style.display="none",s.style.display="block")},this.renderMenuIcon=function(t){var e=docById("menu"),i=docById("aux-toolbar");e.onclick=function(){""==i.style.display||"none"==i.style.display?(t(!1),i.style.display="block",e.innerHTML="more_vert",docById("toggleAuxBtn").className="blue darken-1"):(t(!0),i.style.display="none",e.innerHTML="menu",docById("toggleAuxBtn").className-="blue darken-1")}},this.renderHelpIcon=function(t){docById("helpIcon").onclick=function(){t()}},this.renderModeSelectIcon=function(t){if(_THIS_IS_MUSIC_BLOCKS_){var e=docById("beginnerMode"),i=docById("advancedMode");"none"===e.style.display?i.onclick=function(){t()}:e.onclick=function(){t()}}},this.renderRunSlowlyIcon=function(t){var e=docById("runSlowlyIcon");_THIS_IS_MUSIC_BLOCKS_&&beginnerMode&&"ja"===i&&(e.style.display="none"),e.onclick=function(){t(),docById("stop").style.color=s}},this.renderRunStepIcon=function(t){var e=docById("runStepByStepIcon");_THIS_IS_MUSIC_BLOCKS_&&beginnerMode&&"ja"===i&&(e.style.display="none"),e.onclick=function(){t(),docById("stop").style.color=s}},this.renderAdvancedIcons=function(t,e,i,s,l){var o=docById("displayStatsIcon"),a=docById("loadPluginIcon"),n=docById("delPluginIcon"),r=docById("enableHorizScrollIcon"),c=docById("disableHorizScrollIcon");_THIS_IS_MUSIC_BLOCKS_&&beginnerMode?(o.style.display="none",a.style.display="none",n.style.display="none",r.style.display="none"):(o.onclick=function(){t()},a.onclick=function(){e()},n.onclick=function(){i()},r.onclick=function(){s(),l()},c.onclick=function(){s(),l()})},this.renderMergeIcon=function(t){docById("mergeWithCurrentIcon").onclick=function(){t()}},this.renderRestoreIcon=function(t){docById("restoreIcon").onclick=function(){t()}},this.renderLanguageSelectIcon=function(t){docById("languageSelectIcon").onclick=function(){docById("enUS").onclick=function(){t.enUS_onclick()},docById("enUK").onclick=function(){t.enUK_onclick()},docById("es").onclick=function(){t.es_onclick()},docById("pt").onclick=function(){t.pt_onclick()},docById("ja").onclick=function(){t.ja_onclick()},docById("kana").onclick=function(){t.kana_onclick()},docById("zhCN").onclick=function(){t.zhCN_onclick()},docById("th").onclick=function(){t.th_onclick()},docById("ayc").onclick=function(){t.ayc_onclick()},docById("gug").onclick=function(){t.gug_onclick()},docById("hi").onclick=function(){t.hi_onclick()},docById("ibo").onclick=function(){t.ibo_onclick()},docById("ar").onclick=function(){t.ar_onclick()},docById("he").onclick=function(){t.he_onclick()}}},_THIS_IS_MUSIC_BLOCKS_)var c=[["mb-logo",_("About Music Blocks")],["play",_("Play")],["stop",_("Stop")],["newFile",_("New project")],["load",_("Load project from file")],["saveButton",_("Save project")],["saveButtonAdvanced",_("Save project as HTML")],["planetIcon",_("Find and share projects")],["planetIconDisabled",_("Offline. Sharing is unavailable")],["toggleAuxBtn",_("Auxilary menu")],["helpIcon",_("Help")],["runSlowlyIcon",_("Run slowly")],["runStepByStepIcon",_("Run step by step")],["displayStatsIcon",_("Display statistics")],["loadPluginIcon",_("Load plugin")],["delPluginIcon",_("Delete plugin")],["enableHorizScrollIcon",_("Enable horizontal scrolling")],["disableHorizScrollIcon",_("Disable horizontal scrolling")],["mergeWithCurrentIcon",_("Merge with current project")],["restoreIcon",_("Restore")],["beginnerMode",_("Switch to beginner mode")],["advancedMode",_("Switch to advanced mode")],["languageSelectIcon",_("Select language")],["save-html",_("Save project as HTML"),"innerHTML"],["save-svg",_("Save mouse artwork as SVG"),"innerHTML"],["save-png",_("Save mouse artwork as PNG"),"innerHTML"],["save-wav",_("Save music as WAV"),"innerHTML"],["save-abc",_("Save sheet music as ABC"),"innerHTML"],["save-ly",_("Save sheet music as Lilypond"),"innerHTML"],["save-blockartwork-svg",_("Save block artwork as SVG"),"innerHTML"],["new-project",_("Confirm"),"innerHTML"],["enUS",_("English (United States)"),"innerHTML"],["enUK",_("English (United Kingdom)"),"innerHTML"],["ja",_(""),"innerHTML"],["es",_("espaol"),"innerHTML"],["pt",_("portugus"),"innerHTML"],["kana",_(""),"innerHTML"],["zhCN",_(""),"innerHTML"],["th",_(""),"innerHTML"],["ayc",_("aymara"),"innerHTML"],["gug",_("guarani"),"innerHTML"],["hi",_(""),"innerHTML"],["ibo",_("igbo"),"innerHTML"],["ar",_(""),"innerHTML"],["he",_(""),"innerHTML"]],h=[_("About Music Blocks"),_("Play"),_("Stop"),_("New project"),_("Load project from file"),_("Save project"),_("Save project"),_("Find and share projects"),_("Offline. Sharing is unavailable"),_("Auxilary menu"),_("Help"),_("Run slowly"),_("Run step by step"),_("Display statistics"),_("Load plugin"),_("Delete plugin"),_("Enable horizontal scrolling"),_("Disable horizontal scrolling"),_("Merge with current project"),_("Restore"),_("Switch to beginner mode"),_("Switch to advanced mode"),_("Select language"),_("Save project as HTML"),_("Save mouse artwork as SVG"),_("Save mouse artwork as PNG"),_("Save music as WAV"),_("Save sheet music as ABC"),_("Save sheet music as Lilypond"),_("Save block artwork as SVG"),_("Confirm"),_("Select language")];else c=[["mb-logo",_("About Turtle Blocks")],["play",_("Play")],["stop",_("Stop")],["newFile",_("New project")],["load",_("Load project from file")],["saveButton",_("Save project")],["saveButtonAdvanced",_("Save project as HTML")],["planetIcon",_("Find and share projects")],["planetIconDisabled",_("Offline. Sharing is unavailable")],["toggleAuxBtn",_("Auxilary menu")],["helpIcon",_("Help")],["runSlowlyIcon",_("Run slowly")],["runStepByStepIcon",_("Run step by step")],["displayStatsIcon",_("Display statistics")],["loadPluginIcon",_("Load plugin")],["delPluginIcon",_("Delete plugin")],["enableHorizScrollIcon",_("Enable horizontal scrolling")],["disableHorizScrollIcon",_("Disable horizontal scrolling")],["mergeWithCurrentIcon",_("Merge with current project")],["restoreIcon",_("Restore")],["languageSelectIcon",_("Select language")],["save-html",_("Save project as HTML"),"innerHTML"],["save-svg",_("Save mouse artwork as SVG"),"innerHTML"],["save-png",_("Save mouse artwork as PNG"),"innerHTML"],["save-blockartwork-svg",_("Save block artwork as SVG"),"innerHTML"],["new-project",_("Confirm"),"innerHTML"],["enUS",_("English (United States)"),"innerHTML"],["enUK",_("English (United Kingdom)"),"innerHTML"],["ja",_(""),"innerHTML"],["es",_("espaol"),"innerHTML"],["pt",_("portugus"),"innerHTML"],["kana",_(""),"innerHTML"],["zhCN",_(""),"innerHTML"],["th",_(""),"innerHTML"],["ayc",_("aymara"),"innerHTML"],["gug",_("guarani"),"innerHTML"],["hi",_(""),"innerHTML"],["ibo",_("igbo"),"innerHTML"],["ar",_(""),"innerHTML"],["he",_(""),"innerHTML"]],h=[_("About Turtle Blocks"),_("Play"),_("Stop"),_("New project"),_("Load project from file"),_("Save project"),_("Save project"),_("Find and share projects"),_("Offline. Sharing is unavailable"),_("Auxilary menu"),_("Help"),_("Run slowly"),_("Run step by step"),_("Display statistics"),_("Load plugin"),_("Delete plugin"),_("Enable horizontal scrolling"),_("Disable horizontal scrolling"),_("Merge with current project"),_("Restore"),_("Select language"),_("Save project as HTML"),_("Save turtle artwork as SVG"),_("Save turtle artwork as PNG"),_("Save block artwork as SVG"),_("Confirm"),_("Select language")];this.init=function(t){if(_THIS_IS_MUSIC_BLOCKS_){var e=docById("beginnerMode"),i=docById("advancedMode");t||"null"===t?(i.style.display="block",e.style.display="none"):(i.style.display="none",e.style.display="display")}for(var s=0;s<c.length;s++){var l=c[s],o=h[s],a=docById(l[0]);3===c[s].length?a.innerHTML=l[1]:a.setAttribute("data-tooltip",o)}r||n(".tooltipped").tooltip({html:!0,delay:100}),n(".materialize-iso, .dropdown-trigger").dropdown({constrainWidth:!1,hover:!1,belowOrigin:!0})},this.disableTooltips=function(t){t(".tooltipped").tooltip("remove"),r=!0},this.closeAuxToolbar=function(t){if("block"===auxToolbar.style.display){t(!1);var e=docById("menu");auxToolbar.style.display="none",e.innerHTML="menu",docById("toggleAuxBtn").className-="blue darken-1"}}}define(["sugar-web/env","sugar-web/activity/activity","sugar-web/datastore"],function(e,i,s){var t={activity:i,data:{allProjects:"[]"},env:e,xoColor:{stroke:"#00A0FF",fill:"#8BFF7A"},saveLocally:function(t){i.getDatastoreObject().setDataAsText(JSON.stringify(this.data)),i.getDatastoreObject().save(function(){t&&t()})},isInsideSugarizer:function(){return!1},loadData:function(s){var l=this;i.getDatastoreObject().loadAsText(function(t,e,i){null!=i&&(l.data=JSON.parse(i)),e.buddy_color&&(l.xoColor=e.buddy_color),void 0!==s&&s()})},hideLoading:function(){document.getElementById("loading-image-container").style.display="none"},sugarizerStop:function(){document.getElementById("stop-button").click()},getLanguage:function(){var t={name:"",language:"undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language};return e.isSugarizer()?s.localStorage.getValue("sugar_settings").language:(callback(),t.language)},setup:function(){console.log("insideSugarizer? "+this.isInsideSugarizer()),!1!==this.isInsideSugarizer()&&(this.hideLoading(),i.setup())}};return(window.sugarizerCompatibility=t).setup(),t});var TRASHWIDTH=120,TRASHHEIGHT=120;function Trashcan(){this.isVisible=!1,this._canvas=null,this._stage=null,this._size=null,this._refreshCanvas=null,this._scale=1,this._iconsize=55,this._container=new createjs.Container,this._borderHighlightBitmap=null,this._isHighlightInitialized=!1,this._inAnimation=!1,this._animationInterval=null,this._highlightPower=255,this._animationLevel=0,this.animationTime=500,this.init=function(){this._stage.addChild(this._container),this._stage.setChildIndex(this._container,0),this.resizeEvent(1),this._makeTrash()},this.setCanvas=function(t){return this._canvas=t,this},this.setStage=function(t){return this._stage=t,this},this.setSize=function(t){return this._size=t,this},this.setRefreshCanvas=function(t){return this._refreshCanvas=t,this},this._makeBorderHighlight=function(t){var e=new Image,i=this;e.onload=function(){i._borderHighlightBitmap=new createjs.Bitmap(e),i._borderHighlightBitmap.scaleX=i._size/i._iconsize,i._borderHighlightBitmap.scaleY=i._size/i._iconsize,i._isHighlightInitialized?i._container.removeChildAt(i._container.children.length-1):(i._container.visible=!1,i._isHighlightInitialized=!0),i._container.addChild(i._borderHighlightBitmap),i._borderHighlightBitmap.visible=!0};var s="rgb("+this._highlightPower+","+this._highlightPower+","+this._highlightPower+")";t&&(s=platformColor.trashActive),e.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(BORDER.replace("stroke_color",s))))},this._makeBorder=function(){var t=new Image,e=this;t.onload=function(){border=new createjs.Bitmap(t),bitmap.scaleX=e._size/e._iconsize,bitmap.scaleY=e._size/e._iconsize,e._container.addChild(border),e._makeBorderHighlight(!1)},t.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(BORDER.replace("stroke_color",platformColor.trashBorder))))},this._makeTrash=function(){var t=new Image,e=this;t.onload=function(){bitmap=new createjs.Bitmap(t),e._container.addChild(bitmap),e._iconsize=bitmap.getBounds().width,bitmap.scaleX=e._size/e._iconsize,bitmap.scaleY=e._size/e._iconsize,bitmap.x=(TRASHWIDTH-e._size)/2*bitmap.scaleX,bitmap.y=(TRASHHEIGHT-e._size)/2*bitmap.scaleY,e._makeBorder()},t.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(TRASHICON.replace(/fill_color/g,platformColor.trashBorder))))},this.resizeEvent=function(t){this._scale=t,this._container.x=(this._canvas.width/this._scale-TRASHWIDTH)/2,this._container.y=this._canvas.height/this._scale-TRASHHEIGHT},this.hide=function(){createjs.Tween.get(this._container).to({alpha:0},200).set({visible:!1})},this.show=function(){this.stopHighlightAnimation(),createjs.Tween.get(this._container).to({alpha:0,visible:!0}).to({alpha:1},200)},this.startHighlightAnimation=function(){if(!this._inAnimation){this._inAnimation=!0;var t=this;this._animationInterval=setInterval(function(){if(t._animationLevel+=20,t._animationLevel>=t.animationTime)return t.isVisible=!0,t._makeBorderHighlight(!0),t._refreshCanvas(),void clearInterval(t._animationInterval);t._highlightPower=parseInt(255-t._animationLevel/t.animationTime*255,10),t._makeBorderHighlight(!1),t._refreshCanvas()},20),this._switchHighlightVisibility(!0)}},this.stopHighlightAnimation=function(){this._inAnimation&&(clearInterval(this._animationInterval),this._inAnimation=!1,this.isVisible=!1,this._animationLevel=0,this._highlightPower=255,this._makeBorderHighlight(!1),this._switchHighlightVisibility(!1))},this._switchHighlightVisibility=function(t){last(this._container.children).visible=t,this._container.children[1].visible=!t,this._container.visible=!0,this._refreshCanvas()},this.overTrashcan=function(t,e){var i=this._container.x,s=this._container.y;return!(t<i)&&(!(i+TRASHWIDTH<t)&&!(e<s))}}var DEFAULTCOLOR=0,DEFAULTVALUE=50,DEFAULTCHROMA=100,DEFAULTSTROKE=5,DEFAULTFONT="sans-serif",SCALEFACTOR=4,TURTLEBASEPATH="images/";function Turtle(t,e,s){this.name=t,this.turtles=e,(this.drum=s)&&console.log("turtle "+t+" is a drum."),this.running=!1,this.trash=!1,this.container=null,this.x=0,this.y=0,this.bitmap=null,this.skinChanged=!1,this.shellSize=55,this.blinkFinished=!0,this.isSkinChanged=!1,this._sizeInUse=1,this._isSkinChanged=!1,this.beforeBlinkSize=null,this.startBlock=null,this.decorationBitmap=null,this.queue=[],this.listeners={},this.penstrokes=null,this.imageContainer=null,this.svgOutput="",this.svgPath=!1,this.color=DEFAULTCOLOR,this.value=DEFAULTVALUE,this.chroma=DEFAULTCHROMA,this.stroke=DEFAULTSTROKE,this.canvasColor="rgba(255,0,49,1)",this.canvasAlpha=1,this.orientation=0,this.fillState=!1,this.hollowState=!1,this.penState=!0,this.font=DEFAULTFONT,this.media=[];var y=document.getElementById("overlayCanvas"),q=y.getContext("2d");console.log(q.canvas.width+" x "+q.canvas.height),this.doScrollXY=function(t,e){var i=q.getImageData(0,0,q.canvas.width+t,q.canvas.height+t);q.putImageData(i,t,e);for(var s=0;s<this.turtles.turtleList.length;s++)this.turtles.turtleList[s].trash||this.turtles.turtleList[s].penState&&(this.turtles.turtleList[s].processColor(),q.lineWidth=this.turtles.turtleList[s].stroke,q.lineCap="round",q.beginPath(),q.moveTo(this.turtles.turtleList[s].container.x+t,this.turtles.turtleList[s].container.y+e),q.lineTo(this.turtles.turtleList[s].container.x,this.turtles.turtleList[s].container.y),q.stroke(),q.closePath())},this._svgArc=function(t,e,i,s,l,o){var a=l;if(null==o)var n=Math.PI/t;else n=(o-l)/t;for(var r=0;r<t;r++){var c=e+s*Math.cos(a),h=i+s*Math.sin(a);this.svgOutput+=c+","+h+" ",a+=n}},this.doBezier=function(t,e,i,s,l,o){if(this.penState&&this.hollowState){var a=l,n=o,r=this.turtles.turtleX2screenX(this.x),c=this.turtles.turtleY2screenY(this.y),h=this.turtles.turtleX2screenX(l),u=this.turtles.turtleY2screenY(o),d=this.turtles.turtleX2screenX(t),f=this.turtles.turtleY2screenY(e),p=this.turtles.turtleX2screenX(i),b=this.turtles.turtleY2screenY(s);this.closeSVG();var m=this.stroke;if(this.stroke=1,q.lineWidth=this.stroke,q.lineCap="round",m<3)var g=.5;else g=(m-2)/2;steps=Math.max(Math.floor(m,1));var k=Math.atan2(t-this.x,e-this.y);(k=180*k/Math.PI)<0&&(k+=360);var v=Math.atan2(a-i,n-s);(v=180*v/Math.PI)<0&&(v+=360);var y=(k-90)*Math.PI/180,_=g*Math.sin(y),T=-g*Math.cos(y),L=(v-90)*Math.PI/180,w=g*Math.sin(L),B=-g*Math.cos(L),x=r-_,S=c-T,C=(this.turtles.scale,this.turtles.scale,u-B),A=(this.turtles.scale,this.turtles.scale,h+w),N=u+B,P=(this.turtles.scale,this.turtles.scale,c+T),I=(this.turtles.scale,this.turtles.scale,(d+_)*this.turtles.scale),M=(f+T)*this.turtles.scale,E=(p+w)*this.turtles.scale,O=(b+B)*this.turtles.scale;this.svgPath=!0;var D=r,R=c,W=(F=(180+k)/180*Math.PI)-Math.PI,H=F;q.arc(D,R,g,W,H,!1),this._svgArc(steps,D*this.turtles.scale,R*this.turtles.scale,g*this.turtles.scale,W,H);var F;D=h,R=u,W=(F=v/180*Math.PI)-Math.PI,H=F;q.arc(D,R,g,W,H,!1),this._svgArc(steps,D*this.turtles.scale,R*this.turtles.scale,g*this.turtles.scale,W,H);h=this.turtles.turtleX2screenX(l),u=this.turtles.turtleY2screenY(o);var j=h*this.turtles.scale,V=u*this.turtles.scale;q.stroke(),q.closePath(),this.stroke=m,q.lineWidth=this.stroke,q.lineCap="round",q.moveTo(h,u),this.svgOutput+="M "+j+","+V+" ",this.x=l,this.y=o}else if(this.penState){this.processColor(),q.lineWidth=this.stroke,q.lineCap="round",q.beginPath(),q.moveTo(this.container.x,this.container.y);h=this.turtles.turtleX2screenX(l),u=this.turtles.turtleY2screenY(o),d=this.turtles.turtleX2screenX(t),f=this.turtles.turtleY2screenY(e),p=this.turtles.turtleX2screenX(i),b=this.turtles.turtleY2screenY(s);if(q.bezierCurveTo(d+_,f+T,p+w,b+B,A,N),q.bezierCurveTo(p-w,b-B,d-_,f-T,x,S),q.bezierCurveTo(d,f,p,b,h,u),!this.svgPath){this.svgPath=!0;r=this.turtles.turtleX2screenX(this.x),c=this.turtles.turtleY2screenY(this.y);var U=r*this.turtles.scale,G=c*this.turtles.scale;this.svgOutput+='<path d="M '+U+","+G+" "}I=d*this.turtles.scale,M=f*this.turtles.scale,E=p*this.turtles.scale,O=b*this.turtles.scale,j=h*this.turtles.scale,V=u*this.turtles.scale;this.svgOutput+="C "+I+","+M+" "+E+","+O+" "+j+","+V,this.closeSVG(),this.x=l,this.y=o,q.stroke(),this.fillState||q.closePath()}else{this.x=l,this.y=o;h=this.turtles.turtleX2screenX(l),u=this.turtles.turtleY2screenY(o)}this.container.x=h,this.container.y=u;var z=Math.atan2(a-i,n-s);z=180*z/Math.PI,this.doSetHeading(z)},this.move=function(t,e,i,s,l){if(l?(t=this.turtles.turtleX2screenX(t),e=this.turtles.turtleY2screenY(e),nx=this.turtles.turtleX2screenX(i),ny=this.turtles.turtleY2screenY(s)):(nx=i,ny=s),this.penState&&this.hollowState){this.closeSVG(),this.svgPath=!0;var o=this.stroke;if(this.stroke=1,q.lineWidth=this.stroke,q.lineCap="round",o<3)var a=.5;else a=(o-2)/2;var n=(this.orientation-90)*Math.PI/180,r=a*Math.sin(n),c=-a*Math.cos(n);q.moveTo(t+r,e+c);var h=(t+r)*this.turtles.scale,u=(e+c)*this.turtles.scale;this.svgOutput+='<path d="M '+h+","+u+" ",q.lineTo(nx+r,ny+c);var d=(nx+r)*this.turtles.scale,f=(ny+c)*this.turtles.scale;this.svgOutput+=d+","+f+" ";n=(this.orientation+90)*Math.PI/180,r=a*Math.sin(n),c=-a*Math.cos(n);var p=this.orientation/180*Math.PI,b=nx,m=ny,g=p-Math.PI,k=p;q.arc(b,m,a,g,k,!1);d=(nx+r)*this.turtles.scale,f=(ny+c)*this.turtles.scale;var v=a*this.turtles.scale;steps=Math.max(Math.floor(o,1)),this._svgArc(steps,b*this.turtles.scale,m*this.turtles.scale,v,g),this.svgOutput+=d+","+f+" ",q.lineTo(t+r,e+c);d=(t+r)*this.turtles.scale,f=(e+c)*this.turtles.scale;this.svgOutput+=d+","+f+" ";n=(this.orientation-90)*Math.PI/180,r=a*Math.sin(n),c=-a*Math.cos(n),b=t,m=e,g=(p=(this.orientation+180)/180*Math.PI)-Math.PI,k=p;q.arc(b,m,a,g,k,!1);d=(t+r)*this.turtles.scale,f=(e+c)*this.turtles.scale,v=a*this.turtles.scale;this._svgArc(steps,b*this.turtles.scale,m*this.turtles.scale,v,g),this.svgOutput+=d+","+f+" ",this.closeSVG(),q.stroke(),q.closePath(),this.stroke=o,q.lineWidth=this.stroke,q.lineCap="round",q.moveTo(nx,ny)}else if(this.penState){if(q.lineTo(nx,ny),!this.svgPath){this.svgPath=!0;h=t*this.turtles.scale,u=e*this.turtles.scale;this.svgOutput+='<path d="M '+h+","+u+" "}d=nx*this.turtles.scale,f=ny*this.turtles.scale;this.svgOutput+=d+","+f+" ",q.stroke(),this.fillState||q.closePath()}else q.moveTo(nx,ny);this.penstrokes.image=y,this.container.x=nx,this.container.y=ny,l?(this.x=i,this.y=s):(this.x=this.turtles.screenX2turtleX(i),this.y=this.turtles.screenY2turtleY(s))},this.getNumber=function(){return this.turtles.turtleList.indexOf(this)},this.rename=function(t){this.name=t,null!=this.startBlock&&(this.startBlock.overrideName=this.name,this.name===_("start drum")?this.startBlock.collapseText.text=_("drum"):this.startBlock.collapseText.text=this.name,this.startBlock.regenerateArtwork(!1),this.startBlock.value=this.turtles.turtleList.indexOf(this))},this.arc=function(t,e,i,s,l,o,a,n,r,c,h){if(h?(t=this.turtles.turtleX2screenX(t),e=this.turtles.turtleY2screenY(e),i=this.turtles.turtleX2screenX(i),s=this.turtles.turtleY2screenY(s),nx=this.turtles.turtleX2screenX(l),ny=this.turtles.turtleY2screenY(o)):(nx=l,ny=o),c?(sa=n,ea=r):(sa=n-Math.PI,ea=r-Math.PI),this.penState&&this.hollowState){this.closeSVG(),this.svgPath=!0;var u=this.stroke;if(this.stroke=1,q.lineWidth=this.stroke,q.lineCap="round",u<3)var d=.5;else d=(u-2)/2;var f=(this.orientation+90)*Math.PI/180,p=d*Math.sin(f),b=-d*Math.cos(f);if(c){q.moveTo(i+p,s+b);var m=(i+p)*this.turtles.scale,g=(s+b)*this.turtles.scale}else{q.moveTo(i-p,s-b);m=(i-p)*this.turtles.scale,g=(s-b)*this.turtles.scale}this.svgOutput+='<path d="M '+m+","+g+" ",q.arc(t,e,a+d,sa,ea,c),nsteps=Math.max(Math.floor(a*Math.abs(sa-ea)/2),2),steps=Math.max(Math.floor(u,1)),this._svgArc(nsteps,t*this.turtles.scale,e*this.turtles.scale,(a+d)*this.turtles.scale,sa,ea);f=(this.orientation+90)*Math.PI/180,p=d*Math.sin(f),b=-d*Math.cos(f);var k=nx,v=ny,y=ea,_=ea+Math.PI;q.arc(k,v,d,y,_,c),this._svgArc(steps,k*this.turtles.scale,v*this.turtles.scale,d*this.turtles.scale,y,_),q.arc(t,e,a-d,ea,sa,!c),this._svgArc(nsteps,t*this.turtles.scale,e*this.turtles.scale,(a-d)*this.turtles.scale,ea,sa);var T=i,L=s,w=sa-Math.PI,B=sa;q.arc(T,L,d,w,B,c),this._svgArc(steps,T*this.turtles.scale,L*this.turtles.scale,d*this.turtles.scale,w,B),this.closeSVG(),q.stroke(),q.closePath(),this.stroke=u,q.lineWidth=this.stroke,q.lineCap="round",q.moveTo(nx,ny)}else if(this.penState){if(q.arc(t,e,a,sa,ea,c),!this.svgPath){this.svgPath=!0;m=i*this.turtles.scale,g=s*this.turtles.scale;this.svgOutput+='<path d="M '+m+","+g+" "}if(c)var x=0;else x=1;var S=nx*this.turtles.scale,C=ny*this.turtles.scale,A=a*this.turtles.scale;this.svgOutput+="A "+A+","+A+" 0 0 "+x+" "+S+","+C+" ",q.stroke(),this.fillState||q.closePath()}else q.moveTo(nx,ny);this.container.x=nx,this.container.y=ny,h?(this.x=l,this.y=o):(this.x=this.screenX2turtles.turtleX(l),this.y=this.screenY2turtles.turtleY(o))},this.doClear=function(t,e,i){if(i&&(this.x=0,this.y=0,this.orientation=0),t){var s=this.turtles.turtleList.indexOf(this)%10;this.color=10*s,this.value=DEFAULTVALUE,this.chroma=DEFAULTCHROMA,this.stroke=DEFAULTSTROKE,this.font=DEFAULTFONT}if(this.container.x=this.turtles.turtleX2screenX(this.x),this.container.y=this.turtles.turtleY2screenY(this.y),e&&(this.drum?this.name!==_("start drum")&&this.rename(_("start drum")):this.name!==_("start")&&this.rename(_("start")),this.skinChanged)){var l=TURTLESVG;l=sugarizerCompatibility.isInsideSugarizer()?l.replace(/fill_color/g,sugarizerCompatibility.xoColor.fill).replace(/stroke_color/g,sugarizerCompatibility.xoColor.stroke):l.replace(/fill_color/g,FILLCOLORS[s]).replace(/stroke_color/g,STROKECOLORS[s]),this.doTurtleShell(55,"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(l)))),this.skinChanged=!1}this.bitmap.rotation=this.orientation,this.updateCache();for(s=0;s<this.media.length;s++)this.imageContainer.removeChild(this.media[s]),this.turtles.stage.removeChild(this.media[s]),delete this.media[s];this.media=[],this.penState=!0,this.fillState=!1,this.hollowState=!1,this.canvasColor=getMunsellColor(this.color,this.value,this.chroma),"#"===this.canvasColor[0]&&(this.canvasColor=hex2rgb(this.canvasColor.split("#")[1])),this.svgOutput="",this.svgPath=!1,this.penstrokes.image=null,q.beginPath(),q.clearRect(0,0,y.width,y.height),this.penstrokes.image=y,this.turtles.refreshCanvas()},this.clearPenStrokes=function(){this.penState=!0,this.fillState=!1,this.hollowState=!1,this.canvasColor=getMunsellColor(this.color,this.value,this.chroma),"#"===this.canvasColor[0]&&(this.canvasColor=hex2rgb(this.canvasColor.split("#")[1])),q.beginPath(),q.clearRect(0,0,y.width,y.height),this.processColor(),q.lineWidth=this.stroke,q.lineCap="round",q.beginPath(),this.penstrokes.image=y,this.svgOutput="",this.svgPath=!1,this.turtles.refreshCanvas()},this.doForward=function(t){this.processColor(),this.fillState||(q.lineWidth=this.stroke,q.lineCap="round",q.beginPath(),q.moveTo(this.container.x,this.container.y));var e=this.turtles.screenX2turtleX(this.container.x),i=this.turtles.screenY2turtleY(this.container.y),s=this.orientation*Math.PI/180,l=e+Number(t)*Math.sin(s),o=i+Number(t)*Math.cos(s);this.move(e,i,l,o,!0),this.turtles.refreshCanvas()},this.doSetXY=function(t,e){this.processColor(),this.fillState||(q.lineWidth=this.stroke,q.lineCap="round",q.beginPath(),q.moveTo(this.container.x,this.container.y));var i=this.turtles.screenX2turtleX(this.container.x),s=this.turtles.screenY2turtleY(this.container.y),l=Number(t),o=Number(e);this.move(i,s,l,o,!0),this.turtles.refreshCanvas()},this.doArc=function(t,e){e<0&&(e=-e);var i=Number(t);if(i<0){var s=-1;i=-i}else s=1;for(var l=i%90,o=Math.floor(i/90),a=0;a<o;a++)this._doArcPart(90*s,e);0<l&&this._doArcPart(l*s,e)},this._doArcPart=function(t,e){this.processColor(),this.fillState||(q.lineWidth=this.stroke,q.lineCap="round",q.beginPath(),q.moveTo(this.container.x,this.container.y));var i=Number(t),s=i/180*Math.PI,l=this.orientation/180*Math.PI,o=Number(e);if(ox=this.turtles.screenX2turtleX(this.container.x),oy=this.turtles.screenY2turtleY(this.container.y),i<0){var a=!0;i=-i;var n=ox-Math.cos(l)*o,r=oy+Math.sin(l)*o,c=n+Math.cos(l+s)*o,h=r-Math.sin(l+s)*o}else a=!1,n=ox+Math.cos(l)*o,r=oy-Math.sin(l)*o,c=n-Math.cos(l+s)*o,h=r+Math.sin(l+s)*o;this.arc(n,r,ox,oy,c,h,o,l,l+s,a,!0),a?this.doRight(-i):this.doRight(i),this.turtles.refreshCanvas()},this.doShowImage=function(e,t){if(null!==t){var i=new Image,s=this;i.onload=function(){var t=new createjs.Bitmap(i);s.imageContainer.addChild(t),s.media.push(t),t.scaleX=Number(e)/i.width,t.scaleY=t.scaleX,t.scale=t.scaleX,t.x=s.container.x,t.y=s.container.y,t.regX=i.width/2,t.regY=i.height/2,t.rotation=s.orientation,s.turtles.refreshCanvas()},i.src=t}},this.doShowURL=function(e,t){if(null!==t){var i=new Image;i.src=t;var s=this;i.onload=function(){var t=new createjs.Bitmap(i);s.imageContainer.addChild(t),s.media.push(t),t.scaleX=Number(e)/i.width,t.scaleY=t.scaleX,t.scale=t.scaleX,t.x=s.container.x,t.y=s.container.y,t.regX=i.width/2,t.regY=i.height/2,t.rotation=s.orientation,s.turtles.refreshCanvas()}}},this.doTurtleShell=function(t,s){if(null!==s){var l=new Image;l.src=s;var o=this;this.shellSize=Number(t),l.onload=function(){o.container.removeChild(o.bitmap),o.bitmap=new createjs.Bitmap(l),o.container.addChild(o.bitmap),o.bitmap.scaleX=o.shellSize/l.width,o.bitmap.scaleY=o.bitmap.scaleX,o.bitmap.scale=o.bitmap.scaleX,o.bitmap.x=0,o.bitmap.y=0,o.bitmap.regX=l.width/2,o.bitmap.regY=l.height/2,o.bitmap.rotation=o.orientation,o.skinChanged=!0,o.container.uncache();var t=o.container.getBounds();o.container.cache(t.x,t.y,t.width,t.height);var e=new createjs.Shape;if(e.graphics.beginFill("#FFF").drawRect(0,0,t.width,t.height),e.x=-t.width/2,e.y=-t.height/2,o.container.hitArea=e,null!=o.startBlock){o.startBlock.container.removeChild(o.decorationBitmap),o.decorationBitmap=new createjs.Bitmap(s),o.startBlock.container.addChild(o.decorationBitmap),o.decorationBitmap.name="decoration";var i=o.startBlock.width;o.decorationBitmap.x=i-30*o.startBlock.protoblock.scale/2,o.decorationBitmap.y=20*o.startBlock.protoblock.scale/2,o.decorationBitmap.scaleX=27.5/l.width*o.startBlock.protoblock.scale/2,o.decorationBitmap.scaleY=27.5/l.height*o.startBlock.protoblock.scale/2,o.decorationBitmap.scale=27.5/l.width*o.startBlock.protoblock.scale/2,o.startBlock.updateCache()}o.turtles.refreshCanvas()}}},this.resizeDecoration=function(t,e){this.decorationBitmap.x=e-30*t/2,this.decorationBitmap.y=35*t/2,this.decorationBitmap.scaleX=this.decorationBitmap.scaleY=this.decorationBitmap.scale=.5*t/2},this.doShowText=function(t,e){if(null!==e){if("string"!=typeof e)var s=[e.toString()];else s=e.split("\\n");var l=t.toString()+"px "+this.font;for(i=0;i<s.length;i++){var o=new createjs.Text(s[i],l,this.canvasColor);o.textAlign="left",o.textBaseline="alphabetic",this.turtles.stage.addChild(o),this.media.push(o),o.x=this.container.x,o.y=this.container.y+i*t,o.rotation=this.orientation;var a=o.x*this.turtles.scale,n=o.y*this.turtles.scale,r=t*this.turtles.scale;this.svgOutput+='<text x="'+a+'" y = "'+n+'" fill="'+this.canvasColor+'" font-family = "'+this.font+'" font-size = "'+r+'">'+e+"</text>",this.turtles.refreshCanvas()}}},this.doRight=function(t){for(this.orientation+=Number(t);this.orientation<0;)this.orientation+=360;this.orientation%=360,this.bitmap.rotation=this.orientation,this.blinkFinished&&this.updateCache()},this.doSetHeading=function(t){for(this.orientation=Number(t);this.orientation<0;)this.orientation+=360;this.orientation%=360,this.bitmap.rotation=this.orientation,this.blinkFinished&&this.updateCache()},this.doSetFont=function(t){this.font=t,this.updateCache()},this.doSetColor=function(t){this.closeSVG(),this.color=Number(t);var e=getcolor(this.color);this.canvasValue=e[0],this.value=e[0],this.canvasChroma=e[1],this.chroma=e[1],this.canvasColor=e[2],this.processColor()},this.doSetPenAlpha=function(t){this.canvasAlpha=t},this.processColor=function(){"#"===this.canvasColor[0]&&(this.canvasColor=hex2rgb(this.canvasColor.split("#")[1]));var t=this.canvasColor.substr(0,this.canvasColor.length-2);q.strokeStyle=t+this.canvasAlpha+")",q.fillStyle=t+this.canvasAlpha+")"},this.doSetHue=function(t){this.closeSVG(),this.color=Number(t),this.canvasColor=getMunsellColor(this.color,this.value,this.chroma),this.processColor()},this.doSetValue=function(t){this.closeSVG(),this.value=Number(t),this.canvasColor=getMunsellColor(this.color,this.value,this.chroma),this.processColor()},this.doSetChroma=function(t){this.closeSVG(),this.chroma=Number(t),this.canvasColor=getMunsellColor(this.color,this.value,this.chroma),this.processColor()},this.doSetPensize=function(t){this.closeSVG(),this.stroke=t,q.lineWidth=this.stroke},this.doPenUp=function(){this.closeSVG(),this.penState=!1},this.doPenDown=function(){this.penState=!0},this.doStartFill=function(){q.beginPath(),this.fillState=!0},this.doEndFill=function(){q.fill(),q.closePath(),this.closeSVG(),this.fillState=!1},this.doStartHollowLine=function(){this.hollowState=!0},this.doEndHollowLine=function(){this.hollowState=!1},this.closeSVG=function(){if(this.svgPath){var t=this.canvasColor.replace(/rgba/g,"rgb");t=t.substr(0,this.canvasColor.length-4)+");",this.svgOutput+='" style="stroke-linecap:round;fill:',this.fillState?this.svgOutput+=t+"fill-opacity:"+this.canvasAlpha+";":this.svgOutput+="none;",this.svgOutput+="stroke:"+t+"stroke-opacity:"+this.canvasAlpha+";";var e=this.stroke*this.turtles.scale;this.svgOutput+="stroke-width:"+e+'pt;" />',this.svgPath=!1}},this.createCache=function(){var t=this;t.bounds=t.container.getBounds(),null==t.bounds?setTimeout(function(){t.createCache()},200):t.container.cache(t.bounds.x,t.bounds.y,t.bounds.width,t.bounds.height)},this.updateCache=function(){var t=this;null==t.bounds?(console.log("Block container for "+t.name+" not yet ready."),setTimeout(function(){t.updateCache()},300)):(t.container.updateCache(),t.turtles.refreshCanvas())},this.stopBlink=function(){null==this._blinkTimeout&&this.blinkFinished||(clearTimeout(this._blinkTimeout),this._blinkTimeout=null,this.container.visible=!0,this.turtles.refreshCanvas(),this.blinkFinished=!0)},this.blink=function(t,e){var i=this;this._sizeInUse=i.bitmap.scaleX,this._blinkTimeout=null,16<t||(this.stopBlink(),this.container.visible=!1,this._blinkTimeout=setTimeout(function(){i.container.visible=!0,i.turtles.refreshCanvas()},100),this.turtles.refreshCanvas())}}function Turtles(){this.masterStage=null,this.doClear=null,this.hideMenu=null,this.doGrid=null,this.hideGrids=null,this.stage=null,this.refreshCanvas=null,this.scale=1,this.w=1200,this.h=900,this.backgroundColor=platformColor.background,this._canvas=null,this._rotating=!1,this._drum=!1,console.log("Creating border container"),this._borderContainer=new createjs.Container,this._expandedBoundary=null,this._collapsedBoundary=null,this.isShrunk=!1,this._expandButton=null,this._expandLabel=null,this._expandLabelBG=null,this._collapseButton=null,this._collapseLabel=null,this._collapseLabelBG=null,this._clearButton=null,this._clearLabel=null,this._clearLabelBG=null,this._gridButton=null,this._gridLabel=null,this._gridLabelBG=null,this._locked=!1,this._queue=[],this.turtleList=[],this.setGridLabel=function(t){null!==this._gridLabel&&(this._gridLabel.text=t)},this.setMasterStage=function(t){return this.masterStage=t,this},this.setClear=function(t){return this.doClear=t,this},this.setDoGrid=function(t){return this.doGrid=t,this},this.setHideGrids=function(t){return this.hideGrids=t,this},this.setHideMenu=function(t){return this.hideMenu=t,this},this.setCanvas=function(t){return this._canvas=t,this},this.setStage=function(t){return this.stage=t,this.stage.addChild(this._borderContainer),this},this.scaleStage=function(t){this.stage.scaleX=t,this.stage.scaleY=t,this.refreshCanvas()},this.setRefreshCanvas=function(t){return this.refreshCanvas=t,this},this.setScale=function(t,e,i){this._locked?this._queue=[t,e,i]:(this.scale=i,this.w=t/i,this.h=e/i),this.makeBackground()},this.deltaY=function(t){this.stage.y+=t},this.makeBackground=function(t){if(void 0===t)var s=!1;else s=t;for(var e=0;e<this._borderContainer.children.length;e++)this._borderContainer.children[e].visible=!1,this._borderContainer.removeChild(this._borderContainer.children[e]);null!==this._expandButton&&this.stage.removeChild(this._expandButton),null!==this._collapseButton&&this.stage.removeChild(this._collapseButton),null!==this._clearButton&&this.stage.removeChild(this._clearButton),null!==this._gridButton&&this.stage.removeChild(this._gridButton);var l=this,o=null;return this._locked||function(){l._locked=!0;var t=new Image;t.onload=function(){null!==l._expandedBoundary&&(l._expandedBoundary.visible=!1),l._expandedBoundary=new createjs.Bitmap(t),l._expandedBoundary.x=0,l._expandedBoundary.y=55+LEADING,l._borderContainer.addChild(l._expandedBoundary),function(){var t=new Image;t.onload=function(){null!==l._collapsedBoundary&&(l._collapsedBoundary.visible=!1),l._collapsedBoundary=new createjs.Bitmap(t),l._collapsedBoundary.x=0,l._collapsedBoundary.y=55+LEADING,l._borderContainer.addChild(l._collapsedBoundary),l._collapsedBoundary.visible=!1,function(){l._expandButton=new createjs.Container,l._expandLabel=null,l._expandLabelBG=null,l._expandLabel=new createjs.Text(_("Expand"),"14px Sans","#282828"),l._expandLabel.textAlign="center",l._expandLabel.x=11.5,l._expandLabel.y=55,l._expandLabel.visible=!1;var e=new Image;e.onload=function(){null!==l._expandButton&&(l._expandButton.visible=!1);var t=new createjs.Bitmap(e);l._expandButton.addChild(t),t.visible=!0,l._expandButton.addChild(l._expandLabel),l._expandButton.x=l.w-10-220,l._expandButton.y=70+LEADING+6,l._expandButton.scaleX=SCALEFACTOR,l._expandButton.scaleY=SCALEFACTOR,l._expandButton.scale=SCALEFACTOR,l._expandButton.visible=!1,l.stage.addChild(l._expandButton),l._expandButton.removeAllEventListeners("mouseover"),l._expandButton.on("mouseover",function(t){if(null!==l._expandLabel)if(l._expandLabel.visible=!0,null===l._expandLabelBG){var e=l._expandLabel.getBounds();l._expandLabelBG=new createjs.Shape,l._expandLabelBG.graphics.beginFill("#FFF").drawRoundRect(l._expandLabel.x+e.x-8,l._expandLabel.y+e.y-2,e.width+16,e.height+8,10,10,10,10),l._expandButton.addChildAt(l._expandLabelBG,0)}else l._expandLabelBG.visible=!0;l.refreshCanvas()}),l._expandButton.removeAllEventListeners("mouseout"),l._expandButton.on("mouseout",function(t){null!==l._expandLabel&&(l._expandLabel.visible=!1,l._expandLabelBG.visible=!1,l.refreshCanvas())}),l._expandButton.removeAllEventListeners("pressmove"),l._expandButton.on("pressmove",function(t){var e=(l.w-10-55*SCALEFACTOR)/SCALEFACTOR,i=t.stageX/l.scale-e,s=t.stageY/l.scale-16;l.stage.x=Math.max(0,Math.min(3*l.w/4,i)),l.stage.y=Math.max(55,Math.min(3*l.h/4,s)),l.refreshCanvas()}),l._expandButton.removeAllEventListeners("click"),l._expandButton.on("click",function(t){var e=docById("aux-toolbar");if("block"===e.style.display){var i=docById("menu");e.style.display="none",i.innerHTML="menu",docById("toggleAuxBtn").className-="blue darken-1"}l.hideMenu(),l.scaleStage(1),l._expandedBoundary.visible=!0,l._collapseButton.visible=!0,l._collapsedBoundary.visible=!1,l._expandButton.visible=!1,l.stage.x=0,l.stage.y=0,l.isShrunk=!1;for(var s=0;s<l.turtleList.length;s++)l.turtleList[s].container.scaleX=1,l.turtleList[s].container.scaleY=1,l.turtleList[s].container.scale=1;l._clearButton.scaleX=1,l._clearButton.scaleY=1,l._clearButton.scale=1,l._clearButton.x=l.w-5-110,null!==l._gridButton&&(l._gridButton.scaleX=1,l._gridButton.scaleY=1,l._gridButton.scale=1,l._gridButton.x=l.w-10-165,l._gridButton.visible=!0),l.masterStage.removeChild(l.stage),l.masterStage.addChildAt(l.stage,0)}),function(){l._collapseButton=new createjs.Container,l._collapseLabel=null,l._collapseLabelBG=null,l._collapseLabel=new createjs.Text(_("Collapse"),"14px Sans","#282828"),l._collapseLabel.textAlign="center",l._collapseLabel.x=11.5,l._collapseLabel.y=55,l._collapseLabel.visible=!1;var e=new Image;e.onload=function(){null!==l._collapseButton&&(l._collapseButton.visible=!1);var t=new createjs.Bitmap(e);l._collapseButton.addChild(t),t.visible=!0,l._collapseButton.addChild(l._collapseLabel),l.stage.addChild(l._collapseButton),l._collapseButton.visible=!0,l._collapseButton.x=l.w-55,l._collapseButton.y=70+LEADING+6,l.refreshCanvas(),l._collapseButton.removeAllEventListeners("click"),l._collapseButton.on("click",function(t){var e=docById("aux-toolbar");if("block"===e.style.display){var i=docById("menu");e.style.display="none",i.innerHTML="menu",docById("toggleAuxBtn").className-="blue darken-1"}l.collapse()}),l._collapseButton.removeAllEventListeners("mouseover"),l._collapseButton.on("mouseover",function(t){if(null!==l._collapseLabel){if(l._collapseLabel.visible=!0,null===l._collapseLabelBG){var e=l._collapseLabel.getBounds();l._collapseLabelBG=new createjs.Shape,l._collapseLabelBG.graphics.beginFill("#FFF").drawRoundRect(l._collapseLabel.x+e.x-8,l._collapseLabel.y+e.y-2,e.width+16,e.height+8,10,10,10,10),l._collapseButton.addChildAt(l._collapseLabelBG,0)}else l._collapseLabelBG.visible=!0;o=showButtonHighlight(l._collapseButton.x+28,l._collapseButton.y+28,27.5,t,palettes.scale,l.stage)}l.refreshCanvas()}),l._collapseButton.removeAllEventListeners("mouseout"),l._collapseButton.on("mouseout",function(t){hideButtonHighlight(o,l.stage),null!==l._collapseLabel&&(l._collapseLabel.visible=!1,l._collapseLabelBG.visible=!1,l.refreshCanvas())}),function(){l._clearButton=new createjs.Container,l._clearLabel=null,l._clearLabelBG=null,l._clearButton.removeAllEventListeners("click"),l._clearButton.on("click",function(t){l.doClear()}),l._clearLabel=new createjs.Text(_("Clean"),"14px Sans","#282828"),l._clearLabel.textAlign="center",l._clearLabel.x=27.5,l._clearLabel.y=55,l._clearLabel.visible=!1;var e=new Image;e.onload=function(){var t=new createjs.Bitmap(e);l._clearButton.addChild(t),l._clearButton.addChild(l._clearLabel),t.visible=!0,l._clearButton.x=l.w-5-110,l._clearButton.y=70+LEADING+6,l._clearButton.visible=!0,l.stage.addChild(l._clearButton),l.refreshCanvas(),l._clearButton.removeAllEventListeners("mouseover"),l._clearButton.on("mouseover",function(t){if(null!==l._clearLabel){if(l._clearLabel.visible=!0,null===l._clearLabelBG){var e=l._clearLabel.getBounds();l._clearLabelBG=new createjs.Shape,l._clearLabelBG.graphics.beginFill("#FFF").drawRoundRect(l._clearLabel.x+e.x-8,l._clearLabel.y+e.y-2,e.width+16,e.height+8,10,10,10,10),l._clearButton.addChildAt(l._clearLabelBG,0)}else l._clearLabelBG.visible=!0;o=showButtonHighlight(l._clearButton.x+28,l._clearButton.y+28,27.5,t,palettes.scale,l.stage)}l.refreshCanvas()}),l._clearButton.removeAllEventListeners("mouseout"),l._clearButton.on("mouseout",function(t){hideButtonHighlight(o,l.stage),null!==l._clearLabel&&(l._clearLabel.visible=!1),null!==l._clearLabelBG&&(l._clearLabelBG.visible=!1),l.refreshCanvas()}),s&&l.collapse();localStorage.languagePreference;!function(){l._gridButton=new createjs.Container,l._gridLabel=null,l._gridLabelBG=null,l._gridButton.removeAllEventListeners("click"),l._gridButton.on("click",function(t){l.doGrid()}),l._gridLabel=new createjs.Text(_("show Cartesian"),"14px Sans","#282828"),l._gridLabel.textAlign="center",l._gridLabel.x=27.5,l._gridLabel.y=55,l._gridLabel.visible=!1;var e=new Image;e.onload=function(){var t=new createjs.Bitmap(e);l._gridButton.addChild(t),l._gridButton.addChild(l._gridLabel),t.visible=!0,l._gridButton.x=l.w-10-165,l._gridButton.y=70+LEADING+6,l._gridButton.visible=!0,l.stage.addChild(l._gridButton),l.refreshCanvas(),l._gridButton.removeAllEventListeners("mouseover"),l._gridButton.on("mouseover",function(t){if(null!==l._gridLabel){if(l._gridLabel.visible=!0,null===l._gridLabelBG){var e=l._gridLabel.getBounds();l._gridLabelBG=new createjs.Shape,l._gridLabelBG.graphics.beginFill("#FFF").drawRoundRect(l._gridLabel.x+e.x-8,l._gridLabel.y+e.y-2,e.width+16,e.height+8,10,10,10,10),l._gridButton.addChildAt(l._gridLabelBG,0)}else l._gridLabelBG.visible=!0;o=showButtonHighlight(l._gridButton.x+28,l._gridButton.y+28,27.5,t,palettes.scale,l.stage)}l.refreshCanvas()}),l._gridButton.removeAllEventListeners("mouseout"),l._gridButton.on("mouseout",function(t){hideButtonHighlight(o,l.stage),null!==l._gridLabel&&(l._gridLabel.visible=!1,l._gridLabelBG.visible=!1,l.refreshCanvas())}),s&&l.collapse(),l._locked=!1,3===l._queue.length&&(l.scale=l._queue[2],l.w=l._queue[0]/l.scale,l.h=l._queue[1]/l.scale,l._queue=[],l.makeBackground())},e.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(CARTESIANBUTTON)))}()},e.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(CLEARBUTTON)))}()},e.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(COLLAPSEBUTTON)))}()},e.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(EXPANDBUTTON)))}()};var e=l.w-20,i=l.h-55-LEADING;t.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(MBOUNDARY.replace("HEIGHT",l.h).replace("WIDTH",l.w).replace("Y",10).replace("X",10).replace("DY",i).replace("DX",e).replace("stroke_color",platformColor.ruleColor).replace("fill_color",l.backgroundColor).replace("STROKE",20))))}()};var e=l.w-5,i=l.h-55-LEADING;t.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(MBOUNDARY.replace("HEIGHT",l.h).replace("WIDTH",l.w).replace("Y",10/SCALEFACTOR).replace("X",10/SCALEFACTOR).replace("DY",i).replace("DX",e).replace("stroke_color",platformColor.ruleColor).replace("fill_color",l.backgroundColor).replace("STROKE",20/SCALEFACTOR))))}(),this},this.collapse=function(){this.hideMenu(),this.hideGrids(),this.scaleStage(.25),this._collapsedBoundary.visible=!0,this._expandButton.visible=!0,this._expandedBoundary.visible=!1,this._collapseButton.visible=!1,this.stage.x=3*this.w/4-10,this.stage.y=55+LEADING+6,this.isShrunk=!0;for(var t=0;t<this.turtleList.length;t++)this.turtleList[t].container.scaleX=SCALEFACTOR,this.turtleList[t].container.scaleY=SCALEFACTOR,this.turtleList[t].container.scale=SCALEFACTOR;this._clearButton.scaleX=SCALEFACTOR,this._clearButton.scaleY=SCALEFACTOR,this._clearButton.scale=SCALEFACTOR,this._clearButton.x=this.w-5-440,null!==this._gridButton&&(this._gridButton.scaleX=SCALEFACTOR,this._gridButton.scaleY=SCALEFACTOR,this._gridButton.scale=SCALEFACTOR,this._gridButton.x=this.w-10-660,this._gridButton.visible=!1),this.masterStage.removeChild(this.stage),this.masterStage.addChild(this.stage),this.refreshCanvas()},this.setBlocks=function(t){return this.blocks=t,this},this.addDrum=function(t,e){this._drum=!0,this.add(t,e)},this.addTurtle=function(t,e){if(this._drum=!1,this.add(t,e),this.isShrunk){var i=last(this.turtleList);i.container.scaleX=SCALEFACTOR,i.container.scaleY=SCALEFACTOR,i.container.scale=SCALEFACTOR}},this.add=function(t,e){null!=t?(console.log("adding a new turtle "+t.name),t.value!==this.turtleList.length&&(t.value=this.turtleList.length,console.log("turtle #"+t.value))):console.log("adding a new turtle startBlock is null");var i=!1;"object"===_typeof(e)&&0<Object.keys(e).length&&(i=!0);var s=this.turtleList.length;if(i&&"name"in e)l=e.name;else var l=_("start");var o=new Turtle(l,this,this._drum);i&&("xcor"in e&&(o.x=e.xcor),"ycor"in e&&(o.y=e.ycor)),this.turtleList.push(o),o.imageContainer=new createjs.Container,this.stage.addChild(o.imageContainer),o.penstrokes=new createjs.Bitmap,this.stage.addChild(o.penstrokes);new Image;s%=10,o.container=new createjs.Container,this.stage.addChild(o.container),o.container.x=this.turtleX2screenX(o.x),o.container.y=this.turtleY2screenY(o.y),this.stage.removeChild(this._expandButton),this.stage.addChild(this._expandButton),this.stage.removeChild(this._collapseButton),this.stage.addChild(this._collapseButton),this.stage.removeChild(this._clearButton),this.stage.addChild(this._clearButton),null!==this._gridButton&&(this.stage.removeChild(this._gridButton),this.stage.addChild(this._gridButton));var a=new createjs.Shape;function n(t,e,i,s){if(o.bitmap=i,o.bitmap.regX=27,o.bitmap.regY=27,o.bitmap.cursor="pointer",o.container.addChild(o.bitmap),o.createCache(),null!=(o.startBlock=s)){s.updateCache(),o.decorationBitmap=o.bitmap.clone(),s.container.addChild(o.decorationBitmap),o.decorationBitmap.name="decoration";var l=s.width;o.decorationBitmap.x=l-40*s.protoblock.scale/2,o.decorationBitmap.y=35*s.protoblock.scale/2,o.decorationBitmap.scaleX=o.decorationBitmap.scaleY=o.decorationBitmap.scale=.5*s.protoblock.scale/2,s.updateCache()}t.refreshCanvas()}if(a.graphics.beginFill("#FFF").drawEllipse(-27,-27,55,55),a.x=0,a.y=0,o.container.hitArea=a,this._drum)var r=DRUMSVG;else r=TURTLESVG;sugarizerCompatibility.isInsideSugarizer()?this._makeTurtleBitmap(r.replace(/fill_color/g,sugarizerCompatibility.xoColor.fill).replace(/stroke_color/g,sugarizerCompatibility.xoColor.stroke),"turtle",n,t):this._makeTurtleBitmap(r.replace(/fill_color/g,FILLCOLORS[s]).replace(/stroke_color/g,STROKECOLORS[s]),"turtle",n,t),o.color=10*s,o.canvasColor=getMunsellColor(o.color,DEFAULTVALUE,DEFAULTCHROMA);var c=this;o.container.on("mousedown",function(t){if(!c._rotating){var e=o.container.x-t.stageX/c.scale,i=o.container.y-t.stageY/c.scale;o.container.removeAllEventListeners("pressmove"),o.container.on("pressmove",function(t){o.running||(o.container.x=t.stageX/c.scale+e,o.container.y=t.stageY/c.scale+i,o.x=c.screenX2turtleX(o.container.x),o.y=c.screenY2turtleY(o.container.y),c.refreshCanvas())})}}),o.container.on("click",function(t){console.log("--\x3e [click"+o.name+"]"),c.stage.dispatchEvent("click"+o.name)}),o.container.on("mouseover",function(t){o.running||(o.container.scaleX*=1.2,o.container.scaleY=o.container.scaleX,o.container.scale=o.container.scaleX,c.refreshCanvas())}),o.container.on("mouseout",function(t){o.running||(o.container.scaleX/=1.2,o.container.scaleY=o.container.scaleX,o.container.scale=o.container.scaleX,c.refreshCanvas())}),document.getElementById("loader").className="",setTimeout(function(){i&&("heading"in e&&o.doSetHeading(e.heading),"pensize"in e&&o.doSetPensize(e.pensize),"grey"in e&&o.doSetChroma(e.grey),"shade"in e&&o.doSetValue(e.shade),"color"in e&&o.doSetColor(e.color),"name"in e&&o.rename(e.name))},6e3),this.refreshCanvas()},this._makeTurtleBitmap=function(t,e,i,s){var l=new Image,o=this;l.onload=function(){complete=!0;var t=new createjs.Bitmap(l);i(o,e,t,s)},l.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t)))},this.screenX2turtleX=function(t){return t-this._canvas.width/(2*this.scale)},this.screenY2turtleY=function(t){return this.invertY(t)},this.turtleX2screenX=function(t){return this._canvas.width/(2*this.scale)+t},this.turtleY2screenY=function(t){return this.invertY(t)},this.invertY=function(t){return this._canvas.height/(2*this.scale)-t},this.markAsStopped=function(){for(var t in this.turtleList)this.turtleList[t].running=!1;this.refreshCanvas()},this.running=function(){for(var t in this.turtleList)if(this.turtleList[t].running)return!0;return!1}}function Queue(t,e,i,s){this.blk=t,this.count=e,this.parentBlk=i,this.args=s}function hex2rgb(t){var e=parseInt(t,16);return"rgba("+(e>>16&255)+","+(e>>8&255)+","+(255&e)+",1)"}var LOGOJA1='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="14.227637mm" height="14.552083mm" viewBox="0 0 14.227637 14.552083" version="1.1" id="svg1917"> <defs id="defs1911" /> <metadata id="metadata1914"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <g id="layer1" transform="matrix(0.24123394,0,0,0.24123394,-22.428724,-13.126892)"> <g transform="matrix(0.35277777,0,0,-0.35277777,5.3347636,163.32003)" id="g1838"> <g transform="translate(399.8154,296.855)" id="g22"> <path id="path24" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c -1.236,-9.538 -8.742,-20.454 -20.52,-32.751 0.991,-3.791 2.1,-7.838 3.358,-12.192 1.198,-4.11 2.348,-8.111 3.463,-12.016 2.369,0.184 4.918,0.165 7.649,-0.097 10.995,-1.077 18.478,-8.518 21.847,-18.174 v 59.419 C 15.797,-4.727 9.248,4.822 -0.186,9.196 0.341,6.208 0.4,3.052 0,0" /> </g> <g transform="translate(405.3779,180.7212)" id="g26"> <path id="path28" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c -1.713,-1.584 -3.497,-2.963 -5.33,-4.162 1.183,-14.957 -1.662,-25.43 -7.801,-33.201 -1.713,-2.171 -3.537,-3.994 -5.437,-5.509 h 1.25 c 15.217,0 27.552,12.336 27.552,27.552 V 16.066 C 8.287,10.16 4.924,4.564 0,0" /> </g> <g transform="translate(382.1484,308.4634)" id="g30"> <path id="path32" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C -8.555,0.407 -10.788,-9.805 -5.019,-35.432 14.11,-16.584 12.704,-0.609 0,0" /> </g> <g transform="translate(339.479,150.1611)" id="g34"> <path id="path36" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,8.541 6.922,15.464 15.463,15.464 8.543,0 15.465,-6.923 15.465,-15.464 0,-2.427 -0.576,-4.714 -1.572,-6.759 2.039,-2.401 6.344,-3.426 12.302,0.96 5.713,4.215 9.417,14.465 10.009,27.95 -18.905,-6.227 -40.507,2.477 -48.891,12.44 -10.596,12.629 -19.691,49.994 17.168,74.23 3.465,2.281 6.617,4.548 9.463,6.81 -1.48,5.411 -2.819,10.841 -3.905,16.419 -2.211,11.291 -1.32,20.057 1.446,26.386 h -90.446 c -15.217,0 -27.552,-12.336 -27.552,-27.553 V 15.24 c 0,-15.216 12.335,-27.552 27.552,-27.552 H 6.133 C 2.413,-9.488 0,-5.032 0,0" /> </g> <g transform="translate(380.792,227.7183)" id="g38"> <path id="path40" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c -11.295,-6.08 -9.406,-22.011 -3.695,-23.773 6.563,-2.019 4.549,-7.577 -0.506,-7.577 -5.041,0 -14.13,2.025 -16.152,14.643 -1.518,9.483 3.521,22.383 17.019,27.144 -2.009,6.225 -3.992,12.284 -5.842,18.3 -2.576,-2.472 -5.291,-4.997 -8.146,-7.569 -17.368,-15.672 -23.229,-36.353 -10.602,-54.541 9.433,-13.583 25.072,-14.185 37.86,-8.148 -0.549,5.492 -1.533,11.283 -3.027,17.249 C 4.759,-15.656 2.391,-7.639 0,0" /> </g> <g transform="translate(402.3506,194.3457)" id="g42"> <path id="path44" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 12.566,12.577 2.91,36.234 -13.439,35.569 -9.396,20.879 -6.159,7.796 -4.168,-3.619 -2.699,-2.504 -1.296,-1.278 0,0" /> </g> <g transform="translate(388.9111,229.9146)" id="g46"> <path id="path48" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 16.35,0.665 26.006,-22.992 13.439,-35.569 12.144,-36.847 10.74,-38.073 9.271,-39.188 7.28,-27.772 4.043,-14.689 0,0 m -36.043,-35.569 c -12.627,18.188 -6.767,38.868 10.602,54.541 2.855,2.572 5.57,5.097 8.146,7.569 1.85,-6.016 3.833,-12.075 5.842,-18.3 -13.498,-4.762 -18.537,-17.661 -17.019,-27.144 2.022,-12.618 11.111,-14.643 16.152,-14.643 5.055,0 7.069,5.558 0.506,7.577 -5.711,1.762 -7.6,17.693 3.695,23.773 2.39,-7.639 4.759,-15.656 6.909,-24.272 1.494,-5.967 2.478,-11.757 3.026,-17.249 -12.787,-6.037 -28.426,-5.435 -37.859,8.148 M -6.763,78.549 C 5.941,77.94 7.348,61.965 -11.781,43.117 c -5.77,25.627 -3.536,35.839 5.018,35.432 M 3.336,-86.556 c 6.139,7.771 8.983,18.244 7.801,33.201 1.833,1.198 3.617,2.578 5.33,4.162 4.924,4.564 8.287,10.159 10.234,16.066 V -8.29 C 23.332,1.367 15.85,8.807 4.854,9.884 c -2.731,0.262 -5.28,0.282 -7.649,0.097 -1.115,3.905 -2.265,7.907 -3.463,12.016 -1.258,4.355 -2.367,8.401 -3.357,12.192 11.777,12.298 19.283,23.214 20.519,32.751 0.401,3.052 0.341,6.208 -0.185,9.196 -3.317,1.818 -7.103,2.73 -11.571,2.65 h -21.632 c -2.766,-6.329 -3.658,-15.198 -1.446,-26.489 1.086,-5.578 2.425,-11.008 3.905,-16.42 -2.846,-2.262 -5.998,-4.528 -9.463,-6.809 -36.859,-24.236 -27.764,-61.601 -17.168,-74.23 8.384,-9.963 29.986,-18.667 48.891,-12.441 -0.592,-13.484 -4.297,-23.734 -10.009,-27.949 -5.958,-4.386 -10.263,-3.361 -12.302,-0.961 0.996,2.045 1.572,4.332 1.572,6.76 0,8.541 -6.922,15.464 -15.465,15.464 -8.541,0 -15.463,-6.923 -15.463,-15.464 0,-5.032 2.221,-9.627 5.942,-12.452 h 41.195 c 1.9,1.516 3.918,3.477 5.631,5.649" /> </g> <g transform="translate(257.4902,211.418)" id="g50"> <path id="path52" style="fill:#d8e9fd;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 2.389,0.612 c 16.112,4.117 18.275,13.571 17.013,19.984 l 13.727,3.51 21.672,-84.727 -16.712,-4.276 -14.923,58.354 -20.171,-5.16 z" /> </g> <g transform="translate(280.3423,284.8091)" id="g54"> <path id="path56" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,11.978 8.763,13.014 12.028,13.014 7.052,0 12.651,-4.146 12.651,-11.615 0,-6.325 -4.096,-9.537 -7.673,-11.975 -4.875,-3.421 -7.412,-5.078 -8.243,-6.792 h 15.966 v -6.426 H -0.413 c 0.258,4.299 0.57,8.81 8.553,14.615 6.636,4.823 9.28,6.69 9.28,10.839 0,2.435 -1.555,5.236 -5.08,5.236 C 7.259,6.896 7.105,2.697 7.051,0 Z" /> </g> <g transform="translate(321.2446,245.8525)" id="g58"> <path id="path60" style="fill:#f1d01e;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 1.446,-0.413 c 2.765,-0.789 7.907,-1.975 9.634,4.08 0.489,1.71 0.921,6.217 -4.144,7.661 -6.319,1.805 -8.031,-4.184 -8.499,-5.829 l -8.554,2.442 c 2.501,8.751 9.221,13.597 19.75,10.588 6.252,-1.784 13.575,-7.293 10.753,-17.163 -1.353,-4.738 -5.157,-6.854 -8.129,-7.287 l -0.038,-0.132 c 1.513,-0.931 6.215,-4.905 3.941,-12.865 -2.52,-8.825 -10.821,-13.213 -20.229,-10.527 -4.411,1.261 -15.971,5.634 -11.801,20.241 l 9.016,-2.576 -0.082,-0.048 c -0.715,-2.501 -1.672,-8.347 4.514,-10.112 3.683,-1.05 7.62,0.526 9.104,5.726 1.823,6.38 -4.286,8.411 -8.563,9.631 z" /> </g> <g transform="translate(362.2236,150.3657)" id="g62"> <path id="path64" style="fill:#c50018;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,-4.129 -3.348,-7.474 -7.475,-7.474 -4.129,0 -7.476,3.345 -7.476,7.474 0,4.129 3.347,7.478 7.476,7.478 C -3.348,7.478 0,4.129 0,0" /> </g> </g> </g> </svg>',LOGOJA='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.1" id="svg2" xml:space="preserve" width="55" height="55" viewBox="0 0 55 55"><metadata id="metadata8"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><defs id="defs6"><clipPath clipPathUnits="userSpaceOnUse" id="clipPath18"><path d="M 0,532.918 H 745.508 V 0 H 0 Z" id="path16" /></clipPath></defs><g id="g10" transform="matrix(0.26053262,0,0,-0.26053262,-76.348511,95.783412)"><g id="g1350"><g transform="translate(501.8008,190.7261)" id="g20"><path id="path22" style="fill:#719dd4;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,-18.786 -15.229,-34.016 -34.016,-34.016 h -138.368 c -18.787,0 -34.016,15.23 -34.016,34.016 v 142.769 c 0,18.786 15.229,34.015 34.016,34.015 H -34.016 C -15.229,176.784 0,161.555 0,142.769 Z" /></g><g transform="translate(482.2988,353.0142)" id="g24"><path id="path26" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c -1.527,-11.774 -10.793,-25.251 -25.334,-40.434 1.223,-4.679 2.594,-9.675 4.145,-15.051 1.48,-5.074 2.898,-10.014 4.275,-14.835 2.926,0.227 6.072,0.204 9.445,-0.119 13.574,-1.331 22.811,-10.516 26.971,-22.438 V -19.52 C 19.502,-5.836 11.418,5.953 -0.23,11.353 0.42,7.664 0.494,3.768 0,0" /></g><g transform="translate(489.166,209.6392)" id="g28"><path id="path30" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c -2.115,-1.955 -4.318,-3.658 -6.58,-5.138 1.459,-18.466 -2.053,-31.395 -9.631,-40.989 -2.115,-2.681 -4.367,-4.932 -6.713,-6.802 h 1.543 c 18.787,0 34.016,15.23 34.016,34.016 V 19.835 C 10.23,12.543 6.078,5.635 0,0" /></g><g transform="translate(460.4863,367.3462)" id="g32"><path id="path34" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C -10.561,0.502 -13.318,-12.105 -6.195,-43.743 17.42,-20.475 15.686,-0.752 0,0" /></g><g transform="translate(407.8086,171.9106)" id="g36"><path id="path38" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,10.545 8.547,19.092 19.092,19.092 10.545,0 19.092,-8.547 19.092,-19.092 0,-2.996 -0.711,-5.82 -1.942,-8.345 2.518,-2.963 7.832,-4.229 15.188,1.186 7.052,5.204 11.625,17.858 12.357,34.506 -23.34,-7.687 -50.01,3.058 -60.359,15.358 -13.082,15.592 -24.311,61.722 21.195,91.643 4.277,2.815 8.168,5.614 11.682,8.406 -1.826,6.682 -3.479,13.385 -4.821,20.271 -2.73,13.94 -1.629,24.762 1.786,32.575 H -78.392 c -18.787,0 -34.016,-15.23 -34.016,-34.016 V 18.815 c 0,-18.786 15.229,-34.015 34.016,-34.015 H 7.572 C 2.979,-11.714 0,-6.212 0,0" /></g><g transform="translate(458.8125,267.6606)" id="g40"><path id="path42" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c -13.943,-7.506 -11.613,-27.174 -4.563,-29.35 8.104,-2.492 5.618,-9.353 -0.625,-9.353 -6.222,0 -17.443,2.5 -19.939,18.077 -1.875,11.707 4.348,27.633 21.012,33.511 -2.481,7.685 -4.93,15.166 -7.213,22.593 -3.18,-3.052 -6.533,-6.169 -10.057,-9.345 -21.443,-19.349 -28.678,-44.88 -13.09,-67.334 11.647,-16.77 30.955,-17.513 46.741,-10.06 -0.678,6.781 -1.891,13.93 -3.737,21.295 C 5.875,-19.328 2.951,-9.431 0,0" /></g><g transform="translate(485.4277,226.4595)" id="g44"><path id="path46" style="fill:#64a6f9;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 15.516,15.527 3.592,44.733 -16.592,43.912 -11.6,25.777 -7.604,9.625 -5.145,-4.468 -3.332,-3.091 -1.6,-1.578 0,0" /></g><g transform="translate(468.8359,270.3716)" id="g48"><path id="path50" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 C 20.184,0.821 32.107,-28.385 16.592,-43.912 14.992,-45.49 13.26,-47.003 11.447,-48.38 8.988,-34.287 4.992,-18.135 0,0 m -44.498,-43.912 c -15.588,22.454 -8.354,47.985 13.09,67.334 3.523,3.176 6.877,6.293 10.056,9.345 2.284,-7.427 4.733,-14.908 7.213,-22.593 -16.664,-5.878 -22.886,-21.804 -21.011,-33.511 2.496,-15.577 13.716,-18.077 19.939,-18.077 6.242,0 8.729,6.861 0.625,9.353 -7.051,2.176 -9.381,21.844 4.563,29.35 2.951,-9.431 5.875,-19.328 8.529,-29.966 1.846,-7.365 3.058,-14.514 3.736,-21.295 -15.785,-7.453 -35.094,-6.71 -46.74,10.06 M -8.35,96.975 C 7.336,96.223 9.07,76.5 -14.545,53.231 -21.668,84.869 -18.91,97.477 -8.35,96.975 M 4.119,-106.859 c 7.578,9.593 11.09,22.523 9.631,40.989 2.262,1.479 4.465,3.182 6.58,5.138 6.078,5.634 10.231,12.543 12.635,19.835 v 30.663 C 28.805,1.688 19.568,10.873 5.994,12.203 c -3.373,0.323 -6.519,0.347 -9.445,0.119 -1.377,4.822 -2.795,9.762 -4.276,14.835 -1.55,5.376 -2.921,10.372 -4.144,15.052 14.541,15.183 23.807,28.659 25.334,40.434 0.494,3.767 0.42,7.664 -0.231,11.352 -4.093,2.244 -8.767,3.371 -14.283,3.272 h -26.707 c -3.414,-7.814 -4.515,-18.763 -1.785,-32.703 1.342,-6.886 2.994,-13.589 4.82,-20.271 -3.513,-2.792 -7.404,-5.591 -11.681,-8.406 C -81.91,5.966 -70.682,-40.164 -57.6,-55.756 c 10.35,-12.3 37.02,-23.045 60.36,-15.358 -0.733,-16.648 -5.305,-29.302 -12.358,-34.506 -7.355,-5.415 -12.67,-4.149 -15.187,-1.186 1.23,2.525 1.941,5.349 1.941,8.345 0,10.545 -8.547,19.092 -19.092,19.092 -10.544,0 -19.091,-8.547 -19.091,-19.092 0,-6.212 2.742,-11.885 7.336,-15.372 h 50.859 c 2.346,1.871 4.836,4.293 6.951,6.974" /></g><g transform="translate(306.5874,247.5366)" id="g52"><path id="path54" style="fill:#d8e9fd;fill-opacity:1;fill-rule:nonzero;stroke:none" d="M 0,0 2.95,0.756 C 22.843,5.839 25.512,17.51 23.953,25.427 L 40.9,29.761 67.657,-74.841 47.023,-80.12 28.601,-8.078 3.698,-14.448 Z" /></g><g transform="translate(334.8003,338.1431)" id="g56"><path id="path58" style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,14.787 10.818,16.066 14.851,16.066 8.705,0 15.617,-5.118 15.617,-14.338 0,-7.81 -5.057,-11.775 -9.473,-14.785 -6.017,-4.223 -9.151,-6.269 -10.177,-8.385 h 19.711 v -7.934 H -0.51 c 0.32,5.309 0.703,10.877 10.559,18.044 8.193,5.953 11.457,8.26 11.457,13.382 0,3.006 -1.92,6.463 -6.272,6.463 C 8.962,8.513 8.771,3.33 8.706,0 Z" /></g><g transform="translate(385.2969,290.0483)" id="g60"><path id="path62" style="fill:#f1d01e;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 1.785,-0.51 c 3.414,-0.973 9.762,-2.438 11.895,5.036 0.603,2.113 1.136,7.676 -5.117,9.459 C 0.762,16.214 -1.352,8.819 -1.93,6.788 L -12.49,9.804 C -9.402,20.608 -1.105,26.59 11.893,22.876 19.611,20.673 28.652,13.872 25.168,1.687 23.498,-4.163 18.801,-6.775 15.133,-7.31 l -0.047,-0.163 c 1.867,-1.149 7.672,-6.055 4.865,-15.882 C 16.84,-34.25 6.592,-39.668 -5.023,-36.352 c -5.446,1.557 -19.717,6.956 -14.568,24.99 l 11.13,-3.182 -0.102,-0.058 c -0.882,-3.088 -2.064,-10.305 5.573,-12.485 4.547,-1.296 9.408,0.65 11.24,7.07 2.25,7.875 -5.291,10.384 -10.572,11.889 z" /></g><g transform="translate(435.8887,172.1636)" id="g64"><path id="path66" style="fill:#c50018;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m 0,0 c 0,-5.098 -4.133,-9.228 -9.229,-9.228 -5.097,0 -9.23,4.13 -9.23,9.228 0,5.098 4.133,9.231 9.23,9.231 C -4.133,9.231 0,5.098 0,0" /></g></g></g></svg>',LOGODEFAULT='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" id="svg1121" version="1.1" viewBox="0 0 34.131249 14.552089" height="55.000019" width="129"> <defs id="defs1115"> <clipPath id="clipPath4337" clipPathUnits="userSpaceOnUse"> <rect y="552" x="588" height="1436" width="1900" id="rect4339" style="fill:#a3b5c4;fill-opacity:1;stroke:none;stroke-width:15;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> </clipPath> </defs> <metadata id="metadata1118"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <g transform="matrix(1.086782,0,0,1.086782,-1.5473245,-1.305799)" id="g1812"> <ellipse transform="matrix(0.01046099,0,0,0.01046099,1.0167389,-6.2048529)" clip-path="url(#clipPath4337)" ry="768" rx="748" cy="1476" cx="1540" id="path4333" style="display:inline;fill:#a3b5c4;fill-opacity:1;stroke:none;stroke-width:15;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <ellipse ry="1.7826859" rx="1.6939216" cy="8.8343534" cx="16.446739" id="path4256" style="display:inline;fill:#c9dad8;fill-opacity:1;stroke:#c9dad8;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4328" d="m 17.630266,13.48709 0.32547,0.392044 0.34766,0.27369 0.310676,0.110955 0.236705,-0.05178 0.140544,-0.184926 0.19972,0.08137 0.155338,0.04438 0.613954,-0.421632 0.421631,-0.251499 c 0,0 0.887645,-0.0074 1.605157,-0.554777 0.717513,-0.547381 0.495602,-0.650939 0.495602,-0.650939 l -0.03699,-0.429029 -0.539984,-0.717513 -0.554777,-0.569571 -0.229309,-0.147941 c 0,0 -0.02219,-0.04438 -0.07397,-0.04438 -0.05178,0 -0.244103,-0.07397 -0.517793,0.04438 -0.273691,0.118353 -0.466014,0.170132 -0.843263,0.384646 -0.377248,0.214514 -0.710115,0.421631 -0.835865,0.495602 -0.12575,0.07397 -0.7471,0.429028 -0.7471,0.429028 l -0.09616,0.658336 z" style="display:inline;fill:#f8f8f8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path4330" d="m 18.081485,13.117239 c 0,0 1.017202,0.219808 1.490613,-0.13525 0.68255,-0.674097 1.655893,-1.154731 1.870355,-1.745308 0.108257,-0.298116 0.09265,-0.372377 -0.08018,-0.637191 -0.784085,-1.1169523 -2.186023,0.483563 -2.186023,0.483563 l -1.220511,1.042983 z" style="display:inline;fill:#c9dad8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path4281" d="m 18.923638,11.911166 c 0,0 -2.262073,0.360073 -1.245807,1.631426 1.016268,1.271354 1.33159,0.468415 1.33159,0.468415 0,0 0.237364,0.284021 0.550221,-0.01289 0.312857,-0.29691 0.801657,-0.486563 0.801657,-0.486563 0,0 0.833419,-0.08158 1.728851,-0.640345 0.895432,-0.558769 0.02545,-1.494644 0.02545,-1.494644 0,0 -0.704002,-0.914305 -1.191158,-1.062004 -0.487155,-0.147699 -1.260206,-0.205963 -1.260206,-0.205963 z" style="display:inline;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path5926" d="m 16.889165,3.9907067 c -0.205925,0.00902 -0.490584,0.016452 -0.682434,0.094306 -0.36351,0.1131625 -0.784019,0.3065916 -1.102039,0.4145197 C 14.805707,4.6009993 14.528383,4.8675841 14.442515,4.7707676 14.31485,4.6268244 14.224353,4.595363 14.045689,4.497559 13.801781,4.399505 13.873773,4.4448272 13.660866,4.3863283 13.513681,4.3458871 13.44829,4.2882958 13.047954,4.3023567 c -0.216087,0.00759 -0.47351,0.00804 -0.660081,0.089725 -0.374615,0.1640178 -0.299,0.2484757 -0.538572,0.4900252 -0.165108,0.1664709 -0.223029,0.5749831 -0.282041,0.818858 -0.06939,0.2867776 -0.0547,0.6010393 -0.02031,0.9674031 0.02761,0.2941965 0.09173,0.4973939 0.249388,0.759063 0.135084,0.2241989 0.324561,0.2835828 0.54659,0.4972893 0.07774,0.07483 0.368398,-0.038965 0.48488,-0.015104 0.108709,0.02227 -0.04817,0.2167088 -0.0532,0.2453834 -0.0538,0.2395169 -0.110503,0.087771 -0.0806,0.6274261 0.348123,2.0266892 1.005089,-1.0672647 0.326649,0.6686194 -0.05298,0.135564 -0.437594,0.3888068 -0.503368,0.5868538 -0.01267,0.165109 0.197835,0.19408 0.318997,0.178049 0.06266,0.480395 0.124982,1.042048 0.522242,1.372439 0.120177,0.106402 0.286652,0.09447 0.429317,0.126443 0.221641,0.268128 0.448668,0.557066 0.784087,0.689774 0.283845,0.148435 0.624913,0.051 0.896138,0.233065 0.712925,0.360901 1.59437,0.227424 2.240307,-0.214367 0.239736,-0.02584 0.501243,0.05119 0.751391,0.02222 0.575898,-0.02006 1.167207,-0.240005 1.523962,-0.711502 0.0729,-0.066 0.102081,-0.17814 0.168803,-0.240635 0.06616,0.0833 0.201079,0.165289 0.285653,0.05502 0.193072,-0.253436 0.223413,-0.595104 0.327145,-0.882559 0.08658,0.03641 0.0842,0.265734 0.19082,0.175968 0.08858,-0.27751 0.231055,-0.589554 0.157487,-0.875103 C 21.094968,9.8641514 20.994799,9.7109879 20.959751,9.6709914 21.06973,9.6649214 21.392146,9.6074124 21.364226,9.434279 21.284902,9.2640651 20.930324,9.0580893 20.78147,8.9636893 20.627489,7.0823629 20.831941,7.9730043 20.374475,6.5721668 20.286693,6.296366 20.179582,6.0253908 20.039149,5.7673778 19.814155,5.3540076 19.50363,4.9739075 19.050031,4.6605328 18.694157,4.4866157 18.779167,4.4124578 18.416319,4.2842118 18.040916,4.114893 17.923126,4.1144294 17.706217,4.0495514 17.421993,4.0042382 17.176226,3.9934611 16.889165,3.9907067 Z m -0.416777,3.7702345 c 0.258005,0.00976 0.429259,0.254814 0.527501,0.468441 -0.04651,0.1209123 -0.217613,0.1803318 -0.314316,0.2708005 -0.05227,0.030898 -0.195057,0.1419829 -0.07397,0.1762583 0.167574,-0.00801 0.341125,-0.101776 0.502363,-0.081253 0.0388,0.3136927 0.01038,0.7255031 -0.295939,0.9021495 -0.316884,0.082827 -0.562053,-0.2121416 -0.676829,-0.471618 -0.147096,-0.3666902 -0.185934,-0.8428431 0.07651,-1.1669988 0.06531,-0.068268 0.160011,-0.1063475 0.254678,-0.09778 z m 2.859244,2.5757878 c -0.07673,0.184758 -0.230659,0.330156 -0.407011,0.413252 -0.05539,0.150705 0.04004,0.35438 0.0297,0.483234 -0.04907,-0.160357 -0.0016,-0.361426 -0.108875,-0.496757 -0.07018,-0.02271 -0.147747,-0.0281 -0.211741,-0.07206 0.212794,0.117717 0.49561,0.03924 0.604766,-0.182094 0.02934,-0.03762 0.08159,-0.145575 0.09316,-0.145571 z m -0.965372,0.141988 c 0.04566,0.03409 0.204897,0.162857 0.07744,0.06785 -0.01641,-0.01138 -0.09019,-0.07086 -0.07744,-0.06785 z" style="display:inline;fill:#c9dad8;fill-opacity:1;stroke:none;stroke-width:0.05230495;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4257" d="m 18.562292,4.3406543 c 0,0 -0.01823,-0.1260925 0.05503,-0.2630911 0.107065,-0.2002118 0.364043,-0.4099485 0.661951,-0.5965291 0.390579,-0.2446202 0.878105,-0.4015772 1.457653,0.035985 0.150331,0.1135008 0.27512,0.3561849 0.43652,0.5462458 0,0 0.443822,0.5325871 0.05918,1.7900829 C 20.847978,7.110845 20.24142,6.5338754 20.24142,6.5338754 Z" style="display:inline;fill:#c9dad8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path4259" d="m 15.544962,4.3156298 c 0.674016,0.862017 2.224945,3.3646467 2.552481,2.1357471 0.20922,-0.9101061 0.01532,-2.3025973 0.01532,-2.3025973 0,0 -1.252038,-0.4658857 -2.567802,0.1668502 z" style="display:inline;fill:#899bb0;fill-opacity:1;fill-rule:evenodd;stroke:#899bb0;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4276" d="m 14.55326,9.3192563 c 0,0 -0.167376,0.052305 1.098404,0.3347517 1.26578,0.2824467 1.621453,-0.6695034 1.621453,-0.6695034 0,0 1.035638,-1.5168436 2.144503,-0.3033687 0,0 0.282447,0.3033687 0.784575,0.2929077 0,0 0.313829,-0.1778368 0.575354,-0.010461 0.261525,0.1673759 0.491667,0.3242907 0.491667,0.3242907 0,0 0.387056,0.3661347 -0.292908,0.3556737 0,0 0.4289,0.1046099 -0.08369,1.339007 l -0.146454,-0.334752 c 0,0 -0.20922,1.401773 -0.575354,0.868262 0,0 -0.168567,0.284042 -0.549335,0.538111 -0.461704,0.308073 -1.20062,0.579034 -1.882846,0.335382 0,0 -0.929436,1.023563 -2.512402,0.121125 0,0 -0.871728,0.166552 -1.457543,-0.816781 0,0 -0.805496,0.198759 -0.95195,-1.495922 0,0 -0.679965,0.04184 -0.04184,-0.543971 0.63812,-0.5858155 1.203014,-0.4602836 1.203014,-0.4602836 z" style="display:inline;fill:#f8f8f8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path4365" d="m 13.538544,5.3179276 c -0.01698,0.00333 -0.295429,0.00411 -0.542614,-0.1287894 -0.126298,-0.067906 -0.247026,-0.1270069 -0.29127,-0.1859807 -0.03564,-0.047508 0.0041,-0.1114587 -0.06685,-0.053022 -0.949852,0.7828116 -0.485867,2.0489157 0.391518,2.3817499 0,0 0.16803,-0.930502 1.084571,-1.9878057" style="display:inline;fill:#f8f8f8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4367" d="m 18.969129,4.5514697 c 0,0 0.961615,0.6805271 1.19832,1.6125543 0,0 1.153939,-1.7309068 -0.07397,-2.4262282 0,0 -0.207118,0.79888 -1.124351,0.8136739 z" style="display:inline;fill:#f8f8f8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path4215" d="m 12.838685,10.209018 c 0.144399,1.761682 0.938601,1.472882 0.938601,1.472882 0.63536,1.0108 1.429561,0.82308 1.429561,0.82308 1.371802,0.837522 2.527003,-0.101079 2.527003,-0.101079 1.934963,0.31768 2.411483,-0.924162 2.411483,-0.924162 0.375441,0.577601 0.606481,-0.808641 0.606481,-0.808641 0.05776,-0.11552 0.144401,0.34656 0.144401,0.34656 0.462079,-1.2129605 0.08324,-1.377833 0.08324,-1.377833 1.010801,0.02888 -0.203626,-0.702874 -0.203626,-0.702874 -0.02553,-1.0590654 -0.02508,-1.3292131 -0.390054,-2.3334378 0.809797,0.2163877 0.811057,-0.9606589 0.94917,-1.2297877 0.199919,-0.5390245 -0.0356,-1.5044904 -0.679641,-1.9195323 -0.265411,-0.1710387 -0.6002,-0.2486009 -1.002486,-0.1643198 -0.302755,0.1390128 -0.69254,0.3949895 -0.907628,0.6086619 -0.193613,0.1923395 -0.219649,0.3032114 -0.195442,0.415557" style="fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4227" d="m 12.838685,10.211495 c 0,0 -0.909721,0.0986 0.25992,-0.8111179 0,0 0.49096,-0.4187608 1.472881,-0.05776" style="fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4229" d="M 12.904904,9.565553 C 12.505653,8.7738548 12.670797,8.1656037 12.850244,7.958294" style="fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4201" d="m 14.581303,4.8227692 c 0,0 1.795749,-1.4517066 3.967207,-0.5150309" style="display:inline;fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path style="display:inline;fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 12.913527,7.8996581 C 10.894356,8.3520143 11.168402,4.2545247 12.764952,4.3025073 13.383569,4.2857373 14.097424,4.267855 14.65681,5.001513" id="path4207" /> <path id="path4233" d="m 18.340331,10.454499 c 0,0 0.66424,0.722 1.010801,-0.17328" style="display:inline;fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4235" d="m 18.889052,10.728859 0.0722,0.56316" style="display:inline;fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4251" d="m 14.13482,5.3440801 c -0.178391,0 -0.632946,0.00698 -0.994192,-0.086816 C 12.90873,5.1970519 12.715284,5.0953125 12.658026,4.9235378" style="display:inline;fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4301" d="m 12.672906,11.249959 c 0,0 -1.213113,0.880247 -0.724909,1.545981 l 0.59916,0.532586 0.821072,0.443823 1.227907,0.06657 0.806277,-0.147941 0.414234,-0.184926 0.443822,0.37725 0.399441,0.01479 0.229308,-0.110956 0.687924,-0.273691 0.362456,-0.284786 0.207117,-0.314373 -0.02959,-0.340264 c 0,0 -0.384646,-1.161335 -0.79888,-1.346261 0,0 -0.532587,-0.576969 -1.272291,-0.08137 0,0 -1.116952,0.369852 -2.085964,0.04438 -0.969012,-0.32547 -1.287085,0.05918 -1.287085,0.05918 z" style="display:inline;fill:#f8f8f8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path4325" d="m 11.85318,12.481094 c 0,0 1.220511,-0.702719 3.06977,-0.184927 0,0 0.917234,0.162736 1.508996,-0.06657 0.591764,-0.229309 0.791483,0.27369 0.791483,0.27369 0,0 0.466014,0.843262 0.39944,0.902438 l 0.177529,-0.05178 0.266293,-0.340264 0.07397,-0.258897 -0.140543,-0.429028 -0.273691,-0.576968 -0.310676,-0.443822 -0.251499,-0.184927 -0.421631,-0.184925 -0.406838,0.02959 -0.606556,0.251499 c 0,0 -1.028189,0.288485 -2.2487,-0.184925 0,0 -0.902438,-0.162736 -1.516392,0.983806 l -0.118353,0.399439 z" style="display:inline;fill:#c9dad8;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /> <path id="path4279" d="m 16.833672,13.785217 c 0.153423,-0.102967 1.454122,-0.405144 1.27153,-1.107052 -0.18259,-0.701906 -0.810488,-2.18308 -1.962749,-1.621151 -1.152264,0.561932 -2.428271,0.04422 -2.428271,0.04422 0,0 -0.502575,-0.191198 -0.917137,0.04475 -0.414562,0.235951 -0.835691,0.624285 -0.96967,1.263836 -0.133982,0.639557 1.559745,1.341991 1.559745,1.341991 0,0 1.628567,0.238813 2.395693,-0.276035 0,0 0.629729,0.697771 1.050859,0.309437 z" style="display:inline;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path d="m 17.114016,8.5098241 a 0.94989708,0.58640587 78.078062 0 1 -0.340613,1.0406955 0.94989708,0.58640587 78.078062 0 1 -0.776562,-0.678756 0.94989708,0.58640587 78.078062 0 1 0.23956,-1.1290216 0.94989708,0.58640587 78.078062 0 1 0.807736,0.5318372 l -0.503878,0.3563839 z" id="path4265" style="display:inline;fill:#505050;fill-opacity:1;stroke-width:0.10460994;stroke-miterlimit:4;stroke-dasharray:none" /> <path d="M 20.413977,8.0315906 A 0.85676325,0.52891095 78.078062 0 1 20.10676,8.9702498 0.85676325,0.52891095 78.078062 0 1 19.406336,8.3580431 0.85676325,0.52891095 78.078062 0 1 19.622407,7.3397176 0.85676325,0.52891095 78.078062 0 1 20.350948,7.8194108 l -0.454474,0.3214416 z" id="path4265-2" style="display:inline;fill:#505050;fill-opacity:1;stroke-width:0.10460994;stroke-miterlimit:4;stroke-dasharray:none" /> <path id="path5720" d="m 21.134832,7.6963634 c -0.112318,-0.027757 -0.262497,-0.081054 -0.333731,-0.1184383 -0.144005,-0.075573 -0.299329,-0.2698653 -0.299329,-0.374426 0,-0.096607 -0.193298,-0.846814 -0.294133,-1.1415597 C 19.91785,5.2148827 19.426736,4.6758205 18.806808,4.5243423 18.574543,4.4675893 18.37796,4.3777172 18.37796,4.3282851 c 0,-0.1165874 0.518787,-0.372059 0.755587,-0.3720818 0.225129,-2.09e-5 0.551773,0.1955105 0.754007,0.4513556 0.08958,0.113326 0.336843,0.5587874 0.549476,0.9899141 0.630891,1.2791719 1.127464,1.9684738 1.567563,2.1759633 0.217308,0.1024518 0.226116,0.111942 0.130881,0.1410215 -0.159835,0.048804 -0.77495,0.037681 -1.000642,-0.018094 z" style="fill:#000000;fill-opacity:0;stroke-width:0.05230495;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none" /> <path id="path4245" d="m 15.544387,4.3143709 c 0,0 1.555226,2.1088053 2.078276,2.2761811 0.523049,0.1673759 0.550099,-1.2673939 0.550099,-1.2673939 0,0 0.01046,-0.8054962 -0.03138,-1.16117" style="fill:none;fill-rule:evenodd;stroke:none;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path id="path4249" d="m 18.944377,4.5456262 c 0.250182,0.02965 0.853235,-0.055903 1.134665,-0.7723694" style="fill:none;fill-rule:evenodd;stroke:#505050;stroke-width:0.1046099;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <text id="text4245" y="2.0512714" x="11.557299" style="font-style:normal;font-weight:normal;font-size:0.12553188px;line-height:0%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.01046099px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" xml:space="preserve"><tspan style="font-size:0.4184396px;line-height:1.25;stroke-width:0.01046099px" y="2.0512714" x="11.557299" id="tspan4247"></tspan></text> </g> </svg>',GUIDEURL=_("guide url");"guide url"!==GUIDEURL&&""!==GUIDEURL||(GUIDEURL="https://github.com/sugarlabs/musicblocks/tree/master/guide/README.md");var NUMBERBLOCKDEFAULT=4,DEFAULTPALETTE="rhythm",TITLESTRING=_("Music Blocks is a collection of tools for exploring fundamental musical concepts in a fun way."),VERSION="2.72",BUILTINPALETTES=["search","rhythm","meter","pitch","intervals","tone","ornament","volume","drum","flow","action","boxes","widgets","graphics","pen","number","boolean","media","sensors","heap","ensemble","extras","myblocks"],BUILTINPALETTESFORL23N=[_("search"),_("rhythm"),_("meter"),_("pitch"),_("intervals"),_("tone"),_("ornament"),_("volume"),_("drum"),_("flow"),_("action"),_("boxes"),_("widgets"),_("graphics"),_("pen"),_("number"),_("boolean"),_("media"),_("sensors"),_("heap"),_("ensemble"),_("extras"),_("my blocks")],MULTIPALETTES=[["rhythm","meter","pitch","intervals","tone","ornament","volume","drum","widgets"],["flow","action","boxes","number","boolean","heap","extras","myblocks"],["graphics","pen","media","sensors","ensemble"]],SKIPPALETTES=["heap","extras"],MULTIPALETTEICONS=["music","logic","artwork"],MULTIPALETTENAMES=[_("music"),_("logic"),_("artwork")];function getMainToolbarButtonNames(t){return-1<["popdown-palette","run","step","step-music","stop-turtle","hard-stop-turtle","palette","help","sugarizer-stop","beginner","advanced","planet","planet-disabled","open","save","new"].indexOf(t)}function getAuxToolbarButtonNames(t){return-1<["paste-disabled","Cartesian","compile","utility","restore-trash","hide-blocks","collapse-blocks","go-home"].indexOf(t)}function beginnerBlock(t){return-1!==["newnote","note4","rest2","mynotevalue","meter","setbpm3","setmasterbpm2","everybeatdo","beatvalue","elapsednotes2","pitch","pitchnumber","hertz","steppitch","fourth","fifth","mypitch","pitchinhertz","setkey2","modelength","thirdinterval","sixthinterval","chordI","chordIV","chordV","settemperament","settimbre","newstaccato","newslur","tie","vibrato","chorus","tremolo","neighbor2","crescendo","decrescendo","setnotevolume","setsynthvolume","setdrumvolume","playdrum","playeffect","setdrum","if","ifthenelse","repeat","forever","backward","action","start","do","dispatch","listen","storebox1","box1","storebox2","box2","increment","incrementOne","storein","namedbox","status","matrix","rhythmruler2","pitchslider","rhythm2","stuplet","musickeyboard","tempo","modewidget","matrixcmajor","matrixgmajor","forward","back","left","right","setxy","arc","x","y","heading","scrollxy","fill","background","setpensize","penup","pendown","color","setcolor","setshade","number","random","oneOf","plus","minus","multiply","divide","equal","less","greater","text","media","show","turtleshell","speak","height","width","bottompos","toppos","leftpos","rightpos","mousebutton","mousex","mousey","myclick","push","pop","setHeapEntry","indexHeap","reverseHeap","emptyHeap","heapEmpty","heapLength","showHeap","setturtlename2","turtlename","print"].indexOf(t)}function createDefaultStack(){var t=localStorage.languagePreference;void 0===t&&(t=navigator.language),console.log("language setting is "+t),DATAOBJS="ja"===t?[[0,"start",screen.width/3,100,[null,1,null]],[1,"settimbre",0,0,[0,2,4,3]],[2,["voicename",{value:"guitar"}],0,0,[1]],[3,"hidden",0,0,[1,null]],[4,"newnote",0,0,[1,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:2}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"do"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,13]],[13,"newnote",0,0,[12,14,17,21]],[14,"divide",0,0,[13,15,16]],[15,["number",{value:1}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"vspace",0,0,[13,18]],[18,"pitch",0,0,[17,19,20,null]],[19,["solfege",{value:"mi"}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"hidden",0,0,[13,22]],[22,"newnote",0,0,[21,23,26,30]],[23,"divide",0,0,[22,24,25]],[24,["number",{value:1}],0,0,[23]],[25,["number",{value:4}],0,0,[23]],[26,"vspace",0,0,[22,27]],[27,"pitch",0,0,[26,28,29,null]],[28,["solfege",{value:"sol"}],0,0,[27]],[29,["number",{value:4}],0,0,[27]],[30,"hidden",0,0,[22,31]],[31,"newnote",0,0,[30,32,35,39]],[32,"divide",0,0,[31,33,34]],[33,["number",{value:1}],0,0,[32]],[34,["number",{value:1}],0,0,[32]],[35,"vspace",0,0,[31,36]],[36,"pitch",0,0,[35,37,38,null]],[37,["solfege",{value:"do"}],0,0,[36]],[38,["number",{value:5}],0,0,[36]],[39,"hidden",0,0,[31,null]]]:[[0,"start",screen.width/3,100,[null,1,null]],[1,"settimbre",0,0,[0,2,4,3]],[2,["voicename",{value:"guitar"}],0,0,[1]],[3,"hidden",0,0,[1,null]],[4,"newnote",0,0,[1,5,8,12]],[5,"divide",0,0,[4,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:4}],0,0,[5]],[8,"vspace",0,0,[4,9]],[9,"pitch",0,0,[8,10,11,null]],[10,["solfege",{value:"sol"}],0,0,[9]],[11,["number",{value:4}],0,0,[9]],[12,"hidden",0,0,[4,13]],[13,"newnote",0,0,[12,14,17,21]],[14,"divide",0,0,[13,15,16]],[15,["number",{value:1}],0,0,[14]],[16,["number",{value:4}],0,0,[14]],[17,"vspace",0,0,[13,18]],[18,"pitch",0,0,[17,19,20,null]],[19,["solfege",{value:"mi"}],0,0,[18]],[20,["number",{value:4}],0,0,[18]],[21,"hidden",0,0,[13,22]],[22,"newnote",0,0,[21,23,26,30]],[23,"divide",0,0,[22,24,25]],[24,["number",{value:1}],0,0,[23]],[25,["number",{value:2}],0,0,[23]],[26,"vspace",0,0,[22,27]],[27,"pitch",0,0,[26,28,29,null]],[28,["solfege",{value:"sol"}],0,0,[27]],[29,["number",{value:4}],0,0,[27]],[30,"hidden",0,0,[22,null]]]}function createHelpContent(){var t;if(void 0===(i=localStorage.languagePreference)&&(i=navigator.language),"ja"===i)var e=LOGOJA;else e=LOGODEFAULT;var i,s=_("Music Blocks is a collection of tools for exploring fundamental musical concepts in a fun way.");beginnerMode?(console.log(s),HELPCONTENT=[[_("Welcome to Music Blocks"),s,"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e)))],[_("Meet Mr. Mouse!"),_("Mr Mouse is our Music Blocks conductor.")+" "+_("Mr Mouse encourages you to explore Music Blocks.")+" "+_("Let us start our tour!"),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(LOGODEFAULT)))],[_("Play"),_("Click the run button to run the project in fast mode."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(RUNBUTTON)))],[_("Stop"),_("Stop the music (and the mice).")+" "+_("You can also type Alt-S to stop."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(STOPTURTLEBUTTON)))],[_("New project"),_("Initialize a new project."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(NEWBUTTON)))],[_("Load project from file"),_("You can also load projects from the file system."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(LOADBUTTON)))],[_("Save project"),_("Save your project to a file."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SAVEBUTTON)))],[_("Find and share projects"),_("This button opens a viewer for sharing projects and for finding example projects."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(PLANETBUTTON)))],[_("Palette buttons"),_("This toolbar contains the palette buttons including Rhythm Pitch Tone Action and more.")+" "+_("Click to show the palettes of blocks and drag blocks from the palettes onto the canvas to use them."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(RHYTHMPALETTEICON)))],[_("Cartesian/Polar"),_("Show or hide a coordinate grid."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(CARTESIANBUTTON)))],[_("Clean"),_("Clear the screen and return the mice to their initial positions."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(CLEARBUTTON)))],[_("Collapse"),_("Collapse the graphics window."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(COLLAPSEBUTTON)))],[_("Home"),_("Return all blocks to the center of the screen."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(GOHOMEBUTTON)))],[_("Show/hide blocks"),_("Hide or show the blocks and the palettes."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(HIDEBLOCKSBUTTON)))],[_("Expand/collapse collapsable blocks"),_("Expand or collapse start and action stacks."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(COLLAPSEBLOCKSBUTTON)))],[_("Decrease block size"),_("Decrease the size of the blocks."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SMALLERBUTTON)))],[_("Increase block size"),_("Increase the size of the blocks."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(BIGGERBUTTON)))],[_("Expand/collapse option toolbar"),_("Click this button to expand or collapse the auxillary toolbar."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(MENUBUTTON)))],[_("Run slow"),_("Click to run the project in slow mode."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SLOWBUTTON)))],[_("Run step by step"),_("Click to run the project step by step."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(STEPBUTTON)))],[_("Restore"),_("Restore blocks from the trash."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(RESTORETRASHBUTTON)))],[_("Switch mode"),_("Switch between beginner and advance modes."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(ADVANCEDBUTTON)))],[_("Select language"),_("Select your language preference."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(LANGUAGEBUTTON)))],[_("Keyboard shortcuts"),_("You can type d to create a do block and r to create a re block etc."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SHORTCUTSBUTTON)))],[_("Guide"),_("A detailed guide to Music Blocks is available."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e))),GUIDEURL,_("Music Blocks Guide")],[_("Help"),_("Show these messages."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(HELPBUTTON)))],[_("About"),_("Music Blocks is an open source collection of tools for exploring musical concepts.")+" "+_("A full list of contributors can be found in the Music Blocks GitHub repository.")+" "+_("Music Blocks is licensed under the AGPL.")+" "+_("The current version is")+" "+VERSION,"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e))),"https://github.com/sugarlabs/musicblocks",_("Music Blocks GitHub repository")],[_("Congratulations."),_("You have finished the tour. Please enjoy Music Blocks!"),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e)))]]):HELPCONTENT=[[_("Welcome to Music Blocks"),s,"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e)))],[_("Meet Mr. Mouse!"),_("Mr Mouse is our Music Blocks conductor.")+" "+_("Mr Mouse encourages you to explore Music Blocks.")+" "+_("Let us start our tour!"),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(LOGODEFAULT)))],[_("Run fast"),_("Click the run button to run the project in fast mode."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(RUNBUTTON)))],[_("Stop"),_("Stop the music (and the mice).")+" "+_("You can also type Alt-S to stop."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(STOPTURTLEBUTTON)))],[_("New project"),_("Initialize a new project."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(NEWBUTTON)))],[_("Load project from file"),_("You can also load projects from the file system."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(LOADBUTTON)))],[_("save"),_("Save project")+": "+_("Save your project to a file.")+"<br/><br/>"+_("Save mouse artwork as SVG")+": "+_("Save graphics from your project to as SVG.")+"<br/><br/>"+_("Save mouse artwork as PNG")+": "+_("Save graphics from your project as PNG.")+"<br/><br/>"+_("Save music as WAV")+": "+_("Save audio from your project as WAV.")+"<br/><br/>"+_("Save sheet music as ABC")+": "+_("Save your project to as an ABC file.")+"<br/><br/>"+_("Save sheet music as Lilypond")+": "+_("Save your project to as a Lilypond file.")+"<br/><br/>"+_("Save block artwork as SVG")+": "+_("Save block artwork as an SVG file."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SAVEBUTTON)))],[_("Load samples from server"),_("This button opens a viewer for loading example projects."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(PLANETBUTTON)))],[_("Palette buttons"),_("This toolbar contains the palette buttons including Rhythm Pitch Tone Action and more.")+" "+_("Click to show the palettes of blocks and drag blocks from the palettes onto the canvas to use them."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(RHYTHMPALETTEICON)))],[_("Cartesian/Polar"),_("Show or hide a coordinate grid."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(CARTESIANBUTTON)))],[_("Clean"),_("Clear the screen and return the mice to their initial positions."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(CLEARBUTTON)))],[_("Collapse"),_("Collapse the graphics window."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(COLLAPSEBUTTON)))],[_("Home"),_("Return all blocks to the center of the screen."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(GOHOMEBUTTON)))],[_("Show/hide blocks"),_("Hide or show the blocks and the palettes."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(HIDEBLOCKSBUTTON)))],[_("Expand/collapse collapsible blocks"),_("Expand or collapse start and action stacks."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(COLLAPSEBLOCKSBUTTON)))],[_("Decrease block size"),_("Decrease the size of the blocks."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SMALLERBUTTON)))],[_("Increase block size"),_("Increase the size of the blocks."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(BIGGERBUTTON)))],[_("Expand/collapse option toolbar"),_("Click this button to expand or collapse the auxiliary toolbar."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(MENUBUTTON)))],[_("Run slow"),_("Click to run the project in slow mode."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SLOWBUTTON)))],[_("Run step by step"),_("Click to run the project step by step."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(STEPBUTTON)))],[_("Switch mode"),_("Switch between beginner and advance modes."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(ADVANCEDBUTTON)))],[_("Enable scrolling"),_("You can scroll the blocks on the canvas."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SCROLLUNLOCKBUTTON)))],[_("Display statistics"),_("Display statistics about your Music project."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(STATSBUTTON)))],[_("Delete plugin"),_("Delete a selected plugin."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(PLUGINSDELETEBUTTON)))],[_("Select language"),_("Select your language preference."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(LANGUAGEBUTTON)))],[_("Restore"),_("Restore blocks from the trash."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(RESTORETRASHBUTTON)))],[_("Keyboard shortcuts"),_("You can type d to create a do block and r to create a re block etc."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SHORTCUTSBUTTON)))],[_("Guide"),_("A detailed guide to Music Blocks is available."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e))),GUIDEURL,_("Music Blocks Guide")],[_("Help"),_("Show these messages."),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(HELPBUTTON)))],[_("About"),_("Music Blocks is an open source collection of tools for exploring musical concepts.")+" "+_("A full list of contributors can be found in the Music Blocks GitHub repository.")+" "+_("Music Blocks is licensed under the AGPL.")+" "+_("The current version is")+" "+VERSION,"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e))),"https://github.com/sugarlabs/musicblocks",_("Music Blocks GitHub repository")],[_("Congratulations."),_("You have finished the tour. Please enjoy Music Blocks!"),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e)))]],BLOCKHELP=(_defineProperty(t={newnote:[_("The Note block is a container for one or more Pitch blocks.")+" "+_("The Note block specifies the duration (note value) of its contents."),"documentation",null,"note1"],playdrum:[_("You can use multiple Drum blocks within a Note block."),"documentation",null,"note4"],rest2:[_("A rest of the specified note value duration can be constructed using a Silence block."),"documentation",null,"rest2"],mynotevalue:[_("The Note value block is the value of the duration of the note currently being played."),"documentation",null,"everybeathelp"],meter:[_("The beat of the music is determined by the Meter block (by default, 4 1/4 notes per measure)."),"documentation",null,"meter"],setmasterbpm2:[_("The Master beats per minute block sets the number of 1/4 notes per minute for every voice."),"documentation",null,"setmasterbpm2"],setbpm3:[_("The Beats per minute block sets the number of 1/4 notes per minute."),"documentation",null,"bpmhelp"],everybeatdo:[_("The On-every-note block let you specify actions to take on every note."),"documentation",null,"everybeathelp"],beatvalue:[_("The Beat count block is the number of the current beat,")+" "+_("eg 1, 2, 3, or 4.")+" "+_("In the figure, it is used to take an action on the first beat of each measure."),"documentation",null,"beatvaluehelp"],elapsednotes2:[_("The Notes played block is the number of notes that have been played.")+" "+_("(By default, it counts quarter notes.)"),"documentation",null,"everybeathelp"],pitch:[_("The Pitch block specifies the pitch name and octave of a note that together determine the frequency of the note."),"documentation",null,"note1"],solfege:[_("Pitch can be specified in terms of do re mi fa sol la ti."),"documentation",null,"note1"],notename:[_("Pitch can be specified in terms of C D E F G A B."),"documentation",null,"note2"],pitchnumber:[_("The Pitch Number block will play a pitch associated by its number eg 0 for C and 7 for G."),"documentation",null,"note5"],steppitch:[_("The Scalar Step block (in combination with a Number block) will play the next pitch in a scale,")+" "+_("eg if the last note played was sol, Scalar Step 1 will play la."),"documentation",""],hertz:[_("The Hertz block (in combination with a Number block) will play a sound at the specified frequency."),"documentation",null,"note3"],setscalartransposition:[_("The Scalar transposition block will shift the pitches contained inside Note blocks up (or down) the scale.")+" "+_("In the example shown above, sol is shifted up to la."),"documentation",null,"scalartranshelp"],pitchinhertz:[_("The Pitch in Hertz block is the value in Hertz of the pitch of the note currently being played."),"documentation",""],mypitch:[_("The Pitch number block is the value of the pitch of the note currently being played."),"documentation",null,"everybeathelp"],setkey2:[_("The Set key block is used to set the key and mode,")+" "+_("eg C Major"),"documentation",null,"movablehelp"],modelength:[_("The Mode length block is the number of notes in the current scale.")+" "+_("Most Western scales have 7 notes."),"documentation",""],interval:[_("The Scalar interval block calculates a relative interval based on the current mode, skipping all notes outside of the mode.")+" "+_("In the figure, we add la to sol."),"documentation",null,"intervalhelp"],settemperament:[_("The Set temperament block is used to choose the tuning system used by Music Blocks."),"documentation",""],settimbre:[_("The Set timbre block selects a voice for the synthesizer,")+" "+_("eg guitar piano violin or cello."),"documentation",null,"settimbrehelp"],newstaccato:[_("The Staccato block shortens the length of the actual note while maintaining the specified rhythmic value of the notes."),"documentation",null,"staccatohelp"],newslur:[_("The Slur block lengthens the sustain of notes while maintaining the specified rhythmic value of the notes."),"documentation",null,"slurhelp"],vibrato:[_("The Vibrato block adds a rapid, slight variation in pitch."),"documentation",null,"vibratohelp"],neighbor2:[_("The Neighbor block rapidly switches between neighboring pitches."),"documentation",null,"neighbor2help"],neighbor:[_("The Neighbor block rapidly switches between neighboring pitches."),"documentation",null,"neighborhelp"],crescendo:[_("The Crescendo block will increase the volume of the contained notes by a specified amount for every note played.")+" "+_("For example if you have 7 notes in sequence contained in a Crescendo block with a value of 5 the final note will be at 35% more than the starting volume."),"documentation",null,"crescendohelp"],decrescendo:[_("The Decrescendo block will decrease the volume of the contained notes by a specified amount for every note played.")+" "+_("For example if you have 7 notes in sequence contained in a Decrescendo block with a value of 5 the final note will be at 35% less than the starting volume."),"documentation",null,"crescendohelp"],setsynthvolume:[_("The Set synth volume block will change the volume of a particular synth,")+" "+_("eg guitar violin snare drum etc.")+" "+_("The default volume is 50.")+" "+_("The range is 0 for silence to 100 for full volume."),"documentation",""],setnotevolume:[_("The Set master volume block sets the volume for all synthesizers."),"documentation",""],setdrum:[_("The Set drum block will select a drum sound to replace the pitch of any contained notes.")+" "+_("In the example above, a kick drum sound will be played instead of sol."),"documentation",null,"setdrumhelp"],status:[_("The Status block opens a tool for inspecting the status of Music Blocks as it is running."),"documentation",null,"status"],matrix:[_("The Phrase Maker block opens a tool to create musical phrases."),"documentation",null,"matrix"],rhythmruler2:[_("The Rhythm Maker block opens a tool to create drum machines."),"documentation",null,"rhythmruler2"],pitchslider:[_("The Pitch-slider block opens a tool to generate arbitray pitches."),"documentation",null,"pitchslider"],rhythm2:[_("The Rhythm block is used to generate rhythm patterns."),"documentation",null,"rhythm2"],stuplet:[_("Tuplets are a collection of notes that get scaled to a specific duration.")+" "+_("Using tuplets makes it easy to create groups of notes that are not based on a power of 2."),"documentation",null,"matrix"],musickeyboard:[_("The Music keyboard block opens a piano keyboard that can be used to create notes."),"documentation",null,"musickeyboard2"],tempo:[_("The Tempo block opens a metronome to visualize the beat."),"documentation",null,"tempo"],modewidget:[_("The Custom mode block opens a tool to explore musical mode (the spacing of the notes in a scale)."),"documentation",""],meterwidget:[_("The Meter block opens a tool to select strong beats for the meter."),"documentation",null,"meterwidget"],repeat:[_("The Repeat block will repeat the contained blocks.")+" "+_("In this example the note will be played 4 times."),"documentation",null,"repeathelp"],forever:[_("The Forever block will repeat the contained blocks forever.")+" "+_("In this example of a simple drum machine a kick drum will play 1/4 notes forever."),"documentation",null,"foreverhelp"],if:[_("Conditionals lets your program take different actions depending on the condition.")+" "+_("In this example if the mouse button is pressed a snare drum will play."),"documentation",null,"ifhelp"],ifthenelse:[_("Conditionals lets your program take different actions depending on the condition.")+" "+_("In this example if the mouse button is pressed a snare drum will play, else a kick drum will play."),"documentation",null,"elifhelp"],backward:[_("The Backward block runs code in reverse order (Musical retrograde)."),"documentation",""],action:[_("The Action block is used to group together blocks so that they can be used more than once.")+" "+_("It is often used for storing a phrase of music that is repeated."),"documentation",null,"actionhelp"],start:[_("Each Start block is a separate voice.")+" "+_("All of the Start blocks run at the same time when the Play button is pressed."),"documentation",""],listen:[_("The Listen block is used to listen for an event such as a mouse click.")+" "+_("When the event happens, an action is taken."),"documentation",null,"broadcasthelp"],dispatch:[_("The Broadcast block is used to trigger an event."),"documentation",null,"broadcasthelp"],do:[_("The Do block is used to initiate an action.")+" "+_("In the example, it is used with the One of block to choose a random phase."),"documentation",null,"dohelp"],storebox1:[_("The Store in Box 1 block is used to store a value in Box 1."),"documentation",null,"box1help"],box1:[_("The Box 1 block returns the value stored in Box 1."),"documentation",null,"box1help"],storebox2:[_("The Store in Box 2 block is used to store a value in Box 2."),"documentation",null,"box2help"],box2:[_("The Box 2 block returns the value stored in Box 2."),"documentation",null,"box2help"],increment:[_("The Add-to block is used to add to the value stored in a box.")+" "+_("It can also be used with other blocks such as Color and Pen size."),"documentation",""],incrementOne:[_("The Add-1-to block adds one to the value stored in a box."),"documentation",""],number:[_("The Number block holds a number."),"documentation",""],random:[_("The Random block returns a random number."),"documentation",null,"randomhelp"],oneOf:[_("The One-of block returns one of two choices."),"documentation",null,"oneofhelp"],plus:[_("The Plus block is used to add."),"documentation",""],minus:[_("The Minus block is used to subtract."),"documentation",""],multiply:[_("The Multiply block is used to multiply."),"documentation",""],divide:[_("The Divide block is used to divide."),"documentation",null,"note1"],greater:[_("The Greater-than block returns True if the top number is greater than the bottom number."),"documentation",""],less:[_("The Less-than block returns True if the top number is less than the bottom number."),"documentation",""],equal:[_("The Equal block returns True if the two numbers are equal."),"documentation",""],forward:[_("The Forward block moves the mouse forward."),"documentation",null,"forwardhelp"],back:[_("The Back block moves the mouse backward."),"documentation",null,"forwardhelp"],left:[_("The Left block turns the mouse to the left."),"documentation",null,"forwardhelp"],right:[_("The Right block turns the mouse to the right."),"documentation",null,"forwardhelp"],arc:[_("The Arc block moves the mouse in a arc."),"documentation",null,"archelp"],setxy:[_("The Set XY block moves the mouse to a specific position on the screen."),"documentation",""],scrollxy:[_("The Scroll XY block moves the canvas."),"documentation",null,"everybeathelp"],x:[_("The X block returns the horizontal position of the mouse."),"documentation",null,"xyhelp"],y:[_("The Y block returns the vertical position of the mouse."),"documentation",null,"xyhelp"],heading:[_("The Heading block returns the orientation of the mouse."),"documentation",""],setpensize:[_("The Set-pen-size block changes the size of the pen."),"documentation",""],penup:[_("The Pen-up block raises the pen so that it does not draw."),"documentation",""],pendown:[_("The Pen-down block lowers the pen so that it draws."),"documentation",""],color:[_("The Color block returns the current pen color."),"documentation",""],setcolor:[_("The Set-color block changes the pen color."),"documentation",""],setshade:[_("The Set-shade block changes the pen color from dark to light."),"documentation",""],print:[_("The Print block displays text at the top of the screen."),"documentation",""],text:[_("The Text block holds a text string."),"documentation",""],media:[_("The Media block is used to import an image."),"documentation",null,"turtleshell"],show:[_("The Show block is used to display text or images on the canvas."),"documentation",""],turtleshell:[_("The Shell block is used to change the appearance of the mouse."),"documentation",null,"turtleshell"],speak:[_("The Speak block outputs to the text-to-speech synthesizer"),"documentation",""],height:[_("The Height block returns the height of the canvas."),"documentation",""],width:[_("The Width block returns the width of the canvas."),"documentation",""],toppos:[_("The Top block returns the position of the top of the canvas.")+" "+_("In this example, the mouse moves upward until it reaches the top edge of the canvas; then it reappears at the bottom of the canvas."),"documentation",null,"bottomposhelp"],bottompos:[_("The Bottom block returns the position of the bottom of the canvas.")+" "+_("In this example, the mouse moves upward until it reaches the top edge of the canvas; then it reappears at the bottom of the canvas."),"documentation",null,"bottomposhelp"],leftpos:[_("The Left block returns the position of the left of the canvas.")+" "+_("In this example, the mouse moves right until it reaches the right edge of the canvas; then it reappears at the left of the canvas."),"documentation",null,"lrhelp"],rightpos:[_("The Right block returns the position of the right of the canvas.")+" "+_("In this example, the mouse moves right until it reaches the right edge of the canvas; then it reappears at the left of the canvas."),"documentation",null,"lrhelp"],mousebutton:[_("The Mouse-button block returns True if the mouse button is pressed."),"documentation",null,"mousebuttonhelp"],mousex:[_("The Cursor X block returns the horizontal position of the mouse."),"documentation",null,"mousebuttonhelp"],mousey:[_("The Cursor Y block returns the vertical position of the mouse."),"documentation",null,"mousebuttonhelp"],myclick:[_("The Click block returns True if a mouse has been clicked."),"documentation",null,"clickhelp"],setturtlename2:[_("The Set-name block is used to name a mouse."),"documentation",null,"clickhelp"],turtlename:[_("The Mouse-name block returns the name of a mouse."),"documentation",null,"clickhelp"],rhythmicdot2:[_("The Dot block extends the duration of a note by 50%.")+" "+_("Eg a dotted quarter note will play for 3/8 (1/4 + 1/8) of a beat."),"documentation",null,"dothelp"],tie:[_("The Tie block works on pairs of notes, combining them into one note."),"documentation",null,"tiehelp"],multiplybeatfactor:[_("The Multiply note value block changes the duration of notes by changing their note values."),"documentation",null,"multiplybeathelp"],skipnotes:[_("The Skip notes block will cause notes to be skipped."),"documentation",null,"skiphelp"],newswing2:[_("The Swing block works on pairs of notes (specified by note value), adding some duration (specified by swing value) to the first note and taking the same amount from the second note."),"documentation",null,"swinghelp"],osctime:[_("The Milliseconds block is similar to a Note block except that it uses time (in MS) to specify the note duration."),"documentation",null,"osctimehelp"],pickup:[_("The Pickup block is used to accommodate any notes that come in before the beat."),"documentation",null,"pickup"],onbeatdo:[_("The On-strong-beat block let you specify actions to take on specified beats."),"documentation",null,"everybeathelp"],offbeatdo:[_("The On-weak-beat block let you specify actions to take on weak (off) beats."),"documentation",null,"everybeathelp"],drift:[_("The No clock block decouples the notes from the master clock."),"documentation",""],elapsednotes:[_("The Whole notes played block returns the total number of whole notes played."),"documentation",null,"elapsedhelp"],notecounter:[_("The Note counter block can be used to count the number of contained notes."),"documentation",null,"notecounterhelp"],measurevalue:[_("The Measure count block returns the current measure."),"documentation",""],bpmfactor:[_("The Beats per minute block returns the current beats per minute."),"documentation",""],accidental:[_("The Accidental block is used to create sharps and flats"),"documentation",null,"accidental"],settransposition:[_("The Semi-tone transposition block will shift the pitches contained inside Note blocks up (or down) by half steps.")+" "+_("In the example shown above, sol is shifted up to sol#."),"documentation",""],register:[_("The Register block provides an easy way to modify the register (octave) of the notes that follow it."),"documentation",null,"registerhelp"],invert1:[_("The Invert block rotates any contained notes around a target note."),"documentation",null,"inverthelp"],deltapitch:[_("The Change in pitch block is the difference (in half steps) between the current pitch being played and the previous pitch played."),"documentation",null,"deltapitchhelp"],eastindiansolfege:[_("Pitch can be specified in terms of ni dha pa ma ga re sa."),"documentation",null,"eihelp"],accidentalname:[_("The Accidental selector block is used to choose between double-sharp, sharp, natural, flat, and double-flat."),"documentation",""],number2octave:[_("The Number to octave block will convert a pitch number to an octave."),"documentation",""],setpitchnumberoffset:[_("The Set pitch number offset block is used to set the offset for mapping pitch numbers to pitch and octave."),"documentation",null,"pitchnumberhelp"],consonantstepsizeup:[_("The Scalar step up block returns the number of semi-tones up to the next note in the current key and mode."),"documentation",""],consonantstepsizedown:[_("The Scalar step down block returns the number of semi-tones down to the previous note in the current key and mode."),"documentation",""],movable:[_("When Moveable do is false, the solfege note names are always tied to specific pitches,")+" "+_('eg "do" is always "C-natural"); when Moveable do is true, the solfege note names are assigned to scale degrees ("do" is always the first degree of the major scale).'),"documentation",null,"movablehelp"],definemode:[_("The Define mode block allows you define a custom mode by specifiying pitch numbers."),"documentation",null,"definemode"],semitoneinterval:[_("The Semi-tone interval block calculates a relative interval based on half steps.")+" "+_("In the figure, we add sol# to sol."),"documentation",""],measureintervalscalar:[_("The Scalar interval block measures the distance between two notes in the current key and mode."),"documentation",""],measureintervalsemitones:[_("The Semi-tone interval block measures the distance between two notes in semi-tones."),"documentation",""],doubly:[_("The Doubly block will double the size of an interval."),"documentation",null,"doublyhelp"],voicename:[_("The Set timbre block selects a voice for the synthesizer,")+" "+_("eg guitar piano violin or cello."),"documentation",""],chorus:[_("The Chorus block adds a chorus effect."),"documentation",null,"chorushelp"],phaser:[_("The Phaser block adds a sweeping sound."),"documentation",null,"phaserhelp"],dis:[_("The Distortion block adds distortion to the pitch."),"documentation",null,"dishelp"],tremolo:[_("The Tremolo block adds a wavering effect."),"documentation",null,"tremolohelp"],harmonic2:[_("The Harmonic block will add harmonics to the contained notes."),"documentation",null,"harmonichelp"],harmonic:[_("The Weighted partials block is used to specify the partials associated with a timbre."),"documentation",""],partial:[_("The Partial block is used to specify a weight for a specific partical harmonic."),"documentation",""],fmsynth:[_("The FM synth block is a frequency modulator used to define a timbre."),"documentation",null,"fmsynthhelp"],amsynth:[_("The AM synth block is an amplitude modulator used to define a timbre."),"documentation",null,"amsynthhelp"],duosynth:[_("The Duo synth block is a duo-frequency modulator used to define a timbre."),"documentation",null,"duosynthhelp"],articulation:[_("The Set relative volume block changes the volume of the contained notes."),"documentation",null,"articulationhelp"],notevolumefactor:[_("The Note volume block returns the current volume of the current synthesizer."),"documentation",""],playnoise:[_("The Play noise block will generate white, pink, or brown noise."),"documentation",""],drumname:[_("The Drum name block is used to select a drum."),"documentation",null,"note4"],effectsname:[_("The Effects name block is used to select a sound effect."),"documentation",null,"effectshelp"],noisename:[_("The Noise name block is used to select a noise synthesizer."),"documentation",""]},"pitchslider",[_("The Pitch slider tool to is used to generate pitches at selected frequencies."),"documentation",""]),_defineProperty(t,"pitchstaircase",[_("The Pitch staircase tool to is used to generate pitches from a given ratio."),"documentation",null,"pitchstaircase"]),_defineProperty(t,"pitchdrummatrix",[_("The Pitch drum matrix is used to map pitches to drum sounds."),"documentation",""]),_defineProperty(t,"temperament",[_("The Temperament tool is used to define custom tuning."),"documentation",null,"temperament"]),_defineProperty(t,"temperamentname",[_("The Temperament name block is used to select a tuning method."),"documentation",""]),_defineProperty(t,"tuplet4",[_("The Tuplet block is used to generate a group of notes played in a condensed amount of time."),"documentation",null,"tuplet4"]),_defineProperty(t,"while",[_("The While block will repeat while the condition is true."),"documentation",null,"whilehelp"]),_defineProperty(t,"until",[_("The Until block will repeat until the condition is true."),"documentation",null,"untilhelp"]),_defineProperty(t,"waitfor",[_("The Waitfor block will wait until the condition is true."),"documentation",null,"waitforhelp"]),_defineProperty(t,"break",[_("The Stop block will stop a loop")+": "+_("Forever, Repeat, While, or Until."),"documentation",""]),_defineProperty(t,"switch",[_("The Switch block will run the code in the matching Case."),"documentation",null,"switchhelp"]),_defineProperty(t,"case",[_("The Case block is used inside of a Switch to define matches."),"documentation",null,"switchhelp"]),_defineProperty(t,"default",[_("The Default block is used inside of a Switch to define a default action."),"documentation",null,"switchhelp"]),_defineProperty(t,"duplicatenotes",[_("The Duplicate block will run each block multiple times.")+" "+_("The output of the example is: Sol, Sol, Sol, Sol, Re, Re, Re, Re, Sol, Sol, Sol, Sol."),"documentation",null,"duphelp"]),_defineProperty(t,"arg",[_("The Arg block contains the value of an argument passed to an action."),"documentation",""]),_defineProperty(t,"namedarg",[_("The Arg block contains the value of an argument passed to an action."),"documentation",""]),_defineProperty(t,"calcArg",[_("The Calculate block returns a value calculated by an action."),"documentation",""]),_defineProperty(t,"doArg",[_("The Do block is used to initiate an action."),"documentation",""]),_defineProperty(t,"namedcalcArg",[_("The Calculate block returns a value calculated by an action."),"documentation",""]),_defineProperty(t,"nameddoArg",[_("The Do block is used to initiate an action."),"documentation",""]),_defineProperty(t,"namedcalc",[_("The Calculate block returns a value calculated by an action."),"documentation",""]),_defineProperty(t,"calc",[_("The Calculate block returns a value calculated by an action."),"documentation",""]),_defineProperty(t,"returnToUrl",[_("The Return to URL block will return a value to a webpage."),"documentation",""]),_defineProperty(t,"return",[_("The Return block will return a value from an action."),"documentation",""]),_defineProperty(t,"storein",[_("The Store in block will store a value in a box."),"documentation",""]),_defineProperty(t,"storein2",[_("The Store in block will store a value in a box."),"documentation",""]),_defineProperty(t,"namedbox",[_("The Box block returns the value stored in a box."),"documentation",""]),_defineProperty(t,"abs",[_("The Abs block returns the absolute value."),"documentation",""]),_defineProperty(t,"sqrt",[_("The Sqrt block returns the square root."),"documentation",""]),_defineProperty(t,"power",[_("The Power block calculates a power function."),"documentation",""]),_defineProperty(t,"mod",[_("The Mod block returns the remainder from a division."),"documentation",""]),_defineProperty(t,"int",[_("The Int block returns an integer."),"documentation",""]),_defineProperty(t,"not",[_("The Not block is the logical not operator."),"documentation",""]),_defineProperty(t,"and",[_("The And block is the logical and operator."),"documentation",""]),_defineProperty(t,"or",[_("The Or block is the logical or operator."),"documentation",""]),_defineProperty(t,"boolean",[_("The Boolean block is used to specify true or false."),"documentation",""]),_defineProperty(t,"push",[_("The Push block adds a value to the top of the heap."),"documentation",""]),_defineProperty(t,"pop",[_("The Pop block removes the value at the top of the heap."),"documentation",""]),_defineProperty(t,"setHeapEntry",[_("The Set-heap entry block sets a value in he heap at the specified location."),"documentation",""]),_defineProperty(t,"indexHeap",[_("The Index-heap block returns a value in the heap at a specified location."),"documentation",""]),_defineProperty(t,"reverseHeap",[_("The Reverse-heap block reverses the order of the heap."),"documentation",""]),_defineProperty(t,"loadHeap",[_("The Load-heap block loads the heap from a file."),"documentation",""]),_defineProperty(t,"saveHeap",[_("The Save-heap block saves the heap to a file."),"documentation",""]),_defineProperty(t,"emptyHeap",[_("The Empty-heap block empties the heap."),"documentation",""]),_defineProperty(t,"heapEmpty",[_("The Heap-empty? block returns true if the heap is empty."),"documentation",""]),_defineProperty(t,"heapLength",[_("The Heap-length block returns the length of the heap."),"documentation",""]),_defineProperty(t,"showHeap",[_("The Show-heap block displays the contents of the heap at the top of the screen."),"documentation",""]),_defineProperty(t,"saveHeapToApp",[_("The Save-heap-to-app block saves the heap to a web page."),"documentation",""]),_defineProperty(t,"loadHeapFromApp",[_("The Load-heap-from-app block loads the heap from a web page."),"documentation",""]),_defineProperty(t,"comment",[_("The Comment block prints a comment at the top of the screen when the program is running in slow mode."),"documentation",""]),_defineProperty(t,"wait",[_("The Wait block pauses the program for a specified number of seconds."),"documentation",""]),_defineProperty(t,"vspace",[_("The Space block is used to add space between blocks."),"documentation",""]),_defineProperty(t,"hspace",[_("The Space block is used to add space between blocks."),"documentation",""]),_defineProperty(t,"openProject",[_("The Open project block is used to open a project from a web page."),"documentation",""]),_defineProperty(t,"hideblocks",[_("The Hide blocks block hides the blocks."),"documentation",""]),_defineProperty(t,"showblocks",[_("The Show blocks block shows the blocks."),"documentation",""]),_defineProperty(t,"nobackground",[_("The No background block eliminates the background from the saved SVG output."),"documentation",""]),_defineProperty(t,"makeblock",[_("The Make block block creates a new block."),"documentation",""]),_defineProperty(t,"dockblock",[_("The Dock block block connections two blocks."),"documentation",""]),_defineProperty(t,"runblock",[_("The Run block block runs a block."),"documentation",""]),_defineProperty(t,"moveblock",[_("The Move block block moves a block."),"documentation",""]),_defineProperty(t,"deleteblock",[_("The Delete block block removes a block."),"documentation",""]),_defineProperty(t,"openpalette",[_("The Open palette block opens a palette."),"documentation",""]),_defineProperty(t,"setheading",[_("The Set heading block sets the heading of the mouse."),"documentation",""]),_defineProperty(t,"bezier",[_("The Bezier block draws a Bezier curve."),"documentation",""]),_defineProperty(t,"controlpoint1",[_("The Control-point 1 block sets the first control point for the Bezier curve."),"documentation",""]),_defineProperty(t,"controlpoint1",[_("The Control-point 2 block sets the second control point for the Bezier curve."),"documentation",""]),_defineProperty(t,"sethue",[_("The Set hue block changes the color of the pen."),"documentation",""]),_defineProperty(t,"setgrey",[_("The Set grey block changes the vividness of the pen color."),"documentation",""]),_defineProperty(t,"settranslucency",[_("The Set translucency block changes the opacity of the pen."),"documentation",""]),_defineProperty(t,"fill",[_("The Fill block fills in a shape with a color."),"documentation",null,"fillhelp"]),_defineProperty(t,"hollowline",[_("The Hollow line block creates a line with a hollow center."),"documentation",""]),_defineProperty(t,"background",[_("The Background block sets the window background color."),"documentation",""]),_defineProperty(t,"grey",[_("The Grey block returns the current pen grey value."),"documentation",""]),_defineProperty(t,"shade",[_("The Shade block returns the current pen shade value."),"documentation",""]),_defineProperty(t,"pensize",[_("The Pen size block returns the current pen size value."),"documentation",""]),_defineProperty(t,"setfont",[_("The Set font block sets the font used by the Show block."),"documentation",""]),_defineProperty(t,"tofrequency",[_("The To frequency block converts a pitch name and octave to Hertz."),"documentation",""]),_defineProperty(t,"stopvideocam",[_("The Stop media block stops audio or video playback."),"documentation",""]),_defineProperty(t,"loadFile",[_("The Open file block opens a file for use with the Show block."),"documentation",""]),_defineProperty(t,"video",[_("The Video block selects video for use with the Show block."),"documentation",""]),_defineProperty(t,"camera",[_("The Camera block connects a webcam to the Show block."),"documentation",""]),_defineProperty(t,"keyboard",[_("The Keyboard block returns computer keyboard input."),"documentation",""]),_defineProperty(t,"toascii",[_("The To ASCII block converts numbers to letters."),"documentation",""]),_defineProperty(t,"time",[_("The Time block returns the number of seconds that the program has been running."),"documentation",""]),_defineProperty(t,"getcolorpixel",[_("The Get pixel block returns the color of the pixel under the mouse."),"documentation",""]),_defineProperty(t,"getred",[_("The Get red block returns the red component of the pixel under the mouse."),"documentation",""]),_defineProperty(t,"getgreen",[_("The Get green block returns the green component of the pixel under the mouse."),"documentation",""]),_defineProperty(t,"getblue",[_("The Get blue block returns the blue component of the pixel under the mouse."),"documentation",""]),_defineProperty(t,"loudness",[_("The Loudness block returns the volume detected by the microphone."),"documentation",""]),_defineProperty(t,"newturtle",[_("The New mouse block will create a new mouse."),"documentation",""]),_defineProperty(t,"foundturtle",[_("The Found mouse block will return true if the specified mouse can be found."),"documentation",""]),_defineProperty(t,"turtlesync",[_("The Mouse sync block aligns the beat count between mice."),"documentation",""]),_defineProperty(t,"turtlenote2",[_("The Mouse note block returns the current note value being played by the specified mouse."),"documentation",""]),_defineProperty(t,"turtlepitch",[_("The Mouse pitch block returns the current pitch number being played by the specified mouse."),"documentation",""]),_defineProperty(t,"turtleelapsednotes",[_("The Mouse elapse notes block returns the number of notes played by the specified mouse."),"documentation",""]),_defineProperty(t,"xturtle",[_("The X mouse block returns the X position of the specified mouse."),"documentation",""]),_defineProperty(t,"yturtle",[_("The Y mouse block returns the Y position of the specified mouse."),"documentation",""]),_defineProperty(t,"setturtle",[_("The Set mouse block sends a stack of blocks to be run by the specified mouse."),"documentation",""]),_defineProperty(t,"turtleheading",[_("The Mouse heading block returns the heading of the specified mouse."),"documentation",""]),_defineProperty(t,"turtlecolor",[_("The Mouse color block returns the pen color of the specified mouse."),"documentation",""]),_defineProperty(t,"startTurtle",[_("The Start mouse block starts the specified mouse."),"documentation",""]),_defineProperty(t,"stopTurtle",[_("The Stop mouse block stops the specified mouse."),"documentation",""]),t),void 0===(i=localStorage.languagePreference)&&(i=navigator.language),beginnerMode&&"ja"===i&&(BLOCKHELP.beatvalue=[_("The Beat count block is the number of the current beat,")+" "+_("In the figure, it is used to take an action on the first beat of each measure."),"documentation",null,"everybeathelp"],BLOCKHELP.setkey2=[_("The Set key block is used to set the key and mode,"),"documentation",""],BLOCKHELP.settimbre=[_("The Set timbre block selects a voice for the synthesizer,"),"documentation",""],BLOCKHELP.increment=[_("The Add-to block is used to add to the value stored in a box."),"documentation",""],BLOCKHELP.listen=[_("The Listen block is used to listen for an event such as a mouse click."),"documentation",null,"broadcasthelp"],BLOCKHELP.setdrum=[_("The Set drum block will select a drum sound to replace the pitch of any contained notes."),"documentation",null,"rhythmruler2"],BLOCKHELP.if=[_("Conditionals lets your program take different actions depending on the condition.")+" "+_("In this example if the mouse button is pressed a snare drum will play."),"documentation",null,"ifhelp"],BLOCKHELP.ifthenelse=[_("Conditionals lets your program take different actions depending on the condition.")+" "+_("In this example if the mouse button is pressed a snare drum will play."),"documentation",null,"elifhelp"],BLOCKHELP.musickeyboard=[_("The Music keyboard block opens a piano keyboard that can be used to create notes."),"documentation",null,"musickeyboardja"])}function getMunsellColor(t,e,i){for(var s=Math.round(t/2.5);s<0;)s+=40;s%=40;var l=Math.floor(e/10),o=l+1;l<0?o=l=0:10<l&&(o=l=10);var a=(10*o-e)/10;1<a?a=1:a<0&&(a=0);var n=Math.round(14*i/100);return n<0?n=0:14<n&&(n=14),interpColor(MUNSELL[165*s+15*l+n],MUNSELL[165*s+15*o+n],a)}function getcolor(t){var e=Math.floor(t/2.5),i=e+1;for(p=i-t/2.5,e%=40;e<0;)e+=40;return 40===(i=e+1)&&(i=0),[10*Math.floor(COLORS40[e][0]*p+COLORS40[i][0]*(1-p)),100*Math.floor(COLORS40[e][1]*p+COLORS40[i][1]*(1-p))/14,interpColor(COLORS40[e][2],COLORS40[i][2],p)]}function searchColors(t,e,i){for(var s=-1,l=1e7,o=0;o<100;o++){var a=getcolor(o),n=parseInt(a[2].substr(1,2),16),r=parseInt(a[2].substr(3,2),16),c=parseInt(a[2].substr(5,2),16),h=(n-t)*(n-t)+(r-e)*(r-e)+(c-i)*(c-i);h<l&&(l=h,s=o)}return s}function searchAllColors(t,e,i){for(var s=-1,l=1e7,o=0;o<MUNSELL.length;o++){var a=MUNSELL[o],n=parseInt(a.substr(1,2),16),r=parseInt(a.substr(3,2),16),c=parseInt(a.substr(5,2),16),h=(n-t)*(n-t)+(r-e)*(r-e)+(c-i)*(c-i);h<l&&(l=h,s=o)}return s}window.onload=function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(0<e&&(DetectVersionOfIE=parseInt(t.substring(e+5,t.indexOf(".",e)),10)),0<t.indexOf("Trident/")){var i=t.indexOf("rv:");DetectVersionOfIE=parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var s=t.indexOf("Edge/");0<s&&(DetectVersionOfIE=parseInt(t.substring(s+5,t.indexOf(".",s)),10)),"undefined"!=typeof DetectVersionOfIE&&(document.body.innerHTML="<div style='margin: 200px;'>",document.body.innerHTML+="<h1 style='font-size: 100px; font-family: Arial; text-align: center; color: #F00;'>Music Blocks</h1>",document.body.innerHTML+="<h3 style='font-size: 40px; font-family: Arial; text-align: center;'>Music Blocks will not work in Internet Explorer, you can use:</h3>",document.body.innerHTML+="<div style='width: 550px; margin: 0 auto;'><a href='https://www.chromium.org/getting-involved/download-chromium' style='float: left; display: inherit; font-family: Arial; font-size: 30px; color: #0327F1; text-decoration: none;'>Chromium</a>",document.body.innerHTML+="<a href='https://www.google.com/chrome/' style='float: left; margin-left: 40px;display: inherit; font-family: Arial; font-size: 30px; color: #0327F1; text-decoration: none;'>Chrome</a>",document.body.innerHTML+="<a href='https://support.apple.com/downloads/safari' style='float: left; margin-left: 40px;display: inherit; font-family: Arial; font-size: 30px; color: #0327F1; text-decoration: none;'>Safari</a>",document.body.innerHTML+="<a href='https://www.mozilla.org/en-US/firefox/new/' style='float: left; margin-left: 40px;display: inherit; font-family: Arial; font-size: 30px; color: #0327F1; text-decoration: none;'>Firefox</a>",document.body.innerHTML+="</div></div>")},interpColor=function(t,e,i){if(void 0===t&&void 0===e||(void 0===t?t=e:void 0===e&&(e=t)),0===i)return e;if(1===i)return t;var s=parseInt(t.substr(1,2),16),l=parseInt(t.substr(3,2),16),o=parseInt(t.substr(5,2),16),a=parseInt(e.substr(1,2),16),n=parseInt(e.substr(3,2),16),r=parseInt(e.substr(5,2),16),c=Math.floor(s*i+a*(1-i)),h=Math.floor(l*i+n*(1-i)),u=Math.floor(o*i+r*(1-i));return createjs.Graphics.getRGB(c,h,u,1)},COLORS40=[[6,24,"#ff007e"],[6,24,"#ff0066"],[6,24,"#ff0048"],[6,26,"#ff0000"],[6,26,"#ff3000"],[6,20,"#fd6600"],[8,24,"#ffa300"],[8,22,"#ffb000"],[8,22,"#ffb900"],[8,22,"#ffc000"],[9,22,"#ffe400"],[9,22,"#ffe800"],[9,22,"#f6ee00"],[9,22,"#e1f400"],[9,22,"#c4fb00"],[8,28,"#4eeb00"],[8,22,"#00f200"],[8,28,"#00fd3c"],[6,28,"#00c260"],[6,28,"#00c273"],[6,28,"#00c286"],[6,28,"#00c29d"],[6,26,"#00c1b6"],[6,24,"#00c0ca"],[6,24,"#00c0e7"],[6,20,"#00b9f1"],[6,20,"#00b5ff"],[6,20,"#00b0ff"],[6,20,"#00abff"],[6,18,"#00a1ff"],[4,28,"#005dff"],[4,28,"#4231ff"],[4,28,"#8000fe"],[4,28,"#a000ef"],[6,28,"#f009ff"],[6,28,"#ff00ff"],[6,28,"#ff00f9"],[6,28,"#ff00d9"],[6,26,"#ff00b2"],[6,24,"#ff0098"]],MUNSELL=["#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2c1620","#350f23","#3d0526","#450029","#4c002c","#530030","#5a0034","#600037","#600037","#600037","#600037","#600037","#600037","#600037","#313131","#412c32","#4c2633","#561e34","#601136","#690038","#73003b","#7c003d","#850040","#8d0043","#8d0043","#8d0043","#8d0043","#8d0043","#8d0043","#484848","#5b4247","#693c45","#753444","#802843","#8b1843","#960043","#9f0043","#aa0044","#b30044","#bc0046","#bc0046","#bc0046","#bc0046","#bc0046","#616161","#735c5f","#82565d","#8f4e5b","#9b4659","#a63c58","#b12e57","#bc1756","#c60056","#d10056","#db0056","#e30057","#ed0058","#ed0058","#ed0058","#7a7a7a","#8b7679","#9b7076","#a96973","#b76171","#c3596f","#d04d6d","#da416c","#e62d6b","#f0036a","#fc0069","#ff0069","#ff0068","#ff0068","#ff0068","#949494","#a59193","#b58b8f","#c4848c","#d17e8a","#de7587","#eb6c85","#f76183","#ff5281","#ff417f","#ff277f","#ff007e","#ff007e","#ff007e","#ff007e","#aeaeae","#beabad","#cfa6aa","#df9fa6","#ee98a3","#fc90a0","#ff869d","#ff7b9a","#ff6e98","#ff6095","#ff5293","#ff5293","#ff5293","#ff5293","#ff5293","#c8c8c8","#d7c7c8","#eac0c4","#fbbac0","#ffb2bc","#ffa9b9","#ff9db5","#ff94b1","#ff94b1","#ff94b1","#ff94b1","#ff94b1","#ff94b1","#ff94b1","#ff94b1","#e3e3e3","#f2e2e3","#ffdbde","#ffd3da","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffccd6","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2d161e","#360f1f","#3f0321","#470023","#4e0025","#570028","#570028","#570028","#570028","#570028","#570028","#570028","#570028","#570028","#313131","#422c30","#4d262f","#571e2f","#620f2f","#6c002f","#760030","#800031","#890032","#890032","#890032","#890032","#890032","#890032","#890032","#484848","#5c4244","#6a3c41","#76343d","#82283a","#8d1738","#980036","#a10034","#ab0033","#b50032","#c10032","#c10032","#c10032","#c10032","#c10032","#616161","#745c5d","#835659","#904e55","#9d4651","#a83c4e","#b32e4b","#be1548","#c80046","#d30044","#dd0041","#e60041","#ef003e","#ef003e","#ef003e","#7a7a7a","#8c7677","#9c7072","#ab696d","#b86169","#c55864","#d24c60","#dc415d","#e82d5a","#f30057","#ff0055","#ff0054","#ff0053","#ff0052","#ff0051","#949494","#a59191","#b68b8c","#c68486","#d37d81","#e1757d","#ee6b78","#f96174","#ff5270","#ff416c","#ff2a69","#ff0067","#ff0066","#ff0066","#ff0066","#aeaeae","#bfabab","#d0a5a6","#e09fa0","#f0989b","#fe9095","#ff868f","#ff7b8b","#ff6e86","#ff6282","#ff6282","#ff6282","#ff6282","#ff6282","#ff6282","#c8c8c8","#d8c7c7","#ecc0c0","#fdb9ba","#ffb1b3","#ffa9ad","#ff9ea6","#ff9ea6","#ff9ea6","#ff9ea6","#ff9ea6","#ff9ea6","#ff9ea6","#ff9ea6","#ff9ea6","#e3e3e3","#f3e2e2","#ffdbda","#ffd3d3","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffcccd","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2e161c","#370f1b","#40021c","#48001c","#50001d","#59001f","#59001f","#59001f","#59001f","#59001f","#59001f","#59001f","#59001f","#59001f","#313131","#422c2e","#4e262b","#581d29","#630e26","#6e0025","#770024","#810024","#8b0024","#8b0024","#8b0024","#8b0024","#8b0024","#8b0024","#8b0024","#484848","#5c4342","#6b3c3c","#763437","#822a31","#8d192c","#980028","#a10025","#ab0021","#b6001f","#c1001e","#c1001e","#c1001e","#c1001e","#c1001e","#616161","#745c5b","#845554","#914f4d","#9e4647","#a93c41","#b3303b","#be1a34","#c8002f","#d30029","#dc0025","#e40021","#ed001d","#ed001d","#ed001d","#7a7a7a","#8c7675","#9d706e","#ac6966","#ba625f","#c65858","#d34d51","#dd424b","#e92f44","#f4083e","#fd0039","#ff0034","#ff0031","#ff0031","#ff0031","#949494","#a6918f","#b78b88","#c78480","#d47d79","#e27572","#ef6c6b","#fb6264","#ff545c","#ff4455","#ff3150","#ff0a4b","#ff0048","#ff0048","#ff0048","#aeaeae","#c0abaa","#d2a5a2","#e29f9a","#f29892","#ff908b","#ff8682","#ff7c7b","#ff7073","#ff646d","#ff646d","#ff646d","#ff646d","#ff646d","#ff646d","#c8c8c8","#d9c7c5","#edc0bc","#ffb9b3","#ffb1aa","#ffa9a2","#ff9e98","#ff9e98","#ff9e98","#ff9e98","#ff9e98","#ff9e98","#ff9e98","#ff9e98","#ff9e98","#e3e3e3","#f4e2e0","#ffdbd5","#ffd3cb","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffcbc4","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2e161a","#380f18","#410216","#490016","#510016","#5a0016","#5a0016","#5a0016","#5a0016","#5a0016","#5a0016","#5a0016","#5a0016","#5a0016","#313131","#432c2c","#4f2627","#591e22","#63111d","#6e0019","#770016","#810014","#8b0012","#8b0012","#8b0012","#8b0012","#8b0012","#8b0012","#8b0012","#484848","#5c4340","#6a3c38","#763530","#812b28","#8c1d1f","#970017","#a00010","#a90008","#b40000","#c00000","#c00000","#c00000","#c00000","#c00000","#616161","#745c59","#845650","#914f47","#9e473e","#a83e35","#b2332c","#bc2222","#c60018","#cf000b","#d90000","#e00000","#ea0000","#ea0000","#ea0000","#7a7a7a","#8d7673","#9e706a","#ac6a60","#ba6256","#c65a4b","#d25041","#dc4537","#e7362b","#f0201f","#f90010","#ff0000","#ff0000","#ff0000","#ff0000","#949494","#a7908d","#b88b83","#c7857a","#d57e6f","#e37664","#ef6e5a","#fa644e","#ff5942","#ff4c34","#ff3e29","#ff2914","#ff0d00","#ff0000","#ff0000","#aeaeae","#c1aba7","#d3a59d","#e39f93","#f39887","#ff917d","#ff8871","#ff7f65","#ff7558","#ff6b4f","#ff6045","#ff6045","#ff6045","#ff6045","#ff6045","#c8c8c8","#d9c7c3","#efc0b7","#ffb9ab","#ffb29f","#ffaa93","#ffa185","#ff987c","#ff987c","#ff987c","#ff987c","#ff987c","#ff987c","#ff987c","#ff987c","#e3e3e3","#f5e2de","#ffdad0","#ffd4c2","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffccb7","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2e1717","#390e13","#410310","#4a000d","#52000b","#5a000a","#5a000a","#5a000a","#5a000a","#5a000a","#5a000a","#5a000a","#5a000a","#5a000a","#313131","#422d2a","#4e2622","#581f1b","#631313","#6c000b","#760004","#800000","#890000","#890000","#890000","#890000","#890000","#890000","#890000","#484848","#5c433e","#6a3d34","#75362a","#802e1f","#8a2212","#930e00","#9c0000","#a50000","#ae0000","#b80000","#b80000","#b80000","#b80000","#b80000","#616161","#755c57","#84564b","#905040","#9c4933","#a64125","#af3913","#b72e00","#be2200","#c60600","#cc0000","#d40000","#db0000","#db0000","#db0000","#7a7a7a","#8d7771","#9e7164","#ac6b57","#b96449","#c55d3a","#cf5529","#d74d14","#df4500","#e63a00","#ee2c00","#f51400","#fc0000","#ff0000","#ff0000","#949494","#a8918a","#b98b7d","#c78671","#d47f63","#e17854","#ec7144","#f76931","#ff6216","#ff5900","#ff4f00","#ff4500","#ff3b00","#ff3000","#ff3000","#aeaeae","#c1aba5","#d3a697","#e3a08a","#f29a7b","#fe936e","#ff8c5c","#ff844a","#ff7c33","#ff761d","#ff6e00","#ff6e00","#ff6e00","#ff6e00","#ff6e00","#c8c8c8","#dac7c1","#f0c0b1","#ffbaa2","#ffb493","#ffad84","#ffa572","#ff9e61","#ff9e61","#ff9e61","#ff9e61","#ff9e61","#ff9e61","#ff9e61","#ff9e61","#e3e3e3","#f6e2db","#ffdbc9","#ffd5ba","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffcdab","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2e1714","#390f0b","#410505","#490000","#520000","#520000","#520000","#520000","#520000","#520000","#520000","#520000","#520000","#520000","#313131","#422d28","#4e271e","#572112","#611801","#690700","#690700","#690700","#690700","#690700","#690700","#690700","#690700","#690700","#690700","#484848","#5b443c","#683e2f","#723921","#7b330f","#822d00","#8a2400","#8a2400","#8a2400","#8a2400","#8a2400","#8a2400","#8a2400","#8a2400","#8a2400","#616161","#745d54","#835746","#8e5238","#984d27","#a04711","#a64300","#ac3d00","#ac3d00","#ac3d00","#ac3d00","#ac3d00","#ac3d00","#ac3d00","#ac3d00","#7a7a7a","#8d776e","#9c725f","#aa6c50","#b6673e","#c0612b","#c75c11","#cd5800","#d15500","#d65000","#d65000","#d65000","#d65000","#d65000","#d65000","#949494","#a89187","#b78c78","#c68768","#d28259","#dd7c46","#e67730","#ee720d","#f46e00","#f86a00","#fd6600","#fd6600","#fd6600","#fd6600","#fd6600","#aeaeae","#c2aba2","#d2a792","#e2a181","#ef9c71","#fa9760","#ff914a","#ff8b2d","#ff8700","#ff8300","#ff8000","#ff8000","#ff8000","#ff8000","#ff8000","#c8c8c8","#dbc7bd","#efc1aa","#febc9a","#ffb687","#ffb175","#ffab60","#ffa548","#ffa548","#ffa548","#ffa548","#ffa548","#ffa548","#ffa548","#ffa548","#e3e3e3","#f7e2d8","#ffdcc3","#ffd7b0","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffd09d","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2d1810","#381101","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#3f0a00","#313131","#412e26","#4b2918","#542404","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#5c1e00","#484848","#5a443a","#65402b","#6e3c19","#753800","#7b3400","#7b3400","#7b3400","#7b3400","#7b3400","#7b3400","#7b3400","#7b3400","#7b3400","#7b3400","#616161","#735d51","#815940","#8a5530","#93511c","#994d00","#9e4a00","#a34600","#a34600","#a34600","#a34600","#a34600","#a34600","#a34600","#a34600","#7a7a7a","#8c776b","#9a735a","#a76f47","#b16a33","#b8661b","#be6300","#c36100","#c75e00","#c75e00","#c75e00","#c75e00","#c75e00","#c75e00","#c75e00","#949494","#a79184","#b58d73","#c28960","#cd854c","#d68136","#de7d17","#e37a00","#e77800","#ea7600","#ed7400","#ed7400","#ed7400","#ed7400","#ed7400","#aeaeae","#c2ac9e","#d1a88c","#dea479","#e9a066","#f39b50","#fd9735","#ff9404","#ff9100","#ff8f00","#ff8e00","#ff8c00","#ff8c00","#ff8c00","#ff8c00","#c8c8c8","#dbc7b9","#ecc3a5","#fabe92","#ffba7c","#ffb667","#ffb24e","#ffae2e","#ffaa00","#ffa800","#ffa600","#ffa500","#ffa300","#ffa300","#ffa300","#e3e3e3","#f7e2d3","#ffdebc","#ffd9a8","#ffd593","#ffd07e","#ffd07e","#ffd07e","#ffd07e","#ffd07e","#ffd07e","#ffd07e","#ffd07e","#ffd07e","#ffd07e","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2b190d","#351400","#351400","#351400","#351400","#351400","#351400","#351400","#351400","#351400","#351400","#351400","#351400","#351400","#313131","#3f2f24","#482b12","#502800","#552500","#552500","#552500","#552500","#552500","#552500","#552500","#552500","#552500","#552500","#552500","#484848","#584538","#624227","#6a3f12","#6f3c00","#743a00","#743a00","#743a00","#743a00","#743a00","#743a00","#743a00","#743a00","#743a00","#743a00","#616161","#725e4f","#7e5a3b","#865729","#8d550f","#925200","#955100","#955100","#955100","#955100","#955100","#955100","#955100","#955100","#955100","#7a7a7a","#8b7869","#987455","#a37140","#ab6e28","#b16c03","#b56a00","#b86800","#bb6700","#bb6700","#bb6700","#bb6700","#bb6700","#bb6700","#bb6700","#949494","#a69282","#b38f6e","#be8b59","#c88842","#cf8526","#d48300","#d88100","#db8000","#dd7f00","#dd7f00","#dd7f00","#dd7f00","#dd7f00","#dd7f00","#aeaeae","#c0ad9b","#cea987","#daa672","#e4a35c","#eca043","#f39d1f","#f89b00","#fc9900","#fe9800","#ff9800","#ff9800","#ff9800","#ff9800","#ff9800","#c8c8c8","#dbc8b5","#e9c4a0","#f6c18b","#ffbd73","#ffbb5b","#ffb83e","#ffb509","#ffb300","#ffb200","#ffb100","#ffb000","#ffb000","#ffb000","#ffb000","#e3e3e3","#f7e3cf","#ffdfb7","#ffdca0","#ffd989","#ffd671","#ffd359","#ffd359","#ffd359","#ffd359","#ffd359","#ffd359","#ffd359","#ffd359","#ffd359","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#291a0a","#321600","#321600","#321600","#321600","#321600","#321600","#321600","#321600","#321600","#321600","#321600","#321600","#321600","#313131","#3d2f22","#452d0e","#4c2b00","#502900","#502900","#502900","#502900","#502900","#502900","#502900","#502900","#502900","#502900","#502900","#484848","#564636","#5e4423","#654209","#694000","#6e3e00","#6e3e00","#6e3e00","#6e3e00","#6e3e00","#6e3e00","#6e3e00","#6e3e00","#6e3e00","#6e3e00","#616161","#705f4c","#7a5c37","#815a22","#865800","#8a5700","#8d5600","#8d5600","#8d5600","#8d5600","#8d5600","#8d5600","#8d5600","#8d5600","#8d5600","#7a7a7a","#897966","#947650","#9e7438","#a4721c","#a87000","#ab6f00","#ae6e00","#b06d00","#b06d00","#b06d00","#b06d00","#b06d00","#b06d00","#b06d00","#949494","#a4937f","#af9169","#b98e51","#c08c38","#c68a13","#ca8900","#cd8800","#cf8700","#d18600","#d18600","#d18600","#d18600","#d18600","#d18600","#aeaeae","#beae98","#caab81","#d4a96a","#dca752","#e3a535","#e9a300","#eda100","#efa100","#f1a000","#f2a000","#f2a000","#f2a000","#f2a000","#f2a000","#c8c8c8","#d9c8b2","#e5c69b","#efc483","#f9c269","#ffc04f","#ffbe2b","#ffbc00","#ffbb00","#ffba00","#ffb900","#ffb900","#ffb900","#ffb900","#ffb900","#e3e3e3","#f5e4cb","#ffe2b1","#ffdf99","#ffdd7f","#ffdb63","#ffd948","#ffd948","#ffd948","#ffd948","#ffd948","#ffd948","#ffd948","#ffd948","#ffd948","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#271b08","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#2e1900","#313131","#3b3121","#422f08","#472d00","#472d00","#472d00","#472d00","#472d00","#472d00","#472d00","#472d00","#472d00","#472d00","#472d00","#472d00","#484848","#534735","#5a4620","#604401","#644300","#644300","#644300","#644300","#644300","#644300","#644300","#644300","#644300","#644300","#644300","#616161","#6d604b","#755f34","#7b5d1b","#7f5c00","#825b00","#845b00","#845b00","#845b00","#845b00","#845b00","#845b00","#845b00","#845b00","#845b00","#7a7a7a","#877a64","#90784c","#977731","#9c7610","#9f7500","#a27400","#a47300","#a47300","#a47300","#a47300","#a47300","#a47300","#a47300","#a47300","#949494","#a1947c","#aa9365","#b2914b","#b8902e","#bd8f00","#c08e00","#c28d00","#c48d00","#c48d00","#c48d00","#c48d00","#c48d00","#c48d00","#c48d00","#aeaeae","#bbaf96","#c5ad7d","#ceac64","#d4aa49","#daa926","#dea800","#e1a700","#e3a700","#e4a600","#e5a600","#e5a600","#e5a600","#e5a600","#e5a600","#c8c8c8","#d6caaf","#e0c897","#e8c77d","#f0c662","#f6c444","#fbc312","#ffc200","#ffc100","#ffc000","#ffc000","#ffc000","#ffc000","#ffc000","#ffc000","#e3e3e3","#f2e5c8","#fce4ad","#ffe393","#ffe178","#ffe05c","#ffdf37","#ffdf37","#ffdf37","#ffdf37","#ffdf37","#ffdf37","#ffdf37","#ffdf37","#ffdf37","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#241c08","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#2a1b00","#313131","#393120","#3e3005","#423000","#423000","#423000","#423000","#423000","#423000","#423000","#423000","#423000","#423000","#423000","#423000","#484848","#504835","#56481e","#5a4700","#5d4600","#5d4600","#5d4600","#5d4600","#5d4600","#5d4600","#5d4600","#5d4600","#5d4600","#5d4600","#5d4600","#616161","#6a614a","#706131","#756016","#785f00","#7a5f00","#7b5f00","#7b5f00","#7b5f00","#7b5f00","#7b5f00","#7b5f00","#7b5f00","#7b5f00","#7b5f00","#7a7a7a","#837b63","#8a7b49","#907a2d","#947902","#967900","#987800","#9a7800","#9a7800","#9a7800","#9a7800","#9a7800","#9a7800","#9a7800","#9a7800","#949494","#9e957b","#a49562","#ab9446","#af9425","#b29300","#b59300","#b69200","#b89200","#b89200","#b89200","#b89200","#b89200","#b89200","#b89200","#aeaeae","#b8b094","#bfb07a","#c5af5f","#caaf43","#ceae14","#d1ad00","#d3ad00","#d4ad00","#d5ad00","#d5ad00","#d5ad00","#d5ad00","#d5ad00","#d5ad00","#c8c8c8","#d3cbad","#d9cb93","#dfca78","#e5ca5b","#e9c938","#edc900","#efc800","#f1c800","#f2c800","#f3c800","#f3c800","#f3c800","#f3c800","#f3c800","#e3e3e3","#efe6c6","#f5e6aa","#fbe68f","#ffe672","#ffe552","#ffe522","#ffe500","#ffe400","#ffe400","#ffe400","#ffe400","#ffe400","#ffe400","#ffe400","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#221d0a","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#261d00","#313131","#363221","#3a3204","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#3d3200","#484848","#4e4935","#51491e","#544900","#564900","#564900","#564900","#564900","#564900","#564900","#564900","#564900","#564900","#564900","#564900","#616161","#67624a","#6b6231","#6e6213","#706200","#726200","#736200","#736200","#736200","#736200","#736200","#736200","#736200","#736200","#736200","#7a7a7a","#817c63","#867c49","#897c2a","#8b7c00","#8d7c00","#8e7c00","#8f7c00","#8f7c00","#8f7c00","#8f7c00","#8f7c00","#8f7c00","#8f7c00","#8f7c00","#949494","#9b967b","#a09761","#a49744","#a79720","#a99700","#aa9700","#ab9700","#ac9600","#ac9600","#ac9600","#ac9600","#ac9600","#ac9600","#ac9600","#aeaeae","#b6b194","#bab179","#beb25e","#c1b23f","#c4b205","#c6b200","#c7b200","#c8b200","#c8b200","#c8b200","#c8b200","#c8b200","#c8b200","#c8b200","#c8c8c8","#d1ccac","#d5cc92","#d9cd76","#dccd58","#dfcd33","#e2cd00","#e3cd00","#e4cd00","#e5cd00","#e6cd00","#e6cd00","#e6cd00","#e6cd00","#e6cd00","#e3e3e3","#ece7c5","#f1e8a9","#f5e88d","#f8e96f","#fbe94e","#fee915","#ffe900","#ffe800","#ffe800","#ffe800","#ffe800","#ffe800","#ffe800","#ffe800","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#1f1e0d","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#201f00","#313131","#343322","#353406","#363400","#363400","#363400","#363400","#363400","#363400","#363400","#363400","#363400","#363400","#363400","#363400","#484848","#4b4a35","#4d4b1e","#4e4b00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#4f4c00","#616161","#64634b","#666431","#686513","#686500","#696500","#696500","#696500","#696500","#696500","#696500","#696500","#696500","#696500","#696500","#7a7a7a","#7e7d63","#807e49","#827f2b","#837f00","#847f00","#848000","#858000","#858000","#858000","#858000","#858000","#858000","#858000","#858000","#949494","#98977b","#9b9862","#9d9945","#9e9a20","#9f9a00","#a09a00","#a19a00","#a19a00","#a19a00","#a19a00","#a19a00","#a19a00","#a19a00","#a19a00","#aeaeae","#b3b294","#b6b37a","#b8b45f","#b9b43f","#bbb500","#bcb500","#bcb600","#bcb600","#bcb600","#bcb600","#bcb600","#bcb600","#bcb600","#bcb600","#c8c8c8","#ceccac","#d1ce92","#d3cf76","#d5cf58","#d6d032","#d7d100","#d8d100","#d9d100","#d9d100","#d9d100","#d9d100","#d9d100","#d9d100","#d9d100","#e3e3e3","#eae8c5","#ece9a9","#efea8d","#f1eb6e","#f2ec4d","#f3ec0f","#f4ed00","#f5ed00","#f5ee00","#f6ee00","#f6ee00","#f6ee00","#f6ee00","#f6ee00","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#1c1f10","#192100","#192100","#192100","#192100","#192100","#192100","#192100","#192100","#192100","#192100","#192100","#192100","#192100","#313131","#313424","#2f350d","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#2d3700","#484848","#484b37","#474c21","#454e00","#434f00","#434f00","#434f00","#434f00","#434f00","#434f00","#434f00","#434f00","#434f00","#434f00","#434f00","#616161","#60644d","#606634","#5e6719","#5d6800","#5c6900","#5a6900","#5a6900","#5a6900","#5a6900","#5a6900","#5a6900","#5a6900","#5a6900","#5a6900","#7a7a7a","#7a7e65","#7a804d","#798131","#788204","#778300","#768400","#748400","#748400","#748400","#748400","#748400","#748400","#748400","#748400","#949494","#95987c","#949a64","#939c49","#929d26","#919e00","#919f00","#909f00","#909f00","#909f00","#909f00","#909f00","#909f00","#909f00","#909f00","#aeaeae","#b0b295","#afb57c","#aeb663","#adb844","#acb911","#acba00","#abba00","#abbb00","#aabb00","#aabb00","#aabb00","#aabb00","#aabb00","#aabb00","#c8c8c8","#cbcdad","#cacf94","#cad17a","#c9d35d","#c8d438","#c7d500","#c6d600","#c6d700","#c5d700","#c5d700","#c5d700","#c5d700","#c5d700","#c5d700","#e3e3e3","#e7e9c6","#e6ebaa","#e6ed8f","#e5ef71","#e4f051","#e3f117","#e2f200","#e1f300","#e1f400","#e1f400","#e1f400","#e1f400","#e1f400","#e1f400","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#1a1f12","#112200","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#0a2300","#313131","#2f3426","#2a3614","#233800","#1c3a00","#133c00","#133c00","#133c00","#133c00","#133c00","#133c00","#133c00","#133c00","#133c00","#133c00","#484848","#454b39","#404e26","#3c500c","#375100","#315300","#2b5400","#2b5400","#2b5400","#2b5400","#2b5400","#2b5400","#2b5400","#2b5400","#2b5400","#616161","#5e654f","#596739","#556922","#506b00","#4c6c00","#4a6d00","#466e00","#466e00","#466e00","#466e00","#466e00","#466e00","#466e00","#466e00","#7a7a7a","#777e67","#748152","#6f8439","#6a8519","#678700","#638800","#618900","#5e8a00","#5e8a00","#5e8a00","#5e8a00","#5e8a00","#5e8a00","#5e8a00","#949494","#91997e","#8e9b68","#8a9e51","#85a033","#81a200","#7da300","#7ba400","#7aa400","#79a500","#79a500","#79a500","#79a500","#79a500","#79a500","#aeaeae","#acb397","#a8b680","#a5b969","#a1bb4f","#9cbd29","#98be00","#95c000","#93c000","#92c100","#90c100","#90c100","#90c100","#90c100","#90c100","#c8c8c8","#c8ceaf","#c5d197","#c1d37f","#bcd665","#b8d846","#b4da08","#b1db00","#aedc00","#acdd00","#abdd00","#aade00","#aade00","#aade00","#aade00","#e3e3e3","#e3eac7","#e0edad","#dcef93","#d8f277","#d5f459","#d0f62d","#cdf700","#c9f900","#c7fa00","#c6fa00","#c4fb00","#c4fb00","#c4fb00","#c4fb00","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#172015","#072304","#002500","#002700","#002700","#002700","#002700","#002700","#002700","#002700","#002700","#002700","#002700","#002700","#313131","#2c3429","#23371b","#163a09","#003c00","#003e00","#004000","#004100","#004100","#004100","#004100","#004100","#004100","#004100","#004100","#484848","#414c3d","#384f2d","#2e521c","#215400","#065600","#005800","#005a00","#005a00","#005a00","#005a00","#005a00","#005a00","#005a00","#005a00","#616161","#596553","#506941","#466c2f","#3a6e15","#2c7100","#177300","#007400","#007600","#007800","#007800","#007800","#007800","#007800","#007800","#7a7a7a","#737f6b","#6a835a","#618646","#568931","#4b8b0e","#3d8d00","#2f8f00","#209000","#069100","#009300","#009300","#009300","#009300","#009300","#949494","#8c9a82","#849d70","#7ba15d","#71a447","#66a62d","#5ba900","#4fab00","#45ac00","#3cad00","#33ae00","#27af00","#27af00","#27af00","#27af00","#aeaeae","#a6b59b","#9eb889","#96bc76","#8cbf61","#82c248","#77c428","#6cc600","#63c800","#5ac900","#54ca00","#4ccb00","#45cc00","#45cc00","#45cc00","#c8c8c8","#c1d0b4","#b8d4a0","#afd78c","#a7da77","#9ddd5f","#93e042","#88e20a","#7ee400","#74e600","#6ee700","#65e800","#5ee900","#57ea00","#4eeb00","#e3e3e3","#dcebcc","#d3f0b7","#c9f3a0","#c0f78a","#b6fa71","#adfd55","#a2ff30","#97ff00","#8dff00","#84ff00","#7aff00","#7aff00","#7aff00","#7aff00","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#152017","#00230c","#002602","#002900","#002900","#002900","#002900","#002900","#002900","#002900","#002900","#002900","#002900","#002900","#313131","#2a352b","#1c3821","#063b16","#003d09","#003f00","#004100","#004300","#004300","#004300","#004300","#004300","#004300","#004300","#004300","#484848","#3f4d3f","#315033","#215327","#005619","#005806","#005a00","#005c00","#005c00","#005c00","#005c00","#005c00","#005c00","#005c00","#005c00","#616161","#576656","#496a48","#396d3a","#23702a","#007317","#007600","#007800","#007900","#007b00","#007b00","#007b00","#007b00","#007b00","#007b00","#7a7a7a","#6f806e","#638461","#558852","#438b42","#2b8e31","#009119","#009300","#009500","#009700","#009900","#009900","#009900","#009900","#009900","#949494","#889b86","#7c9f78","#6ea369","#5ea659","#4ba949","#30ac36","#00af1a","#00b100","#00b400","#00b600","#00b700","#00b700","#00b700","#00b700","#aeaeae","#a2b59f","#95ba90","#89bd82","#7ac172","#69c561","#53c84f","#35cb3a","#00ce1b","#00d000","#00d200","#00d400","#00d600","#00d600","#00d600","#c8c8c8","#bcd1b8","#afd5a8","#a1d998","#93dd89","#82e178","#6fe465","#57e751","#32ea39","#00ed0c","#00ef00","#00f200","#00f200","#00f200","#00f200","#e3e3e3","#d6edd1","#c8f1c0","#b8f6ad","#aafa9d","#99fe8b","#87ff79","#71ff65","#52ff4d","#19ff2e","#00ff00","#00ff00","#00ff00","#00ff00","#00ff00","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#132019","#002412","#00270c","#002a07","#002a07","#002a07","#002a07","#002a07","#002a07","#002a07","#002a07","#002a07","#002a07","#002a07","#313131","#28352d","#163927","#003c21","#003e1c","#004016","#004211","#00440e","#00440e","#00440e","#00440e","#00440e","#00440e","#00440e","#00440e","#484848","#3c4d42","#2a513a","#085434","#00572e","#005928","#005c22","#005d1d","#005d1d","#005d1d","#005d1d","#005d1d","#005d1d","#005d1d","#005d1d","#616161","#536659","#416b51","#256f48","#007241","#007539","#007832","#007a2c","#007c27","#007d22","#007d22","#007d22","#007d22","#007d22","#007d22","#7a7a7a","#6c8172","#5b8569","#468960","#238d57","#00904f","#009347","#00963f","#009838","#009b31","#009d2b","#009d2b","#009d2b","#009d2b","#009d2b","#949494","#849b8a","#73a081","#5fa477","#46a86e","#18ab65","#00af5c","#00b253","#00b44b","#00b743","#00b93b","#00bc34","#00bc34","#00bc34","#00bc34","#aeaeae","#9eb6a4","#8dbb9a","#7bbf90","#64c385","#45c77b","#00cb72","#00ce68","#00d15f","#00d356","#00d64d","#00d944","#00db3c","#00db3c","#00db3c","#c8c8c8","#b7d1bd","#a6d6b2","#92dba7","#7ddf9d","#63e392","#38e787","#00ea7e","#00ee73","#00f168","#00f35e","#00f655","#00f84c","#00fa45","#00fd3c","#e3e3e3","#d1edd7","#bff3cb","#a8f8bd","#92fdb2","#78ffa7","#57ff9c","#00ff91","#00ff85","#00ff78","#00ff78","#00ff78","#00ff78","#00ff78","#00ff78","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#12201a","#002416","#002713","#002a11","#002b10","#002b10","#002b10","#002b10","#002b10","#002b10","#002b10","#002b10","#002b10","#002b10","#313131","#27352e","#12392a","#003c27","#003e24","#004022","#004220","#00441f","#00451e","#00471e","#00471e","#00471e","#00471e","#00471e","#00471e","#484848","#3b4d44","#25513f","#00553a","#005737","#005a34","#005c32","#005e31","#005f2f","#00602e","#00622e","#00632d","#00642c","#00642c","#00642c","#616161","#52675c","#3c6b56","#196f50","#00734c","#007649","#007946","#007b43","#007c42","#007e40","#007f3f","#00803e","#00823e","#00833d","#00843c","#7a7a7a","#6a8175","#56856e","#3c8a69","#008e64","#00915f","#00945b","#009759","#009956","#009b54","#009d52","#009f51","#00a050","#00a24f","#00a34e","#949494","#829b8e","#6da187","#56a581","#33a97c","#00ac77","#00b073","#00b36f","#00b56c","#00b869","#00ba67","#00bc65","#00be63","#00c061","#00c260","#aeaeae","#9cb6a7","#88bba0","#72c09a","#55c494","#1dc88f","#00cc8a","#00cf85","#00d282","#00d57f","#00d87c","#00da79","#00dc77","#00de76","#00e074","#c8c8c8","#b5d2c1","#a1d7ba","#88dcb2","#6de0ac","#45e4a6","#00e8a1","#00ec9c","#00ef98","#00f294","#00f591","#00f88e","#00fa8c","#00fa8c","#00fa8c","#e3e3e3","#cfeddb","#b9f3d3","#9df9cb","#80fec4","#5bffbe","#00ffb8","#00ffb3","#00ffae","#00ffae","#00ffae","#00ffae","#00ffae","#00ffae","#00ffae","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#11201b","#002419","#002718","#002a17","#002b17","#002b17","#002b17","#002b17","#002b17","#002b17","#002b17","#002b17","#002b17","#002b17","#313131","#263530","#0e392d","#003c2b","#003e2a","#004029","#004228","#004428","#004528","#004728","#004728","#004728","#004728","#004728","#004728","#484848","#3a4d46","#215142","#005540","#00573e","#005a3d","#005c3c","#005e3b","#005f3b","#00613a","#00623a","#00633a","#00643a","#00643a","#00643a","#616161","#51675e","#396b5a","#096f57","#007354","#007652","#007951","#007b50","#007c4f","#007e4e","#007f4e","#00804d","#00824d","#00834d","#00844d","#7a7a7a","#698177","#538672","#368a6f","#008e6c","#009169","#009567","#009766","#009964","#009c63","#009d62","#009f61","#00a061","#00a260","#00a360","#949494","#819b90","#6aa18b","#50a588","#25a984","#00ac81","#00b07e","#00b37c","#00b67a","#00b879","#00bb77","#00bd76","#00bf75","#00c074","#00c273","#aeaeae","#9ab6aa","#85bba5","#6dc0a1","#4cc49d","#00c899","#00cc96","#00d093","#00d391","#00d58f","#00d88d","#00da8c","#00dc8a","#00de8a","#00e088","#c8c8c8","#b3d2c4","#9ed7be","#83dcb9","#65e0b5","#32e5b1","#00e9ae","#00ecab","#00efa8","#00f3a5","#00f5a3","#00f8a2","#00fba0","#00fba0","#00fba0","#e3e3e3","#cdeede","#b5f4d8","#97f9d2","#76fecd","#4affc9","#00ffc5","#00ffc2","#00ffc2","#00ffc2","#00ffc2","#00ffc2","#00ffc2","#00ffc2","#00ffc2","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#10201c","#00241c","#00271c","#002a1e","#002c20","#002c20","#002c20","#002c20","#002c20","#002c20","#002c20","#002c20","#002c20","#002c20","#313131","#253531","#083930","#003c30","#003e30","#004130","#004330","#004431","#004532","#004733","#004733","#004733","#004733","#004733","#004733","#484848","#384d47","#1c5246","#005545","#005845","#005a44","#005c45","#005e45","#006045","#006146","#006246","#006347","#006548","#006548","#006548","#616161","#4f675f","#356b5e","#006f5c","#00735b","#00765b","#00795b","#007b5a","#007c5b","#007e5b","#00805b","#00815b","#00825c","#00835c","#00845d","#7a7a7a","#688179","#508677","#308a75","#008e73","#009172","#009571","#009771","#009a71","#009c71","#009d71","#009f71","#00a171","#00a271","#00a371","#949494","#809b92","#67a190","#4ba58e","#10a98c","#00ad8a","#00b089","#00b388","#00b687","#00b887","#00bb86","#00bd86","#00bf86","#00c086","#00c286","#aeaeae","#99b6ac","#83bba9","#68c0a7","#42c4a5","#00c8a3","#00cca1","#00d0a0","#00d39f","#00d59e","#00d89e","#00db9d","#00dc9d","#00de9c","#00e09c","#c8c8c8","#b3d2c6","#9bd7c3","#7fdcc0","#5ee0be","#1ae5bc","#00e9ba","#00ecb9","#00f0b7","#00f3b6","#00f6b5","#00f8b5","#00fcb4","#00fcb4","#00fcb4","#e3e3e3","#cceee1","#b3f4dd","#93f9da","#6dfed7","#37ffd5","#00ffd3","#00ffd2","#00ffd2","#00ffd2","#00ffd2","#00ffd2","#00ffd2","#00ffd2","#00ffd2","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#0e201e","#002420","#002723","#002a25","#002c28","#002c28","#002c28","#002c28","#002c28","#002c28","#002c28","#002c28","#002c28","#002c28","#313131","#243533","#043934","#003c35","#003e37","#004138","#00433a","#00443b","#00463d","#00463d","#00463d","#00463d","#00463d","#00463d","#00463d","#484848","#384d49","#18524a","#00554b","#00584c","#005a4e","#005c4f","#005e51","#006052","#006153","#006254","#006355","#006355","#006355","#006355","#616161","#4e6762","#326b62","#006f63","#007364","#007665","#007967","#007b68","#007d69","#007e6a","#00806b","#00816c","#00826d","#00836e","#00836e","#7a7a7a","#67817b","#4e867b","#2b8a7b","#008e7b","#00917c","#00957e","#00977f","#009a80","#009c82","#009e83","#009f84","#00a185","#00a286","#00a386","#949494","#7f9b94","#65a194","#47a594","#00a994","#00ad95","#00b095","#00b396","#00b697","#00b998","#00bb99","#00bd9b","#00bf9c","#00c19d","#00c29d","#aeaeae","#99b6ae","#81bbad","#65c0ad","#38c4ad","#00c8ad","#00ccad","#00d0ae","#00d2af","#00d5b0","#00d8b1","#00dab1","#00dcb2","#00deb3","#00deb3","#c8c8c8","#b2d1c8","#99d7c7","#7ddcc6","#57e0c6","#00e5c6","#00e9c6","#00ecc6","#00efc7","#00f3c8","#00f6c8","#00f6c8","#00f6c8","#00f6c8","#00f6c8","#e3e3e3","#cbede3","#b1f3e2","#8ff9e1","#66fee0","#19ffdf","#00ffdf","#00ffdf","#00ffdf","#00ffdf","#00ffdf","#00ffdf","#00ffdf","#00ffdf","#00ffdf","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#0c2020","#002425","#00272a","#002a2f","#002a2f","#002a2f","#002a2f","#002a2f","#002a2f","#002a2f","#002a2f","#002a2f","#002a2f","#002a2f","#313131","#233535","#003938","#003c3c","#003e40","#004143","#004346","#004449","#00464c","#00464c","#00464c","#00464c","#00464c","#00464c","#00464c","#484848","#364d4c","#13514f","#005553","#005756","#005a5a","#005c5d","#005e60","#006062","#006165","#006367","#006367","#006367","#006367","#006367","#616161","#4e6764","#306b67","#006f6b","#00736e","#007672","#007875","#007b78","#007d7b","#007e7d","#008080","#008182","#008283","#008283","#008283","#7a7a7a","#66817e","#4c8580","#248983","#008d86","#00918a","#00948d","#00978f","#009a93","#009c96","#009e98","#00a09a","#00a19c","#00a29e","#00a29e","#949494","#7f9b97","#64a099","#41a59c","#00a99f","#00aca1","#00b0a4","#00b3a7","#00b6aa","#00b8ac","#00bbaf","#00bdb2","#00bfb4","#00c1b6","#00c1b6","#aeaeae","#98b6b1","#7fbbb3","#62c0b5","#2cc4b7","#00c8ba","#00ccbc","#00cfbe","#00d2c1","#00d5c4","#00d8c6","#00dbc9","#00ddcc","#00ddcc","#00ddcc","#c8c8c8","#b2d1cb","#98d7cc","#7adcce","#4de0d0","#00e4d2","#00e8d4","#00ecd6","#00efd8","#00f3db","#00f3db","#00f3db","#00f3db","#00f3db","#00f3db","#e3e3e3","#cbede6","#aff3e7","#8cf9e8","#5cfeea","#00ffec","#00ffee","#00ffee","#00ffee","#00ffee","#00ffee","#00ffee","#00ffee","#00ffee","#00ffee","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#0b2022","#002429","#00272f","#002a37","#002a37","#002a37","#002a37","#002a37","#002a37","#002a37","#002a37","#002a37","#002a37","#002a37","#313131","#223536","#00393c","#003b41","#003e47","#00414b","#00434f","#004453","#004453","#004453","#004453","#004453","#004453","#004453","#004453","#484848","#364d4e","#0f5154","#005459","#00575e","#005a63","#005c67","#005e6b","#00606e","#006272","#006272","#006272","#006272","#006272","#006272","#616161","#4d6667","#2f6b6c","#006f71","#007277","#00757c","#007881","#007b86","#007d8a","#007e8d","#008090","#008193","#008193","#008193","#008193","#7a7a7a","#668180","#4c8585","#1d8989","#008d8f","#009194","#00949a","#00969e","#0099a3","#009ca7","#009eab","#00a0ae","#00a1b1","#00a1b1","#00a1b1","#949494","#7f9b9a","#63a09e","#3ea4a3","#00a8a8","#00acac","#00afb1","#00b2b5","#00b5ba","#00b8be","#00bbc2","#00bdc7","#00c0ca","#00c0ca","#00c0ca","#aeaeae","#98b6b4","#7ebbb8","#60bfbc","#25c3c0","#00c8c5","#00cbc9","#00cfce","#00d2d2","#00d5d6","#00d7da","#00dadf","#00dadf","#00dadf","#00dadf","#c8c8c8","#b2d1ce","#98d6d2","#76dbd7","#47e0db","#00e4df","#00e8e3","#00ebe7","#00efeb","#00f2f0","#00f2f0","#00f2f0","#00f2f0","#00f2f0","#00f2f0","#e3e3e3","#ccedea","#aef3ed","#89f9f2","#52fef6","#00fffa","#00fffe","#00fffe","#00fffe","#00fffe","#00fffe","#00fffe","#00fffe","#00fffe","#00fffe","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#0a2024","#00232d","#002635","#00293e","#00293e","#00293e","#00293e","#00293e","#00293e","#00293e","#00293e","#00293e","#00293e","#00293e","#313131","#223538","#003840","#003b47","#003e4f","#004057","#00425e","#004463","#004463","#004463","#004463","#004463","#004463","#004463","#004463","#484848","#354d50","#0e5158","#005460","#005667","#00596e","#005c75","#005e7b","#006080","#006183","#006183","#006183","#006183","#006183","#006183","#616161","#4d6669","#2f6a70","#006e78","#007180","#007488","#00778f","#007a96","#007c9b","#007ea0","#0080a5","#0081a9","#0081a9","#0081a9","#0081a9","#7a7a7a","#668082","#4c8489","#1c8891","#008c99","#008fa0","#0093a8","#0095ae","#0098b5","#009bbc","#009ec2","#00a0c6","#00a1ca","#00a1ca","#00a1ca","#949494","#7f9b9c","#659fa3","#3ea3aa","#00a7b1","#00abb8","#00aec0","#00b1c6","#00b4cd","#00b7d4","#00bada","#00bde1","#00c0e7","#00c0e7","#00c0e7","#aeaeae","#99b5b6","#7fbabd","#61bec3","#21c2ca","#00c6d2","#00cad9","#00cde0","#00d1e7","#00d4ed","#00d7f2","#00d9f9","#00d9f9","#00d9f9","#00d9f9","#c8c8c8","#b3d0d0","#98d6d7","#77dade","#44dfe4","#00e3eb","#00e7f2","#00ebf8","#00efff","#00f2ff","#00f2ff","#00f2ff","#00f2ff","#00f2ff","#00f2ff","#e3e3e3","#cdecec","#aff2f3","#89f8fa","#51fdff","#00ffff","#00ffff","#00ffff","#00ffff","#00ffff","#00ffff","#00ffff","#00ffff","#00ffff","#00ffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#0a2026","#002330","#002539","#002844","#002844","#002844","#002844","#002844","#002844","#002844","#002844","#002844","#002844","#002844","#313131","#22353a","#003843","#003a4d","#003d56","#004060","#004268","#004268","#004268","#004268","#004268","#004268","#004268","#004268","#004268","#484848","#364d52","#10505c","#005366","#00566f","#005878","#005b81","#005d89","#005f8f","#005f8f","#005f8f","#005f8f","#005f8f","#005f8f","#005f8f","#616161","#4e666a","#316a74","#006d7e","#007088","#007392","#00769b","#0079a4","#007baa","#007db3","#007db3","#007db3","#007db3","#007db3","#007db3","#7a7a7a","#688084","#4e848d","#228797","#008ba0","#008eaa","#0091b4","#0094bd","#0097c6","#009acf","#009dd8","#009dd8","#009dd8","#009dd8","#009dd8","#949494","#819a9e","#689ea7","#42a2b1","#00a6ba","#00a9c3","#00adcd","#00b0d6","#00b3e0","#00b6e8","#00b9f1","#00b9f1","#00b9f1","#00b9f1","#00b9f1","#aeaeae","#9bb5b8","#81b9c1","#63bdca","#2bc1d3","#00c5dd","#00c9e7","#00ccf0","#00d0fb","#00d2ff","#00d2ff","#00d2ff","#00d2ff","#00d2ff","#00d2ff","#c8c8c8","#b6d0d2","#9ad5db","#79d9e4","#47ddee","#00e2f8","#00e6ff","#00e9ff","#00edff","#00edff","#00edff","#00edff","#00edff","#00edff","#00edff","#e3e3e3","#d0ebee","#b0f1f8","#8af7ff","#54fbff","#54fbff","#54fbff","#54fbff","#54fbff","#54fbff","#54fbff","#54fbff","#54fbff","#54fbff","#54fbff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#0b2027","#002232","#00243d","#002648","#002857","#002857","#002857","#002857","#002857","#002857","#002857","#002857","#002857","#002857","#313131","#22353b","#003746","#003952","#003c5e","#003e69","#004073","#004073","#004073","#004073","#004073","#004073","#004073","#004073","#004073","#484848","#364c54","#164f60","#00526b","#005476","#005682","#00598d","#005b98","#005da1","#005da1","#005da1","#005da1","#005da1","#005da1","#005da1","#616161","#4f656c","#366978","#006b83","#006e8f","#00709b","#0073a6","#0076b2","#0078be","#007ac9","#007ac9","#007ac9","#007ac9","#007ac9","#007ac9","#7a7a7a","#697f85","#528390","#2e869c","#0088a8","#008bb4","#008ec0","#0091cc","#0094d9","#0096e5","#0099f0","#0099f0","#0099f0","#0099f0","#0099f0","#949494","#83999f","#6c9daa","#4ca1b6","#00a4c2","#00a6ce","#00a9da","#00ace6","#00aff3","#00b2ff","#00b5ff","#00b5ff","#00b5ff","#00b5ff","#00b5ff","#aeaeae","#9eb4b9","#86b8c5","#69bcd0","#3ebfdc","#00c2e9","#00c6f7","#00c8ff","#00ccff","#00ccff","#00ccff","#00ccff","#00ccff","#00ccff","#00ccff","#c8c8c8","#b9cfd4","#9fd3e0","#81d7ec","#52dbf9","#00dfff","#00e3ff","#00e3ff","#00e3ff","#00e3ff","#00e3ff","#00e3ff","#00e3ff","#00e3ff","#00e3ff","#e3e3e3","#d3eaef","#b5f0fd","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#93f4ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#0d1f29","#002134","#00223f","#00244b","#002659","#002659","#002659","#002659","#002659","#002659","#002659","#002659","#002659","#002659","#313131","#23343d","#063649","#003855","#003a62","#003c6e","#003e78","#004084","#004084","#004084","#004084","#004084","#004084","#004084","#004084","#484848","#384c56","#1e4e62","#00506e","#00527b","#005487","#005693","#0058a0","#005aaa","#005aaa","#005aaa","#005aaa","#005aaa","#005aaa","#005aaa","#616161","#52656d","#3c677a","#1a6986","#006c93","#006da0","#0070ac","#0072b9","#0075c7","#0076d1","#0076d1","#0076d1","#0076d1","#0076d1","#0076d1","#7a7a7a","#6c7e87","#588193","#3c84a0","#0086ac","#0088b9","#008bc7","#008dd4","#008fe2","#0092f0","#0094fb","#0094fb","#0094fb","#0094fb","#0094fb","#949494","#8699a0","#729cac","#589eba","#30a1c7","#00a3d4","#00a6e2","#00a8f0","#00abff","#00aeff","#00b0ff","#00b0ff","#00b0ff","#00b0ff","#00b0ff","#aeaeae","#a0b3ba","#8bb7c7","#73bad3","#50bce1","#00bff0","#00c2ff","#00c5ff","#00c5ff","#00c5ff","#00c5ff","#00c5ff","#00c5ff","#00c5ff","#00c5ff","#c8c8c8","#bcced4","#a4d2e2","#8ad5f0","#62d9ff","#00dcff","#00dcff","#00dcff","#00dcff","#00dcff","#00dcff","#00dcff","#00dcff","#00dcff","#00dcff","#e3e3e3","#d6e9f0","#baeeff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#9af3ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#1d1d1d","#0f1f2a","#002035","#002140","#00224d","#00245a","#00245a","#00245a","#00245a","#00245a","#00245a","#00245a","#00245a","#00245a","#313131","#26343e","#10354b","#003757","#003865","#003a71","#003b7d","#003c8a","#003c8a","#003c8a","#003c8a","#003c8a","#003c8a","#003c8a","#003c8a","#484848","#3b4b57","#274d64","#004e71","#00507d","#00518a","#005397","#0055a4","#0056af","#0056af","#0056af","#0056af","#0056af","#0056af","#0056af","#616161","#54646e","#43667c","#2b6888","#006996","#006ba2","#006daf","#006ebd","#0070cb","#0072d8","#0072d8","#0072d8","#0072d8","#0072d8","#0072d8","#7a7a7a","#6e7e88","#5e8095","#4982a2","#2584af","#0085bd","#0087cb","#0089d8","#008be7","#008df4","#008fff","#008fff","#008fff","#008fff","#008fff","#949494","#8998a1","#799aae","#649cbc","#489eca","#06a0d7","#00a2e7","#00a4f6","#00a7ff","#00a9ff","#00abff","#00abff","#00abff","#00abff","#00abff","#aeaeae","#a3b2bb","#92b5c8","#7eb7d6","#65b9e5","#37bcf5","#00beff","#00c0ff","#00c0ff","#00c0ff","#00c0ff","#00c0ff","#00c0ff","#00c0ff","#00c0ff","#c8c8c8","#becdd5","#acd0e4","#96d3f3","#76d6ff","#47d8ff","#47d8ff","#47d8ff","#47d8ff","#47d8ff","#47d8ff","#47d8ff","#47d8ff","#47d8ff","#47d8ff","#e3e3e3","#d9e9f0","#c1ecff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#a6f0ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#131e2b","#011f36","#001f42","#001f4e","#00205b","#00205b","#00205b","#00205b","#00205b","#00205b","#00205b","#00205b","#00205b","#00205b","#313131","#28333f","#1a344c","#003459","#003566","#003673","#003680","#00378f","#00378f","#00378f","#00378f","#00378f","#00378f","#00378f","#00378f","#484848","#3e4a58","#304b65","#194c72","#004d7f","#004d8c","#004e9a","#004fa7","#0050b4","#0050b4","#0050b4","#0050b4","#0050b4","#0050b4","#0050b4","#616161","#58636f","#4b647d","#3b658a","#1e6698","#0067a4","#0068b1","#0069c0","#0069ce","#006adc","#006adc","#006adc","#006adc","#006adc","#006adc","#7a7a7a","#727d88","#657e96","#567fa4","#4280b1","#1e81bf","#0082cd","#0083db","#0084eb","#0086fa","#0087ff","#0087ff","#0087ff","#0087ff","#0087ff","#949494","#8c97a1","#8098af","#719abd","#5f9bcc","#469cda","#009dea","#009ffa","#00a0ff","#00a1ff","#00a1ff","#00a1ff","#00a1ff","#00a1ff","#00a1ff","#aeaeae","#a7b1bb","#9ab3ca","#8bb4d8","#79b6e7","#5fb7f8","#33b9ff","#00baff","#00baff","#00baff","#00baff","#00baff","#00baff","#00baff","#00baff","#c8c8c8","#c2ccd5","#b4cee5","#a2d0f5","#8dd2ff","#6fd4ff","#6fd4ff","#6fd4ff","#6fd4ff","#6fd4ff","#6fd4ff","#6fd4ff","#6fd4ff","#6fd4ff","#6fd4ff","#e3e3e3","#dde7f0","#cbeaff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#b7ecff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#161d2b","#0c1d36","#001d42","#001c4e","#001b5b","#001967","#001770","#00147b","#001183","#000d8d","#000895","#00029e","#0000a7","#0000b0","#313131","#2c3240","#22324c","#12325a","#003267","#003174","#003180","#002f8e","#002d9c","#002ca8","#002ab0","#0028ba","#0025c6","#0023cf","#0021d4","#484848","#414958","#384966","#2b4a73","#164a80","#004a8d","#00499b","#0049a8","#0048b6","#0047c4","#0046d0","#0044dc","#0043ea","#0041f3","#003ffe","#616161","#5b6270","#53627d","#48638b","#386399","#2163a6","#0063b2","#0063c0","#0063cf","#0063de","#0062ef","#0061fd","#005fff","#005eff","#005dff","#7a7a7a","#757c89","#6d7c96","#627da4","#557db2","#447dc0","#277ece","#007edc","#007eec","#007efc","#007eff","#007eff","#007dff","#007dff","#007dff","#949494","#8f96a2","#8797af","#7c97bf","#7197cd","#6198db","#4999eb","#1a99fc","#009aff","#009aff","#009aff","#009aff","#009aff","#009aff","#009aff","#aeaeae","#a9b0bb","#a0b1ca","#96b2d9","#89b2e8","#79b3f9","#5fb4ff","#3fb4ff","#3fb4ff","#3fb4ff","#3fb4ff","#3fb4ff","#3fb4ff","#3fb4ff","#3fb4ff","#c8c8c8","#c4cbd5","#bacce5","#aecdf7","#9eceff","#8dceff","#8dceff","#8dceff","#8dceff","#8dceff","#8dceff","#8dceff","#8dceff","#8dceff","#8dceff","#e3e3e3","#e0e7f0","#d4e7ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#c5e9ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#1b1c2c","#191a36","#171841","#17144c","#190f54","#1c075d","#200065","#25006e","#280075","#2c007d","#300085","#34008d","#390097","#3e00a1","#313131","#303140","#2d304d","#2a2e59","#262c65","#252970","#25257a","#271f84","#2a188d","#2d0b97","#31009f","#3500a9","#3800b1","#3c00b9","#4000c1","#484848","#464859","#424766","#3f4573","#3b447f","#37428c","#343f97","#323ba4","#3236b0","#3431b9","#362bc2","#3921cd","#3c12d7","#3f00e0","#4200e8","#616161","#5f6170","#5c607d","#585f8a","#535e98","#4e5ca5","#495bb1","#4458bd","#4155ca","#3f51d7","#3e4ce5","#3e47ef","#3f41fa","#4139ff","#4231ff","#7a7a7a","#787b89","#757a96","#7079a4","#6c78b2","#6777be","#6275cc","#5b74da","#5472e8","#4e6ff7","#496bff","#4667ff","#4361ff","#3a5cff","#3a5cff","#949494","#9395a2","#8f94af","#8a93be","#8693cb","#8192d9","#7a90e9","#728ff9","#668dff","#608bff","#5888ff","#5888ff","#5888ff","#5888ff","#5888ff","#aeaeae","#adafbb","#a8afca","#a4aed9","#9eade9","#98acf9","#91abff","#89aaff","#89aaff","#89aaff","#89aaff","#89aaff","#89aaff","#89aaff","#89aaff","#c8c8c8","#c8cad5","#c2cae5","#bcc9f6","#b5c8ff","#aec7ff","#aec7ff","#aec7ff","#aec7ff","#aec7ff","#aec7ff","#aec7ff","#aec7ff","#aec7ff","#aec7ff","#e3e3e3","#e3e6f0","#dde5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#d6e5ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#1f1b2c","#211835","#23143f","#260f47","#29084f","#2d0057","#31005f","#350067","#39006e","#3e0076","#42007e","#470086","#4d0091","#53009b","#313131","#333040","#352d4b","#362b55","#382760","#3b226a","#3e1c73","#41137c","#450485","#4a008e","#4e0097","#5300a0","#5700a8","#5c00b1","#6100ba","#484848","#4a4758","#4b4465","#4c4271","#4d3f7c","#4f3b87","#513791","#54319c","#582aa6","#5c21af","#6013b8","#6400c1","#6800cb","#6c00d4","#7100dd","#616161","#626070","#635e7c","#635c89","#645995","#6556a0","#6653ac","#684fb7","#6b4ac2","#6e45cc","#713dd8","#7436e0","#782cea","#7d1bf5","#8000fe","#7a7a7a","#7c7a88","#7c7895","#7c76a3","#7c74af","#7d71bb","#7d6ec7","#7e6bd4","#7f67e0","#8163eb","#845ef7","#8757ff","#8a50ff","#8e45ff","#8e45ff","#949494","#9594a1","#9593ae","#9591bc","#958fc9","#958cd6","#958ae4","#9586f2","#9682ff","#977fff","#987aff","#987aff","#987aff","#987aff","#987aff","#aeaeae","#afafbb","#afadc9","#aeabd7","#aea9e6","#ada7f5","#aea4ff","#afa0ff","#afa0ff","#afa0ff","#afa0ff","#afa0ff","#afa0ff","#afa0ff","#afa0ff","#c8c8c8","#cacad4","#c9c8e4","#c8c6f4","#c8c3ff","#c8c0ff","#c8c0ff","#c8c0ff","#c8c0ff","#c8c0ff","#c8c0ff","#c8c0ff","#c8c0ff","#c8c0ff","#c8c0ff","#e3e3e3","#e6e5ef","#e4e3ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#e0e2ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#221a2b","#261633","#2a113b","#2f0a43","#33014a","#380052","#3c0059","#410061","#450067","#4a006e","#4f0076","#55007e","#5c0089","#620092","#313131","#362f3f","#3a2c49","#3e2851","#43235b","#471c64","#4c136d","#510375","#55007d","#5b0085","#60008e","#650096","#6b00a0","#7100a9","#7800b3","#484848","#4d4657","#514263","#553f6d","#593b77","#5e3581","#632f8a","#682794","#6d1c9d","#7108a5","#7600ad","#7c00b6","#8100c0","#8600c8","#8c00d2","#616161","#655f6f","#695c7b","#6c5985","#705690","#74519a","#794da4","#7d47ae","#8240b8","#8738c1","#8c2dcc","#9121d3","#9605dc","#9b00e6","#a000ef","#7a7a7a","#7e7987","#817793","#84749f","#8870ab","#8c6db5","#9068c0","#9564ca","#995ed5","#9e59de","#a351e9","#a848f4","#ad3dfe","#b32eff","#b32eff","#949494","#9893a1","#9b91ac","#9e8eb9","#a18bc5","#a588d1","#a984dc","#ad7fe8","#b379f4","#b775fe","#bd6dff","#bd6dff","#bd6dff","#bd6dff","#bd6dff","#aeaeae","#b2aeba","#b5acc7","#b7a9d4","#bba6e1","#bea2ee","#c39efc","#c899ff","#c899ff","#c899ff","#c899ff","#c899ff","#c899ff","#c899ff","#c899ff","#c8c8c8","#ccc9d4","#cfc6e2","#d2c4f0","#d5c0ff","#dbbbff","#dbbbff","#dbbbff","#dbbbff","#dbbbff","#dbbbff","#dbbbff","#dbbbff","#dbbbff","#dbbbff","#e3e3e3","#e7e4ef","#eae2ff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#eddeff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#25192a","#2a1431","#2f0f38","#34063f","#390046","#3e004d","#430054","#49005b","#4d0061","#530068","#590070","#5e0076","#660080","#660080","#313131","#392e3e","#3e2b46","#43264e","#492057","#4f185f","#540a67","#5a006f","#5f0076","#65007e","#6b0086","#71008e","#780097","#7f00a0","#8700aa","#484848","#504556","#564160","#5c3d69","#623772","#67317c","#6e2984","#731e8c","#790b95","#7e009d","#8400a4","#8a00ac","#9100b5","#9700bd","#9e00c6","#616161","#685e6e","#6e5b78","#735782","#78538b","#7e4e94","#84489d","#8a41a6","#9138b0","#962db8","#9c1cc1","#a200c8","#a800d1","#ae00d9","#b500e3","#7a7a7a","#817986","#867591","#8c719b","#926da6","#9769af","#9d64b9","#a35ec2","#a958cb","#af50d4","#b547dd","#bb3be7","#c22af1","#c80bf9","#d000ff","#949494","#9a93a0","#a090aa","#a58cb5","#ab88c0","#b084ca","#b67fd4","#bd7adf","#c374e9","#c96df3","#cf65fe","#d858ff","#df4cff","#e738ff","#f009ff","#aeaeae","#b4aeb9","#b9aac5","#bfa7d0","#c4a3db","#ca9fe7","#d19af3","#d795fd","#de8eff","#e588ff","#ec7fff","#f574ff","#f574ff","#f574ff","#f574ff","#c8c8c8","#cec9d3","#d3c5e0","#d9c2ec","#dfbdfa","#e6b9ff","#ecb4ff","#f3aeff","#f3aeff","#f3aeff","#f3aeff","#f3aeff","#f3aeff","#f3aeff","#f3aeff","#e3e3e3","#e9e4ee","#eee0fe","#f5dcff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#fed7ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#261829","#2c1330","#310d36","#37033d","#3c0043","#420049","#480051","#4d0057","#52005d","#580063","#5e006a","#630070","#630070","#630070","#313131","#3b2e3c","#412944","#47254b","#4e1d53","#55135b","#5b0162","#610069","#670070","#6d0077","#73007e","#7a0087","#81008f","#890097","#9300a3","#484848","#534454","#5b3f5d","#623a65","#69346d","#702c75","#77227d","#7d1185","#83008c","#8a0094","#90009a","#9600a2","#9e00aa","#a400b1","#ac00ba","#616161","#6b5d6c","#735974","#7a557c","#815085","#884a8c","#8f4394","#963a9d","#9e2ea5","#a51cad","#ac00b5","#b200bc","#b800c3","#c000cb","#c700d3","#7a7a7a","#837883","#8c748c","#946f95","#9c6a9e","#a365a6","#ab5eaf","#b257b6","#b94fbe","#c145c7","#c838cf","#d022d8","#d600df","#de00e7","#e500f0","#949494","#9e929d","#a68ea5","#ae89af","#b685b7","#be7fc0","#c67ac8","#ce73d1","#d66cda","#dd63e2","#e657ec","#ef49f6","#f736fe","#ff00ff","#ff00ff","#aeaeae","#b7adb7","#c0a9bf","#c9a4c8","#d19fd2","#db9adb","#e294e4","#eb8ded","#f486f6","#fd7dff","#ff73ff","#ff66ff","#ff56ff","#ff3fff","#ff3fff","#c8c8c8","#d1c8d0","#dbc3da","#e4bfe3","#efb9ee","#f8b3f7","#ffadff","#ffa6ff","#ff9fff","#ff9fff","#ff9fff","#ff9fff","#ff9fff","#ff9fff","#ff9fff","#e3e3e3","#ece3eb","#f8def6","#ffd9ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffd2ff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#281827","#2e132e","#340b34","#3a013a","#3f0040","#450046","#4b004d","#510053","#560058","#5c005f","#620065","#69006c","#69006c","#69006c","#313131","#3d2d3b","#442941","#4b2347","#531a4f","#590e55","#60005c","#670063","#6e006a","#750070","#7b0077","#83007e","#8b0087","#93008f","#a0009b","#484848","#554452","#5e3e59","#663960","#6f3167","#77286e","#7f1976","#86007c","#8d0082","#94008a","#9b008f","#a20096","#a9009d","#b000a4","#ba00ad","#616161","#6d5d69","#775870","#805377","#884d7e","#904684","#993d8b","#a13392","#a82598","#b100a0","#ba00a8","#c000ad","#c700b3","#cf00ba","#d700c1","#7a7a7a","#857782","#907388","#9a6d8f","#a46797","#ac619d","#b559a4","#be51ab","#c647b1","#ce3ab8","#d726bf","#df00c5","#e600cc","#f000d4","#f700da","#949494","#a0929b","#a98da2","#b488a9","#be82b0","#c77cb7","#d175bd","#da6dc5","#e365cb","#eb5bd2","#f54dda","#fe3be1","#ff1fe9","#ff00f1","#ff00f9","#aeaeae","#b9acb5","#c4a8bc","#cfa2c3","#da9dca","#e496d1","#ee90d8","#f889df","#ff7fe7","#ff75ef","#ff69f6","#ff59ff","#ff46ff","#ff28ff","#ff28ff","#c8c8c8","#d2c8cf","#dfc3d6","#ebbddd","#f7b7e5","#ffb0ed","#ffa9f4","#ffa0fd","#ff98ff","#ff98ff","#ff98ff","#ff98ff","#ff98ff","#ff98ff","#ff98ff","#e3e3e3","#eee3ea","#fcddf2","#ffd7f9","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffcfff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#291726","#30122c","#360a31","#3d0037","#43003d","#480042","#4f0048","#55004e","#5a0053","#61005a","#61005a","#61005a","#61005a","#61005a","#313131","#3f2c38","#47283d","#4f2142","#581748","#5f054e","#670053","#6f0059","#77005f","#7e0065","#85006a","#8e0071","#8e0071","#8e0071","#8e0071","#484848","#57434f","#623d54","#6c3759","#752e5e","#7e2264","#870f69","#8f006e","#980073","#a00079","#a7007d","#b00083","#b80088","#bf008d","#bf008d","#616161","#6f5d67","#7a576c","#855171","#8f4a75","#98427a","#a2387f","#aa2b84","#b31689","#bc008e","#c60094","#ce0099","#d6009e","#dd00a3","#e700a9","#7a7a7a","#87777f","#937284","#9f6c89","#ab648e","#b45e93","#bf5598","#c84b9d","#d13ea1","#da2da6","#e30aab","#ed00b1","#f400b5","#fd00ba","#ff00c0","#949494","#a19199","#ad8c9d","#ba86a2","#c480a6","#cf7aab","#da72b0","#e569b5","#ef5eba","#f952bf","#ff40c5","#ff2ac9","#ff00cf","#ff00d4","#ff00d9","#aeaeae","#bbacb3","#c8a7b7","#d5a1bc","#e19ac0","#ed94c5","#f88cca","#ff84cf","#ff79d5","#ff6cda","#ff5ce0","#ff4be6","#ff38ea","#ff38ea","#ff38ea","#c8c8c8","#d4c7cd","#e2c2d1","#f1bbd5","#ffb5da","#ffaedf","#ffa5e5","#ff9bea","#ff91f0","#ff91f0","#ff91f0","#ff91f0","#ff91f0","#ff91f0","#ff91f0","#e3e3e3","#efe3e8","#ffdded","#ffd6f1","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffcef7","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2b1724","#321129","#39082e","#400033","#460037","#4d003c","#530041","#590045","#590045","#590045","#590045","#590045","#590045","#590045","#313131","#402c36","#49273a","#52203d","#5b1442","#640046","#6c004b","#740050","#7d0054","#840058","#8d005e","#8d005e","#8d005e","#8d005e","#8d005e","#484848","#59434c","#653c4f","#703552","#7a2b55","#841e59","#8d045c","#960061","#9f0065","#a70069","#af006c","#bb0073","#bb0073","#bb0073","#bb0073","#616161","#715c64","#7e5666","#8a4f68","#95476b","#9f3f6d","#a93370","#b32373","#bc0076","#c6007a","#d0007e","#d80081","#e20085","#ec008a","#ec008a","#7a7a7a","#89777d","#97717e","#a46a80","#b16382","#bc5b84","#c85087","#d24589","#dc358c","#e61d8f","#f00091","#f90094","#ff0098","#ff009b","#ff009e","#949494","#a39196","#b18c98","#bf8599","#cb7f9b","#d6789d","#e36f9f","#ee64a2","#f958a4","#ff4aa7","#ff30aa","#ff07ac","#ff00af","#ff00b2","#ff00b2","#aeaeae","#bcacb1","#cba6b2","#daa0b3","#e899b5","#f492b6","#ff89b8","#ff7fbb","#ff73bd","#ff65c0","#ff57c3","#ff43c5","#ff43c5","#ff43c5","#ff43c5","#c8c8c8","#d5c7cb","#e6c1cc","#f6bacd","#ffb3cf","#ffabd0","#ffa1d3","#ff97d5","#ff97d5","#ff97d5","#ff97d5","#ff97d5","#ff97d5","#ff97d5","#ff97d5","#e3e3e3","#f1e2e6","#ffdce7","#ffd4e8","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffcdea","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#1d1d1d","#2c1722","#341026","#3b062a","#42002e","#4a0032","#510036","#57003a","#5e003d","#5e003d","#5e003d","#5e003d","#5e003d","#5e003d","#5e003d","#313131","#412c34","#4b2637","#541f39","#5e133c","#67003f","#700043","#780047","#80004a","#89004e","#89004e","#89004e","#89004e","#89004e","#89004e","#484848","#5a4349","#673c4a","#73344b","#7e2a4d","#881b4e","#920050","#9c0053","#a50055","#ae0058","#b7005b","#b7005b","#b7005b","#b7005b","#b7005b","#616161","#725c61","#805661","#8d4f61","#994662","#a33d62","#ae3064","#b81d65","#c20067","#cc0069","#d7006b","#df006d","#e90070","#e90070","#e90070","#7a7a7a","#8a777b","#99717a","#a76a7a","#b5627a","#c0597a","#cc4e7a","#d6427b","#e1317c","#eb127d","#f6007f","#ff0080","#ff0082","#ff0084","#ff0085","#949494","#a49195","#b38b94","#c28493","#ce7e92","#db7692","#e76d92","#f36293","#ff5494","#ff4595","#ff2996","#ff0097","#ff0098","#ff0098","#ff0098","#aeaeae","#bdacaf","#cda6ae","#dd9fad","#eb98ac","#f891ac","#ff87ac","#ff7cac","#ff70ac","#ff61ae","#ff51ae","#ff51ae","#ff51ae","#ff51ae","#ff51ae","#c8c8c8","#d6c7ca","#e8c1c8","#f9bac7","#ffb2c6","#ffaac5","#ff9fc5","#ff95c5","#ff95c5","#ff95c5","#ff95c5","#ff95c5","#ff95c5","#ff95c5","#ff95c5","#e3e3e3","#f2e2e5","#ffdbe3","#ffd4e1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffcde1","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"];var SYNTHSVG='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" y="0px" xml:space="preserve" x="0px" width="SVGWIDTHpx" viewBox="0 0 SVGWIDTH 55" version="1.1" height="55px" enable-background="new 0 0 SVGWIDTH 55"><g transform="scale(XSCALE,1)"><path d="m 1.5,27.5 c 0,0 2.2,-17.5 6.875,-17.5 4.7,0.0 6.25,11.75 6.875,17.5 0.75,6.67 2.3,17.5 6.875,17.5 4.1,0.0 6.25,-13.6 6.875,-17.5 C 29.875,22.65 31.1,10 35.875,10 c 4.1,0.0 5.97,13.0 6.875,17.5 1.15,5.7 1.75,17.5 6.875,17.5 4.65,0.0 6.875,-17.5 6.875,-17.5" style="stroke:#90c100;fill-opacity:1;fill:none;stroke-width:STROKEWIDTHpx;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /></g></svg>',WHOLENOTE='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="svg6468" viewBox="0 0 5.1680003 12.432" height="12.432" width="5.1680002"> <g transform="translate(-375.23523,-454.37592)"> <g transform="translate(7.9606,5.6125499)" style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 369.80263,457.99537 q 1.104,0 1.872,0.432 0.768,0.416 0.768,1.2 0,0.752 -0.752,1.168 -0.752,0.4 -1.808,0.4 -1.104,0 -1.856,-0.416 -0.752,-0.416 -0.752,-1.232 0,-0.576 0.464,-0.944 0.48,-0.368 1.008,-0.48 0.528,-0.128 1.056,-0.128 z m -0.864,1.136 q 0,0.672 0.304,1.184 0.304,0.512 0.784,0.512 0.736,0 0.736,-0.8 0,-0.64 -0.304,-1.136 -0.288,-0.512 -0.8,-0.512 -0.72,0 -0.72,0.752 z" /> </g> </g> </svg>',HALFNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3.84 12.432" height="3.5085866mm" width="1.0837333mm"> <g transform="translate(-375.23523,-454.37592)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 375.23523,465.70392 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-9.472 0.352,0 0,10.352 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 0.736,0.48 q 0.848,0 1.712,-0.72 0.88,-0.72 0.88,-1.072 0,-0.224 -0.192,-0.224 -0.592,0 -1.632,0.688 -1.024,0.672 -1.024,1.12 0,0.208 0.256,0.208 z" /> </g> </g> </svg>',QUARTERNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4.0859801 11.74224" height="3.313921mm" width="1.1531544mm"> <g transform="translate(-226.1339,-457.841)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 229.60268,457.841 0.5625,0 0.0547,0.0625 0,10.02344 q 0,1.27344 -1.53125,1.625 l -0.375,0.0313 -0.27343,0 q -1.65625,0 -1.875,-1.03906 l -0.0313,-0.24219 q 0,-1.01562 1.64843,-1.20312 l 0.25782,-0.0391 q 0.77343,0 1.47656,0.5 l 0.0313,0 0,-9.65625 0.0547,-0.0625 z" /> </g> </g> </svg>',EIGHTHNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.5234898 11.7422" height="3.3139098mm" width="2.123296mm"> <g transform="translate(-244.80575,-403.5553)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 248.14955,403.5553 0.67969,0 0.0625,0.0547 0,0.30468 q 0.21094,0.42188 1.5625,0.91407 1.875,0.54687 1.875,1.625 0,1.14062 -0.95313,1.89062 l -0.0313,0 -0.23437,-0.25 q 0.47656,-0.38281 0.47656,-1.03906 0,-0.54688 -1.78125,-1.10156 -0.71875,-0.32813 -0.91406,-0.53125 l 0,8.32812 q 0,1.19531 -1.75,1.54688 l -0.44531,0 q -1.89063,0 -1.89063,-1.3125 0,-1.02344 1.65625,-1.20313 l 0.17969,0 q 0.75,0 1.44531,0.5 l 0,-9.67187 0.0625,-0.0547 z" /> </g> </g> </svg>',SIXTEENTHNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.0080001 12.432" height="3.5085866mm" width="1.9778134mm"> <g transform="translate(-182.21292,-431.51877)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 182.21292,442.84677 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-9.472 0.336,0 q 0.064,0.56 0.4,1.088 0.352,0.512 0.8,0.944 0.448,0.416 0.88,0.864 0.448,0.432 0.752,1.024 0.304,0.576 0.304,1.232 0,0.544 -0.256,1.104 0.304,0.448 0.304,1.184 0,1.232 -0.608,2.24 l -0.384,0 q 0.56,-1.12 0.56,-2.032 0,-0.512 -0.256,-0.96 -0.24,-0.448 -0.752,-0.816 -0.496,-0.368 -0.832,-0.56 -0.32,-0.192 -0.896,-0.48 l 0,5.52 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 6.464,-5.904 q 0,-1.648 -2.624,-3.072 0,0.464 0.192,0.88 0.192,0.416 0.512,0.752 0.32,0.32 0.656,0.592 0.336,0.272 0.688,0.608 0.352,0.32 0.544,0.608 0.032,-0.256 0.032,-0.368 z" /> </g> </g> </svg>',THIRTYSECONDNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.0080001 14.496001" height="4.0910935mm" width="1.9778134mm"> <g transform="translate(-630.78433,-240.88335)">  <g  style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1">  <path  d="m 630.78433,254.27535 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-11.536 0.352,0 q 0.048,0.56 0.384,1.072 0.336,0.496 0.768,0.912 0.432,0.4 0.864,0.848 0.432,0.448 0.72,1.104 0.304,0.656 0.304,1.456 0,0.48 -0.16,1.056 0.224,0.416 0.224,0.912 0,0.512 -0.24,0.976 0.304,0.448 0.304,1.168 0,1.232 -0.608,2.24 l -0.384,0 q 0.56,-1.12 0.56,-2.032 0,-0.512 -0.256,-0.96 -0.24,-0.448 -0.752,-0.816 -0.496,-0.368 -0.832,-0.56 -0.32,-0.192 -0.896,-0.48 l 0,5.52 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 6.448,-7.872 q 0,-0.496 -0.208,-0.928 -0.192,-0.432 -0.64,-0.832 -0.432,-0.416 -0.784,-0.672 -0.352,-0.256 -0.976,-0.656 0.032,0.448 0.352,0.896 0.32,0.432 0.704,0.752 0.4,0.32 0.848,0.8 0.464,0.464 0.704,0.912 l 0,-0.272 z m 0,2.096 q 0,-0.4 -0.16,-0.768 -0.144,-0.368 -0.32,-0.608 -0.16,-0.256 -0.592,-0.608 -0.416,-0.352 -0.672,-0.528 -0.256,-0.176 -0.848,-0.576 0.064,0.48 0.4,0.976 0.336,0.48 0.72,0.816 0.4,0.336 0.832,0.784 0.448,0.432 0.64,0.784 l 0,-0.272 z" /> </g> </g> </svg>',SIXTYFOURTHNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.0080001 14.528" height="4.1001244mm" width="1.9778134mm"> <g transform="translate(-345.3223,-325.39492)"> <g transform="translate(3.1093785,1.6864426)" style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 342.21292,337.13248 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-11.568 0.336,0 q 0.064,0.64 0.384,1.104 0.336,0.464 0.752,0.768 0.416,0.304 0.832,0.656 0.416,0.336 0.688,0.928 0.288,0.592 0.288,1.44 0,0.24 -0.144,0.768 0.256,0.608 0.256,1.376 0,0.32 -0.16,0.896 0.224,0.416 0.224,0.912 0,0.496 -0.24,0.96 0.304,0.448 0.304,1.024 0,0.384 -0.08,0.688 -0.08,0.304 -0.16,0.448 -0.08,0.144 -0.368,0.608 l -0.384,0 q 0.08,-0.16 0.192,-0.368 0.112,-0.224 0.16,-0.32 0.064,-0.096 0.112,-0.24 0.064,-0.144 0.08,-0.288 0.016,-0.144 0.016,-0.32 0,-0.272 -0.096,-0.512 -0.08,-0.256 -0.176,-0.432 -0.096,-0.192 -0.32,-0.4 -0.224,-0.208 -0.368,-0.32 -0.144,-0.128 -0.464,-0.304 -0.304,-0.192 -0.432,-0.256 -0.128,-0.064 -0.48,-0.224 -0.336,-0.176 -0.4,-0.208 l 0,4.064 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 6.352,-8.384 q 0,-0.352 -0.144,-0.688 -0.128,-0.352 -0.288,-0.576 -0.16,-0.224 -0.48,-0.496 -0.32,-0.272 -0.512,-0.4 -0.192,-0.144 -0.592,-0.384 -0.384,-0.24 -0.496,-0.32 0.032,0.432 0.352,0.832 0.32,0.384 0.704,0.656 0.4,0.272 0.816,0.72 0.432,0.432 0.624,0.912 0.016,-0.176 0.016,-0.256 z m 0.016,2.128 q 0,-0.208 -0.048,-0.4 -0.032,-0.192 -0.08,-0.336 -0.048,-0.16 -0.176,-0.336 -0.128,-0.176 -0.208,-0.288 -0.08,-0.112 -0.272,-0.272 -0.192,-0.176 -0.288,-0.256 -0.096,-0.08 -0.352,-0.256 -0.24,-0.176 -0.336,-0.224 -0.096,-0.064 -0.384,-0.24 -0.288,-0.192 -0.384,-0.256 0.032,0.464 0.368,0.88 0.336,0.416 0.736,0.704 0.4,0.272 0.816,0.688 0.416,0.416 0.576,0.864 0.032,-0.192 0.032,-0.272 z m -0.016,1.936 q 0,-0.848 -0.624,-1.504 -0.608,-0.672 -1.872,-1.392 0.064,0.464 0.384,0.896 0.336,0.416 0.72,0.688 0.4,0.272 0.8,0.704 0.4,0.416 0.576,0.88 0.016,-0.064 0.016,-0.272 z" /> </g> </g> </svg>',SHARP="",FLAT="",NATURAL="",DOUBLESHARP="",DOUBLEFLAT="",NSYMBOLS={1:"",2:"",4:"",8:"",16:""},RSYMBOLS={1:"",2:"",4:""},BTOFLAT={Eb:"E"+FLAT,Gb:"G"+FLAT,Ab:"A"+FLAT,Bb:"B"+FLAT,Db:"D"+FLAT,Cb:"C"+FLAT,Fb:"F"+FLAT,eb:"E"+FLAT,gb:"G"+FLAT,ab:"A"+FLAT,bb:"B"+FLAT,db:"D"+FLAT,cb:"C"+FLAT,fb:"F"+FLAT},STOSHARP={"E#":"E"+SHARP,"G#":"G"+SHARP,"A#":"A"+SHARP,"B#":"B"+SHARP,"D#":"D"+SHARP,"C#":"C"+SHARP,"F#":"F"+SHARP,"e#":"E"+SHARP,"g#":"G"+SHARP,"a#":"A"+SHARP,"b#":"B"+SHARP,"d#":"D"+SHARP,"c#":"C"+SHARP,"f#":"F"+SHARP},NOTESSHARP=["C","C"+SHARP,"D","D"+SHARP,"E","F","F"+SHARP,"G","G"+SHARP,"A","A"+SHARP,"B"],NOTESFLAT=["C","D"+FLAT,"D","E"+FLAT,"E","F","G"+FLAT,"G","A"+FLAT,"A","B"+FLAT,"B"],NOTESFLAT2=["c","d"+FLAT,"d","e"+FLAT,"e","f","g"+FLAT,"g","a"+FLAT,"a","b"+FLAT,"b"],EQUIVALENTFLATS={"C":"D"+FLAT,"D":"E"+FLAT,"F":"G"+FLAT,"G":"A"+FLAT,"A":"B"+FLAT},EQUIVALENTSHARPS={"D":"C"+SHARP,"E":"D"+SHARP,"G":"F"+SHARP,"A":"G"+SHARP,"B":"A"+SHARP},EQUIVALENTNATURALS={"E":"F","B":"C","C":"B","F":"E"},EXTRATRANSPOSITIONS={"E":["F",0],"B":["C",1],"C":["B",-1],"F":["E",0],"e":["F",0],"b":["C",1],"c":["B",-1],"f":["E",0]},SOLFEGENAMES=["do","re","mi","fa","sol","la","ti"],SOLFEGENAMES1=["do","do"+SHARP,"do"+DOUBLESHARP,"re","re"+FLAT,"re","re"+SHARP,"re"+DOUBLESHARP,"mi","mi"+FLAT,"mi","fa","fa"+SHARP,"fa"+DOUBLESHARP,"sol","sol"+FLAT,"sol","sol"+SHARP,"sol"+DOUBLESHARP,"la","la","la"+FLAT,"la#","la"+DOUBLESHARP,"ti","ti"+FLAT,"ti"],SOLFEGECONVERSIONTABLE={C:"do","C":"do"+SHARP,D:"re","D":"re"+SHARP,E:"mi",F:"fa","F":"fa"+SHARP,G:"sol","G":"sol"+SHARP,A:"la","A":"la"+SHARP,B:"ti","D":"re"+FLAT,"E":"mi"+FLAT,"G":"sol"+FLAT,"A":"la"+FLAT,"B":"ti"+FLAT,R:_("rest")},WESTERN2EISOLFEGENAMES={do:"sa",re:"re",mi:"ga",fa:"ma",sol:"pa",la:"dha",ti:"ni"},PITCHES=["C","D"+FLAT,"D","E"+FLAT,"E","F","G"+FLAT,"G","A"+FLAT,"A","B"+FLAT,"B"],PITCHES1=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],PITCHES2=["C","C"+SHARP,"D","D"+SHARP,"E","F","F"+SHARP,"G","G"+SHARP,"A","A"+SHARP,"B"],PITCHES3=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],NOTESTABLE={1:"do",2:"do"+SHARP,3:"re",4:"re"+SHARP,5:"mi",6:"fa",7:"fa"+SHARP,8:"sol",9:"sol"+SHARP,10:"la",11:"la"+SHARP,0:"ti"},FIXEDSOLFEGE={do:"C",re:"D",mi:"E",fa:"F",sol:"G",la:"A",ti:"B"},FIXEDSOLFEGE1={do:"C","do":"C"+SHARP,"do":"C"+DOUBLESHARP,"re":"D"+DOUBLEFLAT,re:"D","re":"D"+SHARP,"re":"D"+DOUBLESHARP,"mi":"E"+DOUBLEFLAT,mi:"E",fa:"F","fa":"F"+SHARP,"fa":"F"+DOUBLESHARP,"sol":"G"+DOUBLEFLAT,sol:"G","sol":"G"+SHARP,"sol":"G"+DOUBLESHARP,"la":"A"+DOUBLEFLAT,la:"A","la":"A"+SHARP,"la":"A"+DOUBLESHARP,"ti":"B"+DOUBLEFLAT,ti:"B","re":"D"+FLAT,"mi":"E"+FLAT,"sol":"G"+FLAT,"la":"A"+FLAT,"ti":"B"+FLAT,R:_("rest")},NOTESTEP={C:1,D:3,E:5,F:6,G:8,A:10,B:12},SHARPPREFERENCE=["g major","d major","a major","e major","b major","f# major","c# major","e minor","b minor","f# minor","c# minor","g# minor","d# minor"],FLATPREFERENCE=["f major","bb major","eb major","ab major","db major","gb major","cb major","d minor","g minor","c minor","f minor","bb minor","eb minor","d harmonic minor","g harmonic minor","c harmonic minor","f harmonic minor","bb harmonic minor","eb harmonic minor"],SOLFNOTES=["ti","la","sol","fa","mi","re","do"],EASTINDIANSOLFNOTES=["ni","dha","pa","ma","ga","re","sa"],SOLFATTRS=[DOUBLESHARP,SHARP,NATURAL,FLAT,DOUBLEFLAT],DEGREES=_("1st 2nd 3rd 4th 5th 6th 7th 8th 9th 10th 11th 12th");function getSharpFlatPreference(t){var e=keySignatureToMode(t),i=modeMapper(e[0],e[1]),s=i[0]+" "+i[1];return console.log(s),-1!==SHARPPREFERENCE.indexOf(s)?"sharp":-1!==FLATPREFERENCE.indexOf(s)?"flat":"natural"}function mod12(t){for(;t<0;)t+=12;return t%12}var SEMITONES=12,POWER2=[1,2,4,8,16,32,64,128],TWELTHROOT2=1.0594630943592953,TWELVEHUNDRETHROOT2=1.0005777895065548,A0=27.5,C8=4186.01,OCTAVERATIO=2,STARTINGPITCH="C4",RHYTHMRULERHEIGHT=100,SLIDERHEIGHT=200,SLIDERWIDTH=50,MATRIXBUTTONCOLOR="#c374e9",MATRIXLABELCOLOR="#90c100",MATRIXNOTECELLCOLOR="#b1db00",MATRIXTUPLETCELLCOLOR="#57e751",MATRIXRHYTHMCELLCOLOR="#c8c8c8",MATRIXBUTTONCOLORHOVER="#c894e0",MATRIXNOTECELLCOLORHOVER="#c2e820",MATRIXSOLFEWIDTH=52,EIGHTHNOTEWIDTH=24,MATRIXBUTTONHEIGHT=40,MATRIXBUTTONHEIGHT2=66,MATRIXSOLFEHEIGHT=30,wholeNoteImg="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(WHOLENOTE))),halfNoteImg="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(HALFNOTE))),quarterNoteImg="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(QUARTERNOTE))),eighthNoteImg="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(EIGHTHNOTE))),sixteenthNoteImg="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SIXTEENTHNOTE))),thirtysecondNoteImg="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(THIRTYSECONDNOTE))),sixtyfourthNoteImg="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SIXTYFOURTHNOTE))),NOTESYMBOLS={1:wholeNoteImg,2:halfNoteImg,4:quarterNoteImg,8:eighthNoteImg,16:sixteenthNoteImg,32:thirtysecondNoteImg,64:sixtyfourthNoteImg},SELECTORSTRINGS=[_("unison"),_("augmented"),_("diminished"),_("minor"),_("major"),_("perfect"),_("chromatic"),_("algerian"),_("spanish"),_("octatonic"),_("harmonic major"),_("natural minor"),_("harmonic minor"),_("melodic minor"),_("ionian"),_("dorian"),_("phrygian"),_("lydian"),_("mixolydian"),_("aeolian"),_("locrian"),_("jazz minor"),_("bebop"),_("arabic"),_("byzantine"),_("enigmatic"),_("ethiopian"),_("geez"),_("hindu"),_("hungarian"),_("romanian minor"),_("spanish gypsy"),_("maqam"),_("minor blues"),_("major blues"),_("whole tone"),_("minor pentatonic"),_("major pentatonic"),_("chinese"),_("egyptian"),_("hirajoshi"),_("Japan"),_("in"),_("minyo"),_("fibonacci"),_("custom"),_("highpass"),_("lowpass"),_("bandpass"),_("highshelf"),_("lowshelf"),_("notch"),_("allpass"),_("peaking"),_("sine"),_("square"),_("triangle"),_("sawtooth"),_("even"),_("odd"),_("scalar"),_("piano"),_("violin"),_("xylophone"),_("vibraphone"),_("cello"),_("bass"),_("guitar"),_("acoustic guitar"),_("flute"),_("clarinet"),_("saxophone"),_("tuba"),_("trumpet"),_("electronic synth"),_("simple 1"),_("simple 2"),_("simple 3"),_("simple 4"),_("white noise"),_("brown noise"),_("pink noise"),_("custom"),_("snare drum"),_("kick drum"),_("tom tom"),_("floor tom"),_("cup drum"),_("darbuka drum"),_("hi hat"),_("ride bell"),_("cow bell"),_("japanese drum"),_("triangle bell"),_("finger cymbals"),_("chime"),_("gong"),_("clang"),_("crash"),_("bottle"),_("clap"),_("slap"),_("splash"),_("bubbles"),_("raindrop"),_("cat"),_("cricket"),_("dog"),_("duck"),_("banjo"),_("koto"),_("dulcimer"),_("electric guitar"),_("bassoon"),_("celeste"),_("equal"),_("Pythagorean"),_("just intonation"),_("meantone"),_("custom"),_("double flat"),_("flat"),_("natural"),_("sharp"),_("double sharp")],ACCIDENTALLABELS=[_("double sharp")+" "+DOUBLESHARP,_("sharp")+" "+SHARP,_("natural")+" "+NATURAL,_("flat")+" "+FLAT,_("double flat")+" "+DOUBLEFLAT],ACCIDENTALNAMES=["double sharp "+DOUBLESHARP,"sharp "+SHARP,"natural "+NATURAL,"flat "+FLAT,"double flat "+DOUBLEFLAT],ACCIDENTALVALUES=[2,1,0,-1,-2],INVERTMODES=[[_("even"),"even"],[_("odd"),"odd"],[_("scalar"),"scalar"]],INTERVALS=[[_("perfect"),"perfect",[1,4,5,8]],[_("minor"),"minor",[2,3,6,7]],[_("diminished"),"diminished",[2,3,4,5,6,7,8]],[_("augmented"),"augmented",[1,2,3,4,5,6,7,8]],[_("major"),"major",[2,3,6,7]]],INTERVALVALUES={"perfect 1":[0,0],"augmented 1":[1,1],"diminished 2":[0,-1],"minor 2":[1,-1],"major 2":[2,1],"augmented 2":[3,1],"diminished 3":[2,-1],"minor 3":[3,-1],"major 3":[4,1],"augmented 3":[5,1],"diminished 4":[4,-1],"perfect 4":[5,0],"augmented 4":[6,1],"diminished 5":[6,-1],"perfect 5":[7,0],"augmented 5":[8,1],"diminished 6":[7,-1],"minor 6":[8,-1],"major 6":[9,1],"augmented 6":[10,1],"diminished 7":[9,-1],"minor 7":[10,-1],"major 7":[11,1],"augmented 7":[12,1],"diminished 8":[11,-1],"perfect 8":[12,0],"augmented 8":[13,1]},MODE_PIE_MENUS={5:["minor pentatonic","major pentatonic"," ","chinese","egyptian"," ","hirajoshi","in","minyo"," ","fibonacci"," "],6:["minor blues"," "," "," ","major blues"," "," "," ","whole tone"," "," "," "],7:["ionian"," ","dorian"," ","phrygian","lydian"," ","mixolydian"," ","aeolian"," ","locrian"],"7a":["major"," ","harmonic major"," ","natural minor"," ","harmonic minor"," ","melodic minor"," "," "," "],"7b":["jazz minor","bebop","arabic","byzantine","enigmatic","ethiopian","geez","hindu","hungarian","maqam","romanian minor","spanish gypsy"],8:["octatonic"," "," ","diminished"," "," ","spanish"," "," ","algerian"," "," "],12:["chromatic"," "," "," "," "," ","custom"," "," "," "," "," "]},MUSICALMODES={chromatic:[1,1,1,1,1,1,1,1,1,1,1,1],algerian:[2,1,2,1,1,1,3,1],diminished:[2,1,2,1,2,1,2,1],spanish:[1,2,1,1,1,2,2,2],octatonic:[1,2,1,2,1,2,1,2],major:[2,2,1,2,2,2,1],"harmonic major":[2,2,1,2,1,3,1],"natural minor":[2,1,2,2,1,2,2],"harmonic minor":[2,1,2,2,1,3,1],"melodic minor":[2,1,2,2,2,2,1],ionian:[2,2,1,2,2,2,1],dorian:[2,1,2,2,2,1,2],phrygian:[1,2,2,2,1,2,2],lydian:[2,2,2,1,2,2,1],mixolydian:[2,2,1,2,2,1,2],aeolian:[2,1,2,2,1,2,2],locrian:[1,2,2,1,2,2,2],"jazz minor":[2,1,2,2,2,2,1],bebop:[1,1,1,2,2,1,2],arabic:[2,2,1,1,2,2,2],byzantine:[1,3,1,2,1,3,1],enigmatic:[1,3,2,2,2,1,1],ethiopian:[2,1,2,2,1,2,2],geez:[2,1,2,2,1,2,2],hindu:[2,2,1,2,1,2,2],hungarian:[2,1,3,1,1,3,1],maqam:[1,3,1,2,1,3,1],"romanian minor":[2,1,3,1,2,1,2],"spanish gypsy":[1,3,1,2,1,2,2],"minor blues":[3,2,1,1,3,2],"major blues":[2,1,1,3,2,2],"whole tone":[2,2,2,2,2,2],"major pentatonic":[2,2,3,2,3],"minor pentatonic":[3,2,2,3,2],chinese:[4,2,1,4,1],egyptian:[2,3,2,3,2],hirajoshi:[1,4,1,4,2],in:[1,4,2,1,4],minyo:[3,2,2,3,2],fibonacci:[1,1,2,3,5],custom:[1,1,1,1,1,1,1,1,1,1,1,1]},MAQAMTABLE={"hijaz kar":"C maqam","hijaz kar maqam":"C maqam",shahnaz:"D maqam","maqam mustar":"Eb maqam","maqam jiharkah":"F maqam","shadd araban":"G maqam",suzidil:"A maqam",ajam:"Bb maqam","ajam maqam":"Bb maqam"},FILTERTYPES=[[_("highpass"),"highpass"],[_("lowpass"),"lowpass"],[_("bandpass"),"bandpass"],[_("highshelf"),"highshelf"],[_("lowshelf"),"lowshelf"],[_("notch"),"notch"],[_("allpass"),"allpass"],[_("peaking"),"peaking"]],OSCTYPES=[[_("sine"),"sine"],[_("square"),"square"],[_("triangle"),"triangle"],[_("sawtooth"),"sawtooth"]],TEMPERAMENTS=[[_("equal"),"equal","equal"],[_("just intonation"),"just intonation","just intonation"],[_("Pythagorean"),"Pythagorean","Pythagorean"],[_("meantone")+" (1/3)","1/3 comma meantone","meantone (1/3)"],[_("meantone")+" (1/4)","1/4 comma meantone","meantone (1/4)"],[_("custom"),"custom","custom"]],TEMPERAMENT={equal:{"perfect 1":Math.pow(2,0),"minor 2":Math.pow(2,1/12),"augmented 1":Math.pow(2,1/12),"major 2":Math.pow(2,2/12),"augmented 2":Math.pow(2,.25),"minor 3":Math.pow(2,.25),"major 3":Math.pow(2,4/12),"augmented 3":Math.pow(2,5/12),"diminished 4":Math.pow(2,4/12),"perfect 4":Math.pow(2,5/12),"augmented 4":Math.pow(2,.5),"diminished 5":Math.pow(2,.5),"perfect 5":Math.pow(2,7/12),"augmented 5":Math.pow(2,8/12),"minor 6":Math.pow(2,8/12),"major 6":Math.pow(2,.75),"augmented 6":Math.pow(2,10/12),"minor 7":Math.pow(2,10/12),"major 7":Math.pow(2,11/12),"augmented 7":Math.pow(2,1),"diminished 8":Math.pow(2,11/12),"perfect 8":Math.pow(2,1),pitchNumber:12,interval:["perfect 1","minor 2","major 2","minor 3","major 3","perfect 4","diminished 5","perfect 5","minor 6","major 6","minor 7","major 7","perfect 8"]},"just intonation":{"perfect 1":1,"minor 2":16/15,"augmented 1":16/15,"major 2":9/8,"augmented 2":1.2,"minor 3":1.2,"major 3":5/4,"augmented 3":4/3,"diminished 4":5/4,"perfect 4":4/3,"augmented 4":1.4,"diminished 5":1.4,"perfect 5":1.5,"augmented 5":1.6,"minor 6":1.6,"major 6":5/3,"augmented 6":16/9,"minor 7":16/9,"major 7":15/8,"augmented 7":2,"diminished 8":15/8,"perfect 8":2,pitchNumber:12,interval:["perfect 1","minor 2","major 2","minor 3","major 3","perfect 4","diminished 5","perfect 5","minor 6","major 6","minor 7","major 7","perfect 8"]},Pythagorean:{"perfect 1":1,"minor 2":256/243,"augmented 1":256/243,"major 2":9/8,"augmented 2":32/27,"minor 3":32/27,"major 3":81/64,"augmented 3":4/3,"diminished 4":81/64,"perfect 4":4/3,"augmented 4":729/512,"diminished 5":729/512,"perfect 5":1.5,"augmented 5":128/81,"minor 6":128/81,"major 6":27/16,"augmented 6":16/9,"minor 7":16/9,"major 7":243/128,"augmented 7":2,"diminished 8":243/128,"perfect 8":2,pitchNumber:12,interval:["perfect 1","minor 2","major 2","minor 3","major 3","perfect 4","diminished 5","perfect 5","minor 6","major 6","minor 7","major 7","perfect 8"]},"1/3 comma meantone":{"perfect 1":1,"minor 2":1.075693,"augmented 1":1.037156,"major 2":1.115656,"augmented 2":1.157109,"minor 3":1.200103,"major 3":1.244694,"augmented 3":1.290943,"diminished 4":1.290943,"perfect 4":1.338902,"augmented 4":1.38865,"diminished 5":1.440247,"perfect 5":1.493762,"augmented 5":1.549255,"minor 6":1.60682,"major 6":1.666524,"augmented 6":1.728445,"minor 7":1.792668,"major 7":1.859266,"augmented 7":1.92835,"diminished 8":1.92835,"perfect 8":2,pitchNumber:19,interval:["perfect 1","augmented 1","minor 2","major 2","augmented 2","minor 3","major 3","diminished 4","perfect 4","augmented 4","diminished 5","perfect 5","augmented 5","minor 6","major 6","augmented 6","minor 7","major 7","diminished 8","perfect 8"]},"1/4 comma meantone":{"perfect 1":1,"minor 2":16/15,"augmented 1":25/24,"major 2":9/8,"augmented 2":75/64,"minor 3":1.2,"major 3":5/4,"diminished 4":1.28,"augmented 3":125/96,"perfect 4":4/3,"augmented 4":25/18,"diminished 5":1.44,"perfect 5":1.5,"augmented 5":25/16,"minor 6":1.6,"major 6":5/3,"augmented 6":125/72,"minor 7":1.8,"major 7":15/8,"diminished 8":1.92,"augmented 7":125/64,"perfect 8":2,pitchNumber:21,interval:["perfect 1","augmented 1","minor 2","major 2","augmented 2","minor 3","major 3","diminished 4","augmented 3","perfect 4","augmented 4","diminished 5","perfect 5","augmented 5","minor 6","major 6","augmented 6","minor 7","major 7","diminished 8","augmented 7","perfect 8"]},custom:{0:Math.pow(2,0),1:Math.pow(2,1/12),2:Math.pow(2,2/12),3:Math.pow(2,.25),4:Math.pow(2,4/12),5:Math.pow(2,5/12),6:Math.pow(2,.5),7:Math.pow(2,7/12),8:Math.pow(2,8/12),9:Math.pow(2,.75),10:Math.pow(2,10/12),11:Math.pow(2,11/12),pitchNumber:12}},DEFAULTINVERT="even",DEFAULTINTERVAL="perfect 5",DEFAULTVOICE="electronic synth",DEFAULTNOISE="noise1",DEFAULTDRUM="kick drum",DEFAULTEFFECT="duck",DEFAULTMODE="major",DEFAULTTEMPERAMENT="equal",DEFAULTFILTERTYPE="highpass",DEFAULTOSCILLATORTYPE="sine",DEFAULTACCIDENTAL="natural "+NATURAL,customMode=MUSICALMODES.custom;function getInvertMode(t){for(var e in INVERTMODES)if(INVERTMODES[e][0]===t||INVERTMODES[e][1].toLowerCase()===t.toLowerCase())return""!=INVERTMODES[e][0]?INVERTMODES[e][0]:(console.log("I18n for invert mode is misbehaving."),console.log(t+" "+t.toLowerCase()+" "+INVERTMODES[e][0].toLowerCase()+" "+INVERTMODES[e][1].toLowerCase()),INVERTMODES[e][1]);return console.log(t+" not found in INVERTMODES"),t}function getIntervalNumber(t){return INTERVALVALUES[t][0]}function getIntervalDirection(t){return INTERVALVALUES[t][1]}function getModeNumbers(t){for(var e in __convert=function(t){for(var e=0,i="",s=0;s<t.length;s++)i+=e.toString(),s<t.length-1&&(i+=" "),e+=t[s];return i},MUSICALMODES)if(e===t.toLowerCase())return __convert(MUSICALMODES[e]);return console.log(t+" not found in MUSICALMODES"),""}function getDrumIndex(t){""===t?(console.log("getDrumName passed blank name. Returning "+DEFAULTDRUM),t=DEFAULTDRUM):"http"===t.slice(0,4)&&(t=DEFAULTDRUM);for(var e=0;e<DRUMNAMES.length;e++){if(DRUMNAMES[e][0].toLowerCase()===t.toLowerCase())return e;if(DRUMNAMES[e][1].toLowerCase()===t.toLowerCase())return e}return-1}function getDrumName(t){if(""===t)console.log("getDrumName passed blank name. Returning "+DEFAULTDRUM),t=DEFAULTDRUM;else if("http"===t.slice(0,4))return null;for(var e=0;e<DRUMNAMES.length;e++){if(DRUMNAMES[e][0].toLowerCase()===t.toLowerCase())return DRUMNAMES[e][0];if(DRUMNAMES[e][1].toLowerCase()===t.toLowerCase())return DRUMNAMES[e][1]}return null}function getDrumSymbol(t){if(""===t)return console.log("getDrumName passed blank name. Returning hh"),"hh";for(var e=0;e<DRUMNAMES.length;e++){if(DRUMNAMES[e][0].toLowerCase()===t.toLowerCase())return DRUMNAMES[e][3];if(DRUMNAMES[e][1].toLowerCase()===t.toLowerCase())return"hh"}return console.log(t+" not found in DRUMNAMES"),"hh"}function getFilterTypes(t){""===t&&(console.log("getFiterType passed blank name. Returning "+DEFAULTFILTERTYPE),t=DEFAULTFILTERTYPE);for(var e=0;e<FILTERTYPES.length;e++){if(FILTERTYPES[e][0].toLowerCase()===t.toLowerCase())return FILTERTYPES[e][0];if(FILTERTYPES[e][1].toLowerCase()===t.toLowerCase())return FILTERTYPES[e][1]}return console.log(t+" not found in FILTERTYPES"),DEFAULTFILTERTYPE}function getOscillatorTypes(t){""===t&&(console.log("getOscillatorType passed blank name. Returning "+DEFAULTOSCILLATORTYPE),t=null);for(var e=0;e<OSCTYPES.length;e++){if(OSCTYPES[e][0].toLowerCase()===t.toLowerCase())return OSCTYPES[e][0];if(OSCTYPES[e][1].toLowerCase()===t.toLowerCase())return OSCTYPES[e][1]}return null}function getDrumIcon(t){if(""===t)console.log("getDrumIcon passed blank name. Returning "+DEFAULTDRUM),t=DEFAULTDRUM;else if("http"===t.slice(0,4))return"images/drum.svg";for(var e=0;e<DRUMNAMES.length;e++)if(DRUMNAMES[e][0]===t||DRUMNAMES[e][1].toLowerCase()===t.toLowerCase())return DRUMNAMES[e][2];return console.log(t+" not found in DRUMNAMES"),"images/drum.svg"}function getDrumSynthName(t){if(null==t)return console.log("getDrumSynthName passed null name. Returning null"),null;if(""===t)console.log("getDrumSynthName passed blank name. Returning "+DEFAULTDRUM),t=DEFAULTDRUM;else if("http"===t.slice(0,4))return t;for(var e=0;e<DRUMNAMES.length;e++)if(DRUMNAMES[e][0]===t||DRUMNAMES[e][1].toLowerCase()===t.toLowerCase())return DRUMNAMES[e][1];return console.log(t+" not found in DRUMNAMES"),DEFAULTDRUM}function getNoiseName(t){""===t&&(console.log("getNoiseName passed blank name. Returning "+DEFAULTNOISE),t=DEFAULTNOISE);for(var e=0;e<NOISENAMES.length;e++)if(NOISENAMES[e][1]===t)return""!=NOISENAMES[e][0]?NOISENAMES[e][0]:NOISENAMES[e][1];return console.log(t+" not found in NOISENAMES"),DEFAULTNOISE}function getNoiseIcon(t){if(""===t)console.log("getNoiseIcon passed blank name. Returning "+DEFAULTNOISE),t=DEFAULTNOISE;else if("http"===t.slice(0,4))return"images/noises.svg";for(var e=0;e<NOISENAMES.length;e++)if(NOISENAMES[e][0]===t||NOISENAMES[e][1]===t)return NOISENAMES[e][2];return console.log(t+" not found in NOISENAMES"),"images/synth.svg"}function getNoiseSynthName(t){if(null==t)return console.log("getNoiseSynthName passed null name. Returning null"),null;""===t&&(console.log("getNoiseSynthName passed blank name. Returning "+DEFAULTNOISE),t=DEFAULTNOISE);for(var e=0;e<NOISENAMES.length;e++)if(NOISENAMES[e][0]===t||NOISENAMES[e][1]===t)return NOISENAMES[e][1];return console.log(t+" not found in NOISENAMES"),DEFAULTNOISE}function getVoiceName(t){if(""===t)console.log("getVoiceName passed blank name. Returning "+DEFAULTVOICE),t=DEFAULTVOICE;else if("http"===t.slice(0,4))return null;for(var e=0;e<VOICENAMES.length;e++)if(VOICENAMES[e][0]===t){if(""!=VOICENAMES[e][0])return VOICENAMES[e][0];if(VOICENAMES[e][1]===t)return VOICENAMES[e][1]}return console.log(t+" not found in VOICENAMES"),DEFAULTVOICE}function getVoiceIcon(t){if(""===t)console.log("getVoiceIcon passed blank name. Returning "+DEFAULTVOICE),t=DEFAULTVOICE;else if("http"===t.slice(0,4))return"images/voices.svg";for(var e=0;e<VOICENAMES.length;e++)if(VOICENAMES[e][0]===t||VOICENAMES[e][1]===t)return VOICENAMES[e][2];return console.log(t+" not found in VOICENAMES"),"images/voices.svg"}function getVoiceSynthName(t){if(null==t)return console.log("getVoiceSynthName passed null name. Returning null"),null;if(""===t)console.log("getVoiceSynthName passed blank name. Returning "+DEFAULTVOICE),t=DEFAULTVOICE;else if("http"===t.slice(0,4))return t;for(var e=0;e<VOICENAMES.length;e++)if(VOICENAMES[e][0]===t||VOICENAMES[e][1]===t)return VOICENAMES[e][1];return console.log(t+" not found in VOICENAMES"),DEFAULTVOICE}function getTemperamentName(t){""===t&&(console.log("getTemperamentName passed blank name. Returning "+DEFAULTTEMPERAMENT),t=DEFAULTTEMPERAMENT);for(var e=0;e<TEMPERAMENTS.length;e++){if(TEMPERAMENTS[e][0].toLowerCase()===t.toLowerCase())return TEMPERAMENTS[e][1];if(TEMPERAMENTS[e][1].toLowerCase()===t.toLowerCase())return TEMPERAMENTS[e][1]}return console.log(t+" not found in TEMPERAMENTS"),DEFAULTTEMPERAMENT}function keySignatureToMode(t){if(""===t)return console.log("No key signature provided; reverting to C major."),["C","major"];t.toLowerCase()in MAQAMTABLE&&(t=MAQAMTABLE[t.toLowerCase()]);var e=!1;if(1===(s=t.split(" ")).length&&"m"===s[0][s[0].length-1]&&(e=!0,s[0]=s[0].slice(0,s[0].length-1)),s[0]in BTOFLAT)var i=BTOFLAT[s[0]];else if(s[0]in STOSHARP)i=STOSHARP[s[0]];else i=s[0];if(-1===NOTESSHARP.indexOf(i)&&-1===NOTESFLAT.indexOf(i)){console.log("Invalid key or missing name; reverting to C.");var s=(t="C "+t).split(" ");i="C"}if(e)return[i,"natural minor"];for(var l="",o=1;o<s.length;o++)""!==s[o]&&(""===l?l=s[o]:l+=" "+s[o]);return(l=""===l?"major":l.toLowerCase())in MUSICALMODES?[i,l]:(console.log("Invalid mode name: "+l+" reverting to major."),[i,"major"])}function getStepSizeUp(t,e,i,s){return _getStepSize(t,e,"up",i,s)}function getStepSizeDown(t,e,i,s){return _getStepSize(t,e,"down",i,s)}function getModeLength(t){return _buildScale(t)[1].length}function _getStepSize(t,e,i,s,l){if(void 0===l&&(l="equal"),"custom"===l)return s;var o=e,a=_buildScale(t),n=a[0],r=a[1];o in BTOFLAT?o=BTOFLAT[o]:o in STOSHARP&&(o=STOSHARP[o]);var c=n.indexOf(o);if(-1!==c)return"up"===i?r[c]:0<c?-r[c-1]:-last(r);if(-1===c&&o in EQUIVALENTFLATS&&(c=n.indexOf(EQUIVALENTFLATS[o])),-1===c&&o in EQUIVALENTSHARPS&&(c=n.indexOf(EQUIVALENTSHARPS[o])),-1===c&&o in EQUIVALENTNATURALS&&(c=n.indexOf(EQUIVALENTNATURALS[o])),-1!==c)return"up"===i?r[c]:0<c?-r[c-1]:-last(r);var h=0;if(-1!==(u=PITCHES.indexOf(o))){for(;-1===n.indexOf(o);){-1===(u=PITCHES.indexOf(o))&&(u=PITCHES2.indexOf(o)),"up"===i?(o=PITCHES[(u+=1)%12],h+=1):((u-=1)<0&&(u+=12),o=PITCHES[u],h-=1)}return h}if(-1===(u=PITCHES2.indexOf(o)))return console.log(o+" not found"),0;for(;-1===n.indexOf(o);){var u;-1===(u=PITCHES2.indexOf(o))&&(u=PITCHES.indexOf(o)),"up"===i?(o=PITCHES2[(u+=1)%12],h+=1):((u-=1)<0&&(u+=12),o=PITCHES2[u],h-=1)}return h}function _buildScale(t){var e=keySignatureToMode(t),i=e[0];if("CUSTOM"===e[1])var s=customMode;else s=MUSICALMODES[e[1]];if(-1!==NOTESFLAT.indexOf(i))var l=NOTESFLAT;else l=NOTESSHARP;var o=l.indexOf(i);-1===o&&(o=0);for(var a=[i],n=o,r=0;r<s.length;r++)n+=s[r],a.push(l[n%SEMITONES]);return[a,s]}function scaleDegreeToPitch(t,e){var i=_buildScale(t)[0];return e-=1,i[e%=i.length-1]}var SOLFMAPPER=["do","do","re","re","mi","fa","fa","sol","sol","la","la","ti"];function getScaleAndHalfSteps(t){var e=keySignatureToMode(t),i=e[0];if("CUSTOM"===e[1])var s=customMode;else s=MUSICALMODES[e[1]];var l=[];if(7===s.length)for(var o=0;o<s.length;o++){l.push(SOLFEGENAMES[o]);for(var a=1;a<s[o];a++)l.push("")}else if(7<s.length)for(o=0;o<s.length;o++){-1===l.indexOf(SOLFMAPPER[o])?l.push(SOLFMAPPER[o]):l.push(SOLFMAPPER[o]+SHARP);for(a=1;a<s[o];a++)l.push("")}else for(o=0;o<s.length;o++){for(var n=0,r=SOLFMAPPER[l.length];-1!==l.indexOf(r);)n+=1,r=SOLFMAPPER[l.length+n];l.push(r);for(a=1;a<s[o];a++)l.push("")}if(-1!==NOTESFLAT.indexOf(i))var c=NOTESFLAT;else c=NOTESSHARP;return i in EXTRATRANSPOSITIONS&&(i=EXTRATRANSPOSITIONS[i][0]),[c,l,i,e[1]]}function getInterval(t,e,i){var s=_buildScale(e),l=s[0],o=s[1];if(-1!==SOLFEGENAMES.indexOf(i)&&(i=FIXEDSOLFEGE[i]),i in BTOFLAT){i=BTOFLAT[i];var a=l.indexOf(i)}else if(i in STOSHARP){i=STOSHARP[i];a=l.indexOf(i)}else if(-1!==l.indexOf(i))a=l.indexOf(i);else{if(-1===(a=l.indexOf(i))&&i in EQUIVALENTFLATS&&(a=l.indexOf(EQUIVALENTFLATS[i])),-1===a&&i in EQUIVALENTSHARPS&&(a=l.indexOf(EQUIVALENTSHARPS[i])),-1===a&&i in EQUIVALENTNATURALS&&(a=l.indexOf(EQUIVALENTNATURALS[i])),-1===a)if(-1!==(n=PITCHES.indexOf(i))){for(;-1===l.indexOf(i);){var n=PITCHES.indexOf(i);0<t?(i=PITCHES[(n+=1)%12],1):((n-=1)<0&&(n+=12),i=PITCHES[n],1)}a=l.indexOf(i)}else{if(-1===(n=PITCHES2.indexOf(i)))return console.log(i+" not found"),0;for(;-1===l.indexOf(i);){n=PITCHES2.indexOf(i);0<t?(i=PITCHES2[(n+=1)%12],1):((n-=1)<0&&(n+=12),i=PITCHES2[n],1)}a=l.indexOf(i)}}if(0===t)return 0;if(0<t){var r=0;for(n=0;n<t;n++)r+=o[(a+n)%o.length];return r}for(r=0,n=0;t<n;n--){for(var c=(a+n-1)%o.length;c<0;)c+=o.length;r-=o[c]}return r}function getNoteFromInterval(t,e){var i=t.length,c=t.substring(0,1),h=t.substring(0,i-1),u=Number(t.slice(-1)),d=pitchToNumber(h,u,"C major"),f=["C","D","E","F","G","A","B"],p=[DOUBLEFLAT,FLAT,"",SHARP,DOUBLESHARP];function o(t){var e=INTERVALVALUES[t][0],i=(INTERVALVALUES[t][1],numberToPitch(d+e)),s=t.split(" "),l=f.indexOf(c)+Number(s[1])-1,o=u;6<l&&(l-=7,o=u+1);var a=f[l];if(i[0].substring(0,1)===a)return[i[0],o];if(i[0].substring(0,1)!==a){if((i=numberToPitchSharp(d+e))[0]===a)return[i[0],o];var n=getNumber(a,o)-getNumber(h,u),r=p.indexOf("");return[i=a+p[r+e-n]+"",o]}}return"major 2"===e||"major 3"===e||"major 6"===e||"major 7"===e||"perfect 4"===e||"perfect 5"===e||"perfect 8"===e||"perfect 1"===e?o(e):function(t){var e=t.split(" ");if("minor 2"===t||"minor 3"===t||"minor 6"===t||"minor 7"===t){var i=(s=o("major "+e[1]))[0].substring(1,s[0].length);i=0===(l=p.indexOf(i))?p[l]+FLAT:p[l-1]}if("diminished 4"===t||"diminished 5"===t||"diminished 8"===t){i=(s=o("perfect "+e[1]))[0].substring(1,s[0].length);i=0===(l=p.indexOf(i))?p[l]+FLAT:p[l-1]}if("augmented 2"===t||"augmented 3"===t||"augmented 6"===t||"augmented 7"===t){i=(s=o("major "+e[1]))[0].substring(1,s[0].length);i=4===(l=p.indexOf(i))?p[l]+SHARP:p[l+1]}if("augmented 1"===t||"augmented 4"===t||"augmented 5"===t||"augmented 8"===t){var s,l;i=(s=o("perfect "+e[1]))[0].substring(1,s[0].length);i=4===(l=p.indexOf(i))?p[l]+SHARP:p[l+1]}return[s[0].substring(0,1)+i+"",s[1]]}(e)}function calcNoteValueToDisplay(t,e,i){var s=t/e,l=null;if(void 0===i);else;l=s in NSYMBOLS?"1<br>&mdash;<br>"+s.toString()+"<br>"+NSYMBOLS[s]:reducedFraction(e,t),parseInt(s)<s&&(l=(l=parseInt(1.5*s))in NSYMBOLS?(e/t*l).toFixed(2)+"<br>&mdash;<br>"+l.toString()+"<br>"+NSYMBOLS[l]+".":(l=parseInt(1.75*s))in NSYMBOLS?(e/t*l).toFixed(2)+"<br>&mdash;<br>"+l.toString()+"<br>"+NSYMBOLS[l]+"..":reducedFraction(e,t));return l}function durationToNoteValue(t){for(var e=0;e<3;e++){var i=t*(2-1/Math.pow(2,e));if(-1!==POWER2.indexOf(i))return[i,e,null]}for(var s=t,l=1;l<POWER2.length;l++)if(s<POWER2[l]){s=POWER2[l-1];break}-1===POWER2.indexOf(s)&&(s=128);for(l=1;Math.floor(t/l)*l===t&&!(t/2<(l*=2)););return[1,0,[t/(l/=2),l],s]}function toFraction(t){if(1<t){var e=!0;t=1/t}else e=!1;for(var i=1,s=1,l=1;1e-8<Math.abs(i-t);)i<t?s+=1:(l+=1,s=parseInt(t*l)),i=s/l;if(e){var o=s;s=l,l=o}return[s,l]}function frequencyToPitch(t){if(t<A0)return["A",0];if(C8<t)return["C",8];for(var e=0,i=0;i<8800;i++){var s=A0*Math.pow(TWELVEHUNDRETHROOT2,i);if(t<1.0003*s&&.9997*s<t){e=i%100;var l=Math.floor(i/100);return[PITCHES[(l+PITCHES.indexOf("A"))%12],Math.floor((l+PITCHES.indexOf("A"))/12),e]}}return console.log("Could not find note/octave/cents for "+t),["?",-1,0]}function numberToPitch(t,e,i,s){if(void 0===e&&(e="equal"),t<0){for(var l=0;t<0;)t+=12,l+=1;if("equal"===e)return[PITCHES[(t+PITCHES.indexOf("A"))%12],Math.floor((t+PITCHES.indexOf("A"))/12)-l];var o=Math.floor(t-s)}else{if("equal"===e)return[PITCHES[(t+PITCHES.indexOf("A"))%12],Math.floor((t+PITCHES.indexOf("A"))/12)];o=Math.floor(t-s)}if("custom"!==e)return getNoteFromInterval(i,n=TEMPERAMENT[e].interval[o]);if(o+="",void 0!==TEMPERAMENT.custom[o][1])return[TEMPERAMENT.custom[o][1],TEMPERAMENT.custom[o][2]];for(t=0;t<12;t++){var a=""+t,n=TEMPERAMENT.equal.interval[t];TEMPERAMENT.custom[a]=[Math.pow(2,t/12),getNoteFromInterval(i,n)[0],getNoteFromInterval(i,n)[1]]}return[TEMPERAMENT.custom[o][1],TEMPERAMENT.custom[o][2]]}function numberToPitchSharp(t){if(t<0){for(var e=0;t<0;)t+=12,e+=1;return[PITCHES2[(t+PITCHES2.indexOf("A"))%12],Math.floor((t+PITCHES2.indexOf("A"))/12)-e]}return[PITCHES2[(t+PITCHES2.indexOf("A"))%12],Math.floor((t+PITCHES2.indexOf("A"))/12)]}function noteToPitchOctave(t){var e=t.length,i=last(t);return[t.substring(0,e-1),Number(i)]}function noteToFrequency(t,e){var i=noteToPitchOctave(t);return pitchToFrequency(i[0],i[1],0,e)}function pitchToFrequency(t,e,i,s){var l=pitchToNumber(t,e,s);return 0===i?A0*Math.pow(TWELTHROOT2,l):A0*Math.pow(TWELVEHUNDRETHROOT2,100*l+i)}function pitchToNumber(t,e,i){if("R"===t.toUpperCase())return 0;var s=0,l=t.length;if(1<l){if(2<l){var o=t.slice(l-2),a=t.substring(1,l);"bb"===o?(t=t.substring(0,1),s-=2):a===DOUBLEFLAT?(t=t.substring(0,1),s-=2):"*"===o||o===DOUBLESHARP?(t=t.substring(0,1),s+=2):"#b"!==o&&o!==SHARP+FLAT&&"b#"!==o&&o!==FLAT+SHARP||(t=t.slice(0,l-2))}if(1<t.length)"b"===(a=t.slice(l-1))||a===FLAT?(t=t.slice(0,l-1),s-=1):"#"!==a&&a!==SHARP||(t=t.slice(0,l-1),s+=1)}var n=0;if(-1!==PITCHES.indexOf(t))n=PITCHES.indexOf(t.toUpperCase());else{var r=getScaleAndHalfSteps(i);n=-1!==r[1].indexOf(t.toLowerCase())?r[1].indexOf(t.toLowerCase()):(console.log("pitch "+t+" not found."),0)}return 12*e+n-PITCHES.indexOf("A")+s}function noteIsSolfege(t){return void 0===SOLFEGECONVERSIONTABLE[t]}function getSolfege(t){return noteIsSolfege(t)?t:SOLFEGECONVERSIONTABLE[t]}function i18nSolfege(t){var e=_("ti la sol fa mi re do").split(" "),i=splitSolfege(t),s=SOLFNOTES.indexOf(i[0]);return-1!==s?e[s]+i[1]:(console.log(t+" not found."),t)}function splitSolfege(t){if(null!=t&&"string"==typeof t)if(-1!==SOLFNOTES.indexOf(t))var e=t,i="";else if("sol"===t.slice(0,3)){e="sol";if(4===t.length)i=t[3];else i=t[3]+t[4]}else{e=t.slice(0,2);if(3===t.length)i=t[2];else i=t[2]+t[3]}else e="sol",i="";return[e,i]}function getNumber(t,e){if(e<0)var i=0;else if(10<e)i=108;else i=12*(e-1);if((t=String(t)).substring(0,1)in NOTESTEP&&(i+=NOTESTEP[t.substring(0,1)],1<=t.length)){var s=t.substring(1);"bb"===s||s===DOUBLEFLAT?i-=2:"##"===s||"*"===s||s===DOUBLESHARP?i+=2:"b"===s||s===FLAT?i-=1:"#"!==s&&s!==SHARP||(i+=1)}return i}function getNumNote(t,e){var i=t+e,s=Math.floor(i/12),l=NOTESTABLE[i%=12];return"ti"===l[i]&&(s-=1),[l,s+1]}function isInt(t){return!isNaN(t)&&parseInt(Number(t))===t&&!isNaN(parseInt(t,10))}function reducedFraction(t,e){function i(t,e){return s.apply(this,arguments)}var s;greatestCommonMultiple=(s=function(t,e){return 0===e?t:greatestCommonMultiple(e,t%e)},i.toString=function(){return s.toString()},i);var l=greatestCommonMultiple(t,e);return-1!==[1,2,4,8,16].indexOf(e/l)?t/l+"<br>&mdash;<br>"+e/l+"<br>"+NSYMBOLS[e/l]:t/l+"<br>&mdash;<br>"+e/l+"<br><br>"}function getCustomNote(t){t instanceof Array&&(t=t[0]);var e="";-1!==t.indexOf("(")&&(e=t.substring(t.indexOf("("),t.length));var i=(t=t.replace(e,"")).replace("do","").replace("re","").replace("mi","").replace("fa","").replace("sol","").replace("la","").replace("ti","").replace("A","").replace("B","").replace("C","").replace("D","").replace("E","").replace("F","").replace("G","");switch(t=t.replace(i,""),i){case"bb":case DOUBLEFLAT:t=t+""+e;break;case"b":case FLAT:t=t+""+e;break;case"##":case"*":case DOUBLESHARP:t=t+""+e;break;case"#":case SHARP:t=t+""+e;break;default:t=t+i+e}return t}function getNote(t,e,i,s,l,o,a,n){void 0===n&&(n="equal"),">"===t.substr(-1)&&(e=parseInt(t.slice(t.indexOf(">")+1,t.indexOf("/")-1)),t=t.substr(0,t.indexOf("<")));var r=!1,c=!1,h=!1;if("number"!=typeof t&&("rest"===t.toLowerCase().substr(0,4)||"r"===t.toLowerCase().substr(0,4)))return["R",""];if(e=Math.round(e),void 0===i&&(i=0),i=Math.round(i),"number"==typeof t&&(t=t.toString()),"equal"===n){var u=t.replace("do","").replace("re","").replace("mi","").replace("fa","").replace("sol","").replace("la","").replace("ti","").replace("A","").replace("B","").replace("C","").replace("D","").replace("E","").replace("F","").replace("G","");switch(t=t.replace(u,""),u){case"bb":case DOUBLEFLAT:t+="b",c=!0,i-=1;break;case"b":case FLAT:t+="b",c=!0;break;case"##":case"*":case DOUBLESHARP:t+="#",h=!0,i+=1;break;case"#":case SHARP:t+="#",h=!0}if(h?t in STOSHARP&&(t=STOSHARP[t]):t in BTOFLAT?t=BTOFLAT[t]:t in STOSHARP&&(t=STOSHARP[t]),t in EXTRATRANSPOSITIONS){e+=EXTRATRANSPOSITIONS[t][1];var d=EXTRATRANSPOSITIONS[t][0]}else if(-1!==NOTESSHARP.indexOf(t.toUpperCase()))d=t.toUpperCase();else if(-1!==NOTESFLAT.indexOf(t))d=t;else if(-1!==NOTESFLAT2.indexOf(t))d=NOTESFLAT[notesFlat2.indexOf(t)];else{if(-1!==["#",SHARP,FLAT,"b"].indexOf(t.substr(-1))&&(r=!0),s=s||"C major",l)var f=getScaleAndHalfSteps(s);else f=getScaleAndHalfSteps("C major");var p=f[0],b=f[1],m=f[2],g=f[3];if(l)-1===(k=p.indexOf(m))&&(console.log("WARNING: Key "+m+" not found in "+p+". Using default of C"),k=0,p=NOTESSHARP),5<k&&(i-=12);else var k=0;if(r&&("#"===t.substr(-1)?k+=1:t.substr(-1)===SHARP?k+=1:t.substr(-1)===FLAT?k-=1:"b"===t.substr(-1)&&(k-=1)),-1!==b.indexOf(t.substr(0,1).toLowerCase()))var v=t.substr(0,1).toLowerCase();else if(-1!==b.indexOf(t.substr(0,2).toLowerCase()))v=t.substr(0,2).toLowerCase();else if(-1!==b.indexOf(t.substr(0,3).toLowerCase()))v=t.substr(0,3).toLowerCase();else{var y=_("ti la sol fa mi re do").split(" ");if(-1!==y.indexOf(t.substr(0,1).toLowerCase()))v=SOLFNOTES[y.indexOf(t.substr(0,2).toLowerCase())];else if(-1!==y.indexOf(t.substr(0,2).toLowerCase()))v=SOLFNOTES[y.indexOf(t.substr(0,2).toLowerCase())];else if(-1!==y.indexOf(t.substr(0,3).toLowerCase()))v=SOLFNOTES[y.indexOf(t.substr(0,3).toLowerCase())];else v=t.substr(0,2).toLowerCase()}if(l)switch(g){case"dorian":0<(T=SOLFEGENAMES.indexOf(v))&&(i+=12),i-=12,6<(T+=6)&&(T-=7),v=SOLFEGENAMES[T];break;case"phrygian":1<(T=SOLFEGENAMES.indexOf(v))&&(i+=12),6<(T+=5)&&(T-=7),v=SOLFEGENAMES[T];break;case"lydian":2<(T=SOLFEGENAMES.indexOf(v))&&(i+=12),6<(T+=4)&&(T-=7),v=SOLFEGENAMES[T];break;case"mixolydian":3<(T=SOLFEGENAMES.indexOf(v))&&(i+=12),6<(T+=3)&&(T-=7),v=SOLFEGENAMES[T];break;case"minor":case"aeolian":4<(T=SOLFEGENAMES.indexOf(v))&&(i+=12),6<(T+=2)&&(T-=7),v=SOLFEGENAMES[T];break;case"locrian":var T;5<(T=SOLFEGENAMES.indexOf(v))&&(i+=12),6<(T+=1)&&(T-=7),v=SOLFEGENAMES[T]}if(-1===b.indexOf(v))return console.log(v),console.log(b.indexOf(t)),console.log("WARNING: Note ["+t+"] not found in "+b+". Returning REST"),null!=a&&a(INVALIDPITCH,null),["R",""];var L=b.indexOf(v)+k;11<L?(L-=12,e+=1):L<0&&(L+=12,e-=1),(d=p[L])in EXTRATRANSPOSITIONS&&(e+=EXTRATRANSPOSITIONS[d][1],d=EXTRATRANSPOSITIONS[d][0])}if(i&&0!==i){if(i<0)var w=-Math.floor(-i/12),B=- -i%12;else w=Math.floor(i/12),B=i%12;e+=w,0<B?-1!==NOTESSHARP.indexOf(d)?(T=NOTESSHARP.indexOf(d),(T+=B)<0?(T+=12,e-=1):11<T&&(T-=12,e+=1),d=NOTESSHARP[T]):-1!==NOTESFLAT.indexOf(d)?(T=NOTESFLAT.indexOf(d),(T+=B)<0?(T+=12,e-=1):11<T&&(T-=12,e+=1),d=NOTESFLAT[T]):console.log("note not found? "+d):B<0&&(-1!==NOTESFLAT.indexOf(d)?(T=NOTESFLAT.indexOf(d),(T+=B)<0?(T+=12,e-=1):11<T&&(T-=12,e+=1),d=NOTESFLAT[T]):-1!==NOTESSHARP.indexOf(d)?(T=NOTESSHARP.indexOf(d),(T+=B)<0?(T+=12,e-=1):11<T&&(T-=12,e+=1),d=NOTESSHARP[T]):console.log("note not found? "+d))}switch(getSharpFlatPreference(s)){case"flat":d in EQUIVALENTFLATS&&(d=EQUIVALENTFLATS[d]);break;case"sharp":d in EQUIVALENTSHARPS&&(d=EQUIVALENTSHARPS[d]);break;case"natural":d in EQUIVALENTNATURALS&&(d=EQUIVALENTNATURALS[d])}if(null!=o)switch(o){case-1:d in EQUIVALENTFLATS&&(d=EQUIVALENTFLATS[d]);break;case 1:d in EQUIVALENTSHARPS&&(d=EQUIVALENTSHARPS[d])}h?d in EQUIVALENTSHARPS&&(d=EQUIVALENTSHARPS[d]):c&&d in EQUIVALENTFLATS&&(d=EQUIVALENTFLATS[d])}else if("custom"===n){d=getCustomNote(t);for(var x in TEMPERAMENT.custom)if("pitchNumber"!==x&&d===TEMPERAMENT.custom[x][1]){var S=Number(x);break}if(void 0===S)return getNote(t,e,i,s,l,o,a);var C=e,A=TEMPERAMENT.custom.pitchNumber;if(0!==i){if(i<0)w=-Math.floor(-i/A),B=- -i%A;else w=Math.floor(i/A),B=i%A;C+=w,S+=B}S<0?(S+=A,C-=1):A<=S&&(S-=A,C+=1),S+="",d=TEMPERAMENT.custom[S][1],e=C}else{u=t.replace("do","").replace("re","").replace("mi","").replace("fa","").replace("sol","").replace("la","").replace("ti","").replace("A","").replace("B","").replace("C","").replace("D","").replace("E","").replace("F","").replace("G","");switch(t=t.replace(u,""),-1!==SOLFEGENAMES.indexOf(t)&&(t=FIXEDSOLFEGE[t]),u){case"bb":case DOUBLEFLAT:t+="";break;case"b":case FLAT:t+="b";break;case"##":case"*":case DOUBLESHARP:t+="";break;case"#":case SHARP:t+="#"}d=t;if(i&&0!==i){if(i<0)w=-Math.floor(-i/12),B=- -i%12;else w=Math.floor(i/12),B=i%12;if(e+=w,0<B){var N=d+""+e;for(var P in INTERVALVALUES)if(B===INTERVALVALUES[P][0]){var I=getNoteFromInterval(N,P);break}}else if(B<0){N=d+""+(e-1);for(var P in INTERVALVALUES)if(12+B===INTERVALVALUES[P][0]){I=getNoteFromInterval(N,P);break}}else if(0===B)I=getNoteFromInterval(N=d+""+e,"perfect 1");d=I[0],e=I[1]}}return e<1?[d,1]:10<e?[d,10]:[d,e]}function showButtonHighlight(t,e,i,s,l,o){return platform.FFOS?{}:showMaterialHighlight(t,e,i,s,l,o)}calcOctave=function(e,i,t,s){if("number"==typeof i)return Math.max(1,Math.min(Math.floor(i),9));var l,o,a,n;o=getNumber(l=-1!==SOLFEGENAMES1.indexOf(s)?FIXEDSOLFEGE1[s]:s,e),stepUpCurrentNote=getNumber(l,e+1),stepDownCurrentNote=getNumber(l,e-1),null!=t?t=(t=t[0]).substring(0,t.length-1):lastNotePlated="G",a=getNumber(t,e);var r=Math.abs(a-o),c=Math.abs(a-stepUpCurrentNote),h=Math.abs(a-stepDownCurrentNote);switch((r<=5||isNaN(r))&&(n=e),5<r&&5<c&&h<5&&(n=Math.max(e-1,1)),5<r&&c<5&&5<h&&(n=Math.min(e+1,9)),5<r&&5<c&&5<h&&(n=e),i){case _("current"):case"current":return n;case _("next"):case"next":return Math.min(n+1,10);case _("previous"):case"previous":return Math.max(n-1,1);default:try{return Math.floor(Number(i))}catch(t){return console.log("cannot convert "+i+" to a number"),e}}},calcOctaveInterval=function(t){var e=0;switch(t){case 1:case _("next"):case"next":e=1;break;case-1:case _("previous"):case"previous":e=-1;break;case _("current"):case"current":case 0:e=0;break;case 2:e=2;break;case-2:e=-2;break;default:console.log("Interval octave must be between -2 and 2."),e=0}return e},convertFactor=function(t){switch(t){case.0625:return"16";case.125:return"8";case.09375:return"16.";case.1875:return"8.";case.21875:return"8..";case.25:return"4";case.3125:return"4 16";case.375:return"4.";case.4375:return"4..";case.5:return"2";case.5625:return"2 16";case.675:return"2 8";case.6875:return"2 8 16";case.75:return"2.";case.8125:return"2 4 16";case.875:return"2..";case.9375:return"2 4 8 16";case 1:return"1";default:return null}},modeMapper=function(t,e){switch(t=t.toLowerCase(),e=e.toLowerCase()){case"ionian":e="major";break;case"dorian":switch(t){case"c":t="a"+SHARP,e="major";break;case"d":t="c",e="major";break;case"e":t="d",e="major";break;case"f":t="c",e="minor";break;case"g":t="f",e="major";break;case"a":t="g",e="major";break;case"b":t="a",e="major";break;case"c"+SHARP:case"d"+SHARP:t="b",e="major";break;case"f"+SHARP:t="f",e="major";break;case"g"+SHARP:t="b",e="major";break;case"a"+SHARP:t="g"+SHARP,e="major";break;case"d"+FLAT:case"e"+FLAT:t="e"+FLAT,e="minor";break;case"g"+FLAT:t="d",e="minor";break;case"a"+FLAT:t="e"+FLAT,e="minor";break;case"b"+FLAT:t="f",e="minor"}break;case"phrygian":switch(t){case"c":t="g"+SHARP,e="major";break;case"d":t="a"+SHARP,e="major";break;case"e":t="c",e="major";break;case"f":t="b",e="major";break;case"g":t="c",e="minor";break;case"a":t="f",e="major";break;case"b":t="g",e="major";break;case"c"+SHARP:t="a",e="major";break;case"d"+SHARP:t="b",e="major";break;case"f"+SHARP:t="d",e="major";break;case"g"+SHARP:t="e",e="major";break;case"a"+SHARP:t="b",e="major";break;case"d"+FLAT:t="g"+FLAT,e="minor";break;case"e"+FLAT:t="e"+FLAT,e="minor";break;case"g"+FLAT:t="d",e="major";break;case"a"+FLAT:t="d"+FLAT,e="minor";break;case"b"+FLAT:t="e"+FLAT,e="minor"}break;case"lydian":switch(t){case"c":t="g",e="major";break;case"d":t="a",e="major";break;case"e":t="b",e="major";break;case"f":t="c",e="major";break;case"g":t="d",e="major";break;case"a":t="e",e="major";break;case"b":t="b",e="major";break;case"c"+SHARP:t="g"+SHARP,e="major";break;case"d"+SHARP:t="a"+SHARP,e="major";break;case"f"+SHARP:t="b",e="major";break;case"g"+SHARP:t="c",e="minor";break;case"a"+SHARP:t="f",e="major";break;case"d"+FLAT:t="f",e="minor";break;case"e"+FLAT:t="g",e="minor";break;case"g"+FLAT:t="d"+FLAT,e="minor";break;case"a"+FLAT:t="c",e="minor";break;case"b"+FLAT:t="d",e="minor"}break;case"mixolydian":switch(t){case"c":t="f",e="major";break;case"d":t="g",e="major";break;case"e":t="a",e="major";break;case"f":t="a"+SHARP,e="major";break;case"g":t="c",e="major";break;case"a":t="d",e="major";break;case"b":t="e",e="major";break;case"c"+SHARP:t="b",e="major";break;case"d"+SHARP:t="g"+SHARP,e="major";break;case"f"+SHARP:case"g"+SHARP:t="b",e="major";break;case"a"+SHARP:t="c",e="minor";break;case"d"+FLAT:t="e"+FLAT,e="minor";break;case"e"+FLAT:t="f",e="minor";break;case"g"+FLAT:case"a"+FLAT:t="e"+FLAT,e="minor";break;case"b"+FLAT:t="c",e="minor"}break;case"locrian":switch(t){case"c":t="b",e="major";break;case"d":t="c",e="minor";break;case"e":t="f",e="major";break;case"f":t="b",e="major";break;case"g":t="g"+SHARP,e="major";break;case"a":t="a"+SHARP,e="major";break;case"b":t="c",e="major";break;case"c"+SHARP:t="d",e="major";break;case"d"+SHARP:t="e",e="major";break;case"f"+SHARP:t="g",e="major";break;case"g"+SHARP:t="a ",e="major";break;case"a"+SHARP:t="b",e="major";break;case"d"+FLAT:t="d",e="major";break;case"e"+FLAT:t="d"+FLAT,e="minor";break;case"g"+FLAT:t="f",e="minor";break;case"a"+FLAT:t="g"+FLAT,e="minor";break;case"b"+FLAT:t="d"+FLAT,e="minor"}break;case"aeolian":case"natural minor":e="minor"}return[t,e]},window.platform={android:/Android/i.test(navigator.userAgent),FF:/Firefox/i.test(navigator.userAgent),mobile:/Mobi/i.test(navigator.userAgent),tablet:/Tablet/i.test(navigator.userAgent)},platform.androidWebkit=platform.android&&!platform.FF,platform.FFOS=platform.FF&&(platform.mobile||platform.tablet)&&!platform.android,console.log("On platform: ",platform),window.platformColor={blockText:"#282828",paletteColors:{widgets:["#7CD622","#57AD02","#77C428","#B4EB7D"],pitch:["#7CD622","#57AD02","#77C428","#B4EB7D"],rhythm:["#FE994F","#E86B0E","#FF8B2D","#FEC092"],meter:["#FE994F","#E86B0E","#FF8B2D","#FEC092"],tone:["#3EDCDD","#1DBCBD","#25C3C0","#A1EEEF"],ornament:["#3EDCDD","#1DBCBD","#25C3C0","#A1EEEF"],intervals:["#7CD622","#57AD02","#77C428","#B4EB7D"],volume:["#3EDCDD","#1DBCBD","#25C3C0","#A1EEEF"],drum:["#3EDCDD","#1DBCBD","#25C3C0","#A1EEEF"],graphics:["#92A9FF","#5370DC","#728FF9","#CDD8FF"],turtle:["#92A9FF","#5370DC","#728FF9","#CDD8FF"],pen:["#92A9FF","#5370DC","#728FF9","#CDD8FF"],boxes:["#FFBF00","#DAAF30","#DAA926","#FFE391"],action:["#FFBF00","#DAAF30","#DAA926","#FFE391"],media:["#FF664B","#EA4326","#FF5942","#FFB9E2"],number:["#FF6EA1","#FF2C76","#FF5293","#FFCDDF"],boolean:["#D97DF5","#B653D3","#C96DF3","#EDC6A3"],flow:["#D98A43","#B7651A","#D68136","#ECC6A4"],sensors:["#FF664B","#EA4326","#FF5942","#FFB9E2"],extras:["#C4C4C4","#A0A0A0","#B0B0B0","#D0D0D0"],myblocks:["#FFBF00","#DAAF30","#DAA926","#FFE391"],heap:["#D98A43","#B7651A","#D68136","#ECC6A4"],ensemble:["#92A9FF","#5370DC","#728FF9","#CDD8FF"]},disconnected:"#C4C4C4",header:(platform.FF,"#4DA6FF"),aux:"#1A8CFF",sub:"#8CC6FF",doHeaderShadow:!platform.FF,rule:"#E2E2E2",ruleColor:"#E2E2E2",trashColor:"#C0C0C0",trashBorder:"#808080",trashActive:"#FF0000",background:"#F9F9F9",paletteSelected:"#F3F3F3",paletteBackground:"#FFFFFF",paletteText:"#666666",rulerHighlight:"#FFBF00",selectorBackground:"#8CC6FF",selectorSelected:"#1A8CFF",labelColor:"#a0a0a0",tupletBackground:"#c0c0c0",drumBackground:"#3EDCDD",pitchBackground:"#7CD622",graphicsBackground:"#92A9FF",drumLabelBackground:"#25C3C0",pitchLabelBackground:"#77C428",graphicsLabelBackground:"#728FF9",rhythmcellcolor:"#c8c8c8",hitAreaGraphicsBeginFill:"#FFF",orange:"#e37a00",piemenuBasic:["#3ea4a3","#60bfbc","#1d8989","#60bfbc","#1d8989"],exitWheelcolors:["#808080","#c0c0c0"],exitWheelcolors2:["#808080","#a08080","#80a080"],pitchWheelcolors:["#77c428","#93e042","#77c428","#5ba900","#77c428","#93e042","#adfd55"],accidentalsWheelcolors:["#77c428","#93e042","#77c428","#5ba900","#77c428"],accidentalsWheelcolorspush:"#c0c0c0",octavesWheelcolors:["#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#c0c0c0","#c0c0c0","#c0c0c0","#c0c0c0","#c0c0c0","#c0c0c0"],blockLabelsWheelcolors:["#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6"],noteValueWheelcolors:["#ffb2bc","#ffccd6"],tabsWheelcolors:["#ffb2bc","#ffccd6"],numberWheelcolors:["#ffb2bc","#ffccd6"],piemenuBasicundefined:["#77c428","#93e042","#5ba900"],booleanWheelcolors:["#d3cf76","#b8b45f"],piemenuVoicesColors:["#3ea4a3","#60bfbc","#1d8989","#60bfbc","#1d8989"],intervalNameWheelcolors:["#77c428","#93e042","#77c428","#5ba900","#93e042"],intervalWheelcolors:["#77c428","#93e042","#77c428","#5ba900","#93e042"],modeWheelcolors:["#77c428","#93e042"],modeGroupWheelcolors:["#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#ffb2bc","#ffccd6","#c0c0c0","#c0c0c0","#c0c0c0","#c0c0c0","#c0c0c0","#c0c0c0"],modePieMenusIfColorPush:"#4b8b0e",modePieMenusElseColorPush:"#66a62d",wheelcolors:["#808080","#909090","#808080","#909090","#707070"]},document.querySelector("meta[name=theme-color]").content=platformColor.header;var POLYCOUNT=3,NOISENAMES=[[_("white noise"),"noise1","images/synth.svg","electronic"],[_("brown noise"),"noise2","images/synth.svg","electronic"],[_("pink noise"),"noise3","images/synth.svg","electronic"]],VOICENAMES=[[_("piano"),"piano","images/voices.svg","string"],[_("violin"),"violin","images/voices.svg","string"],[_("cello"),"cello","images/voices.svg","string"],[_("bass"),"bass","images/voices.svg","string"],[_("guitar"),"guitar","images/voices.svg","string"],[_("acoustic guitar"),"acoustic guitar","images/voices.svg","string"],[_("flute"),"flute","images/voices.svg","wind"],[_("clarinet"),"clarinet","images/voices.svg","wind"],[_("saxophone"),"saxophone","images/voices.svg","wind"],[_("tuba"),"tuba","images/voices.svg","wind"],[_("trumpet"),"trumpet","images/voices.svg","wind"],[_("banjo"),"banjo","images/voices.svg","string"],[_("koto"),"koto","images/voices.svg","string"],[_("dulcimer"),"dulcimer","images/voices.svg","string"],[_("electric guitar"),"electric guitar","images/voices.svg","string"],[_("bassoon"),"bassoon","images/voices.svg","string"],[_("celeste"),"celeste","images/voices.svg","string"],[_("xylophone"),"xylophone","images/8_bellset_key_6.svg","precussion"],[_("electronic synth"),"electronic synth","images/synth.svg","electronic"],[_("sine"),"sine","images/synth.svg","electronic"],[_("square"),"square","images/synth.svg","electronic"],[_("sawtooth"),"sawtooth","images/synth.svg","electronic"],[_("triangle"),"triangle","images/synth.svg","electronic"],[_("custom"),"custom","images/synth.svg","electronic"],[_("vibraphone"),"vibraphone","images/synth.svg","electronic"]],DRUMNAMES=[[_("snare drum"),"snare drum","images/snaredrum.svg","sn","drum"],[_("kick drum"),"kick drum","images/kick.svg","hh","drum"],[_("tom tom"),"tom tom","images/tom.svg","tomml","drum"],[_("floor tom"),"floor tom tom","images/floortom.svg","tomfl","drum"],[_("cup drum"),"cup drum","images/cup.svg","hh","drum"],[_("darbuka drum"),"darbuka drum","images/darbuka.svg","hh","drum"],[_("taiko"),"japanese drum","images/tom.svg","hh","drum"],[_("hi hat"),"hi hat","images/hihat.svg","hh","bell"],[_("ride bell"),"ride bell","images/ridebell.svg","rb","bell"],[_("cow bell"),"cow bell","images/cowbell.svg","cb","bell"],[_("triangle bell"),"triangle bell","images/trianglebell.svg","tri","bell"],[_("finger cymbals"),"finger cymbals","images/fingercymbals.svg","cymca","bell"],[_("chime"),"chime","images/chime.svg","cymca","bell"],[_("gong"),"gong","images/gong.svg","cymca","bell"],[_("clang"),"clang","images/clang.svg","cymca","effect"],[_("crash"),"crash","images/crash.svg","cymca","effect"],[_("bottle"),"bottle","images/bottle.svg","hh","effect"],[_("clap"),"clap","images/clap.svg","hc","effect"],[_("slap"),"slap","images/slap.svg","vibs","effect"],[_("splash"),"splash","images/splash.svg","hh","effect"],[_("bubbles"),"bubbles","images/bubbles.svg","hh","effect"],[_("raindrop"),"raindrop","images/bubbles.svg","hh","effect"],[_("cat"),"cat","images/cat.svg","hh","animal"],[_("cricket"),"cricket","images/cricket.svg","hh","animal"],[_("dog"),"dog","images/dog.svg","hh","animal"],[_("duck"),"duck","images/duck.svg","hh","animal"]],EFFECTSNAMES=["duck","dog","cricket","cat","bubbles","splash","bottle"],SOUNDSAMPLESDEFINES=["samples/violin","samples/cello","samples/flute","samples/guitar","samples/clarinet","samples/saxophone","samples/tuba","samples/trumpet","samples/bass","samples/bottle","samples/clap","samples/darbuka","samples/hihat","samples/splash","samples/bubbles","samples/cowbell","samples/dog","samples/kick","samples/tom","samples/cat","samples/crash","samples/duck","samples/ridebell","samples/triangle","samples/chime","samples/cricket","samples/fingercymbal","samples/slap","samples/clang","samples/cup","samples/floortom","samples/snare","samples/piano","samples/acguit","samples/banjo","samples/bassoon","samples/celeste","samples/raindrop","samples/koto","samples/gong","samples/dulcimer","samples/electricguitar","samples/xylophone","samples/vibraphone","samples/japanese_drum"],DEFAULTSYNTHVOLUME={flute:90,"electronic synth":90,piano:100,banjo:90,koto:70,"kick drum":100,"tom tom":100,"floor tom":100,"cup drum":100,"darbuka drum":100,"hi hat":100,"ride bell":100,"cow bell":100,"triangle bell":60,"finger cymbals":70,chime:90,gong:70,clang:70,crash:90,clap:90,slap:60,vibraphone:100,xylophone:100,"japanese drum":90},SAMPLECENTERNO={piano:["C4",39],violin:["C5",51],cello:["C3",27],bass:["C2",15],guitar:["C4",39],"acoustic guitar":["C4",39],flute:["F#5",57],saxophone:["C5",51],clarinet:["C4",39],tuba:["C4",39],trumpet:["C3",27],banjo:["C6",63],koto:["C5",51],dulcimer:["C4",39],"electric guitar":["C3",27],bassoon:["D4",41],celeste:["C3",27],vibraphone:["C5",51],xylophone:["C4",39]};function validateAndSetParams(t,e){if(t&&null!==t&&e&&void 0!==e)for(var i in t)i in e&&void 0!==e[i]&&(t[i]=e[i]);return t}var instruments={0:{}},instrumentsSource={},instrumentsEffects={0:{}},instrumentsFilters={0:{}};function Synth(){var a={sine:1,triangle:1,sawtooth:1,square:1,pluck:1,noise1:1,noise2:1,noise3:1,poly:1,"simple 1":1,"simple 2":1,"simple 3":1,"simple 4":1,custom:1},l={amsynth:1,fmsynth:1,duosynth:1};this.tone=new Tone,Tone.Buffer.onload=function(){console.log("sample loaded")},this.samples=null,this.samplesuffix="_SAMPLE",this.samplesManifest=null,this.changeInTemperament=!1,this.inTemperament="equal",this.startingPitch="C4",this.noteFrequencies={},this.temperamentChanged=function(t,e){var i,s=e,l=TEMPERAMENT[t],o=s.length,a=pitchToNumber(s.substring(0,o-1),s.slice(-1),"C major");startPitchObj=numberToPitch(a),(s=(startPitchObj[0]+startPitchObj[1]).toString()).substring(1,o-1)===FLAT||"b"===s.substring(1,o-1)?s=s.replace(FLAT,"b"):s.substring(1,o-1)!==SHARP&&"#"!==s.substring(1,o-1)||(s=s.replace(SHARP,"#"));var n=Tone.Frequency(s).toFrequency();for(var r in this.noteFrequencies=(_defineProperty(i={},e.substring(0,o-1),[Number(e.slice(-1)),n]),_defineProperty(i,getNoteFromInterval(e,"minor 2")[0],[getNoteFromInterval(e,"minor 2")[1],l["minor 2"]*n]),_defineProperty(i,getNoteFromInterval(e,"augmented 1")[0],[getNoteFromInterval(e,"augmented 1")[1],l["augmented 1"]*n]),_defineProperty(i,getNoteFromInterval(e,"major 2")[0],[getNoteFromInterval(e,"major 2")[1],l["major 2"]*n]),_defineProperty(i,getNoteFromInterval(e,"minor 3")[0],[getNoteFromInterval(e,"minor 3")[1],l["minor 3"]*n]),_defineProperty(i,getNoteFromInterval(e,"augmented 2")[0],[getNoteFromInterval(e,"augmented 2")[1],l["augmented 2"]*n]),_defineProperty(i,getNoteFromInterval(e,"major 3")[0],[getNoteFromInterval(e,"major 3")[1],l["major 3"]*n]),_defineProperty(i,getNoteFromInterval(e,"augmented 3")[0],[getNoteFromInterval(e,"augmented 3")[1],l["augmented 3"]*n]),_defineProperty(i,getNoteFromInterval(e,"diminished 4")[0],[getNoteFromInterval(e,"diminished 4")[1],l["diminished 4"]*n]),_defineProperty(i,getNoteFromInterval(e,"perfect 4")[0],[getNoteFromInterval(e,"perfect 4")[1],l["perfect 4"]*n]),_defineProperty(i,getNoteFromInterval(e,"augmented 4")[0],[getNoteFromInterval(e,"augmented 4")[1],l["augmented 4"]*n]),_defineProperty(i,getNoteFromInterval(e,"diminished 5")[0],[getNoteFromInterval(e,"diminished 5")[1],l["diminished 5"]*n]),_defineProperty(i,getNoteFromInterval(e,"perfect 5")[0],[getNoteFromInterval(e,"perfect 5")[1],l["perfect 5"]*n]),_defineProperty(i,getNoteFromInterval(e,"augmented 5")[0],[getNoteFromInterval(e,"augmented 5")[1],l["augmented 5"]*n]),_defineProperty(i,getNoteFromInterval(e,"minor 6")[0],[getNoteFromInterval(e,"minor 6")[1],l["minor 6"]*n]),_defineProperty(i,getNoteFromInterval(e,"major 6")[0],[getNoteFromInterval(e,"major 6")[1],l["major 6"]*n]),_defineProperty(i,getNoteFromInterval(e,"augmented 6")[0],[getNoteFromInterval(e,"augmented 6")[1],l["augmented 6"]*n]),_defineProperty(i,getNoteFromInterval(e,"minor 7")[0],[getNoteFromInterval(e,"minor 7")[1],l["minor 7"]*n]),_defineProperty(i,getNoteFromInterval(e,"major 7")[0],[getNoteFromInterval(e,"major 7")[1],l["major 7"]*n]),_defineProperty(i,getNoteFromInterval(e,"augmented 7")[0],[getNoteFromInterval(e,"augmented 7")[1],l["augmented 7"]*n]),_defineProperty(i,getNoteFromInterval(e,"diminished 8")[0],[getNoteFromInterval(e,"diminished 8")[1],l["diminished 8"]*n]),_defineProperty(i,getNoteFromInterval(e,"perfect 8")[0],[getNoteFromInterval(e,"perfect 8")[1],l["perfect 8"]*n]),i),this.noteFrequencies)if(r.substring(1,r.length)===FLAT||"b"===r.substring(1,r.length)){var c=r.substring(0,1)+"b";this.noteFrequencies[c]=this.noteFrequencies[r],delete this.noteFrequencies[r]}else if(r.substring(1,r.length)===SHARP||"#"===r.substring(1,r.length)){c=r.substring(0,1)+"#";this.noteFrequencies[c]=this.noteFrequencies[r],delete this.noteFrequencies[r]}this.changeInTemperament=!1},this.getFrequency=function(t,e){return this._getFrequency(t,e)},this._getFrequency=function(t,e,i){if(e&&(void 0===i?this.temperamentChanged(this.inTemperament,this.startingPitch):this.temperamentChanged(i,this.startingPitch)),"equal"===this.inTemperament){if("string"==typeof t){var s=t.length;return pitchToFrequency(o=t.substring(0,s-1),a=Number(t.slice(-1)),0,null)}if("number"==typeof t)return t;var l=[];for(c=0;c<t.length;c++)if("string"==typeof t[c]){s=t[c].length;var o=t[c].substring(0,s-1),a=Number(t[c].slice(-1));l.push(pitchToFrequency(o,a,0,null))}else l.push(t[c]);return l}function n(t){var e=t.length;for(var i in r.noteFrequencies)if(i===t.substring(0,e-1)){if(r.noteFrequencies[i][0]===Number(t.slice(-1)))return r.noteFrequencies[i][1];var s=Number(t.slice(-1))-r.noteFrequencies[i][0];return r.noteFrequencies[i][1]*Math.pow(2,s)}}var r=this;if("string"==typeof t)return n(t);if("object"!==_typeof(t))return t;l=[];for(var c=0;c<t.length;c++)"string"==typeof t[c]?l.push(n(t[c])):l.push(t[c]);return l},this.getCustomFrequency=function(t){function e(t){var e=t.slice(-1);t=getCustomNote(t.substring(0,t.length-1));var i=n.startingPitch,s=pitchToFrequency(i.substring(0,i.length-1),i.slice(-1),0,"C Major");if("number"==typeof t)t=t;else for(var l in TEMPERAMENT.custom)if("pitchNumber"!==l&&t==TEMPERAMENT.custom[l][1]){var o=e-TEMPERAMENT.custom[l][2];return Number(TEMPERAMENT.custom[l][0]*s*Math.pow(OCTAVERATIO,o))}}if("string"==typeof t)return e(t);if("object"!==_typeof(t))return t;for(var i=[],s=0;s<t.length;s++)"string"==typeof t[s]?i.push(e(t[s])):i.push(t[s]);return i},this.resume=function(){this.tone.context.resume()},this.loadSamples=function(){if(this.samplesManifest={voice:[{name:"piano",data:PIANO_SAMPLE},{name:"violin",data:VIOLIN_SAMPLE},{name:"cello",data:CELLO_SAMPLE},{name:"flute",data:FLUTE_SAMPLE},{name:"clarinet",data:CLARINET_SAMPLE},{name:"saxophone",data:SAXOPHONE_SAMPLE},{name:"trumpet",data:TRUMPET_SAMPLE},{name:"tuba",data:TUBA_SAMPLE},{name:"guitar",data:GUITAR_SAMPLE},{name:"acoustic guitar",data:ACOUSTIC_GUITAR_SAMPLE},{name:"bass",data:BASS_SAMPLE},{name:"banjo",data:BANJO_SAMPLE},{name:"koto",data:KOTO_SAMPLE},{name:"dulcimer",data:DULCIMER_SAMPLE},{name:"electric guitar",data:ELECTRICGUITAR_SAMPLE},{name:"bassoon",data:BASSOON_SAMPLE},{name:"celeste",data:CELESTE_SAMPLE},{name:"vibraphone",data:VIBRAPHONE_SAMPLE},{name:"xylophone",data:XYLOPHONE_SAMPLE}],drum:[{name:"bottle",data:BOTTLE_SAMPLE},{name:"clap",data:CLAP_SAMPLE},{name:"darbuka drum",data:DARBUKA_SAMPLE},{name:"hi hat",data:HIHAT_SAMPLE},{name:"splash",data:SPLASH_SAMPLE},{name:"bubbles",data:BUBBLES_SAMPLE},{name:"raindrop",data:RAINDROP_SAMPLE},{name:"cow bell",data:COWBELL_SAMPLE},{name:"dog",data:DOG_SAMPLE},{name:"kick drum",data:KICK_SAMPLE},{name:"tom tom",data:TOM_SAMPLE},{name:"cat",data:CAT_SAMPLE},{name:"crash",data:CRASH_SAMPLE},{name:"duck",data:DUCK_SAMPLE},{name:"ride bell",data:RIDEBELL_SAMPLE},{name:"triangle bell",data:TRIANGLE_SAMPLE},{name:"chime",data:CHIME_SAMPLE},{name:"gong",data:GONG_SAMPLE},{name:"cricket",data:CRICKET_SAMPLE},{name:"finger cymbals",data:FINGERCYMBAL_SAMPLE},{name:"slap",data:SLAP_SAMPLE},{name:"japanese drum",data:JAPANESE_DRUM_SAMPLE},{name:"clang",data:CLANG_SAMPLE},{name:"cup drum",data:CUP_SAMPLE},{name:"floor tom tom",data:FLOORTOM_SAMPLE},{name:"snare drum",data:SNARE_SAMPLE}]},null===this.samples)for(var t in this.samples={},this.samplesManifest)this.samplesManifest.hasOwnProperty(t)&&(this.samples[t]={})},this._loadSample=function(t){for(var e in this.samplesManifest)if(this.samplesManifest.hasOwnProperty(e))for(var i in this.samplesManifest[e])if(this.samplesManifest[e].hasOwnProperty(i)){var s=this.samplesManifest[e][i].name;t===s&&(this.samples[e][s]=this.samplesManifest[e][i].data())}},this.samplesQueue=[];var n=this;return require(SOUNDSAMPLESDEFINES,function(){n.loadSamples();for(var t=0;t<n.samplesQueue.length;t++)n.__createSynth(0,n.samplesQueue[t][0],n.samplesQueue[t][1],n.samplesQueue[t][2])}),platform.FF||(this.recorder=new Recorder(Tone.Master)),this.getDefaultParamValues=function(t){var e=t.toLowerCase();switch(null!==getOscillatorTypes(e)&&(e=getOscillatorTypes(e)),e){case"amsynth":var i={harmonicity:1,detune:0,envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}};break;case"fmsynth":i={harmonicity:1,modulationIndex:10,detune:0,envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}};break;case"noise1":i={noise:{type:"white"},envelope:{attack:.005,decay:.1,sustain:1}};break;case"noise2":i={noise:{type:"brown"},envelope:{attack:.005,decay:.1,sustain:1}};break;case"noise3":i={noise:{type:"pink"},envelope:{attack:.005,decay:.1,sustain:1}};break;case"simple 1":case"simple 2":case"simple 3":case"simple 4":i={oscillator:{type:"sine"},envelope:{attack:.03,decay:0,sustain:1,release:.03}};break;case"duosynth":i={vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}},voice1:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}};break;case"sine":case"triangle":case"square":case"sawtooth":i={oscillator:{type:e},envelope:{attack:.03,decay:0,sustain:1,release:.03}};break;case"pluck":i={attackNoise:1,dampening:4e3,resonance:.9};break;case"poly":i={polyphony:POLYCOUNT};break;default:i={}}return i},this.createDefaultSynth=function(t){console.log("create default poly/default/custom synth for turtle "+t);var e=new Tone.PolySynth(POLYCOUNT,Tone.AMSynth).toMaster();instruments[t]["electronic synth"]=e,instrumentsSource["electronic synth"]=[0,"electronic synth"],instruments[t].custom=e,instrumentsSource.custom=[0,"custom"]},this._createSampleSynth=function(t,e,i,s){if(i in this.samples.voice){instrumentsSource[e]=[2,i],console.log(i+" "+SAMPLECENTERNO[i][0]);var l={};l[SAMPLECENTERNO[i][0]]=this.samples.voice[i];var o=new Tone.Sampler(l)}else if(i in this.samples.drum){instrumentsSource[e]=[1,i],console.log(i);o=new Tone.Player(this.samples.drum[i])}else{instrumentsSource[e]=[1,"drum"],console.log(DEFAULTDRUM);o=new Tone.Player(this.samples.drum[DEFAULTDRUM])}return o},this._createBuiltinSynth=function(t,e,i,s){if(i in a){var l=this.getDefaultParamValues(i);l=validateAndSetParams(l,s)}switch(i){case"simple 1":case"simple 2":case"simple 3":case"simple 4":instrumentsSource[e]=[3,i],console.log(i);var o=new Tone.Synth(l);break;case"sine":case"triangle":case"square":case"sawtooth":instrumentsSource[e]=[3,i],console.log(i);o=new Tone.Synth(l);break;case"pluck":instrumentsSource[e]=[3,i],console.log(i);o=new Tone.PluckSynth(l);break;case"poly":instrumentsSource[e]=[0,"poly"],console.log("poly");o=new Tone.PolySynth(l.polyphony,Tone.AMSynth);break;case"noise1":case"noise2":case"noise3":instrumentsSource[e]=[4,i],console.log(i);o=new Tone.NoiseSynth(l);break;default:instrumentsSource[e]=[0,"poly"],console.log("poly (default)");o=new Tone.PolySynth(POLYCOUNT,Tone.AMSynth)}return o},this._createCustomSynth=function(t,e){var i=this.getDefaultParamValues(t);if(i=validateAndSetParams(i,e),"amsynth"===t.toLowerCase())var s=new Tone.AMSynth(i);else if("fmsynth"===t.toLowerCase())s=new Tone.FMSynth(i);else if("duosynth"===t.toLowerCase())s=new Tone.DuoSynth(i);else s=new Tone.PolySynth(POLYCOUNT,Tone.AMSynth);return s},this.__createSynth=function(t,e,i,s){this._loadSample(i),i in this.samples.voice||i in this.samples.drum?instruments[t][e]=this._createSampleSynth(t,e,i,null).toMaster():i in a?instruments[t][e]=this._createBuiltinSynth(t,e,i,s).toMaster():i in l?(instruments[t][e]=this._createCustomSynth(i,s).toMaster(),instrumentsSource[e]=[0,"poly"]):4<=i.length&&("http"===i.slice(0,4)?(instruments[t][i]=new Tone.Sampler(i).toMaster(),instrumentsSource[e]=[1,"drum"]):"file"===i.slice(0,4)?(instruments[t][i]=new Tone.Sampler(i).toMaster(),instrumentsSource[e]=[1,"drum"]):"drum"===i&&(instruments[t][i]=this._createSampleSynth(t,i,i,null).toMaster(),instrumentsSource[e]=[1,"drum"]))},this.createSynth=function(t,e,i,s){if(null===this.samples){this.samplesQueue.push([e,i,s]);var l=this;require(SOUNDSAMPLESDEFINES,function(){l.loadSamples()})}else this.__createSynth(t,e,i,s)},this.loadSynth=function(t,e){return e in instruments[t]?console.log(e+" already loaded"):(console.log("loading "+e),this.createSynth(t,e,e,null)),e in instruments[t]?instruments[t][e].toMaster():null},this._performNotes=function(i,t,e,s,l,o){if("equal"!==this.inTemperament&&"custom"!==this.inTemperament)if("number"==typeof t)t=t;else{var a=t;void 0===(t=this._getFrequency(t,this.changeInTemperament))&&(t=a.substring(1,a.length-1)==DOUBLEFLAT?a.substring(0,1)+"bb"+a.substring(a.length-1,a.length):a.substring(1,a.length-1)==DOUBLESHARP?a.substring(0,1)+"x"+a.substring(a.length-1,a.length):a)}if("custom"==this.inTemperament){a=t;void 0===(t=this.getCustomFrequency(t))&&(t=a),console.log(t)}if(null===s&&null===l)i.triggerAttackRelease(t,e);else{if(null!=l){var n=l.length,r=0,c=[];for(r=0;r<n;r++){var h=new Tone.Filter(l[r].filterFrequency,l[r].filterType,l[r].filterRolloff);c.push(h),i.chain(c[r],Tone.Master)}}if(null!=s){if(s.doVibrato){var u=new Tone.Vibrato(1/s.vibratoFrequency,s.vibratoIntensity);i.chain(u,Tone.Master)}if(s.doDistortion){var d=new Tone.Distortion(s.distortionAmount).toMaster();i.connect(d,Tone.Master)}if(s.doTremolo){var f=new Tone.Tremolo({frequency:s.tremoloFrequency,depth:s.tremoloDepth}).toMaster().start();i.chain(f)}if(s.doPhaser){var p=new Tone.Phaser({frequency:s.rate,octaves:s.octaves,baseFrequency:s.baseFrequency}).toMaster();i.chain(p,Tone.Master)}if(s.doChorus){var b=new Tone.Chorus({frequency:s.chorusRate,delayTime:s.delayTime,depth:s.chorusDepth}).toMaster();i.chain(b,Tone.Master)}if(s.doPartials)if(void 0!==i.oscillator)i.oscillator.partials=s.partials;else if(void 0!==i.voices)for(v=0;v<i.voices.length;v++)i.voices[v].oscillator.partials=s.partials;if(s.doPortamento)if(void 0!==i.oscillator)i.portamento=s.portamento;else if(void 0!==i.voices)for(v=0;v<i.voices.length;v++)i.voices[v].portamento=s.portamento;if(s.doNeighbor){for(var m=s.neighborArgBeat,g=s.neighborArgCurrentBeat,k=[],v=0;v<s.neighborArgNote1.length;v++){var y=s.neighborArgNote1[v].replace("","#").replace("","b"),_=s.neighborArgNote2[v].replace("","#").replace("","b");k.push({time:0,note:y,duration:m},{time:m,note:_,duration:m},{time:2*m,note:y,duration:g})}var T=new Tone.Part(function(t,e){i.triggerAttackRelease(e.note,e.duration,t)},k).start()}}if(!s.doNeighbor)if(void 0!==o&&o){if(void 0!==i.oscillator)i.setNote(t);else if(void 0!==i.voices)for(v=0;v<i.voices.length;v++)i.voices[v].setNote(t)}else i.triggerAttackRelease(t,e);setTimeout(function(){if(s&&null!=s&&(s.doVibrato&&u.dispose(),s.doDistortion&&d.dispose(),s.doTremolo&&f.dispose(),s.doPhaser&&p.dispose(),s.doChorus&&b.dispose(),s.doNeighbor&&T.dispose()),l&&null!=l)for(r=0;r<n;r++)c[r].dispose()},1e3*e)}},this.trigger=function(t,e,i,s,l,o,a){null!=l&&(0!==l.vibratoIntensity&&(l.doVibrato=!0),0!==l.distortionAmount&&(l.doDistortion=!0),0!==l.tremoloFrequency&&(l.doTremolo=!0),0!==l.rate&&(l.doPhaser=!0),0!==l.chorusRate&&(l.doChorus=!0),l.neighborSynth&&(l.doNeighbor=!0));var n=e,r=instruments[t]["electronic synth"],c=0;if(s in instruments[t]&&(r=instruments[t][s],1===(c=instrumentsSource[s][0])||2===c))instrumentsSource[s][1];switch(c){case 1:"http"===s.slice(0,4)||s.slice(0,4),r.start();break;case 2:this._performNotes(r.toMaster(),e,i,l,o,a);break;case 3:"object"===_typeof(e)&&(n=e[0]),this._performNotes(r.toMaster(),n,i,l,o,a);break;case 4:r.triggerAttackRelease(i);break;case 0:default:this._performNotes(r.toMaster(),n,i,l,o,a)}},this.stopSound=function(t,e){switch(instrumentsSource[e][0]){case 1:instruments[t][e].stop();break;default:instruments[t][e].triggerRelease()}},this.start=function(){Tone.Transport.start()},this.stop=function(){Tone.Transport.stop()},this.setVolume=function(t,e,i){if(e in DEFAULTSYNTHVOLUME){var s=DEFAULTSYNTHVOLUME[e];if(50<i)var l=(i-50)/50*(100-s)+s;else l=i/50*s}else l=i;var o=Tone.gainToDb(l/100);e in instruments[t]&&(instruments[t][e].volume.value=o)},this.getVolume=function(t,e){return e in instruments[t]?instruments[t][e].volume.value:(console.log("instrument not found"),50)},this.setMasterVolume=function(t){var e=Tone.gainToDb(t/100);Tone.Master.volume.rampTo(e,.01)},this}function format(i,s){return(i=i.replace(/{([a-zA-Z0-9.]*)}/g,function(t,e){return x=s,e.split(".").forEach(function(t){void 0===x&&console.log("Undefined value in template string",i,e,x,t),x=x[t]}),x})).replace(/{_([a-zA-Z0-9]+)}/g,function(t,e){return _(e)})}function canvasPixelRatio(){var t=window.devicePixelRatio||1,e=document.querySelector("#myCanvas").getContext("2d");return t/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}function windowHeight(){return/Android/i.test(navigator.userAgent)?window.outerHeight:window.innerHeight}function windowWidth(){return/Android/i.test(navigator.userAgent)?window.outerWidth:window.innerWidth}function httpGet(t){var e=null;if(e=new XMLHttpRequest,null===t?e.open("GET",window.server,!1):e.open("GET",window.server+t,!1),e.setRequestHeader("x-api-key","3tgTzMXbbw6xEKX7"),e.send(),299<e.status)throw"Error from server";return e.responseText}function httpPost(t,e){var i=null;return(i=new XMLHttpRequest).open("POST",window.server+t,!1),i.setRequestHeader("x-api-key","3tgTzMXbbw6xEKX7"),i.send(e),i.responseText}function HttpRequest(e,t,i){var s=this.request=new XMLHttpRequest;this.handler=t,this.url=e,this.localmode=Boolean(0===self.location.href.search(/^file:/i)),this.userCallback=i;var l=this;try{s.open("GET",e),s.onreadystatechange=function(){l.handler()},s.send("")}catch(t){self.console&&console.log("Failed to load resource from "+e+": Network error."),"function"==typeof i&&i(!1,"network error"),this.request=this.handler=this.userCallback=null}}function docByClass(t){return document.getElementsByClassName(t)}function docByTagName(t){document.getElementsByTagName(t)}function docById(t){return document.getElementById(t)}function docByName(t){return document.getElementsByName(t)}function last(t){var e=t.length;return 0===e?null:t[e-1]}function getTextWidth(t,e){var i=(getTextWidth.canvas||(getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");return i.font=e,i.measureText(t).width}function doSVG(t,e,i,s,l,o){var a="";for(var n in i.turtleList)i.turtleList[n].closeSVG(),a+=i.turtleList[n].svgOutput;var r='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="'+s+'" height="'+l+'">\n';return r+='<g transform="scale('+o+","+o+')">\n',r+=e.svgOutput,""===a?"":(r+=a,r+="</g>",r+="</svg>")}function isSVGEmpty(t){for(var e in t.turtleList)if(t.turtleList[e].closeSVG(),""!==t.turtleList[e].svgOutput)return!1;return!0}function fileExt(t){if(null===t)return"";var e=t.split(".");return 1===e.length||""===e[0]&&2===e.length?"":e.pop()}function fileBasename(t){var e=t.split(".");return 1===e.length?e[0]:""===e[0]&&2===e.length?t:(e.pop(),e.join("."))}function _(e){for(var t=e,i=[",","(",")","?","","<",">",".","\n",'"',":","%s","%d","/","'",";","","!",""],s=0;s<i.length;s++)t=t.replace(i[s],"");t=t.replace(/ /g,"-"),"kana"!==localStorage.kanaPreference||"ja"===document.webL10n.getLanguage()&&(t="kana-"+t);try{var l=document.webL10n.get(t);return""===l&&(l=e),l}catch(t){return console.log("i18n error: "+e),e}}function toTitleCase(t){if("string"==typeof t){var e="";return 1<t.length&&(e=t.substring(1)),t.toUpperCase()[0]+e}}function processRawPluginData(t,e,i,s,l,o,a,n,r,c,h){for(var u=t.split("\n"),d="",f=0;f<u.length;f++)0!==u[f].length&&"/"!==u[f][0]&&(d+=u[f]);try{var p=processPluginData(d.replace(/\n/g,""),e,i,l,o,a,n,r,c,h)}catch(t){p=null;s("Error loading plugin: "+t)}return p}function processPluginData(pluginData,palettes,blocks,evalFlowDict,evalArgDict,evalParameterDict,evalSetterDict,evalOnStartList,evalOnStopList,evalMacroDict){var obj=JSON.parse(pluginData),newPalette=!1;if("PALETTEPLUGINS"in obj)for(var name in obj.PALETTEPLUGINS){PALETTEICONS[name]=obj.PALETTEPLUGINS[name];var fillColor="#ff0066";if("PALETTEFILLCOLORS"in obj&&name in obj.PALETTEFILLCOLORS)var fillColor=obj.PALETTEFILLCOLORS[name];PALETTEFILLCOLORS[name]=fillColor;var strokeColor="#ef003e";if("PALETTESTROKECOLORS"in obj&&name in obj.PALETTESTROKECOLORS)var strokeColor=obj.PALETTESTROKECOLORS[name];PALETTESTROKECOLORS[name]=strokeColor;var highlightColor="#ffb1b3";if("PALETTEHIGHLIGHTCOLORS"in obj&&name in obj.PALETTEHIGHLIGHTCOLORS)var highlightColor=obj.PALETTEHIGHLIGHTCOLORS[name];PALETTEHIGHLIGHTCOLORS[name]=highlightColor;var strokeHighlightColor="#404040";if("HIGHLIGHTSTROKECOLORS"in obj&&name in obj.HIGHLIGHTSTROKECOLORS)var strokeHighlightColor=obj.HIGHLIGHTSTROKECOLORS[name];HIGHLIGHTSTROKECOLORS[name]=strokeHighlightColor,platformColor.paletteColors[name]=[fillColor,strokeColor,highlightColor,strokeHighlightColor],name in palettes.buttons?console.log("palette "+name+" already exists"):(console.log("adding palette "+name),palettes.add(name),newPalette=!0)}if(newPalette)try{console.log("CALLING makePalettes"),palettes.makePalettes()}catch(t){console.log("makePalettes: "+t)}if("IMAGES"in obj)for(var blkName in obj.IMAGES)pluginsImages[blkName]=obj.IMAGES[blkName];if("FLOWPLUGINS"in obj)for(var flow in obj.FLOWPLUGINS)evalFlowDict[flow]=obj.FLOWPLUGINS[flow];if("ARGPLUGINS"in obj)for(var arg in obj.ARGPLUGINS)evalArgDict[arg]=obj.ARGPLUGINS[arg];if("MACROPLUGINS"in obj)for(var macro in obj.MACROPLUGINS)try{evalMacroDict[macro]=JSON.parse(obj.MACROPLUGINS[macro])}catch(t){console.log("could not parse macro "+macro),console.log(obj.MACROPLUGINS[macro])}if("SETTERPLUGINS"in obj)for(var setter in obj.SETTERPLUGINS)evalSetterDict[setter]=obj.SETTERPLUGINS[setter];if("BLOCKPLUGINS"in obj)for(var block in obj.BLOCKPLUGINS){console.log("adding plugin block "+block);try{eval(obj.BLOCKPLUGINS[block])}catch(t){console.log("Failed to load plugin for "+block+": "+t)}}if("GLOBALS"in obj&&eval(obj.GLOBALS),"PARAMETERPLUGINS"in obj)for(var parameter in obj.PARAMETERPLUGINS)evalParameterDict[parameter]=obj.PARAMETERPLUGINS[parameter];if("ONLOAD"in obj)for(var arg in obj.ONLOAD)eval(obj.ONLOAD[arg]);if("ONSTART"in obj)for(var arg in obj.ONSTART)evalOnStartList[arg]=obj.ONSTART[arg];if("ONSTOP"in obj)for(var arg in obj.ONSTOP)evalOnStopList[arg]=obj.ONSTOP[arg];for(var protoblock in blocks.protoBlockDict)try{void 0===blocks.protoBlockDict[protoblock].palette?console.log("Cannot find palette for protoblock "+protoblock):null===blocks.protoBlockDict[protoblock].palette?console.log("Cannot find palette for protoblock "+protoblock):blocks.protoBlockDict[protoblock].palette.add(blocks.protoBlockDict[protoblock])}catch(t){console.log(t)}return console.log("updating palette "+name),palettes.updatePalettes(name),setTimeout(function(){palettes.show(),palettes.bringToTop()},2e3),obj}function updatePluginObj(t){for(var e in t.PALETTEPLUGINS)pluginObjs.PALETTEPLUGINS[e]=t.PALETTEPLUGINS[e];for(var e in t.PALETTEFILLCOLORS)pluginObjs.PALETTEFILLCOLORS[e]=t.PALETTEFILLCOLORS[e];for(var e in t.PALETTESTROKECOLORS)pluginObjs.PALETTESTROKECOLORS[e]=t.PALETTESTROKECOLORS[e];for(var e in t.PALETTEHIGHLIGHTCOLORS)pluginObjs.PALETTEHIGHLIGHTCOLORS[e]=t.PALETTEHIGHLIGHTCOLORS[e];for(var i in t.FLOWPLUGINS)pluginObjs.FLOWPLUGINS[i]=t.FLOWPLUGINS[i];for(var s in t.ARGPLUGINS)pluginObjs.ARGPLUGINS[s]=t.ARGPLUGINS[s];for(var l in t.BLOCKPLUGINS)pluginObjs.BLOCKPLUGINS[l]=t.BLOCKPLUGINS[l];if("MACROPLUGINS"in t)for(var o in t.MACROPLUGINS)pluginObjs.MACROPLUGINS[o]=t.MACROPLUGINS[o];for(var e in"GLOBALS"in t&&("GLOBALS"in pluginObjs||(pluginObjs.GLOBALS=""),pluginObjs.GLOBALS+=t.GLOBALS),"IMAGES"in t&&(pluginObjs.IMAGES=t.IMAGES),t.ONLOAD)pluginObjs.ONLOAD[e]=t.ONLOAD[e];for(var e in t.ONSTART)pluginObjs.ONSTART[e]=t.ONSTART[e];for(var e in t.ONSTOP)pluginObjs.ONSTOP[e]=t.ONSTOP[e]}function preparePluginExports(t){return updatePluginObj(t),JSON.stringify(pluginObjs)}function processMacroData(t,e,i,s){if("{}"!==t){var l=JSON.parse(t);for(var o in e.add("myblocks","black","#a0a0a0"),l)console.log("adding "+o+" to macroDict"),s[o]=l[o],i.addToMyPalette(o,s[o]);e.makePalettes()}}function prepareMacroExports(t,e,i){return null!==t&&(i[t]=e),JSON.stringify(i)}function doPublish(t){var e=doSave();console.log("push "+e+" to FB");var i=t+" "+docById("description").value+" "+e;console.log("comment: "+i);FB.login(function(){FB.api("/me/feed","post",{message:i})},{scope:"publish_actions"})}var hasSetupCamera=!1;function doUseCamera(e,i,s,l,o,a,n){var r=!1,c=document.querySelector("#camVideo"),h=document.querySelector("#camCanvas");function u(){h.width=320,h.height=240,h.getContext("2d").drawImage(c,0,0,320,240);var t=h.toDataURL("image/png");i.turtleList[s].doShowImage(e[0],t)}navigator.getMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia,void 0===navigator.getMedia&&n("Your browser does not support the webcam"),hasSetupCamera?(r=!0,c.play(),l?(o=window.setInterval(u,100),a(o)):u()):navigator.getMedia({video:!0,audio:!1},function(t){if(navigator.mozGetUserMedia)c.mozSrcObject=t;else{var e=window.URL||window.webkitURL;c.src=e.createObjectURL(t)}c.play(),hasSetupCamera=!0},function(t){n("Could not connect to camera"),console.log("Could not connect to camera",t)}),c.addEventListener("canplay",function(t){console.log("canplay",r,hasSetupCamera),r||(c.setAttribute("width",320),c.setAttribute("height",240),h.setAttribute("width",320),h.setAttribute("height",240),r=!0,l?(o=window.setInterval(u,100),a(o)):u())},!1)}function doStopVideoCam(t,e){null!==t&&window.clearInterval(t),e(null),document.querySelector("#camVideo").pause()}function hideDOMLabel(){var t=docById("textLabel");null!==t&&(t.style.display="none");var e=docById("numberLabel");null!==e&&(e.style.display="none");var i=docById("wheelDiv");null!==i&&(i.style.display="none")}function displayMsg(t,e){}function safeSVG(t){return"string"==typeof t?t.replace(/&/,"&amp;").replace(/</,"&lt;").replace(/>/,"&gt;"):t}function toFixed2(t){return"number"!=typeof t?t:t!==Math.floor(t)?t.toFixed(2).toString():t.toString()}function mixedNumber(t){if("number"!=typeof t)return t;var e=Math.floor(t);if(e<t){var i=rationalToFraction(t-e);return 0===e?i[0]+"/"+i[1]:1===i[0]&&1===i[1]?e+1:99<i[1]?t.toFixed(2):e+" "+i[0]+"/"+i[1]}return t.toString()}function LCD(t,e){return Math.abs(t*e/GCD(t,e))}function GCD(t,e){for(t=Math.abs(t),e=Math.abs(e);e;){var i=e;e=t%e,t=i}return t}function rationalSum(t,e){if(0===t||0===e)return console.log("divide by zero?"),[0,1];if(Math.floor(t[0])!==t[0])var i=rationalToFraction(t[0]);else i=[t[0],1];if(Math.floor(e[0])!==e[0])var s=rationalToFraction(e[0]);else s=[e[0],1];if(Math.floor(t[1])!==t[1])var l=rationalToFraction(t[1]);else l=[t[1],1];if(Math.floor(e[1])!==e[1])var o=rationalToFraction(e[1]);else o=[e[1],1];t[0]=i[0]*l[1],t[1]=i[1]*l[0],e[0]=s[0]*o[1],e[1]=s[1]*o[0];var a=LCD(t[1],e[1]);t[0],t[1],e[0],e[1];return[t[0]*a/t[1]+e[0]*a/e[1],a]}function rationalToFraction(t){if(1<t){var e=!0;t=1/t}else e=!1;for(var i=1,s=1,l=1;1e-8<Math.abs(i-t);)i<t?s+=1:(l+=1,s=Math.floor(t*l)),i=s/l;return 0===l||0===s?[0,1]:e?[l,s]:[s,l]}function nearestBeat(t,e){for(var i=1/(2*e),s=0,l=t/100;i<l;)i+=1/e,s+=1;return[s,e]}function oneHundredToFraction(t){if(t<1)return[1,64];if(99<t)return[1,1];switch(Math.floor(t)){case 1:return[1,64];case 2:return[1,48];case 3:case 4:case 5:return[1,32];case 6:case 7:case 8:return[1,16];case 9:case 10:case 11:return[1,12];case 12:case 13:case 14:return[1,8];case 15:case 16:case 17:return[1,6];case 18:case 19:return[3,16];case 20:case 21:case 22:return[1,5];case 23:case 24:case 25:case 26:case 27:case 28:case 29:return[1,4];case 30:case 31:return[5,16];case 32:case 33:case 34:case 35:return[1,3];case 36:case 37:case 38:case 39:return[3,8];case 40:case 41:return[2,5];case 42:case 43:case 44:return[7,16];case 45:case 46:case 47:return[15,32];case 48:case 49:case 50:case 51:case 52:return[1,2];case 53:case 54:return[17,32];case 56:case 57:case 58:return[9,16];case 59:case 60:case 61:return[3,5];case 62:case 63:case 64:case 65:return[5,8];case 66:case 67:return[2,3];case 68:case 69:case 70:return[11,16];case 71:case 72:case 73:case 74:return[23,32];case 75:case 76:case 77:case 78:case 79:case 80:return[3,4];case 81:case 82:return[13,16];case 83:case 84:case 85:case 86:return[5,6];case 87:case 88:case 89:case 90:return[7,8];case 91:case 92:return[11,12];case 93:case 94:case 95:return[15,16];case 96:case 98:return[31,32];case 98:return[63,64];default:return[t,100]}}function rgbToHex(t,e,i){return"#"+((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)}function hexToRGB(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function delayExecution(i){return new Promise(function(t,e){setTimeout(function(){t(!0)},i)})}function HelpWidget(){this.init=function(o){window.innerWidth;var t=docById("myCanvas"),e=0,s=docById("helpDiv");s.style.display="",s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var i=docById("helpButtonsDiv");i.classList.add("top-wrapper");var l=this;if(null===o){var a;i.innerHTML=_("Take a tour"),(r=document.getElementById("right-arrow")).style.display="block",r.classList.add("hover"),(c=document.getElementById("left-arrow")).style.display="block",c.classList.add("hover"),(a=docById("left-arrow")).onclick=function(){(e-=1)<0&&(e=HELPCONTENT.length-1),l._showPage(e)},(a=docById("right-arrow")).onclick=function(){(e+=1)===HELPCONTENT.length&&(e=0),l._showPage(e)}}else{if(null===o.activeBlock.name)s.style.display="none";else var n=o.blockList[o.activeBlock].protoblock.staticLabels[0];var r,c;i.innerHTML=n,(r=document.getElementById("right-arrow")).style.display="none",r.classList.remove("hover"),(c=document.getElementById("left-arrow")).style.display="none",c.classList.remove("hover")}(a=document.createElement("div")).classList.add("close-button"),i.appendChild(a),a.onclick=function(){s.style.display="none"};var h=document.createElement("div");if(h.classList.add("drag-button"),i.appendChild(h),this._dx=h.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=h.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=h.innerHTML,h.onmouseover=function(t){h.innerHTML=""},h.onmouseout=function(t){l._dragging||(h.innerHTML=l._dragCellHTML)},t.ondragover=function(t){l._dragging=!0,t.preventDefault()},t.ondrop=function(t){if(l._dragging){l._dragging=!1;var e=t.clientX-(h.getBoundingClientRect().left-s.getBoundingClientRect().left)-41;s.style.left=e+"px";var i=t.clientY-(h.getBoundingClientRect().top-s.getBoundingClientRect().top)-41;s.style.top=i+"px",h.innerHTML=l._dragCellHTML}},s.ondragover=function(t){l._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(l._dragging){l._dragging=!1;var e=t.clientX-(h.getBoundingClientRect().left-s.getBoundingClientRect().left)-41;s.style.left=e+"px";var i=t.clientY-(h.getBoundingClientRect().top-s.getBoundingClientRect().top)-41;s.style.top=i+"px",h.innerHTML=l._dragCellHTML}},s.onmousedown=function(t){l._target=t.target},s.ondragstart=function(t){h.contains(l._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()},null===o)this._showPage(0);else if(null===o.activeBlock.name)s.style.display="none";else{var u=o.blockList[o.activeBlock].name;if(u in BLOCKHELP){var d=docById("helpBodyDiv");if(body="",1<BLOCKHELP[u].length){var f=BLOCKHELP[u][1],p=localStorage.languagePreference;switch(void 0===p&&(p=navigator.language),p){case"ja":"kana"==localStorage.kanaPreference?f+="-kana":f+="-ja";break;case"es":f+="-es";break;case"pt":f+="-pt"}body=body+'<p><img src="'+f+"/"+u+'_block.svg"></p>'}body=body+"<p>"+BLOCKHELP[u][0]+"</p>",body+='<img src="header-icons/export-chunk.svg" id="loadButton" width="32" height="32" alt='+_("Load blocks")+"/>",d.innerHTML=body;var b=docById("loadButton");null!==b&&(b.onclick=function(){if(BLOCKHELP[u].length<4){console.log("CLICK: "+u);var t=o.palettes.getProtoNameAndPalette(u),e=t[0],i=t[1],s=t[2];o.protoBlockDict.hasOwnProperty(s)&&o.palettes.dict[i].makeBlockFromSearch(e,s,function(t){o.moveBlock(t,100,100)})}else if("string"==typeof BLOCKHELP[u][3]){var l=getMacroExpansion(BLOCKHELP[u][3],100,100);console.log("CLICK: "+l),o.loadNewBlocks(l)}else{l=BLOCKHELP[u][3];console.log("CLICK: "+l),o.loadNewBlocks(l)}})}else s.style.display="none"}},this._showPage=function(t){var e=docById("helpBodyDiv"),i="";if(i=(i=(i=-1!==[_("Welcome to Music Blocks"),_("Meet Mr. Mouse!"),_("Guide"),_("About"),_("Congratulations.")].indexOf(HELPCONTENT[t][0])?i+'<p>&nbsp;<img src="'+HELPCONTENT[t][2]+'"></p>':i+'<p>&nbsp;<img src="'+HELPCONTENT[t][2]+'"width="64px" height="64px"></p>')+"<h1>"+HELPCONTENT[t][0]+"</h1>")+"<p>"+HELPCONTENT[t][1]+"</p>",3<HELPCONTENT[t].length){var s=HELPCONTENT[t][3];console.log(t+" "+s),i=i+'<p><a href="'+s+'" target="_blank">'+HELPCONTENT[t][4]+"</a></p>"}e.style.color="#505050",e.innerHTML=i},this.showPageByName=function(t){for(var e=0;e<HELPCONTENT.length;e++)HELPCONTENT[e].includes(t)&&this._showPage(e)},this.hide=function(){docById("helpDiv").style.visibility="hidden",docById("helpButtonsDiv").style.visibility="hidden";for(var t=0;t<this.BPMs.length;t++)docById("helpCanvas"+t).style.visibility="hidden";null!=this._intervalID&&clearInterval(this._intervalID)}}function MeterWidget(){this.init=function(t,e){this._logo=t,this._meterBlock=e,this._strongBeats=[],this._playing=!1,this._click_lock=!1,this._beatValue=.25;var i=window.innerWidth;this._cellScale=i/1200;this._cellScale;var s=docById("myCanvas"),l=docById("meterDiv");l.style.visibility="visible",l.setAttribute("draggable","true"),l.style.left="200px",l.style.top="175px";var o=docById("meterButtonsDiv");o.style.display="inline",o.style.visibility="visible",o.style.width=535,o.innerHTML='<table cellpadding="0px" id="meterButtonTable"></table>';var a=docById("meterButtonTable").createTHead().insertRow(0);this._logo.synth.setMasterVolume(PREVIEWVOLUME),this._logo.synth.loadSynth(0,"kick drum"),this._logo.setSynthVolume(0,"kick drum",PREVIEWVOLUME),this._logo.synth.loadSynth(0,"snare drum"),this._logo.setSynthVolume(0,"snare drum",PREVIEWVOLUME);var n=this;(r=this._addButton(a,"close-button.svg",32,_("Close"))).onclick=function(){n._playing=!1,docById("meterDiv").style.visibility="hidden",docById("meterButtonsDiv").style.visibility="hidden",docById("meterTableDiv").style.visibility="hidden",docById("meterWheelDiv").style.visibility="hidden",n._logo.hideMsgs()};var r=this._addButton(a,"play-button.svg",32,_("Play"));this._click_lock=!1,r.onclick=function(){n._get_click_lock()?console.log("click lock"):(console.log("CLICK PLAY/PAUSE"),n._click_lock=!0,n.__getPlayingStatus()?(console.log("PAUSING"),this.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play all")+'" alt="'+_("Play all")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',n._playing=!1):(console.log("PLAYING"),this.innerHTML='&nbsp;&nbsp;<img src="header-icons/stop-button.svg" title="'+_("Stop")+'" alt="'+_("Stop")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',n._playing=!0,n._logo.setTurtleDelay(0),n._logo.resetSynth(0),n._playBeat()),setTimeout(function(){n._click_lock=!1},1e3))},(r=this._addButton(a,"export-chunk.svg",32,_("Save"))).onclick=function(){n._save()};var c=this._addButton(a,"grab.svg",32,_("Drag"));c.style.cursor="move",this._dx=c.getBoundingClientRect().left-l.getBoundingClientRect().left,this._dy=c.getBoundingClientRect().top-l.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=c.innerHTML,c.onmouseover=function(t){c.innerHTML=""},c.onmouseout=function(t){n._dragging||(c.innerHTML=n._dragCellHTML)},s.ondragover=function(t){n._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",c.innerHTML=n._dragCellHTML}},l.ondragover=function(t){n._dragging=!0,t.preventDefault()},l.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",c.innerHTML=n._dragCellHTML}},l.onmousedown=function(t){n._target=t.target},l.ondragstart=function(t){c.contains(n._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};var h=docById("meterTableDiv");if(h.style.display="inline",h.style.visibility="visible",h.style.border="0px",h.innerHTML='<div id="meterWheelDiv"></div>',null!==e){var u=this._logo.blocks.blockList[e].connections[1];if(null!==u)var d=this._logo.blocks.blockList[u].value;else d=4;var f=this._logo.blocks.blockList[e].connections[2];null!==f&&(this._beatValue=this._logo.blocks.blockList[f].value),this._piemenuMeter(d,this._beatValue)}else this._piemenuMeter(4,this._beatValue);this._logo.textMsg(_("Click in the circle to select strong beats for the meter."))},this._get_click_lock=function(){return this._click_lock},this.__playDrum=function(t){this._logo.synth.trigger(0,"C4",this._logo.defaultBPMFactor*this._beatValue,t,null,null)},this.__getPlayingStatus=function(){return this._playing},this.__getPauseStatus=function(){return!this._playing},this.__playOneBeat=function(t,e){if(this.__getPauseStatus()){console.log("PAUSING");for(t=0;t<this._strongBeats.length;t++)this._playWheel.navItems[t].navItem.hide()}else{var i=t-1;i<0&&(i+=this._strongBeats.length),this._playWheel.navItems[t].navItem.show(),this._playWheel.navItems[i].navItem.hide(),this._strongBeats[t]?this.__playDrum("snare drum"):this.__playDrum("kick drum");var s=this;setTimeout(function(){s.__playOneBeat((t+1)%s._strongBeats.length,e)},e)}},this._playBeat=function(){if(0<this._logo.bpm[0].length)var t=TONEBPM/last(this._logo.bpm[0]);else t=TONEBPM/this._logo._masterBPM;for(var e=0;e<this._strongBeats.length;e++)this._playWheel.navItems[e].navItem.hide();var i=1e3*t*this._beatValue;this.__playOneBeat(0,i)},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._save=function(){for(var t=[],e=[],i=this._strongBeats.length,s=0;s<i;s++)this._strongBeats[s]&&t.push(s);var l=0;for(s=0;s<t.length;s++)0===s?(1===t.length?e.push([0,"onbeatdo",100,100,[null,1,2,null]]):e.push([0,"onbeatdo",100,100,[null,1,2,3]]),e.push([1,["number",{value:t[s]+1}],0,0,[0]]),e.push([2,["text",{value:"action"}],0,0,[0]])):(s===t.length-1?e.push([l,"onbeatdo",0,0,[l-3,l+1,l+2,null]]):e.push([l,"onbeatdo",0,0,[l-3,l+1,l+2,l+3]]),e.push([l+1,["number",{value:t[s]+1}],0,0,[l]]),e.push([l+2,["text",{value:"action"}],0,0,[l]])),l+=3;console.log(e),this._logo.blocks.loadNewBlocks(e)},this._piemenuMeter=function(t,e){docById("meterWheelDiv").style.display="",this._meterWheel=new wheelnav("meterWheelDiv",null,400,400),this._beatWheel=new wheelnav("_beatWheel",this._meterWheel.raphael),this._playWheel=new wheelnav("_playWheel",this._meterWheel.raphael),wheelnav.cssMeter=!0,this._meterWheel.colors=platformColor.modeWheelcolors,this._meterWheel.slicePathFunction=slicePath().DonutSlice,this._meterWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._meterWheel.slicePathCustom.minRadiusPercent=.4,this._meterWheel.slicePathCustom.maxRadiusPercent=.75,this._meterWheel.sliceSelectedPathCustom=this._meterWheel.slicePathCustom,this._meterWheel.sliceInitPathCustom=this._meterWheel.slicePathCustom,this._meterWheel.clickModeRotate=!1,this._meterWheel.navAngle=-90,this._meterWheel.animatetime=0,16<t&&(t=16);var i=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],s=[];this._strongBeats=[];for(var l=0;l<t;l++)s.push(i[l]),this._strongBeats.push(!1);this._meterWheel.createWheel(s),this._beatWheel.colors=platformColor.modeWheelcolors,this._beatWheel.slicePathFunction=slicePath().DonutSlice,this._beatWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._beatWheel.slicePathCustom.minRadiusPercent=.75,this._beatWheel.slicePathCustom.maxRadiusPercent=.9,this._beatWheel.sliceSelectedPathCustom=this._beatWheel.slicePathCustom,this._beatWheel.sliceInitPathCustom=this._beatWheel.slicePathCustom,this._beatWheel.clickModeRotate=!1,this._beatWheel.navAngle=-90,this._beatWheel.titleRotateAngle=90;for(s=[],l=0;l<t;l++)s.push("x");this._beatWheel.createWheel(s),this._playWheel.colors=[platformColor.orange],this._playWheel.slicePathFunction=slicePath().DonutSlice,this._playWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._playWheel.slicePathCustom.minRadiusPercent=.3,this._playWheel.slicePathCustom.maxRadiusPercent=.4,this._playWheel.sliceSelectedPathCustom=this._playWheel.slicePathCustom,this._playWheel.sliceInitPathCustom=this._playWheel.slicePathCustom,this._playWheel.clickModeRotate=!1,this._playWheel.navAngle=-90,this._playWheel.titleRotateAngle=90;for(s=[],l=0;l<t;l++)s.push(" ");this._playWheel.createWheel(s);for(l=0;l<t;l++)this._playWheel.navItems[l].navItem.hide();var o=this,a=function(){var t=o._meterWheel.selectedNavItemIndex;o._strongBeats[t]=!0,o._beatWheel.navItems[t].navItem.show()},n=function(){var t=o._beatWheel.selectedNavItemIndex;o._beatWheel.navItems[t].navItem.hide(),o._strongBeats[t]=!1};for(l=0;l<t;l++)o._meterWheel.navItems[l].navigateFunction=a,o._beatWheel.navItems[l].navigateFunction=n,o._beatWheel.navItems[l].navItem.hide()}}function ModeWidget(){this.init=function(t,e){this._logo=t,this._modeBlock=e,this._locked=!1,this._pitch=this._logo.keySignature[0][0],this._noteValue=.333,this._undoStack=[],this._playing=!1,this._selectedNotes=[],this._newPattern=[];var i=window.innerWidth;this._cellScale=i/1200;this._cellScale;var s=docById("myCanvas"),l=docById("modeDiv");l.style.visibility="visible",l.setAttribute("draggable","true"),l.style.left="200px",l.style.top="150px";var o=docById("modeButtonsDiv");o.style.display="inline",o.style.visibility="visible",o.style.width=535,o.innerHTML='<table cellpadding="0px" id="modeButtonTable"></table>';var a=docById("modeButtonTable").createTHead().insertRow(0),n=this;(r=this._addButton(a,"close-button.svg",32,_("Close"))).onclick=function(){docById("modeDiv").style.visibility="hidden",docById("modeButtonsDiv").style.visibility="hidden",docById("modeTableDiv").style.visibility="hidden",n._logo.hideMsgs()};var r=this._addButton(a,"play-button.svg",32,_("Play all"));(this._playButton=r).onclick=function(){n._logo.resetSynth(0),n._playingStatus()?(n._playing=!1,this.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play all")+'" alt="'+_("Play all")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;'):(n._playing=!0,this.innerHTML='&nbsp;&nbsp;<img src="header-icons/stop-button.svg" title="'+_("Stop")+'" alt="'+_("Stop")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',n._playAll())},(r=this._addButton(a,"export-chunk.svg",32,_("Save"))).onclick=function(){n._save()},(r=this._addButton(a,"erase-button.svg",32,_("Clear"))).onclick=function(){n._clear()},(r=this._addButton(a,"rotate-left.svg",32,_("Rotate counter clockwise"))).onclick=function(){n._rotateLeft()},(r=this._addButton(a,"rotate-right.svg",32,_("Rotate clockwise"))).onclick=function(){n._rotateRight()},(r=this._addButton(a,"invert.svg",32,_("Invert"))).onclick=function(){n._invert()},(r=this._addButton(a,"restore-button.svg",32,_("Undo"))).onclick=function(){n._undo()};var c=this._addButton(a,"grab.svg",32,_("Drag"));c.style.cursor="move",this._dx=c.getBoundingClientRect().left-l.getBoundingClientRect().left,this._dy=c.getBoundingClientRect().top-l.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=c.innerHTML,c.onmouseover=function(t){c.innerHTML=""},c.onmouseout=function(t){n._dragging||(c.innerHTML=n._dragCellHTML)},s.ondragover=function(t){n._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",c.innerHTML=n._dragCellHTML}},l.ondragover=function(t){n._dragging=!0,t.preventDefault()},l.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",c.innerHTML=n._dragCellHTML}},l.onmousedown=function(t){n._target=t.target},l.ondragstart=function(t){c.contains(n._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};var h=docById("modeTableDiv");h.style.display="inline",h.style.visibility="visible",h.style.border="0px",h.innerHTML='<div id="meterWheelDiv"></div><table id="modeTable"></table>',this._piemenuMode(),(r=(a=docById("modeTable").insertRow()).insertCell()).innerHTML="&nbsp;",r.style.backgroundColor=platformColor.selectorBackground,this._setMode(),this._logo.textMsg(_("Click in the circle to select notes for the mode."))},this._playingStatus=function(){return this._playing},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._setMode=function(){var t=keySignatureToMode(this._logo.keySignature[0]),e=MUSICALMODES[t[1]],i=docById("modeTable"),s=i.rows.length-1;console.log(_(t[1])),i.rows[s].cells[0].innerHTML=t[0]+" "+_(t[1]);for(var l=0,o=0,a=0;a<12;a++)a===o?(this._noteWheel.navItems[a].navItem.show(),this._selectedNotes[a]=!0,o+=e[l],l+=1):this._noteWheel.navItems[a].navItem.hide()},this._invert=function(){this._locked||(this._locked=!0,this._saveState(),this.__invertOnePair(1))},this.__invertOnePair=function(t){var e=this._selectedNotes[t];this._selectedNotes[t]=this._selectedNotes[12-t],this._selectedNotes[t]?this._noteWheel.navItems[t].navItem.show():this._noteWheel.navItems[t].navItem.hide(),this._selectedNotes[12-t]=e,this._selectedNotes[12-t]?this._noteWheel.navItems[12-t].navItem.show():this._noteWheel.navItems[12-t].navItem.hide();var i=this;5===t?(i._saveState(),i._setModeName(),i._locked=!1):setTimeout(function(){i.__invertOnePair(t+1)},125)},this._resetNotes=function(){for(var t=0;t<this._selectedNotes.length;t++)this._selectedNotes[t]?this._noteWheel.navItems[t].navItem.show():this._noteWheel.navItems[t].navItem.hide(),this._playWheel.navItems[t].navItem.hide()},this._rotateRight=function(){if(!this._locked){this._locked=!0,this._saveState(),this._newPattern=[],this._newPattern.push(this._selectedNotes[11]);for(var t=0;t<11;t++)this._newPattern.push(this._selectedNotes[t]);this.__rotateRightOneCell(1)}},this.__rotateRightOneCell=function(t,e){this._selectedNotes[t]=this._newPattern[t],this._selectedNotes[t]?this._noteWheel.navItems[t].navItem.show():this._noteWheel.navItems[t].navItem.hide();var i=this;0===t?setTimeout(function(){i._selectedNotes[0]?(i._saveState(),i._setModeName(),i._locked=!1):(i._locked=!1,i._rotateRight())},125):setTimeout(function(){i.__rotateRightOneCell((t+1)%12)},125)},this._rotateLeft=function(){if(!this._locked){this._locked=!0,this._saveState(),this._newPattern=[];for(var t=1;t<12;t++)this._newPattern.push(this._selectedNotes[t]);this._newPattern.push(this._selectedNotes[0]),this.__rotateLeftOneCell(11)}},this.__rotateLeftOneCell=function(t){this._selectedNotes[t]=this._newPattern[t],this._selectedNotes[t]?this._noteWheel.navItems[t].navItem.show():this._noteWheel.navItems[t].navItem.hide();var e=this;0===t?setTimeout(function(){e._selectedNotes[0]?(e._saveState(),e._setModeName(),e._locked=!1):(e._locked=!1,e._rotateLeft())},125):setTimeout(function(){e.__rotateLeftOneCell(t-1)},125)},this._playAll=function(){if(!this._locked){this._logo.synth.stop(),this._locked=!0,this._notesToPlay=[];for(var t=0;t<12;t++)this._selectedNotes[t]&&this._notesToPlay.push(t);this._notesToPlay.push(12),this._notesToPlay.push(12);for(t=11;-1<t;t--)this._selectedNotes[t]&&this._notesToPlay.push(t);this._lastNotePlayed=null,this._playing&&this.__playNextNote(0)}},this.__playNextNote=function(i){time=this._noteValue+.125;var s=this;i>this._notesToPlay.length-1?setTimeout(function(){s._playing=!1,s._playButton.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play all")+'" alt="'+_("Play all")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',s._resetNotes(),s._locked=!1},1e3*time):setTimeout(function(){null!==s._lastNotePlayed&&s._playWheel.navItems[s._lastNotePlayed%12].navItem.hide(),note=s._notesToPlay[i],s._playWheel.navItems[note%12].navItem.show(),s._lastNotePlayed=note;var t=s._logo.keySignature[0],e=getNote(s._pitch,4,note,t,!1,null,s._logo.errorMsg);if(s._logo.synth.trigger(0,e[0].replace(//g,"#").replace(//g,"b")+e[1],s._noteValue,DEFAULTVOICE,null,null),!s._playing)return s._locked=!1,void setTimeout(s._resetNotes(),500);s.__playNextNote(i+1)},1e3*time)},this._playNote=function(t){var e=this._logo.keySignature[0],i=getNote(this._pitch,4,t,e,!1,null,this._logo.errorMsg);this._logo.synth.trigger(0,i[0].replace(//g,"#").replace(//g,"b")+i[1],this._noteValue,DEFAULTVOICE,null,null)},this._saveState=function(){state=JSON.stringify(this._selectedNotes),state!==last(this._undoStack)&&this._undoStack.push(JSON.stringify(this._selectedNotes))},this._undo=function(){if(0<this._undoStack.length){for(var t=JSON.parse(this._undoStack.pop()),e=0;e<12;e++)this._selectedNotes[e]=t[e];this._resetNotes(),this._setModeName()}},this._clear=function(){this._saveState();for(var t=1;t<12;t++)this._selectedNotes[t]=!1;this._resetNotes(),this._setModeName()},this._calculateMode=function(){for(var t=[],e=(docById("modeTable"),1),i=1;i<12;i++)this._selectedNotes[i]?(t.push(e),e=1):e+=1;return t.push(e),t},this._setModeName=function(){var t=docById("modeTable"),e=t.rows.length-1,i=JSON.stringify(this._calculateMode()),s=keySignatureToMode(this._logo.keySignature[0])[0];for(var l in MUSICALMODES)if(JSON.stringify(MUSICALMODES[l])===i)return null!=this._modeBlock&&(console.log("setModeName:"+l),this._logo.blocks.blockList[this._modeBlock].value=l,this._logo.blocks.blockList[this._modeBlock].text.text=_(l),this._logo.blocks.blockList[this._modeBlock].updateCache(),this._logo.refreshCanvas()),void(t.rows[e].cells[0].innerHTML=s+" "+_(l));t.rows[e].cells[0].innerHTML=""},this._save=function(){var t=docById("modeTable"),e=t.rows.length-1;""===t.rows[e].cells[0].innerHTML&&(customMode=this._calculateMode(),console.log("custom mode: "+customMode),storage.custommode=JSON.stringify(customMode));var i=t.rows[e].cells[0].innerHTML;""===i&&(i=_("custom"));for(var s=[[0,["action",{collapsed:!0}],100,100,[null,1,2,null]],[1,["text",{value:i}],0,0,[0]]],l=0,o=this._calculateMode().length,a=0,n=0;n<12;n++){var r=11-n;if(this._selectedNotes[r]){a+=1;var c=NOTESTABLE[(1+r)%12];console.log(c+" 4");var h=s.length,u=h+1,d=h+2;a===o?s.push([h,"pitch",0,0,[l,u,d,null]]):s.push([h,"pitch",0,0,[l,u,d,h+3]]),s.push([u,["solfege",{value:c}],0,0,[h]]),s.push([d,["number",{value:4}],0,0,[h]]);l=h}}console.log(s),this._logo.blocks.loadNewBlocks(s);for(s=[[0,"definemode",150,120,[null,1,3,2]],[1,["modename",{value:i}],0,0,[0]],[2,"hidden",0,0,[0,null]]],l=0,o=this._calculateMode().length,a=0,n=0;n<12;n++)if(this._selectedNotes[n]){a+=1;var f=s.length;a===o?s.push([f,"pitchnumber",0,0,[l,f+1,null]]):s.push([f,"pitchnumber",0,0,[l,f+1,f+2]]),s.push([f+1,["number",{value:n}],0,0,[f]]);l=f}console.log(s);var p=this;setTimeout(function(){p._logo.blocks.loadNewBlocks(s)},2e3)},this._piemenuMode=function(){docById("meterWheelDiv").style.display="",this._modeWheel=new wheelnav("meterWheelDiv",null,400,400),this._noteWheel=new wheelnav("_noteWheel",this._modeWheel.raphael),this._playWheel=new wheelnav("_playWheel",this._modeWheel.raphael),wheelnav.cssMeter=!0,this._modeWheel.colors=platformColor.modeWheelcolors,this._modeWheel.slicePathFunction=slicePath().DonutSlice,this._modeWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._modeWheel.slicePathCustom.minRadiusPercent=.4,this._modeWheel.slicePathCustom.maxRadiusPercent=.75,this._modeWheel.sliceSelectedPathCustom=this._modeWheel.slicePathCustom,this._modeWheel.sliceInitPathCustom=this._modeWheel.slicePathCustom,this._modeWheel.clickModeRotate=!1,this._modeWheel.navAngle=-90;for(var t=["0","1","2","3","4","5","6","7","8","9","10","11"],e=[],i=this._modeWheel.animatetime=0;i<12;i++)e.push(t[i]);this._modeWheel.createWheel(e),this._noteWheel.colors=platformColor.noteValueWheelcolors,this._noteWheel.slicePathFunction=slicePath().DonutSlice,this._noteWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._noteWheel.slicePathCustom.minRadiusPercent=.75,this._noteWheel.slicePathCustom.maxRadiusPercent=.9,this._noteWheel.sliceSelectedPathCustom=this._noteWheel.slicePathCustom,this._noteWheel.sliceInitPathCustom=this._noteWheel.slicePathCustom,this._noteWheel.clickModeRotate=!1,this._noteWheel.navAngle=-90,this._noteWheel.titleRotateAngle=90;e=[" "];this._selectedNotes=[!0];for(i=1;i<12;i++)e.push("x"),this._selectedNotes.push(!1);this._noteWheel.createWheel(e),this._playWheel.colors=[platformColor.orange],this._playWheel.slicePathFunction=slicePath().DonutSlice,this._playWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._playWheel.slicePathCustom.minRadiusPercent=.3,this._playWheel.slicePathCustom.maxRadiusPercent=.4,this._playWheel.sliceSelectedPathCustom=this._playWheel.slicePathCustom,this._playWheel.sliceInitPathCustom=this._playWheel.slicePathCustom,this._playWheel.clickModeRotate=!1,this._playWheel.navAngle=-90,this._playWheel.titleRotateAngle=90;for(e=[],i=0;i<12;i++)e.push(" ");this._playWheel.createWheel(e);for(i=0;i<12;i++)this._playWheel.navItems[i].navItem.hide();var s=this,l=function(){var t=s._modeWheel.selectedNavItemIndex;s._saveState(),s._selectedNotes[t]=!0,s._noteWheel.navItems[t].navItem.show(),s._playNote(t),s._setModeName()},o=function(){var t=s._noteWheel.selectedNavItemIndex;0!=t&&(s._noteWheel.navItems[t].navItem.hide(),s._saveState(),s._selectedNotes[t]=!1,s._setModeName())};for(i=0;i<12;i++)s._modeWheel.navItems[i].navigateFunction=l,s._noteWheel.navItems[i].navigateFunction=o,s._noteWheel.navItems[i].navItem.hide()}}function MusicKeyboard(){var k=(new Tone.Synth).toMaster();this.noteNames=[],this.octaves=[];var t=document.getElementById("keyboard"),i=(document.getElementById("keyboardHolder2"),document.getElementById("firstOctave"),document.getElementById("firstNote"),document.getElementById("secondOctave"),document.getElementById("secondNote"),document.getElementById("white")),v=(document.getElementById("black"),[]),y=[];this.processClick=function(t){var e=this.noteNames[t];if("hertz"===e)var i=this.octaves[t];else if(e in FIXEDSOLFEGE1)i=FIXEDSOLFEGE1[e].replace(SHARP,"#").replace(FLAT,"b")+this.octaves[t];else i=e.replace(SHARP,"#").replace(FLAT,"b")+this.octaves[t];y.push(i),k.triggerAttackRelease(i,"8n")},this.loadHandler=function(t,e){var i=this;t.onclick=function(){i.processClick(e)}},this.init=function(t){this._logo=t;var e=window.innerWidth;this._cellScale=e/1200;this._cellScale;var i=docById("myCanvas"),s=docById("mkbDiv");s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var l=docById("mkbButtonsDiv");l.style.display="inline",l.style.visibility="visible",l.style.width=295,l.innerHTML='<table cellpadding="0px" id="mkbButtonTable"></table>',document.getElementById("myrow").innerHTML="",document.getElementById("myrow2").innerHTML="",v=[],y=[];var o=docById("mkbButtonTable").createTHead().insertRow(0),a=this;if(0===this.noteNames.length){for(var n=0;n<PITCHES3.length;n++)this.noteNames.push(PITCHES3[n]),this.octaves.push(4),4===n&&(this.noteNames.push(null),this.octaves.push(4));this.noteNames.push(PITCHES3[0]),this.octaves.push(5)}document.getElementById("keyboardHolder2").style.display="block";for(var r=[],c=0;c<this.noteNames.length;c++)if(null===this.noteNames[c]){var h=document.getElementById("myrow2"),u=document.createElement("td"),d=document.getElementsByTagName("td").length;u.setAttribute("id",d),r.push(d),u.innerHTML="",u.style.visibility="hidden",h.appendChild(u)}else if("hertz"===this.noteNames[c]){var f=document.getElementById("myrow"),p=document.createElement("td"),b=document.getElementsByTagName("td").length;p.setAttribute("id",b),r.push(b),p.innerHTML=this.octaves[c],f.appendChild(p)}else if(-1!==this.noteNames[c].indexOf(SHARP)||-1!==this.noteNames[c].indexOf("#")){h=document.getElementById("myrow2"),u=document.createElement("td"),d=document.getElementsByTagName("td").length;u.setAttribute("id",d),r.push(d);var m=this.noteNames[c].replace(SHARP,"").replace("#","");-1!==SOLFEGENAMES.indexOf(m)?u.innerHTML=i18nSolfege(m)+SHARP+this.octaves[c]:u.innerHTML=this.noteNames[c]+this.octaves[c],h.appendChild(u)}else if(-1!==this.noteNames[c].indexOf(FLAT)||-1!==this.noteNames[c].indexOf("b")){h=document.getElementById("myrow2"),u=document.createElement("td"),d=document.getElementsByTagName("td").length;u.setAttribute("id",d),r.push(d);m=this.noteNames[c].replace(FLAT,"").replace("b","");-1!==SOLFEGENAMES.indexOf(m)?u.innerHTML=i18nSolfege(m)+FLAT+this.octaves[c]:u.innerHTML=this.noteNames[c]+this.octaves[c],h.appendChild(u)}else{f=document.getElementById("myrow"),p=document.createElement("td"),b=document.getElementsByTagName("td").length;p.setAttribute("id",b),r.push(b),-1!==SOLFEGENAMES.indexOf(this.noteNames[c])?p.innerHTML=i18nSolfege(this.noteNames[c])+this.octaves[c]:p.innerHTML=this.noteNames[c]+this.octaves[c],f.appendChild(p)}for(n=0;n<r.length;n++)this.loadHandler(document.getElementById(r[n]),n);this._addButton(o,"close-button.svg",32,_("close")).onclick=function(){s.style.visibility="hidden",l.style.visibility="hidden",document.getElementById("keyboardHolder").style.display="none",document.getElementById("keyboardHolder2").style.display="none",document.getElementById("myrow").innerHTML="",document.getElementById("myrow2").innerHTML="",v=[],y=[]},this._addButton(o,"play-button.svg",32,_("Play")).onclick=function(){if(a._logo.setTurtleDelay(0),0<v.length)for(var t=0;t<v.length;t++){var e=v[t].replace(SHARP,"#").replace(FLAT,"b");k.triggerAttackRelease(e,"8n"),T(500)}else for(t=0;t<y.length;t++){e=y[t].replace(SHARP,"#").replace(FLAT,"b");k.triggerAttackRelease(e,"8n"),T(500)}},this._addButton(o,"export-chunk.svg",32,_("Save")).onclick=function(){0<v.length?a._save(v):a._save(y)},this._addButton(o,"erase-button.svg",32,_("Clear")).onclick=function(){v=[],y=[]};var g=this._addButton(o,"grab.svg",32,_("Drag"));g.style.cursor="move",this._dx=g.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=g.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=g.innerHTML,g.onmouseover=function(t){g.innerHTML=""},g.onmouseout=function(t){a._dragging||(g.innerHTML=a._dragCellHTML)},i.ondragover=function(t){a._dragging=!0,t.preventDefault()},i.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",g.innerHTML=a._dragCellHTML}},s.ondragover=function(t){a._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",g.innerHTML=a._dragCellHTML}},s.onmousedown=function(t){a._target=t.target},s.ondragstart=function(t){g.contains(a._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()}},t.addEventListener("mousedown",function(t){var e=t.target;"TD"===e.tagName&&("lightgrey"!==e.style.backgroundColor&&"rgb(72,72,72)"!==e.style.backgroundColor&&(v.push(e.textContent),e.parentNode===i?e.style.backgroundColor="lightgrey":e.style.backgroundColor="rgb(72,72,72)"),function(t){keys=t.split("/"),1===keys.length?k.triggerAttackRelease(keys[0].replace(SHARP,"#").replace(FLAT,"b"),"8n"):k.triggerAttackRelease(keys[1].replace(SHARP,"#").replace(FLAT,"b"),"8n")}(e.textContent))}),t.addEventListener("mouseup",function(t){var e=t.target;"TD"===e.tagName&&(e.parentNode===i?e.style.backgroundColor="white":e.style.backgroundColor="black")});function T(t){for(var e=(new Date).getTime(),i=0;i<1e7&&!((new Date).getTime()-e>t);i++);}this._save=function(t){console.log("generating keyboard pitches for: "+t);for(var e=[[0,["action",{collapsed:!1}],100,100,[null,1,null,null]],[1,["text",{value:_("action")}],0,0,[0]]],i=0,s=0;s<t.length;s++){if("string"==typeof t[s])var l=(o=t[s].slice(0)).substring(0,o.length-1);else var o=t[s];var a=e.length;e.push([a,"note",0,0,[i,a+1,a+2,null]]);var n=e[a][4].length;0===s?e[i][4][n-2]=a:e[i][4][n-1]=a;i=a;e.push([a+1,["number",{value:"4"}],0,0,[a]]);var r=a+2,c=a;"string"==typeof t[s]?(e.push([r,"pitch",0,0,[c,r+1,r+2,null]]),-1!==["#","b","",""].indexOf(l[1])?e.push([r+1,["solfege",{value:SOLFEGECONVERSIONTABLE[o[0]]+o[1]}],0,0,[r]]):e.push([r+1,["solfege",{value:SOLFEGECONVERSIONTABLE[l[0]]}],0,0,[r]]),e.push([r+2,["number",{value:o[o.length-1]}],0,0,[r]])):(e.push([r,"hertz",0,0,[c,r+1,null]]),e.push([r+1,["number",{value:o}],0,0,[r]]))}console.log(e),this._logo.blocks.loadNewBlocks(e)},this.clearBlocks=function(){this.noteNames=[],this.octaves=[]},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l}}function PitchDrumMatrix(){this.rowLabels=[],this.rowArgs=[],this.drums=[],this._rests=0,this._rowBlocks=[],this._colBlocks=[],this._blockMap=[],this.clearBlocks=function(){this._rowBlocks=[],this._colBlocks=[]},this.addRowBlock=function(t){this._rowBlocks.push(t)},this.addColBlock=function(t){this._colBlocks.push(t)},this.addNode=function(t,e){for(var i=0;i<this._blockMap.length;i++){var s=this._blockMap[i];if(s[0]===t&&s[1]===e)return}this._blockMap.push([t,e])},this.removeNode=function(t,e){for(var i=0;i<this._blockMap.length;i++){var s=this._blockMap[i];s[0]===t&&s[1]===e&&(this._blockMap[i]=[-1,-1])}},this._get_save_lock=function(){return this._save_lock},this.init=function(t){this._logo=t;var e=window.innerWidth;this._cellScale=e/1200;this._cellScale;var i=docById("myCanvas"),s=docById("pdmDiv");s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var l=docById("pdmButtonsDiv");l.style.display="inline",l.style.visibility="visible",l.style.width=295,l.innerHTML='<table cellpadding="0px" id="pdmButtonTable"></table>';var o=docById("pdmButtonTable").createTHead().insertRow(0),a=this;(n=this._addButton(o,"close-button.svg",32,_("Close"))).onclick=function(){s.style.visibility="hidden",l.style.visibility="hidden",c.style.visibility="hidden",a._logo.hideMsgs()},(n=this._addButton(o,"play-button.svg",32,_("Play"))).onclick=function(){a._logo.setTurtleDelay(0),a._playAll()};var n=this._addButton(o,"export-chunk.svg",32,_("Save"));this._save_lock=!1,n.onclick=function(){a._get_save_lock()||(a._save_lock=!0,a._save(),setTimeout(function(){a._save_lock=!1},1e3))},(n=this._addButton(o,"erase-button.svg",32,_("Clear"))).onclick=function(){a._clear()};var r=this._addButton(o,"grab.svg",32,_("Drag"));r.style.cursor="move",this._dx=r.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=r.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=r.innerHTML,r.onmouseover=function(t){r.innerHTML=""},r.onmouseout=function(t){a._dragging||(r.innerHTML=a._dragCellHTML)},i.ondragover=function(t){a._dragging=!0,t.preventDefault()},i.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",r.innerHTML=a._dragCellHTML}},s.ondragover=function(t){a._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",r.innerHTML=a._dragCellHTML}},s.onmousedown=function(t){a._target=t.target},s.ondragstart=function(t){r.contains(a._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};var c=docById("pdmTableDiv");c.style.display="inline",c.style.visibility="visible",c.style.border="0px",c.innerHTML="",c.innerHTML='<div id="pdmOuterDiv"><div id="pdmInnerDiv"><table cellpadding="0px" id="pdmTable"></table></div></div>';for(var h=docById("pdmTable"),u=0,d=0;d<this.rowLabels.length;d++)if(this.rowLabels[d].toLowerCase()!==_("rest")){var f,p,b=getDrumName(this.rowLabels[d]);if(null==b)(p=(f=h.insertRow()).insertCell()).style.backgroundColor=platformColor.labelColor,p.style.fontSize=100*this._cellScale+"%",p.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+1+"px",p.style.width=Math.floor(MATRIXSOLFEWIDTH*this._cellScale)+"px",p.style.minWidth=p.style.minWidth,p.style.maxWidth=p.style.minWidth,p.className="headcol",p.innerHTML=this.rowLabels[u]+this.rowArgs[u].toString().sub(),f.insertCell().innerHTML='<table cellpadding="0px" id="pdmCellTable'+u+'"><tr></tr></table>',docById("pdmCellTable"+u).insertRow().setAttribute("id","pdm"+u),u+=1;else this.drums.push(b)}else this._rests+=1;(p=(f=h.insertRow()).insertCell()).style.backgroundColor=platformColor.labelColor,p.style.fontSize=100*this._cellScale+"%",p.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",p.style.width=Math.floor(MATRIXSOLFEWIDTH*this._cellScale)+"px",p.style.minWidth=Math.floor(MATRIXSOLFEWIDTH*this._cellScale)+"px",p.style.maxWidth=p.style.minWidth,p.className="headcol",p.innerHTML="";var m=Math.max(Math.floor(.5*window.innerHeight/100),8),g=docById("pdmOuterDiv");if(h.rows.length+2>m){g.style.height=window.innerHeight/2+"px";var k=Math.max(Math.min(window.innerWidth/2,this._cellScale*(52*this.drums.length+MATRIXSOLFEWIDTH+24)),295)}else{g.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(h.rows.length+3)+"px";k=Math.max(Math.min(window.innerWidth/2,this._cellScale*(52*this.drums.length+MATRIXSOLFEWIDTH)),295)}g.style.width=k+"px";var v=docById("pdmInnerDiv"),y=Math.min(k-100,this._cellScale*this.drums.length*52);v.style.width=y+"px",v.style.marginLeft=53*this._cellScale+"px",f.insertCell().innerHTML='<table cellpadding="0px" id="pdmDrumTable"><tr></tr></table>';for(d=0;d<this.drums.length;d++)this._addDrum(d);this._logo.textMsg(_("Click in the grid to map notes to drums."))},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._addDrum=function(t){for(var e=this.drums[t],i=docById("pdmTable"),s=0;s<i.rows.length-1;s++){(l=docById("pdmCellTable"+s).rows[0].insertCell()).style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+1+"px",l.width=50,l.style.width=l.width,l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){"black"!==this.style.backgroundColor&&(this.style.backgroundColor=platformColor.selectorSelected)},l.onmouseout=function(){"black"!==this.style.backgroundColor&&(this.style.backgroundColor=platformColor.selectorBackground)},l.setAttribute("id",s+","+t)}var l;(l=docById("pdmDrumTable").rows[0].insertCell()).height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+1+"px",l.width=50,l.style.width=l.width,l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",l.style.fontSize=Math.floor(75*this._cellScale)+"%",l.style.lineHeight="100%",l.setAttribute("id",t);var o=getDrumName(e);""===o&&(o=e),l.innerHTML='&nbsp;&nbsp;<img src="'+getDrumIcon(o)+'" title="'+o+'" alt="'+o+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',l.style.backgroundColor=platformColor.selectorBackground},this.makeClickable=function(){for(var t=docById("pdmTable"),e=docById("pdmDrumTable"),i=0;i<t.rows.length-1;i++)for(var s=docById("pdmCellTable"+i).rows[0],l=this,o=0;o<s.cells.length;o++){c=s.cells[o];e.rows[0].cells[o];c.onclick=function(){var t=this.id.split(",");"black"===this.style.backgroundColor?(this.style.backgroundColor=platformColor.selectorBackground,l._setCellPitchDrum(t[1],t[0],!1)):(this.style.backgroundColor="black",l._setCellPitchDrum(t[1],t[0],!0))}}for(i=0;i<this._blockMap.length;i++){var a=this._blockMap[i];if(-1!==a[0]){var n=this._rowBlocks.indexOf(a[0]),r=-1;for(o=0;o<this._colBlocks.length;o++)if(this._colBlocks[o]===a[1]){r=o;break}if(-1===r)continue;var c=(s=docById("pdmCellTable"+n).rows[0]).cells[r];null!=c&&(c.style.backgroundColor="black",this._setPairCell(n,r,c,!1))}}},this._playAll=function(){this._logo.synth.stop();for(var t=[],e=docById("pdmTable"),i=0;i<e.rows.length-1;i++){for(var s=docById("pdmCellTable"+i).rows[0],l=0;l<s.cells.length;l++){if("black"===s.cells[l].style.backgroundColor){t.push([i,l]);break}}l===s.cells.length&&t.push([i,-1])}(i=0)<t.length&&this._playPitchDrum(i,t)},this._playPitchDrum=function(e,i){docById("pdmDrumTable").rows[0].cells[e];var s=docById("pdmTable"),t=docById("pdmCellTable"+e).rows[0].cells[e];if((s=docById("pdmTable")).rows[e].cells[0].style.backgroundColor=platformColor.selectorBackground,-1!==i[e][1]&&this._setPairCell(i[e][0],i[e][1],t,!0),e<i.length-1){var l=this;setTimeout(function(){var t=e+1;l._playPitchDrum(t,i)},1e3)}else setTimeout(function(){for(var t=0;t<s.rows.length-1;t++){s.rows[t].cells[0].style.backgroundColor=platformColor.labelColor}},1e3)},this._setCellPitchDrum=function(t,e,i){var s=Number(t),l=Number(e),o=((o=docById("pdmDrumTable").rows[0]).cells[s],docById("pdmTable"),docById("pdmCellTable"+l).rows[0]);if(i)for(var a=0;a<o.cells.length;a++)if(a!==s&&(cell=o.cells[a],"black"===cell.style.backgroundColor)){var n=this._rowBlocks[l],r=this._colBlocks[a];this.removeNode(n,r),cell.style.backgroundColor=platformColor.selectorBackground;var c=cell.id.split(",");this._setCellPitchDrum(Number(c[0]),Number(c[1]),!1)}n=this._rowBlocks[l],r=this._colBlocks[s];i?this.addNode(n,r):this.removeNode(n,r);for(o=docById("pdmCellTable"+l).rows[0],a=0;a<o.cells.length;a++)cell=o.cells[a],"black"===cell.style.backgroundColor&&this._setPairCell(l,a,cell,i)},this._setPairCell=function(t,e,i,s){var l=docById("pdmTable").rows[t].cells[0].innerHTML,o=getDrumSynthName(docById("pdmDrumTable").rows[0].cells[e].innerHTML.split('"')[3]),a=getNote(l,-1,0,this._logo.keySignature[0],!1,null,this._logo.errorMsg),n=a[0]+a[1];if(s){var r=1e3*this._logo.defaultBPMFactor*.25;this._logo.synth.trigger(0,n.replace(//g,"b").replace(//g,"#"),.125,"default",null,null);var c=this;setTimeout(function(){c._logo.synth.trigger(0,"C2",.125,o,null,null)},r)}},this._clear=function(){for(var t=docById("pdmTable"),e=0;e<t.rows.length-1;e++)for(var i=docById("pdmCellTable"+e).rows[0],s=0;s<i.cells.length;s++){var l=i.cells[s];"black"===l.style.backgroundColor&&(l.style.backgroundColor=platformColor.selectorBackground,this._setCellPitchDrum(s,e,!1))}},this._save=function(){for(var t in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[t].hideMenu(!0);this._logo.refreshCanvas();for(var e=[],i=docById("pdmTable"),s=docById("pdmDrumTable"),l=0;l<i.rows.length-1;l++)for(var o=docById("pdmCellTable"+l).rows[0],a=0;a<o.cells.length;a++){"black"!==o.cells[a].style.backgroundColor||e.push([l,a])}if(0!==e.length){var n=[[0,["action",{collapsed:!0}],100,100,[null,1,2,null]],[1,["text",{value:"drums"}],0,0,[0]]],r=0;for(l=0;l<e.length;l++){o=e[l][0];var c=e[l][1],h=i.rows[o].cells[0].innerHTML,u=getDrumSynthName(s.rows[0].cells[c].innerHTML.split('"')[3]),d=getNote(h,-1,0,this._logo.keySignature[0],!1,null,this._logo.errorMsg),f=d[0],p=d[1],b=n.length,m=b+1,g=b+2,k=b+3,v=b+4,y=b+5;n.push([b,"setdrum",0,0,[r,m,g,y]]),n.push([m,["drumname",{value:u}],0,0,[b]]),n.push([g,"pitch",0,0,[b,k,v,null]]),n.push([k,["solfege",{value:SOLFEGECONVERSIONTABLE[f]}],0,0,[g]]),n.push([v,["number",{value:p}],0,0,[g]]),l===e.length-1?n.push([y,"hidden",0,0,[b,null]]):n.push([y,"hidden",0,0,[b,y+1]]);r=y}console.log(n),this._logo.blocks.loadNewBlocks(n)}}}function PitchSlider(){var v=Math.pow(2,1/12);this.Sliders=[],this._focusedCellIndex=0,this._isKeyPressed=0,this._delta=0,this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="51px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._play=function(t){var e=t.cellIndex,i=this.Sliders[e][0]*Math.pow(v,this.Sliders[e][1]);this._logo.synth.trigger(0,i,1,DEFAULTVOICE,null,null)},this._moveSlider=function(t,e){var i=t.cellIndex,s=docById("slider"),l=s.cells[i].childNodes[0],o=l.childNodes[0],a=(parseFloat(Math.floor(SLIDERWIDTH*this._cellScale)),2*this.Sliders[i][0]),n=this.Sliders[i][1]+1*e,r=this.Sliders[i][0]*Math.pow(v,n);if(!(a<r||r<this.Sliders[i][0])){this.Sliders[i][2]=0,this.Sliders[i][1]=n;var c=Number(l.style.top.replace("px",""));l.style.top=c-e*SLIDERHEIGHT/12+"px",o.innerHTML=r.toFixed(this.places),this._logo.synth.stop(),this._play(s.cells[i])}},this._save=function(t){var e=t.cellIndex,i=this.Sliders[e][0]*Math.pow(v,this.Sliders[e][1]);for(var s in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[s].hideMenu(!0);this._logo.refreshCanvas();var l=[[0,"note",100+this._delta,100+this._delta,[null,1,2,null]],[1,["number",{value:8}],0,0,[0]]];this._delta+=21;var o=l.length,a=o+1,n=o+2;l.push([o,"hertz",0,0,[0,a,n]]),l.push([a,["number",{value:i.toFixed(this.places)}],0,0,[o]]),l.push([n,"hidden",0,0,[o,null]]),this._logo.blocks.loadNewBlocks(l)},this._addKeyboardInput=function(e){var i=this;e.focus(),e.addEventListener("keydown",function(t){i._isKeyPressed=0,37<=t.keyCode&&t.keyCode<=40?i._isKeyPressed=1:13===t.keyCode&&(i._isKeyPressed=1)}),e.addEventListener("keyup",function(t){1===i._isKeyPressed&&(i._isKeyPressed=0,38===t.keyCode&&i._moveSlider(e,1),40===t.keyCode&&i._moveSlider(e,-1),37===t.keyCode&&i._focusCell(e,-1),39===t.keyCode&&i._focusCell(e,1),13===t.keyCode&&i._save(e))})},this._focusCell=function(t,e){var i=t.cellIndex+e;i<0&&(i=this.Sliders.length-1),i>this.Sliders.length-1&&(i=0),t.blur();var s=docById("slider").cells[i];this._addKeyboardInput(s)},this.init=function(t){this._logo=t,beginnerMode?this.places=0:this.places=2;var e=window.innerWidth;this._cellScale=1;var i=docById("myCanvas"),s=docById("sliderDiv");s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var l=docById("sliderButtonsDiv");l.style.display="inline",l.style.visibility="visible",l.style.width=118,l.innerHTML='<table id="sliderButtonTable"></table>';var o,a=docById("sliderButtonTable").createTHead().insertRow(0),r=this;(o=this._addButton(a,"close-button.svg",32,_("Close"))).onclick=function(){s.style.visibility="hidden",l.style.visibility="hidden",n.style.visibility="hidden",r._logo.hideMsgs()},o.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},o.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},(o=this._addButton(a,"grab.svg",32,_("Drag"))).style.cursor="move",this._dx=o.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=o.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=o.innerHTML,o.onmouseover=function(t){o.innerHTML=""},o.onmouseout=function(t){r._dragging||(o.innerHTML=r._dragCellHTML)},i.ondragover=function(t){r._dragging=!0,t.preventDefault()},i.ondrop=function(t){if(r._dragging){r._dragging=!1;var e=t.clientX-r._dx;s.style.left=e+"px";var i=t.clientY-r._dy;s.style.top=i+"px",o.innerHTML=r._dragCellHTML}},s.ondragover=function(t){r._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(r._dragging){r._dragging=!1;var e=t.clientX-r._dx;s.style.left=e+"px";var i=t.clientY-r._dy;s.style.top=i+"px",o.innerHTML=r._dragCellHTML}},s.onmousedown=function(t){r._target=t.target},s.ondragstart=function(t){o.contains(r._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};var n=docById("sliderTableDiv");n.style.display="inline",n.style.visibility="visible",n.style.border="2px",n.innerHTML="",n.innerHTML='<div id="sliderOuterDiv"><div id="sliderInnerDiv"><table id="sliderSliderTable"></table></div></div>';var c=docById("sliderOuterDiv");c.style.width=Math.min(11+this.Sliders.length*SLIDERWIDTH,e/2)+"px",c.style.height=11+SLIDERHEIGHT+153+"px";var h=docById("sliderInnerDiv");h.style.width=10+this.Sliders.length*SLIDERWIDTH+"px",h.style.height=10+SLIDERHEIGHT+153+"px";var u=docById("sliderSliderTable"),d=u.insertRow();d.setAttribute("id","slider");for(var f=u.insertRow(),p=u.insertRow(),b=0;b<this.Sliders.length;b++){var m=d.insertCell();m.style.width=SLIDERWIDTH*this._cellScale+"px",m.style.minWidth=m.style.width,m.style.maxWidth=m.style.width,m.style.height=(51+SLIDERHEIGHT)*this._cellScale+"px",m.style.backgroundColor=platformColor.selectorBackground,m.setAttribute("tabIndex",1);var g=document.createElement("div");g.setAttribute("id","sliderInCell"),g.setAttribute("position","absolute"),g.style.height=Math.floor(e/SLIDERHEIGHT)+"px",g.style.width=Math.floor(SLIDERWIDTH*this._cellScale)+"px",g.style.top=SLIDERHEIGHT+"px",g.style.backgroundColor=platformColor.selectorBackground,m.appendChild(g);var k=document.createElement("P");k.innerHTML=this.Sliders[b][0].toFixed(this.places),g.appendChild(k),m.onmouseover=function(t){r._addKeyboardInput(this)},m.onmouseout=function(){this.blur()},m.onmousemove=function(t){var e=this.childNodes[0],i=t.pageY-this.getBoundingClientRect().top;if(SLIDERHEIGHT<i)i=SLIDERHEIGHT;else if(i<0)i=0;var s=this.cellIndex;(e=docById("slider").cells[s].childNodes[0]).style.top=i+"px";var l=Math.max(SLIDERHEIGHT-i,0),o=parseFloat(r.Sliders[s][0])/SLIDERHEIGHT*l;r.Sliders[s][1]=12*Math.log2(parseFloat(r.Sliders[s][0]+o)/r.Sliders[s][0]),r.Sliders[s][2]=o-r.Sliders[s][0]*Math.pow(v,r.Sliders[s][1]);var a=e.childNodes[0],n=r.Sliders[s][0]*Math.pow(v,r.Sliders[s][1]);a.innerHTML=n.toFixed(r.places),r._play(this)},m.onclick=function(){r._save(this)},this._addButton(f,"up.svg",32,_("Move up")).onclick=function(){r._moveSlider(this,1)},this._addButton(p,"down.svg",32,_("Move down")).onclick=function(){r._moveSlider(this,-1)}}this._logo.textMsg(_("Click on the slider to create a note block."))}}function PitchStaircase(){this.Stairs=[],this.stairPitchBlocks=[],this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._makeStairs=function(t,e){window.innerWidth,this._cellScale;var i=docById("pscTable");if(i.innerHTML="",i.style.textAlign="center",e)this.Stairs.length;else this.Stairs.length;for(var s=this,l=0;l<this.Stairs.length;l++){i.insertRow().insertCell().innerHTML='<table cellpadding="0px" id="stepTable'+l+'"></table>';var o=docById("stepTable"+l).insertRow(),a=this.Stairs[l][2],n=this._addButton(o,"play-button.svg",32,_("Play"));n.className="headcol",n.setAttribute("id",l);var r=o.insertCell();r.setAttribute("id",a),r.style.width=600*parseFloat(220/a)*this._cellScale/3+"px",r.innerHTML=a.toFixed(2)+"<br>"+this.Stairs[l][0]+this.Stairs[l][1],r.style.minWidth=r.style.width,r.style.maxWidth=r.style.width,r.style.height="53px",r.style.backgroundColor=platformColor.selectorBackground;var c=Number(r.style.width.replace(/px/,"")),h=c.toString(),u=(c/55).toString(),d=(165/c).toString(),f="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(SYNTHSVG.replace(/SVGWIDTH/g,h).replace(/XSCALE/g,u).replace(/STOKEWIDTH/g,d))));r.style.backgroundImage="url("+f+")",r.style.backgroundRepeat="no-repeat",r.style.backgroundPosition="center center",r.addEventListener("click",function(t){s._dissectStair(t)}),n.onclick=function(){var t=docById("stepTable"+this.getAttribute("id")).rows[0].cells[1];s._playOne(t)}}},this._undo=function(){if(0===this._history.length)return console.log("nothing for undo to undo"),!1;var t=this._history.pop();this.Stairs.splice(t,1);var e=this.stairPitchBlocks.pop();console.log("removing block "+e);var i=this._logo.blocks.blockList[e].connections[0],s=last(this._logo.blocks.blockList[e].connections);if(null!==s){if("vspace"===this._logo.blocks.blockList[s].name){var l=last(this._logo.blocks.blockList[s].connections);if("vspace"===this._logo.blocks.blockList[l].name){var o=last(this._logo.blocks.blockList[l].connections);this._logo.blocks.blockList[l].connections[1]=null}else{o=last(this._logo.blocks.blockList[s].connections);this._logo.blocks.blockList[s].connections[1]=null}}}else o=s;t=this._logo.blocks.blockList[i].connections.indexOf(e);return this._logo.blocks.blockList[i].connections[t]=o,this._logo.blocks.blockList[e].connections[0]=null,this._logo.blocks.sendStackToTrash(this._logo.blocks.blockList[e]),this._logo.blocks.blockMoved(i),this._logo.blocks.adjustDocks(this._logo.blocks.findTopBlock(i)),this._logo.blocks.clampThisToCheck=[[this._logo.blocks.findTopBlock(i),0]],this._logo.blocks.adjustExpandableClampBlock(),this._refresh(),!0},this._dissectStair=function(t){var e=docById("musicratio1").value;e=isNaN(e)?3:Math.abs(Math.floor(e)),docById("musicratio1").value=e;var i=docById("musicratio2").value;i=isNaN(i)?2:Math.abs(Math.floor(i)),docById("musicratio2").value=i,inputNum=parseFloat(i/e);for(var s=t.target,l=Number(s.getAttribute("id")),o=0;o<this.Stairs.length&&this.Stairs[o][2]!==l;o++);if(o!==this.Stairs.length){for(var a=frequencyToPitch(parseFloat(l)/inputNum),n=!1,r=!0,c=0;c<this.Stairs.length;c++){if(this.Stairs[c][2]<parseFloat(l)/inputNum){this.Stairs.splice(c,0,[a[0],a[1],parseFloat(l)/inputNum,this.Stairs[o][3]*parseFloat(i),this.Stairs[o][4]*parseFloat(e),this.Stairs[o][2]]),n=!0;break}if(this.Stairs[c][2]===parseFloat(l)/inputNum){this.Stairs.splice(c,1,[a[0],a[1],parseFloat(l)/inputNum,this.Stairs[o][3]*parseFloat(i),this.Stairs[o][4]*parseFloat(e),this.Stairs[o][2]]),r=!(n=!0);break}}n?this._history.push(c):(this.Stairs.push([a[0],a[1],parseFloat(l)/inputNum,this.Stairs[o][3]*parseFloat(i),this.Stairs[o][4]*parseFloat(e),this.Stairs[o][2]]),this._history.push(this.Stairs.length-1));this.Stairs[c][0],this.Stairs[c][1];var h=frequencyToPitch(l=this.Stairs[c][2]),u=last(this.stairPitchBlocks),d=this._logo.blocks.findBottomBlock(u),f=last(this._logo.blocks.blockList[d].connections);if(0===h[2])var p=[[0,"pitch",0,0,[null,1,2,f]],[1,["notename",{value:h[1]}],0,0,[0]],[2,["number",{value:h[1]}],0,0,[0]]];else p=[[0,"hertz",0,0,[null,1,6]],[1,"multiply",0,0,[0,2,3]],[2,["number",{value:this.Stairs[o][5].toFixed(2)}],0,0,[1]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:this.Stairs[o][4]}],0,0,[3]],[5,["number",{value:this.Stairs[o][3]}],0,0,[3]],[6,"vspace",0,0,[0,7]],[7,"vspace",0,0,[6,f]]];var b=this._logo.blocks.blockList.length;console.log(p),this._logo.blocks.loadNewBlocks(p);c=this._logo.blocks.blockList[d].connections.length-1;this._logo.blocks.blockList[d].connections[c]=b,this._logo.blocks.blockList[b].connections[0]=d,this._logo.blocks.adjustDocks(d,!0),this.stairPitchBlocks.push(b),this._makeStairs(c,r),this._resizeWidget()}else console.log("DID NOT FIND A MATCH "+l)},this._playOne=function(t){t.style.backgroundColor=platformColor.selectorBackground;var e=Number(t.getAttribute("id"));this._logo.synth.trigger(0,e,1,DEFAULTVOICE,null,null),setTimeout(function(){t.style.backgroundColor=platformColor.selectorBackground},1e3)},this._playAll=function(){for(var e=this,t=[],i=0;i<this.Stairs.length;i++){var s=this.Stairs[i][0]+this.Stairs[i][1];t.push(s.replace(//g,"b").replace(//g,"#")),docById("stepTable"+i).rows[0].cells[1].style.backgroundColor=platformColor.selectorBackground,this._logo.synth.trigger(0,t,1,DEFAULTVOICE,null,null)}setTimeout(function(){for(var t=0;t<e.Stairs.length;t++){docById("stepTable"+t).rows[0].cells[1].style.backgroundColor=platformColor.selectorBackground}},1e3)},this.playUpAndDown=function(){var t=[],e=this.Stairs[this.Stairs.length-1][0]+this.Stairs[this.Stairs.length-1][1];t.push(e.replace(//g,"b").replace(//g,"#")),docById("stepTable"+(this.Stairs.length-1)).rows[0].cells[1].style.backgroundColor=platformColor.selectorBackground,this._logo.synth.trigger(0,t,1,DEFAULTVOICE,null,null),this._playNext(this.Stairs.length-2,-1)},this._playNext=function(e,i){if("hidden"!==docById("pscDiv").style.visibility){var s=this;if(e!==this.Stairs.length){if(-1===e)return setTimeout(function(){for(var t=0;t<s.Stairs.length;t++){docById("stepTable"+t).rows[0].cells[1].style.backgroundColor=platformColor.selectorBackground}},1e3),void setTimeout(function(){s._playNext(0,1)},200);var l=[],t=this.Stairs[e][0]+this.Stairs[e][1];l.push(t.replace(//g,"b").replace(//g,"#"));docById("stepTable"+(e-i));setTimeout(function(){null!=t&&(t.rows[0].cells[1].style.backgroundColor=platformColor.selectorBackground);var t=docById("stepTable"+e);t.rows[0].cells[1].style.backgroundColor=platformColor.selectorBackground,s._logo.synth.trigger(0,l,1,DEFAULTVOICE,null,null),(e<s.Stairs.length||-1<e)&&s._playNext(e+i,i)},1e3)}else setTimeout(function(){for(var t=0;t<s.Stairs.length;t++){docById("stepTable"+t).rows[0].cells[1].style.backgroundColor=platformColor.selectorBackground}},1e3)}},this._save=function(t){for(var e in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[e].hideMenu(!0);this._logo.refreshCanvas();for(var i=[[0,["action",{collapsed:!0}],100,100,[null,1,2,null]],[1,["text",{value:"stair"}],0,0,[0]]],s=0,l=0;l<this.Stairs.length;l++){console.log(this.Stairs[l][5]+"x"+this.Stairs[l][4]+"/"+this.Stairs[l][3]);frequencyToPitch(this.Stairs[l][2]),this.Stairs[l][0],this.Stairs[l][1];var o=frequencyToPitch(this.Stairs[l][2]);if(0===o[2]){var a=i.length,n=a,r=a+1,c=a+2,h=a+3,u="hidden";i.push([n,"pitch",0,0,[s,r,c,h]]),i.push([r,["notename",{value:o[0]}],0,0,[a]]),i.push([c,["number",{value:o[1]}],0,0,[a]])}else{var d=(n=i.length)+1,f=n+2,p=n+3,b=n+4,m=n+5,g=n+6;h=n+7,u="vspace";i.push([n,"hertz",0,0,[s,d,g]]),i.push([d,"multiply",0,0,[n,f,p]]),i.push([f,["number",{value:this.Stairs[l][5].toFixed(2)}],0,0,[d]]),i.push([p,"divide",0,0,[d,b,m]]),i.push([b,["number",{value:this.Stairs[l][4]}],0,0,[p]]),i.push([m,["number",{value:this.Stairs[l][3]}],0,0,[p]]),i.push([g,"vspace",0,0,[n,h]]),n=g}l===this.Stairs.length-1?i.push([h,u,0,0,[n,null]]):i.push([h,u,0,0,[n,h+1]]),s=h}this._logo.blocks.loadNewBlocks(i)},this._get_save_lock=function(){return this._save_lock},this.init=function(t){this._logo=t;for(var e=0;e<this.Stairs.length;e++)this.Stairs[e].push(1),this.Stairs[e].push(1),this.Stairs[e].push(this.Stairs[e][2]);this._history=[];var i=window.innerWidth;this._cellScale=i/1200;this._cellScale;var s=docById("pscDiv");s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var l=docById("pscButtonsDiv");l.style.display="inline",l.style.visibility="visible",l.style.width=476,l.innerHTML='<table cellpadding="0px" id="pscButtonTable"></table>';var o=docById("myCanvas"),a=docById("pscButtonTable").createTHead().insertRow(0),n=this;(r=this._addButton(a,"close-button.svg",32,_("Close"))).onclick=function(){docById("pscDiv").style.visibility="hidden",docById("pscButtonsDiv").style.visibility="hidden",docById("pscTableDiv").style.visibility="hidden",docById("musicratio1").classList.remove("hasKeyboard"),docById("musicratio2").classList.remove("hasKeyboard"),n._logo.hideMsgs()},(r=this._addButton(a,"play-chord.svg",32,_("Play chord"))).onclick=function(){n._playAll()},(r=this._addButton(a,"play-scale.svg",32,_("Play scale"))).onclick=function(){n.playUpAndDown()},r.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},r.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},r.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},r.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground};var r=this._addButton(a,"export-chunk.svg",32,_("Save"));this._save_lock=!1,r.onclick=function(){n._get_save_lock()||(n._save_lock=!0,n._save(0),setTimeout(function(){n._save_lock=!1},1e3))},r.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},r.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},(r=a.insertCell()).innerHTML='<input id="musicratio1" style="-webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="musicratio1" type="musicratio1" value="3" />',r.style.width=Math.floor(MATRIXBUTTONHEIGHT*this._cellScale)+"px",r.style.minWidth=r.style.width,r.style.maxWidth=r.style.width,r.style.backgroundColor=platformColor.selectorBackground,docById("musicratio1").classList.add("hasKeyboard"),(r=a.insertCell()).innerHTML="<h2>:</h2>",r.style.backgroundColor=platformColor.selectorBackground,(r=a.insertCell()).innerHTML='<input id="musicratio2" style="-webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="musicratio2" type="musicratio2" value="2" />',r.style.width=Math.floor(MATRIXBUTTONHEIGHT*this._cellScale)+"px",r.style.minWidth=r.style.width,r.style.maxWidth=r.style.width,r.style.backgroundColor=platformColor.selectorBackground,docById("musicratio2").classList.add("hasKeyboard"),(r=this._addButton(a,"restore-button.svg",32,_("Undo"))).onclick=function(){n._undo()},(r=this._addButton(a,"erase-button.svg",32,_("Clear"))).onclick=function(){for(;n._undo(););},r.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},r.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground};var c=this._addButton(a,"grab.svg",32,_("Drag"));c.style.cursor="move",this._dx=c.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=c.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=c.innerHTML,c.onmouseover=function(t){c.innerHTML=""},c.onmouseout=function(t){n._dragging||(c.innerHTML=n._dragCellHTML)},o.ondragover=function(t){n._dragging=!0,t.preventDefault()},o.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;s.style.left=e+"px";var i=t.clientY-n._dy;s.style.top=i+"px",c.innerHTML=n._dragCellHTML}},s.ondragover=function(t){n._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;s.style.left=e+"px";var i=t.clientY-n._dy;s.style.top=i+"px",c.innerHTML=n._dragCellHTML}},s.onmousedown=function(t){n._target=t.target},s.ondragstart=function(t){c.contains(n._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};var h=docById("pscTableDiv");h.style.display="inline",h.style.visibility="visible",h.style.border="0px",h.innerHTML="",h.innerHTML='<div id="pscOuterDiv"><div id="pscInnerDiv"><table cellpadding="0px" id="pscTable"></table></div></div>',this._refresh(),this._logo.textMsg(_("Click on a note to create a new step."))},this._resizeWidget=function(){var t=Math.max(Math.floor(.5*window.innerHeight/100),8),e=docById("pscOuterDiv");if(this.Stairs.length>t){e.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(t+6)+"px";var i=Math.max(Math.min(window.innerWidth,685*this._cellScale),476);e.style.width=i+"px"}else{e.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(this.Stairs.length+3)+"px";i=Math.max(Math.min(window.innerWidth,685*this._cellScale-20),476);e.style.width=i+"px"}i=Math.max(Math.min(window.innerWidth,600*this._cellScale),423);var s=docById("pscInnerDiv");s.style.width=i+"px",s.style.marginLeft=53*this._cellScale+"px"},this._refresh=function(){this._makeStairs(-1,!0),this._resizeWidget()}}var MATRIXGRAPHICS=["forward","back","right","left","setcolor","setshade","sethue","setgrey","settranslucency","setpensize","setheading"],MATRIXGRAPHICS2=["arc","setxy"],MATRIXSYNTHS=["sine","triangle","sawtooth","square","hertz"];function PitchTimeMatrix(){this._stopOrCloseClicked=!1,this._instrumentName=DEFAULTVOICE,this.paramsEffects={doVibrato:!1,doDistortion:!1,doTremolo:!1,doPhaser:!1,doChorus:!1,vibratoIntensity:0,vibratoFrequency:0,distortionAmount:0,tremoloFrequency:0,tremoloDepth:0,rate:0,octaves:0,baseFrequency:0,chorusRate:0,delayTime:0,chorusDepth:0},this.rowLabels=[],this.rowArgs=[],this._noteBlocks=!1,this.sorted=!1,this._notesToPlay=[],this._outputAsTuplet=[],this._matrixHasTuplets=!1,this._notesCounter=0,this._noteStored=[],this._rowBlocks=[],this._colBlocks=[],this._rowMap=[],this._rowOffset=[],this._blockMap=[],this.blockNo=null,this.notesBlockMap=[],this._blockMapHelper=[],this.columnBlocksMap=[],this.clearBlocks=function(){this._rowBlocks=[],this._colBlocks=[],this._rowMap=[],this._rowOffset=[]},this.addRowBlock=function(t){this._rowMap.push(this._rowBlocks.length),this._rowOffset.push(0),this._rowBlocks.push(t)},this.addColBlock=function(t,e){for(var i=0,s=0;s<this._colBlocks.length;s++){this._colBlocks[s][0]===t&&(i+=1)}for(s=i;s<e+i;s++)this._colBlocks.push([t,s])},this.addNode=function(t,e,i){for(var s=0,l=0;l<this._blockMap.length;l++){var o=this._blockMap[l];o[0]===t&&o[1][0]===e&&o[1][1]===i&&(console.log("node is already in the list"),s+=1)}this._blockMap.push([t,[e,i],s])},this.removeNode=function(t,e,i){for(var s=0;s<this._blockMap.length;s++){var l=this._blockMap[s];l[0]===t&&l[1][0]===e&&l[1][1]===i&&(this._blockMap[s]=[-1,[-1,1,0]])}},this._get_save_lock=function(){return this._save_lock},this.init=function(t){this._noteStored=[],this._noteBlocks=!1,this._rests=0,this._logo=t,this.playingNow=!1,this._expanded=!1;var e=window.innerWidth;this._cellScale=e/1200;var i=32*this._cellScale,s=docById("myCanvas"),l=docById("ptmDiv");l.style.visibility="visible",l.setAttribute("draggable","true"),l.style.left="200px",l.style.top="150px";var o=docById("ptmButtonsDiv");o.style.display="inline",o.style.visibility="visible",o.style.width=535,o.innerHTML='<table cellpadding="0px" id="ptmButtonTable"></table>';var a=docById("ptmButtonTable").createTHead().insertRow(0);console.log("notes "+this.rowLabels+" octave "+this.rowArgs),this._notesToPlay=[],this._matrixHasTuplets=!1;var n=this;(r=this._addButton(a,"close-button.svg",32,_("Close"))).onclick=function(){n._rowOffset=[];for(var t=0;t<n._rowMap.length;t++)n._rowMap[t]=t;n._logo.synth.stopSound(0,n._instrumentName),n._logo.synth.stop(),n._stopOrCloseClicked=!0,h.style.visibility="hidden",o.style.visibility="hidden",l.style.visibility="hidden",n._logo.hideMsgs(),docById("wheelDivptm").style.display="none"},(r=this._addButton(a,"play-button.svg",32,_("Play"))).onclick=function(){n._logo.setTurtleDelay(0),n._logo.resetSynth(0),n.playAll(a)};var r=this._addButton(a,"export-chunk.svg",32,_("Save"));this._save_lock=!1,r.onclick=function(){n._get_save_lock()||(n._save_lock=!0,n._save(),setTimeout(function(){n._save_lock=!1},1e3))},(r=this._addButton(a,"erase-button.svg",32,_("Clear"))).onclick=function(){n._clear()},localStorage.beginnerMode||((r=this._addButton(a,"export-button.svg",32,_("Export"))).onclick=function(){n._export()});(r=this._addButton(a,"sort.svg",32,_("Sort"))).onclick=function(){n._sort()};var c=this._addButton(a,"grab.svg",32,_("Drag"));c.style.cursor="move",this._dx=c.getBoundingClientRect().left-l.getBoundingClientRect().left,this._dy=c.getBoundingClientRect().top-l.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=c.innerHTML,c.onmouseover=function(t){c.innerHTML=""},c.onmouseout=function(t){n._dragging||(c.innerHTML=n._dragCellHTML)},s.ondragover=function(t){n._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",c.innerHTML=n._dragCellHTML}},l.ondragover=function(t){n._dragging=!0,t.preventDefault()},l.ondrop=function(t){if(n._dragging){n._dragging=!1;var e=t.clientX-n._dx;l.style.left=e+"px";var i=t.clientY-n._dy;l.style.top=i+"px",c.innerHTML=n._dragCellHTML}},l.onmousedown=function(t){n._target=t.target},l.ondragstart=function(t){c.contains(n._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()},this._addButton(a,"expand-button.svg",32,_("expand"),"").onclick=function(){var t=docById("ptmDiv");n._expanded?(t.style.width=n._initial_w,t.style.height=n._initial_h,this.innerHTML='&nbsp;&nbsp;<img src="header-icons/expand-button.svg" title="'+_("expand")+'" alt="'+_("expand")+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',n._expanded=!1):(t.style.width=Math.max(758,Math.min(1200,window.innerWidth))+"px",t.style.height=Math.max(400,Math.min(900,window.innerHeight))+"px",this.innerHTML='&nbsp;&nbsp;<img src="header-icons/collapse-button.svg" title="'+_("collapse")+'" alt="'+_("collapse")+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',n._expanded=!0)};var h=docById("ptmTableDiv");h.style.display="inline",h.style.visibility="visible",h.style.border="0px",h.innerHTML="",h.innerHTML='<div id="ptmOuterDiv"><div id="ptmInnerDiv"><table cellpadding="0px" id="ptmTable"></table></div></div>';var u=Math.max(Math.floor(.5*window.innerHeight/100),8),d=docById("ptmOuterDiv");if(this.rowLabels.length>u){d.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(u+6)+"px";e=Math.max(Math.min(window.innerWidth,758*this._cellScale),535);d.style.width=e+"px"}else{d.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(this.rowLabels.length+3)+"px";e=Math.max(Math.min(window.innerWidth,758*this._cellScale-20),535);d.style.width=e+"px"}e=Math.max(Math.min(window.innerWidth,630*this._cellScale),482);var f=docById("ptmInnerDiv");f.style.width=e+"px",f.style.marginLeft=106*this._cellScale+"px";var p=docById("ptmTable");if(!this.sorted)for(this.columnBlocksMap=this._mapNotesBlocks("all",!0),m=0;m<this.columnBlocksMap.length;m++)-1===MATRIXGRAPHICS.indexOf(this.columnBlocksMap[m][1])&&-1===MATRIXGRAPHICS2.indexOf(this.columnBlocksMap[m][1])&&-1===MATRIXSYNTHS.indexOf(this.columnBlocksMap[m][1])&&-1===["playdrum","pitch"].indexOf(this.columnBlocksMap[m][1])&&(this.columnBlocksMap=this.columnBlocksMap.slice(0,m).concat(this.columnBlocksMap.slice(m+1)),m--);for(var b=0,m=0;m<this.rowLabels.length;m++)if("rest"!==this.rowLabels[m].toLowerCase()){var g=p.insertRow(),k=getDrumName(this.rowLabels[m]);if(-1!=MATRIXGRAPHICS.indexOf(this.rowLabels[m])||-1!=MATRIXGRAPHICS2.indexOf(this.rowLabels[m])?cellColor=platformColor.graphicsLabelBackground:cellColor=null===k?platformColor.pitchLabelBackground:platformColor.drumLabelBackground,(r=g.insertCell()).style.backgroundColor=cellColor,r.style.fontSize=100*this._cellScale+"%",r.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+1+"px",r.style.width=Math.floor(MATRIXSOLFEWIDTH*this._cellScale)+"px",r.style.minWidth=Math.floor(MATRIXSOLFEWIDTH*this._cellScale)+"px",r.style.maxWidth=r.style.minWidth,r.className="headcol",r.innerHTML="",r.setAttribute("id","headcol"+m),null!=k)r.innerHTML='&nbsp;&nbsp;<img src="'+getDrumIcon(k)+'" title="'+_(k)+'" alt="'+_(k)+'" height="'+i+'" width="'+i+'" vertical-align="middle">&nbsp;&nbsp;';else if("http"===this.rowLabels[m].slice(0,4))r.innerHTML='&nbsp;&nbsp;<img src="'+getDrumIcon(this.rowLabels[m])+'" title="'+this.rowLabels[m]+'" alt="'+this.rowLabels[m]+'" height="'+i/2+'" width="'+i/2+'" vertical-align="middle"/>&nbsp;&nbsp;';else if(-1!==MATRIXSYNTHS.indexOf(this.rowLabels[m]))r.innerHTML='&nbsp;&nbsp;<img src="images/synth2.svg" height="'+i+'" width="'+i+'" vertical-align="middle">&nbsp;&nbsp;';else if(-1!==MATRIXGRAPHICS.indexOf(this.rowLabels[m]))r.innerHTML='&nbsp;&nbsp;<img src="images/mouse.svg" height="'+i+'" width="'+i+'" vertical-align="middle">&nbsp;&nbsp;';else if(-1!==MATRIXGRAPHICS2.indexOf(this.rowLabels[m]))r.innerHTML='&nbsp;&nbsp;<img src="images/mouse.svg" height="'+i+'" width="'+i+'" vertical-align="middle">&nbsp;&nbsp;';else{var v={C:1,D:2,E:3,F:4,G:5,A:6,B:7,do:1,re:2,mi:3,fa:4,sol:5,la:6,ti:7},y=this.rowLabels[m];y in v&&4===this.rowArgs[m]?r.innerHTML='<img src="images/8_bellset_key_'+v[y]+'.svg" width="'+r.style.width+'" vertical-align="middle">':"C"===y&&5===this.rowArgs[m]&&(r.innerHTML='<img src="images/8_bellset_key_8.svg" width="'+r.style.width+'" vertical-align="middle">')}if((r=g.insertCell()).style.backgroundColor=cellColor,r.style.fontSize=100*this._cellScale+"%",r.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+1+"px",r.style.width=Math.floor(MATRIXSOLFEWIDTH*this._cellScale)+"px",r.style.minWidth=Math.floor(MATRIXSOLFEWIDTH*this._cellScale)+"px",r.style.maxWidth=r.style.minWidth,r.className="labelcol",r.style.left=53*this._cellScale+"px",r.setAttribute("alt",m),r.setAttribute("id","labelcol"+m),null!=k)r.innerHTML=_(k),r.style.fontSize=Math.floor(14*this._cellScale)+"px",r.setAttribute("alt",m+"__drumblocks"),r.onclick=function(t){null===(r=t.target).getAttribute("alt")&&(r=r.parentNode);var e=r.getAttribute("alt").split("__")[0],i=r.getAttribute("alt").split("__")[1];n._createcolumnpiesubmenu(e,i)},this._noteStored.push(k);else if("http"===this.rowLabels[m].slice(0,4))r.innerHTML=this.rowLabels[m],r.style.fontSize=Math.floor(14*this._cellScale)+"px",this._noteStored.push(this.rowLabels[m].replace(/ /g,":"));else if(-1!==MATRIXSYNTHS.indexOf(this.rowLabels[m]))r.innerHTML=this.rowArgs[m],r.style.fontSize=Math.floor(14*this._cellScale)+"px",r.setAttribute("alt",m+"__synthsblocks"),r.onclick=function(t){null===(r=t.target).getAttribute("alt")&&(r=r.parentNode);var e=r.getAttribute("alt").split("__")[0],i=r.getAttribute("alt").split("__")[1];n._creatematrixgraphicspiesubmenu(e,i)},this._noteStored.push(this.rowArgs[m]);else if(-1!==MATRIXGRAPHICS.indexOf(this.rowLabels[m]))r.innerHTML=_(this.rowLabels[m])+"<br>"+this.rowArgs[m],r.style.fontSize=Math.floor(12*this._cellScale)+"px",r.setAttribute("alt",m+"__graphicsblocks"),r.onclick=function(t){null===(r=t.target).getAttribute("alt")&&(r=r.parentNode);var e=r.getAttribute("alt").split("__")[0],i=r.getAttribute("alt").split("__")[1];n._creatematrixgraphicspiesubmenu(e,i)},this._noteStored.push(this.rowLabels[m]+":"+this.rowArgs[m]);else if(-1!==MATRIXGRAPHICS2.indexOf(this.rowLabels[m]))r.innerHTML=_(this.rowLabels[m])+"<br>"+this.rowArgs[m][0]+" "+this.rowArgs[m][1],r.style.fontSize=Math.floor(12*this._cellScale)+"px",r.setAttribute("alt",m+"__graphicsblocks2"),r.onclick=function(t){null===(r=t.target).getAttribute("alt")&&(r=r.parentNode);var e=r.getAttribute("alt").split("__")[0],i=r.getAttribute("alt").split("__")[1];n._creatematrixgraphic2spiesubmenu(e,i)},this._noteStored.push(this.rowLabels[m]+":"+this.rowArgs[m][0]+":"+this.rowArgs[m][1]);else{if(noteIsSolfege(this.rowLabels[m])&&"custom"!==this._logo.synth.inTemperament){r.innerHTML=i18nSolfege(this.rowLabels[m])+this.rowArgs[m].toString().sub();var T=getNote(this.rowLabels[m],this.rowArgs[m],0,this._logo.keySignature[0],!1,null,this._logo.errorMsg,this._logo.synth.inTemperament)}else{r.innerHTML=this.rowLabels[m]+this.rowArgs[m].toString().sub();T=[this.rowLabels[m],this.rowArgs[m]]}r.setAttribute("alt",m+"__pitchblocks"),r.onclick=function(t){null===(r=t.target).getAttribute("alt")&&(r=r.parentNode);var e=r.getAttribute("alt").split("__")[0],i=r.getAttribute("alt").split("__")[1];n._createcolumnpiesubmenu(e,i)},this._noteStored.push(T[0]+T[1])}(L=g.insertCell()).innerHTML='<table cellpadding="0px" id="ptmCellTable'+b+'"></table>',docById("ptmCellTable"+b).insertRow().setAttribute("id","ptm"+b),b+=1}else this._rests+=1;(L=(g=p.insertRow()).insertCell()).className="headcol",L.innerHTML='<table cellpadding="0px"><tr><td id="ptmTupletNoteLabel"></td></tr><tr><td id="ptmTupletValueLabel"></td></tr><tr><td id="ptmNoteValueLabel"></td></tr></table>';var L,w=docById("ptmNoteValueLabel");w.innerHTML=_("note value"),w.style.fontSize=75*this._cellScale+"%",w.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",w.style.width=Math.floor(2*MATRIXSOLFEWIDTH*this._cellScale)+"px",w.style.minWidth=w.style.width,w.style.maxWidth=w.style.width,w.style.backgroundColor=platformColor.labelColor,(L=g.insertCell()).innerHTML='<table  class="ptmTable" cellpadding="0px"><tr id="ptmTupletNoteValueRow"></tr><tr id="ptmTupletValueRow"></tr><tr id="ptmNoteValueRow"></tr></table>',this._lookForNoteBlocks(),!this.sorted&&this._noteBlocks?setTimeout(function(){console.log("sorting"),n._sort()},1e3):this.sorted=!1,this._logo.textMsg(_("Click on the table to add notes.")),this._initial_w=l.style.width,this._initial_h=l.style.height},this._creatematrixgraphic2spiesubmenu=function(h,t){docById("wheelDivptm").style.display="";var i=["<-","Enter","1","2","3","4","5","6","7","8","9","0"];this._pitchWheel=new wheelnav("wheelDivptm",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._pitchWheel.raphael),this._blockLabelsWheel=new wheelnav("_blockLabelsWheel",this._pitchWheel.raphael);var e=MATRIXGRAPHICS2.slice();wheelnav.cssMode=!0,this._pitchWheel.keynavigateEnabled=!1,this._pitchWheel.slicePathFunction=slicePath().DonutSlice,this._pitchWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._pitchWheel.colors=platformColor.pitchWheelcolors,this._pitchWheel.slicePathCustom.minRadiusPercent=.4,this._pitchWheel.slicePathCustom.maxRadiusPercent=.8,this._pitchWheel.sliceSelectedPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.sliceInitPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.clickModeRotate=!1,this._pitchWheel.animatetime=0,this._pitchWheel.createWheel(i),this._exitWheel.colors=platformColor.exitWheelcolors2,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.4,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._blockLabelsWheel.colors=platformColor.blockLabelsWheelcolors,this._blockLabelsWheel.slicePathFunction=slicePath().DonutSlice,this._blockLabelsWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._blockLabelsWheel.slicePathCustom.minRadiusPercent=.8,this._blockLabelsWheel.slicePathCustom.maxRadiusPercent=1,this._blockLabelsWheel.sliceSelectedPathCustom=this._blockLabelsWheel.slicePathCustom,this._blockLabelsWheel.sliceInitPathCustom=this._blockLabelsWheel.slicePathCustom,this._blockLabelsWheel.clickModeRotate=!1,this._blockLabelsWheel.titleRotateAngle=90,this._blockLabelsWheel.animatetime=0,this._blockLabelsWheel.createWheel(e);var s=docById("labelcol"+h).getBoundingClientRect().x,l=docById("labelcol"+h).getBoundingClientRect().y;docById("wheelDivptm").style.position="absolute",docById("wheelDivptm").style.height="300px",docById("wheelDivptm").style.width="300px",docById("wheelDivptm").style.left=Math.min(this._logo.blocks.turtles._canvas.width-200,Math.max(0,s*this._logo.blocks.getStageScale()))+"px",docById("wheelDivptm").style.top=Math.min(this._logo.blocks.turtles._canvas.height-250,Math.max(0,l*this._logo.blocks.getStageScale()))+"px";var u=this.columnBlocksMap[h][0],o=this._logo.blocks.blockList[u].name,a=this._logo.blocks.blockList[this._logo.blocks.blockList[u].connections[1]].value,n=this._logo.blocks.blockList[this._logo.blocks.blockList[u].connections[2]].value;this._blockLabelsWheel.navigateWheel(e.indexOf(o)),this.xblockValue=[a.toString(),"x"],this.yblockValue=[n.toString(),"y"],this._exitWheel.createWheel(["x",this.yblockValue[0],this.xblockValue[0]]),this.blockValue=this.xblockValue,this.x=!0;var d=this;this._exitWheel.navItems[0].navigateFunction=function(){docById("wheelDivptm").style.display="none",d._pitchWheel.removeWheel(),d._exitWheel.removeWheel(),"graphicsblocks"===t&&d._blockLabelsWheel.removeWheel()},this._exitWheel.navItems[1].navigateFunction=function(){d.x=!1,docById("wheelnav-_exitWheel-slice-1").setAttribute("fill","#80a080"),docById("wheelnav-_exitWheel-slice-2").setAttribute("fill","#a08080"),docById("wheelnav-_exitWheel-slice-1").style.fill="#80a080",docById("wheelnav-_exitWheel-slice-2").style.fill="#a08080",d._exitWheel.colors[1]="#80a080",d._exitWheel.colors[2]="#a08080",docById("wheelnav-_exitWheel-title-1").children[0].textContent=d.yblockValue[0],docById("wheelnav-_exitWheel-title-2").children[0].textContent=d.xblockValue[0]},this._exitWheel.navItems[2].navigateFunction=function(){d.x=!0,docById("wheelnav-_exitWheel-slice-1").setAttribute("fill","#a08080"),docById("wheelnav-_exitWheel-slice-2").setAttribute("fill","#80a080"),docById("wheelnav-_exitWheel-slice-1").style.fill="#a08080",docById("wheelnav-_exitWheel-slice-2").style.fill="#80a080",d._exitWheel.colors[1]="#a08080",d._exitWheel.colors[2]="#80a080",docById("wheelnav-_exitWheel-title-1").children[0].textContent=d.yblockValue[0],docById("wheelnav-_exitWheel-title-2").children[0].textContent=d.xblockValue[0]};function r(){var t=d._pitchWheel.selectedNavItemIndex,e=i[t];d.x?d.blockValue=d.xblockValue:d.blockValue=d.yblockValue,3!==d.blockValue[0].length&&("0"===d.blockValue[0]?d.blockValue[0]=e:d.blockValue[0]=d.blockValue[0]+e,"x"===d.blockValue[1]?docById("wheelnav-_exitWheel-title-2").children[0].textContent=d.blockValue[0]:docById("wheelnav-_exitWheel-title-1").children[0].textContent=d.blockValue[0])}this._pitchWheel.navItems[0].navigateFunction=function(){d.x?d.blockValue=d.xblockValue:d.blockValue=d.yblockValue,1===d.blockValue[0].length?d.blockValue[0]="0":d.blockValue[0]=d.blockValue[0].slice(0,d.blockValue[0].length-1),"x"===d.blockValue[1]?docById("wheelnav-_exitWheel-title-2").children[0].textContent=d.blockValue[0]:docById("wheelnav-_exitWheel-title-1").children[0].textContent=d.blockValue[0]},this._pitchWheel.navItems[1].navigateFunction=function(){f(!1)};for(var c=2;c<i.length;c++)this._pitchWheel.navItems[c].navigateFunction=r;var f=function(t){var e=d._blockLabelsWheel.navItems[d._blockLabelsWheel.selectedNavItemIndex].title;if(!1!==t){var i=[[0,[e,{}],0,0,[null,1,2,null]],[1,["number",{value:parseInt(d.xblockValue[0])}],0,0,[0]],[2,["number",{value:parseInt(d.yblockValue[0])}],0,0,[0]]];d._logo.blocks.loadNewBlocks(i);var s=d._logo.blocks.blockList.length-3;setTimeout(d._blockReplace(u,s),500),d.columnBlocksMap[h][0]=s,u=s}d.rowLabels[h]=e;var l=d._logo.blocks.blockList[u].connections[1];d._logo.blocks.blockList[l].text.text=d.xblockValue[0],d._logo.blocks.blockList[l].value=parseInt(d.xblockValue[0]);var o=d._logo.blocks.blockList[l].container.children.length-1;d._logo.blocks.blockList[l].container.setChildIndex(d._logo.blocks.blockList[l].text,o),d._logo.blocks.blockList[l].updateCache();l=d._logo.blocks.blockList[u].connections[2];d._logo.blocks.blockList[l].text.text=d.yblockValue[0],d._logo.blocks.blockList[l].value=parseInt(d.yblockValue[0]);o=d._logo.blocks.blockList[l].container.children.length-1;d._logo.blocks.blockList[l].container.setChildIndex(d._logo.blocks.blockList[l].text,o),d._logo.blocks.blockList[l].updateCache(),d.rowArgs[h][0]=parseInt(d.xblockValue),d.rowArgs[h][1]=parseInt(d.yblockValue);var a=docById("headcol"+h),n=window.innerWidth/1200*32;-1!==MATRIXGRAPHICS2.indexOf(d.rowLabels[h])&&(a.innerHTML='&nbsp;&nbsp;<img src="images/mouse.svg" height="'+n+'" width="'+n+'" vertical-align="middle">&nbsp;&nbsp;'),a=docById("labelcol"+h),-1!==MATRIXGRAPHICS2.indexOf(d.rowLabels[h])&&(a.innerHTML=_(d.rowLabels[h])+"<br>"+d.rowArgs[h][0]+" "+d.rowArgs[h][1],a.style.fontSize=Math.floor(12*d._cellScale)+"px"),noteStored=d.rowLabels[h]+":"+d.rowArgs[h][0]+":"+d.rowArgs[h][1];for(var r=0;r<d._notesToPlay.length;r++){var c=d._notesToPlay[r][0].indexOf(d._noteStored[h]);"black"===(a=docById(h+":"+r)).style.backgroundColor&&(d._notesToPlay[r][0][c]=noteStored)}d._noteStored[h]=noteStored};for(c=0;c<e.length;c++)this._blockLabelsWheel.navItems[c].navigateFunction=f},this._creatematrixgraphicspiesubmenu=function(c,h){docById("wheelDivptm").style.display="";var i=["<-","Enter","1","2","3","4","5","6","7","8","9","0"];if(this._pitchWheel=new wheelnav("wheelDivptm",null,1300,1300),this._exitWheel=new wheelnav("_exitWheel",this._pitchWheel.raphael),"graphicsblocks"===h){this._blockLabelsWheel=new wheelnav("_blockLabelsWheel",this._pitchWheel.raphael);var t=MATRIXGRAPHICS.slice()}wheelnav.cssMode=!0,this._pitchWheel.keynavigateEnabled=!1,this._pitchWheel.slicePathFunction=slicePath().DonutSlice,this._pitchWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._pitchWheel.colors=platformColor.pitchWheelcolors,this._pitchWheel.slicePathCustom.minRadiusPercent=.4,this._pitchWheel.slicePathCustom.maxRadiusPercent=.7,this._pitchWheel.sliceSelectedPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.sliceInitPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.clickModeRotate=!1,this._pitchWheel.animatetime=0,this._pitchWheel.createWheel(i),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.4,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,"graphicsblocks"===h&&(this._blockLabelsWheel.colors=platformColor.blockLabelsWheelcolors,this._blockLabelsWheel.slicePathFunction=slicePath().DonutSlice,this._blockLabelsWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._blockLabelsWheel.slicePathCustom.minRadiusPercent=.7,this._blockLabelsWheel.slicePathCustom.maxRadiusPercent=1,this._blockLabelsWheel.sliceSelectedPathCustom=this._blockLabelsWheel.slicePathCustom,this._blockLabelsWheel.sliceInitPathCustom=this._blockLabelsWheel.slicePathCustom,this._blockLabelsWheel.clickModeRotate=!1,this._blockLabelsWheel.titleRotateAngle=90,this._blockLabelsWheel.animatetime=0,this._blockLabelsWheel.createWheel(t));var e=docById("labelcol"+c).getBoundingClientRect().x,s=docById("labelcol"+c).getBoundingClientRect().y;docById("wheelDivptm").style.position="absolute",docById("wheelDivptm").style.height="300px",docById("wheelDivptm").style.width="300px",docById("wheelDivptm").style.left=Math.min(this._logo.blocks.turtles._canvas.width-200,Math.max(0,e*this._logo.blocks.getStageScale()))+"px",docById("wheelDivptm").style.top=Math.min(this._logo.blocks.turtles._canvas.height-250,Math.max(0,s*this._logo.blocks.getStageScale()))+"px";var u=this.columnBlocksMap[c][0],l=this._logo.blocks.blockList[u].name,o=this._logo.blocks.blockList[this._logo.blocks.blockList[u].connections[1]].value;"graphicsblocks"===h&&this._blockLabelsWheel.navigateWheel(t.indexOf(l)),this.blockValue=o.toString(),this._exitWheel.createWheel(["x",this.blockValue]);var d=this;this._exitWheel.navItems[0].navigateFunction=function(){docById("wheelDivptm").style.display="none",d._pitchWheel.removeWheel(),d._exitWheel.removeWheel(),"graphicsblocks"===h&&d._blockLabelsWheel.removeWheel()};function a(){var t=d._pitchWheel.selectedNavItemIndex,e=i[t];3!==d.blockValue.length&&("0"===d.blockValue?d.blockValue=e:d.blockValue=d.blockValue+e,docById("wheelnav-_exitWheel-title-1").children[0].textContent=d.blockValue)}this._pitchWheel.navItems[0].navigateFunction=function(){1===d.blockValue.length?d.blockValue="0":d.blockValue=d.blockValue.slice(0,d.blockValue.length-1),docById("wheelnav-_exitWheel-title-1").children[0].textContent=d.blockValue},this._pitchWheel.navItems[1].navigateFunction=function(){r(!1)};for(var n=2;n<i.length;n++)this._pitchWheel.navItems[n].navigateFunction=a;var r=function(t){if("graphicsblocks"===h){var e=d._blockLabelsWheel.navItems[d._blockLabelsWheel.selectedNavItemIndex].title;if(!1!==t){var i=[[0,[e,{}],0,0,[null,1,null]],[1,["number",{value:parseInt(d.blockValue)}],0,0,[0]]];d._logo.blocks.loadNewBlocks(i);var s=d._logo.blocks.blockList.length-2;setTimeout(d._blockReplace(u,s),500),d.columnBlocksMap[c][0]=s,u=s}d.rowLabels[c]=e}setTimeout(function(){var t=d._logo.blocks.blockList[u].connections[1];d._logo.blocks.blockList[t].text.text=d.blockValue,d._logo.blocks.blockList[t].value=parseInt(d.blockValue);var e=d._logo.blocks.blockList[t].container.children.length-1;d._logo.blocks.blockList[t].container.setChildIndex(d._logo.blocks.blockList[t].text,e),d._logo.blocks.blockList[t].updateCache()},600),d.rowArgs[c]=parseInt(d.blockValue);var l=docById("headcol"+c),o=window.innerWidth/1200*32;-1!==MATRIXSYNTHS.indexOf(d.rowLabels[c])?l.innerHTML='&nbsp;&nbsp;<img src="images/synth2.svg" height="'+o+'" width="'+o+'" vertical-align="middle">&nbsp;&nbsp;':-1!==MATRIXGRAPHICS.indexOf(d.rowLabels[c])&&(l.innerHTML='&nbsp;&nbsp;<img src="images/mouse.svg" height="'+o+'" width="'+o+'" vertical-align="middle">&nbsp;&nbsp;'),l=docById("labelcol"+c),-1!==MATRIXSYNTHS.indexOf(d.rowLabels[c])?(l.innerHTML=d.rowArgs[c],l.style.fontSize=Math.floor(14*this._cellScale)+"px"):-1!==MATRIXGRAPHICS.indexOf(d.rowLabels[c])&&(l.innerHTML=_(d.rowLabels[c])+"<br>"+d.rowArgs[c],l.style.fontSize=Math.floor(12*d._cellScale)+"px");var a=null;"graphicsblocks"===h?a=d.rowLabels[c]+":"+d.rowArgs[c]:"synthsblocks"===h&&(a=d.rowArgs[c]);for(var n=0;n<d._notesToPlay.length;n++){var r=d._notesToPlay[n][0].indexOf(d._noteStored[c]);"black"===(l=docById(c+":"+n)).style.backgroundColor&&(d._notesToPlay[n][0][r]=a)}d._noteStored[c]=d.rowLabels[c]+":"+d.rowArgs[c]};if("graphicsblocks"===h)for(n=0;n<t.length;n++)this._blockLabelsWheel.navItems[n].navigateFunction=r},this._createcolumnpiesubmenu=function(b,m){b=parseInt(b),docById("wheelDivptm").style.display="";var t=["","","","",""],g=["ti","la","sol","fa","mi","re","do"],e=["snare drum","kick drum","tom tom","floor tom tom","cup drum","darbuka drum","japanese drum","hi hat","ride bell","cow bell","triangle bell","finger cymbals","chime","gong","clang","crash","clap","slap"];if("drumblocks"===m){g=e;for(var i=[0,0,0,0,0,0,0,1,1,1,1,1,1,1,2,2,2,2],s=platformColor.piemenuVoicesColors,l=[],o=0;o<e.length;o++)l.push(s[i[o]%s.length])}if(this._pitchWheel="drumblocks"===m?new wheelnav("wheelDivptm",null,1200,1200):new wheelnav("wheelDivptm",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._pitchWheel.raphael),"pitchblocks"===m&&(this._accidentalsWheel=new wheelnav("_accidentalsWheel",this._pitchWheel.raphael),this._octavesWheel=new wheelnav("_octavesWheel",this._pitchWheel.raphael)),wheelnav.cssMode=!0,this._pitchWheel.keynavigateEnabled=!1,this._pitchWheel.slicePathFunction=slicePath().DonutSlice,this._pitchWheel.slicePathCustom=slicePath().DonutSliceCustomization(),"pitchblocks"===m?(this._pitchWheel.colors=platformColor.pitchWheelcolors,this._pitchWheel.slicePathCustom.minRadiusPercent=.2,this._pitchWheel.slicePathCustom.maxRadiusPercent=.5):"drumblocks"===m&&(this._pitchWheel.titleRotateAngle=0,this._pitchWheel.colors=l,this._pitchWheel.slicePathCustom.minRadiusPercent=.2,this._pitchWheel.slicePathCustom.maxRadiusPercent=1),this._pitchWheel.sliceSelectedPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.sliceInitPathCustom=this._pitchWheel.slicePathCustom,this._pitchWheel.animatetime=0,this._pitchWheel.createWheel(g),this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]),"pitchblocks"===m){this._accidentalsWheel.colors=platformColor.accidentalsWheelcolors,this._accidentalsWheel.slicePathFunction=slicePath().DonutSlice,this._accidentalsWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._accidentalsWheel.slicePathCustom.minRadiusPercent=.5,this._accidentalsWheel.slicePathCustom.maxRadiusPercent=.75,this._accidentalsWheel.sliceSelectedPathCustom=this._accidentalsWheel.slicePathCustom,this._accidentalsWheel.sliceInitPathCustom=this._accidentalsWheel.slicePathCustom;var a=[];for(o=0;o<t.length;o++)a.push(t[o]);for(o=0;o<9;o++)a.push(null),this._accidentalsWheel.colors.push(platformColor.accidentalsWheelcolorspush);this._accidentalsWheel.animatetime=0,this._accidentalsWheel.createWheel(a),this._accidentalsWheel.setTooltips([_("double sharp"),_("sharp"),_("natural"),_("flat"),_("double flat")]),this._octavesWheel.colors=platformColor.octavesWheelcolors,this._octavesWheel.slicePathFunction=slicePath().DonutSlice,this._octavesWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._octavesWheel.slicePathCustom.minRadiusPercent=.75,this._octavesWheel.slicePathCustom.maxRadiusPercent=.95,this._octavesWheel.sliceSelectedPathCustom=this._octavesWheel.slicePathCustom,this._octavesWheel.sliceInitPathCustom=this._octavesWheel.slicePathCustom;var n=["8","7","6","5","4","3","2","1",null,null,null,null,null,null];this._octavesWheel.animatetime=0,this._octavesWheel.createWheel(n)}var r=docById("labelcol"+b).getBoundingClientRect().x,c=docById("labelcol"+b).getBoundingClientRect().y;docById("wheelDivptm").style.position="absolute",docById("wheelDivptm").style.height="300px",docById("wheelDivptm").style.width="300px",docById("wheelDivptm").style.left=Math.min(this._logo.blocks.turtles._canvas.width-200,Math.max(0,r*this._logo.blocks.getStageScale()))+"px",docById("wheelDivptm").style.top=Math.min(this._logo.blocks.turtles._canvas.height-250,Math.max(0,c*this._logo.blocks.getStageScale()))+"px";var k=this.columnBlocksMap[b][0],h=this._logo.blocks.blockList[this._logo.blocks.blockList[k].connections[1]].value;if("pitchblocks"===m){var u=this._logo.blocks.blockList[this._logo.blocks.blockList[k].connections[2]].value,d=2;for(o=0;o<t.length;o++)if(-1!==h.indexOf(t[o])){d=o,h=h.substr(0,h.indexOf(t[o]));break}this._accidentalsWheel.navigateWheel(d),this._octavesWheel.navigateWheel(n.indexOf(u.toString()))}this._pitchWheel.navigateWheel(g.indexOf(h));var v=this;this._exitWheel.navItems[0].navigateFunction=function(){docById("wheelDivptm").style.display="none",v._pitchWheel.removeWheel(),v._exitWheel.removeWheel(),"pitchblocks"===m&&(v._accidentalsWheel.removeWheel(),v._octavesWheel.removeWheel())};var f=function(){var t=v._pitchWheel.navItems[v._pitchWheel.selectedNavItemIndex].title,e=0;if("pitchblocks"===m){var i=v._accidentalsWheel.navItems[v._accidentalsWheel.selectedNavItemIndex].title;""!==i&&(t+=i);var s=Number(v._octavesWheel.navItems[v._octavesWheel.selectedNavItemIndex].title),l=getNote(t,s,0,v._logo.keySignature[0],!1,null,v._logo.errorMsg,v._logo.synth.inTemperament);v._logo.synth.setMasterVolume(PREVIEWVOLUME),v._logo.setSynthVolume(0,DEFAULTVOICE,PREVIEWVOLUME),v._logo.synth.trigger(0,[l[0]+l[1]],1/8,DEFAULTVOICE,null,null)}else if("drumblocks"===m){if(void 0===v._logo.instrumentNames[0]||-1===v._logo.instrumentNames[0].indexOf(t)){void 0===v._logo.instrumentNames[0]&&(v._logo.instrumentNames[0]=[]),v._logo.instrumentNames[0].push(t),t===DEFAULTVOICE&&v._logo.synth.createDefaultSynth(0),v._logo.synth.loadSynth(0,t);e=500}setTimeout(function(){v._logo.synth.setMasterVolume(DEFAULTVOLUME),v._logo.setSynthVolume(0,t,DEFAULTVOLUME),v._logo.synth.trigger(0,"G4",.25,t,null,null,!1),v._logo.synth.start()},e)}!function(){var t=v._pitchWheel.navItems[v._pitchWheel.selectedNavItemIndex].title,e=g.indexOf(t);if("pitchblocks"===m){var i=v._accidentalsWheel.navItems[v._accidentalsWheel.selectedNavItemIndex].title,s=!1;""!==i&&(t+=i,s=!0)}var l=v._logo.blocks.blockList[k].connections[1];v._logo.blocks.blockList[l].text.text=t,v._logo.blocks.blockList[l].value=t;var o=v._logo.blocks.blockList[l].container.children.length-1;if(v._logo.blocks.blockList[l].container.setChildIndex(v._logo.blocks.blockList[l].text,o),v._logo.blocks.blockList[l].updateCache(),"pitchblocks"===m){var a=Number(v._octavesWheel.navItems[v._octavesWheel.selectedNavItemIndex].title);v._logo.blocks.blockList[l].blocks.setPitchOctave(v._logo.blocks.blockList[l].connections[0],a);var n=[t,a];s&&(n=getNote(t,a,0,v._logo.keySignature[0],!1,null,v._logo.errorMsg,v._logo.synth.inTemperament)),v.rowLabels[b]=n[0],v.rowArgs[b]=n[1]}else"drumblocks"===m&&(v.rowLabels[b]=t);var r=docById("headcol"+b),c=getDrumName(v.rowLabels[b]),h={C:1,D:2,E:3,F:4,G:5,A:6,B:7,do:1,re:2,mi:3,fa:4,sol:5,la:6,ti:7},u=v.rowLabels[b],d=window.innerWidth/1200*32;if(null!=c?r.innerHTML='&nbsp;&nbsp;<img src="'+getDrumIcon(c)+'" title="'+_(c)+'" alt="'+_(c)+'" height="'+d+'" width="'+d+'" vertical-align="middle">&nbsp;&nbsp;':u in h&&4===v.rowArgs[b]?r.innerHTML='<img src="images/8_bellset_key_'+h[u]+'.svg" width="'+r.style.width+'" vertical-align="middle">':"C"===u&&5===v.rowArgs[b]&&(r.innerHTML='<img src="images/8_bellset_key_8.svg" width="'+r.style.width+'" vertical-align="middle">'),r=docById("labelcol"+b),null!=c)r.innerHTML=_(c),r.style.fontSize=Math.floor(14*this._cellScale)+"px";else if(noteIsSolfege(v.rowLabels[e])&&"custom"!==v._logo.synth.inTemperament){r.innerHTML=i18nSolfege(v.rowLabels[b])+v.rowArgs[b].toString().sub();n=getNote(v.rowLabels[b],v.rowArgs[b],0,v._logo.keySignature[0],!1,null,v._logo.errorMsg,v._logo.synth.inTemperament)}else{r.innerHTML=v.rowLabels[b]+v.rowArgs[b].toString().sub();n=[v.rowLabels[b],v.rowArgs[b]]}var f=null;"pitchblocks"===m?f=n[0]+n[1]:"drumblocks"===m&&(f=c);for(e=0;e<v._notesToPlay.length;e++){var p=v._notesToPlay[e][0].indexOf(v._noteStored[b]);"black"===(r=docById(b+":"+e)).style.backgroundColor&&(v._notesToPlay[e][0][p]=f)}v._noteStored[b]=f}()};for(o=0;o<g.length;o++)this._pitchWheel.navItems[o].navigateFunction=f;if("pitchblocks"===m){for(o=0;o<t.length;o++)this._accidentalsWheel.navItems[o].navigateFunction=f;for(o=0;o<8;o++)this._octavesWheel.navItems[o].navigateFunction=f}},this._blockReplace=function(t,e){var i=this._logo.blocks.blockList[t].connections[0],s=last(this._logo.blocks.blockList[t].connections);if(this._logo.blocks.blockList[e].connections[0]=i,this._logo.blocks.blockList[e].connections[this._logo.blocks.blockList[e].connections.length-1]=s,null!=i){for(var l=0;l<this._logo.blocks.blockList[i].connections.length;l++)if(this._logo.blocks.blockList[i].connections[l]===t){this._logo.blocks.blockList[i].connections[l]=e;break}for(var o=i;o!=this.blockNo;)this._logo.blocks.blockList[o].isClampBlock()&&this._logo.blocks.clampBlocksToCheck.push([o,0]),o=this._logo.blocks.blockList[o].connections[0];this._logo.blocks.clampBlocksToCheck.push([this.blockNo,0])}if(null!=s)for(l=0;l<this._logo.blocks.blockList[s].connections.length;l++)if(this._logo.blocks.blockList[s].connections[l]===t){this._logo.blocks.blockList[s].connections[l]=e;break}this._logo.blocks.adjustDocks(i,!0),this._logo.blocks.blockList[t].connections[0]=null,this._logo.blocks.blockList[t].connections[this._logo.blocks.blockList[t].connections.length-1]=null,this._logo.blocks.sendStackToTrash(this._logo.blocks.blockList[t]),this._logo.refreshCanvas()},this._removePitchBlock=function(t){var e=this._logo.blocks.blockList[t].connections[0],i=last(this._logo.blocks.blockList[t].connections);this._logo.blocks.blockList[e].connections[this._logo.blocks.blockList[e].connections.length-1]=i,this._logo.blocks.blockList[i].connections[0]=e,this._logo.blocks.blockList[t].connections[this._logo.blocks.blockList[t].connections.length-1]=null,this._logo.blocks.sendStackToTrash(this._logo.blocks.blockList[t]),this._logo.blocks.adjustDocks(this.blockNo,!0),this._logo.blocks.clampBlocksToCheck.push([this.blockNo,0]),this._logo.blocks.refreshCanvas()},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._generateDataURI=function(t){return"data:text/html;charset=utf-8,"+encodeURIComponent(t)},this._sort=function(){if(this.sorted)console.log("already sorted");else{this._markedColsInRow=[];for(var t=0;t<this.rowLabels.length;t++){for(var e=[],i=docById("ptm"+t),s=i.cells.length,l=0;l<s;l++){"black"===i.cells[l].style.backgroundColor&&e.push(l)}this._markedColsInRow.push(e)}var o=[];for(l=0;l<this.rowLabels.length;l++){if("rest"!==this.rowLabels[l].toLowerCase())null==getDrumName(this.rowLabels[l])&&-1===MATRIXGRAPHICS.indexOf(this.rowLabels[l])&&-1===MATRIXGRAPHICS2.indexOf(this.rowLabels[l])&&(-1!==MATRIXSYNTHS.indexOf(this.rowLabels[l])?o.push([this.rowArgs[l],this.rowLabels[l],this.rowArgs[l],l,this._noteStored[l]]):o.push([noteToFrequency(this.rowLabels[l]+this.rowArgs[l],this._logo.keySignature[0]),this.rowLabels[l],this.rowArgs[l],l,this._noteStored[l]]))}for(l=0;l<this.rowLabels.length;l++){if(null!=getDrumName(this.rowLabels[l])){var a=getDrumIndex(this.rowLabels[l]);o.push([-a,this.rowLabels[l],this.rowArgs[l],l,this._noteStored[l]])}}for(l=0;l<this.rowLabels.length;l++)if(-1!==MATRIXGRAPHICS.indexOf(this.rowLabels[l])){var n=MATRIXGRAPHICS.indexOf(this.rowLabels[l])+100;o.push([-n,this.rowLabels[l],this.rowArgs[l],l,this._noteStored[l]])}else if(-1!==MATRIXGRAPHICS2.indexOf(this.rowLabels[l])){n=MATRIXGRAPHICS.indexOf(this.rowLabels[l])+200;o.push([-n,this.rowLabels[l],this.rowArgs[l],l,this._noteStored[l]])}var r=o.sort(function(t,e){return t[0]-e[0]});r=r.reverse(),this.rowLabels=[],this.rowArgs=[],this._sortedRowMap=[],this._rowMapper=[];for(l=0;l<r.length;l++)this._rowMapper.push(r[l][3]);var c=[],h=this.columnBlocksMap;for(l=0;l<this._rowMapper.length;l++)c.push(this.columnBlocksMap[this._rowMapper[l]]);this.columnBlocksMap=c;var u=0;for(l=0;l<r.length;l++){var d=r[l];if(this._rowMap[d[3]]=l,this._noteStored[l]=d[4],0===l)this._sortedRowMap.push(0);else{if(0<l&&d[1]===last(this.rowLabels)){console.log("skipping "+d[1]+" "+last(this.rowLabels)),this._sortedRowMap.push(last(this._sortedRowMap)),setTimeout(this._removePitchBlock(h[r[u][3]][0]),500),this.columnBlocksMap=this.columnBlocksMap.filter(function(t){return t[0]!==h[r[u][3]][0]}),u=l;for(var f=this._rowMap[l];f<this._rowMap.length;f++)this._rowOffset[f]-=1;this._rowMap[l]=this._rowMap[l-1];continue}console.log("pushing "+d[1]+" "+last(this.rowLabels)),this._sortedRowMap.push(last(this._sortedRowMap)+1),u=l}this.rowLabels.push(d[1]),this.rowArgs.push(Number(d[2]))}this._matrixHasTuplets=!1,this.sorted=!0,this.init(this._logo),this.sorted=!0;for(l=0;l<this._logo.tupletRhythms.length;l++)switch(this._logo.tupletRhythms[l][0]){case"simple":case"notes":var p=[this._logo.tupletParams[this._logo.tupletRhythms[l][1]]];p.push([]);for(f=2;f<this._logo.tupletRhythms[l].length;f++)p[1].push(this._logo.tupletRhythms[l][f]);this.addTuplet(p);break;default:this.addNotes(this._logo.tupletRhythms[l][1],this._logo.tupletRhythms[l][2])}this.makeClickable()}},this._export=function(){var t=window.open("");console.log(t);var e=t.document;if(void 0!==e){var i=e.createElement("title");i.innerHTML="Music Matrix",e.head.appendChild(i);var s=e.createElement("H3");s.innerHTML="Music Matrix",e.body.appendChild(s);var l=e.createElement("TABLE");l.setAttribute("id","exportTable"),l.style.textAlign="center",e.body.appendChild(l);for(var o,a=e.getElementById("exportTable").createTHead(),n=0;o=docById("ptm"+n);n++){var r=(u=a.insertRow()).insertCell(),c=getDrumName(this.rowLabels[n]);null!=c?(r.innerHTML=_(c),r.style.fontSize=Math.floor(14*this._cellScale)+"px"):"http"===this.rowLabels[n].slice(0,4)?(r.innerHTML=this.rowLabels[n],r.style.fontSize=Math.floor(14*this._cellScale)+"px"):-1!==MATRIXSYNTHS.indexOf(this.rowLabels[n])?(r.innerHTML=this.rowArgs[n],r.style.fontSize=Math.floor(14*this._cellScale)+"px"):-1!==MATRIXGRAPHICS.indexOf(this.rowLabels[n])?(r.innerHTML=_(this.rowLabels[n])+"<br>"+this.rowArgs[n],r.style.fontSize=Math.floor(12*this._cellScale)+"px"):-1!==MATRIXGRAPHICS2.indexOf(this.rowLabels[n])?(r.innerHTML=_(this.rowLabels[n])+"<br>"+this.rowArgs[n][0]+" "+this.rowArgs[n][1],r.style.fontSize=Math.floor(12*this._cellScale)+"px"):noteIsSolfege(this.rowLabels[n])?r.innerHTML=i18nSolfege(this.rowLabels[n])+this.rowArgs[n].toString().sub():r.innerHTML=this.rowLabels[n]+this.rowArgs[n].toString().sub();for(var h=0;p=o.cells[h];h++){(f=u.insertCell()).style.backgroundColor=p.style.backgroundColor,f.innerHTML=p.innerHTML,f.width=p.width,""==f.width&&(f.width=p.style.width),f.colSpan=p.colSpan,f.style.minWidth=p.style.width,f.style.maxWidth=p.style.width,f.height="30px",f.style.fontSize="14px",f.style.padding="1px"}}if(this._matrixHasTuplets){var u;(r=(u=a.insertRow()).insertCell()).innerHTML=_("note value");var d=docById("ptmTupletNoteValueRow");for(n=0;n<d.cells.length;n++){var f=u.insertCell(),p=d.cells[n];f.style.backgroundColor=p.style.backgroundColor,f.innerHTML=p.innerHTML,f.width=p.width,""==f.width&&(f.width=p.style.width),f.colSpan=p.colSpan,f.style.minWidth=p.style.width,f.style.maxWidth=p.style.width,f.style.fontSize="14px",f.style.padding="1px"}(r=(u=a.insertRow()).insertCell()).innerHTML=_("tuplet value");for(d=docById("ptmTupletValueRow"),n=0;n<d.cells.length;n++){f=u.insertCell(),p=d.cells[n];f.style.backgroundColor=p.style.backgroundColor,f.innerHTML=p.innerHTML,f.width=p.width,""==f.width&&(f.width=p.style.width),f.colSpan=p.colSpan,f.style.minWidth=p.style.width,f.style.maxWidth=p.style.width,f.style.fontSize="14px",f.style.padding="1px"}}(r=(u=a.insertRow()).insertCell()).innerHTML=_("note value");for(d=docById("ptmNoteValueRow"),n=0;n<d.cells.length;n++){f=u.insertCell(),p=d.cells[n];f.style.backgroundColor=p.style.backgroundColor,f.innerHTML=p.innerHTML,f.width=p.width,""==f.width&&(f.width=p.style.width),f.colSpan=p.colSpan,f.style.minWidth=p.style.width,f.style.maxWidth=p.style.width,f.style.fontSize="14px",f.style.padding="1px"}var b=e.documentElement.outerHTML;e.body.innerHTML+='<br><a id="downloadb1" style="background:#C374E9;border-radius:5%;padding:0.3em;text-decoration:none;margin:0.5em;color:white;" download>Download Matrix</a>',e.getElementById("downloadb1").download="MusicMatrix",e.getElementById("downloadb1").href=this._generateDataURI(b),e.close()}else console.log("Could not create export window")},this.note2Solfege=function(t,e){if(-1===["",""].indexOf(t[1]))var i=t[1],s=SOLFEGECONVERSIONTABLE[t[0]];else i=t[2],s=SOLFEGECONVERSIONTABLE[t.substr(0,2)];this.rowLabels[e]=s,this.rowArgs[e]=i},this.addTuplet=function(t){for(var e=t[0][0]/t[0][1],i=t[1].length,s=0,l=(docById("ptmTable"),0);l<i;l++){if(0===l)var o=t[1][0];else o=LCD(o,t[1][l]);s+=32/t[1][l]}var a=0;for(l=0;l<i;l++)0<t[1][l]&&(a+=o/t[1][l]);this.rowLabels.length,(f=docById("ptm0")).cells.length;var n=t[0][1]/t[0][0],r=calcNoteValueToDisplay(t[0][1],t[0][0],this._cellScale);for(l=0;l<i;l++)this._notesToPlay.push([["R"],s*t[0][1]/(32/t[1][l])]),this._outputAsTuplet.push([i,n]);if(!this._matrixHasTuplets){var c=Math.max(Math.floor(.5*window.innerHeight/100),8),h=docById("ptmOuterDiv");if(this.rowLabels.length>c){h.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(c+6)+"px";var u=Math.max(Math.min(window.innerWidth,758*this._cellScale),535);h.style.width=u+"px"}else{h.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(this.rowLabels.length+6)+"px";u=Math.max(Math.min(window.innerWidth,758*this._cellScale-20),535);h.style.width=u+"px"}var d,f=docById("ptm0");(d=docById("ptmTupletNoteLabel")).innerHTML=_("note value"),d.style.fontSize=75*this._cellScale+"%",d.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",d.style.width=Math.floor(2*MATRIXSOLFEWIDTH*this._cellScale)+"px",d.style.minWidth=d.style.width,d.style.maxWidth=d.style.width,d.style.backgroundColor=platformColor.labelColor,(d=docById("ptmTupletValueLabel")).innerHTML=_("tuplet value"),d.style.fontSize=75*this._cellScale+"%",d.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",d.style.width=Math.floor(2*MATRIXSOLFEWIDTH*this._cellScale)+"px",d.style.minWidth=d.style.width,d.style.maxWidth=d.style.width,d.style.backgroundColor=platformColor.labelColor;var p=docById("ptmTupletNoteValueRow"),b=docById("ptmTupletValueRow");for(l=0;l<f.cells.length;l++){(g=p.insertCell()).style.backgroundColor=platformColor.tupletBackground,g.style.width=f.cells[l].style.width,g.style.minWidth=f.cells[l].style.minWidth,g.style.maxWidth=f.cells[l].style.maxWidth,g.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+"px",(g=b.insertCell()).style.backgroundColor=platformColor.tupletBackground,g.style.width=f.cells[l].style.width,g.style.minWidth=f.cells[l].style.minWidth,g.style.maxWidth=f.cells[l].style.maxWidth,g.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+"px"}}var m=n*a;for(l=0;l<i;l++){var g=(p=docById("ptmTupletNoteValueRow")).insertCell(-1),k=32/t[1][l],v=1/(k/(s/e));g.style.backgroundColor=platformColor.tupletBackground,g.style.width=this._noteWidth(v)+"px",g.style.minWidth=g.style.width,g.style.maxWidth=g.style.width,g.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",g.setAttribute("id",1/m),g.style.lineHeight="60%",g.style.fontSize=75*this._cellScale+"%",g.style.textAlign="center";var y=toFraction(k/(s/e));null!=NOTESYMBOLS&&y[1]in NOTESYMBOLS?g.innerHTML=y[0]+"<br>&mdash;<br>"+y[1]+'<br><img src="'+NOTESYMBOLS[y[1]]+'" height='+MATRIXSOLFEHEIGHT/2*this._cellScale+">":g.innerHTML=y[0]+"<br>&mdash;<br>"+y[1]+"<br><br>";for(var T=g.style.width,L=0;L<this.rowLabels.length;L++){if(-1!=MATRIXGRAPHICS.indexOf(this.rowLabels[L]))cellColor=platformColor.graphicsBackground;else{var w=getDrumName(this.rowLabels[L]);cellColor=null===w?platformColor.pitchBackground:platformColor.drumBackground}(g=docById("ptm"+L).insertCell()).setAttribute("cellColor",cellColor),g.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+"px",g.setAttribute("alt",1/m),g.style.width=T,g.style.minWidth=g.style.width,g.style.maxWidth=g.style.width,g.style.backgroundColor=cellColor,g.onmouseover=function(){"black"!==this.style.backgroundColor&&(this.style.backgroundColor=platformColor.selectorSelected)},g.onmouseout=function(){"black"!==this.style.backgroundColor&&(this.style.backgroundColor=this.getAttribute("cellColor"))}}}(g=(b=docById("ptmTupletValueRow")).insertCell()).colSpan=i,g.style.fontSize=Math.floor(75*this._cellScale)+"%",g.style.lineHeight="60%",g.style.width=this._noteWidth(n)+"px",g.style.minWidth=g.style.width,g.style.maxWidth=g.style.width,g.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",g.style.textAlign="center",g.innerHTML=a,g.style.backgroundColor=platformColor.tupletBackground,(g=docById("ptmNoteValueRow").insertCell()).colSpan=i,g.style.fontSize=Math.floor(75*this._cellScale)+"%",g.style.lineHeight="60%",g.style.width=this._noteWidth(n)+"px",g.style.minWidth=g.style.width,g.style.maxWidth=g.style.width,g.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",g.style.textAlign="center",g.innerHTML=r,g.style.backgroundColor=platformColor.rhythmcellcolor,this._matrixHasTuplets=!0},this._noteWidth=function(t){return Math.max(Math.floor(EIGHTHNOTEWIDTH*(8/t)*this._cellScale),15)},this.addNotes=function(t,e){docById("ptmTable");for(var i=calcNoteValueToDisplay(e,1,this._cellScale),s=0;s<t;s++)this._notesToPlay.push([["R"],e]),this._outputAsTuplet.push([t,e]);for(var l=this.rowLabels.length-this._rests,o=0;o<t;o++){for(s=0;s<l;s++){if(-1!=MATRIXGRAPHICS.indexOf(this.rowLabels[s])||-1!=MATRIXGRAPHICS2.indexOf(this.rowLabels[s]))cellColor=platformColor.graphicsBackground;else{var a=getDrumName(this.rowLabels[s]);cellColor=null===a?platformColor.pitchBackground:platformColor.drumBackground}(n=docById("ptm"+s).insertCell()).setAttribute("cellColor",cellColor),n.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+"px",n.style.width=this._noteWidth(e)+"px",n.style.minWidth=n.style.width,n.style.maxWidth=n.style.width,n.style.backgroundColor=cellColor,n.setAttribute("alt",1/e),n.onmouseover=function(){"black"!==this.style.backgroundColor&&(this.style.backgroundColor=platformColor.selectorSelected)},n.onmouseout=function(){"black"!==this.style.backgroundColor&&(this.style.backgroundColor=this.getAttribute("cellColor"))}}var n;if((n=docById("ptmNoteValueRow").insertCell()).style.width=this._noteWidth(e)+"px",n.style.minWidth=n.style.width,n.style.maxWidth=n.style.width,n.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",n.style.fontSize=Math.floor(75*this._cellScale)+"%",n.style.lineHeight="60%",n.style.textAlign="center",n.innerHTML=i,n.style.backgroundColor=platformColor.rhythmcellcolor,n.setAttribute("alt",e),this._matrixHasTuplets)(n=docById("ptmTupletNoteValueRow").insertCell()).style.width=this._noteWidth(e)+"px",n.style.minWidth=n.style.width,n.style.maxWidth=n.style.width,n.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",n.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",n.style.backgroundColor=platformColor.tupletBackground,(n=docById("ptmTupletValueRow").insertCell()).style.width=this._noteWidth(e)+"px",n.style.minWidth=n.style.width,n.style.maxWidth=n.style.width,n.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",n.style.height=Math.floor(1.5*MATRIXSOLFEHEIGHT*this._cellScale)+"px",n.style.backgroundColor=platformColor.tupletBackground}},this._lookForNoteBlocks=function(){this._noteBlocks=!1;for(var t=0;t<this._blockMap.length;t++){var e=this._blockMap[t][1][0];if(null!==this._logo.blocks.blockList[e])if(void 0!==this._logo.blocks.blockList[e]){if("newnote"===this._logo.blocks.blockList[e].name){console.log("FOUND A NOTE BLOCK."),this._noteBlocks=!0;break}}else console.log("block "+e+" is undefined")}},this._syncMarkedBlocks=function(){for(var i=[],t=0;t<this._blockMap.length;t++)if(-1!==this._blockMap[t][0])for(var e=0;e<this._blockMapHelper.length;e++)if(JSON.stringify(this._blockMap[t][1])===JSON.stringify(this._blockMapHelper[e][0]))for(var s=0;s<this._blockMapHelper[e][1].length;s++)i.push([this._blockMap[t][0],this._colBlocks[this._blockMapHelper[e][1][s]],this._blockMap[t][2]]);this._blockMap=i.filter(function(e,t){return t===i.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(e)})})},this.blockConnection=function(t,e){var i=this._logo.blocks.blockList.length-t;if(null==e)this._logo.blocks.blockList[this.blockNo].connections[2]=i,this._logo.blocks.blockList[i].connections[0]=this.blockNo;else{var s=this._logo.blocks.blockList[e].connections.length-1;this._logo.blocks.blockList[e].connections[s]=i,this._logo.blocks.blockList[i].connections[0]=e}this._logo.blocks.clampBlocksToCheck.push([this.blockNo,0]),this._logo.blocks.adjustDocks(this.blockNo,!0)},this._deleteRhythmBlock=function(t){null!==last(this._logo.blocks.blockList[t].connections)&&this._logo.blocks.sendStackToTrash(this._logo.blocks.blockList[last(this._logo.blocks.blockList[t].connections)]),this._logo.blocks.sendStackToTrash(this._logo.blocks.blockList[t]),this._logo.blocks.adjustDocks(this.blockNo,!0),this._logo.blocks.refreshCanvas()},this._addRhythmBlock=function(t,e){var i=[];t=toFraction(t);var s=this._logo.blocks.blockList[this.blockNo].connections[1],l=this._logo.blocks.findBottomBlock(s);i="vspace"===this._logo.blocks.blockList[l].name?[[0,["rhythm2",{}],0,0,[null,1,2,5]],[1,["number",{value:e}],0,0,[0]],[2,["divide",{}],0,0,[0,3,4]],[3,["number",{value:t[1]}],0,0,[2]],[4,["number",{value:t[0]}],0,0,[2]],[5,["vspace",{}],0,0,[0,null]]]:[[0,"vspace",0,0,[null,1]],[1,["rhythm2",{}],0,0,[0,2,3,6]],[2,["number",{value:e}],0,0,[1]],[3,["divide",{}],0,0,[1,4,5]],[4,["number",{value:t[1]}],0,0,[3]],[5,["number",{value:t[0]}],0,0,[3]],[6,["vspace",{}],0,0,[1,null]]],this._logo.blocks.loadNewBlocks(i);"vspace"===this._logo.blocks.blockList[l].name?setTimeout(this.blockConnection(6,l),500):setTimeout(this.blockConnection(7,l),500),this._logo.blocks.refreshCanvas()},this._update=function(t,e,i,s){var l=[];e=toFraction(e),"tupletnote"===s?(l.push(this._logo.blocks.blockList[this._logo.blocks.blockList[t].connections[1]].connections[1]),l.push(this._logo.blocks.blockList[this._logo.blocks.blockList[t].connections[1]].connections[2])):(l.push(this._logo.blocks.blockList[this._logo.blocks.blockList[t].connections[2]].connections[1]),l.push(this._logo.blocks.blockList[this._logo.blocks.blockList[t].connections[2]].connections[2])),"rhythm"!==s&&"stupletvalue"!==s||(l.push(this._logo.blocks.blockList[t].connections[1]),this._logo.blocks.blockList[l[2]].value=parseFloat(i),this._logo.blocks.blockList[l[2]].text.text=i.toString(),this._logo.blocks.blockList[l[2]].updateCache()),("rhythm"===s||"stuplet"===s||"tupletnote"===s&&null!==e)&&(this._logo.blocks.blockList[l[0]].value=parseFloat(e[1]),this._logo.blocks.blockList[l[0]].text.text=e[1].toString(),this._logo.blocks.blockList[l[0]].updateCache(),this._logo.blocks.blockList[l[1]].value=parseFloat(e[0]),this._logo.blocks.blockList[l[1]].text.text=e[0].toString(),this._logo.blocks.blockList[l[1]].updateCache(),this._logo.refreshCanvas()),saveLocally()},this._mapNotesBlocks=function(t,e){var i=[],s=this._logo.blocks.blockList[this.blockNo].connections[1],l=this._logo.blocks.blockList[s],o=0;for((l.name===t||"all"===t&&"hidden"!==l.name&&"vspace"!==l.name&&"hiddennoflow"!==l.name)&&(e?i.push([s,l.name]):i.push(s));null!=last(l.connections);){if((o+=1)>2*this._logo.blocks.blockList){console.log("infinite loop finding bottomBlock?");break}s=last(l.connections),((l=this._logo.blocks.blockList[s]).name===t||"all"===t&&"hidden"!==l.name&&"vspace"!==l.name&&"hiddennoflow"!==l.name)&&(e?i.push([s,l.name]):i.push(s))}return i},this.recalculateBlocks=function(){var t=[];t.push([this._logo.tupletRhythms[0][2],1]);for(var e=1,i=1;i<this._logo.tupletRhythms.length;i++)this._logo.tupletRhythms[i][2]===last(t)[0]?e+=1:(t[t.length-1][1]=e,t.push([this._logo.tupletRhythms[i][2],1]),e=1);return 1<e&&(t[t.length-1][1]=e),t},this._readjustNotesBlocks=function(){var t=this._mapNotesBlocks("rhythm2"),e=this.recalculateBlocks(),i=[],s=e.length-t.length;if(0<=s)for(var l=0;l<t.length;l++)this._update(t[l],e[l][0],e[l][1],"rhythm");else for(l=0;l<e.length;l++)this._update(t[l],e[l][0],e[l][1],"rhythm");for(l=0;l<s;l++)this._addRhythmBlock(e[t.length+l][0],e[t.length+l][1]);for(l=s;l<0;l++)this._deleteRhythmBlock(t[t.length+l]);t=this._mapNotesBlocks("rhythm2");for(l=0;l<t.length;l++)for(var o=0;o<e[l][1];o++)i.push([t[l],o]);this._colBlocks=i},this._restartGrid=function(t){this._matrixHasTuplets=!1,this.sorted=!0,this.init(this._logo),this.sorted=!1;for(var e=0;e<this._logo.tupletRhythms.length;e++)switch(this._logo.tupletRhythms[e][0]){case"simple":case"notes":var i=[this._logo.tupletParams[e]];i.push([]);for(var s=2;s<this._logo.tupletRhythms[e].length;s++)i[1].push(this._logo.tupletRhythms[e][s]);this.addTuplet(i);break;default:this.addNotes(this._logo.tupletRhythms[e][1],this._logo.tupletRhythms[e][2])}this.makeClickable(),docById("wheelDivptm").style.display="none",t._menuWheel.removeWheel(),t._exitWheel.removeWheel()},this._addNotes=function(t,e,i){e=parseInt(e),this._blockMapHelper=[];for(var s=0;s<=e;s++)this._blockMapHelper.push([this._colBlocks[s],[s]]);for(s=e+1;s<this._logo.tupletRhythms.length;s++)this._blockMapHelper.push([this._colBlocks[s],[s+parseInt(i)]]);for(s=0;s<parseInt(i);s++)this._logo.tupletRhythms=this._logo.tupletRhythms.slice(0,e+s+1).concat(this._logo.tupletRhythms.slice(e+s));this._readjustNotesBlocks(),this._syncMarkedBlocks(),this._restartGrid(t)},this._deleteNotes=function(t,e){if(1!==this._logo.tupletRhythms.length){e=parseInt(e),this._blockMapHelper=[];for(var i=0;i<e;i++)this._blockMapHelper.push([this._colBlocks[i],[i]]);for(i=e+1;i<this._logo.tupletRhythms.length;i++)this._blockMapHelper.push([this._colBlocks[i],[i-1]]);this._logo.tupletRhythms=this._logo.tupletRhythms.slice(0,e).concat(this._logo.tupletRhythms.slice(e+1)),this._readjustNotesBlocks(),this._syncMarkedBlocks(),this._restartGrid(t)}},this._divideNotes=function(t,e,i){e=parseInt(e),this._blockMapHelper=[];for(var s=0;s<e;s++)this._blockMapHelper.push([this._colBlocks[s],[s]]);this._logo.tupletRhythms=this._logo.tupletRhythms.slice(0,e).concat([[this._logo.tupletRhythms[e][0],this._logo.tupletRhythms[e][1],this._logo.tupletRhythms[e][2]*i]]).concat(this._logo.tupletRhythms.slice(e+1)),this._blockMapHelper.push([this._colBlocks[e],[]]);var l=0;for(s=0;s<i-1;s++)this._logo.tupletRhythms=this._logo.tupletRhythms.slice(0,e+s+1).concat(this._logo.tupletRhythms.slice(e+s)),l=e+s,this._blockMapHelper[e][1].push(l);l++,this._blockMapHelper[e][1].push(l);for(s=e+1;s<this._colBlocks.length;s++)l++,this._blockMapHelper.push([this._colBlocks[s],[l]]);this._readjustNotesBlocks(),this._syncMarkedBlocks(),this._restartGrid(t)},this._tieNotes=function(t,e){var i=null,s=null;s=t.id<e.id?(i=t.id,e.id):(i=e.id,t.id),this._blockMapHelper=[];for(var l=0;l<i;l++)this._blockMapHelper.push([this._colBlocks[l],[l]]);var o=l;for(l=i;l<=s;l++)this._blockMapHelper.push([this._colBlocks[l],[o]]);o++;for(l=parseInt(s)+1;l<this._logo.tupletRhythms.length;l++)this._blockMapHelper.push([this._colBlocks[l],[o]]),o++;var a=0;for(l=i;l<=s;l++)a+=1/parseFloat(this._logo.tupletRhythms[l][2]);this._logo.tupletRhythms=this._logo.tupletRhythms.slice(0,i).concat([[this._logo.tupletRhythms[i][0],this._logo.tupletRhythms[i][1],1/a]]).concat(this._logo.tupletRhythms.slice(parseInt(s)+1)),this._readjustNotesBlocks(),this._syncMarkedBlocks(),this._restartGrid(that)},this._updateTuplet=function(t,e,i,s){if(this._logo.tupletParams[e][1]=i,this._restartGrid(t),"simpletupletnote"===s){var l=this._mapNotesBlocks("stuplet");this._update(l[e],i,0,"stuplet")}else{l=this._mapNotesBlocks("tuplet4");this._update(l[e],i,0,"tupletnote")}},this._updateTupletValue=function(t,e,i,s){if(e=parseInt(e),i=parseInt(i),s=parseInt(s),this._blockMapHelper=[],i<s){for(var l=0,o=0;o<=this._logo.tupletRhythms.length&&o!=e;o++)for(var a=0;a<this._logo.tupletRhythms[o].length-2;a++)this._blockMapHelper.push([this._colBlocks[l],[l]]),l++;for(a=0;a<this._logo.tupletRhythms[e].length-2;a++)this._blockMapHelper.push([this._colBlocks[l],[l]]),l++;var n=l;l=l+s-i;for(o=e+1;o<this._logo.tupletRhythms.length;o++)for(a=0;a<this._logo.tupletRhythms[o].length-2;a++)this._blockMapHelper.push([this._colBlocks[n],[l]]),n++,l++;for(o=i;o<s;o++)this._logo.tupletRhythms[e]=this._logo.tupletRhythms[e].slice(0,this._logo.tupletRhythms[e].length).concat(this._logo.tupletRhythms[e].slice(this._logo.tupletRhythms[e].length-1))}else{for(l=0,o=0;o<=this._logo.tupletRhythms.length&&o!=e;o++)for(a=0;a<this._logo.tupletRhythms[o].length-2;a++)this._blockMapHelper.push([this._colBlocks[l],[l]]),l++;for(o=i;s<o;o--)this._logo.tupletRhythms[e]=this._logo.tupletRhythms[e].slice(0,this._logo.tupletRhythms[e].length-1);for(a=0;a<this._logo.tupletRhythms[e].length-2;a++)this._blockMapHelper.push([this._colBlocks[l],[l]]),l++;for(n=l+i-s,o=e+1;o<this._logo.tupletRhythms.length;o++)for(a=0;a<this._logo.tupletRhythms[o].length-2;a++)this._blockMapHelper.push([this._colBlocks[n],[l]]),n++,l++}var r=this._mapNotesBlocks("stuplet"),c=[];for(o=0;o<this._logo.tupletRhythms.length;o++)for(a=0;a<this._logo.tupletRhythms[o].length-2;a++)c.push([r[o],a]);this._colBlocks=c,this._restartGrid(t),this._syncMarkedBlocks(),this._update(r[e],null,s,"stupletvalue")},this._createpiesubmenu=function(i,s,e){if(docById("wheelDivptm").style.display="",this._menuWheel=new wheelnav("wheelDivptm",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._menuWheel.raphael),"tupletvalue"===e){var l=["1","2","3","-","4","5","6","7","8","+","9","10"];this.newNoteValue=String(s)}else"simpletupletnote"===e||"tupletnote"===e?(l=["<-","Enter","1","2","3","4","5","6","7","8","9","10"],this.newNoteValue="/"):"rhythmnote"===e&&(this._tabsWheel=new wheelnav("_tabsWheel",this._menuWheel.raphael),this.newNoteValue=2,l=["divide","delete","add",String(this.newNoteValue)]);wheelnav.cssMode=!0,this._menuWheel.keynavigateEnabled=!1,this._menuWheel.clickModeRotate=!1,this._menuWheel.colors=platformColor.pitchWheelcolors,this._menuWheel.slicePathFunction=slicePath().DonutSlice,this._menuWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._menuWheel.sliceSelectedPathCustom=this._menuWheel.slicePathCustom,this._menuWheel.sliceInitPathCustom=this._menuWheel.slicePathCustom,this._menuWheel.animatetime=0,this._exitWheel.colors=platformColor.exitWheelcolors,this._exitWheel.keynavigateEnabled=!1,this._exitWheel.clickModeRotate=!1,this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom;var t=[];if("tupletvalue"===e)t=["x",this.newNoteValue],this._menuWheel.slicePathCustom.minRadiusPercent=.4,this._menuWheel.slicePathCustom.maxRadiusPercent=1,this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.4;else if("simpletupletnote"===e||"tupletnote"===e)t=["x",this.newNoteValue],this._menuWheel.slicePathCustom.minRadiusPercent=.5,this._menuWheel.slicePathCustom.maxRadiusPercent=1,this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.5;else if("rhythmnote"===e){t=["x"," "];var o=["","","","","","","","","","","","","1","2","3","4","5","6","7",""];this._menuWheel.slicePathCustom.minRadiusPercent=.2,this._menuWheel.slicePathCustom.maxRadiusPercent=.7,this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._tabsWheel.colors=platformColor.pitchWheelcolors,this._tabsWheel.slicePathFunction=slicePath().DonutSlice,this._tabsWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._tabsWheel.slicePathCustom.minRadiusPercent=.7,this._tabsWheel.slicePathCustom.maxRadiusPercent=1,this._tabsWheel.sliceSelectedPathCustom=this._tabsWheel.slicePathCustom,this._tabsWheel.sliceInitPathCustom=this._tabsWheel.slicePathCustom,this._tabsWheel.clickModeRotate=!1,this._tabsWheel.createWheel(o);for(var a=0;a<o.length;a++)this._tabsWheel.navItems[a].navItem.hide()}this._menuWheel.createWheel(l),this._exitWheel.createWheel(t),docById("wheelDivptm").style.position="absolute",docById("wheelDivptm").style.height="250px",docById("wheelDivptm").style.width="250px";var n=docById(i).getBoundingClientRect().x,r=docById(i).getBoundingClientRect().y;docById("wheelDivptm").style.left=Math.min(this._logo.blocks.turtles._canvas.width-200,Math.max(0,n*this._logo.blocks.getStageScale()))+"px",docById("wheelDivptm").style.top=Math.min(this._logo.blocks.turtles._canvas.height-250,Math.max(0,r*this._logo.blocks.getStageScale()))+"px";var c=this;if(this._exitWheel.navItems[0].navigateFunction=function(){docById("wheelDivptm").style.display="none",c._menuWheel.removeWheel(),c._exitWheel.removeWheel()},"tupletvalue"===e){var h=function(){var t=c._menuWheel.selectedNavItemIndex,e=l[t];c.newNoteValue=String(e),docById("wheelnav-_exitWheel-title-1").children[0].textContent=c.newNoteValue,c._updateTupletValue(c,i,s,c.newNoteValue)};this._menuWheel.navItems[3].navigateFunction=function(){1<c.newNoteValue&&(c.newNoteValue=String(parseInt(c.newNoteValue)-1),docById("wheelnav-_exitWheel-title-1").children[0].textContent=c.newNoteValue,c._updateTupletValue(c,i,s,c.newNoteValue))},this._menuWheel.navItems[9].navigateFunction=function(){c.newNoteValue=String(parseInt(c.newNoteValue)+1),docById("wheelnav-_exitWheel-title-1").children[0].textContent=c.newNoteValue,c._updateTupletValue(c,i,s,c.newNoteValue)};for(a=0;a<l.length;a++)9!==a&&3!=a&&(this._menuWheel.navItems[a].navigateFunction=h)}else if("simpletupletnote"===e||"tupletnote"===e){var u=!1,d=!1;h=function(){var t=c._menuWheel.selectedNavItemIndex,e=l[t];u?d||(c.newNoteValue=c.newNoteValue+String(e),docById("wheelnav-_exitWheel-title-1").children[0].textContent=c.newNoteValue,d=!0):(c.newNoteValue=String(e)+"/",docById("wheelnav-_exitWheel-title-1").children[0].textContent=c.newNoteValue,u=!0)};this._menuWheel.navItems[0].navigateFunction=function(){if(d&&u){var t=c.newNoteValue.split("/");c.newNoteValue=t[0]+"/",docById("wheelnav-_exitWheel-title-1").children[0].textContent=c.newNoteValue,d=!1}else u&&(c.newNoteValue="/",docById("wheelnav-_exitWheel-title-1").children[0].textContent=c.newNoteValue,u=!1)},this._menuWheel.navItems[1].navigateFunction=function(){if(d&&u){var t=c.newNoteValue.split("/");c._updateTuplet(c,i,parseInt(t[1])/parseInt(t[0]),e)}};for(a=2;a<l.length;a++)this._menuWheel.navItems[a].navigateFunction=h}else if("rhythmnote"===e){var f=0;this._menuWheel.navItems[0].navigateFunction=function(){c._divideNotes(c,i,c.newNoteValue)},this._menuWheel.navItems[1].navigateFunction=function(){c._deleteNotes(c,i)},this._menuWheel.navItems[2].navigateFunction=function(){c._addNotes(c,i,c.newNoteValue)},this._menuWheel.navItems[3].navigateFunction=function(){if(f){for(t=12;t<19;t++)docById("wheelnav-wheelDivptm-title-3").children[0].textContent=c.newNoteValue,c._tabsWheel.navItems[t].navItem.hide();f=0}else{for(var t=12;t<19;t++)docById("wheelnav-wheelDivptm-title-3").children[0].textContent=c.newNoteValue,c._tabsWheel.navItems[t].navItem.show();f=1}};for(a=12;a<19;a++)this._tabsWheel.navItems[a].navigateFunction=function(){var t=c._tabsWheel.selectedNavItemIndex;c.newNoteValue=o[t],docById("wheelnav-wheelDivptm-title-3").children[0].textContent=o[t]}}},this.makeClickable=function(){for(var t=docById("ptmNoteValueRow"),e=docById("ptmTupletValueRow"),i=0;i<t.cells.length;i++){(b=t.cells[i]).setAttribute("id",i);var s=e.cells[i];void 0!==s&&s.setAttribute("id",i);var l=this;__mouseDownHandler=function(t){var e=t.target;l._mouseDownCell=e},__mouseUpHandler=function(t){var e=t.target;l._mouseUpCell=e,l._mouseDownCell!==l._mouseUpCell?l._tieNotes(l._mouseDownCell,l._mouseUpCell):l._createpiesubmenu(this.getAttribute("id"),this.getAttribute("alt"),"rhythmnote")},void 0!==s?"notes"===this._logo.tupletRhythms[0][0]?b.onclick=function(){l._createpiesubmenu(this.getAttribute("id"),null,"tupletnote")}:(b.onclick=function(){l._createpiesubmenu(this.getAttribute("id"),null,"simpletupletnote")},s.onclick=function(){l._createpiesubmenu(this.getAttribute("id"),this.getAttribute("colspan"),"tupletvalue")}):(b.removeEventListener("mousedown",__mouseDownHandler),b.addEventListener("mousedown",__mouseDownHandler),b.removeEventListener("mouseup",__mouseUpHandler),b.addEventListener("mouseup",__mouseUpHandler))}for(var o=this.rowLabels.length,a=0;a<o;a++){var n=docById("ptm"+a);for(i=0;i<n.cells.length;i++){"black"===(b=n.cells[i]).style.backgroundColor&&(b.style.backgroundColor=b.getAttribute("cellColor"),this._setNotes(i,a,!1))}}for(a=0;a<o;a++)for(n=docById("ptm"+a),i=0;i<n.cells.length;i++){(b=n.cells[i]).setAttribute("id",a+":"+i);l=this;var r=!1;b.onmousedown=function(){r=!0;var t=this.id.split(":"),e=Number(t[0]),i=Number(t[1]);"black"===this.style.backgroundColor?(this.style.backgroundColor=this.getAttribute("cellColor"),l._notesToPlay[i][0]=["R"],l._setNotes(i,e,!1)):(this.style.backgroundColor="black",l._setNotes(i,e,!0))},b.onmouseover=function(){var t=this.id.split(":"),e=Number(t[0]),i=Number(t[1]);r&&("black"===this.style.backgroundColor?(this.style.backgroundColor=this.getAttribute("cellColor"),l._notesToPlay[i][0]=["R"],l._setNotes(i,e,!1)):(this.style.backgroundColor="black",l._setNotes(i,e,!0)))},b.onmouseup=function(){r=!1}}if(this._lookForNoteBlocks(),this.sorted)for(a=0;a<this._rowMapper.length;a++){var c=this._rowMapper[a];for(n=docById("ptm"+(p=this._sortedRowMap[a])),i=0;i<this._markedColsInRow[c].length;i++){var h=this._markedColsInRow[c][i];(b=n.cells[h]).style.backgroundColor="black","R"===this._notesToPlay[h][0][0]&&(this._notesToPlay[h][0]=[]),this._setNoteCell(p,h,b,!1,null)}}else for(a=0;a<this._blockMap.length;a++){var u=this._blockMap[a];if(-1!==u[0]){var d=u[2],f=(h=0,null);for(i=0;i<this._rowBlocks.length;i++)if(this._rowBlocks[i]===u[0]){if(h===d){f=i;break}h+=1}if(null===f){console.log("Could not find a row match.");continue}var p=this._rowMap[f]+this._rowOffset[this._rowMap[f]];for(h=-1,i=0;i<this._colBlocks.length;i++)if(this._noteBlocks){if(this._colBlocks[i][0]===u[1][0]&&this._colBlocks[i][1]===d){h=i;break}}else if(this._colBlocks[i][0]===u[1][0]&&this._colBlocks[i][1]===u[1][1]){h=i;break}if(-1==h)continue;var b;if(null===(n=docById("ptm"+p)))console.log("COULD NOT FIND ROW "+p);else null!=(b=n.cells[h])&&(b.style.backgroundColor="black","R"===this._notesToPlay[h][0][0]&&(this._notesToPlay[h][0]=[]),this._setNoteCell(p,h,b,!1,null))}}},this.playAll=function(t){this.playingNow=!this.playingNow;var e=t.cells[1];if(this.playingNow){e.innerHTML='&nbsp;&nbsp;<img src="header-icons/stop-button.svg" title="'+_("stop")+'" alt="'+_("stop")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;',this._logo.synth.stop();var i=[];for(var s in this._notesToPlay)i.push(this._notesToPlay[s]);this._notesToPlay=i,this._notesCounter=0;var l=this._notesToPlay[this._notesCounter][0],o=[],a=[],n=[];for(s=0;s<l.length;s++){if("number"==typeof l[s])var r=null;else r=getDrumName(l[s]);if("number"==typeof l[s])a.push(l[s]);else if(null!=r)n.push(r);else if("http"===l[s].slice(0,4))n.push(l[s]);else{var c=l[s].split(":");1<c.length?-1!==MATRIXSYNTHS.indexOf(c[0])?a.push(l[s]):this._processGraphics(c):o.push(l[s].replace(//g,"b").replace(//g,"#"))}this._stopOrCloseClicked=!1}var h=this._notesToPlay[this._notesCounter][1];this._notesCounter+=1,this._colIndex=0;var u=(t=docById("ptmNoteValueRow")).cells[this._colIndex];if(u.style.backgroundColor=platformColor.selectorBackground,1<u.colSpan)this._spanCounter=1,(t=docById("ptmTupletNoteValueRow")).cells[this._colIndex].style.backgroundColor=platformColor.selectorBackground;else this._spanCounter=0,this._colIndex+=1;"R"!==l[0]&&0<o.length&&this._playChord(o,this._logo.defaultBPMFactor/h);for(s=0;s<a.length;s++)this._logo.synth.trigger(0,[Number(a[s])],this._logo.defaultBPMFactor/h,this._instrumentName,null,null);for(s=0;s<n.length;s++)this._logo.synth.trigger(0,"C2",this._logo.defaultBPMFactor/h,n[s],null,null);this.__playNote(0,0,e)}else this._stopOrCloseClicked=!0,e.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;'},this._resetMatrix=function(){for(var t=docById("ptmNoteValueRow"),e=0;e<t.cells.length;e++){t.cells[e].style.backgroundColor=platformColor.rhythmcellcolor}if(that._matrixHasTuplets)for(t=docById("ptmTupletNoteValueRow"),e=0;e<t.cells.length;e++){t.cells[e].style.backgroundColor=platformColor.tupletBackground}},this.__playNote=function(n,r,c){if("hidden"!==docById("ptmDiv").style.visibility){noteValue=this._notesToPlay[r][1],n=1/noteValue;var h=this;setTimeout(function(){if(r===h._notesToPlay.length-1)h._resetMatrix(),c.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;',h.playingNow=!1;else{if(null!=(a=docById("ptmNoteValueRow").cells[h._colIndex]))if(a.style.backgroundColor=platformColor.selectorBackground,1<a.colSpan)docById("ptmTupletNoteValueRow").cells[h._notesCounter].style.backgroundColor=platformColor.selectorBackground;h._notesCounter>=h._notesToPlay.length&&(h._notesCounter=1,h._logo.synth.stop()),note=h._notesToPlay[h._notesCounter][0],noteValue=h._notesToPlay[h._notesCounter][1],h._notesCounter+=1;var t=[],e=[],i=[];if(!h._stopOrCloseClicked)for(var s=0;s<note.length;s++){if("number"==typeof note[s])var l=null;else l=getDrumName(note[s]);if("number"==typeof note[s])e.push(note[s]);else if(null!=l)i.push(l);else if("http"===note[s].slice(0,4))i.push(note[s]);else{var o=note[s].split(":");if(-1!==MATRIXSYNTHS.indexOf(o[0])){e.push(note[s]);continue}-1!==MATRIXGRAPHICS.indexOf(o[0])?h._processGraphics(o):-1!==MATRIXGRAPHICS2.indexOf(o[0])?h._processGraphics(o):t.push(note[s].replace(//g,"b").replace(//g,"#"))}}"R"!==note[0]&&0<t.length&&h._playChord(t,h._logo.defaultBPMFactor/noteValue);for(s=0;s<e.length;s++)h._logo.synth.trigger(0,[Number(e[s])],h._logo.defaultBPMFactor/noteValue,h._instrumentName,null,null);for(s=0;s<i.length;s++)h._logo.synth.trigger(0,["C2"],h._logo.defaultBPMFactor/noteValue,i[s],null,null)}var a;null!=(a=docById("ptmNoteValueRow").cells[h._colIndex])&&(1<a.colSpan?(h._spanCounter+=1,h._spanCounter===a.colSpan&&(h._spanCounter=0,h._colIndex+=1)):(h._spanCounter=0,h._colIndex+=1),(r+=1)<h._notesToPlay.length&&h.playingNow?h.__playNote(n,r,c):(h._resetMatrix(),c.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;'))},1e3*h._logo.defaultBPMFactor*n+h._logo.turtleDelay)}},this._playChord=function(t,e){var i=this;setTimeout(function(){i._logo.synth.trigger(0,t[0],e,i._instrumentName,null,null)},1),1<t.length&&setTimeout(function(){i._logo.synth.trigger(0,t[1],e,i._instrumentName,null,null)},1),2<t.length&&setTimeout(function(){i._logo.synth.trigger(0,t[2],e,i._instrumentName,null,null)},1),3<t.length&&setTimeout(function(){i._logo.synth.trigger(0,t[3],e,i._instrumentName,null,null)},1)},this._processGraphics=function(t){switch(t[0]){case"forward":this._logo.turtles.turtleList[0].doForward(t[1]);break;case"back":this._logo.turtles.turtleList[0].doForward(-t[1]);break;case"right":this._logo.turtles.turtleList[0].doRight(t[1]);break;case"left":this._logo.turtles.turtleList[0].doRight(-t[1]);break;case"setcolor":this._logo.turtles.turtleList[0].doSetColor(t[1]);break;case"sethue":this._logo.turtles.turtleList[0].doSetHue(t[1]);break;case"setshade":this._logo.turtles.turtleList[0].doSetValue(t[1]);break;case"setgrey":this._logo.turtles.turtleList[0].doSetChroma(t[1]);break;case"settranslucency":var e=1-t[1]/100;this._logo.turtles.turtleList[0].doSetPenAlpha(e);break;case"setpensize":this._logo.turtles.turtleList[0].doSetPensize(t[1]);break;case"setheading":this._logo.turtles.turtleList[0].doSetHeading(t[1]);break;case"arc":this._logo.turtles.turtleList[0].doArc(t[1],t[2]);break;case"setxy":this._logo.turtles.turtleList[0].doSetXY(t[1],t[2]);break;default:console.log("unknown graphics command "+t[0])}},this._setNotes=function(t,e,i){var s=this._rowBlocks[this._rowMap.indexOf(e-this._rowOffset[e])],l=this._colBlocks[t];i?this.addNode(s,l[0],l[1]):this.removeNode(s,l[0],l[1]),this._notesToPlay[t][0]=[];for(var o=0;o<this.rowLabels.length;o++){var a=docById("ptm"+o).cells[t];"black"===a.style.backgroundColor&&this._setNoteCell(o,t,a,i)}},this._setNoteCell=function(t,e,i,s){var l=this._noteStored[t];if("hertz"===this.rowLabels[t])var o=null,a=!1,n=[l];else{o=getDrumName(l),a=!1;if(graphicNote=l.split(":"),-1!=MATRIXGRAPHICS.indexOf(graphicNote[0])&&-1!=MATRIXGRAPHICS2.indexOf(graphicNote[0]))a=!0;n=l.split(":")}var r=docById("ptm"+t).cells[e].getAttribute("alt");this._notesToPlay[parseInt(e)][0].push(l),1===n.length?s&&(null!=o?this._logo.synth.trigger(0,"C2",r,o,null,null):"hertz"===this.rowLabels[t]?this._logo.synth.trigger(0,Number(l),r,this._instrumentName,null,null):!0!==a?"string"==typeof l?this._logo.synth.trigger(0,l.replace(//g,"b").replace(//g,"#"),r,this._instrumentName,null,null):this._logo.synth.trigger(0,l,r,this._instrumentName,null,null):console.log("Cannot parse note object: "+n)):-1!==MATRIXSYNTHS.indexOf(n[0])&&this._logo.synth.trigger(0,[Number(n[1])],r,n[0],null,null)},this._clear=function(){for(var t=0;t<this.rowLabels.length;t++)for(var e=docById("ptm"+t),i=0;i<e.cells.length;i++){var s=e.cells[i];"black"===s.style.backgroundColor&&(s.style.backgroundColor=s.getAttribute("cellColor"),this._notesToPlay[i][0]=["R"],this._setNotes(i,t,!1))}},this._save=function(){for(var t in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[t].hideMenu(!0);this._logo.refreshCanvas();for(var e=[[0,["action",{collapsed:!0}],100,100,[null,1,null,null]],[1,["text",{value:_("action")}],0,0,[0]]],i=0,s=0;s<this._notesToPlay.length;s++){var l=this._notesToPlay[s].slice(0);""===l[0]&&(l[0]="R");var o=e.length;e.push([o,"newnote",0,0,[i,o+1,o+2,null]]);var a=e[o][4].length;0===s?e[i][4][a-2]=o:e[i][4][a-1]=o;i=o;if(1!==this._outputAsTuplet[s][0]&&parseInt(this._outputAsTuplet[s][1])===this._outputAsTuplet[s][1]){var n=7;e.push([o+1,"vspace",0,0,[o,o+n]]),e.push([o+2,"divide",0,0,[o,o+3,o+4]]),e.push([o+3,["number",{value:1}],0,0,[o+2]]),e.push([o+4,"multiply",0,0,[o+2,o+5,o+6]]),e.push([o+5,["number",{value:this._outputAsTuplet[s][0]}],0,0,[o+4]]),e.push([o+6,["number",{value:this._outputAsTuplet[s][1]}],0,0,[o+4]])}else{n=5;if(e.push([o+1,"vspace",0,0,[o,o+n]]),e.push([o+2,"divide",0,0,[o,o+3,o+4]]),parseInt(l[1])<l[1]){var r=toFraction(l[1]);e.push([o+3,["number",{value:r[1]}],0,0,[o+2]]),e.push([o+4,["number",{value:r[0]}],0,0,[o+2]])}else e.push([o+3,["number",{value:1}],0,0,[o+2]]),e.push([o+4,["number",{value:l[1]}],0,0,[o+2]])}e[o][4][1]=o+2,e[o][4][2]=o+1;if("R"===l[0][0]||null==l[0][0]){var c=null;if(5===n||7===n)var h=o+1;else h=o;var u=o+(n-=2);e.push([u+1,"rest2",0,0,[h,c]]),h+=n}else{u=o+n;for(var d=0;d<l[0].length;d++){if(0===d)if(5===n||7===n)h=o+1;else h=o;if("number"==typeof l[0][d]){r=null;var f=null}else r=l[0][d].split(":"),f=getDrumName(l[0][d]);if(null==r){if(1===l[0].length||d===l[0].length-1)c=null;else c=u+2;e.push([u,"hertz",0,0,[h,u+1,c]]),e.push([u+1,["number",{value:l[0][d]}],0,0,[u]]),h=(u+=2)-2}else if(null!=f){if(1===l[0].length||d===l[0].length-1)c=null;else c=u+2;e.push([u,"playdrum",0,0,[h,u+1,c]]),e.push([u+1,["drumname",{value:f}],0,0,[u]]),h=(u+=2)-2}else if("http"===l[0][d].slice(0,4)){if(1===l[0].length||d===l[0].length-1)c=null;else c=u+2;e.push([u,"playdrum",0,0,[h,u+1,c]]),e.push([u+1,["text",{value:l[0][d]}],0,0,[u]]),h=(u+=2)-2}else if(2<r.length){if(1===l[0].length||d===l[0].length-1)c=null;else c=u+3;e.push([u,r[0],0,0,[h,u+1,u+2,c]]),e.push([u+1,["number",{value:Number(r[1])}],0,0,[u]]),e.push([u+2,["number",{value:Number(r[2])}],0,0,[u]]),h=(u+=3)-3}else if(1<r.length){if(1===l[0].length||d===l[0].length-1)c=null;else c=u+2;e.push([u,r[0],0,0,[h,u+1,c]]),e.push([u+1,["number",{value:Number(r[1])}],0,0,[u]]),h=(u+=2)-2}else{if(1===l[0].length||d===l[0].length-1)c=null;else c=u+3;h=(""===l[0][d][1]?"custom"==this._logo.synth.inTemperament?(e.push([u,"pitch",0,0,[h,u+1,u+2,c]]),e.push([u+1,["customNote",{value:l[0][d].substring(0,l[0][d].length-1)}],0,0,[u]]),e.push([u+2,["number",{value:l[0][d].slice(-1)}],0,0,[u]])):(e.push([u,"pitch",0,0,[h,u+1,u+2,c]]),e.push([u+1,["solfege",{value:SOLFEGECONVERSIONTABLE[l[0][d][0]+""]}],0,0,[u]]),e.push([u+2,["number",{value:l[0][d][2]}],0,0,[u]])):""===l[0][d][1]?"custom"==this._logo.synth.inTemperament?(e.push([u,"pitch",0,0,[h,u+1,u+2,c]]),e.push([u+1,["customNote",{value:l[0][d].substring(0,l[0][d].length-1)}],0,0,[u]]),e.push([u+2,["number",{value:l[0][d].slice(-1)}],0,0,[u]])):(e.push([u,"pitch",0,0,[h,u+1,u+2,c]]),e.push([u+1,["solfege",{value:SOLFEGECONVERSIONTABLE[l[0][d][0]+""]}],0,0,[u]]),e.push([u+2,["number",{value:l[0][d][2]}],0,0,[u]])):(e.push([u,"pitch",0,0,[h,u+1,u+2,c]]),"custom"==this._logo.synth.inTemperament?(e.push([u+1,["customNote",{value:l[0][d].substring(0,l[0][d].length-1)}],0,0,[u]]),e.push([u+2,["number",{value:l[0][d].slice(-1)}],0,0,[u]])):(e.push([u+1,["solfege",{value:SOLFEGECONVERSIONTABLE[l[0][d][0]]}],0,0,[u]]),e.push([u+2,["number",{value:l[0][d][1]}],0,0,[u]]))),u),u+=3}}}}this._logo.blocks.loadNewBlocks(e)}}function RhythmRuler(){this.Drums=[],this.Rulers=[],this._dissectHistory=[],this._undoList=[],this._playing=!1,this._playingOne=!1,this._playingAll=!1,this._cellCounter=0,this._elapsedTimes=[],this._startingTime=null,this._offsets=[],this._rulerSelected=0,this._rulerPlaying=-1,this._tapMode=!1,this._tapTimes=[],this._tapCell=null,this._tapEndTime=null,this._longPressStartTime=null,this._inLongPress=!1,this._mouseDownCell=null,this._mouseUpCell=null,this._wheel=null,this._noteWidth=function(t){return Math.floor(EIGHTHNOTEWIDTH*(8/Math.abs(t))*3)},this._calculateZebraStripes=function(t){var e=docById("ruler"+t);if(this._rulerSelected%2==0)var i=platformColor.selectorBackground;else i=platformColor.selectorSelected;for(var s=0;s<e.cells.length;s++){var l=e.cells[s];i===platformColor.selectorBackground&&(l.style.backgroundColor=s%2==0?platformColor.selectorBackground:platformColor.selectorSelected),i===platformColor.selectorSelected&&(l.style.backgroundColor=s%2==0?platformColor.selectorSelected:platformColor.selectorBackground)}},this._dissectRuler=function(t){var e=t.target;if(null!=e)if(this._tapMode&&0<this._tapTimes.length){var i=new Date;this._tapTimes.push(i.getTime())}else{var s=e.parentNode;if(null!=s&&(this._rulerSelected=s.id[5],null!=this._rulerSelected))if(this._playing)console.log("You cannot dissect while widget is playing.");else if(this._tapMode){if(null===this._tapCell){var l=this.Rulers[this._rulerSelected][0];if(this._tapCell=t.target,l[this._tapCell.cellIndex]<0){this._tapCell=null,this._tapMode=!1,this._tapTimes=[],this._tapEndTime=null;return void(this._tapButton.innerHTML='&nbsp;&nbsp;<img src="header-icons/tap-button.svg" title="'+_("tap a rhythm")+'" alt="'+_("tap a rhythm")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;')}this._tapTimes=[];var o=this._bpmFactor/Math.abs(l[this._tapCell.cellIndex]);if(null===this.Drums[this._rulerSelected])var a="snare drum";else{var n=this._logo.blocks.blockList[this.Drums[this._rulerSelected]].connections[1];a=this._logo.blocks.blockList[n].value}for(var r=this,c=0;c<4;c++)setTimeout(function(){r._logo.synth.trigger(0,"C4",r._logo.defaultBPMFactor/16,a,null,null)},o*c/4);setTimeout(function(){r.__startTapping(l,o)},o)}}else{l=this.Rulers[this._rulerSelected][0];var h=docById("dissectNumber").value;h=""===h||isNaN(h)?2:Math.abs(Math.floor(h)),docById("dissectNumber").value=h,this._rulerSelected=e.parentNode.id[5],this.__dissectByNumber(e,h,!0)}}},this.__startTapping=function(t,e){var i=new Date;this._tapTimes=[i.getTime()],this._tapEndTime=this._tapTimes[0]+e;var s,l,o,a,n,r=this;setTimeout(function(){r.__endTapping()},e),this._tapCell.innerHTML='<div id="progressBar"></div>',s=e/8,l=12.5,o=docById("progressBar"),a=1,n=setInterval(function(){100<=a?clearInterval(n):(a+=l,o.style.width=a+"%")},s)},this.__endTapping=function(){this._rulerSelected=this._tapCell.parentNode.id[5],this._tapCell.innerHTML="";var t=new Date;if(this._tapTimes.push(t.getTime()),this._tapMode=!1,"string"==typeof this._rulerSelected||"number"==typeof this._rulerSelected){var e=this.Rulers[this._rulerSelected][0];last(this._tapTimes)>this._tapEndTime&&(this._tapTimes[this._tapTimes.length-1]=this._tapEndTime);var i=docById("dissectNumber").value;switch(i=""===i||isNaN(i)?2:Math.abs(Math.floor(i))){case 2:var s=16;break;case 3:s=27;break;case 4:s=32;break;case 5:s=25;break;case 6:s=36;break;case 7:s=14;break;case 8:s=64;break;default:s=16}for(var l=[],o=0,a=(this._bpmFactor,Math.abs(e[this._tapCell.cellIndex]),1);a<this._tapTimes.length;a++){var n=this._tapTimes[a]-this._tapTimes[a-1];if(a<this._tapTimes.length-1){0===(r=nearestBeat(100*n/this._bpmFactor,s))[0]&&(r[0]=1,r[1]=r[1]/2),o+r[0]/r[1]<1&&(o+=r[0]/r[1],l.push(r[1]/r[0]))}else{var r=rationalToFraction(1/e[this._tapCell.cellIndex]-o);l.push(r[1]/r[0])}}this.__divideFromList(this._tapCell,l,!0)}this._tapTimes=[],this._tapCell=null,this._tapEndTime=null;this._tapButton.innerHTML='&nbsp;&nbsp;<img src="header-icons/tap-button.svg" title="'+_("tap a rhythm")+'" alt="'+_("tap a rhythm")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;'},this.__addCellEventHandlers=function(t,e,i){var l=this;if(__mouseOverHandler=function(t){var e=t.target;if(null!=e){l._rulerSelected=e.parentNode.id[5];var i=l.Rulers[l._rulerSelected][0][e.cellIndex];if(i<0){var s=rationalToFraction(Math.abs(Math.abs(-1/i)));e.innerHTML=calcNoteValueToDisplay(s[1],s[0],l._cellScale)+" "+_("silence")}else{s=rationalToFraction(Math.abs(Math.abs(1/i)));e.innerHTML=calcNoteValueToDisplay(s[1],s[0],l._cellScale)}}},__mouseOutHandler=function(t){t.target.innerHTML=""},__mouseDownHandler=function(t){var e=t.target;l._mouseDownCell=e;var i=new Date;l._longPressStartTime=i.getTime(),l._inLongPress=!1,l._longPressBeep=setTimeout(function(){l._logo.synth.trigger(0,"C4",1/32,"chime",null,null);var t=l._mouseDownCell;if(null!=t){l._rulerSelected=t.parentNode.id[5];l.Rulers[l._rulerSelected][0][t.cellIndex];t.style.backgroundColor=platformColor.selectorBackground}},1500)},__mouseUpHandler=function(t){clearTimeout(l._longPressBeep);var e=t.target;if(l._mouseUpCell=e,l._mouseDownCell!==l._mouseUpCell)l._tieRuler(t);else if(null!=l._longPressStartTime&&!l._tapMode){1500<(new Date).getTime()-l._longPressStartTime&&(l._inLongPress=!0,l.__toggleRestState(this,!0))}l._mouseDownCell=null,l._mouseUpCell=null,l._longPressStartTime=null},__clickHandler=function(t){if(null!=t){if(!l.__getLongPressStatus())null!=t.target?l._dissectRuler(t):console.log("Rhythm Ruler: null cell found on click");l._inLongPress=!1}},12<e&&0<i){var s=rationalToFraction(Math.abs(1/i));t.innerHTML=calcNoteValueToDisplay(s[1],s[0],l._cellScale)}else t.innerHTML="",t.removeEventListener("mouseover",__mouseOverHandler),t.addEventListener("mouseover",__mouseOverHandler),t.removeEventListener("mouseout",__mouseOutHandler),t.addEventListener("mouseout",__mouseOutHandler);t.removeEventListener("mousedown",__mouseDownHandler),t.addEventListener("mousedown",__mouseDownHandler),t.removeEventListener("mouseup",__mouseUpHandler),t.addEventListener("mouseup",__mouseUpHandler),t.removeEventListener("click",__clickHandler),t.addEventListener("click",__clickHandler)},this.__getLongPressStatus=function(){return this._inLongPress},this.__toggleRestState=function(t,e){var l=this;if(null!=t){this._rulerSelected=t.parentNode.id[5];var i=this.Rulers[this._rulerSelected][0],s=i[t.cellIndex];if(__mouseOverHandler=function(t){var e=t.target;if(null!=e){l._rulerSelected=e.parentNode.id[5];var i=l.Rulers[l._rulerSelected][0][e.cellIndex];if(i<0){var s=rationalToFraction(Math.abs(Math.abs(-1/i)));e.innerHTML=calcNoteValueToDisplay(s[1],s[0],l._cellScale)+" "+_("silence")}else{s=rationalToFraction(Math.abs(Math.abs(1/i)));e.innerHTML=calcNoteValueToDisplay(s[1],s[0],l._cellScale)}}},__mouseOutHandler=function(t){t.target.innerHTML=""},s<0){var o=rationalToFraction(Math.abs(1/s));t.innerHTML=calcNoteValueToDisplay(o[1],o[0],l._cellScale),t.removeEventListener("mouseover",__mouseOverHandler),t.removeEventListener("mouseout",__mouseOutHandler)}else t.innerHTML="",t.removeEventListener("mouseover",__mouseOverHandler),t.addEventListener("mouseover",__mouseOverHandler),t.removeEventListener("mouseout",__mouseOutHandler),t.addEventListener("mouseout",__mouseOutHandler);i[t.cellIndex]=-s,this._calculateZebraStripes(this._rulerSelected);var a=this.Rulers[this._rulerSelected][1];e&&this._undoList.push(["rest",this._rulerSelected]),a.push(t.cellIndex)}},this.__divideFromList=function(t,e,i){if("object"===_typeof(t)&&"object"===_typeof(e)){var s=docById("ruler"+this._rulerSelected),l=t.cellIndex;if("string"==typeof this._rulerSelected||"number"==typeof this._rulerSelected){var o=this.Rulers[this._rulerSelected][0],a=this.Rulers[this._rulerSelected][1];i&&this._undoList.push(["tap",this._rulerSelected]),a.push([l,e]),s.deleteCell(l);o[l],this._noteWidth(c);o.splice(l,1);for(var n=0;n<e.length;n++){var r=s.insertCell(l+n),c=e[n],h=parseFloat(this._noteWidth(c));o.splice(l+n,0,c),r.style.width=h+"px",r.style.minWidth=r.style.width,r.style.maxWidth=r.style.width,r.style.height="70px",r.style.minHeight=r.style.height,r.style.maxHeight=r.style.height,this.__addCellEventHandlers(r,h,c)}this._calculateZebraStripes(this._rulerSelected)}}},this.__dissectByNumber=function(t,e,i){if("object"===_typeof(t)&&"number"==typeof e){var s=docById("ruler"+this._rulerSelected),l=t.cellIndex;if("string"==typeof this._rulerSelected||"number"==typeof this._rulerSelected){var o=this.Rulers[this._rulerSelected][0],a=this.Rulers[this._rulerSelected][1];i&&this._undoList.push(["dissect",this._rulerSelected]),a.push([l,e]),s.deleteCell(l);var n=o[l],r=0;e*n<=256?(r=e*n,this._logo.hideMsgs()):(console.log("Top max value exceeded"),this._logo.errorMsg(_("Maximum value of 256 has been exceeded.")),r=e);var c=this._noteWidth(r),h=(parseFloat(e),parseFloat(c),parseFloat(this._noteWidth(n))-parseFloat(e)*parseFloat(c)),u=parseFloat(this._noteWidth(r))+parseFloat(h)/e;o.splice(l,1);for(var d=0;d<e;d++){var f=s.insertCell(l+d);o.splice(l+d,0,r),f.style.width=u+"px",f.style.minWidth=f.style.width,f.style.maxWidth=f.style.width,f.style.height="70px",f.style.minHeight=f.style.height,f.style.maxHeight=f.style.height,this.__addCellEventHandlers(f,u,r)}this._calculateZebraStripes(this._rulerSelected)}}},this._tieRuler=function(t){if(this._playing)console.log("You cannot tie while widget is playing.");else if(this._tapMode)this._dissectRuler(t);else{var e=t.target;null!=e&&(this._rulerSelected=e.parentNode.id[5],this.__tie(!0))}},this.__tie=function(t){var e=docById("ruler"+this._rulerSelected);if(null!==this._mouseDownCell&&null!==this._mouseUpCell&&this._mouseDownCell!==this._mouseUpCell&&("string"==typeof this._rulerSelected||"number"==typeof this._rulerSelected)){var i=this.Rulers[this._rulerSelected][0],s=this._mouseDownCell.cellIndex,l=this._mouseUpCell.cellIndex;if(-1===s||-1===l)return;if(l<s){var o=s;s=l,l=o;o=this._mouseDdownCell;this._mouseDownCell=this._mouseUpCell,this._mouseUpCell=o}i=this.Rulers[this._rulerSelected][0];var a=this.Rulers[this._rulerSelected][1];t&&this._undoList.push(["tie",this._rulerSelected]);for(var n=[],r=s;r<l+1;r++)n.push([r,i[r]]);a.push(n);var c=i[s],h=Math.abs(1/c);for(r=l;s<r;r--)h+=Math.abs(1/i[r]),e.deleteCell(r),this.Rulers[this._rulerSelected][0].splice(r,1);var u=this._noteWidth(1/h);i[s]=c<0?-1/h:1/h,this._mouseDownCell.style.width=u+"px",this._mouseDownCell.style.minWidth=this._mouseDownCell.style.width,this._mouseDownCell.style.maxWidth=this._mouseDownCell.style.width,this._mouseDownCell.style.height="70px",this._mouseDownCell.style.minHeight=this._mouseDownCell.style.height,this._mouseDownCell.style.maxHeight=this._mouseDownCell.style.height,this.__addCellEventHandlers(this._mouseDownCell,u,i[s]),this._calculateZebraStripes(this._rulerSelected)}},this._undo=function(){if(this._logo.synth.stop(),this._startingTime=null,this._playing=!1,this._playingAll=!1,this._playingOne=!1,this._rulerPlaying=-1,this._startingTime=null,0!==this._undoList.length){var t=(f=this._undoList.pop())[1],e=this.Rulers[t][1];if(0!==e.length){var i=docById("ruler"+t),s=this.Rulers[t][0];if("dissect"===f[0]){var l=e[e.length-1][1],o=e[e.length-1][0],a=i.cells[o].style.width,n=parseFloat(a)*l,r=(u=s[o])/l;(g=i.insertCell(o)).style.width=this._noteWidth(r)+"px",g.style.minWidth=g.style.width,g.style.maxWidth=g.style.width,g.style.height="70px",g.style.minHeight=g.style.height,g.style.maxHeight=g.style.height,g.style.backgroundColor=platformColor.selectorBackground,g.innerHTML=calcNoteValueToDisplay(u/l,1,this._cellScale),s[o]=u/l,s.splice(o+1,l-1),this.__addCellEventHandlers(g,n,r);for(var c=0;c<l;c++)i.deleteCell(o+1)}else if("tap"===f[0]){o=last(e)[0];var h=last(e)[1],u=s[o],d=0;for(c=0;c<h.length;c++)d+=1/h[c];r=1/d,n=this._noteWidth(r);(g=i.insertCell(o)).style.width=n+"px",g.style.minWidth=g.style.width,g.style.maxWidth=g.style.width,g.style.height="70px",g.style.minHeight=g.style.height,g.style.maxHeight=g.style.height,g.style.backgroundColor=platformColor.selectorBackground;var f=rationalToFraction(r);g.innerHTML=calcNoteValueToDisplay(f[1],f[0],this._cellScale),s[o]=r,s.splice(o+1,h.length-1),this.__addCellEventHandlers(g,n,r);for(c=0;c<h.length;c++)i.deleteCell(o+1)}else if("tie"===f[0]){var p=last(e);if(0<p.length){var b=i.cells[p[0][0]],m=this._noteWidth(p[0][1]);b.style.width=m+"px",b.style.minWidth=b.style.width,b.style.maxWidth=b.style.width,b.style.height="70px",b.style.minHeight=b.style.height,b.style.maxHeight=b.style.height,s[p[0][0]]=p[0][1],this.__addCellEventHandlers(b,m,p[0][1]);for(c=1;c<p.length;c++){var g=i.insertCell(p[0][0]+c);n=this._noteWidth(p[c][1]);g.style.width=n+"px",g.style.minWidth=g.style.width,g.style.maxWidth=g.style.width,g.style.height="70px",g.style.minHeight=g.style.height,g.style.maxHeight=g.style.height,s.splice(p[0][0]+c,0,p[c][1]),g.innerHTML=calcNoteValueToDisplay(p[c][1],1,this._cellScale),this.__addCellEventHandlers(g,n,p[c][1])}this.Rulers[t][0]=s}else console.log("empty history encountered... skipping undo")}else if("rest"===f[0]){o=last(e);var k=i.cells[o];this.__toggleRestState(k,!1),e.pop()}e.pop(),this._calculateZebraStripes(t)}}},this._tap=function(){this._tapMode=!0;this._tapButton.innerHTML='&nbsp;&nbsp;<img src="header-icons/tap-active-button.svg" title="'+_("tap a rhythm")+'" alt="'+_("tap a rhythm")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;'},this._clear=function(){this._logo.synth.stop(),this._logo.resetSynth(0),this._playing=!1,this._playingAll=!1,this._playingOne=!1,this._rulerPlaying=-1,this._startingTime=null;for(this._playAllCell.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play all")+'" alt="'+_("Play all")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',r=0;r<this.Rulers.length;r++)for(this._rulerSelected=r;0<this.Rulers[r][1].length;)this._undo()},this.__pause=function(){this._playAllCell.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play all")+'" alt="'+_("Play all")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',this._playing=!1,this._playingAll=!1,this._playingOne=!1,this._rulerPlaying=-1,this._startingTime=null;for(var t=0;t<this.Rulers.length;t++)this._calculateZebraStripes(t)},this.playAll=function(){if(this._playing){if(this._playingAll){this.__pause(),this._playingAll=!0;var t=this;setTimeout(function(){t.__resume()},1e3)}}else this._playingAll||this.__resume()},this.__resume=function(){this._playAllCell.innerHTML='&nbsp;&nbsp;<img src="header-icons/pause-button.svg" title="'+_("Pause")+'" alt="'+_("Pause")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',this._logo.setTurtleDelay(0),this._playingAll=!0,this._playing=!0,this._playingOne=!1,this._cellCounter=0,this._rulerPlaying=-1;for(var t=0;t<this.Rulers.length;t++)this._elapsedTimes[t]=0,this._offsets[t]=0;this._playAll()},this._playAll=function(){if(this._logo.synth.stop(),this._logo.resetSynth(0),null==this._startingTime){var t=new Date;this._startingTime=t.getTime();for(var e=0;e<this.Rulers.length;e++)this._offsets[e]=0,this._elapsedTimes[e]=0}for(e=0;e<this.Rulers.length;e++)this.__loop(0,e,0)},this._playOne=function(){if(this._logo.synth.stop(),this._logo.resetSynth(0),null==this._startingTime){var t=new Date;this._startingTime=t.getTime(),this._elapsedTimes[this._rulerSelected]=0,this._offsets[this._rulerSelected]=0}console.log("this._rulerSelected "+this._rulerSelected),this.__loop(0,this._rulerSelected,0)},this.__loop=function(t,e,i){if("hidden"!==docById("rulerDiv").style.visibility&&"hidden"!==docById("rulerButtonsDiv").style.visibility&&"hidden"!==docById("rulerTableDiv").style.visibility){var s=docById("ruler"+e);if(null!=s){0===i&&this._calculateZebraStripes(e);var l=s.cells[i],o=this.Rulers[e][0],a=o[i];if(t=Math.abs(1/a),null===this.Drums[e])var n="snare drum";else{var r=this._logo.blocks.blockList[this.Drums[e]].connections[1];n=this._logo.blocks.blockList[r].value}for(var c=!1,h=0;h<DRUMNAMES.length;h++){if(DRUMNAMES[h][0].replace("-"," ")===n){n=DRUMNAMES[h][1],c=!0;break}if(DRUMNAMES[h][1]===n){c=!0;break}}var u=!1;if(!c)for(h=0;h<VOICENAMES.length;h++){if(VOICENAMES[h][0]===n){n=VOICENAMES[h][1],u=!0;break}if(VOICENAMES[h][1]===n){u=!0;break}}var d=this;if(d._playing){0<a&&(u?d._logo.synth.trigger(0,"C4",d._logo.defaultBPMFactor/a,n,null,null,!1):c&&d._logo.synth.trigger(0,["C4"],d._logo.defaultBPMFactor/a,n,null,null)),l.style.backgroundColor=platformColor.rulerHighlight;h=new Date;d._offsets[e]=h.getTime()-d._startingTime-d._elapsedTimes[e]}setTimeout(function(){(i+=1)===o.length&&(i=0),d._playing&&d.__loop(t,e,i)},1e3*this._logo.defaultBPMFactor*t-this._offsets[e]),this._elapsedTimes[e]+=1e3*this._logo.defaultBPMFactor*t}else console.log("Cannot find ruler "+e+". Widget closed?")}},this._save=function(u){var d=this;for(var t in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[t].hideMenu(!0);this._logo.refreshCanvas(),setTimeout(function(){var t=docById("ruler"+u),e=d.Rulers[u][0];if(null===d.Drums[u])var i=_("snare drum")+" "+_("rhythm");else i=d._logo.blocks.blockList[d._logo.blocks.blockList[d.Drums[u]].connections[1]].value.split(" ")[0]+" "+_("rhythm");for(var s=42*u,l=[[0,["action",{collapsed:!0}],100+s,100+s,[null,1,2,null]],[1,["text",{value:i}],0,0,[0]]],o=0,a=1,n=0;n<t.cells.length;n++)if(e[n]===e[n+1]&&n<t.cells.length-1)a+=1;else{var r=l.length,c=e[n],h=rationalToFraction(1/Math.abs(c));l.push([r,"rhythm2",0,0,[o,r+1,r+2,r+5]]),l.push([r+1,["number",{value:a}],0,0,[r]]),l.push([r+2,"divide",0,0,[r,r+3,r+4]]),l.push([r+3,["number",{value:h[0]}],0,0,[r+2]]),l.push([r+4,["number",{value:h[1]}],0,0,[r+2]]),l.push([r+5,"vspace",0,0,[r,r+6]]),n==t.cells.length-1?l.push([r+6,"hidden",0,0,[r+5,null]]):l.push([r+6,"hidden",0,0,[r+5,r+7]]),o=r+6,a=1}d._logo.blocks.loadNewBlocks(l),u>d.Rulers.length-2||d._save(u+1)},500)},this._saveTuplets=function(d){var f=this;for(var t in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[t].hideMenu(!0);this._logo.refreshCanvas(),setTimeout(function(){var t=docById("ruler"+d),e=f.Rulers[d][0];if(null===f.Drums[d])var i=_("snare drum")+" "+_("rhythm");else i=f._logo.blocks.blockList[f._logo.blocks.blockList[f.Drums[d]].connections[1]].value.split(" ")[0]+" "+_("rhythm");for(var s=42*d,l=[[0,["action",{collapsed:!0}],100+s,100+s,[null,1,2,null]],[1,["text",{value:i}],0,0,[0]]],o=0,a=1,n=0;n<t.cells.length;n++)if(e[n]===e[n+1]&&n<t.cells.length-1)a+=1;else{var r=l.length,c=e[n],h=rationalToFraction(1/Math.abs(c)),u=h[1]/a;Number.isInteger(u)?(l.push([r,"stuplet",0,0,[o,r+1,r+2,r+5]]),l.push([r+1,["number",{value:a}],0,0,[r]]),l.push([r+2,"divide",0,0,[r,r+3,r+4]]),l.push([r+3,["number",{value:h[0]}],0,0,[r+2]]),l.push([r+4,["number",{value:u}],0,0,[r+2]])):(l.push([r,"rhythm2",0,0,[o,r+1,r+2,r+5]]),l.push([r+1,["number",{value:a}],0,0,[r]]),l.push([r+2,"divide",0,0,[r,r+3,r+4]]),l.push([r+3,["number",{value:h[0]}],0,0,[r+2]]),l.push([r+4,["number",{value:h[1]}],0,0,[r+2]])),l.push([r+5,"vspace",0,0,[r,r+6]]),n==t.cells.length-1?l.push([r+6,"hidden",0,0,[r+5,null]]):l.push([r+6,"hidden",0,0,[r+5,r+7]]),o=r+6,a=1}f._logo.blocks.loadNewBlocks(l),d>f.Rulers.length-2||f._saveTuplets(d+1)},500)},this._saveMachine=function(t){if(null===this.Drums[t])var e="snare drum";else{var i=this._logo.blocks.blockList[this.Drums[t]].connections[1];e=this._logo.blocks.blockList[i].value}for(var s=0;s<DRUMNAMES.length;s++)if(DRUMNAMES[s][1]===e)return void(-1===EFFECTSNAMES.indexOf(e)?this._saveDrumMachine(t,e,!1):this._saveDrumMachine(t,e,!0));for(s=0;s<VOICENAMES.length;s++)if(VOICENAMES[s][1]===e)return void this._saveVoiceMachine(t,e)},this._saveDrumMachine=function(u,d,f){var p=this;for(var t in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[t].hideMenu(!0);this._logo.refreshCanvas(),setTimeout(function(){var t=docById("ruler"+u),e=p.Rulers[u][0],i=42*u;if(null===p.Drums[u])var s=_("snare drum")+" "+_("action");else s=p._logo.blocks.blockList[p._logo.blocks.blockList[p.Drums[u]].connections[1]].value.split(" ")[0]+" "+_("action");for(var l=[[0,["action",{collapsed:!0}],100+i,100+i,[null,1,2,null]],[1,["text",{value:s}],0,0,[0]]],o=0,a=1,n=0;n<t.cells.length;n++)if(e[n]===e[n+1]&&n<t.cells.length-1)a+=1;else{var r=l.length,c=e[n],h=rationalToFraction(1/Math.abs(c));1===a?(l.push([r,"newnote",0,0,[o,r+1,r+4,r+7]]),l.push([r+1,"divide",0,0,[r,r+2,r+3]]),l.push([r+2,["number",{value:h[0]}],0,0,[r+1]]),c<0?(l.push([r+3,["number",{value:h[1]}],0,0,[r+1]]),l.push([r+4,"vspace",0,0,[r,r+5]]),l.push([r+5,"rest2",0,0,[r+4,r+6]]),l.push([r+6,"hidden",0,0,[r+5,null]])):(l.push([r+3,["number",{value:h[1]}],0,0,[r+1]]),l.push([r+4,"vspace",0,0,[r,r+5]]),l.push([r+5,"playdrum",0,0,[r+4,r+6,null]]),f?l.push([r+6,["effectsname",{value:d}],0,0,[r+5]]):l.push([r+6,["drumname",{value:d}],0,0,[r+5]])),n==t.cells.length-1?l.push([r+7,"hidden",0,0,[r,null]]):(l.push([r+7,"hidden",0,0,[r,r+8]]),o=r+7)):(n==t.cells.length-1?l.push([r,"repeat",0,0,[o,r+1,r+2,null]]):(l.push([r,"repeat",0,0,[o,r+1,r+2,r+10]]),o=r),l.push([r+1,["number",{value:a}],0,0,[r]]),l.push([r+2,"newnote",0,0,[r,r+3,r+6,r+9]]),l.push([r+3,"divide",0,0,[r+2,r+4,r+5]]),l.push([r+4,["number",{value:1}],0,0,[r+3]]),c<0?(l.push([r+5,["number",{value:-c}],0,0,[r+3]]),l.push([r+6,"vspace",0,0,[r+2,r+7]]),l.push([r+7,"rest2",0,0,[r+6,r+8]]),l.push([r+8,"hidden",0,0,[r+7,null]])):(l.push([r+5,["number",{value:c}],0,0,[r+3]]),l.push([r+6,"vspace",0,0,[r+2,r+7]]),l.push([r+7,"playdrum",0,0,[r+6,r+8,null]]),f?l.push([r+8,["effectsname",{value:d}],0,0,[r+7]]):l.push([r+8,["drumname",{value:d}],0,0,[r+7]])),l.push([r+9,"hidden",0,0,[r+2,null]])),a=1}p._logo.blocks.loadNewBlocks(l),u>p.Rulers.length-2||p._saveMachine(u+1)},500)},this._saveVoiceMachine=function(u,d){var f=this;for(var t in this._logo.blocks.palettes.dict)this._logo.blocks.palettes.dict[t].hideMenu(!0);this._logo.refreshCanvas(),setTimeout(function(){var t=docById("ruler"+u),e=f.Rulers[u][0],i=42*u;if(null===f.Drums[u])var s=_("guitar")+" "+_("action");else s=f._logo.blocks.blockList[f._logo.blocks.blockList[f.Drums[u]].connections[1]].value.split(" ")[0]+"_"+_("action");var l=[[0,["action",{collapsed:!0}],100+i,100+i,[null,1,2,null]],[1,["text",{value:s}],0,0,[0]]];l.push([2,"settimbre",0,0,[0,3,5,4]]),l.push([3,["voicename",{value:d}],0,0,[2]]),l.push([4,"hidden",0,0,[2,null]]);for(var o=2,a=1,n=0;n<t.cells.length;n++)if(e[n]===e[n+1]&&n<t.cells.length-1)a+=1;else{var r=l.length,c=e[n],h=rationalToFraction(1/Math.abs(c));1===a?c<0?(l.push([r,"newnote",0,0,[o,r+1,r+4,r+7]]),l.push([r+1,"divide",0,0,[r,r+2,r+3]]),l.push([r+2,["number",{value:h[0]}],0,0,[r+1]]),l.push([r+3,["number",{value:h[1]}],0,0,[r+1]]),l.push([r+4,"vspace",0,0,[r,r+5]]),l.push([r+5,"rest2",0,0,[r+4,r+6]]),l.push([r+6,"hidden",0,0,[r+5,null]]),n==t.cells.length-1?l.push([r+7,"hidden",0,0,[r,null]]):(l.push([r+7,"hidden",0,0,[r,r+8]]),o=r+7)):(l.push([r,"newnote",0,0,[o,r+1,r+4,r+8]]),l.push([r+1,"divide",0,0,[r,r+2,r+3]]),l.push([r+2,["number",{value:h[0]}],0,0,[r+1]]),l.push([r+3,["number",{value:h[1]}],0,0,[r+1]]),l.push([r+4,"vspace",0,0,[r,r+5]]),l.push([r+5,"pitch",0,0,[r+4,r+6,r+7,null]]),l.push([r+6,["notename",{value:"C"}],0,0,[r+5]]),l.push([r+7,["number",{value:4}],0,0,[r+5]]),n==t.cells.length-1?l.push([r+8,"hidden",0,0,[r,null]]):(l.push([r+8,"hidden",0,0,[r,r+9]]),o=r+8)):(n==t.cells.length-1?l.push([r,"repeat",0,0,[o,r+1,r+2,null]]):(l.push([r,"repeat",0,0,[o,r+1,r+2,r+11]]),o=r),l.push([r+1,["number",{value:a}],0,0,[r]]),c<0?(l.push([r+2,"newnote",0,0,[r,r+3,r+6,r+9]]),l.push([r+3,"divide",0,0,[r+2,r+4,r+5]]),l.push([r+4,["number",{value:1}],0,0,[r+3]]),l.push([r+5,["number",{value:-c}],0,0,[r+3]]),l.push([r+6,"vspace",0,0,[r+2,r+7]]),l.push([r+7,"rest2",0,0,[r+6,r+8]]),l.push([r+8,"hidden",0,0,[r+7,null]]),l.push([r+9,"hidden",0,0,[r+2,null]])):(l.push([r+2,"newnote",0,0,[r,r+3,r+6,r+10]]),l.push([r+3,"divide",0,0,[r+2,r+4,r+5]]),l.push([r+4,["number",{value:1}],0,0,[r+3]]),l.push([r+5,["number",{value:c}],0,0,[r+3]]),l.push([r+6,"vspace",0,0,[r+2,r+7]]),l.push([r+7,"pitch",0,0,[r+6,r+8,r+9,null]]),l.push([r+8,["notename",{value:"C"}],0,0,[r+7]]),l.push([r+9,["number",{value:4}],0,0,[r+7]]),l.push([r+10,"hidden",0,0,[r+2,null]]))),a=1}f._logo.blocks.loadNewBlocks(l),u>f.Rulers.length-2||f._saveMachine(u+1)},500)},this._get_save_lock=function(){return this._save_lock},this.init=function(t){console.log("init RhythmRuler"),this._logo=t,this._bpmFactor=1e3*TONEBPM/this._logo._masterBPM,this._playing=!1,this._playingOne=!1,this._playingAll=!1,this._rulerPlaying=-1,this._startingTime=null,this._expanded=!1,0===this.Drums.length&&(this.Drums.push(null),this.Rulers.push([[1],[]])),this._elapsedTimes=[],this._offsets=[];for(var e=0;e<this.Rulers.length;e++)this._elapsedTimes.push(0),this._offsets.push(0);var i=window.innerWidth;this._cellScale=1;var s=docById("myCanvas"),a=docById("rulerDiv");a.style.visibility="visible",a.setAttribute("draggable","true"),this._left=200,this._top=150,a.style.left=this._left+"px",a.style.top=this._top+"px";var n=docById("rulerButtonsDiv");n.style.display="inline",n.style.visibility="visible",n.style.width=535,n.innerHTML='<table id="widgetButtonTable"></table>';var l=docById("widgetButtonTable").createTHead().insertRow(0),r=this;(o=this._addButton(l,"close-button.svg",32,_("Close"),"")).onclick=function(){for(var t=[],e=[],i=0;i<r.Rulers.length;i++)if(null!==r.Drums[i]){for(var s=[],l=0;l<r.Rulers[i][1].length;l++)s.push(r.Rulers[i][1][l]);docById("dissectNumber").classList.add("hasKeyboard"),t.push([s,r.Drums[i]]),e.push(r.Drums[i])}for(i=0;i<r._dissectHistory.length;i++){var o=r._dissectHistory[i][1];if(-1===e.indexOf(o)){s=JSON.parse(JSON.stringify(r._dissectHistory[i][0]));t.push([s,o])}}r._dissectHistory=JSON.parse(JSON.stringify(t)),u.style.visibility="hidden",n.style.visibility="hidden",a.style.visibility="hidden",r._playing=!1,r._playingOne=!1,r._playingAll=!1,r._logo.hideMsgs()},this._playAllCell=this._addButton(l,"play-button.svg",32,_("Play all"),""),this._playAllCell.onclick=function(){r._playing?r.__pause():r._playingAll||r.__resume()};var o=this._addButton(l,"export-chunk.svg",32,_("Save rhythms"),"");this._save_lock=!1,o.onclick=function(){r._get_save_lock()||(r._save_lock=!0,r._saveTuplets(0),setTimeout(function(){r._save_lock=!1},1e3))},(o=this._addButton(l,"export-drums.svg",32,_("Save drum machine"),"")).onclick=function(){r._get_save_lock()||(r._save_lock=!0,r._saveMachine(0),setTimeout(function(){r._save_lock=!1},1e3))},(o=l.insertCell()).innerHTML='<input id="dissectNumber" style="-webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="dissectNumber" type="dissectNumber" value="2" />',o.style.width="51px",o.style.minWidth=o.style.width,o.style.maxWidth=o.style.width,o.style.height=Math.floor(MATRIXBUTTONHEIGHT)+"px",o.style.backgroundColor=platformColor.selectorBackground;var c=docById("dissectNumber");c.onfocus=function(t){},c.onkeydown=function(t){46===t.keyCode&&(c.value=c.value.substring(0,c.value.length-1))},c.oninput=function(t){c.onmouseout=function(){c.value<2&&(c.value=2)},128<c.value&&(c.value=128)},(o=this._addButton(l,"restore-button.svg",32,_("Undo"),"")).onclick=function(){r._undo()},this._tapButton=this._addButton(l,"tap-button.svg",32,_("Tap a rhythm"),""),this._tapButton.onclick=function(){r._tap()},(o=this._addButton(l,"erase-button.svg",32,_("Clear"),"")).onclick=function(){r._clear()};var h=this._addButton(l,"grab.svg",32,_("Drag"),"");h.style.cursor="move",this._dx=h.getBoundingClientRect().left-a.getBoundingClientRect().left,this._dy=h.getBoundingClientRect().top-a.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=h.innerHTML,h.onmouseover=function(t){h.innerHTML=""},h.onmouseout=function(t){r._dragging||(h.innerHTML=r._dragCellHTML)},s.ondragover=function(t){r._dragging=!0,t.preventDefault()},s.ondrop=function(t){r._dragging&&(r._dragging=!1,r._left=t.clientX-r._dx,r._top=t.clientY-r._dy,a.style.left=r._left+"px",a.style.top=r._top+"px",h.innerHTML=r._dragCellHTML)},a.ondragover=function(t){r._dragging=!0,t.preventDefault()},a.ondrop=function(t){r._dragging&&(r._dragging=!1,r._left=t.clientX-r._dx,r._top=t.clientY-r._dy,a.style.left=r._left+"px",a.style.top=r._top+"px",h.innerHTML=r._dragCellHTML)},a.onmousedown=function(t){r._target=t.target},a.ondragstart=function(t){h.contains(r._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()},this._addButton(l,"expand-button.svg",32,_("expand"),"").onclick=function(){var t=docById("rulerDiv");if(r._expanded){t.style.width=r._initial_w,t.style.height=r._initial_h;var e=Math.min(Math.floor(.5*window.innerHeight/100),2);docById("rulerOuterDiv").style.height=130*e+"px",this.innerHTML='&nbsp;&nbsp;<img src="header-icons/expand-button.svg" title="'+_("expand")+'" alt="'+_("expand")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;',r._expanded=!1}else{t.style.width=Math.max(675,Math.min(1200,window.innerWidth))+"px",t.style.height=Math.max(100+130*r.Rulers.length,Math.min(900,window.innerHeight))+"px",docById("rulerOuterDiv").style.height=Math.max(100+130*r.Rulers.length,Math.min(880,window.innerHeight-20))+"px",this.innerHTML='&nbsp;&nbsp;<img src="header-icons/collapse-button.svg" title="'+_("collapse")+'" alt="'+_("collapse")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;',r._expanded=!0}};var u=docById("rulerTableDiv");u.style.display="inline",u.style.visibility="visible",u.style.border="2px",u.innerHTML="",u.innerHTML='<div id="rulerOuterDiv"><div id="rulerInnerDiv"><table id="rhythmRulerTable"></table></div></div>';var d=Math.max(Math.floor(.5*window.innerHeight/100),2),f=docById("rulerOuterDiv");if(this.Rulers.length>d){f.style.height=130*d+"px";i=Math.max(Math.min(window.innerWidth,675),535);f.style.width=i+25+"px"}else{f.style.height=130*this.Rulers.length+"px";i=Math.max(Math.min(window.innerWidth,655),535);f.style.width=i+25+"px"}i=Math.max(Math.min(window.innerWidth,600),484);docById("rulerInnerDiv").style.width=i+"px";var p=docById("rhythmRulerTable");for(e=0;e<this.Rulers.length;e++){var b=p.insertRow(),m=this._addButton(b,"play-button.svg",32,_("Play"),"<br>");m.setAttribute("id",e),m.className="headcol",m.onclick=function(){var t=Number(this.getAttribute("id"));r._playing?r._rulerPlaying===t&&(this.innerHTML='<br>&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',r._playing=!1,r._playingOne=!1,r._playingAll=!1,r._rulerPlaying=-1,r._startingTime=null,r._elapsedTimes[t]=0,r._offsets[t]=0,setTimeout(r._calculateZebraStripes(t),1e3)):!1===r._playingOne&&(r._rulerSelected=t,r._logo.setTurtleDelay(0),r._playing=!0,r._playingOne=!0,r._playingAll=!1,r._cellCounter=0,r._startingTime=null,r._rulerPlaying=t,this.innerHTML='<br>&nbsp;&nbsp;<img src="header-icons/pause-button.svg" title="'+_("Pause")+'" alt="'+_("Pause")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',r._elapsedTimes[t]=0,r._offsets[t]=0,r._playOne())},b.insertCell().innerHTML='<table id="rulerCellTable'+e+'"></table>';var g=docById("rulerCellTable"+e);g.style.textAlign="center",g.style.border="0px",g.style.borderCollapse="collapse",g.cellSpacing="0px",g.cellPadding="0px";var k=g.insertRow();k.setAttribute("id","ruler"+e);for(var v=0;v<this.Rulers[e][0].length;v++){var y=this.Rulers[e][0][v],T=k.insertCell(-1);T.innerHTML=calcNoteValueToDisplay(y,1,this._cellScale),T.style.height="70px",T.style.minHeight=T.style.height,T.style.maxHeight=T.style.height,T.style.width=this._noteWidth(y)+"px",T.style.minWidth=T.style.width,T.style.maxWidth=T.style.width,T.style.border="0px",T.border="0px",T.padding="0px",T.style.padding="0px",T.style.lineHeight="60 % ",T.style.backgroundColor=e%2==0?v%2==0?platformColor.selectorBackground:platformColor.selectorSelected:v%2==0?platformColor.selectorSelected:platformColor.selectorBackground,this.__addCellEventHandlers(T,this._noteWidth(y),y)}b.cells[0].style.width="51px",b.cells[0].style.minWidth="51px",b.cells[0].style.maxWidth="51px",b.cells[0].style.height=k.offsetHeight+"px",b.cells[0].style.minHeight=k.offsetHeight+"px",b.cells[0].style.maxHeight=k.offsetHeight+"px",b.cells[0].style.verticalAlign="middle"}for(var L=0;L<this.Drums.length;L++)if(null!==this.Drums[e])for(e=0;e<this._dissectHistory.length;e++)if(this._dissectHistory[e][1]===this.Drums[L])for(b=docById("ruler"+L),v=0;v<this._dissectHistory[e][0].length;v++)if(null!=this._dissectHistory[e][0][v])if(this._rulerSelected=L,"number"==typeof this._dissectHistory[e][0][v]){o=b.cells[this._dissectHistory[e][0][v]];this.__toggleRestState(o,!1)}else if("number"==typeof this._dissectHistory[e][0][v][0]){if("number"==typeof this._dissectHistory[e][0][v][1])null!=(o=b.cells[this._dissectHistory[e][0][v][0]])?this.__dissectByNumber(o,this._dissectHistory[e][0][v][1],!1):console.log("Could not find cell to divide. Did the order of the rhythm blocks change?");else null!=(o=b.cells[this._dissectHistory[e][0][v][0]])&&this.__divideFromList(o,this._dissectHistory[e][0][v][1],!1)}else{var w=this._dissectHistory[e][0][v];this._mouseDownCell=b.cells[w[0][0]],this._mouseUpCell=b.cells[last(w)[0]],null!=this._mouseUpCell&&this.__tie(!1),this._mouseDownCell=null,this._mouseUpCell=null}this._logo.textMsg(_("Click on the ruler to divide it.")),this._initial_w=a.style.width,this._initial_h=a.style.height},this._addButton=function(t,e,i,s,l){var o=t.insertCell(-1);return o.innerHTML=l+'&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',o.style.width="51px",o.style.minWidth=o.style.width,o.style.maxWidth=o.style.width,o.style.height=o.style.width,o.style.minHeight=o.style.height,o.style.maxHeight=o.style.height,o.style.backgroundColor=platformColor.selectorBackground,o.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},o.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},o},this._piemenuRuler=function(t){},this._piemenuNumber=function(t,e){docById("wheelDiv").style.display="",this._numberWheel=new wheelnav("wheelDiv",null,600,600),this._exitWheel=new wheelnav("_exitWheel",this._numberWheel.raphael);for(var i=[],s=0;s<t.length;s++)i.push(t[s].toString());i.push(null),wheelnav.cssMode=!0,this._numberWheel.keynavigateEnabled=!0,this._numberWheel.colors=["#ffb2bc","#ffccd6"],this._numberWheel.slicePathFunction=slicePath().DonutSlice,this._numberWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._numberWheel.slicePathCustom.minRadiusPercent=.2,16<t.length?this._numberWheel.slicePathCustom.maxRadiusPercent=1:this._numberWheel.slicePathCustom.maxRadiusPercent=.6,this._numberWheel.sliceSelectedPathCustom=this._numberWheel.slicePathCustom,this._numberWheel.sliceInitPathCustom=this._numberWheel.slicePathCustom,this._numberWheel.animatetime=300,this._numberWheel.createWheel(i),this._exitWheel.colors=["#808080","#c0c0c0"],this._exitWheel.slicePathFunction=slicePath().DonutSlice,this._exitWheel.slicePathCustom=slicePath().DonutSliceCustomization(),this._exitWheel.slicePathCustom.minRadiusPercent=0,this._exitWheel.slicePathCustom.maxRadiusPercent=.2,this._exitWheel.sliceSelectedPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.sliceInitPathCustom=this._exitWheel.slicePathCustom,this._exitWheel.clickModeRotate=!1,this._exitWheel.createWheel(["x"," "]);function l(){var t=new Date;o._piemenuExitTime=t.getTime(),docById("wheelDiv").style.display="none",o._numberWheel.removeWheel(),o._exitWheel.removeWheel()}var o=this;docById("dissectNumber");this._positionWheel(),-1===(s=t.indexOf(e))&&(s=0),this._numberWheel.navigateWheel(s);for(s=0;s<i.length;s++)this._numberWheel.navItems[s].navigateFunction=function(){docById("dissectNumber").value=t[o._numberWheel.selectedNavItemIndex],l()};this._exitWheel.navItems[0].navigateFunction=function(){l()}},this._positionWheel=function(){if("none"!=docById("wheelDiv").style.display){docById("wheelDiv").style.position="absolute",docById("wheelDiv").style.height="300px",docById("wheelDiv").style.width="300px";var t=this._left+100,e=this._top;docById("wheelDiv").style.left=Math.min(Math.max(t-75,0),this._logo.blocks.turtles._canvas.width-300)+"px",docById("wheelDiv").style.top=e-300<0?e+60+"px":e-300+"px"}}}function StatusMatrix(){var k,v;docById("statusDiv").style.visibility="hidden",this.init=function(t){this._logo=t;var e=window.innerWidth;this._cellScale=e/1200;var i=this._cellScale,s=docById("myCanvas"),l=docById("statusDiv");l.style.visibility="visible",l.setAttribute("draggable","true");var o=docById("statusButtonsDiv");o.style.display="inline",o.style.visibility="visible",o.style.width=128,o.innerHTML='<table cellpadding="0px" id="statusButtonTable"></table>';var a=(f=docById("statusButtonTable").createTHead()).insertRow(0),n=this;(g=this._addButton(a,"close-button.svg",32,_("Close"))).onclick=function(){c.style.visibility="hidden",o.style.visibility="hidden",l.style.visibility="hidden"};var r=this._addButton(a,"grab.svg",32,_("Drag"));r.style.cursor="move",this._dx=r.getBoundingClientRect().left-l.getBoundingClientRect().left,this._dy=r.getBoundingClientRect().top-l.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=r.innerHTML,r.onmouseover=function(t){r.innerHTML=""},r.onmouseout=function(t){n._dragging||(r.innerHTML=n._dragCellHTML)},s.ondragover=function(t){n._dragging=!0,t.preventDefault()},s.ondrop=function(t){n._dragging&&(n._dragging=!1,k=t.clientX-n._dx,l.style.left=k+"px",v=t.clientY-n._dy,l.style.top=v+"px",r.innerHTML=n._dragCellHTML)},l.ondragover=function(t){n._dragging=!0,t.preventDefault()},l.ondrop=function(t){n._dragging&&(n._dragging=!1,k=t.clientX-n._dx,l.style.left=k+"px",v=t.clientY-n._dy,l.style.top=v+"px",r.innerHTML=n._dragCellHTML)},l.onmousedown=function(t){n._target=t.target},l.ondragstart=function(t){r.contains(n._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};var c=docById("statusTableDiv");c.style.display="inline",c.style.visibility="visible",c.style.border="0px",c.innerHTML='<div id="statusOuterDiv"><div id="statusInnerDiv"><table cellpadding="0px" id="statusTable"></table></div></div>';var h=Math.max(Math.floor(.5*window.innerHeight/100),8),u=docById("statusOuterDiv");if(this._logo.turtles.turtleList.length>h){u.style.height=this._cellScale*MATRIXSOLFEHEIGHT*(h+2)+"px";e=Math.max(Math.min(window.innerWidth,620*this._cellScale),128);u.style.width=e+"px"}else{4<this._logo.statusFields.length?u.style.height=this._cellScale*(MATRIXBUTTONHEIGHT2+(2+MATRIXSOLFEHEIGHT)*this._logo.turtles.turtleList.length)+30+"px":u.style.height=this._cellScale*(MATRIXBUTTONHEIGHT2+(2+MATRIXSOLFEHEIGHT)*this._logo.turtles.turtleList.length)+"px";e=Math.max(Math.min(window.innerWidth,620*this._cellScale-20),128);u.style.width=e+"px"}e=Math.max(Math.min(window.innerWidth,540.5*this._cellScale),75);var d=docById("statusInnerDiv");d.style.width=e+"px",d.style.marginLeft=53*this._cellScale+"px";var f;a=(f=docById("statusTable").createTHead()).insertRow(),i=Math.floor(24*this._cellScale);(g=a.insertCell()).style.backgroundColor=platformColor.selectorBackground,g.className="headcol",g.style.height=Math.floor(MATRIXBUTTONHEIGHT*this._cellScale)+"px",g.style.width=53*this._cellScale+"px",g.innerHTML="&nbsp;";for(var p=0;p<this._logo.statusFields.length;p++){switch((g=a.insertCell(p+1)).style.fontSize=Math.floor(100*this._cellScale)+"%",console.log(this._logo.statusFields[p][1]),this._logo.statusFields[p][1]){case"plus":case"minus":case"neg":case"divide":case"power":case"multiply":case"sqrt":case"int":case"mod":var b="";break;case"namedbox":b=this._logo.blocks.blockList[this._logo.statusFields[p][0]].privateData;break;case"bpm":case"bpmfactor":if("ja"===localStorage.languagePreference)b=_("beats per minute2");else b=this._logo.blocks.blockList[this._logo.statusFields[p][0]].protoblock.staticLabels[0];console.log(b);break;default:b=this._logo.blocks.blockList[this._logo.statusFields[p][0]].protoblock.staticLabels[0]}g.innerHTML="&nbsp;<b>"+b+"</b>&nbsp;",g.style.height=Math.floor(MATRIXBUTTONHEIGHT*this._cellScale)+"px",g.style.backgroundColor=platformColor.selectorBackground}_THIS_IS_MUSIC_BLOCKS_&&((g=a.insertCell()).style.fontSize=Math.floor(100*this._cellScale)+"%",g.innerHTML="&nbsp;<b>"+_("note")+"</b>&nbsp;",g.style.height=Math.floor(MATRIXBUTTONHEIGHT*this._cellScale)+"px",g.style.backgroundColor=platformColor.selectorBackground);for(var m=0;m<this._logo.turtles.turtleList.length;m++)if(!this._logo.turtles.turtleList[m].trash){if((g=(a=f.insertRow()).insertCell()).style.backgroundColor=platformColor.labelColor,_THIS_IS_MUSIC_BLOCKS_?g.innerHTML='&nbsp;&nbsp;<img src="images/mouse.svg" title="'+this._logo.turtles.turtleList[m].name+'" alt="'+this._logo.turtles.turtleList[m].name+'" height="'+i+'" width="'+i+'">&nbsp;&nbsp;':g.innerHTML='&nbsp;&nbsp;<img src="header-icons/turtle-button.svg" title="'+this._logo.turtles.turtleList[m].name+'" alt="'+this._logo.turtles.turtleList[m].name+'" height="'+i+'" width="'+i+'">&nbsp;&nbsp;',g.style.width=53*this._cellScale+"px",g.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+"px",g.className="headcol",_THIS_IS_MUSIC_BLOCKS_)for(p=0;p<this._logo.statusFields.length+1;p++){(g=a.insertCell()).style.backgroundColor=platformColor.selectorBackground,g.style.fontSize=Math.floor(100*this._cellScale)+"%",g.innerHTML="",g.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+"px"}else for(p=0;p<this._logo.statusFields.length;p++){var g;(g=a.insertCell()).style.backgroundColor=platformColor.selectorBackground,g.style.fontSize=Math.floor(100*this._cellScale)+"%",g.innerHTML="",g.style.height=Math.floor(MATRIXSOLFEHEIGHT*this._cellScale)+"px"}1}},this.updateAll=function(){var t=docById("statusTable");statusDiv.style.top=v+"px",statusDiv.style.left=k+"px",this._logo.updatingStatusMatrix=!0;for(var e=0,i=0;i<this._logo.turtles.turtleList.length;i++)if(!this._logo.turtles.turtleList[i].trash){for(var s=0;s<this._logo.statusFields.length;s++){var l=this._logo.inStatusMatrix;switch(this._logo.inStatusMatrix=!1,this._logo.parseArg(this._logo,i,this._logo.statusFields[s][0]),this._logo.blocks.blockList[this._logo.statusFields[s][0]].name){case"x":case"y":case"heading":var o=this._logo.blocks.blockList[this._logo.statusFields[s][0]].value.toFixed(2);break;case"mynotevalue":o=mixedNumber(this._logo.blocks.blockList[this._logo.statusFields[s][0]].value);break;case"elapsednotes2":var a=this._logo.statusFields[s][0],n=this._logo.blocks.blockList[a].connections[1],r=this._logo.parseArg(this._logo,i,n,a,null);o=mixedNumber(this._logo.blocks.blockList[this._logo.statusFields[s][0]].value)+"  "+mixedNumber(r);break;case"elapsednotes":o=mixedNumber(this._logo.blocks.blockList[this._logo.statusFields[s][0]].value);break;case"namedbox":var c=this._logo.blocks.blockList[this._logo.statusFields[s][0]].privateData;if(c in this._logo.boxes)o=this._logo.boxes[c];else o="";break;case"beatvalue":o=mixedNumber(this._logo.currentBeat[i]);break;case"measurevalue":o=this._logo.currentMeasure[i];break;case"pitchinhertz":o="";if(null!=this._logo.noteStatus[i])for(var h=this._logo.noteStatus[i][0],u=0;u<h.length;u++){0<u&&(o+=" ");var d=this._logo.synth.getFrequency(h[u],this._logo.synth.changeInTemperament);"number"==typeof d&&(o+=d.toFixed(2))}break;default:o=this._logo.blocks.blockList[this._logo.statusFields[s][0]].value}var f=o;this._logo.inStatusMatrix=l,null!=(p=t.rows[e+1].cells[s+1])&&(p.innerHTML=f)}if(_THIS_IS_MUSIC_BLOCKS_){var p,b="";o="";if(null!=this._logo.noteStatus[i]){for(h=this._logo.noteStatus[i][0],u=0;u<h.length;u++)"number"==typeof h[u]?(b+=toFixed2(h[u]),b+="Hz "):(b+=h[u],b+=" ");var m=rationalToFraction(o=this._logo.noteStatus[i][1]);b+=m[1]+"/"+m[0]}null!=(p=t.rows[e+1].cells[s+1])&&(p.innerHTML=b.replace(/#/g,"").replace(/b/g,""))}e+=1}this._logo.updatingStatusMatrix=!1},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l}}function TemperamentWidget(){var d=docById("temperamentTableDiv"),b=null;this.inTemperament=null,this.lastTriggered=null,this.notes=[],this.frequencies=[],this.intervals=[],this.ratios=[],this.scale=[],this.cents=[],this.scaleNotes=[],this.pitchNumber=0,this.circleIsVisible=!0,this.playbackForward=!0,this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._circleOfNotes=function(){this.circleIsVisible=!1,this.toggleNotesButton(),d.style.display="inline",d.style.visibility="visible",d.style.border="0px",d.style.overflow="auto",d.style.backgroundColor="white",d.style.height="300px",d.innerHTML='<div id="temperamentTable"></div>';var t=docById("temperamentTable");t.style.position="relative";t.innerHTML='<canvas id="circ" width = 430px height = 360px></canvas><div id="wheelDiv2" class="wheelNav"></div><div id ="information"></div>',t.style.width=temperamentDiv.width;var e=docById("circ");e.style.position="absolute",e.style.zIndex=1,e.style.background="rgba(255, 255, 255, 0.85)";var i=e.getContext("2d"),s=e.width/2,l=e.height/2;i.beginPath(),i.arc(s,l,150,0,2*Math.PI,!1),i.fillStyle="rgba(204, 0, 102, 0)",i.fill(),i.lineWidth=1,i.strokeStyle="#003300",i.stroke();var h=[];docById("wheelDiv2").style.display="",docById("wheelDiv2").style.background="none",this.createMainWheel=function(t,e){void 0===t&&(t=this.ratios),void 0===e&&(e=this.pitchNumber);for(var i=[],s=0;s<e;s++){var l=s.toString();i.push(l)}this.notesCircle=new wheelnav("wheelDiv2",null,350,350),this.notesCircle.wheelRadius=230,this.notesCircle.navItemsEnabled=!1,this.notesCircle.navAngle=270,this.notesCircle.navItemsContinuous=!0,this.notesCircle.navItemsCentered=!1,this.notesCircle.slicePathFunction=slicePath().MenuSliceWithoutLine,this.notesCircle.slicePathCustom=slicePath().MenuSliceCustomization(),this.notesCircle.sliceSelectedPathCustom=this.notesCircle.slicePathCustom,this.notesCircle.sliceInitPathCustom=this.notesCircle.slicePathCustom,this.notesCircle.initWheel(i),h=[];for(var o=[],a=[],n=[],r=0;r<this.notesCircle.navItemCount;r++)this.notesCircle.navItems[r].fillAttr="#c8C8C8",this.notesCircle.navItems[r].titleAttr.font="20 20px Impact, Charcoal, sans-serif",this.notesCircle.navItems[r].titleSelectedAttr.font="20 20px Impact, Charcoal, sans-serif",h[r]=270+Math.log10(t[r])/Math.log10(this.powerBase)*360,0!==r&&(n[r-1]=r==e-1?h[0]+360-h[r]:h[r]-h[r-1]),0===r?(a[r]=360/e,o[r]=this.notesCircle.navAngle-a[0]/2):(o[r]=o[r-1]+a[r-1],a[r]=2*(h[r]-o[r])),this.notesCircle.navItems[r].sliceAngle=a[r];var c=2*Math.PI*150/e/3;for(r=0;r<n.length;r++)n[r]<11&&(c=2*Math.PI*150/e/6);29<c&&(c=2*Math.PI*150/33),this.notesCircle.slicePathCustom.menuRadius=c,this.notesCircle.createWheel(),docById("wheelDiv2").style.position="absolute",docById("wheelDiv2").style.height="360px",docById("wheelDiv2").style.width="430px",docById("wheelDiv2").style.zIndex=5},this.createMainWheel();var o=this;if(this.octaveChanged){var a=document.createElement("div");a.id="divAppend",a.innerHTML='<div id="clearNotes" style="float:left;">Clear</div><div id="standardOctave" style="float:right;">Back to 2:1 Octave Space</div>',a.style.textAlign="center",a.style.position="absolute",a.style.zIndex=2,a.style.height="33px",a.style.width=docById("wheelDiv2").style.width,a.style.marginTop="360px",a.style.background="rgba(255, 255, 255, 0.85)",a.style.overflow="auto",docById("temperamentTable").append(a),(r=docById("clearNotes")).style.height="30px",r.style.marginLeft="3px",r.style.backgroundColor=platformColor.selectorBackground,r.style.width="212px";var n=docById("standardOctave");n.style.height="30px",n.style.marginRight="3px",n.style.backgroundColor=platformColor.selectorBackground,n.style.width="207px"}else{var r;(r=document.createElement("div")).id="divAppend",r.innerHTML="Clear",r.style.textAlign="center",r.style.position="absolute",r.style.zIndex=2,r.style.paddingTop="5px",r.style.backgroundColor=platformColor.selectorBackground,r.style.height="25px",r.style.width=docById("wheelDiv2").style.width,r.style.marginTop=docById("wheelDiv2").style.height,r.style.overflow="auto",docById("temperamentTable").append(r)}void 0!==r&&(r.onclick=function(){var t=o.ratios[0];o.ratios=[],o.ratios[0]=t,o.ratios[1]=o.powerBase;var e=o.frequencies[0];o.frequencies=[],o.frequencies[0]=e,o.frequencies[1]=e*o.powerBase,o.pitchNumber=1,o.checkTemperament(o.ratios),o._circleOfNotes()}),void 0!==n&&(n.onclick=function(){var t=[],e=[],i=o.frequencies[0];o.frequencies=[];for(var s=0;s<o.ratios.length;s++)t[s]=Math.log10(o.ratios[s])/Math.log10(o.powerBase)*12,o.ratios[s]=Math.pow(2,t[s]/12),e[s]=o.ratios[s].toFixed(2),o.frequencies[s]=o.ratios[s]*i,o.frequencies[s]=o.frequencies[s].toFixed(2);o.powerBase=2,o.checkTemperament(e),o.octaveChanged=!1,o._circleOfNotes()}),docById("temperamentTable").addEventListener("click",function(t){o.showNoteInfo(t,h)})},this.showNoteInfo=function(t,e){for(var i=0;i<this.notesCircle.navItemCount;i++)if(t.target.id=="wheelnav-wheelDiv2-slice-"+i||t.target.innerHTML==i&&""!==t.target.innerHTML){var s=t.clientX-docById("wheelDiv2").getBoundingClientRect().left,l=t.clientY-docById("wheelDiv2").getBoundingClientRect().top,o=this.frequencies[i],a=this;null!==docById("noteInfo")&&docById("noteInfo").remove(),docById("information").innerHTML+='<div class="popup" id="noteInfo" style=" left: '+s+"px; top: "+l+'px;"><span class="popuptext" id="myPopup"></span></div>',0!==i&&(docById("noteInfo").innerHTML+='<img src="header-icons/edit.svg" id="edit" title="edit" alt="edit" height=20px width=20px data-message="'+i+'">'),docById("noteInfo").innerHTML+='<img src="header-icons/close-button.svg" id="close" title="close" alt="close" height=20px width=20px align="right"><br>';for(var n=!1,r=0;r<this.ratiosNotesPair.length;r++)if(this.ratios[i]==this.ratiosNotesPair[r][0]){n=!0,docById("noteInfo").innerHTML+='<div id="note">&nbsp; Note : '+this.ratiosNotesPair[r][1]+"</div>";break}if(0==n){var c=Math.log10(this.ratios[i])/Math.log10(2)*1200,h=[],u=[];for(r=0;r<this.cents.length;r++)h[r]=c-this.cents[r],u[r]=Math.abs(c-this.cents[r]);var d=u.reduce(function(t,e){return Math.min(t,e)}),f=u.indexOf(d);h[f]<0?docById("noteInfo").innerHTML+='<div id="note">&nbsp; Note : '+this.ratiosNotesPair[f][1]+"(- "+u[f].toFixed(2)+")</div>":docById("noteInfo").innerHTML+='<div id="note">&nbsp; Note : '+this.ratiosNotesPair[f][1]+"(+ "+u[f].toFixed(2)+")</div>"}docById("noteInfo").innerHTML+='<div id="frequency">&nbsp Frequency : '+o+"</div>",270<=e[i]&&e[i]<=360?(docById("noteInfo").style.top=l-100+"px",docById("noteInfo").style.left=s+"px"):360<e[i]&&e[i]<=450?(docById("noteInfo").style.top=l+"px",docById("noteInfo").style.left=s+"px"):450<e[i]&&e[i]<=540?(docById("noteInfo").style.top=l+"px",docById("noteInfo").style.left=s-180+"px"):540<e[i]&&e[i]<=630&&(docById("noteInfo").style.top=l-100+"px",docById("noteInfo").style.left=s-180+"px"),docById("noteInfo").style.position="absolute",docById("noteInfo").style.zIndex=10,docById("close").onclick=function(){docById("noteInfo").remove()},null!==docById("edit")&&docById("edit").addEventListener("click",function(t){a.editFrequency(t)})}},this.editFrequency=function(t){var i=Number(t.target.dataset.message),s=this;docById("noteInfo").style.width="180px",docById("noteInfo").style.height="130px",docById("note").innerHTML="",docById("frequency").innerHTML="",docById("noteInfo").innerHTML+='<center><input type="range" class="sliders" id = "frequencySlider1" style="width:170px; background:white; border:0;" min="'+this.frequencies[i-1]+'" max="'+this.frequencies[i+1]+'"></center>',docById("noteInfo").innerHTML+='<br>&nbsp;&nbsp;Frequency : <span class="rangeslidervalue" id="frequencydiv1">'+this.frequencies[i]+"</span>",docById("noteInfo").innerHTML+='<br><br><div id="done" style="background:rgb(196, 196, 196);"><center>Done</center><div>',docById("frequencySlider1").oninput=function(){docById("frequencydiv1").innerHTML=docById("frequencySlider1").value;var t=docById("frequencySlider1").value,e=t/s.frequencies[0];s.temporaryRatios=s.ratios.slice(),s.temporaryRatios[i]=e,s._logo.resetSynth(0),s._logo.synth.trigger(0,t,.01*s._logo.defaultBPMFactor,"electronic synth",null,null),s.createMainWheel(s.temporaryRatios)},docById("done").onclick=function(){s.ratios=s.temporaryRatios.slice(),s.typeOfEdit="nonequal",s.createMainWheel();var t=s.frequencies[0];s.frequencies=[];for(var e=0;e<s.ratios.length;e++)s.frequencies[e]=s.ratios[e]*t,s.frequencies[e]=s.frequencies[e].toFixed(2);s.checkTemperament(s.ratios),docById("noteInfo").remove()},docById("close").onclick=function(){s.temporaryRatios=s.ratios.slice(),s.createMainWheel(),docById("noteInfo").remove()}},this._graphOfNotes=function(){this.circleIsVisible=!0,this.toggleNotesButton(),d.innerHTML="",null!=docById("wheelDiv2")&&(docById("wheelDiv2").style.display="none",this.notesCircle.removeWheel()),d.innerHTML='<table id="notesGraph"></table>';var t=docById("notesGraph"),e=(t.createTHead().insertRow(0),[]);"custom"==this.inTemperament?e=["Play","Pitch Number","Ratio","Frequency"]:(e=["Play","Pitch Number","Ratio","Interval","Note","Frequency"]).splice(5,0,this.scale),t.innerHTML='<thead id="tablehead"><tr id="menu"></tr></thead><tbody id="tablebody"></tbody>';for(var i="",s=0;s<e.length;s++)i+='<th id="menuLabels">'+e[s]+"</th>";docById("menu").innerHTML=i;var l=document.querySelectorAll("#menuLabels");for(s=0;s<e.length;s++)l[s].style.background=platformColor.labelColor,l[s].style.height="30px",l[s].style.textAlign="center",l[s].style.fontWeight="bold","custom"==this.inTemperament?(l[0].style.width="40px",l[1].style.width="120px",l[2].style.width="120px",l[3].style.width="140px"):(l[0].style.width="40px",l[1].style.width="40px",l[2].style.width="60px",l[3].style.width="120px",l[4].style.width="50px",l[5].style.width="100px",l[6].style.width="95px");var o="";for(s=0;s<=this.pitchNumber;s++)o+='<tr id="notes_'+s+'"></tr>';docById("tablebody").innerHTML+='<tr><td colspan="7"><div id="graph"><table id="tableOfNotes"></table></div></td></tr>',docById("tableOfNotes").innerHTML=o;this._logo.synth.startingPitch;var a=this,n=[],r=[],c=[];for(s=0;s<=this.pitchNumber;s++){n[s]=docById("notes_"+s),r[0]=n[s].insertCell(-1),r[0].innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="play" alt="play" height="20px" width="20px" id="play_'+s+'" data-id="'+s+'">&nbsp;&nbsp;',r[0].style.width="40px",r[0].style.backgroundColor=platformColor.selectorBackground,r[0].style.textAlign="center",r[0].onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},r[0].onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground};var h=docById("play_"+s);if(h.onmouseover=function(t){this.style.cursor="pointer"},h.onclick=function(t){var e=t.target.dataset.id;a.playNote(e)},r[1]=n[s].insertCell(-1),r[1].id="pitchNumber_"+s,r[1].innerHTML=s,r[1].style.backgroundColor=platformColor.selectorBackground,r[1].style.textAlign="center",c[s]=this.ratios[s],c[s]=c[s].toFixed(2),r[2]=n[s].insertCell(-1),r[2].innerHTML=c[s],r[2].style.backgroundColor=platformColor.selectorBackground,r[2].style.textAlign="center","custom"!==this.inTemperament){r[3]=n[s].insertCell(-1),r[3].innerHTML=this.intervals[s],r[3].style.width="120px",r[3].style.backgroundColor=platformColor.selectorBackground,r[3].style.textAlign="center",r[4]=n[s].insertCell(-1),r[4].innerHTML=this.notes[s],r[4].style.width="50px",r[4].style.backgroundColor=platformColor.selectorBackground,r[4].style.textAlign="center",r[5]=n[s].insertCell(-1);for(var u=0;u<this.scaleNotes.length;u++)if(this.notes[s][0]==this.scaleNotes[u]){r[5].innerHTML=u;break}""===r[5].innerHTML&&(r[5].innerHTML="Non Scalar"),r[5].style.width="100px",r[5].style.backgroundColor=platformColor.selectorBackground,r[5].style.textAlign="center"}r[6]=n[s].insertCell(-1),r[6].innerHTML=this.frequencies[s],r[6].style.backgroundColor=platformColor.selectorBackground,r[6].style.textAlign="center","custom"==this.inTemperament?(r[1].style.width="130px",r[6].style.width="130px",r[2].style.width="130px"):(r[1].style.width="60px",r[6].style.width="80px",r[2].style.width="60px")}},this.edit=function(){this._logo.synth.setMasterVolume(0),this._logo.synth.stop();var e=this;null!=docById("wheelDiv2")&&(docById("wheelDiv2").style.display="none",this.notesCircle.removeWheel()),d.innerHTML="",d.innerHTML='<table id="editOctave" width="430"><tbody><tr id="menu"></tr></tbody></table>';for(var t=["Equal","Ratios","Arbitrary","Octave Space"],i="",s=0;s<t.length;s++)i+='<td id="editMenus">'+t[s]+"</td>";docById("menu").innerHTML=i,docById("editOctave").innerHTML+='<tr><td colspan="4" id="userEdit"></td></tr>';var l=document.querySelectorAll("#editMenus");for(s=0;s<t.length;s++)l[s].style.background=platformColor.selectorBackground,l[s].style.height="30px",l[s].style.textAlign="center",l[s].style.fontWeight="bold";l[0].style.background="#c8C8C8",e.equalEdit(),l[0].onclick=function(t){l[1].style.background=platformColor.selectorBackground,l[2].style.background=platformColor.selectorBackground,l[3].style.background=platformColor.selectorBackground,l[0].style.background="#c8C8C8",e.equalEdit()},l[1].onclick=function(t){l[0].style.background=platformColor.selectorBackground,l[2].style.background=platformColor.selectorBackground,l[3].style.background=platformColor.selectorBackground,l[1].style.background="#c8C8C8",e.ratioEdit()},l[2].onclick=function(t){l[0].style.background=platformColor.selectorBackground,l[1].style.background=platformColor.selectorBackground,l[3].style.background=platformColor.selectorBackground,l[2].style.background="#c8C8C8",e.arbitraryEdit()},l[3].onclick=function(t){l[0].style.background=platformColor.selectorBackground,l[1].style.background=platformColor.selectorBackground,l[2].style.background=platformColor.selectorBackground,l[3].style.background="#c8C8C8",e.octaveSpaceEdit()}},this.equalEdit=function(){docById("userEdit").innerHTML="";var l=docById("userEdit");l.style.backgroundColor="#c8C8C8",l.innerHTML='<br>Pitch Number &nbsp;&nbsp;&nbsp;&nbsp; <input type="text" id="octaveIn" value="0"></input> &nbsp;&nbsp; To &nbsp;&nbsp; <input type="text" id="octaveOut" value="0"></input><br><br>',l.innerHTML+='Number of Divisions &nbsp;&nbsp;&nbsp;&nbsp; <input type="text" id="divisions" value="'+this.pitchNumber+'"></input>',l.style.paddingLeft="80px";var r=this;function c(t){var e=document.createElement("div");e.id="divAppend",e.innerHTML=t?'<div id="preview" style="float:left;">Back</div><div id="done_" style="float:right;">Done</div>':'<div id="preview" style="float:left;">Preview</div><div id="done_" style="float:right;">Done</div>',e.style.textAlign="center",e.style.marginLeft="-80px",e.style.height="32px",e.style.marginTop="40px",e.style.overflow="auto",l.append(e);var i=docById("preview");i.style.height="30px",i.style.marginLeft="3px",i.style.backgroundColor=platformColor.selectorBackground,i.style.width="215px";var s=docById("done_");s.style.height="30px",s.style.marginRight="3px",s.style.backgroundColor=platformColor.selectorBackground,s.style.width="205px"}c(!1),divAppend.onmouseover=function(){this.style.cursor="pointer"};var h=this.pitchNumber,u=Number(docById("octaveIn").value),d=Number(docById("octaveOut").value),f=Number(docById("divisions").value),p=[],b=[],m=[],g=[],k=[],v=[];this.tempRatios=[],divAppend.addEventListener("click",function(t){r.performEqualEdit(t)}),this.performEqualEdit=function(t){if(u=Number(docById("octaveIn").value),d=Number(docById("octaveOut").value),f=Number(docById("divisions").value),this.tempRatios=this.ratios.slice(),u===d){for(var e=0;e<f;e++)p[e]=Math.pow(this.powerBase,e/f),m[e]=p[e].toFixed(2);for(e=0;e<this.tempRatios.length;e++)g[e]=this.tempRatios[e],g[e]=g[e].toFixed(2);var i=m.filter(function(t){return-1==g.indexOf(t)});for(e=0;e<i.length;e++)v[e]=m.indexOf(i[e]),k[e]=p[v[e]];this.tempRatios=this.tempRatios.concat(k),this.tempRatios.sort(function(t,e){return t-e}),h=this.tempRatios.length-1,this.typeOfEdit="equal",this.divisions=f}else{h=f+Number(h)-Math.abs(u-d);var s=270+Math.log10(this.tempRatios[u])/Math.log10(this.powerBase)*360,l=270+Math.log10(this.tempRatios[d])/Math.log10(this.powerBase)*360,o=Math.abs(l-s)/f;this.tempRatios.splice(u+1,Math.abs(u-d)-1);for(e=0;e<f-1;e++){var a=(Math.min(s,l)+o*(e+1)-270)/360;p[e]=Math.pow(this.powerBase,a),this.tempRatios.splice(u+1+e,0,p[e]),b[e]=this.tempRatios[e],b[e]=b[e].toFixed(2)}this.typeOfEdit="nonequal"}if("Done"===t.target.innerHTML){this.ratios=this.tempRatios.slice();var n=this.frequencies[0];this.frequencies=[];for(e=0;e<=h;e++)this.frequencies[e]=this.ratios[e]*n,this.frequencies[e]=this.frequencies[e].toFixed(2);this.pitchNumber=h,this.checkTemperament(b),this._circleOfNotes()}else if("Preview"===t.target.innerHTML){docById("userEdit").innerHTML='<div id="wheelDiv2" class="wheelNav"></div>',this.createMainWheel(this.tempRatios,h);for(e=0;e<h;e++)this.notesCircle.navItems[e].fillAttr="#e0e0e0",this.notesCircle.navItems[e].sliceHoverAttr.fill="#e0e0e0",this.notesCircle.navItems[e].slicePathAttr.fill="#e0e0e0",this.notesCircle.navItems[e].sliceSelectedAttr.fill="#e0e0e0";this.notesCircle.refreshWheel(),docById("userEdit").style.paddingLeft="0px",c(!0),divAppend.style.marginTop=docById("wheelDiv2").style.height,docById("preview").style.marginLeft="80px",docById("done_").onclick=function(){r.ratios=r.tempRatios.slice();var t=r.frequencies[0];r.frequencies=[];for(var e=0;e<=h;e++)r.frequencies[e]=r.ratios[e]*t,r.frequencies[e]=r.frequencies[e].toFixed(2);r.pitchNumber=h,r.checkTemperament(b),r._circleOfNotes()},docById("preview").onclick=function(){r.equalEdit()}}}},this.ratioEdit=function(){docById("userEdit").innerHTML="";var l=docById("userEdit");l.style.backgroundColor="#c8C8C8",l.innerHTML='<br>Ratio &nbsp;&nbsp;&nbsp;&nbsp; <input type="text" id="ratioIn" value="1"></input> &nbsp;&nbsp; : &nbsp;&nbsp; <input type="text" id="ratioOut" value="1"></input><br><br>',l.innerHTML+='Recursion &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="text" id="recursion" value="1"></input>',l.style.paddingLeft="100px";var m=this;function g(t){var e=document.createElement("div");e.id="divAppend",e.innerHTML=t?'<div id="preview" style="float:left;">Back</div><div id="done_" style="float:right;">Done</div>':'<div id="preview" style="float:left;">Preview</div><div id="done_" style="float:right;">Done</div>',e.style.textAlign="center",e.style.marginLeft="-100px",e.style.height="32px",e.style.marginTop="40px",e.style.overflow="auto",l.append(e);var i=docById("preview");i.style.height="30px",i.style.marginLeft="3px",i.style.backgroundColor=platformColor.selectorBackground,i.style.width="215px";var s=docById("done_");s.style.height="30px",s.style.marginRight="3px",s.style.backgroundColor=platformColor.selectorBackground,s.style.width="205px"}g(!1),divAppend.onmouseover=function(){this.style.cursor="pointer"},divAppend.onclick=function(t){var e,i=docById("ratioIn").value,s=docById("ratioOut").value,l=docById("recursion").value,o=m.frequencies.length,a=i/s,n=[],r=[],c=[],h=[],u=[];function d(t){return e.apply(this,arguments)}m.tempRatios=m.ratios.slice(),calculateRatios=(e=function(t){if(r[t]<m.frequencies[o-1])for(var e=0;e<m.tempRatios.length;e++){if(c[e]=n[t]-m.tempRatios[e],c[e]<0){h.push(e),m.tempRatios.splice(h[t],0,n[t]);break}if(0==c[e]){h.push(e),m.tempRatios.splice(h[t],1,n[t]);break}}else n[t]=n[t]/2,r[t]=m.frequencies[0]*n[t],calculateRatios(t)},d.toString=function(){return e.toString()},d);for(var f=0;f<l;f++)n[f]=Math.pow(a,f+1),r[f]=m.frequencies[0]*n[f],calculateRatios(f);m.tempRatios.sort(function(t,e){return t-e});var p=m.tempRatios.length-1;if("Done"==t.target.innerHTML){m.ratios=m.tempRatios.slice(),m.typeOfEdit="nonequal",m.pitchNumber=m.ratios.length-1;var b=m.frequencies[0];m.frequencies=[];for(f=0;f<=m.pitchNumber;f++)m.frequencies[f]=m.ratios[f]*b,m.frequencies[f]=m.frequencies[f].toFixed(2);for(f=0;f<m.ratios.length;f++)u[f]=m.ratios[f],u[f]=u[f].toFixed(2);m.checkTemperament(u),m._circleOfNotes()}else if("Preview"==t.target.innerHTML){docById("userEdit").innerHTML='<div id="wheelDiv2" class="wheelNav"></div>',m.createMainWheel(m.tempRatios,p);for(f=0;f<p;f++)m.notesCircle.navItems[f].fillAttr="#e0e0e0",m.notesCircle.navItems[f].sliceHoverAttr.fill="#e0e0e0",m.notesCircle.navItems[f].slicePathAttr.fill="#e0e0e0",m.notesCircle.navItems[f].sliceSelectedAttr.fill="#e0e0e0";m.notesCircle.refreshWheel(),docById("userEdit").style.paddingLeft="0px",g(!0),divAppend.style.marginTop=docById("wheelDiv2").style.height,docById("preview").style.marginLeft="100px",docById("done_").onclick=function(){m.ratios=m.tempRatios.slice(),m.pitchNumber=m.ratios.length-1;var t=m.frequencies[0];m.frequencies=[];for(var e=0;e<=m.pitchNumber;e++)m.frequencies[e]=m.ratios[e]*t,m.frequencies[e]=m.frequencies[e].toFixed(2);for(e=0;e<m.ratios.length;e++)u[e]=m.ratios[e],u[e]=u[e].toFixed(2);m.checkTemperament(u),m._circleOfNotes()},docById("preview").onclick=function(){m.ratioEdit()}}}},this.arbitraryEdit=function(){docById("userEdit").innerHTML="";var t=docById("userEdit");t.innerHTML='<br><div id="wheelDiv3" class="wheelNav"></div>',t.style.paddingLeft="0px";var r=[];this.tempRatios1=this.ratios.slice(),this._createInnerWheel=function(t,e){void 0!==this.wheel1&&(docById("wheelDiv4").display="none",this.wheel1.removeWheel()),null==t&&(t=this.ratios),null==e&&(e=this.pitchNumber);for(var i=[],s=0;s<e;s++){var l=s.toString();i.push(l)}docById("wheelDiv4").style.display="",docById("wheelDiv4").style.background="none",docById("wheelDiv4").style.position="relative",docById("wheelDiv4").style.zIndex=5,this.wheel1=new wheelnav("wheelDiv4"),this.wheel1.wheelRadius=200,this.wheel1.navItemsEnabled=!1,this.wheel1.navAngle=270,this.wheel1.navItemsContinuous=!0,this.wheel1.navItemsCentered=!1,this.wheel1.slicePathFunction=slicePath().MenuSliceWithoutLine,this.wheel1.slicePathCustom=slicePath().MenuSliceCustomization(),this.wheel1.sliceSelectedPathCustom=this.wheel1.slicePathCustom,this.wheel1.sliceInitPathCustom=this.wheel1.slicePathCustom,this.wheel1.initWheel(i);for(var o=[],a=[],n=[],r=[],c=0;c<this.wheel1.navItemCount;c++)this.wheel1.navItems[c].fillAttr="#e0e0e0",this.wheel1.navItems[c].titleAttr.font="20 20px Impact, Charcoal, sans-serif",this.wheel1.navItems[c].titleSelectedAttr.font="20 20px Impact, Charcoal, sans-serif",n[c]=270+Math.log10(t[c])/Math.log10(this.powerBase)*360,0!==c&&(c==this.pitchNumber-1?r[c-1]=n[0]+360-n[c]:r[c-1]=n[c]-n[c-1]),0===c?(a[c]=360/e,o[c]=this.wheel1.navAngle-a[0]/2):(o[c]=o[c-1]+a[c-1],a[c]=2*(n[c]-o[c])),this.wheel1.navItems[c].sliceAngle=a[c];var h=2*Math.PI*128/e/3;for(c=0;c<r.length;c++)r[c]<11&&(h=2*Math.PI*128/this.pitchNumber/6);29<h&&(h=2*Math.PI*128/33),this.wheel1.slicePathCustom.menuRadius=h,null!==docById("frequencySlider")&&(docById("frequencySlider").oninput=function(){u._refreshInnerWheel()}),this.wheel1.createWheel()},t.innerHTML+='<div id="wheelDiv4" class="wheelNav"></div>',this._createInnerWheel(),t.innerHTML+='<canvas id="circ1" width = 430px height = 256px></canvas>';var e=docById("circ1");e.style.position="absolute",e.style.zIndex=1,e.style.marginTop="-305px";var i=e.getContext("2d"),s=e.width/2,l=e.height/2;i.beginPath(),i.arc(s,l,128,0,2*Math.PI,!1),i.fillStyle="rgba(204, 0, 102, 0)",i.fill(),i.lineWidth=1,i.strokeStyle="#003300",i.stroke(),this._createOuterWheel=function(e,i){void 0!==this.wheel&&(docById("wheelDiv3").display="none",this.wheel.removeWheel()),null==i&&(i=this.pitchNumber),null==e&&(e=this.ratios),docById("wheelDiv3").style.display="",docById("wheelDiv3").style.background="none",this.wheel=new wheelnav("wheelDiv3",null,600,600),this.wheel.wheelRadius=300,this.wheel.slicePathFunction=slicePath().DonutSlice,this.wheel.slicePathCustom=slicePath().DonutSliceCustomization(),this.wheel.slicePathCustom.minRadiusPercent=.9,this.wheel.slicePathCustom.maxRadiusPercent=1,this.wheel.sliceSelectedPathCustom=this.wheel.slicePathCustom,this.wheel.sliceInitPathCustom=this.wheel.slicePathCustom,this.wheel.colors=["#c0c0c0","#e0e0e0"],this.wheel.titleRotateAngle=90,this.wheel.navItemsEnabled=!1;var t=[],s=[],l=[],o=[],a=[];for(r=[],n=0;n<=i;n++)n!==i&&t.push("|"),s[n]=270+Math.log10(e[n])/Math.log10(this.powerBase)*360,0!==n&&(l[n-1]=n==i-1?s[0]+360-s[n]:s[n]-s[n-1],r[n-1]=s[n-1]+l[n-1]/2);this.wheel.navAngle=270+l[0]/2,this.wheel.initWheel(t);for(var n=0;n<i;n++)0===n?(a[n]=360/i,o[n]=this.wheel.navAngle-a[0]/2):(o[n]=o[n-1]+a[n-1],a[n]=2*(r[n]-o[n])),this.wheel.navItems[n].sliceAngle=a[n];this.wheel.createWheel(),docById("wheelDiv3").style.position="absolute",docById("wheelDiv3").style.zIndex=10,docById("wheelDiv3").style.marginTop="15px",docById("wheelDiv3").style.marginLeft="37px",docById("wheelDiv3").addEventListener("mouseover",function(t){u.arbitraryEditSlider(t,r,e,i)})},this._createOuterWheel();var u=this,o=document.createElement("div");o.id="divAppend",o.innerHTML="Done",o.style.textAlign="center",o.style.paddingTop="5px",o.style.backgroundColor=platformColor.selectorBackground,o.style.height="25px",o.style.marginTop="40px",o.style.overflow="auto",t.append(o),o.onmouseover=function(){this.style.cursor="pointer"},o.onclick=function(){u.ratios=u.tempRatios1.slice(),u.typeOfEdit="nonequal",u.pitchNumber=u.ratios.length-1;var t=[],e=u.frequencies[0];u.frequencies=[];for(var i=0;i<u.ratios.length;i++)u.frequencies[i]=u.ratios[i]*e,u.frequencies[i]=u.frequencies[i].toFixed(2);for(i=0;i<u.ratios.length;i++)t[i]=u.ratios[i],t[i]=t[i].toFixed(2);u.checkTemperament(t),u._circleOfNotes()}},this.arbitraryEditSlider=function(t,e,i,s){for(var l=this.frequencies[0],o=[],a=0;a<=s;a++)o[a]=i[a]*l,o[a]=o[a].toFixed(2);for(var n=0;n<s;n++)if(t.target.parentNode.id=="wheelnav-wheelDiv3-title-"+n){var r=t.clientX-docById("wheelDiv3").getBoundingClientRect().left,c=t.clientY-docById("wheelDiv3").getBoundingClientRect().top,h=this;null!==docById("noteInfo1")&&docById("noteInfo1").remove(),docById("wheelDiv3").innerHTML+='<div class="popup" id="noteInfo1" style="width:180px; height:135px;"><span class="popuptext" id="myPopup"></span></div>',docById("noteInfo1").innerHTML+='<img src="header-icons/close-button.svg" id="close" title="close" alt="close" height=20px width=20px align="right">',docById("noteInfo1").innerHTML+='<br><center><input type="range" class="sliders" id = "frequencySlider" style="width:170px; background:white; border:0;" min="'+o[n]+'" max="'+o[n+1]+'" value="30"></center>',docById("noteInfo1").innerHTML+='&nbsp;&nbsp;Frequency : <span class="rangeslidervalue" id="frequencydiv">'+o[n]+"</span>",docById("noteInfo1").innerHTML+='<br><br><div id="done" style="background:rgb(196, 196, 196);"><center>Done</center><div>',270<=e[n]&&e[n]<=360?(docById("noteInfo1").style.top=c-100+"px",docById("noteInfo1").style.left=r+"px"):360<e[n]&&e[n]<=450?(docById("noteInfo1").style.top=c+"px",docById("noteInfo1").style.left=r+"px"):450<e[n]&&e[n]<=540?(docById("noteInfo1").style.top=c+"px",docById("noteInfo1").style.left=r-180+"px"):540<e[n]&&e[n]<=630&&(docById("noteInfo1").style.top=c-100+"px",docById("noteInfo1").style.left=r-180+"px"),docById("frequencySlider").oninput=function(){h._refreshInnerWheel()},docById("done").onclick=function(){h.tempRatios1=h.tempRatios.slice();var t=h.tempRatios1.length-1;h._createOuterWheel(h.tempRatios1,t)},docById("close").onclick=function(){h.tempRatios=h.tempRatios1.slice();var t=h.tempRatios.length-1;h._createInnerWheel(h.tempRatios,t),docById("noteInfo1").remove()}}},this._refreshInnerWheel=function(){docById("frequencydiv").innerHTML=docById("frequencySlider").value;var t=docById("frequencySlider").value,e=t/this.frequencies[0],i=[];this.tempRatios=this.tempRatios1.slice();for(var s=0;s<this.tempRatios.length;s++){if(i[s]=e-this.tempRatios[s],i[s]=i[s].toFixed(2),i[s]<0){var l=s;this.tempRatios.splice(l,0,e);break}if(0==i[s]){l=s;this.tempRatios.splice(l,1,e);break}}var o=this.tempRatios.length-1;this._logo.resetSynth(0),this._logo.synth.trigger(0,t,.01*this._logo.defaultBPMFactor,"electronic synth",null,null),this._createInnerWheel(this.tempRatios,o)},this.octaveSpaceEdit=function(){docById("userEdit").innerHTML="";var o=this.ratios.length,t=this.ratios[o-1],e=docById("userEdit");e.style.backgroundColor="#c8C8C8",e.innerHTML='<br><br>Octave Space &nbsp;&nbsp;&nbsp;&nbsp; <input type="text" id="startNote" value="'+t+'" style="width:50px;"></input> &nbsp;&nbsp; : &nbsp;&nbsp; <input type="text" id="endNote" value="1" style="width:50px;"></input><br><br>',e.style.paddingLeft="70px";var a=this,i=document.createElement("div");i.id="divAppend",i.innerHTML="Done",i.style.textAlign="center",i.style.paddingTop="5px",i.style.marginLeft="-70px",i.style.backgroundColor=platformColor.selectorBackground,i.style.height="25px",i.style.marginTop="40px",i.style.overflow="auto",e.append(i),i.onmouseover=function(){this.style.cursor="pointer"},i.onclick=function(){var t=docById("startNote").value/docById("endNote").value;if(2!=t){if(!confirm("Octave Space has changed. This changes temperament significantly"))return}var e=[],i=[],s=a.frequencies[0];a.frequencies=[];for(var l=0;l<o;l++)e[l]=Math.log10(a.ratios[l])/Math.log10(a.powerBase)*12,a.ratios[l]=Math.pow(t,e[l]/12),i[l]=a.ratios[l].toFixed(2),a.frequencies[l]=a.ratios[l]*s,a.frequencies[l]=a.frequencies[l].toFixed(2);a.powerBase=t,a.typeOfEdit="nonequal",a.checkTemperament(i),2!=t&&(a.octaveChanged=!0),a._circleOfNotes()}},this.checkTemperament=function(t){var e,i=[];for(var s in TEMPERAMENT)if("custom"!==s){for(var l=TEMPERAMENT[s],o=[],a=0;a<l.interval.length;a++)i[a]=l.interval[a],o[a]=l[i[a]],o[a]=o[a].toFixed(2);if(t.length==o.length&&t.every(function(t,e){return t===o[e]})){e=s,this.inTemperament=s,b.innerHTML=this.inTemperament;break}}void 0===e&&(this.inTemperament="custom",b.innerHTML=this.inTemperament)},this._save=function(){var t=!1,e=[];if(this.notes=[],"custom"==this.inTemperament)for(var i=0;i<this.ratios.length;i++){for(var s=0;s<this.ratiosNotesPair.length;s++)if(t=!1,this.ratios[i]==this.ratiosNotesPair[s][0]){t=!0,this.notes[i]=this.ratiosNotesPair[s][1][0]+"(+0)"+this.ratiosNotesPair[s][1][1];break}if(!t){var l=Math.log10(this.ratios[i])/Math.log10(2)*1200,o=[],a=[];for(s=0;s<this.cents.length;s++)o[s]=l-this.cents[s],a[s]=Math.abs(l-this.cents[s]);var n=a.reduce(function(t,e){return Math.min(t,e)});o[e=a.indexOf(n)]<0?this.notes[i]=this.ratiosNotesPair[e][1][0]+"(-"+a[e].toFixed(2)+")"+this.ratiosNotesPair[e][1][1]:this.notes[i]=this.ratiosNotesPair[e][1][0]+"(+"+a[e].toFixed(2)+")"+this.ratiosNotesPair[e][1][1]}}OCTAVERATIO=this.powerBase;var r=[[0,"temperament1",100,100,[null,1,2,null]],[1,["text",{value:this._logo.blocks.findUniqueTemperamentName(this.inTemperament)}],0,0,[0]],[2,["storein"],0,0,[0,3,4,5]],[3,["text",{value:this._logo.synth.startingPitch}],0,0,[2]],[4,["number",{value:this.frequencies[0]}],0,0,[2]],[5,["octavespace"],0,0,[2,6,9]],[6,["divide"],0,0,[5,7,8]],[7,["number",{value:rationalToFraction(OCTAVERATIO)[0]}],0,0,[6]],[8,["number",{value:rationalToFraction(OCTAVERATIO)[1]}],0,0,[6]],[9,"vspace",0,0,[5,10]]],c=9;for(i=0;i<this.pitchNumber;i++){var h=r.length;c="equal"===this.inTemperament||"1/3 comma meantone"===this.inTemperament||"equal"===this.typeOfEdit&&this.divisions===this.pitchNumber?(r.push([h,"definefrequency",0,0,[c,h+1,h+8,h+12]]),r.push([h+1,"multiply",0,0,[h,h+2,h+3]]),r.push([h+2,["namedbox",{value:this._logo.synth.startingPitch}],0,0,[h+1]]),r.push([h+3,["power"],0,0,[h+1,h+4,h+5]]),r.push([h+4,["number",{value:this.powerBase}],0,0,[h+3]]),r.push([h+5,["divide"],0,0,[h+3,h+6,h+7]]),r.push([h+6,["number",{value:i}],0,0,[h+5]]),r.push([h+7,["number",{value:this.pitchNumber}],0,0,[h+5]]),r.push([h+8,"vspace",0,0,[h,h+9]]),r.push([h+9,["pitch"],0,0,[h+8,h+10,h+11,null]]),"custom"!==this.inTemperament?(r.push([h+10,["notename",{value:this.ratiosNotesPair[i][1][0]}],0,0,[h+9]]),r.push([h+11,["number",{value:this.ratiosNotesPair[i][1][1]}],0,0,[h+9]])):(r.push([h+10,["text",{value:this.notes[i].substring(0,this.notes[i].length-1)}],0,0,[h+9]]),r.push([h+11,["number",{value:this.notes[i].slice(-1)}],0,0,[h+9]])),i==this.pitchNumber-1?r.push([h+12,"hidden",0,0,[h,null]]):r.push([h+12,"hidden",0,0,[h,h+13]]),h+12):(r.push([h,"definefrequency",0,0,[c,h+1,h+6,h+10]]),r.push([h+1,"multiply",0,0,[h,h+2,h+3]]),r.push([h+2,["namedbox",{value:this._logo.synth.startingPitch}],0,0,[h+1]]),r.push([h+3,["divide"],0,0,[h+1,h+4,h+5]]),r.push([h+4,["number",{value:rationalToFraction(this.ratios[i])[0]}],0,0,[h+3]]),r.push([h+5,["number",{value:rationalToFraction(this.ratios[i])[1]}],0,0,[h+3]]),r.push([h+6,"vspace",0,0,[h,h+7]]),r.push([h+7,["pitch"],0,0,[h+6,h+8,h+9,null]]),"custom"!==this.inTemperament?(r.push([h+8,["notename",{value:this.ratiosNotesPair[i][1][0]}],0,0,[h+7]]),r.push([h+9,["number",{value:this.ratiosNotesPair[i][1][1]}],0,0,[h+7]])):(r.push([h+8,["text",{value:this.notes[i].substring(0,this.notes[i].length-1)}],0,0,[h+7]]),r.push([h+9,["number",{value:this.notes[i].slice(-1)}],0,0,[h+7]])),i==this.pitchNumber-1?r.push([h+10,"hidden",0,0,[h,null]]):r.push([h+10,"hidden",0,0,[h,h+11]]),h+10)}this._logo.blocks.loadNewBlocks(r);var u=this._logo.synth.startingPitch.length,d=this._logo.synth.startingPitch.substring(0,u-1),f=this._logo.synth.startingPitch.slice(-1),p=[[0,"settemperament",100,100,[null,1,2,3,null]],[1,["temperamentname",{value:this.inTemperament}],0,0,[0]],[2,["notename",{value:d}],0,0,[0]],[3,["number",{value:f}],0,0,[0]]];if(this._logo.blocks.loadNewBlocks(p),"custom"===this.inTemperament){TEMPERAMENT.custom=[],TEMPERAMENT.custom.pitchNumber=this.pitchNumber;for(i=0;i<this.pitchNumber;i++){var b=""+i;TEMPERAMENT.custom[b]=[this.ratios[i],this.notes[i].substring(0,this.notes[i].length-1),this.notes[i].slice(-1)]}}"custom"==this.inTemperament&&(this._logo.customTemperamentDefined=!0,this._logo.blocks.protoBlockDict.custompitch.hidden=!1,this._logo.blocks.palettes.updatePalettes("pitch"))},this.playNote=function(t){this._logo.resetSynth(0);if(null==docById("wheelDiv4"))var e=this.frequencies[t];else e=this.tempRatios1[t]*this.frequencies[0];this._logo.synth.trigger(0,e,.5*this._logo.defaultBPMFactor,"electronic synth",null,null)},this.playAll=function(){var e=0;this.playbackForward=!0,this._playing=!this._playing,this._logo.resetSynth(0);var i=docById("buttonsRow").cells[1];this._playing?i.innerHTML='&nbsp;&nbsp;<img src="header-icons/stop-button.svg" title="'+_("Stop")+'" alt="'+_("Stop")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;':(this._logo.synth.setMasterVolume(0),this._logo.synth.stop(),i.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;');var s,t=this._logo.synth.startingPitch,l=Number(t.slice(-1))-1,o=pitchToFrequency(t.substring(0,t.length-1),l,0,"C Major"),a=this,n=this.pitchNumber;function r(t){return s.apply(this,arguments)}null!==docById("wheelDiv4")&&(n=this.tempRatios1.length-1),__playLoop=(s=function(t){if(t===n&&(a.playbackForward=!1),0===t&&e++,a._playing&&(a._logo.synth.trigger(0,o,.5*a._logo.defaultBPMFactor,"electronic synth",null,null),a.playNote(t)),0==a.circleIsVisible&&null==docById("wheelDiv4"))t===n?(a.notesCircle.navItems[0].fillAttr="#808080",a.notesCircle.navItems[0].sliceHoverAttr.fill="#808080",a.notesCircle.navItems[0].slicePathAttr.fill="#808080",a.notesCircle.navItems[0].sliceSelectedAttr.fill="#808080"):(a.notesCircle.navItems[t].fillAttr="#808080",a.notesCircle.navItems[t].sliceHoverAttr.fill="#808080",a.notesCircle.navItems[t].slicePathAttr.fill="#808080",a.notesCircle.navItems[t].sliceSelectedAttr.fill="#808080"),0==a.playbackForward&&t<n?t===n-1?(a.notesCircle.navItems[0].fillAttr="#c8C8C8",a.notesCircle.navItems[0].sliceHoverAttr.fill="#c8C8C8",a.notesCircle.navItems[0].slicePathAttr.fill="#c8C8C8",a.notesCircle.navItems[0].sliceSelectedAttr.fill="#c8C8C8"):(a.notesCircle.navItems[t+1].fillAttr="#c8C8C8",a.notesCircle.navItems[t+1].sliceHoverAttr.fill="#c8C8C8",a.notesCircle.navItems[t+1].slicePathAttr.fill="#c8C8C8",a.notesCircle.navItems[t+1].sliceSelectedAttr.fill="#c8C8C8"):0!==t&&(a.notesCircle.navItems[t-1].fillAttr="#c8C8C8",a.notesCircle.navItems[t-1].sliceHoverAttr.fill="#c8C8C8",a.notesCircle.navItems[t-1].slicePathAttr.fill="#c8C8C8",a.notesCircle.navItems[t-1].sliceSelectedAttr.fill="#c8C8C8"),a.notesCircle.refreshWheel();else if(1==a.circleIsVisible&&null==docById("wheelDiv4")){if(docById("pitchNumber_"+t).style.background=platformColor.labelColor,0==a.playbackForward&&t<n)docById("pitchNumber_"+(t+1)).style.background=platformColor.selectorBackground;else if(0!==t)docById("pitchNumber_"+(t-1)).style.background=platformColor.selectorBackground}else null!==docById("wheelDiv4")&&(t===n?(a.wheel1.navItems[0].fillAttr="#808080",a.wheel1.navItems[0].sliceHoverAttr.fill="#808080",a.wheel1.navItems[0].slicePathAttr.fill="#808080",a.wheel1.navItems[0].sliceSelectedAttr.fill="#808080"):(a.wheel1.navItems[t].fillAttr="#808080",a.wheel1.navItems[t].sliceHoverAttr.fill="#808080",a.wheel1.navItems[t].slicePathAttr.fill="#808080",a.wheel1.navItems[t].sliceSelectedAttr.fill="#808080"),0==a.playbackForward&&t<n?t===n-1?(a.wheel1.navItems[0].fillAttr="#e0e0e0",a.wheel1.navItems[0].sliceHoverAttr.fill="#e0e0e0",a.wheel1.navItems[0].slicePathAttr.fill="#e0e0e0",a.wheel1.navItems[0].sliceSelectedAttr.fill="#e0e0e0"):(a.wheel1.navItems[t+1].fillAttr="#e0e0e0",a.wheel1.navItems[t+1].sliceHoverAttr.fill="#e0e0e0",a.wheel1.navItems[t+1].slicePathAttr.fill="#e0e0e0",a.wheel1.navItems[t+1].sliceSelectedAttr.fill="#e0e0e0"):0!==t&&(a.wheel1.navItems[t-1].fillAttr="#e0e0e0",a.wheel1.navItems[t-1].sliceHoverAttr.fill="#e0e0e0",a.wheel1.navItems[t-1].slicePathAttr.fill="#e0e0e0",a.wheel1.navItems[t-1].sliceSelectedAttr.fill="#e0e0e0"),a.wheel1.refreshWheel());a.playbackForward?t+=1:t-=1,t<=n&&0<=t&&a._playing&&e<2?setTimeout(function(){__playLoop(t)},1e3*a._logo.defaultBPMFactor*.5):(i.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;',-1!==t&&setTimeout(function(){if(0==a.circleIsVisible&&null==docById("wheelDiv4"))a.notesCircle.navItems[t-1].fillAttr="#c8C8C8",a.notesCircle.navItems[t-1].sliceHoverAttr.fill="#c8C8C8",a.notesCircle.navItems[t-1].slicePathAttr.fill="#c8C8C8",a.notesCircle.navItems[t-1].sliceSelectedAttr.fill="#c8C8C8",a.notesCircle.refreshWheel();else if(1==a.circleIsVisible&&null==docById("wheelDiv4")){docById("pitchNumber_"+(t-1)).style.background=platformColor.selectorBackground}else null!==docById("wheelDiv4")&&(a.wheel1.navItems[t-1].fillAttr="#e0e0e0",a.wheel1.navItems[t-1].sliceHoverAttr.fill="#e0e0e0",a.wheel1.navItems[t-1].slicePathAttr.fill="#e0e0e0",a.wheel1.navItems[t-1].sliceSelectedAttr.fill="#e0e0e0",a.wheel1.refreshWheel())},1e3*a._logo.defaultBPMFactor*.5),a._playing=!1)},r.toString=function(){return s.toString()},r),this._playing&&__playLoop(0)},this.init=function(t){this._logo=t;var e=window.innerWidth;this._cellScale=e/1200;this._cellScale;var s=docById("temperamentDiv");s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var i=docById("temperamentButtonsDiv");i.style.display="inline",i.style.visibility="visible",i.style.width=430,i.innerHTML='<table cellpadding="0px" id="temperamentButtonTable"></table>';var l=docById("myCanvas"),o=docById("temperamentButtonTable").createTHead().insertRow(0);o.id="buttonsRow";var a=this;this._addButton(o,"close-button.svg",32,_("Close")).onclick=function(){a._logo.synth.setMasterVolume(0),a._logo.synth.stop(),docById("temperamentDiv").style.visibility="hidden",docById("temperamentButtonsDiv").style.visibility="hidden",docById("temperamentTableDiv").style.visibility="hidden",null!=docById("wheelDiv2")&&(docById("wheelDiv2").style.display="none",a.notesCircle.removeWheel()),null!=docById("wheelDiv3")&&(docById("wheelDiv3").style.display="none",a.wheel.removeWheel()),null!=docById("wheelDiv4")&&(docById("wheelDiv4").style.display="none",a.wheel1.removeWheel())},this._playing=!1,(b=o.insertCell()).innerHTML=this.inTemperament,b.style.width="106px",b.style.minWidth=b.style.width,b.style.maxWidth=b.style.width,b.style.height="53px",b.style.minHeight=b.style.height,b.style.maxHeight=b.style.height,b.style.textAlign="center",b.style.backgroundColor=platformColor.selectorBackground,this._addButton(o,"play-button.svg",32,_("Play all")).onclick=function(t){a.playAll()},this._addButton(o,"export-chunk.svg",32,_("Save")).onclick=function(){a._save()};var n=this._addButton(o,"play-button.svg",32,_("Table")),r=TEMPERAMENT[this.inTemperament];this.pitchNumber=r.pitchNumber,this.octaveChanged=!1,this.scale=this.scale[0]+" "+this.scale[1],this.scaleNotes=_buildScale(this.scale),this.scaleNotes=this.scaleNotes[0],this.powerBase=2;var c=this._logo.synth.startingPitch,h=[],u=[];this.notes=[],this.frequencies=[],this.intervals=[],this.ratios=[],this.ratiosNotesPair=[];for(var d=0;d<=this.pitchNumber;d++)if("custom"==this.inTemperament&&void 0!==TEMPERAMENT.custom[0][1]){var f=d+"";d===this.pitchNumber?(this.notes[d]=[TEMPERAMENT.custom[0][1],Number(TEMPERAMENT.custom[0][2])+1],this.ratios[d]=this.powerBase):(this.notes[d]=[TEMPERAMENT.custom[f][1],TEMPERAMENT.custom[f][2]],this.ratios[d]=TEMPERAMENT.custom[f][0]),this.frequencies[d]=this._logo.synth.getCustomFrequency(this.notes[d][0]+this.notes[d][1]+"").toFixed(2),this.cents[d]=Math.log10(this.ratios[d])/Math.log10(2)*1200,this.ratiosNotesPair[d]=[this.ratios[d],this.notes[d]]}else"custom"==this.inTemperament&&(r=TEMPERAMENT.equal),h[d]=getNoteFromInterval(c,r.interval[d]),this.notes[d]=h[d],u[d]=h[d][0],h[d][0].substring(1,h[d][0].length)===FLAT||"b"===h[d][0].substring(1,h[d][0].length)?u[d]=h[d][0].replace(FLAT,"b"):h[d][0].substring(1,h[d][0].length)!==SHARP&&"#"!==h[d][0].substring(1,h[d][0].length)||(u[d]=h[d][0].replace(SHARP,"#")),h[d]=u[d]+h[d][1],this.frequencies[d]=this._logo.synth._getFrequency(h[d],!0,this.inTemperament).toFixed(2),this.intervals[d]=r.interval[d],this.ratios[d]=r[this.intervals[d]],this.cents[d]=Math.log10(this.ratios[d])/Math.log10(2)*1200,this.ratiosNotesPair[d]=[this.ratios[d],this.notes[d]];this.toggleNotesButton=function(){this.circleIsVisible?(n.getElementsByTagName("img")[0].src="header-icons/circle.svg",n.getElementsByTagName("img")[0].title="circle",n.getElementsByTagName("img")[0].alt="circle"):(n.getElementsByTagName("img")[0].src="header-icons/table.svg",n.getElementsByTagName("img")[0].title="table",n.getElementsByTagName("img")[0].alt="table")},this._circleOfNotes(),n.onclick=function(t){a.circleIsVisible?a._circleOfNotes():a._graphOfNotes()},this._addButton(o,"add2.svg",32,_("Add pitches")).onclick=function(t){a.edit()};var p=this._addButton(o,"grab.svg",32,_("Drag"));p.style.cursor="move",this._dx=p.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=p.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=p.innerHTML,p.onmouseover=function(t){p.innerHTML=""},p.onmouseout=function(t){a._dragging||(p.innerHTML=a._dragCellHTML)},l.ondragover=function(t){a._dragging=!0,t.preventDefault()},l.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",p.innerHTML=a._dragCellHTML}},s.ondragover=function(t){a._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",p.innerHTML=a._dragCellHTML}},s.onmousedown=function(t){a._target=t.target},s.ondragstart=function(t){p.contains(a._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()}}}function Tempo(){this._xradius=25,this.BPMs=[],this.BPMBlocks=[],this._updateBPM=function(t){if(this._intervals[t]=60/this.BPMs[t]*1e3,null!=this.BPMBlocks[t]){var e=this._logo.blocks.blockList[this.BPMBlocks[t]].connections[1];null!=e&&(this._logo.blocks.blockList[e].value=parseFloat(this.BPMs[t]),this._logo.blocks.blockList[e].text.text=this.BPMs[t],this._logo.blocks.blockList[e].updateCache(),this._logo.refreshCanvas(),saveLocally())}},this.pause=function(){clearInterval(this._intervalID)},this.resume=function(){for(var t=new Date,e=0;e<this.BPMs.length;e++)this._widgetFirstTimes[e]=t.getTime(),this._widgetNextTimes[e]=this._widgetFirstTimes[e]+this._intervals[e],this._directions[e]=1;var i=this;null!==this._intervalID&&clearInterval(this._intervalID),this._intervalID=setInterval(function(){i._draw()},5)},this._useBPM=function(t){this.BPMs[t]=docById("BPMInput"+t).value,1e3<this.BPMs[t]?(this.BPMs[t]=1e3,this._logo.errorMsg(_("The beats per minute must be between 30 and 1000."))):this.BPMs[t]<30&&(this.BPMs[t]=30,this._logo.errorMsg(_("The beats per minute must be between 30 and 1000."))),this._updateBPM(t),docById("BPMInput"+t).value=this.BPMs[t]},this._speedUp=function(t){this.BPMs[t]=parseFloat(this.BPMs[t])+Math.round(.1*this.BPMs[t]),1e3<this.BPMs[t]&&(this.BPMs[t]=1e3),this._updateBPM(t),docById("BPMInput"+t).value=this.BPMs[t]},this._slowDown=function(t){this.BPMs[t]=parseFloat(this.BPMs[t])-Math.round(.1*this.BPMs[t]),this.BPMs[t]<30&&(this.BPMs[t]=30),this._updateBPM(t),docById("BPMInput"+t).value=this.BPMs[t]},this._draw=function(){for(var t=new Date,e=0;e<this.BPMs.length;e++){var i=docById("tempoCanvas"+e);null==this._widgetFirstTimes[e]&&(this._widgetFirstTimes[e]=t.getTime(),this._widgetNextTimes[e]=this._widgetFirstTimes[e]+this._intervals[e]);var s=this._widgetNextTimes[e]-t.getTime();if(t.getTime()>this._widgetNextTimes[e])this._logo.synth.trigger(0,["C2"],.0625,"bottle",null,null,!1),this._widgetNextTimes[e]+=this._intervals[e],-1===this._directions[e]?this._directions[e]=1:this._directions[e]=-1;else{if(0!==this._intervals[e])var l=i.width*(s/this._intervals[e]);else l=0;if(i.width-l<=25?this._xradius=i.width-l:this._xradius=l<=25?l:25,-1===this._directions[e])var o=i.width-l;else o=l}void 0===o&&(o=-1===this._directions[e]?0:i.width);var a=i.getContext("2d");a.clearRect(0,0,i.width,i.height),a.beginPath(),a.fillStyle="rgba(0,0,0,1)",a.ellipse(o,75,Math.max(this._xradius,1),75,0,0,2*Math.PI),a.fill(),a.closePath()}},this.__save=function(i){var s=this;setTimeout(function(){console.log("saving a BPM block for "+s.BPMs[i]);var t=42*i,e=[[0,["setbpm3",{}],100+t,100+t,[null,1,2,5]],[1,["number",{value:s.BPMs[i]}],0,0,[0]],[2,["divide",{}],0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,["vspace",{}],0,0,[0,null]]];s._logo.blocks.loadNewBlocks(e)},200*i)},this._saveTempo=function(){for(var t=0;t<this.BPMs.length;t++)this.__save(t)},this._get_save_lock=function(){return this._save_lock},this.init=function(t){this._logo=t,this._directions=[],this._widgetFirstTimes=[],this._widgetNextTimes=[],this._firstClickTimes=null,this._intervals=[],this.isMoving=!0,null!=this._intervalID&&null!=this._intervalID&&clearInterval(this._intervalID),this._intervalID=null,this._logo.synth.loadSynth(0,getDrumSynthName("bottle")),null!=this._intervalID&&clearInterval(this._intervalID);window.innerWidth;var e=docById("myCanvas"),s=docById("tempoDiv");s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var i=docById("tempoButtonsDiv");i.style.display="inline",i.style.visibility="visible",i.style.width=476,i.innerHTML='<table cellpadding="0px" id="tempoButtonTable"></table>';var l=docById("tempoButtonTable"),o=l.createTHead().insertRow(0),a=this;(n=this._addButton(o,"close-button.svg",32,_("Close"))).onclick=function(){a.hide(),a._logo.hideMsgs()},(n=this._addButton(o,"pause-button.svg",32,_("Pause"))).onclick=function(){a.isMoving?(a.pause(),this.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Pause")+'" alt="'+_("Pause")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',a.isMoving=!1):(a.resume(),this.innerHTML='&nbsp;&nbsp;<img src="header-icons/pause-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle">&nbsp;&nbsp;',a.isMoving=!0)},n.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},n.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground};var n=this._addButton(o,"export-chunk.svg",32,_("Save tempo"),"");this._save_lock=!1,n.onclick=function(){a._get_save_lock()||(a._save_lock=!0,a._saveTempo(),setTimeout(function(){a._save_lock=!1},1e3))},n.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},n.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground};var r=this._addButton(o,"grab.svg",32,_("Drag"));r.style.cursor="move",this._dx=r.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=r.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=r.innerHTML,r.onmouseover=function(t){r.innerHTML=""},r.onmouseout=function(t){a._dragging||(r.innerHTML=a._dragCellHTML)},e.ondragover=function(t){a._dragging=!0,t.preventDefault()},e.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",r.innerHTML=a._dragCellHTML}},s.ondragover=function(t){a._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",r.innerHTML=a._dragCellHTML}},s.onmousedown=function(t){a._target=t.target},s.ondragstart=function(t){r.contains(a._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()};for(var c=[],h=[],u=0;u<this.BPMs.length;u++){this._directions.push(1),this._widgetFirstTimes.push(this._logo.firstNoteTime),this._intervals.push(60/this.BPMs[u]*1e3),this._widgetNextTimes.push(this._widgetFirstTimes[u]-this._intervals[u]);o=l.insertRow();(n=this._addButton(o,"up.svg",32,_("speed up"))).setAttribute("id",u),n.onclick=function(){var t=Number(this.getAttribute("id"));a._speedUp(t)},n.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},n.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},(n=this._addButton(o,"down.svg",32,_("slow down"))).setAttribute("id",u),n.onclick=function(){var t=Number(this.getAttribute("id"));a._slowDown(t)},n.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},n.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},(n=o.insertCell()).innerHTML='<input id="BPMInput'+u+'" style="-webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="BPMInput" type="BPMInput" value="'+this.BPMs[u]+'" />',n.setAttribute("id",u),n.style.width="53px",n.style.minWidth=n.style.width,n.style.maxWidth=n.style.width,n.style.height="53px",n.style.minHeight=n.style.height,n.style.maxHeight=n.style.height,n.style.backgroundColor=platformColor.selectorBackground;o=l.insertRow();c.push(o.insertCell()),c[u].style.height="98px",h.push(document.createElement("canvas")),h[u].setAttribute("id","tempoCanvas"+u),h[u].style.width="700px",h[u].style.height="100px",h[u].style.position="absolute",h[u].style.border="1px",h[u].style.background="rgba(255, 255, 255, 1)",c[u].appendChild(h[u]),h[u].style.visibility="visible",h[u].style.top=c[u].getBoundingClientRect().top-100+1-53+"px",h[u].addEventListener("click",function(){id=Number(this.getAttribute("id").replace("tempoCanvas",""));var t=new Date;if(null==a._firstClickTime)a._firstClickTime=t.getTime();else{var e=parseInt(6e4/(t.getTime()-a._firstClickTime));if(29<e&&e<1001)a.BPMs[id]=e,a._updateBPM(id),docById("BPMInput"+id).value=a.BPMs[id],a._firstClickTime=null;else a._firstClickTime=t.getTime()}});var d=docById("BPMInput"+u);d.classList.add("hasKeyboard"),d.addEventListener("keyup",function(t){13===t.keyCode&&(id=Number(this.getAttribute("id").replace("BPMInput","")),console.log(id),a._useBPM(id))})}this._logo.textMsg(_("Adjust the tempo with the buttons.")),this.resume()},this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this.hide=function(){docById("tempoDiv").style.visibility="hidden",docById("tempoButtonsDiv").style.visibility="hidden";for(var t=0;t<this.BPMs.length;t++)docById("tempoCanvas"+t).style.visibility="hidden";null!=this._intervalID&&clearInterval(this._intervalID)}}function TimbreWidget(){var u=docById("timbreTableDiv");this.notesToPlay=[],this.env=[],this.ENVs=[],this.synthVals={oscillator:{type:"sine6",source:DEFAULTOSCILLATORTYPE},envelope:{attack:.01,decay:.5,sustain:.6,release:.01}},this.adsrMap=["attack","decay","sustain","release"],this.amSynthParamvals={harmonicity:3},this.fmSynthParamvals={modulationIndex:10},this.noiseSynthParamvals={noise:{type:"white"}},this.duoSynthParamVals={vibratoAmount:.5,vibratoRate:5},this.fil=[],this.filterParams=[],this.osc=[],this.oscParams=[],this.tremoloEffect=[],this.tremoloParams=[],this.vibratoEffect=[],this.vibratoParams=[],this.chorusEffect=[],this.chorusParams=[],this.phaserEffect=[],this.phaserParams=[],this.distortionEffect=[],this.distortionParams=[],this.AMSynthesizer=[],this.AMSynthParams=[],this.FMSynthesizer=[],this.FMSynthParams=[],this.NoiseSynthesizer=[],this.NoiseSynthParams=[],this.duoSynthesizer=[],this.duoSynthParams=[],this.activeParams=["synth","amsynth","fmsynth","noisesynth","duosynth","envelope","oscillator","filter","effects","chorus","vibrato","phaser","distortion","tremolo"],this.isActive={};for(var t=0;t<this.activeParams.length;t++)this.isActive[this.activeParams[t]]=!1;this.blockNo=null,this.instrumentName="custom",this._addButton=function(t,e,i,s){var l=t.insertCell(-1);return l.innerHTML='&nbsp;&nbsp;<img src="header-icons/'+e+'" title="'+s+'" alt="'+s+'" height="'+i+'" width="'+i+'" vertical-align="middle" align-content="center">&nbsp;&nbsp;',l.style.width="53px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,l.style.height=l.style.width,l.style.minHeight=l.style.height,l.style.maxHeight=l.style.height,l.style.backgroundColor=platformColor.selectorBackground,l.onmouseover=function(){this.style.backgroundColor=platformColor.selectorBackgroundHOVER},l.onmouseout=function(){this.style.backgroundColor=platformColor.selectorBackground},l},this._update=function(t,e,i){var s=[];if(!0===this.isActive.envelope&&null!=this.env[t])for(j=0;j<4;j++)s[j]=this._logo.blocks.blockList[this.env[t]].connections[j+1];if(!0===this.isActive.filter&&null!=this.fil[t])for(j=0;j<3;j++)s[j]=this._logo.blocks.blockList[this.fil[t]].connections[j+1];if(!0===this.isActive.oscillator&&null!=this.osc[t])for(j=0;j<2;j++)s[j]=this._logo.blocks.blockList[this.osc[t]].connections[j+1];if(!0===this.isActive.amsynth&&null!=this.AMSynthesizer[t]&&(s[0]=this._logo.blocks.blockList[this.AMSynthesizer[t]].connections[1]),!0===this.isActive.fmsynth&&null!=this.FMSynthesizer[t]&&(s[0]=this._logo.blocks.blockList[this.FMSynthesizer[t]].connections[1]),!0===this.isActive.noisesynth&&null!=this.NoiseSynthesizer[t]&&(s[0]=this._logo.blocks.blockList[this.NoiseSynthesizer[t]].connections[1]),!0===this.isActive.duosynth&&null!=this.duoSynthesizer[t])for(j=0;j<2;j++)s[j]=this._logo.blocks.blockList[this.duoSynthesizer[t]].connections[j+1];if(!0===this.isActive.tremolo&&null!=this.tremoloEffect[t])for(j=0;j<2;j++)s[j]=this._logo.blocks.blockList[this.tremoloEffect[t]].connections[j+1];if(!0===this.isActive.vibrato&&null!=this.vibratoEffect[t]){s[0]=this._logo.blocks.blockList[this.vibratoEffect[t]].connections[1];var l=this._logo.blocks.blockList[this.vibratoEffect[t]].connections[2];if("divide"===this._logo.blocks.blockList[l].name&&null!=this._logo.blocks.blockList[l].connections[1]&&"number"===this._logo.blocks.blockList[this._logo.blocks.blockList[l].connections[1]].name&&null!=this._logo.blocks.blockList[l].connections[2]&&"number"===this._logo.blocks.blockList[this._logo.blocks.blockList[l].connections[2]].name){var o=this._logo.blocks.blockList[l].connections[1],a=this._logo.blocks.blockList[l].connections[2];s[1]=a,s[2]=o}else{var n=rationalToFraction(this._logo.parseArg(this._logo,0,l,null,null)),r=(this._logo.blocks.blockList[last(this.vibratoEffect)].connections[3],this._logo.blocks.blockList.length),c=[[0,["divide",{}],0,0,[null,1,2]],[1,["number",{value:n[0]}],0,0,[0]],[2,["number",{value:n[1]}],0,0,[0]]];this._logo.blocks.loadNewBlocks(c),s[1]=r+2,s[2]=r+1;var h=this;__blockRefresher=function(){h._logo.blocks.blockList[last(h.vibratoEffect)].connections[2]=r,h._logo.blocks.blockList[r].connections[0]=last(h.vibratoEffect),h._logo.blocks.blockList[l].connections[0]=null,h._logo.blocks.clampBlocksToCheck.push([r,0]),h._logo.blocks.clampBlocksToCheck.push([h.blockNo,0]),h._logo.blocks.adjustDocks(h.blockNo,!0)},setTimeout(__blockRefresher(),250)}}if(!0===this.isActive.chorus&&null!=this.chorusEffect[t])for(j=0;j<3;j++)s[j]=this._logo.blocks.blockList[this.chorusEffect[t]].connections[j+1];if(!0===this.isActive.phaser&&null!=this.phaserEffect[t])for(j=0;j<3;j++)s[j]=this._logo.blocks.blockList[this.phaserEffect[t]].connections[j+1];!0===this.isActive.distortion&&null!=this.distortionEffect[t]&&(s[0]=this._logo.blocks.blockList[this.distortionEffect[t]].connections[1]),null!=s[0]&&(this._logo.blocks.blockList[s[i]].value="string"==typeof e?e:parseFloat(e),this._logo.blocks.blockList[s[i]].text.text=e.toString(),this._logo.blocks.blockList[s[i]].updateCache(),this._logo.refreshCanvas(),saveLocally())},this._playNote=function(t,e){this._logo.synth.setMasterVolume(last(this._logo.masterVolume));var i=instrumentsEffects[0][this.instrumentName],s={doVibrato:!1,doDistortion:!1,doTremolo:!1,doPhaser:!1,doChorus:!1,vibratoIntensity:0,vibratoFrequency:0,distortionAmount:0,tremoloFrequency:0,tremoloDepth:0,rate:0,octaves:0,baseFrequency:0,chorusRate:0,delayTime:0,chorusDepth:0};i.vibratoActive&&(s.vibratoFrequency=i.vibratoFrequency,s.vibratoIntensity=i.vibratoIntensity,s.doVibrato=!0),i.distortionActive&&(s.distortionAmount=i.distortionAmount,s.doDistortion=!0),i.tremoloActive&&(s.tremoloFrequency=i.tremoloFrequency,s.tremoloDepth=i.tremoloDepth,s.doTremolo=!0),i.phaserActive&&(s.rate=i.rate,s.octaves=i.octaves,s.baseFrequency=i.baseFrequency,s.doPhaser=!0),i.chorusActive&&(s.chorusRate=i.chorusRate,s.delayTime=i.delayTime,s.chorusDepth=i.chorusDepth,s.doChorus=!0),this.instrumentName in instrumentsFilters[0]?this._logo.synth.trigger(0,t,this._logo.defaultBPMFactor*e,this.instrumentName,s,instrumentsFilters[0][this.instrumentName]):(console.log(s.vibratoIntensity+" "+s.vibratoFrequency),this._logo.synth.trigger(0,t,this._logo.defaultBPMFactor*e,this.instrumentName,s,null))},this._play=function(t){this._playing=!this._playing,this._logo.resetSynth(0);var e=t.cells[0];this._playing?e.innerHTML='&nbsp;&nbsp;<img src="header-icons/stop-button.svg" title="'+_("stop")+'" alt="'+_("stop")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;':(this._logo.synth.setMasterVolume(0),this._logo.synth.stop(),e.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;');var i,s=this;function l(t){return i.apply(this,arguments)}0===this.notesToPlay.length&&(this.notesToPlay=[["G4",.25],["E4",.25],["G4",.5]]),__playLoop=(i=function(t){s._playing&&s._playNote(s.notesToPlay[t][0],s.notesToPlay[t][1]),(t+=1)<s.notesToPlay.length&&s._playing?setTimeout(function(){__playLoop(t)},1e3*s._logo.defaultBPMFactor*s.notesToPlay[t-1][1]):(e.innerHTML='&nbsp;&nbsp;<img src="header-icons/play-button.svg" title="'+_("Play")+'" alt="'+_("Play")+'" height="32" width="32" vertical-align="middle" align-content="center">&nbsp;&nbsp;',s._playing=!1)},l.toString=function(){return i.toString()},l),this._playing&&__playLoop(0)},this._save=function(){var t=docById("timbreName").value,e=[[0,"settimbre",100+this._delta,100+this._delta,[null,1,null,2]],[1,["text",{value:t}],0,0,[0]],[2,"hidden",0,0,[0,null]]];this._logo.blocks.loadNewBlocks(e),this._delta+=42},this._undo=function(){var t=0;if(this.isActive.envelope){1<this.env.length&&(t=this.env.length-1),docById("envelopeButtonCell").style.backgroundColor=platformColor.selectorBackground;for(var e=0;e<4;e++)this.synthVals.envelope[this.adsrMap[e]]=parseFloat(this.ENVs[e])/100,docById("myRange"+e).value=parseFloat(this.ENVs[e]),docById("myspan"+e).textContent=this.ENVs[e],this._update(t,parseFloat(this.ENVs[e]),e);this._logo.synth.createSynth(0,this.instrumentName,this.synthVals.oscillator.source,this.synthVals)}else if(!0===this.isActive.amsynth)docById("synthButtonCell").style.backgroundColor=platformColor.selectorBackground,1<this.AMSynthesizer.length&&(t=this.AMSynthesizer.length-1),docById("myRangeS0").value=parseFloat(this.AMSynthParams[0]),docById("myspanS0").textContent=this.AMSynthParams[0],this.amSynthParamvals.harmonicity=parseFloat(this.AMSynthParams[0]),this._update(t,this.AMSynthParams[0],0),this._logo.synth.createSynth(0,this.instrumentName,"amsynth",this.amSynthParamvals);else if(!0===this.isActive.fmsynth)docById("synthButtonCell").style.backgroundColor=platformColor.selectorBackground,1<this.FMSynthesizer.length&&(t=this.FMSynthesizer.length-1),docById("myRangeS0").value=parseFloat(this.FMSynthParams[0]),docById("myspanS0").textContent=this.FMSynthParams[0],this.fmSynthParamvals.modulationIndex=parseFloat(this.FMSynthParams[0]),this._update(t,this.FMSynthParams[0],0),this._logo.synth.createSynth(0,this.instrumentName,"fmsynth",this.fmSynthParamvals);else if(!0===this.isActive.noisesynth)docById("synthButtonCell").style.backgroundColor=platformColor.selectorBackground,1<this.NoiseSynthesizer.length&&(t=this.NoiseSynthesizer.length-1),docById("myRangeS0").value=this.NoiseSynthParams[0],docById("myspanS0").textContent=this.NoiseSynthParams[0],this.noiseSynthParamvals["noise.type"]=this.NoiseSynthParams[0],this._update(t,this.NoiseSynthParams[0],0),this._logo.synth.createSynth(0,this.instrumentName,"noisesynth",this.noiseSynthParamvals);else if(!0===this.isActive.duosynth)docById("synthButtonCell").style.backgroundColor=platformColor.selectorBackground,1<this.duoSynthesizer.length&&(t=this.duoSynthesizer.length-1),docById("myRangeS0").value=parseFloat(this.duoSynthParams[0]),docById("myspanS0").textContent=this.duoSynthParams[0],this.duoSynthParamVals.vibratoRate=parseFloat(this.duoSynthParams[0]),this._update(t,this.duoSynthParams[0],0),docById("myRangeS1").value=parseFloat(this.duoSynthParams[1]),docById("myspanS1").textContent=this.duoSynthParams[1],this.duoSynthParamVals.vibratoAmount=parseFloat(this.duoSynthParams[1]),this._update(t,this.duoSynthParams[1],1),this._logo.synth.createSynth(0,this.instrumentName,"duosynth",this.duoSynthParamVals);else if(this.isActive.oscillator)docById("oscillatorButtonCell").style.backgroundColor=platformColor.selectorBackground,1<this.osc.length&&(t=this.osc.length-1),docById("selOsc1").value=DEFAULTOSCILLATORTYPE,this._update(t,DEFAULTOSCILLATORTYPE,0),docById("myRangeO0").value=parseFloat(6),docById("myspanO0").textContent="6",this._update(t,"6",1),this.synthVals.oscillator.type="sine6",this.synthVals.oscillator.source=DEFAULTOSCILLATORTYPE,this._logo.synth.createSynth(0,this.instrumentName,this.oscParams[0],this.synthVals);else if(this.isActive.filter)for(e=0;e<this.fil.length;e++){docById("filterButtonCell").style.backgroundColor=platformColor.selectorBackground,docById("sel"+e).value=this.filterParams[3*e],this._update(e,this.filterParams[3*e],0),instrumentsFilters[0][this.instrumentName][e].filterType=this.filterParams[3*e];var i=[4*e,4*e+1,4*e+2,4*e+3];-12===this.filterParams[3*e+1]?docById("radio"+i[0]).checked=!0:docById("radio"+i[0]).checked=!1,-24===this.filterParams[3*e+1]?docById("radio"+i[1]).checked=!0:docById("radio"+i[1]).checked=!1,-48===this.filterParams[3*e+1]?docById("radio"+i[2]).checked=!0:docById("radio"+i[2]).checked=!1,-96===this.filterParams[3*e+1]?docById("radio"+i[3]).checked=!0:docById("radio"+i[3]).checked=!1,this._update(e,this.filterParams[1+3*e],1),instrumentsFilters[0][this.instrumentName][e].filterRolloff=parseFloat(this.filterParams[1+3*e]),docById("myRangeF"+e).value=parseFloat(this.filterParams[2+3*e]),docById("myspanF"+e).textContent=this.filterParams[2+3*e],this._update(e,this.filterParams[2+3*e],2),instrumentsFilters[0][this.instrumentName][e].filterFrequency=parseFloat(this.filterParams[2+3*e])}else if(!0===this.isActive.tremolo){docById("effectsButtonCell").style.backgroundColor=platformColor.selectorBackground,1!==this.tremoloEffect.length&&(t=this.tremoloEffect.length-1);for(e=0;e<2;e++)docById("myRangeFx"+e).value=parseFloat(this.tremoloParams[e]),docById("myspanFx"+e).textContent=this.tremoloParams[e],this._update(t,this.tremoloParams[e],e)}else if(!0===this.isActive.vibrato){docById("effectsButtonCell").style.backgroundColor=platformColor.selectorBackground,1!==this.vibratoEffect.length&&(t=this.vibratoEffect.length-1);for(e=0;e<2;e++)docById("myRangeFx"+e).value=parseFloat(this.vibratoParams[e]),docById("myspanFx"+e).textContent=this.vibratoParams[e],this._update(t,this.vibratoParams[e],e)}else if(!0===this.isActive.phaser){docById("effectsButtonCell").style.backgroundColor=platformColor.selectorBackground,1!==this.phaserEffect.length&&(t=this.phaserEffect.length-1);for(e=0;e<3;e++)docById("myRangeFx"+e).value=parseFloat(this.phaserParams[e]),docById("myspanFx"+e).textContent=this.phaserParams[e],this._update(t,this.phaserParams[e],e)}else if(!0===this.isActive.chorus){docById("effectsButtonCell").style.backgroundColor=platformColor.selectorBackground,1!==this.chorusEffect.length&&(t=this.chorusEffect.length-1);for(e=0;e<3;e++)docById("myRangeFx"+e).value=parseFloat(this.chorusParams[e]),docById("myspanFx"+e).textContent=this.chorusParams[e],this._update(t,this.chorusParams[e],e)}else!0===this.isActive.distortion&&(docById("effectsButtonCell").style.backgroundColor=platformColor.selectorBackground,1!==this.distortionEffect.length&&(t=this.dstortionEffect.length-1),docById("myRangeFx0").value=parseFloat(this.distortionParams[0]),docById("myspanFx0").textContent=this.distortionParams[0],this._update(t,this.distortionParams[0],0));this._playNote("G4",1/8)},this.init=function(t){this._logo=t,this._delta=0,this._playing=!1;var e=window.innerWidth;this._cellScale=e/1200;this._cellScale;var s=docById("timbreDiv");s.style.visibility="visible",s.setAttribute("draggable","true"),s.style.left="200px",s.style.top="150px";var i=docById("timbreButtonsDiv");i.style.display="inline",i.style.visibility="visible",i.style.width=476,i.innerHTML='<table cellpadding="0px" id="timbreButtonTable"></table>';var l=docById("myCanvas"),o=docById("timbreButtonTable").createTHead().insertRow(0),a=this;_unhighlightButtons=function(){p.style.backgroundColor="#808080",r.style.backgroundColor=platformColor.selectorBackground,c.style.backgroundColor=platformColor.selectorBackground,h.style.backgroundColor=platformColor.selectorBackground,u.style.backgroundColor=platformColor.selectorBackground,d.style.backgroundColor=platformColor.selectorBackground},(f=this._addButton(o,"close-button.svg",32,_("Close"))).onclick=function(){docById("timbreDiv").style.visibility="hidden",docById("timbreButtonsDiv").style.visibility="hidden",docById("timbreTableDiv").style.visibility="hidden",docById("timbreName").classList.remove("hasKeyboard"),a._logo.hideMsgs()},(f=this._addButton(o,"play-button.svg",32,_("Play"))).onclick=function(){a._play(o)},(f=this._addButton(o,"export-chunk.svg",32,_("Save"))).onclick=function(){a._save()},(f=o.insertCell()).innerHTML='<input id="timbreName" style="-webkit-user-select: text;-moz-user-select: text;-ms-user-select: text;" class="timbreName" type="text" value="'+this.instrumentName+'" />',f.style.width="106px",f.style.minWidth=f.style.width,f.style.maxWidth=f.style.width,f.style.height="53px",f.style.minHeight=f.style.height,f.style.maxHeight=f.style.height,f.style.backgroundColor=platformColor.selectorBackground;var n=docById("timbreName");n.classList.add("hasKeyboard"),n.oninput=function(t){var e=a._logo.blocks.blockList[a.blockNo].connections[1],i=a._logo.blocks.blockList[e];i.value=n.value;var s=i.value.toString();8<s.length&&(s=s.substr(0,7)+"..."),i.text.text=s,i.updateCache()};var r=this._addButton(o,"synth.svg",32,_("Synthesizer"));r.id="synthButtonCell",this.isActive.synth=!1,r.onclick=function(){_unhighlightButtons();for(var t=0;t<a.activeParams.length;t++)a.isActive[a.activeParams[t]]=!1;a.isActive.synth=!0,0===a.osc.length?a._synth():a._logo.errorMsg(_("Unable to use synth due to existing oscillator"))};var c=this._addButton(o,"oscillator.svg",32,_("Oscillator"));c.id="oscillatorButtonCell",this.isActive.oscillator=!1,c.onclick=function(){_unhighlightButtons();for(var t=0;t<a.activeParams.length;t++)a.isActive[a.activeParams[t]]=!1;if(a.isActive.oscillator=!0,0===a.osc.length){var e=a._logo.blocks.blockList[a.blockNo].connections[2],i=a._logo.blocks.findBottomBlock(e),s=[[0,["oscillator",{}],0,0,[null,2,1,null]],[1,["number",{value:6}],0,0,[0]],[2,["oscillatortype",{value:DEFAULTOSCILLATORTYPE}],0,0,[0]]];a._logo.blocks.loadNewBlocks(s);var l=a._logo.blocks.blockList.length-3;a.osc.push(l),a.oscParams.push(DEFAULTOSCILLATORTYPE),a.oscParams.push(6),setTimeout(a.blockConnection(3,i),500),a._oscillator(!0)}else a._oscillator(!1);0===a.osc.length||0===a.AMSynthesizer.length&&0===a.FMSynthesizer.length&&0===a.duoSynthesizer.length||a._oscillator(!1)};var h=this._addButton(o,"envelope.svg",32,_("Envelope"));h.id="envelopeButtonCell",this.isActive.envelope=!1,h.onclick=function(){_unhighlightButtons();for(var t=0;t<a.activeParams.length;t++)a.isActive[a.activeParams[t]]=!1;if(a.isActive.envelope=!0,0===a.env.length){var e=a._logo.blocks.blockList[a.blockNo].connections[2],i=a._logo.blocks.findBottomBlock(e);a._logo.blocks.loadNewBlocks([[0,["envelope",{}],0,0,[null,1,2,3,4,null]],[1,["number",{value:1}],0,0,[0]],[2,["number",{value:50}],0,0,[0]],[3,["number",{value:60}],0,0,[0]],[4,["number",{value:1}],0,0,[0]]]);var s=a._logo.blocks.blockList.length-5;a.env.push(s),a.ENVs.push(1),a.ENVs.push(50),a.ENVs.push(60),a.ENVs.push(1),setTimeout(a.blockConnection(5,i),500),a._envelope(!0)}else a._envelope(!1)};var u=this._addButton(o,"effects.svg",32,_("Effects"));u.id="effectsButtonCell",this.isActive.effects=!1,u.onclick=function(){_unhighlightButtons();for(var t=0;t<a.activeParams.length;t++)a.isActive[a.activeParams[t]]=!1;a.isActive.effects=!0,a._effects()};var d=this._addButton(o,"filter.svg",32,_("Filter"));d.id="filterButtonCell",this.isActive.filter=!1,d.onclick=function(){_unhighlightButtons();for(var t=0;t<a.activeParams.length;t++)a.isActive[a.activeParams[t]]=!1;if(a.isActive.filter=!0,0===a.fil.length){var e=a._logo.blocks.blockList[a.blockNo].connections[2],i=a._logo.blocks.findBottomBlock(e),s=[[0,["filter",{}],0,0,[null,3,1,2,null]],[1,["number",{value:-12}],0,0,[0]],[2,["number",{value:392}],0,0,[0]],[3,["filtertype",{value:DEFAULTFILTERTYPE}],0,0,[0]]];a._logo.blocks.loadNewBlocks(s);var l=a._logo.blocks.blockList.length-4;a.fil.push(l),a.filterParams.push(DEFAULTFILTERTYPE),a.filterParams.push(-12),a.filterParams.push(392),setTimeout(a.blockConnection(4,i),500)}a._filter()};var f,p=this._addButton(o,"filter+.svg",32,_("Add filter"));p.style.backgroundColor="#808080",p.onclick=function(){a.isActive.filter&&a._addFilter()},p.onmouseover=function(){},p.onmouseout=function(){},(f=this._addButton(o,"restore-button.svg",32,_("Undo"))).onclick=function(){a._undo()};var b=this._addButton(o,"grab.svg",32,_("Drag"));b.style.cursor="move",this._dx=b.getBoundingClientRect().left-s.getBoundingClientRect().left,this._dy=b.getBoundingClientRect().top-s.getBoundingClientRect().top,this._dragging=!1,this._target=!1,this._dragCellHTML=b.innerHTML,b.onmouseover=function(t){b.innerHTML=""},b.onmouseout=function(t){a._dragging||(b.innerHTML=a._dragCellHTML)},l.ondragover=function(t){a._dragging=!0,t.preventDefault()},l.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",b.innerHTML=a._dragCellHTML}},s.ondragover=function(t){a._dragging=!0,t.preventDefault()},s.ondrop=function(t){if(a._dragging){a._dragging=!1;var e=t.clientX-a._dx;s.style.left=e+"px";var i=t.clientY-a._dy;s.style.top=i+"px",b.innerHTML=a._dragCellHTML}},s.onmousedown=function(t){a._target=t.target},s.ondragstart=function(t){b.contains(a._target)?t.dataTransfer.setData("text/plain",""):t.preventDefault()},this._logo.textMsg(_("Click on buttons to open the timbre design tools."))},this.clampConnection=function(t,e,i){this._logo.blocks.blockList[this.blockNo].connections[2]=t,this._logo.blocks.blockList[t].connections[0]=this.blockNo,null!=i&&(this._logo.blocks.blockList[t].connections[e]=i,this._logo.blocks.blockList[i].connections[0]=t),this._logo.blocks.clampBlocksToCheck.push([t,0]),this._logo.blocks.clampBlocksToCheck.push([this.blockNo,0]),this._logo.blocks.adjustDocks(this.blockNo,!0)},this.clampConnectionVspace=function(t,e,i){this._logo.blocks.blockList[this.blockNo].connections[2]=t,this._logo.blocks.blockList[t].connections[0]=this.blockNo,null!=i&&(this._logo.blocks.blockList[e].connections[1]=i,this._logo.blocks.blockList[i].connections[0]=e),this._logo.blocks.clampBlocksToCheck.push([t,0]),this._logo.blocks.clampBlocksToCheck.push([this.blockNo,0]),this._logo.blocks.adjustDocks(this.blockNo,!0)},this._changeBlock=function(t,e,i){var s=0;0!==this.AMSynthesizer.length&&"AMSynth"!==e?(s=this.AMSynthesizer.pop(),setTimeout(this._blockReplace(s,t),500)):0!==this.FMSynthesizer.length&&"FMSynth"!==e?(s=this.FMSynthesizer.pop(),setTimeout(this._blockReplace(s,t),500)):0!==this.duoSynthesizer.length&&"DuoSynth"!==e?(s=this.duoSynthesizer.pop(),setTimeout(this._blockReplace(s,t),500)):"FMSynth"===e||"AMSynth"===e?setTimeout(this.blockConnection(2,i),500):setTimeout(this.blockConnection(3,i),500)},this._blockReplace=function(t,e){var i=this._logo.blocks.blockList[t].connections[0],s=last(this._logo.blocks.blockList[t].connections);if(this._logo.blocks.blockList[e].connections[0]=i,this._logo.blocks.blockList[e].connections[this._logo.blocks.blockList[e].connections.length-1]=s,null!=i){for(var l=0;l<this._logo.blocks.blockList[i].connections.length;l++)if(this._logo.blocks.blockList[i].connections[l]===t){this._logo.blocks.blockList[i].connections[l]=e;break}for(var o=i;o!=this.blockNo;)this._logo.blocks.blockList[o].isClampBlock()&&this._logo.blocks.clampBlocksToCheck.push([o,0]),o=this._logo.blocks.blockList[o].connections[0];this._logo.blocks.clampBlocksToCheck.push([this.blockNo,0])}if(null!=s)for(l=0;l<this._logo.blocks.blockList[s].connections.length;l++)if(this._logo.blocks.blockList[s].connections[l]===t){this._logo.blocks.blockList[s].connections[l]=e;break}this._logo.blocks.adjustDocks(i,!0),this._logo.blocks.blockList[t].connections[0]=null,this._logo.blocks.blockList[t].connections[this._logo.blocks.blockList[t].connections.length-1]=null,this._logo.blocks.sendStackToTrash(this._logo.blocks.blockList[t]),this._logo.refreshCanvas()},this.blockConnection=function(t,e){var i=this._logo.blocks.blockList.length-t;if(null==e)this._logo.blocks.blockList[this.blockNo].connections[2]=i,this._logo.blocks.blockList[i].connections[0]=this.blockNo;else{for(var s=this._logo.blocks.blockList[e].connections.length-1;"hidden"===this._logo.blocks.blockList[e].name&&"newnote"!==this._logo.blocks.blockList[this._logo.blocks.blockList[e].connections[0]].name;){var l=this._logo.blocks.blockList[e].connections[0];s=this._logo.blocks.blockList[l].connections.length-2,this._logo.blocks.clampBlocksToCheck.push([l,0]),null==this._logo.blocks.blockList[l].connections[s]?e=l:(e=this._logo.blocks.findBottomBlock(this._logo.blocks.blockList[l].connections[s]),s=this._logo.blocks.blockList[e].connections.length-1)}this._logo.blocks.blockList[e].connections[s]=i,this._logo.blocks.blockList[i].connections[0]=e}this._logo.blocks.clampBlocksToCheck.push([this.blockNo,0]),this._logo.blocks.adjustDocks(this.blockNo,!0)},this._synth=function(){var o=this,a=0;docById("synthButtonCell").style.backgroundColor="#C8C8C8",docById("synthButtonCell").onmouseover=function(){},docById("synthButtonCell").onmouseout=function(){},u.style.display="inline",u.style.visibility="visible",u.style.border="0px",u.style.overflow="auto",u.style.backgroundColor="white",u.style.height="300px",u.innerHTML='<div id="timbreTable"></div>';for(var t=docById("timbreTable"),e="",i=0;i<2;i++)e+='<div id ="synth'+i+'"></div>';t.innerHTML=e;var s=document.createElement("div");s.id="envAppend",s.style.backgroundColor=platformColor.selectorBackground,s.style.height="30px",s.style.marginTop="40px",s.style.overflow="auto",t.append(s),docById("synth0").innerHTML='<p><input type="radio" name="synthsName" value="AMSynth"/>'+_("AM synth")+'</br><input type="radio" name="synthsName" value="FMSynth"/>'+_("FM synth")+'</br><input type="radio" name="synthsName" value="DuoSynth"/>'+_("duo synth")+"</br></p>";var n,r=docById("synth1"),l=docByName("synthsName");for(i=0;i<l.length;i++)l[i].onclick=function(){for(var t='<div id="chosen">'+(n=this.value)+"</div>",e=0;e<o.activeParams.length;e++)o.isActive[o.activeParams[e]]=!1;if(o.isActive.synth=!0,"AMSynth"===n){if(o.isActive.amsynth=!0,o.isActive.fmsynth=!1,o.isActive.duosynth=!1,0===o.AMSynthesizer.length){var i=o._logo.blocks.blockList[o.blockNo].connections[2],s=o._logo.blocks.findBottomBlock(i);o._logo.blocks.loadNewBlocks([[0,["amsynth",{}],0,0,[null,1,null]],[1,["number",{value:1}],0,0,[0]]]);var l=o._logo.blocks.blockList.length-2;o.AMSynthesizer.push(l),o.AMSynthParams.push(1),o._changeBlock(last(o.AMSynthesizer),n,s),console.log("CREATING AM SYNTH!!!"),o.amSynthParamvals.harmonicity=parseFloat(o.AMSynthParams[0]),o._logo.synth.createSynth(0,o.instrumentName,"amsynth",o.amSynthParamvals)}t+='<div id="wrapperS0"><div id="sS0"><span>'+_("harmonicity")+'</span></div><div class="insideDivSynth"><input type="range" id="myRangeS0" class="sliders" style="margin-top:20px" value="'+parseFloat(o.AMSynthParams[0])+'"><span id="myspanS0" class="rangeslidervalue">'+o.AMSynthParams[0]+"</span></div></div>",r.innerHTML=t,o.amSynthParamvals.harmonicity=parseFloat(o.AMSynthParams[0]),1!==o.AMSynthesizer.length&&(a=o.AMSynthesizer.length-1),document.getElementById("wrapperS0").addEventListener("change",function(t){docById("synthButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;docById("myRangeS0").value=parseFloat(e.value),o.amSynthParamvals.harmonicity=parseFloat(e.value),docById("myspanS0").textContent=e.value,o._update(a,e.value,0),o._logo.synth.createSynth(0,o.instrumentName,"amsynth",o.amSynthParamvals),o._playNote("G4",1/8)})}else if("FMSynth"===n){if(o.isActive.amsynth=!1,o.isActive.fmsynth=!0,o.isActive.duosynth=!1,0===o.FMSynthesizer.length){i=o._logo.blocks.blockList[o.blockNo].connections[2],s=o._logo.blocks.findBottomBlock(i);o._logo.blocks.loadNewBlocks([[0,["fmsynth",{}],0,0,[null,1,null]],[1,["number",{value:10}],0,0,[0]]]);l=o._logo.blocks.blockList.length-2;o.FMSynthesizer.push(l),o.FMSynthParams.push(10),o._changeBlock(last(o.FMSynthesizer),n,s),console.log("CREATING FM SYNTH!!!"),o.fmSynthParamvals.modulationIndex=parseFloat(o.FMSynthParams[0]),o._logo.synth.createSynth(0,o.instrumentName,"fmsynth",o.fmSynthParamvals)}t+='<div id="wrapperS0"><div id="sS0"><span>'+_("modulation index")+'</span></div><div class="insideDivSynth"><input type="range" id="myRangeS0" class="sliders" style="margin-top:20px" value="'+parseFloat(o.FMSynthParams[0])+'"><span id="myspanS0" class="rangeslidervalue">'+o.FMSynthParams[0]+"</span></div></div>",r.innerHTML=t,o.fmSynthParamvals.modulationIndex=parseFloat(o.FMSynthParams[0]),1!==o.FMSynthesizer.length&&(a=o.FMSynthesizer.length-1),document.getElementById("wrapperS0").addEventListener("change",function(t){docById("synthButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;docById("myRangeS0").value=parseFloat(e.value),docById("myspanS0").textContent=e.value,o.fmSynthParamvals.modulationIndex=parseFloat(e.value),o._update(a,e.value,0),o._logo.synth.createSynth(0,o.instrumentName,"fmsynth",o.fmSynthParamvals),o._playNote("G4",1/8)})}else if("NoiseSynth"===n){if(o.isActive.amsynth=!1,o.isActive.fmsynth=!1,o.isActive.noisesynth=!0,o.isActive.duosynth=!1,0===o.NoiseSynthesizer.length){i=o._logo.blocks.blockList[o.blockNo].connections[2],s=o._logo.blocks.findBottomBlock(i);o._logo.blocks.loadNewBlocks([[0,["noisesynth",{}],0,0,[null,1,null]],[1,["number",{value:10}],0,0,[0]]]);l=o._logo.blocks.blockList.length-2;o.NoiseSynthesizer.push(l),o.NoiseSynthParams.push("white"),o._changeBlock(last(o.NoiseSynthesizer),n,s),console.log("CREATING NOISE SYNTH!!!"),o.noiseSynthParamvals["noise.type"]=o.NoiseSynthParams[0],o._logo.synth.createSynth(0,o.instrumentName,"noisesynth",o.noiseSynthParamvals)}t+='<div id="wrapperS0"><div id="sS0"><span>'+_("modulation index")+'</span></div><div class="insideDivSynth"><input type="range" id="myRangeS0" class="sliders" style="margin-top:20px" value="'+o.NoiseSynthParams[0]+'"><span id="myspanS0" class="rangeslidervalue">'+o.NoiseSynthParams[0]+"</span></div></div>",r.innerHTML=t,o.noiseSynthParamvals["noise.type"]=o.NoiseSynthParams[0],1!==o.NoiseSynthesizer.length&&(a=o.NoiseSynthesizer.length-1),document.getElementById("wrapperS0").addEventListener("change",function(t){docById("synthButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;docById("myRangeS0").value=parseFloat(e.value),docById("myspanS0").textContent=e.value,o.noiseSynthParamvals["noise.type"]=parseFloat(e.value),o._update(a,e.value,0),o._logo.synth.createSynth(0,o.instrumentName,"noisesynth",o.noiseSynthParamvals),o._playNote(1/8)})}else if("DuoSynth"===n){if(o.isActive.amsynth=!1,o.isActive.fmsynth=!1,o.isActive.duosynth=!0,0===o.duoSynthesizer.length){i=o._logo.blocks.blockList[o.blockNo].connections[2],s=o._logo.blocks.findBottomBlock(i);o._logo.blocks.loadNewBlocks([[0,["duosynth",{}],0,0,[null,1,2,null]],[1,["number",{value:10}],0,0,[0]],[2,["number",{value:6}],0,0,[0]]]);l=o._logo.blocks.blockList.length-3;o.duoSynthesizer.push(l),o.duoSynthParams.push(10),o.duoSynthParams.push(6),o._changeBlock(last(o.duoSynthesizer),n,s),console.log("CREATING DUO SYNTH!!!"),o.duoSynthParamVals.vibratoRate=parseFloat(o.duoSynthParams[0]),o.duoSynthParamVals.vibratoAmount=parseFloat(o.duoSynthParams[1]),o._logo.synth.createSynth(0,o.instrumentName,"duosynth",o.duoSynthParamVals)}t+='<div id="wrapperS0"><div id="sS0"><span>'+_("vibrato rate")+'</span></div><div class="insideDivSynth"><input type="range" id="myRangeS0" class="sliders" style="margin-top:20px" value="'+parseFloat(o.duoSynthParams[0])+'"><span id="myspanS0" class="rangeslidervalue">'+o.duoSynthParams[0]+"</span></div></div>",t+='<div id="wrapperS1"><div id="sS1"><span>'+_("vibrato amount")+'</span></div><div class="insideDivSynth"><input type="range" id="myRangeS1" class="sliders" style="margin-top:20px" value="'+parseFloat(o.duoSynthParams[1])+'"><span id="myspanS1" class="rangeslidervalue">'+o.duoSynthParams[1]+"</span></div></div>",r.innerHTML=t,1!==o.duoSynthesizer.length&&(a=o.duoSynthesizer.length-1),o.duoSynthParamVals.vibratoRate=parseFloat(o.duoSynthParams[0]),o.duoSynthParamVals.vibratoAmount=parseFloat(o.duoSynthParams[1]);for(e=0;e<2;e++)document.getElementById("wrapperS"+e).addEventListener("change",function(t){docById("synthButtonCell").style.backgroundColor="#C8C8C8";var e=t.target,i=e.id.slice(-1);docById("myRangeS"+i).value=parseFloat(e.value),0===i?o.duoSynthParamVals.vibratoRate=parseFloat(e.value):1===i&&(o.duoSynthParamVals.vibratoAmount=parseFloat(e.value)),docById("myspanS"+i).textContent=e.value,o._update(a,e.value,Number(i)),o._logo.synth.createSynth(0,o.instrumentName,"duosynth",o.duoSynthParamVals),o._playNote("G4",1/8)})}}},this._oscillator=function(t){var i=this,s=0;1!==this.osc.length&&(s=this.osc.length-1),docById("oscillatorButtonCell").style.backgroundColor="#C8C8C8",docById("oscillatorButtonCell").onmouseover=function(){},docById("oscillatorButtonCell").onmouseout=function(){},u.style.display="inline",u.style.visibility="visible",u.style.border="0px",u.style.overflow="auto",u.style.backgroundColor="white",u.style.height="300px",u.innerHTML='<div id="timbreTable"></div>';var e=docById("timbreTable"),l='<div id="wrapperOsc0"><div id="sOsc0"><span>'+_("type")+'</span></div><div id="selOsc"></div></div>';l+='<div id="wrapperOsc1"><div id="sOsc1"><span>'+_("partials")+'</span></div><div class="insideDivOsc"><input type="range" id="myRangeO0" class="sliders" style="margin-top:20px" min="0" max="20" value="'+parseFloat(i.oscParams[1])+'"><span id="myspanO0" class="rangeslidervalue">'+i.oscParams[1]+"</span></div></div>",e.innerHTML=l;var o=document.createElement("div");o.id="envAppend",o.style.backgroundColor=platformColor.selectorBackground,o.style.height="30px",o.style.marginTop="40px",o.style.overflow="auto",e.append(o);for(var a=docById("selOsc"),n='<select id="selOsc1">',r=0;r<OSCTYPES.length;r++)0===OSCTYPES[r][0].length?OSCTYPES[r][0]===this.oscParams[0]||OSCTYPES[r][1]===this.oscParams[0]?n+='<option value="'+OSCTYPES[r][1]+'" selected>'+OSCTYPES[r][1]+"</option>":n+='<option value="'+OSCTYPES[r][1]+'">'+OSCTYPES[r][1]+"</option>":OSCTYPES[r][0]===this.oscParams[0]||OSCTYPES[r][1]===this.oscParams[0]?n+='<option value="'+OSCTYPES[r][0]+'" selected>'+OSCTYPES[r][0]+"</option>":n+='<option value="'+OSCTYPES[r][0]+'">'+OSCTYPES[r][0]+"</option>";n+="</select>",a.innerHTML=n,document.getElementById("wrapperOsc0").addEventListener("change",function(t){docById("oscillatorButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;i.oscParams[0]=e.value,i.synthVals.oscillator.type=e.value+i.oscParams[1].toString(),i.synthVals.oscillator.source=e.value,i._update(s,e.value,0),i._logo.synth.createSynth(0,i.instrumentName,i.oscParams[0],i.synthVals),i._playNote("G4",1/8)}),document.getElementById("wrapperOsc1").addEventListener("change",function(t){docById("oscillatorButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;i.oscParams[1]=parseFloat(e.value),i.synthVals.oscillator.type=i.oscParams[0]+parseFloat(e.value),docById("myRangeO0").value=parseFloat(e.value),docById("myspanO0").textContent=e.value,i._update(s,e.value,1),i._logo.synth.createSynth(0,i.instrumentName,i.oscParams[0],i.synthVals),i._playNote("G4",1/8)}),docById("selOsc1").value=this.oscParams[0],this._update(s,this.oscParams[0],0),this._update(s,this.oscParams[1],1),this.synthVals.oscillator.type=this.oscParams[0]+this.oscParams[1].toString(),this.synthVals.oscillator.source=this.oscParams[0],t&&(console.log("CREATING OSCILLATOR SYNTH!!!"),this._logo.synth.createSynth(0,this.instrumentName,this.oscParams[0],this.synthVals))},this._envelope=function(t){var s=this,l=0;1!==this.env.length&&(l=this.env.length-1),docById("envelopeButtonCell").style.backgroundColor="#C8C8C8",docById("envelopeButtonCell").onmouseover=function(){},docById("envelopeButtonCell").onmouseout=function(){},u.style.display="inline",u.style.visibility="visible",u.style.border="0px",u.style.overflow="auto",u.style.backgroundColor="white",u.style.height="300px",u.innerHTML='<div id="timbreTable"></div>';for(var e=docById("timbreTable"),i="",o=0;o<4;o++)i+='<div id="wrapperEnv'+o+'"><div class="circle">'+"ADSR".charAt(o)+'</div><div class="insideDivEnv"><input type="range" id="myRange'+o+'" class="sliders" style="margin-top:20px" value="'+parseFloat(s.ENVs[o])+'"><span id="myspan'+o+'" class="rangeslidervalue">'+s.ENVs[o]+"</span></div></div>";e.innerHTML=i;var a=document.createElement("div");a.id="envAppend",a.style.backgroundColor=platformColor.selectorBackground,a.style.height="30px",a.style.marginTop="40px",a.style.overflow="auto",e.append(a);for(o=0;o<4;o++)this.synthVals.envelope[this.adsrMap[o]]=parseFloat(this.ENVs[o])/100,this._update(l,this.ENVs[o],o);for(o=0;o<4;o++)document.getElementById("wrapperEnv"+o).addEventListener("change",function(t){docById("envelopeButtonCell").style.backgroundColor="#C8C8C8";var e=t.target,i=e.id.slice(-1);docById("myRange"+i).value=parseFloat(e.value),docById("myspan"+i).textContent=e.value,s.synthVals.envelope[s.adsrMap[i]]=parseFloat(e.value)/100,s._update(l,parseFloat(e.value),i),s._logo.synth.createSynth(0,s.instrumentName,s.synthVals.oscillator.source,s.synthVals),s._playNote("G4",1/8)});t&&(console.log("CREATING ENVELOPE SYNTH!!!"),this._logo.synth.createSynth(0,this.instrumentName,this.synthVals.oscillator.source,this.synthVals))},this._filter=function(){docById("filterButtonCell").style.backgroundColor="#C8C8C8",docById("filterButtonCell").onmouseover=function(){},docById("filterButtonCell").onmouseout=function(){},u.style.display="inline",u.style.visibility="visible",u.style.border="0px",u.style.overflow="auto",u.style.backgroundColor="white",u.style.height="300px",u.innerHTML='<div id="timbreTable"></div>';var t=docById("timbreTable");t.innerHTML="";for(var e=0;e<this.fil.length;e++)this._createFilter(e,t);this._addFilterListeners(),this._updateFilters()},this._createFilter=function(t,e){console.log("adding filter "+t);var i=[3*t,3*t+1,3*t+2],s=[4*t,4*t+1,4*t+2,4*t+3];if(t%2==1)var l='<div class="rectangle"><p>&nbsp;</p>';else if(0<t)l="<div><p>&nbsp;</p>";else l="<div>";var o="selector"+t,a="sel"+t;l+='<div class="wrapper" id="wrapper'+i[0]+'"><div class="s" id="s'+i[0]+'"><span>'+_("type")+'</span></div><div class="filterselector" id="'+o+'"></div></div>',l+='<div class="wrapper" id="wrapper'+i[1]+'"><div class="s" id="s'+i[1]+'"><span>'+_("rolloff")+'</span></div><div class="insideDivFilter"><p><input id="radio'+s[0]+'" type="radio" name="rolloff'+t+'" value="-12" checked="checked"/>-12<input  id="radio'+s[1]+'" type="radio" name="rolloff'+t+'" value="-24"/>-24<input id="radio'+s[2]+'" type="radio" name="rolloff'+t+'" value="-48"/>-48<input id="radio'+s[3]+'" type="radio" name="rolloff'+t+'" value="-96"/>-96</p></div></div>',l+='<div class="wrapper" id="wrapper'+i[2]+'"><div class="s" id="s'+i[2]+'"><span>'+_("frequency")+'</span></div><div class="insideDivFilter"><input type="range" id="myRangeF'+t+'" class="sliders" style="margin-top:20px" max="7050" value="'+parseFloat(this.filterParams[3*t+2])+'"><span id="myspanF'+t+'" class="rangeslidervalue">'+this.filterParams[3*t+2]+"</span></div></div>",l+="</div>",e.innerHTML+=l;for(var n=docById(o),r='<select class="sel" id="'+a+'">',c=null,h=0;h<FILTERTYPES.length;h++)0===FILTERTYPES[h][0].length?FILTERTYPES[h][1]===this.filterParams[3*t]?(r+='<option value="'+FILTERTYPES[h][1]+'" selected>'+FILTERTYPES[h][1]+"</option>",c=FILTERTYPES[h][1]):r+='<option value="'+FILTERTYPES[h][1]+'">'+FILTERTYPES[h][1]+"</option>":FILTERTYPES[h][0]===this.filterParams[3*t]?(r+='<option value="'+FILTERTYPES[h][0]+'" selected>'+FILTERTYPES[h][0]+"</option>",c=FILTERTYPES[h][0]):r+='<option value="'+FILTERTYPES[h][0]+'">'+FILTERTYPES[h][0]+"</option>";r+="</select>",n.innerHTML=r,this.instrumentName in instrumentsFilters[0]||(instrumentsFilters[0][this.instrumentName]=[]),instrumentsFilters[0][this.instrumentName].length-1<t&&instrumentsFilters[0][this.instrumentName].push({filterType:c,filterRolloff:-12,filterFrequency:392})},this._addFilterListeners=function(){for(var s=this,t=0;t<this.fil.length;t++){var e=[4*t,4*t+1,4*t+2,4*t+3];docById("sel"+t).addEventListener("change",function(t){docById("filterButtonCell").style.backgroundColor="#C8C8C0";var e=t.target,i=e.id.slice(-1);instrumentsFilters[0][s.instrumentName][i].filterType=e.value,s._update(i,e.value,0),1<instrumentsFilters[0][s.instrumentName].filter(function(t){return t.filterType===e.value}).length&&s._logo.errorMsg(_("Filter already present.")),s._playNote("G4",1/8)});for(var i=0;i<e.length;i++){docById("radio"+e[i]).onclick=function(t){var e=t.target,i=Number(e.id.replace("radio",""));instrumentsFilters[0][s.instrumentName][Math.floor(i/4)].filterRolloff=parseFloat(this.value),s._update(Math.floor(i/4),this.value,1),s._playNote("G4",1/8)}}docById("myRangeF"+t).addEventListener("change",function(t){docById("filterButtonCell").style.backgroundColor="#C8C0C8";var e=t.target,i=e.id.slice(-1);docById("myRangeF"+i).value=parseFloat(e.value),docById("myspanF"+i).textContent=e.value,instrumentsFilters[0][s.instrumentName][i].filterFrequency=parseFloat(e.value),s._update(i,e.value,2),s._playNote("G4",1/8)})}},this._updateFilters=function(){for(var t=0;t<this.fil.length;t++){var e=[4*t,4*t+1,4*t+2,4*t+3];docById("sel"+t).value=instrumentsFilters[0][this.instrumentName][t].filterType;var i=instrumentsFilters[0][this.instrumentName][t].filterRolloff;docById("radio"+e[0]).checked=-12===i,docById("radio"+e[1]).checked=-24===i,docById("radio"+e[2]).checked=-48===i,docById("radio"+e[3]).checked=-96===i}},this._addFilter=function(){var t=docById("timbreTable"),e=this._logo.blocks.blockList[this.blockNo].connections[2],i=this._logo.blocks.findBottomBlock(e),s=[[0,["filter",{}],0,0,[null,3,1,2,null]],[1,["number",{value:-12}],0,0,[0]],[2,["number",{value:392}],0,0,[0]],[3,["filtertype",{value:DEFAULTFILTERTYPE}],0,0,[0]]];this._logo.blocks.loadNewBlocks(s);var l=this._logo.blocks.blockList.length-4,o=instrumentsFilters[0][this.instrumentName].slice(),a=FILTERTYPES.slice().filter(function(t){for(var e in o)if(o[e].filterType===t[1])return!1;return!0});this.fil.push(l),a.length<=0?this.filterParams.push(DEFAULTFILTERTYPE):this.filterParams.push(a[0][1]),this.filterParams.push(-12),this.filterParams.push(392);setTimeout(this.blockConnection(4,i),500),this._createFilter(this.fil.length-1,t),this._playNote("G4",1/8),this._addFilterListeners(),this._updateFilters()},this._effects=function(){var n=this,r=0;docById("effectsButtonCell").style.backgroundColor="#C8C8C8",docById("effectsButtonCell").onmouseover=function(){},docById("effectsButtonCell").onmouseout=function(){},u.style.display="inline",u.style.visibility="visible",u.style.border="0px",u.style.overflow="auto",u.style.backgroundColor="white",u.style.height="300px",u.innerHTML='<div id="timbreTable"></div>';for(var t=docById("timbreTable"),e="",i=0;i<2;i++)e+='<div id ="effect'+i+'"></div>';t.innerHTML=e;var s=document.createElement("div");s.id="envAppend",s.style.backgroundColor=platformColor.selectorBackground,s.style.height="30px",s.style.marginTop="40px",s.style.overflow="auto",t.append(s),docById("effect0").innerHTML='<p><input type="radio" name="effectsName" value="Tremolo"/>'+_("tremolo")+'</br><input type="radio" name="effectsName" value="Vibrato"/>'+_("vibrato")+'</br><input type="radio" name="effectsName" value="Chorus"/>'+_("chorus")+'</br><input type="radio" name="effectsName" value="Phaser"/>'+_("phaser")+'</br><input type="radio" name="effectsName" value="Distortion"/>'+_("distortion")+"</br></p>";var c,h=docById("effect1"),l=docByName("effectsName");for(i=0;i<l.length;i++)l[i].onclick=function(){var t='<div id="chosen">'+(c=this.value)+"</div>";if("Tremolo"===c){n.isActive.tremolo=!0,n.isActive.chorus=!1,n.isActive.vibrato=!1,n.isActive.distortion=!1,n.isActive.phaser=!1,instrumentsEffects[0][n.instrumentName].tremoloActive=!0;for(var e=0;e<2;e++)t+='<div id="wrapperFx'+e+'"><div id="sFx'+e+'"><span></span></div><div class="insideDivEffects"><input type="range" id="myRangeFx'+e+'" class="sliders" style="margin-top:20px" value="2"><span id="myspanFx'+e+'" class="rangeslidervalue">2</span></div></div>';if(h.innerHTML=t,docById("sFx0").textContent=_("rate"),docById("myRangeFx0").value=10,docById("myspanFx0").textContent="10",docById("sFx1").textContent=_("depth"),docById("myRangeFx1").value=50,docById("myspanFx1").textContent="50",0!==n.tremoloEffect.length){r=n.tremoloEffect.length-1;for(e=0;e<2;e++)docById("myRangeFx"+e).value=parseFloat(n.tremoloParams[e]),docById("myspanFx"+e).textContent=n.tremoloParams[e],n._update(r,n.tremoloParams[e],e)}if(0===n.tremoloEffect.length){var i=n._logo.blocks.blockList[n.blockNo].connections[2],s=n._logo.blocks.blockList.length;n._logo.blocks.loadNewBlocks([[0,["tremolo",{}],0,0,[null,1,2,null,3]],[1,["number",{value:10}],0,0,[0]],[2,["number",{value:50}],0,0,[0]],[3,"hidden",0,0,[0,null]]]),n.tremoloEffect.push(s),n.tremoloParams.push(10),n.tremoloParams.push(50),setTimeout(n.clampConnection(s,3,i),500)}for(e=0;e<2;e++)document.getElementById("wrapperFx"+e).addEventListener("change",function(t){docById("effectsButtonCell").style.backgroundColor="#C8C8C8";var e=t.target,i=e.id.slice(-1);docById("myRangeFx"+i).value=parseFloat(e.value),docById("myspanFx"+i).textContent=e.value,0===i&&(instrumentsEffects[0][n.instrumentName].tremoloFrequency=parseFloat(e.value)),1===i&&(instrumentsEffects[0][n.instrumentName].tremoloDepth=parseFloat(e.value)/100),n._update(r,e.value,Number(i)),n._playNote("G4",1/8)})}else if("Vibrato"===c){n.isActive.tremolo=!1,n.isActive.chorus=!1,n.isActive.vibrato=!0,n.isActive.distortion=!1,n.isActive.phaser=!1,instrumentsEffects[0][n.instrumentName].vibratoActive=!0;for(e=0;e<2;e++)t+='<div id="wrapperFx'+e+'"><div id="sFx'+e+'"><span></span></div><div class="insideDivEffects"><input type="range" id="myRangeFx'+e+'" class="sliders" style="margin-top:20px" max="25" value="2"><span id="myspanFx'+e+'" class="rangeslidervalue">2</span></div></div>';if(h.innerHTML=t,docById("sFx0").textContent=_("intensity"),docById("sFx1").textContent=_("rate"),0<n.vibratoEffect.length){last(n.vibratoEffect);docById("myRangeFx0").value=parseFloat(n.vibratoParams[0]),docById("myspanFx0").textContent=n.vibratoParams[0],docById("myRangeFx1").value=100/parseFloat(n.vibratoParams[1]);var l=rationalToFraction(1/parseFloat(n.vibratoParams[1]));docById("myspanFx1").textContent=l[0]+"/"+l[1]}else{var o=n._logo.blocks.blockList[n.blockNo].connections[2],a=n._logo.blocks.blockList.length;n._logo.blocks.loadNewBlocks([[0,["vibrato",{}],0,0,[null,1,3,2,6]],[1,["number",{value:5}],0,0,[0]],[2,["vspace",{}],0,0,[0,null]],[3,["divide",{}],0,0,[0,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:16}],0,0,[3]],[6,["hidden",{}],0,0,[0,null]]]),n.vibratoEffect.push(a),n.vibratoParams.push(5),n.vibratoParams.push(16),setTimeout(n.clampConnectionVspace(a,a+2,o),500),docById("myRangeFx0").value=5,docById("myspanFx0").textContent="5",instrumentsEffects[0][n.instrumentName].vibratoIntensity=.05,docById("myRangeFx1").value=6.25,docById("myspanFx1").textContent="1/16",instrumentsEffects[0][n.instrumentName].vibratoFrequency=1/16}document.getElementById("wrapperFx0").addEventListener("change",function(t){docById("effectsButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;docById("myRangeFx0").value=parseFloat(e.value),docById("myspanFx0").textContent=e.value,instrumentsEffects[0][n.instrumentName].vibratoIntensity=parseFloat(e.value)/100,n._update(n.vibratoEffect.length-1,e.value,0),n._playNote("G4",1/8)}),document.getElementById("wrapperFx1").addEventListener("change",function(t){docById("effectsButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;docById("myRangeFx1").value=parseFloat(e.value);var i=oneHundredToFraction(e.value);docById("myspanFx1").textContent=i[0]+"/"+i[1];var s=parseFloat(i[0])/parseFloat(i[1]);instrumentsEffects[0][n.instrumentName].vibratoFrequency=s,n._update(n.vibratoEffect.length-1,i[1],1),n._update(n.vibratoEffect.length-1,i[0],2),n._playNote("G4",1/8)})}else if("Chorus"===c){n.isActive.tremolo=!1,n.isActive.chorus=!0,n.isActive.vibrato=!1,n.isActive.distortion=!1,n.isActive.phaser=!1,instrumentsEffects[0][n.instrumentName].chorusActive=!0;for(e=0;e<3;e++)t+='<div id="wrapperFx'+e+'"><div id="sFx'+e+'"><span></span></div><div class="insideDivEffects"><input type="range" id="myRangeFx'+e+'" class="sliders" style="margin-top:20px" value="2"><span id="myspanFx'+e+'" class="rangeslidervalue">2</span></div></div>';if(h.innerHTML=t,docById("sFx0").textContent=_("rate"),docById("myRangeFx0").value=2,docById("myspanFx0").textContent="2",docById("sFx1").textContent=_("delay (MS)"),docById("myRangeFx1").value=4,docById("myspanFx1").textContent="4",docById("sFx2").textContent=_("depth"),docById("myRangeFx2").value=70,docById("myspanFx2").textContent="70",0!==n.chorusEffect.length){r=n.chorusEffect.length-1;for(e=0;e<3;e++)docById("myRangeFx"+e).value=parseFloat(n.chorusParams[e]),docById("myspanFx"+e).textContent=n.chorusParams[e],n._update(r,n.chorusParams[e],e)}if(0===n.chorusEffect.length){i=n._logo.blocks.blockList[n.blockNo].connections[2],s=n._logo.blocks.blockList.length;n._logo.blocks.loadNewBlocks([[0,["chorus",{}],0,0,[null,1,2,3,null,4]],[1,["number",{value:2}],0,0,[0]],[2,["number",{value:4}],0,0,[0]],[3,["number",{value:70}],0,0,[0]],[4,"hidden",0,0,[0,null]]]),n.chorusEffect.push(s),n.chorusParams.push(2),n.chorusParams.push(4),n.chorusParams.push(70),setTimeout(n.clampConnection(s,4,i),500)}for(e=0;e<3;e++)document.getElementById("wrapperFx"+e).addEventListener("change",function(t){docById("effectsButtonCell").style.backgroundColor="#C8C8C8";var e=t.target,i=e.id.slice(-1);docById("myRangeFx"+i).value=parseFloat(e.value),docById("myspanFx"+i).textContent=e.value,0===i&&(instrumentsEffects[0][n.instrumentName].chorusRate=parseFloat(e.value)),1===i&&(instrumentsEffects[0][n.instrumentName].delayTime=parseFloat(e.value)),2===i&&(instrumentsEffects[0][n.instrumentName].chorusDepth=parseFloat(e.value)/100),n._update(r,e.value,Number(i)),n._playNote("G4",1/8)})}else if("Phaser"===c){n.isActive.tremolo=!1,n.isActive.chorus=!1,n.isActive.vibrato=!1,n.isActive.distortion=!1,n.isActive.phaser=!0,instrumentsEffects[0][n.instrumentName].phaserActive=!0;for(e=0;e<3;e++)t+='<div id="wrapperFx'+e+'"><div id="sFx'+e+'"><span></span></div><div class="insideDivEffects"><input type="range" id="myRangeFx'+e+'" class="sliders" style="margin-top:20px" value="2"><span id="myspanFx'+e+'" class="rangeslidervalue">2</span></div></div>';if(h.innerHTML=t,docById("sFx0").textContent=_("rate"),docById("myRangeFx0").value=5,docById("myspanFx0").textContent="5",docById("sFx1").textContent=_("octaves"),docById("myRangeFx1").value=3,docById("myspanFx1").textContent="3",docById("sFx2").textContent=_("base frequency"),docById("myRangeFx2").value=350,docById("myspanFx2").textContent="350",0!==n.phaserEffect.length){r=n.phaserEffect.length-1;for(e=0;e<3;e++)docById("myRangeFx"+e).value=parseFloat(n.phaserParams[e]),docById("myspanFx"+e).textContent=n.phaserParams[e],n._update(r,n.phaserParams[e],e)}if(0===n.phaserEffect.length){i=n._logo.blocks.blockList[n.blockNo].connections[2],s=n._logo.blocks.blockList.length;n._logo.blocks.loadNewBlocks([[0,["phaser",{}],0,0,[null,1,2,3,null,4]],[1,["number",{value:5}],0,0,[0]],[2,["number",{value:3}],0,0,[0]],[3,["number",{value:350}],0,0,[0]],[4,"hidden",0,0,[0,null]]]),n.phaserEffect.push(s),n.phaserParams.push(5),n.phaserParams.push(3),n.phaserParams.push(350),setTimeout(n.clampConnection(s,4,i),500)}for(e=0;e<3;e++)document.getElementById("wrapperFx"+e).addEventListener("change",function(t){docById("effectsButtonCell").style.backgroundColor="#C8C8C8";var e=t.target,i=e.id.slice(-1);docById("myRangeFx"+i).value=parseFloat(e.value),docById("myspanFx"+i).textContent=e.value,0===i&&(instrumentsEffects[0][n.instrumentName].rate=parseFloat(e.value)),1===i&&(instrumentsEffects[0][n.instrumentName].octaves=parseFloat(e.value)),2===i&&(instrumentsEffects[0][n.instrumentName].baseFrequency=parseFloat(e.value)),n._update(r,e.value,Number(i)),n._playNote("G4",1/8)})}else if("Distortion"===c){if(n.isActive.tremolo=!1,n.isActive.chorus=!1,n.isActive.vibrato=!1,n.isActive.distortion=!0,n.isActive.phaser=!1,instrumentsEffects[0][n.instrumentName].distortionActive=!0,t+='<div id="wrapperFx0"><div id="sFx0"><span></span></div><div class="insideDivEffects"><input type="range" id="myRangeFx0" class="sliders" style="margin-top:20px" value="2"><span id="myspanFx0" class="rangeslidervalue">2</span></div></div>',h.innerHTML=t,docById("sFx0").textContent=_("distortion amount"),docById("myRangeFx0").value=40,docById("myspanFx0").textContent="40",0!==n.distortionEffect.length&&(r=n.distortionEffect.length-1,docById("myRangeFx0").value=parseFloat(n.distortionParams[0]),docById("myspanFx0").textContent=n.distortionParams[0],n._update(r,n.distortionParams[0],0)),0===n.distortionEffect.length){i=n._logo.blocks.blockList[n.blockNo].connections[2],s=n._logo.blocks.blockList.length;n._logo.blocks.loadNewBlocks([[0,["dis",{}],0,0,[null,1,null,2]],[1,["number",{value:40}],0,0,[0]],[2,"hidden",0,0,[0,null]]]),n.distortionEffect.push(s),n.distortionParams.push(40),setTimeout(n.clampConnection(s,2,i),500)}document.getElementById("wrapperFx0").addEventListener("change",function(t){docById("effectsButtonCell").style.backgroundColor="#C8C8C8";var e=t.target;e.id.slice(-1);docById("myRangeFx0").value=parseFloat(e.value),docById("myspanFx0").textContent=e.value,instrumentsEffects[0][n.instrumentName].distortionAmount=parseFloat(e.value)/100,n._update(r,e.value,0),n._playNote("G4",1/8)})}}}}
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}var JSInterface=function(){function w(){_classCallCheck(this,w),_defineProperty(this,"_methodArgConstraints",{playNote:[{type:"number",constraints:{min:0,max:1e3,integer:!1}},{type:"function",constraints:{async:!0}}],playNoteMillis:[{type:"number",constraints:{min:0,max:1e5,integer:!1}},{type:"function",constraints:{async:!0}}],dot:[{type:"number",constraints:{min:0,max:10,integer:!0}},{type:"function",constraints:{async:!0}}],tie:[{type:"function",constraints:{async:!0}}],multiplyNoteValue:[{type:"number",constraints:{min:0,max:1e3,integer:!1}},{type:"function",constraints:{async:!0}}],swing:[{type:"number",constraints:{min:0,max:1e3,integer:!1}},{type:"number",constraints:{min:0,max:1e3,integer:!1}},{type:"function",constraints:{async:!0}}],setMeter:[{type:"number",constraints:{min:1,max:16,integer:!0}},{type:"number",constraints:{min:0,max:1e3,integer:!1}}],PICKUP:[{type:"number",constraints:{min:0,max:1e3,integer:!1}}],setBPM:[{type:"number",constraints:{min:40,max:208,integer:!0}},{type:"number",constraints:{min:0,max:10,integer:!1}}],setMasterBPM:[{type:"number",constraints:{min:40,max:208,integer:!0}},{type:"number",constraints:{min:0,max:10,integer:!1}}],onEveryNoteDo:[{type:"string",constraints:{type:"any"}}],onEveryBeatDo:[{type:"string",constraints:{type:"any"}}],onStrongBeatDo:[{type:"number",constraints:{min:1,max:16,integer:!0}},{type:"string",constraints:{type:"any"}}],onWeakBeatDo:[{type:"string",constraints:{type:"any"}}],setNoClock:[{type:"function",constraints:{async:!0}}],getNotesPlayed:[{type:"number",constraints:{min:0,max:1e3,integer:!1}}],playPitch:[{type:"string",constraints:{type:"solfegeorletter"}},{type:"number",constraints:{min:1,max:8,integer:!0}}],stepPitch:[{type:"number",constraints:{min:-7,max:7,integer:!0}}],playNthModalPitch:[{type:"number",constraints:{min:-7,max:7,integer:!0}},{type:"number",constraints:{min:1,max:8,integer:!0}}],playPitchNumber:[{type:"number",constraints:{min:-3,max:12,integer:!0}}],playHertz:[{type:"number",constraints:{min:20,max:2e4,integer:!1}}],setAccidental:[{type:"string",constraints:{type:"accidental"}},{type:"function",constraints:{async:!0}}],setScalarTranspose:[{type:"number",constraints:{min:-10,max:10,integer:!0}},{type:"function",constraints:{async:!0}}],setSemitoneTranspose:[{type:"number",constraints:{min:-10,max:10,integer:!0}},{type:"function",constraints:{async:!0}}],setRegister:[{type:"number",constraints:{min:-3,max:3,integer:!0}}],invert:[{type:"string",constraints:{type:"solfegeorletter"}},{type:"number",constraints:{min:1,max:8,integer:!0}},{type:"string",constraints:{type:"oneof",values:["even","odd","scalar"],defaultIndex:0}}],setPitchNumberOffset:[{type:"string",constraints:{type:"solfegeorletter"}},{type:"number",constraints:{min:1,max:8,integer:!0}}],numToPitch:[{type:"number",constraints:{min:0,max:100,integer:!0}}],numToOctave:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setKey:[{type:"string",constraints:{type:"letterkey"}},{type:"string",constraints:{type:"oneof",values:["major","ionian","dorian","phrygian","lydian","myxolydian","minor","aeolian"],defaultIndex:0}}],MOVABLEDO:[{type:"boolean"}],setScalarInterval:[{type:"number",constraints:{min:-7,max:7,integer:!0}},{type:"function",constraints:{async:!0}}],setSemitoneInterval:[{type:"number",constraints:{min:-12,max:12,integer:!0}},{type:"function",constraints:{async:!0}}],setTemperament:[{type:"string",constraints:{type:"oneof",values:["equal","just intonation","Pythagorean","1/3 comma meantone","1/4 comma meantone"],defaultIndex:0}},{type:"string",constraints:{type:"solfegeorletter"}},{type:"number",constraints:{min:0,max:10,integer:!0}}],setInstrument:[{type:"string",constraints:{type:"synth"}},{type:"function",constraints:{async:!0}}],doVibrato:[{type:"number",constraints:{min:0,max:10,integer:!1}},{type:"number",constraints:{min:0,max:10,integer:!1}},{type:"function",constraints:{async:!0}}],doChorus:[{type:"number",constraints:{min:0,max:10,integer:!1}},{type:"number",constraints:{min:0,max:10,integer:!1}},{type:"number",constraints:{min:0,max:100,integer:!1}},{type:"function",constraints:{async:!0}}],doPhaser:[{type:"number",constraints:{min:0,max:20,integer:!1}},{type:"number",constraints:{min:0,max:3,integer:!0}},{type:"number",constraints:{min:20,max:2e4,integer:!1}},{type:"function",constraints:{async:!0}}],doTremolo:[{type:"number",constraints:{min:0,max:20,integer:!1}},{type:"number",constraints:{min:0,max:100,integer:!0}},{type:"function",constraints:{async:!0}}],doDistortion:[{type:"number",constraints:{min:0,max:100,integer:!0}},{type:"function",constraints:{async:!0}}],doHarmonic:[{type:"number",constraints:{min:0,max:11,integer:!0}},{type:"function",constraints:{async:!0}}],setStaccato:[{type:"number",constraints:{min:0,max:1e3,integer:!1}},{type:"function",constraints:{async:!0}}],setSlur:[{type:"number",constraints:{min:0,max:1e3,integer:!1}},{type:"function",constraints:{async:!0}}],doNeighbor:[{type:"number",constraints:{min:-7,max:7,integer:!0}},{type:"number",constraints:{min:0,max:1e3,integer:!1}},{type:"function",constraints:{async:!0}}],doCrescendo:[{type:"number",constraints:{min:0,max:100,integer:!1}},{type:"function",constraints:{async:!0}}],doDecrescendo:[{type:"number",constraints:{min:0,max:100,integer:!1}},{type:"function",constraints:{async:!0}}],PANNING:[{type:"number",constraints:{min:-100,max:100,integer:!0}}],MASTERVOLUME:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setRelativeVolume:[{type:"number",constraints:{min:-50,max:50,integer:!1}},{type:"function",constraints:{async:!0}}],setSynthVolume:[{type:"string",constraints:{type:"synth"}},{type:"number",constraints:{min:0,max:100,integer:!1}}],getSynthVolume:[{type:"string",constraints:{type:"synth"}}],playDrum:[{type:"string",constraints:{type:"drum"}}],setDrum:[{type:"string",constraints:{type:"drum"}},{type:"function",constraints:{async:!0}}],mapPitchToDrum:[{type:"string",constraints:{type:"drum"}},{type:"function",constraints:{async:!0}}],playNoise:[{type:"string",constraints:{type:"noise"}}],goForward:[{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}}],goBackward:[{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}}],turnRight:[{type:"number",constraints:{min:-360,max:360,integer:!1}}],turnLeft:[{type:"number",constraints:{min:-360,max:360,integer:!1}}],setXY:[{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}},{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}}],setHeading:[{type:"number",constraints:{min:-360,max:360,integer:!1}}],drawArc:[{type:"number",constraints:{min:-360,max:360,integer:!1}},{type:"number",constraints:{min:0,max:1e5,integer:!1}}],drawBezier:[{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}},{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}}],setBezierControlPoint1:[{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}},{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}}],scrollXY:[{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}},{type:"number",constraints:{min:-1e5,max:1e5,integer:!1}}],setColor:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setGrey:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setShade:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setHue:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setTranslucency:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setPensize:[{type:"number",constraints:{min:0,max:100,integer:!0}}],setValue:[[{type:"string",constraints:{type:"any"}},{type:"number",constraints:{min:-1e3,max:1e3,integer:!0}}],[{type:"string",constraints:{type:"any"}},{type:"number",constraints:{min:-1e3,max:1e3,integer:!0}}],[{type:"string",constraints:{type:"any"}},{type:"undefined"}]],getValue:[[{type:"string",constraints:{type:"any"}},{type:"number",constraints:{min:-1e3,max:1e3,integer:!0}}],[{type:"string",constraints:{type:"any"}},{type:"undefined"}]],getDict:[[{type:"string",constraints:{type:"any"}},{type:"undefined"}]],showDict:[[{type:"string",constraints:{type:"any"}},{type:"undefined"}]]})}return _createClass(w,null,[{key:"isClampBlock",value:function(e){return w._clampBlocks.includes(e)}},{key:"isSetter",value:function(e){return e in w._setterNameLookup}},{key:"isGetter",value:function(e){return e in w._getterNameLookup}},{key:"isMethod",value:function(e){return e in w._methodNameLookup}},{key:"methodReturns",value:function(e){return w._returningMethods.includes(e)}},{key:"getSetterName",value:function(e){return w.isSetter(e)?w._setterNameLookup[e]:null}},{key:"getGetterName",value:function(e){return w.isGetter(e)?w._getterNameLookup[e]:null}},{key:"getMethodName",value:function(e){return w.isMethod(e)?w._methodNameLookup[e]:null}},{key:"rearrangeMethodArgs",value:function(e,t){return e in w._rearrangeArgsLookup&&(t=w._rearrangeArgsLookup[e].map(function(e){return t[e]})),t}},{key:"validateArgs",value:function(e,t){if(!(e in w._methodArgConstraints))return t;var n=w._methodArgConstraints[e],r=[];for(var o in n){var i,a,s,c=[t[o],n[o]],m=c[0],u=c[1];if(Array.isArray(u)){var y,p=_createForOfIteratorHelper(u);try{for(p.s();!(y=p.n()).done;){var l=y.value;if(_typeof(m)===l.type){u=l;break}}}catch(e){p.e(e)}finally{p.f()}if(Array.isArray(u)){var d='TypeMismatch error: expected one of "'.concat(u.map(function(e){return e.type}).toString(),'" but found "').concat(_typeof(m),'"');throw JSEditor.logConsole(d,"maroon"),d}}if(_typeof(m)!==u.type)if("string"==typeof m&&"number"===u.type){if(isNaN(Number(m))){var g='TypeMismatch error: expected "number" but found "string"';throw JSEditor.logConsole(g,"maroon"),g}m=Number(m)}else{if("string"!=typeof m||"boolean"!==u.type){var f='TypeMismatch error: expected "'.concat(u.type,'" but found "').concat(_typeof(m),'"');throw JSEditor.logConsole(f,"maroon"),f}m="true"===m.toLowerCase()||"false"!==m.toLowerCase()&&(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ',!0)),!0)}switch(u.type){case"number":m<u.constraints.min?(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ').concat(u.constraints.min)),m=u.constraints.min):m>u.constraints.max&&(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ').concat(u.constraints.max)),m=u.constraints.max),u.constraints.integer&&!Number.isInteger(m)&&(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ').concat(Math.floor(m))),m=Math.floor(m));break;case"function":if(u.constraints.async&&"AsyncFunction"!==m[Symbol.toStringTag]){var b="".concat(t[0],' error: expected "async" function');throw JSEditor.logConsole(b,"maroon"),b}break;case"string":if("solfegeorletter"===u.constraints.type){var h,x,v=m.split(" "),A=["do","re","mi","fa","sol","la","ti"];A.includes(v[0].toLowerCase())||["c","d","e","f","g","a","b"].includes(v[0].toLowerCase())?(m=A.includes(v[0].toLowerCase())?v[0].toLowerCase():v[0].toUpperCase(),1<v.length&&(h=[SHARP,FLAT,NATURAL,DOUBLESHARP,DOUBLEFLAT],x={sharp:SHARP,flat:FLAT,doublesharp:DOUBLESHARP,doubleflat:DOUBLEFLAT},h.includes(v[1])?m+=v[1]:v[1].toLowerCase()in x&&(m+=x[v[1].toLowerCase()]))):(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ',"sol")),m="sol")}else if("accidental"===u.constraints.type){var S=["sharp ".concat(SHARP),"flat ".concat(FLAT),"natural ".concat(NATURAL),"double sharp ".concat(DOUBLESHARP),"double flat ".concat(DOUBLEFLAT)],C=[SHARP,FLAT,NATURAL,DOUBLESHARP,DOUBLEFLAT],L=["sharp","flat","natural","doublesharp","doubleflat"];C.includes(m)?m=S[C.indexOf(m)]:L.includes(m.toLowerCase())&&(m=S[L.indexOf(m.toLowerCase())])}else if("oneof"===u.constraints.type){var P=-1;for(var E in u.constraints.values)if(u.constraints.values[E].toLowerCase()===m.toLowerCase()){P=E;break}m=-1!==P?u.constraints.values[P]:(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ').concat(u.constraints.values[u.constraints.defaultIndex])),u.constraints.values[u.constraints.defaultIndex])}else{"synth"===u.constraints.type?m=["piano","harmonuium","mandolin","violin","viola","cello","bass","double bass","sitar","guitar","acoustic guitar","flute","clarinet","saxophone","tuba","trumpet","oboe","trombone","banjo","koto","dulcimer","electric guitar","bassoon","celeste","xylophone","electronic synth","sine","square","sawtooth","triangle","vibraphone"].includes(m)?m.toLowerCase():(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ').concat(DEFAULTVOICE)),DEFAULTVOICE):"drum"===u.constraints.type?m=["snare drum","kick drum","tom tom","floor tom tom","cup drum","darbuka drum","japanese drum","hi hat","ride bell","cow bell","triangle bell","finger cymbals","chime","gong","clang","crash","clap","slap","raindrop"].includes(m)?m.toLowerCase():(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ',"kick drum")),"kick drum"):"noise"===u.constraints.type?m="white noise"===m.toLowerCase()?"noise1":"brown noise"===m.toLowerCase()?"noise2":"pink noise"===m.toLowerCase()?"noise3":(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ',"white noise")),"noise1"):"letterkey"===u.constraints.type&&(i=m.split(" "),["c","d","e","f","g","a","b"].includes(i[0].toLowerCase())?(m=i[0].toUpperCase(),1<i.length&&(a=[SHARP,FLAT,NATURAL,DOUBLESHARP,DOUBLEFLAT],s={sharp:SHARP,flat:FLAT,doublesharp:DOUBLESHARP,doubleflat:DOUBLEFLAT},a.includes(i[1])?m+=i[1]:i[1].toLowerCase()in s&&(m+=s[i[1].toLowerCase()]))):(JSEditor.logConsole("".concat(m,' in "').concat(e,'" reset to ',"C")),m="C"))}}r.push(m)}return r}}]),w}();_defineProperty(JSInterface,"_clampBlocks",["newnote","osctime","rhythmicdot2","tie","multiplybeatfactor","newswing2","drift","accidental","setscalartransposition","settransposition","invert1","definemode","interval","semitoneinterval","settimbre","vibrato","chorus","phaser","tremolo","dis","harmonic2","newstaccato","newslur","neighbor2","crescendo","decrescendo","articulation","setdrum","mapdrum"]),_defineProperty(JSInterface,"_returningMethods",["getDict","getDict2","dictionary"]),_defineProperty(JSInterface,"_setterNameLookup",{pickup:"PICKUP",moveble:"MOVABLE",setnotevolume:"MASTERVOLUME",setpanning:"PANNING"}),_defineProperty(JSInterface,"_getterNameLookup",{mynotevalue:"NOTEVALUE",elapsednotes:"WHOLENOTESPLAYED",beatvalue:"BEATCOUNT",measurevalue:"MEASURECOUNT",bpmfactor:"BPM",beatfactor:"BEATFACTOR",currentmeter:"CURRENTMETER",deltapitch2:"SCALARCHANGEINPITCH",deltapitch:"CHANGEINPITCH",consonantstepsizeup:"SCALARSTEPUP",consonantstepsizedown:"SCALARSTEPDOWN",key:"CURRENTKEY",currentmode:"CURRENTMODE",modelength:"MODELENGTH",notevolumefactor:"MASTERVOLUME",x:"X",y:"Y",heading:"HEADING",pensize:"PENSIZE",color:"COLOR",shade:"SHADE",grey:"GREY"}),_defineProperty(JSInterface,"_methodNameLookup",{newnote:"playNote",osctime:"playNoteMillis",rest2:"playRest",rhythmicdot2:"dot",tie:"tie",multiplybeatfactor:"multiplyNoteValue",newswing2:"swing",meter:"setMeter",setbpm3:"setBPM",setmasterbpm2:"setMasterBPM",everybeatdo:"onEveryNoteDo",everybeatdonew:"onEveryBeatDo",onbeatdo:"onStrongBeatDo",offbeatdo:"onWeakBeatDo",drift:"setNoClock",elapsednotes2:"getNotesPlayed",pitch:"playPitch",steppitch:"stepPitch",nthmodalpitch:"playNthModalPitch",pitchnumber:"playPitchNumber",hertz:"playHertz",accidental:"setAccidental",setscalartransposition:"setScalarTranspose",settransposition:"setSemitoneTranspose",register:"setRegister",invert1:"invert",setpitchnumberoffset:"setPitchNumberOffset",number2pitch:"numToPitch",number2octave:"numToOctave",setkey2:"setKey",interval:"setScalarInterval",semitoneinterval:"setSemitoneInterval",settemperament:"setTemperament",settimbre:"setInstrument",vibrato:"doVibrato",chorus:"doChorus",phaser:"doPhaser",tremolo:"doTremolo",dis:"doDistortion",harmonic2:"doHarmonic",newstaccato:"setStaccato",newslur:"setSlur",neighbor2:"doNeighbor",crescendo:"doCrescendo",decrescendo:"doDecrescendo",articulation:"setRelativeVolume",setsynthvolume:"setSynthVolume",synthvolumefactor:"getSynthVolume",playdrum:"playDrum",setdrum:"setDrum",mapdrum:"mapPitchToDrum",playnoise:"playNoise",random:"MathUtility.doRandom",oneOf:"MathUtility.doOneOf",distance:"MathUtility.doCalculateDistance",forward:"goForward",back:"goBackward",right:"turnRight",left:"turnLeft",setxy:"setXY",setheading:"setHeading",arc:"drawArc",bezier:"drawBezier",controlpoint1:"setBezierControlPoint1",controlpoint2:"setBezierControlPoint2",clear:"clear",scrollxy:"scrollXY",setcolor:"setColor",setgrey:"setGrey",setshade:"setShade",sethue:"setHue",settranslucency:"setTranslucency",setpensize:"setPensize",penup:"penUp",pendown:"penDown",background:"fillBackground",setfont:"setFont",dictionary:"getDict",setDict:"setValue",getDict:"getValue",setDict2:"setValue",getDict2:"getValue",print:"print"}),_defineProperty(JSInterface,"_rearrangeArgsLookup",{setDict:[1,2,0],getDict:[1,0]}),"undefined"!=typeof module&&module.exports&&(module.exports=JSInterface);
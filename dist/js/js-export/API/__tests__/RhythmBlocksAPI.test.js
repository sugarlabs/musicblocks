"use strict";function asyncGeneratorStep(e,t,r,n,a,o,c){try{var s=e[o](c),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(s){return function(){var e=this,c=arguments;return new Promise(function(t,r){var n=s.apply(e,c);function a(e){asyncGeneratorStep(n,t,r,a,o,"next",e)}function o(e){asyncGeneratorStep(n,t,r,a,o,"throw",e)}a(void 0)})}}var JSInterface={validateArgs:jest.fn()};global.JSInterface=JSInterface,global.MusicBlocks={BLK:"mockBLK"};var RhythmBlocksAPI=require("../RhythmBlocksAPI");describe("RhythmBlocksAPI",function(){var n;beforeEach(function(){(n=new RhythmBlocksAPI).turIndex=0,n.runCommand=jest.fn(),n.ENDFLOWCOMMAND="END"}),afterEach(function(){jest.clearAllMocks()}),test("playNote calls runCommand with correct arguments",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=jest.fn(),JSInterface.validateArgs.mockReturnValue([100,t]),e.next=4,n.playNote(100,t);case 4:r=e.sent,expect(JSInterface.validateArgs).toHaveBeenCalledWith("playNote",[100,t]),expect(n.runCommand).toHaveBeenCalledWith("playNote",[100,"newnote",0,"mockBLK"]),expect(t).toHaveBeenCalled(),expect(r).toBe("END");case 9:case"end":return e.stop()}},e)}))),test("playNoteMillis calls runCommand with correct arguments",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=jest.fn(),JSInterface.validateArgs.mockReturnValue([1e3,t]),e.next=4,n.playNoteMillis(1e3,t);case 4:r=e.sent,expect(JSInterface.validateArgs).toHaveBeenCalledWith("playNoteMillis",[1e3,t]),expect(n.runCommand).toHaveBeenCalledWith("playNote",[1e3,"osctime",0,"mockBLK"]),expect(t).toHaveBeenCalled(),expect(r).toBe("END");case 9:case"end":return e.stop()}},e)}))),test("playRest calls runCommand with correct arguments",function(){n.playRest(),expect(n.runCommand).toHaveBeenCalledWith("playRest",[0])}),test("dot calls runCommand with correct arguments",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=jest.fn(),JSInterface.validateArgs.mockReturnValue([1,t]),e.next=4,n.dot(1,t);case 4:r=e.sent,expect(JSInterface.validateArgs).toHaveBeenCalledWith("dot",[1,t]),expect(n.runCommand).toHaveBeenCalledWith("doRhythmicDot",[1,0]),expect(t).toHaveBeenCalled(),expect(r).toBe("END");case 9:case"end":return e.stop()}},e)}))),test("tie calls runCommand with correct arguments",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=jest.fn(),JSInterface.validateArgs.mockReturnValue([void 0,t]),e.next=4,n.tie(t);case 4:r=e.sent,expect(JSInterface.validateArgs).toHaveBeenCalledWith("tie",[t]),expect(n.runCommand).toHaveBeenCalledWith("doTie",[0]),expect(t).toHaveBeenCalled(),expect(r).toBe("END");case 9:case"end":return e.stop()}},e)}))),test("multiplyNoteValue calls runCommand with correct arguments",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=jest.fn(),JSInterface.validateArgs.mockReturnValue([2,t]),e.next=4,n.multiplyNoteValue(2,t);case 4:r=e.sent,expect(JSInterface.validateArgs).toHaveBeenCalledWith("multiplyNoteValue",[2,t]),expect(n.runCommand).toHaveBeenCalledWith("multiplyNoteValue",[2,0]),expect(t).toHaveBeenCalled(),expect(r).toBe("END");case 9:case"end":return e.stop()}},e)}))),test("swing calls runCommand with correct arguments",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=jest.fn(),JSInterface.validateArgs.mockReturnValue([1,4,t]),e.next=4,n.swing(1,4,t);case 4:r=e.sent,expect(JSInterface.validateArgs).toHaveBeenCalledWith("multiplyNoteValue",[1,4,t]),expect(n.runCommand).toHaveBeenCalledWith("addSwing",[1,4,0]),expect(t).toHaveBeenCalled(),expect(r).toBe("END");case 9:case"end":return e.stop()}},e)}))),test("methods handle validation errors correctly",_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return JSInterface.validateArgs.mockImplementation(function(){throw new Error("Invalid arguments")}),e.next=3,expect(n.playNote()).rejects.toThrow("Invalid arguments");case 3:return e.next=5,expect(n.playNoteMillis()).rejects.toThrow("Invalid arguments");case 5:return e.next=7,expect(n.dot()).rejects.toThrow("Invalid arguments");case 7:return e.next=9,expect(n.tie()).rejects.toThrow("Invalid arguments");case 9:return e.next=11,expect(n.multiplyNoteValue()).rejects.toThrow("Invalid arguments");case 11:return e.next=13,expect(n.swing()).rejects.toThrow("Invalid arguments");case 13:case"end":return e.stop()}},e)}))),test("methods handle command execution errors correctly",_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return JSInterface.validateArgs.mockReturnValue([1,jest.fn()]),n.runCommand.mockRejectedValue(new Error("Command failed")),e.next=4,expect(n.playNote(1,jest.fn())).rejects.toThrow("Command failed");case 4:return e.next=6,expect(n.playNoteMillis(1,jest.fn())).rejects.toThrow("Command failed");case 6:return e.next=8,expect(n.playRest()).rejects.toThrow("Command failed");case 8:return e.next=10,expect(n.dot(1,jest.fn())).rejects.toThrow("Command failed");case 10:return e.next=12,expect(n.tie(jest.fn())).rejects.toThrow("Command failed");case 12:return e.next=14,expect(n.multiplyNoteValue(2,jest.fn())).rejects.toThrow("Command failed");case 14:return e.next=16,expect(n.swing(1,4,jest.fn())).rejects.toThrow("Command failed");case 16:case"end":return e.stop()}},e)})))});
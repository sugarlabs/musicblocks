"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var SYNTHSVG='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" y="0px" xml:space="preserve" x="0px" width="SVGWIDTHpx" viewBox="0 0 SVGWIDTH 55" version="1.1" height="55px" enable-background="new 0 0 SVGWIDTH 55"><g transform="scale(XSCALE,1)"><path d="m 1.5,27.5 c 0,0 2.2,-17.5 6.875,-17.5 4.7,0.0 6.25,11.75 6.875,17.5 0.75,6.67 2.3,17.5 6.875,17.5 4.1,0.0 6.25,-13.6 6.875,-17.5 C 29.875,22.65 31.1,10 35.875,10 c 4.1,0.0 5.97,13.0 6.875,17.5 1.15,5.7 1.75,17.5 6.875,17.5 4.65,0.0 6.875,-17.5 6.875,-17.5" style="stroke:#90c100;fill-opacity:1;fill:none;stroke-width:STROKEWIDTHpx;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /></g></svg>',WHOLENOTE='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="svg6468" viewBox="0 0 5.1680003 12.432" height="12.432" width="5.1680002"> <g transform="translate(-375.23523,-454.37592)"> <g transform="translate(7.9606,5.6125499)" style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 369.80263,457.99537 q 1.104,0 1.872,0.432 0.768,0.416 0.768,1.2 0,0.752 -0.752,1.168 -0.752,0.4 -1.808,0.4 -1.104,0 -1.856,-0.416 -0.752,-0.416 -0.752,-1.232 0,-0.576 0.464,-0.944 0.48,-0.368 1.008,-0.48 0.528,-0.128 1.056,-0.128 z m -0.864,1.136 q 0,0.672 0.304,1.184 0.304,0.512 0.784,0.512 0.736,0 0.736,-0.8 0,-0.64 -0.304,-1.136 -0.288,-0.512 -0.8,-0.512 -0.72,0 -0.72,0.752 z" /> </g> </g> </svg>',HALFNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3.84 12.432" height="3.5085866mm" width="1.0837333mm"> <g transform="translate(-375.23523,-454.37592)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 375.23523,465.70392 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-9.472 0.352,0 0,10.352 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 0.736,0.48 q 0.848,0 1.712,-0.72 0.88,-0.72 0.88,-1.072 0,-0.224 -0.192,-0.224 -0.592,0 -1.632,0.688 -1.024,0.672 -1.024,1.12 0,0.208 0.256,0.208 z" /> </g> </g> </svg>',QUARTERNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4.0859801 11.74224" height="3.313921mm" width="1.1531544mm"> <g transform="translate(-226.1339,-457.841)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 229.60268,457.841 0.5625,0 0.0547,0.0625 0,10.02344 q 0,1.27344 -1.53125,1.625 l -0.375,0.0313 -0.27343,0 q -1.65625,0 -1.875,-1.03906 l -0.0313,-0.24219 q 0,-1.01562 1.64843,-1.20312 l 0.25782,-0.0391 q 0.77343,0 1.47656,0.5 l 0.0313,0 0,-9.65625 0.0547,-0.0625 z" /> </g> </g> </svg>',EIGHTHNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.5234898 11.7422" height="3.3139098mm" width="2.123296mm"> <g transform="translate(-244.80575,-403.5553)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 248.14955,403.5553 0.67969,0 0.0625,0.0547 0,0.30468 q 0.21094,0.42188 1.5625,0.91407 1.875,0.54687 1.875,1.625 0,1.14062 -0.95313,1.89062 l -0.0313,0 -0.23437,-0.25 q 0.47656,-0.38281 0.47656,-1.03906 0,-0.54688 -1.78125,-1.10156 -0.71875,-0.32813 -0.91406,-0.53125 l 0,8.32812 q 0,1.19531 -1.75,1.54688 l -0.44531,0 q -1.89063,0 -1.89063,-1.3125 0,-1.02344 1.65625,-1.20313 l 0.17969,0 q 0.75,0 1.44531,0.5 l 0,-9.67187 0.0625,-0.0547 z" /> </g> </g> </svg>',SIXTEENTHNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.0080001 12.432" height="3.5085866mm" width="1.9778134mm"> <g transform="translate(-182.21292,-431.51877)"> <g style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 182.21292,442.84677 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-9.472 0.336,0 q 0.064,0.56 0.4,1.088 0.352,0.512 0.8,0.944 0.448,0.416 0.88,0.864 0.448,0.432 0.752,1.024 0.304,0.576 0.304,1.232 0,0.544 -0.256,1.104 0.304,0.448 0.304,1.184 0,1.232 -0.608,2.24 l -0.384,0 q 0.56,-1.12 0.56,-2.032 0,-0.512 -0.256,-0.96 -0.24,-0.448 -0.752,-0.816 -0.496,-0.368 -0.832,-0.56 -0.32,-0.192 -0.896,-0.48 l 0,5.52 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 6.464,-5.904 q 0,-1.648 -2.624,-3.072 0,0.464 0.192,0.88 0.192,0.416 0.512,0.752 0.32,0.32 0.656,0.592 0.336,0.272 0.688,0.608 0.352,0.32 0.544,0.608 0.032,-0.256 0.032,-0.368 z" /> </g> </g> </svg>',THIRTYSECONDNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.0080001 14.496001" height="4.0910935mm" width="1.9778134mm"> <g transform="translate(-630.78433,-240.88335)">  <g  style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1">  <path  d="m 630.78433,254.27535 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-11.536 0.352,0 q 0.048,0.56 0.384,1.072 0.336,0.496 0.768,0.912 0.432,0.4 0.864,0.848 0.432,0.448 0.72,1.104 0.304,0.656 0.304,1.456 0,0.48 -0.16,1.056 0.224,0.416 0.224,0.912 0,0.512 -0.24,0.976 0.304,0.448 0.304,1.168 0,1.232 -0.608,2.24 l -0.384,0 q 0.56,-1.12 0.56,-2.032 0,-0.512 -0.256,-0.96 -0.24,-0.448 -0.752,-0.816 -0.496,-0.368 -0.832,-0.56 -0.32,-0.192 -0.896,-0.48 l 0,5.52 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 6.448,-7.872 q 0,-0.496 -0.208,-0.928 -0.192,-0.432 -0.64,-0.832 -0.432,-0.416 -0.784,-0.672 -0.352,-0.256 -0.976,-0.656 0.032,0.448 0.352,0.896 0.32,0.432 0.704,0.752 0.4,0.32 0.848,0.8 0.464,0.464 0.704,0.912 l 0,-0.272 z m 0,2.096 q 0,-0.4 -0.16,-0.768 -0.144,-0.368 -0.32,-0.608 -0.16,-0.256 -0.592,-0.608 -0.416,-0.352 -0.672,-0.528 -0.256,-0.176 -0.848,-0.576 0.064,0.48 0.4,0.976 0.336,0.48 0.72,0.816 0.4,0.336 0.832,0.784 0.448,0.432 0.64,0.784 l 0,-0.272 z" /> </g> </g> </svg>',SIXTYFOURTHNOTE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7.0080001 14.528" height="4.1001244mm" width="1.9778134mm"> <g transform="translate(-345.3223,-325.39492)"> <g transform="translate(3.1093785,1.6864426)" style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"> <path d="m 342.21292,337.13248 q 0,-0.832 0.816,-1.472 0.816,-0.656 1.728,-0.656 0.528,0 0.944,0.272 l 0,-11.568 0.336,0 q 0.064,0.64 0.384,1.104 0.336,0.464 0.752,0.768 0.416,0.304 0.832,0.656 0.416,0.336 0.688,0.928 0.288,0.592 0.288,1.44 0,0.24 -0.144,0.768 0.256,0.608 0.256,1.376 0,0.32 -0.16,0.896 0.224,0.416 0.224,0.912 0,0.496 -0.24,0.96 0.304,0.448 0.304,1.024 0,0.384 -0.08,0.688 -0.08,0.304 -0.16,0.448 -0.08,0.144 -0.368,0.608 l -0.384,0 q 0.08,-0.16 0.192,-0.368 0.112,-0.224 0.16,-0.32 0.064,-0.096 0.112,-0.24 0.064,-0.144 0.08,-0.288 0.016,-0.144 0.016,-0.32 0,-0.272 -0.096,-0.512 -0.08,-0.256 -0.176,-0.432 -0.096,-0.192 -0.32,-0.4 -0.224,-0.208 -0.368,-0.32 -0.144,-0.128 -0.464,-0.304 -0.304,-0.192 -0.432,-0.256 -0.128,-0.064 -0.48,-0.224 -0.336,-0.176 -0.4,-0.208 l 0,4.064 q 0,0.896 -0.784,1.488 -0.784,0.592 -1.728,0.592 -0.528,0 -0.928,-0.304 -0.4,-0.32 -0.4,-0.8 z m 6.352,-8.384 q 0,-0.352 -0.144,-0.688 -0.128,-0.352 -0.288,-0.576 -0.16,-0.224 -0.48,-0.496 -0.32,-0.272 -0.512,-0.4 -0.192,-0.144 -0.592,-0.384 -0.384,-0.24 -0.496,-0.32 0.032,0.432 0.352,0.832 0.32,0.384 0.704,0.656 0.4,0.272 0.816,0.72 0.432,0.432 0.624,0.912 0.016,-0.176 0.016,-0.256 z m 0.016,2.128 q 0,-0.208 -0.048,-0.4 -0.032,-0.192 -0.08,-0.336 -0.048,-0.16 -0.176,-0.336 -0.128,-0.176 -0.208,-0.288 -0.08,-0.112 -0.272,-0.272 -0.192,-0.176 -0.288,-0.256 -0.096,-0.08 -0.352,-0.256 -0.24,-0.176 -0.336,-0.224 -0.096,-0.064 -0.384,-0.24 -0.288,-0.192 -0.384,-0.256 0.032,0.464 0.368,0.88 0.336,0.416 0.736,0.704 0.4,0.272 0.816,0.688 0.416,0.416 0.576,0.864 0.032,-0.192 0.032,-0.272 z m -0.016,1.936 q 0,-0.848 -0.624,-1.504 -0.608,-0.672 -1.872,-1.392 0.064,0.464 0.384,0.896 0.336,0.416 0.72,0.688 0.4,0.272 0.8,0.704 0.4,0.416 0.576,0.88 0.016,-0.064 0.016,-0.272 z" /> </g> </g> </svg>',SHARP="‚ôØ",FLAT="‚ô≠",NATURAL="‚ôÆ",DOUBLESHARP="ùÑ™",DOUBLEFLAT="ùÑ´",NSYMBOLS={1:"ùÖù",2:"ùÖû",4:"‚ô©",8:"‚ô™",16:"ùÖ°"},RSYMBOLS={1:"ùÑª",2:"ùÑº",4:"ùÑΩ",8:"ùÑæ",16:"ùÑø"},BTOFLAT={Eb:"E"+FLAT,Gb:"G"+FLAT,Ab:"A"+FLAT,Bb:"B"+FLAT,Db:"D"+FLAT,Cb:"C"+FLAT,Fb:"F"+FLAT,eb:"E"+FLAT,gb:"G"+FLAT,ab:"A"+FLAT,bb:"B"+FLAT,db:"D"+FLAT,cb:"C"+FLAT,fb:"F"+FLAT},STOSHARP={"E#":"E"+SHARP,"G#":"G"+SHARP,"A#":"A"+SHARP,"B#":"B"+SHARP,"D#":"D"+SHARP,"C#":"C"+SHARP,"F#":"F"+SHARP,"e#":"E"+SHARP,"g#":"G"+SHARP,"a#":"A"+SHARP,"b#":"B"+SHARP,"d#":"D"+SHARP,"c#":"C"+SHARP,"f#":"F"+SHARP},NOTESSHARP=["C","C"+SHARP,"D","D"+SHARP,"E","F","F"+SHARP,"G","G"+SHARP,"A","A"+SHARP,"B"],NOTESFLAT=["C","D"+FLAT,"D","E"+FLAT,"E","F","G"+FLAT,"G","A"+FLAT,"A","B"+FLAT,"B"],NOTESFLAT2=["c","d"+FLAT,"d","e"+FLAT,"e","f","g"+FLAT,"g","a"+FLAT,"a","b"+FLAT,"b"],EQUIVALENTFLATS={"C‚ôØ":"D"+FLAT,"D‚ôØ":"E"+FLAT,"F‚ôØ":"G"+FLAT,"G‚ôØ":"A"+FLAT,"A‚ôØ":"B"+FLAT},EQUIVALENTSHARPS={"D‚ô≠":"C"+SHARP,"E‚ô≠":"D"+SHARP,"G‚ô≠":"F"+SHARP,"A‚ô≠":"G"+SHARP,"B‚ô≠":"A"+SHARP},EQUIVALENTNATURALS={"E‚ôØ":"F","B‚ôØ":"C","C‚ô≠":"B","F‚ô≠":"E"},EQUIVALENTACCIDENTALS={F:"E‚ôØ",C:"B‚ôØ",B:"C‚ô≠",E:"F‚ô≠",G:"FùÑ™",D:"CùÑ™",A:"GùÑ™"},CONVERT_DOWN={C:"B"+SHARP,"C‚ô≠":"B","D‚ô≠":"C"+SHARP,"E‚ô≠":"D"+SHARP,F:"E"+SHARP,"F‚ô≠":"E","G‚ô≠":"F"+SHARP,"A‚ô≠":"G"+SHARP,"B‚ô≠":"A"+SHARP},CONVERT_DOUBLE_DOWN={"C‚ôØ":"B"+DOUBLESHARP,D:"C"+DOUBLESHARP,E:"D"+DOUBLESHARP,"F‚ôØ":"E"+DOUBLESHARP,G:"F"+DOUBLESHARP,A:"G"+DOUBLESHARP,B:"A"+DOUBLESHARP},CONVERT_UP={"C‚ôØ":"D"+FLAT,"D‚ôØ":"E"+FLAT,"E‚ôØ":"F",E:"F"+FLAT,"F‚ôØ":"G"+FLAT,"G‚ôØ":"A"+FLAT,"A‚ôØ":"B"+FLAT,"B‚ôØ":"C",B:"C"+FLAT},CONVERT_DOUBLE_UP={C:"D"+DOUBLEFLAT,D:"E"+DOUBLEFLAT,"E‚ô≠":"F"+DOUBLEFLAT,F:"G"+DOUBLEFLAT,G:"A"+DOUBLEFLAT,A:"B"+DOUBLEFLAT,"B‚ô≠":"C"+DOUBLEFLAT},EXTRATRANSPOSITIONS={"E‚ôØ":["F",0],"B‚ôØ":["C",1],"C‚ô≠":["B",-1],"F‚ô≠":["E",0],"e‚ôØ":["F",0],"b‚ôØ":["C",1],"c‚ô≠":["B",-1],"f‚ô≠":["E",0]},SOLFEGENAMES=["do","re","mi","fa","sol","la","ti"],SOLFEGENAMES1=["do","do"+SHARP,"do"+DOUBLESHARP,"re"+DOUBLEFLAT,"re"+FLAT,"re","re"+SHARP,"re"+DOUBLESHARP,"mi"+DOUBLEFLAT,"mi"+FLAT,"mi","fa","fa"+SHARP,"fa"+DOUBLESHARP,"sol"+DOUBLEFLAT,"sol"+FLAT,"sol","sol"+SHARP,"sol"+DOUBLESHARP,"la","la"+DOUBLEFLAT,"la"+FLAT,"la"+SHARP,"la"+DOUBLESHARP,"ti"+DOUBLEFLAT,"ti"+FLAT,"ti"],NOTENAMES=["C","D","E","F","G","A","B"],ALLNOTENAMES=["C","C#","Cx","Dbb","Db","D","D#","Dx","Ebb","Eb","E","E#","Ex","Fbb","Fb","F","F#","Fx","Gbb","Gb","G","G#","Gx","Abb","Ab","A","A#","Ax","Bbb","Bb","B","B#","Bx","Cbb","Cb"],NOTENAMES1=["C","C"+SHARP,"C"+DOUBLESHARP,"D"+DOUBLEFLAT,"D"+FLAT,"D","D"+SHARP,"D"+DOUBLESHARP,"E"+DOUBLEFLAT,"E"+FLAT,"E","F","F"+SHARP,"F"+DOUBLESHARP,"G"+DOUBLEFLAT,"G"+FLAT,"G","G"+SHARP,"G"+DOUBLESHARP,"A","A"+DOUBLEFLAT,"A"+FLAT,"A"+SHARP,"A"+DOUBLESHARP,"B"+DOUBLEFLAT,"B"+FLAT,"B"],SOLFEGECONVERSIONTABLE={"C‚ô≠":"do"+FLAT,C:"do","C‚ôØ":"do"+SHARP,"D‚ô≠":"re"+FLAT,D:"re","D‚ôØ":"re"+SHARP,"E‚ô≠":"mi"+FLAT,E:"mi",F:"fa","F‚ôØ":"fa"+SHARP,"G‚ô≠":"sol"+FLAT,G:"sol","G‚ôØ":"sol"+SHARP,"A‚ô≠":"la"+FLAT,A:"la","A‚ôØ":"la"+SHARP,"B‚ô≠":"ti"+FLAT,B:"ti","B‚ôØ":"ti"+SHARP,R:_("rest")},WESTERN2EISOLFEGENAMES={do:"sa",re:"re",mi:"ga",fa:"ma",sol:"pa",la:"dha",ti:"ni"},PITCHES=["C","D"+FLAT,"D","E"+FLAT,"E","F","G"+FLAT,"G","A"+FLAT,"A","B"+FLAT,"B"],PITCHES1=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],PITCHES2=["C","C"+SHARP,"D","D"+SHARP,"E","F","F"+SHARP,"G","G"+SHARP,"A","A"+SHARP,"B"],PITCHES3=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],NOTESTABLE={1:"do",2:"do"+SHARP,3:"re",4:"re"+SHARP,5:"mi",6:"fa",7:"fa"+SHARP,8:"sol",9:"sol"+SHARP,10:"la",11:"la"+SHARP,0:"ti"},FIXEDSOLFEGE={do:"C",re:"D",mi:"E",fa:"F",sol:"G",la:"A",ti:"B"},FIXEDSOLFEGE1={"doùÑ´":"B","do‚ô≠":"C"+FLAT,do:"C","do‚ôØ":"C"+SHARP,"doùÑ™":"D","reùÑ´":"C","re‚ô≠":"D"+FLAT,re:"D","re‚ôØ":"D"+SHARP,"reùÑ™":"E","miùÑ´":"D","mi‚ô≠":"E"+FLAT,mi:"E","mi‚ôØ":"E"+SHARP,"miùÑ™":"G","faùÑ´":"E"+FLAT,"fa‚ô≠":"F"+FLAT,fa:"F","fa‚ôØ":"F"+SHARP,"faùÑ™":"G"+SHARP,"solùÑ´":"E","sol‚ô≠":"G"+FLAT,sol:"G","sol‚ôØ":"G"+SHARP,"solùÑ™":"A","laùÑ´":"G","la‚ô≠":"A"+FLAT,la:"A","la‚ôØ":"A"+SHARP,"laùÑ™":"B","tiùÑ´":"A","ti‚ô≠":"B"+FLAT,ti:"B","ti‚ôØ":"B"+SHARP,"tiùÑ™":"C",R:_("rest")},NOTESTEP={C:1,D:3,E:5,F:6,G:8,A:10,B:12},ALLNOTESTEP={Cb:0,C:1,"C#":2,Db:2,D:3,"D#":4,Eb:4,E:5,"E#":6,Fb:5,F:6,"F#":7,Gb:7,G:8,"G#":9,Ab:9,A:10,"A#":11,Bb:11,B:12,"B#":0},SEMITONETOINTERVALMAP={0:{0:_("Perfect unison"),1:_("Diminished second")},1:{1:_("Minor second"),0:_("Augmented unison")},2:{1:_("Major second"),2:_("Diminished third")},3:{2:_("Minor third"),1:_("Augmented second")},4:{2:_("Major third"),3:_("Diminished fourth")},5:{3:_("Perfect fourth"),2:_("Augmented third")},6:{4:_("Diminished fifth"),3:_("Augmented fourth")},7:{4:_("Perfect fifth"),5:_("Diminished sixth")},8:{5:_("Minor sixth"),4:_("Augmented fifth")},9:{5:_("Major sixth"),6:_("Diminished seventh")},10:{6:_("Minor seventh"),5:_("Augmented sixth")},11:{6:_("Major seventh"),0:_("Diminished octave")},12:{0:_("Perfect octave"),6:_("Augmented seventh")},13:{1:_("Minor ninth"),0:_("Augmented octave")},14:{1:_("Major ninth"),2:_("Diminished tenth")},15:{2:_("Minor tenth"),1:_("Augmented ninth")},16:{2:_("Major tenth"),3:_("Diminished eleventh")},17:{3:_("Perfect eleventh"),2:_("Augmented tenth")},18:{4:_("Diminished twelfth"),3:_("Augmented eleventh")},19:{4:_("Perfect twelfth"),5:_("Diminished thirteenth")},20:{5:_("Minor thirteenth"),4:_("Augmented fifth, plus an octave")},21:{5:_("Major thirteenth"),6:_("Diminished seventh, plus an octave")}},SHARPPREFERENCE=["g major","d major","a major","e major","b major","f# major","c# major","e minor","b minor","f# minor","c# minor","g# minor","d# minor"],FLATPREFERENCE=["f major","bb major","eb major","ab major","db major","gb major","cb major","d minor","g minor","c minor","f minor","bb minor","eb minor","d harmonic minor","g harmonic minor","c harmonic minor","f harmonic minor","bb harmonic minor","eb harmonic minor"],SOLFNOTES=["ti","la","sol","fa","mi","re","do"],SCALENOTES=["7","6","5","4","3","2","1"],EASTINDIANSOLFNOTES=["ni","dha","pa","ma","ga","re","sa"],DRUMS=["snare drum","kick drum","tom tom","floor tom","bass drum","cup drum","darbuka drum","japanese drum","hi hat","ride bell","cow bell","triangle bell","finger cymbals","chime","gong","clang","crash","clap","slap"],GRAPHICS=["forward","back","right","left","set heading","set color","set shade","set hue","set grey","set translucency","set pen size"],SOLFATTRS=[DOUBLESHARP,SHARP,NATURAL,FLAT,DOUBLEFLAT],DEGREES=_("1st 2nd 3rd 4th 5th 6th 7th 8th 9th 10th 11th 12th"),SEMITONES=12,POWER2=[1,2,4,8,16,32,64,128],TWELTHROOT2=1.0594630943592953,TWELVEHUNDRETHROOT2=1.0005777895065548,A0=27.5,C8=4186.01,octaveRatio=2,RHYTHMRULERHEIGHT=100,YSTAFFNOTEHEIGHT=12.5,YSTAFFOCTAVEHEIGHT=87.5,SLIDERHEIGHT=200,SLIDERWIDTH=50,MATRIXBUTTONCOLOR="#c374e9",MATRIXLABELCOLOR="#90c100",MATRIXNOTECELLCOLOR="#b1db00",MATRIXTUPLETCELLCOLOR="#57e751",MATRIXRHYTHMCELLCOLOR="#c8c8c8",MATRIXBUTTONCOLORHOVER="#c894e0",MATRIXNOTECELLCOLORHOVER="#c2e820",MATRIXSOLFEWIDTH=52,EIGHTHNOTEWIDTH=24,MATRIXBUTTONHEIGHT=40,MATRIXBUTTONHEIGHT2=66,MATRIXSOLFEHEIGHT=30,wholeNoteImg="data:image/svg+xml;base64,"+window.btoa(base64Encode(WHOLENOTE)),halfNoteImg="data:image/svg+xml;base64,"+window.btoa(base64Encode(HALFNOTE)),quarterNoteImg="data:image/svg+xml;base64,"+window.btoa(base64Encode(QUARTERNOTE)),eighthNoteImg="data:image/svg+xml;base64,"+window.btoa(base64Encode(EIGHTHNOTE)),sixteenthNoteImg="data:image/svg+xml;base64,"+window.btoa(base64Encode(SIXTEENTHNOTE)),thirtysecondNoteImg="data:image/svg+xml;base64,"+window.btoa(base64Encode(THIRTYSECONDNOTE)),sixtyfourthNoteImg="data:image/svg+xml;base64,"+window.btoa(base64Encode(SIXTYFOURTHNOTE)),NOTESYMBOLS={1:wholeNoteImg,2:halfNoteImg,4:quarterNoteImg,8:eighthNoteImg,16:sixteenthNoteImg,32:thirtysecondNoteImg,64:sixtyfourthNoteImg},SELECTORSTRINGS=[_("unison"),_("augmented"),_("diminished"),_("minor"),_("major"),_("perfect"),_("chromatic"),_("algerian"),_("spanish"),_("octatonic"),_("harmonic major"),_("natural minor"),_("harmonic minor"),_("melodic minor"),_("ionian"),_("dorian"),_("phrygian"),_("lydian"),_("mixolydian"),_("aeolian"),_("locrian"),_("jazz minor"),_("bebop"),_("arabic"),_("byzantine"),_("enigmatic"),_("ethiopian"),_("geez"),_("hindu"),_("hungarian"),_("romanian minor"),_("spanish gypsy"),_("maqam"),_("minor blues"),_("major blues"),_("whole tone"),_("minor pentatonic"),_("major pentatonic"),_("chinese"),_("egyptian"),_("hirajoshi"),_("Japan"),_("in"),_("minyo"),_("fibonacci"),_("custom"),_("highpass"),_("lowpass"),_("bandpass"),_("highshelf"),_("lowshelf"),_("notch"),_("allpass"),_("peaking"),_("sine"),_("square"),_("triangle"),_("sawtooth"),_("even"),_("odd"),_("scalar"),_("piano"),_("violin"),_("viola"),_("xylophone"),_("vibraphone"),_("cello"),_("bass"),_("double bass"),_("guitar"),_("sitar"),_("harmoiunm"),_("mandolin"),_("acoustic guitar"),_("flute"),_("clarinet"),_("saxophone"),_("tuba"),_("trumpet"),_("oboe"),_("trombone"),_("electronic synth"),_("simple 1"),_("simple 2"),_("simple 3"),_("simple 4"),_("white noise"),_("brown noise"),_("pink noise"),_("custom"),_("snare drum"),_("kick drum"),_("tom tom"),_("floor tom"),_("bass drum"),_("cup drum"),_("darbuka drum"),_("hi hat"),_("ride bell"),_("cow bell"),_("japanese drum"),_("triangle bell"),_("finger cymbals"),_("chime"),_("gong"),_("clang"),_("crash"),_("bottle"),_("clap"),_("slap"),_("splash"),_("bubbles"),_("raindrop"),_("cat"),_("cricket"),_("dog"),_("duck"),_("banjo"),_("koto"),_("dulcimer"),_("electric guitar"),_("bassoon"),_("celeste"),_("equal"),_("Pythagorean"),_("just intonation"),_("Meantone").toLowerCase(),_("custom"),_("double flat"),_("flat"),_("natural"),_("sharp"),_("double sharp"),_("major"),_("minor"),_("augmented"),_("diminished"),_("major 7th"),_("minor 7th"),_("dominant 7th"),_("minor-major 7th"),_("fully-diminished 7th"),_("half-diminished 7th"),_("custom")],ACCIDENTALLABELS=[_("double sharp")+" "+DOUBLESHARP,_("sharp")+" "+SHARP,_("natural")+" "+NATURAL,_("flat")+" "+FLAT,_("double flat")+" "+DOUBLEFLAT],ACCIDENTALNAMES=["double sharp "+DOUBLESHARP,"sharp "+SHARP,"natural "+NATURAL,"flat "+FLAT,"double flat "+DOUBLEFLAT],ACCIDENTALVALUES=[2,1,0,-1,-2],CHORDNAMES=["triad (root position)","triad (1st inversion)","triad (2nd inversion)","seventh (root position)","seventh (1st inversion)","seventh (2nd inversion)","seventh (3rd inversion)","ninth (root position)","thirteenth (root position)","major","minor","augmented","diminished","major 7th","minor 7th","dominant 7th","minor-major 7th","fully-diminished 7th","half-diminished 7th","custom"],DEFAULTCHORD=CHORDNAMES[9],CHORDVALUES=[[[0,0],[2,0],[4,0]],[[2,0],[4,0],[7,0]],[[-3,0],[0,0],[2,0]],[[0,0],[2,0],[4,0],[6,0]],[[2,0],[4,0],[6,0],[7,0]],[[-3,0],[-1,0],[0,0],[2,0]],[[-1,0],[0,0],[2,0],[4,0]],[[0,0],[2,0],[4,0],[6,0],[8,0]],[[0,0],[2,0],[4,0],[6,0],[12,0]],[[0,0],[0,4],[0,7]],[[0,0],[0,3],[0,7]],[[0,0],[0,4],[0,8]],[[0,0],[0,3],[0,6]],[[0,0],[0,4],[0,7],[0,11]],[[0,0],[0,3],[0,7],[0,10]],[[0,0],[0,4],[0,7],[0,10]],[[0,0],[0,3],[0,7],[0,11]],[[0,0],[0,3],[0,6],[0,9]],[[0,0],[0,3],[0,6],[0,10]],[[0,0],[0,4],[0,7]]],setCustomChord=function(e){CHORDVALUES[CHORDVALUES.length-1]=e},INVERTMODES=[[_("even"),"even"],[_("odd"),"odd"],[_("scalar"),"scalar"]],INTERVALS=[[_("perfect"),"perfect",[1,4,5,8]],[_("minor"),"minor",[2,3,6,7]],[_("diminished"),"diminished",[2,3,4,5,6,7,8]],[_("augmented"),"augmented",[1,2,3,4,5,6,7,8]],[_("major"),"major",[2,3,6,7]]],INTERVALVALUES={"perfect 1":[0,0,1],"diminished 2":[0,-1,1.024],"augmented 1":[1,1,25/24],"chromatic semitone":[1,1,25/24],"minor 2":[1,-1,16/15],"major 2":[2,1,9/8],"whole tone":[2,1,9/8],"diminished 3":[2,-1,1.152],"augmented 2":[3,1,75/64],"minor 3":[3,-1,1.2],"major 3":[4,1,5/4],"diminished 4":[4,-1,1.28],"augmented 3":[5,1,125/96],"perfect 4":[5,0,4/3],"augmented 4":[6,1,25/18],"diminished 5":[6,-1,1.44],"perfect 5":[7,0,1.5],"diminished 6":[7,-1,1.536],"augmented 5":[8,1,25/16],"minor 6":[8,-1,1.6],"major 6":[9,1,5/3],"diminished 7":[9,-1,1.8],"augmented 6":[10,1,125/72],"minor 7":[10,-1,1.8],"major 7":[11,1,15/8],"diminished 8":[11,-1,1.92],"diminished octave":[11,-1,1.92],"augmented 7":[12,1,125/64],"perfect 8":[12,0,2],octave:[12,0,2],"augmented 8":[13,1,25/12]},MODE_PIE_MENUS={5:["minor pentatonic","major pentatonic"," ","chinese","egyptian"," ","hirajoshi","in","minyo"," ","fibonacci"," "],6:["minor blues"," "," "," ","major blues"," "," "," ","whole tone"," "," "," "],7:["ionian"," ","dorian"," ","phrygian","lydian"," ","mixolydian"," ","aeolian"," ","locrian"],"7a":["major"," ","harmonic major"," ","natural minor"," ","harmonic minor"," ","melodic minor"," "," "," "],"7b":["jazz minor"," ","arabic","byzantine","enigmatic","ethiopian","geez","hindu","hungarian","maqam","romanian minor","spanish gypsy"],8:["octatonic"," ","spanish"," ","bebop"," ","diminished"," "," ","algerian"," "," "],12:["chromatic"," "," "," "," "," ","custom"," "," "," "," "," "]},MUSICALMODES={chromatic:[1,1,1,1,1,1,1,1,1,1,1,1],algerian:[2,1,2,1,1,1,3,1],diminished:[2,1,2,1,2,1,2,1],spanish:[1,2,1,1,1,2,2,2],octatonic:[1,2,1,2,1,2,1,2],bebop:[1,1,1,2,2,1,2,2],major:[2,2,1,2,2,2,1],"harmonic major":[2,2,1,2,1,3,1],"natural minor":[2,1,2,2,1,2,2],"harmonic minor":[2,1,2,2,1,3,1],"melodic minor":[2,1,2,2,2,2,1],ionian:[2,2,1,2,2,2,1],dorian:[2,1,2,2,2,1,2],phrygian:[1,2,2,2,1,2,2],lydian:[2,2,2,1,2,2,1],mixolydian:[2,2,1,2,2,1,2],minor:[2,1,2,2,1,2,2],aeolian:[2,1,2,2,1,2,2],locrian:[1,2,2,1,2,2,2],"jazz minor":[2,1,2,2,2,2,1],arabic:[2,2,1,1,2,2,2],byzantine:[1,3,1,2,1,3,1],enigmatic:[1,3,2,2,2,1,1],ethiopian:[2,1,2,2,1,2,2],geez:[2,1,2,2,1,2,2],hindu:[2,2,1,2,1,2,2],hungarian:[2,1,3,1,1,3,1],maqam:[1,3,1,2,1,3,1],"romanian minor":[2,1,3,1,2,1,2],"spanish gypsy":[1,3,1,2,1,2,2],"minor blues":[3,2,1,1,3,2],"major blues":[2,1,1,3,2,2],"whole tone":[2,2,2,2,2,2],"major pentatonic":[2,2,3,2,3],"minor pentatonic":[3,2,2,3,2],chinese:[4,2,1,4,1],egyptian:[2,3,2,3,2],hirajoshi:[1,4,1,4,2],in:[1,4,2,1,4],minyo:[3,2,2,3,2],fibonacci:[1,1,2,3,5],"alt pentatonic":[2,3,2,2,3],custom:[1,1,1,1,1,1,1,1,1,1,1,1]},MAQAMTABLE={"hijaz kar":"C maqam","hijaz kar maqam":"C maqam",shahnaz:"D maqam","maqam mustar":"Eb maqam","maqam jiharkah":"F maqam","shadd araban":"G maqam",suzidil:"A maqam",ajam:"Bb maqam","ajam maqam":"Bb maqam"},FILTERTYPES=[[_("highpass"),"highpass"],[_("lowpass"),"lowpass"],[_("bandpass"),"bandpass"],[_("highshelf"),"highshelf"],[_("lowshelf"),"lowshelf"],[_("notch"),"notch"],[_("allpass"),"allpass"],[_("peaking"),"peaking"]],OSCTYPES=[[_("sine"),"sine"],[_("square"),"square"],[_("triangle"),"triangle"],[_("sawtooth"),"sawtooth"]],INITIALTEMPERAMENTS=[[_("Equal (12EDO)"),"equal","equal"],[_("Equal (5EDO)"),"equal5","equal5"],[_("Equal (7EDO)"),"equal7","equal7"],[_("Equal (19EDO)"),"equal19","equal19"],[_("Equal (31EDO)"),"equal31","equal31"],[_("5-limit Just Intonation"),"just intonation","just intonation"],[_("Pythagorean (3-limit JI)"),"Pythagorean","Pythagorean"],[_("Meantone")+" (1/3)","1/3 comma meantone","meantone (1/3)"],[_("Meantone")+" (1/4)","1/4 comma meantone","meantone (1/4)"]],TEMPERAMENTS=[[_("Equal (12EDO)"),"equal","equal"],[_("Equal (5EDO)"),"equal5","equal5"],[_("Equal (7EDO)"),"equal7","equal7"],[_("Equal (19EDO)"),"equal19","equal19"],[_("Equal (31EDO)"),"equal31","equal31"],[_("5-limit Just Intonation"),"just intonation","just intonation"],[_("Pythagorean (3-limit JI)"),"Pythagorean","Pythagorean"],[_("Meantone")+" (1/3)","1/3 comma meantone","meantone (1/3)"],[_("Meantone")+" (1/4)","1/4 comma meantone","meantone (1/4)"],[_("custom"),"custom","custom"]],PreDefinedTemperaments={equal:!0,equal5:!0,equal7:!0,equal19:!0,equal31:!0,"just intonation":!0,Pythagorean:!0,"1/3 comma meantone":!0,"1/4 comma meantone":!0},TEMPERAMENT={equal:{"perfect 1":Math.pow(2,0),"minor 2":Math.pow(2,1/12),"augmented 1":Math.pow(2,1/12),"major 2":Math.pow(2,2/12),"augmented 2":Math.pow(2,.25),"minor 3":Math.pow(2,.25),"major 3":Math.pow(2,4/12),"augmented 3":Math.pow(2,5/12),"diminished 4":Math.pow(2,4/12),"perfect 4":Math.pow(2,5/12),"augmented 4":Math.pow(2,.5),"diminished 5":Math.pow(2,.5),"perfect 5":Math.pow(2,7/12),"augmented 5":Math.pow(2,8/12),"minor 6":Math.pow(2,8/12),"major 6":Math.pow(2,.75),"augmented 6":Math.pow(2,10/12),"minor 7":Math.pow(2,10/12),"major 7":Math.pow(2,11/12),"augmented 7":Math.pow(2,1),"diminished 8":Math.pow(2,11/12),"perfect 8":Math.pow(2,1),pitchNumber:12,interval:["perfect 1","minor 2","major 2","minor 3","major 3","perfect 4","diminished 5","perfect 5","minor 6","major 6","minor 7","major 7","perfect 8"]},equal5:{"perfect 1":Math.pow(2,0),"minor 2":Math.pow(2,.2),"augmented 1":Math.pow(2,.2),"major 2":Math.pow(2,.4),"augmented 2":Math.pow(2,.4),"minor 3":Math.pow(2,.4),"major 3":Math.pow(2,.6),"augmented 3":Math.pow(2,.6),"diminished 4":Math.pow(2,.6),"perfect 4":Math.pow(2,.6),"augmented 4":Math.pow(2,.8),"diminished 5":Math.pow(2,.8),"perfect 5":Math.pow(2,1),"augmented 5":Math.pow(2,1),"minor 6":Math.pow(2,1),"major 6":Math.pow(2,1),"augmented 6":Math.pow(2,1),"minor 7":Math.pow(2,1),"major 7":Math.pow(2,1),"augmented 7":Math.pow(2,1),"diminished 8":Math.pow(2,1),"perfect 8":Math.pow(2,1),pitchNumber:5,interval:["perfect 1","minor 2","major 2","major 3","augmented 4","perfect 5"]},equal7:{"perfect 1":Math.pow(2,0),"minor 2":Math.pow(2,1/7),"augmented 1":Math.pow(2,1/7),"major 2":Math.pow(2,2/7),"augmented 2":Math.pow(2,2/7),"minor 3":Math.pow(2,3/7),"major 3":Math.pow(2,3/7),"augmented 3":Math.pow(2,4/7),"diminished 4":Math.pow(2,4/7),"perfect 4":Math.pow(2,4/7),"augmented 4":Math.pow(2,5/7),"diminished 5":Math.pow(2,4/7),"perfect 5":Math.pow(2,5/7),"augmented 5":Math.pow(2,6/7),"minor 6":Math.pow(2,5/7),"major 6":Math.pow(2,6/7),"augmented 6":Math.pow(2,1),"minor 7":Math.pow(2,6/7),"major 7":Math.pow(2,6/7),"augmented 7":Math.pow(2,1),"diminished 8":Math.pow(2,1),"perfect 8":Math.pow(2,1),pitchNumber:7,interval:["perfect 1","minor 2","major 2","major 3","perfect 4","perfect 5","major 6","perfect 8"]},equal19:{"perfect 1":Math.pow(2,0),"minor 2":Math.pow(2,2/19),"augmented 1":Math.pow(2,1/19),"major 2":Math.pow(2,3/19),"augmented 2":Math.pow(2,4/19),"minor 3":Math.pow(2,5/19),"major 3":Math.pow(2,6/19),"augmented 3":Math.pow(2,7/19),"diminished 4":Math.pow(2,7/19),"perfect 4":Math.pow(2,8/19),"augmented 4":Math.pow(2,9/19),"diminished 5":Math.pow(2,9/19),"perfect 5":Math.pow(2,10/19),"augmented 5":Math.pow(2,11/19),"minor 6":Math.pow(2,12/19),"major 6":Math.pow(2,13/19),"augmented 6":Math.pow(2,14/19),"minor 7":Math.pow(2,15/19),"major 7":Math.pow(2,16/19),"augmented 7":Math.pow(2,17/19),"diminished 8":Math.pow(2,18/19),"perfect 8":Math.pow(2,1),pitchNumber:19,interval:["perfect 1","augmented 1","minor 2","major 2","augmented 2","minor 3","major 3","augmented 3","perfect 4","augmented 4","perfect 5","augmented 5","minor 6","major 6","augmented 6","minor 7","major 7","augmented 7","diminished 8","perfect 8"]},equal31:{"perfect 1":Math.pow(2,0),"diminished 2":Math.pow(2,1/31),"augmented 1":Math.pow(2,2/31),"minor 2":Math.pow(2,3/31),"mid 2":Math.pow(2,4/31),"major 2":Math.pow(2,5/31),"up-major 2":Math.pow(2,6/31),"down-minor 3":Math.pow(2,7/31),"minor 3":Math.pow(2,8/31),"mid 3":Math.pow(2,9/31),"major 3":Math.pow(2,10/31),"up-major 3":Math.pow(2,11/31),"down 4":Math.pow(2,12/31),"perfect 4":Math.pow(2,13/31),"up 4":Math.pow(2,14/31),"down-diminished 5":Math.pow(2,15/31),"up-augmented 4":Math.pow(2,16/31),"down 5":Math.pow(2,17/31),"perfect 5":Math.pow(2,18/31),"up 5":Math.pow(2,19/31),"down-minor 6":Math.pow(2,20/31),"minor 6":Math.pow(2,21/31),"mid 6":Math.pow(2,22/31),"major 6":Math.pow(2,23/31),"up-major 6":Math.pow(2,24/31),"down-minor 7":Math.pow(2,25/31),"minor 7":Math.pow(2,26/31),"mid 7":Math.pow(2,27/31),"major 7":Math.pow(2,28/31),"up-major 7":Math.pow(2,29/31),"down 8":Math.pow(2,30/31),"perfect 8":Math.pow(2,1),octave:Math.pow(2,1),pitchNumber:31,interval:["perfect 1","diminished 2","augmented 1","minor 2","mid 2","major 2","up-major 2","down-minor 3","minor 3","mid 3","major 3","up-major 3","down 4","perfect 4","up 4","down-diminished 5","up-augmented 4","down 5","perfect 5","up 5","down-minor 6","minor 6","mid 6","major 6","up-major 6","down-minor 7","minor 7","mid 7","major 7","up-major 7","down 8","perfect 8"]},"just intonation":{"perfect 1":1,"minor 2":16/15,"augmented 1":16/15,"major 2":9/8,"augmented 2":1.2,"minor 3":1.2,"major 3":5/4,"augmented 3":4/3,"diminished 4":5/4,"perfect 4":4/3,"augmented 4":1.4,"diminished 5":1.4,"perfect 5":1.5,"augmented 5":1.6,"minor 6":1.6,"major 6":5/3,"augmented 6":16/9,"minor 7":16/9,"major 7":15/8,"augmented 7":2,"diminished 8":15/8,"perfect 8":2,pitchNumber:12,interval:["perfect 1","minor 2","major 2","minor 3","major 3","perfect 4","diminished 5","perfect 5","minor 6","major 6","minor 7","major 7","perfect 8"]},Pythagorean:{"perfect 1":1,"minor 2":256/243,"augmented 1":256/243,"major 2":9/8,"augmented 2":32/27,"minor 3":32/27,"major 3":81/64,"augmented 3":4/3,"diminished 4":81/64,"perfect 4":4/3,"augmented 4":729/512,"diminished 5":729/512,"perfect 5":1.5,"augmented 5":128/81,"minor 6":128/81,"major 6":27/16,"augmented 6":16/9,"minor 7":16/9,"major 7":243/128,"augmented 7":2,"diminished 8":243/128,"perfect 8":2,pitchNumber:12,interval:["perfect 1","minor 2","major 2","minor 3","major 3","perfect 4","diminished 5","perfect 5","minor 6","major 6","minor 7","major 7","perfect 8"]},"1/3 comma meantone":{"perfect 1":1,"minor 2":1.075693,"augmented 1":1.037156,"major 2":1.115656,"augmented 2":1.157109,"minor 3":1.200103,"major 3":1.244694,"augmented 3":1.290943,"diminished 4":1.290943,"perfect 4":1.338902,"augmented 4":1.38865,"diminished 5":1.440247,"perfect 5":1.493762,"augmented 5":1.549255,"minor 6":1.60682,"major 6":1.666524,"augmented 6":1.728445,"minor 7":1.792668,"major 7":1.859266,"augmented 7":1.92835,"diminished 8":1.92835,"perfect 8":2,pitchNumber:19,interval:["perfect 1","augmented 1","minor 2","major 2","augmented 2","minor 3","major 3","diminished 4","perfect 4","augmented 4","diminished 5","perfect 5","augmented 5","minor 6","major 6","augmented 6","minor 7","major 7","diminished 8","perfect 8"]},"1/4 comma meantone":{"perfect 1":1,"minor 2":16/15,"augmented 1":25/24,"major 2":9/8,"augmented 2":75/64,"minor 3":1.2,"major 3":5/4,"diminished 4":1.28,"augmented 3":125/96,"perfect 4":4/3,"augmented 4":25/18,"diminished 5":1.44,"perfect 5":1.5,"augmented 5":25/16,"minor 6":1.6,"major 6":5/3,"augmented 6":125/72,"minor 7":1.8,"major 7":15/8,"diminished 8":1.92,"augmented 7":125/64,"perfect 8":2,pitchNumber:21,interval:["perfect 1","augmented 1","minor 2","major 2","augmented 2","minor 3","major 3","diminished 4","augmented 3","perfect 4","augmented 4","diminished 5","perfect 5","augmented 5","minor 6","major 6","augmented 6","minor 7","major 7","diminished 8","augmented 7","perfect 8"]},custom:{0:Math.pow(2,0),1:Math.pow(2,1/12),2:Math.pow(2,2/12),3:Math.pow(2,.25),4:Math.pow(2,4/12),5:Math.pow(2,5/12),6:Math.pow(2,.5),7:Math.pow(2,7/12),8:Math.pow(2,8/12),9:Math.pow(2,.75),10:Math.pow(2,10/12),11:Math.pow(2,11/12),pitchNumber:12,interval:["perfect 1","minor 2","major 2","minor 3","major 3","perfect 4","diminished 5","perfect 5","minor 6","major 6","minor 7","major 7","perfect 8"]}},MIDI_INSTRUMENTS={default:0,piano:0,violin:40,viola:41,cello:42,"double bass":43,bass:32,sitar:104,guitar:24,"acoustic guitar":25,"electric guitar":27,flute:73,clarinet:71,saxophone:65,tuba:58,trumpet:56,oboe:68,trombone:57,banjo:105,koto:107,dulcimer:15,bassoon:70,celeste:8,xylophone:13,"electronic synth":81,sine:81,square:80,sawtooth:81,triangle:81,vibraphone:11},DRUM_MIDI_MAP={"snare drum":38,"kick drum":36,"tom tom":41,"floor tom tom":43,"cup drum":47,"darbuka drum":50,"japanese drum":56,"hi hat":42,"ride bell":53,"cow bell":56,"triangle bell":81,"finger cymbals":69,chime:82,gong:52,clang:55,crash:49,clap:39,slap:40,raindrop:88},REVERSE_DRUM_MIDI_MAP={38:["snare drum"],36:["kick drum"],41:["tom tom"],43:["floor tom tom"],47:["cup drum"],50:["darbuka drum"],56:["japanese drum","cow bell"],42:["hi hat"],53:["ride bell"],81:["triangle bell"],69:["finger cymbals"],82:["chime"],52:["gong"],55:["clang"],49:["crash"],39:["clap"],40:["slap"],88:["raindrop"]},getMidiInstrument=function(){return MIDI_INSTRUMENTS},getMidiDrum=function(){return DRUM_MIDI_MAP},getReverseDrumMidi=function(){return REVERSE_DRUM_MIDI_MAP},setOctaveRatio=function(e){octaveRatio=e},getOctaveRatio=function(){return octaveRatio},getTemperamentsList=function(){return TEMPERAMENTS},getTemperament=function(e){return TEMPERAMENT[e]},getTemperamentKeys=function(){var e=[];for(var t in TEMPERAMENT)e.push(t);return e},addTemperamentToList=function(e){for(var t=0;t<TEMPERAMENTS.length;t++)if(PreDefinedTemperaments[t]===e)return;TEMPERAMENTS.push(e)},deleteTemperamentFromList=function(e){delete TEMPERAMENT[e]},addTemperamentToDictionary=function(e,t){TEMPERAMENT[e]=t},updateTemperaments=function(){for(var e in TEMPERAMENTS=[].concat(INITIALTEMPERAMENTS),TEMPERAMENT)e in PreDefinedTemperaments||TEMPERAMENTS.push([_(e),e,e])},DEFAULTINVERT="even",DEFAULTINTERVAL="perfect 5",DEFAULTVOICE="electronic synth",DEFAULTNOISE="noise1",DEFAULTDRUM="kick drum",DEFAULTEFFECT="duck",DEFAULTMODE="major",DEFAULTTEMPERAMENT="equal",DEFAULTFILTERTYPE="highpass",DEFAULTOSCILLATORTYPE="sine",DEFAULTACCIDENTAL="natural "+NATURAL,customMode=MUSICALMODES.custom,getInvertMode=function(e){for(var t in INVERTMODES)if(INVERTMODES[t][0]===e||INVERTMODES[t][1].toLowerCase()===e.toLowerCase())return""!=INVERTMODES[t][0]?INVERTMODES[t][0]:INVERTMODES[t][1];return e},getIntervalNumber=function(e){return INTERVALVALUES[e][0]},getIntervalDirection=function(e){return INTERVALVALUES[e][1]},getIntervalRatio=function(e){return INTERVALVALUES[e][2]},getModeNumbers=function(e){for(var t in MUSICALMODES)if(t===e.toLowerCase())return function(e){for(var t=0,r="",n=0;n<e.length;n++)r+=t.toString(),n<e.length-1&&(r+=" "),t+=e[n];return r}(MUSICALMODES[t]);return""},getDrumIndex=function(e){""!==e&&"http"!==e.slice(0,4)||(e=DEFAULTDRUM);for(var t=0;t<DRUMNAMES.length;t++){if(DRUMNAMES[t][0].toLowerCase()===e.toLowerCase())return t;if(DRUMNAMES[t][1].toLowerCase()===e.toLowerCase())return t}return-1},getDrumName=function(e){if(""===e)e=DEFAULTDRUM;else if("http"===e.slice(0,4))return null;for(var t=0;t<DRUMNAMES.length;t++){if(DRUMNAMES[t][0].toLowerCase()===e.toLowerCase())return DRUMNAMES[t][0];if(DRUMNAMES[t][1].toLowerCase()===e.toLowerCase())return DRUMNAMES[t][1]}return null},getDrumSymbol=function(e){if(""===e)return"hh";for(var t=0;t<DRUMNAMES.length;t++){if(DRUMNAMES[t][0].toLowerCase()===e.toLowerCase())return DRUMNAMES[t][3];if(DRUMNAMES[t][1].toLowerCase()===e.toLowerCase())return"hh"}return"hh"},getFilterTypes=function(e){""===e&&(e=DEFAULTFILTERTYPE);for(var t=0;t<FILTERTYPES.length;t++){if(FILTERTYPES[t][0].toLowerCase()===e.toLowerCase())return FILTERTYPES[t][0];if(FILTERTYPES[t][1].toLowerCase()===e.toLowerCase())return FILTERTYPES[t][1]}return DEFAULTFILTERTYPE},getOscillatorTypes=function(e){""===e&&(e=null);for(var t=0;t<OSCTYPES.length;t++){if(OSCTYPES[t][0].toLowerCase()===e.toLowerCase())return OSCTYPES[t][0];if(OSCTYPES[t][1].toLowerCase()===e.toLowerCase())return OSCTYPES[t][1]}return null},getDrumIcon=function(e){if(""===e)e=DEFAULTDRUM;else if("http"===e.slice(0,4))return"images/drum.svg";for(var t=0;t<DRUMNAMES.length;t++)if(DRUMNAMES[t][0]===e||DRUMNAMES[t][1].toLowerCase()===e.toLowerCase())return DRUMNAMES[t][2];return"images/drum.svg"},getDrumSynthName=function(e){if(null==e)return null;if(""===e)e=DEFAULTDRUM;else if("http"===e.slice(0,4))return e;for(var t=0;t<DRUMNAMES.length;t++)if(DRUMNAMES[t][0]===e||DRUMNAMES[t][1].toLowerCase()===e.toLowerCase())return DRUMNAMES[t][1];return DEFAULTDRUM},getNoiseName=function(e){""===e&&(e=DEFAULTNOISE);for(var t=0;t<NOISENAMES.length;t++)if(NOISENAMES[t][1]===e)return""!=NOISENAMES[t][0]?NOISENAMES[t][0]:NOISENAMES[t][1];return DEFAULTNOISE},getNoiseIcon=function(e){if(""===e)e=DEFAULTNOISE;else if("http"===e.slice(0,4))return"images/noises.svg";for(var t=0;t<NOISENAMES.length;t++)if(NOISENAMES[t][0]===e||NOISENAMES[t][1]===e)return NOISENAMES[t][2];return"images/synth.svg"},getNoiseSynthName=function(e){if(null==e)return null;""===e&&(e=DEFAULTNOISE);for(var t=0;t<NOISENAMES.length;t++)if(NOISENAMES[t][0]===e||NOISENAMES[t][1]===e)return NOISENAMES[t][1];return DEFAULTNOISE},getVoiceName=function(e){if(""===e)e=DEFAULTVOICE;else if("http"===e.slice(0,4))return null;for(var t=0;t<VOICENAMES.length;t++)if(VOICENAMES[t][0]===e){if(""!=VOICENAMES[t][0])return VOICENAMES[t][0];if(VOICENAMES[t][1]===e)return VOICENAMES[t][1]}return DEFAULTVOICE},getVoiceIcon=function(e){if(""===e)e=DEFAULTVOICE;else if("http"===e.slice(0,4))return"images/voices.svg";for(var t=0;t<VOICENAMES.length;t++)if(VOICENAMES[t][0]===e||VOICENAMES[t][1]===e)return VOICENAMES[t][2];for(var r=0;r<CUSTOMSAMPLES.length;r++)if(CUSTOMSAMPLES[r][0]===e||CUSTOMSAMPLES[r][1]===e)return CUSTOMSAMPLES[r][0];return"images/voices.svg"},getVoiceSynthName=function(e){if(null==e)return null;if(""===e)e=DEFAULTVOICE;else if("http"===e.slice(0,4))return e;for(var t=0;t<VOICENAMES.length;t++)if(VOICENAMES[t][0]===e||VOICENAMES[t][1]===e)return VOICENAMES[t][1];return DEFAULTVOICE},isCustomTemperament=function(e){return!(e in PreDefinedTemperaments)},getTemperamentName=function(e){""===e&&(e=DEFAULTTEMPERAMENT);for(var t=0;t<TEMPERAMENTS.length;t++){if(TEMPERAMENTS[t][0].toLowerCase()===e.toLowerCase())return TEMPERAMENTS[t][1];if(TEMPERAMENTS[t][1].toLowerCase()===e.toLowerCase())return TEMPERAMENTS[t][1]}return DEFAULTTEMPERAMENT},noteToObj=function(e){var t=parseInt(e.slice(e.length-1));return isNaN(t)?t=4:e=e.slice(0,e.length-1),[e,t]},frequencyToPitch=function(e){if(e<A0)return["A",0,0];if(C8<e)return["C",8,0];for(var t=0,r=0;r<9600;r++){var n=A0*Math.pow(TWELVEHUNDRETHROOT2,r);if(e<1.0003*n&&.9997*n<e){t=r%100;var a=Math.floor(r/100);return 50<t&&(t-=100,a+=1),[PITCHES[(a+PITCHES.indexOf("A"))%12],Math.floor((a+PITCHES.indexOf("A"))/12),t]}}return["?",-1,0]},getArticulation=function(e){return e.replace("do","").replace("re","").replace("mi","").replace("fa","").replace("sol","").replace("la","").replace("ti","").replace("A","").replace("B","").replace("C","").replace("D","").replace("E","").replace("F","").replace("G","").replace("^^","").replace("vv","").replace("^","").replace("v","")},keySignatureToMode=function(e){if(""===e||null==e)return["C","major"];e.toLowerCase()in MAQAMTABLE&&(e=MAQAMTABLE[e.toLowerCase()]);var t,r=e.split(" "),n=!1;if(1===r.length&&"m"===r[0][r[0].length-1]&&(n=!0,r[0]=r[0].slice(0,r[0].length-1)),(t=r[0]in BTOFLAT?BTOFLAT[r[0]]:r[0]in STOSHARP?STOSHARP[r[0]]:r[0])==="C"+FLAT?(r=e.split(" "),t="C"+FLAT):t=="B"+SHARP?(r=e.split(" "),t="B"+SHARP):t=="F"+FLAT?(r=e.split(" "),t="F"+FLAT):SOLFEGENAMES1.includes(t)?t=getNote(t,4,0,"C Major",!1)[0]:NOTESSHARP.includes(t)||NOTESFLAT.includes(t)||(console.debug("Invalid key or missing name; reverting to C."),r=(e="C "+e).split(" "),t="C"),n)return[t,"natural minor"];for(var a="",o=1;o<r.length;o++)""!==r[o]&&(""===a?a=r[o]:a+=" "+r[o]);return(a=""===a?"major":a.toLowerCase())in MUSICALMODES?[t,a]:(console.debug("Invalid mode name: "+a+" reverting to major."),[t,"major"])},SOLFMAPPER=["do","do","re","re","mi","fa","fa","sol","sol","la","la","ti"],getScaleAndHalfSteps=function(e){var t=keySignatureToMode(e),r=t[0],n="CUSTOM"===t[1]?customMode:MUSICALMODES[t[1]],a=[];if(7===n.length)for(var o=0;o<n.length;o++){a.push(SOLFEGENAMES[o]);for(var i=1;i<n[o];i++)a.push("")}else if(7<n.length)for(var s=0;s<n.length;s++){a.includes(SOLFMAPPER[s])?a.push(SOLFMAPPER[s]+SHARP):a.push(SOLFMAPPER[s]);for(var m=1;m<n[s];m++)a.push("")}else for(var u,c,l=0;l<n.length;l++){for(u=0,c=SOLFMAPPER[a.length];a.includes(c);)u+=1,c=SOLFMAPPER[a.length+u];a.push(c);for(var E=1;E<n[l];E++)a.push("")}var A=NOTESSHARP;return NOTESFLAT.includes(r)&&(A=NOTESFLAT),r in EXTRATRANSPOSITIONS&&(r=EXTRATRANSPOSITIONS[r][0]),[A,a,r,t[1]]},modeMapper=function(e,t){switch(e=e.toLowerCase(),t=t.toLowerCase()){case"ionian":t="major";break;case"dorian":switch(t="major",e){case"c":e="a"+SHARP;break;case"d":e="c";break;case"e":e="d";break;case"f":e="c",t="minor";break;case"g":e="f";break;case"a":e="g";break;case"b":e="a";break;case"c"+SHARP:case"d"+SHARP:e="b";break;case"f"+SHARP:e="f";break;case"g"+SHARP:e="b";break;case"a"+SHARP:e="g"+SHARP;break;case"d"+FLAT:case"e"+FLAT:e="e"+FLAT,t="minor";break;case"g"+FLAT:e="d",t="minor";break;case"a"+FLAT:e="e"+FLAT,t="minor";break;case"b"+FLAT:e="f",t="minor"}break;case"phrygian":switch(t="major",e){case"c":e="g"+SHARP;break;case"d":e="a"+SHARP;break;case"e":e="c";break;case"f":e="b";break;case"g":e="c",t="minor";break;case"a":e="f";break;case"b":e="g";break;case"c"+SHARP:e="a";break;case"d"+SHARP:e="b";break;case"f"+SHARP:e="d";break;case"g"+SHARP:e="e";break;case"a"+SHARP:e="b";break;case"d"+FLAT:e="g"+FLAT,t="minor";break;case"e"+FLAT:e="e"+FLAT,t="minor";break;case"g"+FLAT:e="d";break;case"a"+FLAT:e="d"+FLAT,t="minor";break;case"b"+FLAT:e="e"+FLAT,t="minor"}break;case"lydian":switch(t="major",e){case"c":e="g";break;case"d":e="a";break;case"e":e="b";break;case"f":e="c";break;case"g":e="d";break;case"a":e="e";break;case"b":e="b";break;case"c"+SHARP:e="g"+SHARP;break;case"d"+SHARP:e="a"+SHARP;break;case"f"+SHARP:e="b";break;case"g"+SHARP:e="c",t="minor";break;case"a"+SHARP:e="f";break;case"d"+FLAT:e="f",t="minor";break;case"e"+FLAT:e="g",t="minor";break;case"g"+FLAT:e="d"+FLAT,t="minor";break;case"a"+FLAT:e="c",t="minor";break;case"b"+FLAT:e="d",t="minor"}break;case"mixolydian":switch(t="major",e){case"c":e="f";break;case"d":e="g";break;case"e":e="a";break;case"f":e="a"+SHARP;break;case"g":e="c";break;case"a":e="d";break;case"b":e="e";break;case"c"+SHARP:e="b";break;case"d"+SHARP:e="g"+SHARP;break;case"f"+SHARP:case"g"+SHARP:e="b";break;case"a"+SHARP:e="c",t="minor";break;case"d"+FLAT:e="e"+FLAT,t="minor";break;case"e"+FLAT:e="f",t="minor";break;case"g"+FLAT:case"a"+FLAT:e="e"+FLAT,t="minor";break;case"b"+FLAT:e="c",t="minor"}break;case"locrian":switch(t="major",e){case"c":e="b";break;case"d":e="c",t="minor";break;case"e":e="f";break;case"f":e="b";break;case"g":e="g"+SHARP;break;case"a":e="a"+SHARP;break;case"b":e="c";break;case"c"+SHARP:e="d";break;case"d"+SHARP:e="e";break;case"f"+SHARP:e="g";break;case"g"+SHARP:e="a ";break;case"a"+SHARP:e="b";break;case"d"+FLAT:e="d";break;case"e"+FLAT:e="d"+FLAT,t="minor";break;case"g"+FLAT:e="f",t="minor";break;case"a"+FLAT:e="g"+FLAT,t="minor";break;case"b"+FLAT:e="d"+FLAT,t="minor"}break;case"aeolian":case"natural minor":t="minor"}return[e,t]},getSharpFlatPreference=function(e){var t=keySignatureToMode(e),r=modeMapper(t[0],t[1]),n=r[0]+" "+r[1];return SHARPPREFERENCE.includes(n)?"sharp":FLATPREFERENCE.includes(n)?"flat":"natural"},getCustomNote=function(e){e instanceof Array&&(e=e[0]);var t="";e.includes("(")&&(t=e.substring(e.indexOf("("),e.length)),e=e.replace(t,"");var r=getArticulation(e);switch(e=e.replace(r,""),r){case"bb":case DOUBLEFLAT:e=e+"ùÑ´"+t;break;case"b":case FLAT:e=e+"‚ô≠"+t;break;case"##":case"*":case"x":case DOUBLESHARP:e=e+"ùÑ™"+t;break;case"#":case SHARP:e=e+"‚ôØ"+t;break;default:e=e+r+t}return e},pitchToNumber=function(e,t,r){if("R"===e.toUpperCase())return 0;var n,a,o=0,i=e.length;1<i&&(2<i&&(a=e.slice(i-2),n=e.substring(1,i),"bb"===a||n===DOUBLEFLAT?(e=e.substring(0,1),o-=2):"*"===a||a===DOUBLESHARP?(e=e.substring(0,1),o+=2):"#b"!==a&&a!==SHARP+FLAT&&"b#"!==a&&a!==FLAT+SHARP||(e=e.slice(0,i-2))),1<e.length&&("b"===(n=e.slice(i-1))||n===FLAT?(e=e.slice(0,i-1),--o):"#"!==n&&n!==SHARP||(e=e.slice(0,i-1),o+=1)));var s,m;return 12*t+(PITCHES.includes(e)?PITCHES.indexOf(e.toUpperCase()):(s=getScaleAndHalfSteps(r))[1].includes(e.toLowerCase())?s[1].indexOf(e.toLowerCase()):(console.debug("pitch "+e+" not found in mode."),e.toLowerCase()in FIXEDSOLFEGE1?(m=FIXEDSOLFEGE1[e.toLowerCase()],s[0].indexOf(m)):0))-PITCHES.indexOf("A")+o},numberToPitchSharp=function(e){if(e<0){for(var t=0;e<0;)e+=12,t+=1;return[PITCHES2[(e+PITCHES2.indexOf("A"))%12],Math.floor((e+PITCHES2.indexOf("A"))/12)-t]}return[PITCHES2[(e+PITCHES2.indexOf("A"))%12],Math.floor((e+PITCHES2.indexOf("A"))/12)]},getNumber=function(e,t){var r,n=t<0?0:10<t?108:12*(t-1);return(e=String(e)).substring(0,1)in NOTESTEP&&(n+=NOTESTEP[e.substring(0,1)],1<=e.length&&("bb"===(r=e.substring(1))||r===DOUBLEFLAT?n-=2:"##"===r||"*"===r||r===DOUBLESHARP?n+=2:"b"===r||r===FLAT?--n:"#"!==r&&r!==SHARP||(n+=1))),n},getNoteFromInterval=function(e,t){function r(e){var t=INTERVALVALUES[e][0],r=numberToPitch(h+t),n=e.split(" "),a=f.indexOf(T)+Number(n[n.length-1])-1,o=S;6<a&&(a-=7,o=S+1);var i=f[a];if(r[0].substring(0,1)===i)return[r[0],o];if(r[0].substring(0,1)!==i){if((r=numberToPitchSharp(h+t))[0]===i)return[r[0],o];var s=getNumber(i,o)-getNumber(p,S),m=g.indexOf("");return[r=i+g[m+t-s]+"",o]}}var n,a,o,i,s,m,u,c,l,E,A,d=e.length,T=e.substring(0,1),p=e.substring(0,d-1),S=Number(e.slice(-1)),h=pitchToNumber(p,S,"C major"),f=["C","D","E","F","G","A","B"],g=[DOUBLEFLAT,FLAT,"",SHARP,DOUBLESHARP];return"major 2"===t||"major 3"===t||"major 6"===t||"major 7"===t||"perfect 4"===t||"perfect 5"===t||"perfect 8"===t||"perfect 1"===t?r(t):(A=(n=t).split(" "),"minor 2"===n||"minor 3"===n||"minor 6"===n||"minor 7"===n?(s=(i=r("major "+A[A.length-1]))[0].substring(1,i[0].length),s=0===(m=g.indexOf(s))?g[m]+FLAT:g[m-1]):"down 4"===n||"down 5"===n||"down 8"===n?("down 4"===n?i=r("perfect 4"):"down 5"===n?i=r("perfect 5"):"down 8"===n&&(i=r("perfect 8")),s=i[0].substring(1,i[0].length),s=0===(m=g.indexOf(s))?g[m]+FLAT:g[m-1]):"down-diminished 5"===n?(s=(i=r("perfect 5"))[0].substring(1,i[0].length),s=(m=g.indexOf(s))<=1?g[0]+FLAT:g[m-2]):"diminished 2"===n?(s=(i=r("perfect 1"))[0].substring(1,i[0].length),s=0===(m=g.indexOf(s))?g[m]+FLAT:g[m-1]):n.startsWith("diminished ")?(a=n.split(" ")[1],o=["4","5","8"].includes(a)?"perfect "+a:"major "+a,s=(i=r(o))[0].substring(1,i[0].length),s=0===(m=g.indexOf(s))?g[m]+FLAT:g[m-1]):"up 4"===n||"up 5"===n||"up-augmented 4"===n?("up 4"===n||"up-augmented 4"===n?i=r("perfect 4"):"up 5"===n&&(i=r("perfect 5")),s=i[0].substring(1,i[0].length),s=4===(m=g.indexOf(s))?g[m]+SHARP:g[m+1]):"augmented 1"===n?(s=(i=r("perfect 1"))[0].substring(1,i[0].length),s=4===(m=g.indexOf(s))?g[m]+SHARP:g[m+1]):"augmented 2"===n||"augmented 3"===n||"augmented 4"===n||"augmented 5"===n||"augmented 6"===n||"augmented 7"===n||"augmented 8"===n?(u=n.split(" ")[1],s=(i=["1","4","5","8"].includes(u)?r("perfect "+u):r("major "+u))[0].substring(1,i[0].length),s=4===(m=g.indexOf(s))?g[m]+SHARP:g[m+1]):"up-major 2"===n||"up-major 3"===n||"up-major 6"===n||"up-major 7"===n?(c=n.split(" ")[1],s=(i=r("major "+c))[0].substring(1,i[0].length),s=4===(m=g.indexOf(s))?g[m]+SHARP:g[m+1]):"down-minor 3"===n||"down-minor 6"===n||"down-minor 7"===n?(l=n.split(" ")[1],s=(i=r("major "+l))[0].substring(1,i[0].length),s=(m=g.indexOf(s))<=1?g[0]+FLAT:g[m-2]):"mid 2"!==n&&"mid 3"!==n&&"mid 6"!==n&&"mid 7"!==n||(E=n.split(" ")[1],s=(i=r("major "+E))[0].substring(1,i[0].length),s=0===(m=g.indexOf(s))?g[m]+FLAT:g[m-1]),[i[0].substring(0,1)+s+"",i[1]])},numberToPitch=function(e,t,r,n){void 0===t&&(t="equal");var a=0;if(e<0){for(;e<0;)e+=12,a+=1;if("equal"===t)return[PITCHES[(e+PITCHES.indexOf("A"))%12],Math.floor((e+PITCHES.indexOf("A"))/12)-a];m=Math.floor(e-n)}else{if("equal"===t)return[PITCHES[(e+PITCHES.indexOf("A"))%12],Math.floor((e+PITCHES.indexOf("A"))/12)];m=Math.floor(e-n)}if(isCustomTemperament(t)){var o=TEMPERAMENT[t].pitchNumber,i=m%o,s=Math.floor(m/o),m=i+"";if(void 0===TEMPERAMENT[t][m]){for(var u=0;u<12;u++){var c=""+u,l=TEMPERAMENT.equal.interval[e];TEMPERAMENT[t][c]=[Math.pow(2,u/12),getNoteFromInterval(r,l)[0],getNoteFromInterval(r,l)[1]]}return[TEMPERAMENT[t][m][1],TEMPERAMENT[t][m][2]]}var E=Number(TEMPERAMENT[t][m][2])+s;return[TEMPERAMENT[t][m][1],E]}return l=TEMPERAMENT[t].interval[m],getNoteFromInterval(r,l)},GetNotesForInterval=function(e){var t,r,n=e.singer.noteStatus,a=e.singer.notePitches,o=e.singer.intervals,i=e.singer.noteOctaves,s="C",m="C",u=0;if(n&&n[0]){if(s=n[0][0].replace(/\d/g,""),!n[0][1])return{firstNote:s,secondNote:s,octave:u};m=n[0][1].replace(/\d/g,"");var c=parseInt(n[0][0].replace(/[^0-9]/g,"")),u=parseInt(n[0][1].replace(/[^0-9]/g,""))-c}else{a&&(s=(t=a[last(e.singer.inNoteBlock)])[0],m=t[t.length-1])}return o&&o.length?u=Math.floor(o[0]/7):i&&i[last(e.singer.inNoteBlock)]&&(u=(r=i[last(e.singer.inNoteBlock)])[r.length-1]-r[0]),s=s.replace("‚ô≠","b"),m=m.replace("‚ô≠","b"),{firstNote:s=s.replace("‚ôØ","#"),secondNote:m=m.replace("‚ôØ","#"),octave:u}};function base64Encode(e){var t=(new TextEncoder).encode(e);return String.fromCharCode.apply(String,_toConsumableArray(t))}function getNote(e,t,r,n,a,o,i,s){void 0===s&&(s="equal");var m,u,c,l,E,A,d,T,p,S=!1,h=!1,f=!1,g=0,L=0;if(void 0===r&&(r=0),r<0?(L=(r=-r)-(g=Math.floor(r)),g=-g,L=100*-L,r=-r):L=100*(r-(g=Math.floor(r))),"number"!=typeof e){if(">"===e.substr(-1)&&(t=parseInt(e.slice(e.indexOf(">")+1,e.indexOf("/")-1)),e=e.substr(0,e.indexOf("<"))),"rest"===e.toLowerCase().substr(0,4)||"r"===e.toLowerCase().substr(0,4))return["R","",0];var b=e;["#",SHARP,FLAT,"b"].includes(e.substr(-1))&&(b=e.slice(0,e.length-1)),isNaN(b)||(["#",SHARP].includes(e.substr(-1))?g+=1:["b",FLAT].includes(e.substr(-1))&&--g,e=Number(b))}if(t=Math.round(t),"number"==typeof e&&(n=n||"C major",m=0,a&&(-1===(m=PITCHES.indexOf(n.split(" ")[0]))&&(m=PITCHES.indexOf(n.split(" ")[0])),-1===m&&(m=PITCHES2.indexOf(n.split(" ")[0])),-1===m&&(m=0,console.log("Cannot find "+n.split(" ")[0]+". Reverting to C"))),e="sharp"===getSharpFlatPreference(n)?PITCHES2[(e+m)%12]:PITCHES[(e+m)%12]),s in PreDefinedTemperaments){switch(u=getArticulation(e),e=e.replace(u,""),u){case"bb":case DOUBLEFLAT:e+="b",h=!0,--g;break;case"b":case FLAT:e+="b",h=!0;break;case"##":case"*":case"x":case DOUBLESHARP:e+="#",f=!0,g+=1;break;case"#":case SHARP:e+="#",f=!0}if(!f&&e in BTOFLAT?e=BTOFLAT[e]:e in STOSHARP&&(e=STOSHARP[e]),e in EXTRATRANSPOSITIONS)t+=EXTRATRANSPOSITIONS[e][1],j=EXTRATRANSPOSITIONS[e][0];else if(NOTESSHARP.includes(e.toUpperCase()))j=e.toUpperCase();else if(NOTESFLAT.includes(e))j=e;else if(NOTESFLAT2.includes(e))j=NOTESFLAT[NOTESFLAT2.indexOf(e)];else{["#",SHARP,FLAT,"b"].includes(e.substr(-1))&&(S=!0),n=n||"C major";var N,O,M,P,F,R=(c=getScaleAndHalfSteps(a?n:"C major"))[0],I=c[1],w=c[2],D=c[3];if(a?(-1===(N=R.indexOf(w))&&(console.debug("WARNING: Key "+w+" not found in "+R+". Using default of C"),N=0,R=NOTESSHARP),5<N&&(g-=12)):N=0,S&&("#"===e.substr(-1)||e.substr(-1)===SHARP?N+=1:e.substr(-1)!==FLAT&&"b"!==e.substr(-1)||--N),M=I.includes(e.substr(0,1).toLowerCase())?e.substr(0,1).toLowerCase():I.includes(e.substr(0,2).toLowerCase())?e.substr(0,2).toLowerCase():I.includes(e.substr(0,3).toLowerCase())?e.substr(0,3).toLowerCase():(O=_("ti la sol fa mi re do").split(" ")).includes(e.substr(0,1).toLowerCase())||O.includes(e.substr(0,2).toLowerCase())?SOLFNOTES[O.indexOf(e.substr(0,2).toLowerCase())]:O.includes(e.substr(0,3).toLowerCase())?SOLFNOTES[O.indexOf(e.substr(0,3).toLowerCase())]:e.substr(0,2).toLowerCase(),a)switch(D){case"dorian":0<(P=SOLFEGENAMES.indexOf(M))&&(g+=12),g-=12,6<(P+=6)&&(P-=7),M=SOLFEGENAMES[P];break;case"phrygian":1<(P=SOLFEGENAMES.indexOf(M))&&(g+=12),6<(P+=5)&&(P-=7),M=SOLFEGENAMES[P];break;case"lydian":2<(P=SOLFEGENAMES.indexOf(M))&&(g+=12),6<(P+=4)&&(P-=7),M=SOLFEGENAMES[P];break;case"mixolydian":3<(P=SOLFEGENAMES.indexOf(M))&&(g+=12),6<(P+=3)&&(P-=7),M=SOLFEGENAMES[P];break;case"minor":case"aeolian":4<(P=SOLFEGENAMES.indexOf(M))&&(g+=12),6<(P+=2)&&(P-=7),M=SOLFEGENAMES[P];break;case"locrian":5<(P=SOLFEGENAMES.indexOf(M))&&(g+=12),6<(P+=1)&&(P-=7),M=SOLFEGENAMES[P]}if(!I.includes(M))return console.debug("WARNING: Note ["+e+"] not found in "+I+". Returning REST"),null!=i&&i(INVALIDPITCH,null),["R","",0];11<(F=I.indexOf(M)+N)?(F-=12,t+=1):F<0&&(F+=12,--t),(j=R[F])in EXTRATRANSPOSITIONS&&(t+=EXTRATRANSPOSITIONS[j][1],j=EXTRATRANSPOSITIONS[j][0])}switch(g&&0!==g&&(p=g<0?(l=-Math.floor(-g/12),- -g%12):(l=Math.floor(g/12),g%12),t+=l,0<p?NOTESSHARP.includes(j)?(E=NOTESSHARP.indexOf(j),(E+=p)<0?(E+=12,--t):11<E&&(E-=12,t+=1),j=NOTESSHARP[E]):NOTESFLAT.includes(j)?(A=NOTESFLAT.indexOf(j),(A+=p)<0?(A+=12,--t):11<A&&(A-=12,t+=1),j=NOTESFLAT[A]):console.debug("note not found? "+j):p<0&&(NOTESFLAT.includes(j)?(d=NOTESFLAT.indexOf(j),(d+=p)<0?(d+=12,--t):11<d&&(d-=12,t+=1),j=NOTESFLAT[d]):NOTESSHARP.includes(j)?(T=NOTESSHARP.indexOf(j),(T+=p)<0?(T+=12,--t):11<T&&(T-=12,t+=1),j=NOTESSHARP[T]):console.debug("note not found? "+j))),getSharpFlatPreference(n)){case"flat":j in EQUIVALENTFLATS&&(j=EQUIVALENTFLATS[j]);break;case"sharp":j in EQUIVALENTSHARPS&&(j=EQUIVALENTSHARPS[j]);break;case"natural":j in EQUIVALENTNATURALS&&(j=EQUIVALENTNATURALS[j])}if(null!=o)switch(o){case-1:j in EQUIVALENTFLATS&&(j=EQUIVALENTFLATS[j]);break;case 1:j in EQUIVALENTSHARPS&&(j=EQUIVALENTSHARPS[j])}f?j in EQUIVALENTSHARPS&&(j=EQUIVALENTSHARPS[j]):h&&j in EQUIVALENTFLATS&&(j=EQUIVALENTFLATS[j])}else if(isCustomTemperament(s)){j=getCustomNote(e);var H=null;for(var C in TEMPERAMENT[s])if("pitchNumber"!==C&&"interval"!=C){if(j===TEMPERAMENT[s][C][3]){H="string"==typeof C?Number(C):C;break}if(j===TEMPERAMENT[s][C][1]){H="string"==typeof C?Number(C):C;break}}if(null===H||"null"===H)return getNote(e,t,g,n,a,o,i);var v,y,U=t,x=TEMPERAMENT[temperamentFloor].pitchNumber;0!==g&&(y=g<0?(v=-Math.floor(-g/x),- -g%x):(v=Math.floor(g/x),g%x),U+=v,H+=y),H<0?(H+=x,--U):x<=H&&(H-=x,U+=1),H+="",j=3<TEMPERAMENT[s][H].length?TEMPERAMENT[s][H][3]:TEMPERAMENT[s][H][1],t=U}else{switch(u=getArticulation(e),e=e.replace(u,""),SOLFEGENAMES.includes(e)&&(e=FIXEDSOLFEGE[e]),u){case"bb":case DOUBLEFLAT:e+="ùÑ´";break;case"b":case FLAT:e+="b";break;case"##":case"*":case"x":case DOUBLESHARP:e+="ùÑ™";break;case"#":case SHARP:e+="#"}var k,j=e;if(g&&0!==g){var B,V,G=g<0?(k=-Math.floor(-g/12),- -g%12):(k=Math.floor(g/12),r%12);if(t+=k,0<G){for(var q in B=j+""+t,INTERVALVALUES)if(G===INTERVALVALUES[q][0]){V=getNoteFromInterval(B,q);break}}else if(G<0){for(var $ in B=j+""+(t-1),INTERVALVALUES)if(12+G===INTERVALVALUES[$][0]){V=getNoteFromInterval(B,$);break}}else 0===G&&(V=getNoteFromInterval(B=j+""+t,"perfect 1"));j=V[0],t=V[1]}}return t<1?[j,1,L]:10<t?[j,10,L]:[j,t,L]}var _module$exports,_calculate_pitch_number=function(t,e,r){var n;if(null!==r.singer.lastNotePlayed)n=("string"==typeof e?noteToObj:frequencyToPitch)(e);else if(r.singer.inNoteBlock in r.singer.notePitches&&0<r.singer.notePitches[last(r.singer.inNoteBlock)].length)n=getNote(r.singer.notePitches[last(r.singer.inNoteBlock)][0],r.singer.noteOctaves[last(r.singer.inNoteBlock)][0],0,r.singer.keySignature,r.singer.movable,null,t.errorMsg);else try{n=("string"==typeof e?noteToObj:frequencyToPitch)(e)}catch(e){t.errorMsg(INVALIDPITCH),n=["G",4]}return pitchToNumber(n[0],n[1],r.singer.keySignature)-r.singer.pitchNumberOffset},buildScale=function(e){if("C‚ô≠ major"==e)return[["C"+FLAT,"D"+FLAT,"E"+FLAT,"F"+FLAT,"G"+FLAT,"A"+FLAT,"B"+FLAT,"C"+FLAT],[2,2,1,2,2,2,1]];if("F‚ô≠ major"==e)return[["F"+FLAT,"G"+FLAT,"A"+FLAT,"B"+DOUBLEFLAT,"C"+FLAT,"D"+FLAT,"E"+FLAT,"F"+FLAT],[2,2,1,2,2,2,1]];var t,r,n=keySignatureToMode(e),a=n[0];a=="C"+FLAT&&(a=(n=keySignatureToMode("B "+n[1]))[0]),t="CUSTOM"===n[1]?customMode:MUSICALMODES[n[1]];var o=(r=NOTESFLAT.includes(a)?SHARPPREFERENCE.includes(n[0].toLowerCase()+" "+n[1])?NOTESSHARP:NOTESFLAT:FLATPREFERENCE.includes(n[0].toLowerCase()+" "+n[1])?NOTESFLAT:NOTESSHARP).indexOf(a);-1===o&&(o=0);for(var i=[a],s=o,m=0;m<t.length;m++)s+=t[m],i.push(r[s%SEMITONES]);if(i.length<9){for(var u=0;u<i.length-1;u++)0===u?i[u][0]===i[u+1][0]&&i[u+1]in CONVERT_UP&&(i[u+1]=CONVERT_UP[i[u+1]]):r===NOTESSHARP?i[u][0]===i[u+1][0]&&i[u]in CONVERT_DOWN&&(i[u]=CONVERT_DOWN[i[u]]):i[u-1][0]===i[u][0]&&i[u]in CONVERT_UP&&(i[u]=CONVERT_UP[i[u]]);if(2===a.length&&a[1]===SHARP)for(var c=i.length-1;0<c;c--)i[c][0]===i[c-1][0]&&(i[c-1]in CONVERT_DOWN?i[c-1]=CONVERT_DOWN[i[c-1]]:i[c-1]in CONVERT_DOUBLE_DOWN&&(i[c-1]=CONVERT_DOUBLE_DOWN[i[c-1]]));else if(2===a.length&&a[1]===FLAT)for(var l=0;l<i.length-2;l++)i[l][0]===i[l+1][0]&&(i[l+1]in CONVERT_UP?i[l+1]=CONVERT_UP[i[l+1]]:i[l+1]in CONVERT_DOUBLE_UP&&(i[l+1]=CONVERT_DOUBLE_UP[i[l+1]]))}return[i,t]},_getStepSize=function(e,n,t,r,a){if(void 0===a&&(a="equal"),isCustomTemperament(a))return r;var o=n,i=buildScale(e),s=i[0],m=i[1];o in BTOFLAT?o=BTOFLAT[o]:o in STOSHARP&&(o=STOSHARP[o]);var u=s.findIndex(function(e){return(t=e)==(r=n)||t=="E"+SHARP&&"F"==r||"E"==t&&r=="F"+FLAT||"F"==t&&"E‚ôØ"==r||t=="F"+FLAT&&"E"==r||t=="B"+SHARP&&"C"==r||"B"==t&&r=="C"+FLAT||"C"==t&&"B‚ôØ"==r||t=="C"+FLAT&&"B"==r||t=="B"+DOUBLEFLAT&&"A"==r||t=="F"+DOUBLESHARP&&"G"==r;var t,r});if(-1!==u)return"up"===t?m[u]:0<u?-m[u-1]:-last(m);if(-1===u&&o in EQUIVALENTFLATS&&(u=s.indexOf(EQUIVALENTFLATS[o])),-1===u&&o in EQUIVALENTSHARPS&&(u=s.indexOf(EQUIVALENTSHARPS[o])),-1===u&&o in EQUIVALENTNATURALS&&(u=s.indexOf(EQUIVALENTNATURALS[o])),-1!==u)return"up"===t?m[u]:0<u?-m[u-1]:-last(m);var c=0,l=PITCHES.indexOf(o);if(-1!==l){for(;!s.includes(o);)-1===(l=PITCHES.indexOf(o))&&(l=PITCHES2.indexOf(o)),"up"===t?(o=PITCHES[(l+=1)%12],c+=1):(--l<0&&(l+=12),o=PITCHES[l],--c);return c}if(-1===(l=PITCHES2.indexOf(o)))return console.debug(o+" not found"),0;for(;!s.includes(o);)-1===(l=PITCHES2.indexOf(o))&&(l=PITCHES.indexOf(o)),"up"===t?(o=PITCHES2[(l+=1)%12],c+=1):(--l<0&&(l+=12),o=PITCHES2[l],--c);return c},getStepSizeUp=function(e,t,r,n){return _getStepSize(e,t,"up",r,n)},getStepSizeDown=function(e,t,r,n){return _getStepSize(e,t,"down",r,n)},getModeLength=function(e){return buildScale(e)[1].length},scaleDegreeToPitchMapping=function(e,t,r,n){null===n&&--t;var a=keySignatureToMode(e),o=buildScale(e),i=o[0],s=o[1],m=[0],u=[],c=[],l=[];if(r){if(c=buildScale(a[0]+" major")[0],null===n)return c[t];if(null==t){for(var E in c)c[E][0]==n[0]&&(l.push(String(Number(E)+1)),c[E]==n?l.push(NATURAL):c[E].includes(SHARP)||c[E].includes(FLAT)?l.push(FLAT):n.includes(SHARP)?l.push(SHARP):n.includes(FLAT)&&l.push(FLAT));return l}}else if(7==s.length){if(null===n)return i[t];if(null==t){for(var A in i)i[A][0]==n[0]&&(l.push(String(Number(A)+1)),i[A]==n?l.push(NATURAL):i[A].includes(SHARP)||i[A].includes(FLAT)?l.push(FLAT):n.includes(SHARP)?l.push(SHARP):n.includes(FLAT)&&l.push(FLAT));return l}}else if(s.length<7){for(var d=buildScale(a[0]+" major")[0],T=0;T<s.length;T++){switch(m[T]){case 0:u.push(1);break;case 1:case 2:u.push(2);break;case 3:case 4:u.push(3);break;case 5:u.push(4);break;case 6:4!==u[u.length-1]?u.push(4):m[T]+i[T]!=7&&u.push(5);break;case 7:u.push(5);break;case 8:case 9:u.push(6);break;case 10:case 11:u.push(7);break;default:continue}m.push(m[T]+s[T])}for(var p=0,S=0;S<7;S++)u.includes(S+1)?(c.push(i[p]),p++):c.push(d[S]);if(null===n)return c[t];if(null==t){for(var h in c)c[h][0]==n[0]&&(l.push(String(Number(h)+1)),c[h]==n?l.push(NATURAL):c[h].includes(SHARP)||c[h].includes(FLAT)?l.push(FLAT):n.includes(SHARP)?l.push(SHARP):n.includes(FLAT)&&l.push(FLAT));return l}}else{for(var f=0;f<s.length;f++)m.push(m[f]+s[f]);for(var g=0;g<m.length;g++)switch(m[g]){case 0:c.push(i[g]);break;case 1:2==m[g+1]?c.push(i[g+1]):c.push(i[g]);break;case 2:if(1==m[g-1])continue;c.push(i[g]);break;case 3:4==m[g+1]?c.push(i[g+1]):c.push(i[g]);break;case 4:if(3==m[g-1])continue;c.push(i[g]);break;case 5:c.push(i[g]);break;case 6:(5==m[g-1]&&7!=m[g+1]||5!=m[g-1]&&7==m[g+1])&&c.push(i[g]);break;case 7:c.push(i[g]);break;case 8:9==m[g+1]?c.push(i[g+1]):c.push(i[g]);break;case 9:if(8==m[g-1])continue;c.push(i[g]);break;case 10:11==m[g+1]?c.push(i[g+1]):c.push(i[g]);break;case 11:if(10==m[g-1])continue;c.push(i[g])}if(null===n)return c[t];if(null==t){for(var L in c)c[L][0]==n[0]&&(l.push(String(Number(L)+1)),c[L]==n?l.push(NATURAL):c[L].includes(SHARP)||c[L].includes(FLAT)?l.push(FLAT):n.includes(SHARP)?l.push(SHARP):n.includes(FLAT)&&l.push(FLAT));return l}}},nthDegreeToPitch=function(e,t){var r=buildScale(e)[0];return r[t%=r.length-1]},getInterval=function(e,t,r){var n,a=buildScale(t),o=a[0],i=a[1];if(SOLFEGENAMES.includes(r)&&(r=FIXEDSOLFEGE[r]),r in BTOFLAT)r=BTOFLAT[r],n=o.indexOf(r);else if(r in STOSHARP)r=STOSHARP[r],n=o.indexOf(r);else if(o.includes(r))n=o.indexOf(r);else{-1===(n=o.indexOf(r))&&r in EQUIVALENTFLATS&&(n=o.indexOf(EQUIVALENTFLATS[r])),-1===n&&r in EQUIVALENTSHARPS&&(n=o.indexOf(EQUIVALENTSHARPS[r])),-1===n&&r in EQUIVALENTNATURALS&&(n=o.indexOf(EQUIVALENTNATURALS[r]));var s=0;if(-1===n)if(PITCHES.includes(r)){for(;!(o.includes(r)||24<(s+=1));){var m=PITCHES.indexOf(r);r=0<e?PITCHES[(m+=1)%12]:(--m<0&&(m+=12),PITCHES[m])}n=o.indexOf(r)}else{if(!PITCHES2.includes(r))return console.debug(r+" not found"),0;for(;!(o.includes(r)||24<(s+=1));){var u=PITCHES2.indexOf(r);r=0<e?PITCHES2[(u+=1)%12]:(--u<0&&(u+=12),PITCHES2[u])}n=o.indexOf(r)}}var c=0;if(0===e)return 0;if(0<e){for(var l=0;l<e;l++)c+=i[(n+l)%i.length];return c}for(var E=0;e<E;E--){for(var A=(n+E-1)%i.length;A<0;)A+=i.length;c-=i[A]}return c},reducedFraction=function(e,t){var r=function e(t,r){return 0===r?t:e(r,t%r)}(e,t);return[1,2,4,8,16].includes(t/r)?e/r+"<br>&mdash;<br>"+t/r+"<br>"+NSYMBOLS[t/r]:e/r+"<br>&mdash;<br>"+t/r+"<br><br>"},toFraction=function(e){var t=!1;1<e&&(t=!0,e=1/e);for(var r,n=1,a=1,o=1;1e-8<Math.abs(n-e);)n<e?a+=1:(o+=1,a=parseInt(e*o)),n=a/o;return t&&(r=a,a=o,o=r),[a,o]},calcNoteValueToDisplay=function(e,t){var r,n,a,o=e/t,i=null,i=o in NSYMBOLS?"1<br>&mdash;<br>"+o.toString()+"<br>"+NSYMBOLS[o]:reducedFraction(t,e);return parseInt(o)<o&&(i=(i=parseInt(1.5*o))in NSYMBOLS?(r=toFraction(t/e),n=Number.isInteger(r[0])?0:2,a=Number.isInteger(r[1])?0:2,r[0].toFixed(n)+"<br>&mdash;<br>"+r[1].toFixed(a)+"<br>"+NSYMBOLS[i]+"."):(i=parseInt(1.75*o))in NSYMBOLS?(r=toFraction(t/e),n=Number.isInteger(r[0])?0:2,a=Number.isInteger(r[1])?0:2,r[0].toFixed(n)+"<br>&mdash;<br>"+r[1].toFixed(a)+"<br>"+NSYMBOLS[i]+".."):reducedFraction(t,e)),i},durationToNoteValue=function(e){for(var t,r=0;r<3;r++)if(t=e*(2-1/Math.pow(2,r)),POWER2.includes(t))return[t,r,null];for(var n=e,a=1;a<POWER2.length;a++)if(n<POWER2[a]){n=POWER2[a-1];break}POWER2.includes(n)||(n=128);for(var o=1;Math.floor(e/o)*o===e&&!(e/2<(o*=2)););return[1,0,[e/(o/=2),o],n]},noteToPitchOctave=function(e){var t=e.length;return[e.substring(0,t-1),Number(last(e))]},pitchToFrequency=function(e,t,r,n){var a=pitchToNumber(e,t,n);return 0===r?A0*Math.pow(TWELTHROOT2,a):A0*Math.pow(TWELVEHUNDRETHROOT2,100*a+r)},noteToFrequency=function(e,t){var r=noteToPitchOctave(e);return pitchToFrequency(r[0],r[1],0,t)},noteIsSolfege=function(e){return void 0===SOLFEGECONVERSIONTABLE[e]},getSolfege=function(e){return noteIsSolfege(e)?e:SOLFEGECONVERSIONTABLE[e]},splitSolfege=function(e){if(null==e||"string"!=typeof e)return["sol",""];var t,r=SOLFNOTES.includes(e)?(t=e,""):"sol"===e.slice(0,3)?(t="sol",4===e.length?e[3]:e[3]+e[4]):(t=e.slice(0,2),3===e.length?e[2]:e[2]+e[3]);return[t,r]},i18nSolfege=function(e){var t=_("ti la sol fa mi re do").split(" "),r=splitSolfege(e),n=SOLFNOTES.indexOf(r[0]);if(-1!==n)return t[n]+r[1];var a=Object.values(t).indexOf(r[0]);return-1!==a?SOLFNOTES[a]+r[1]:e},splitScaleDegree=function(e){return e?[e.slice(0,1),e.slice(1)]:[5,NATURAL]},getNumNote=function(e,t){var r=e+t,n=Math.floor(r/12),a=NOTESTABLE[r%=12];return"ti"===a[r]&&--n,[a,n+1]},calcOctave=function(t,e,r,n){if("number"==typeof e)return Math.max(1,Math.min(Math.floor(e),9));var a,o=SOLFEGENAMES1.includes(n)?FIXEDSOLFEGE1[n]:n,i=getNumber(o,t),s=getNumber(o,t+1),m=getNumber(o,t-1);r=null!=r?(r=r[0]).substring(0,r.length-1):"G";var u=getNumber(r,t),c=Math.abs(u-i),l=Math.abs(u-s),E=Math.abs(u-m);switch((c<=5||isNaN(c))&&(a=t),5<c&&5<l&&E<5&&(a=Math.max(t-1,1)),5<c&&l<5&&5<E&&(a=Math.min(t+1,9)),5<c&&5<l&&5<E&&(a=t),e){case _("current"):case"current":return a;case _("next"):case"next":return Math.min(a+1,10);case _("previous"):case"previous":return Math.max(a-1,1);default:try{return a||Math.floor(Number(e))}catch(e){return t}}},calcOctaveInterval=function(e){var t=0;switch(e){case 1:case _("next"):case"next":t=1;break;case-1:case _("previous"):case"previous":t=-1;break;case _("current"):case"current":case 0:t=0;break;case 2:t=2;break;case-2:t=-2;break;default:console.debug("Interval octave must be between -2 and 2."),t=0}return t},isInt=function(e){return!isNaN(e)&&parseInt(Number(e))===e&&!isNaN(parseInt(e,10))},convertFromSolfege=function(e){return e in FIXEDSOLFEGE1&&(e=FIXEDSOLFEGE1[e]),e in EQUIVALENTNATURALS&&(e=EQUIVALENTNATURALS[e]),e},convertFactor=function(e){switch(e){case.0625:return"16";case.125:return"8";case.09375:return"16.";case.1875:return"8.";case.21875:return"8..";case.25:return"4";case.3125:return"4 16";case.375:return"4.";case.4375:return"4..";case.5:return"2";case.5625:return"2 16";case.675:return"2 8";case.6875:return"2 8 16";case.75:return"2.";case.8125:return"2 4 16";case.875:return"2..";case.9375:return"2 4 8 16";case 1:return"1";default:return null}},getPitchInfo=function(e,t,r,n){var a,o,i;Number(r)?(a=(i=frequencyToPitch(r))[0],o=i[1],cents=i[2]):(a=r.substr(0,r.length-1),o=r[r.length-1]),a.includes(DOUBLESHARP)?a="B"===(a=a.replace(DOUBLESHARP,""))?"C"+SHARP:NOTESSHARP[NOTESSHARP.indexOf(a)+2]:a.includes(DOUBLEFLAT)&&(a="C"===(a=a.replace(DOUBLEFLAT,""))?"B"+FLAT:NOTESFLAT[NOTESFLAT.indexOf(a)-2]),a=a.replace("#",SHARP).replace("b",FLAT),buildScale(n.singer.keySignature)[0].includes(a)||(a in EQUIVALENTFLATS?a=EQUIVALENTFLATS[a]:a in EQUIVALENTSHARPS&&(a=EQUIVALENTSHARPS[a]));try{switch(t){case"alphabet":return a;case"alphabet class":case"letter class":return a[0];case"solfege syllable":case"solfege class":return"solfege class"===t&&(a=a.replace(SHARP).replace(FLAT)),!1===n.singer.movable?SOLFEGECONVERSIONTABLE[a]:SOLFEGENAMES[buildScale(n.singer.keySignature)[0].indexOf(a)];case"pitch class":return(pitchToNumber(a,o,n.singer.keySignature)-3)%12;case"scalar class":return scaleDegreeToPitchMapping(n.singer.keySignature,null,n.singer.movable,a)[0];case"scale degree":return(i=scaleDegreeToPitchMapping(n.singer.keySignature,null,n.singer.movable,a))[0]+i[1];case"nth degree":return buildScale(n.singer.keySignature)[0].indexOf(a);case"staff y":return["C","D","E","F","G","A","B"].indexOf(a[0])*YSTAFFNOTEHEIGHT+(o-4)*YSTAFFOCTAVEHEIGHT;case"pitch number":return _calculate_pitch_number(e,a,n);case"pitch in hertz":return e.logo.synth._getFrequency(a+o,e.logo.synth.changeInTemperament);case"pitch to color":return NOTESSHARP.includes(a)?8.33*NOTESSHARP.indexOf(a):NOTESFLAT.includes(a)?8.33*NOTESFLAT.indexOf(a):(console.debug("Pitch not found: "+a),0);case"pitch to shade":return 12.5*o;default:return"__INVALID_INPUT__"}}catch(e){console.debug("Waiting for note to play")}};"undefined"!=typeof module&&module.exports&&(module.exports=(_defineProperty(_module$exports={updateTemperaments:updateTemperaments,scaleDegreeToPitchMapping:scaleDegreeToPitchMapping,buildScale:buildScale,getNote:getNote,getModeLength:getModeLength,nthDegreeToPitch:nthDegreeToPitch,getInterval:getInterval,_calculate_pitch_number:_calculate_pitch_number,_getStepSize:_getStepSize,reducedFraction:reducedFraction,toFraction:toFraction,durationToNoteValue:durationToNoteValue,calcNoteValueToDisplay:calcNoteValueToDisplay,noteToPitchOctave:noteToPitchOctave,pitchToFrequency:pitchToFrequency,noteIsSolfege:noteIsSolfege,getSolfege:getSolfege,splitSolfege:splitSolfege,i18nSolfege:i18nSolfege,splitScaleDegree:splitScaleDegree,getNumNote:getNumNote,calcOctave:calcOctave,calcOctaveInterval:calcOctaveInterval,isInt:isInt,convertFromSolfege:convertFromSolfege,convertFactor:convertFactor,getPitchInfo:getPitchInfo,noteToFrequency:noteToFrequency,TEMPERAMENT:TEMPERAMENT,setOctaveRatio:setOctaveRatio,getOctaveRatio:getOctaveRatio},"TEMPERAMENT",TEMPERAMENT),_defineProperty(_module$exports,"TEMPERAMENTS",TEMPERAMENTS),_defineProperty(_module$exports,"INITIALTEMPERAMENTS",INITIALTEMPERAMENTS),_defineProperty(_module$exports,"PreDefinedTemperaments",PreDefinedTemperaments),_defineProperty(_module$exports,"getTemperamentsList",getTemperamentsList),_defineProperty(_module$exports,"getTemperament",getTemperament),_defineProperty(_module$exports,"getTemperamentKeys",getTemperamentKeys),_defineProperty(_module$exports,"addTemperamentToList",addTemperamentToList),_defineProperty(_module$exports,"deleteTemperamentFromList",deleteTemperamentFromList),_defineProperty(_module$exports,"addTemperamentToDictionary",addTemperamentToDictionary),_defineProperty(_module$exports,"updateTemperaments",updateTemperaments),_defineProperty(_module$exports,"DEFAULTINVERT",DEFAULTINVERT),_defineProperty(_module$exports,"DEFAULTMODE",DEFAULTMODE),_defineProperty(_module$exports,"customMode",customMode),_defineProperty(_module$exports,"getInvertMode",getInvertMode),_defineProperty(_module$exports,"getIntervalNumber",getIntervalNumber),_defineProperty(_module$exports,"getIntervalDirection",getIntervalDirection),_defineProperty(_module$exports,"getIntervalRatio",getIntervalRatio),_defineProperty(_module$exports,"getModeNumbers",getModeNumbers),_defineProperty(_module$exports,"getDrumIndex",getDrumIndex),_defineProperty(_module$exports,"getDrumName",getDrumName),_defineProperty(_module$exports,"getDrumSymbol",getDrumSymbol),_defineProperty(_module$exports,"getFilterTypes",getFilterTypes),_defineProperty(_module$exports,"getOscillatorTypes",getOscillatorTypes),_defineProperty(_module$exports,"getDrumIcon",getDrumIcon),_defineProperty(_module$exports,"getDrumSynthName",getDrumSynthName),_defineProperty(_module$exports,"getNoiseName",getNoiseName),_defineProperty(_module$exports,"getNoiseIcon",getNoiseIcon),_defineProperty(_module$exports,"getNoiseSynthName",getNoiseSynthName),_defineProperty(_module$exports,"getVoiceName",getVoiceName),_defineProperty(_module$exports,"getVoiceIcon",getVoiceIcon),_defineProperty(_module$exports,"getVoiceSynthName",getVoiceSynthName),_defineProperty(_module$exports,"isCustomTemperament",isCustomTemperament),_defineProperty(_module$exports,"getTemperamentName",getTemperamentName),_defineProperty(_module$exports,"noteToObj",noteToObj),_defineProperty(_module$exports,"frequencyToPitch",frequencyToPitch),_defineProperty(_module$exports,"getArticulation",getArticulation),_defineProperty(_module$exports,"keySignatureToMode",keySignatureToMode),_defineProperty(_module$exports,"getScaleAndHalfSteps",getScaleAndHalfSteps),_defineProperty(_module$exports,"modeMapper",modeMapper),_defineProperty(_module$exports,"getSharpFlatPreference",getSharpFlatPreference),_defineProperty(_module$exports,"getCustomNote",getCustomNote),_defineProperty(_module$exports,"pitchToNumber",pitchToNumber),_defineProperty(_module$exports,"numberToPitchSharp",numberToPitchSharp),_defineProperty(_module$exports,"getNumber",getNumber),_defineProperty(_module$exports,"getNoteFromInterval",getNoteFromInterval),_defineProperty(_module$exports,"numberToPitch",numberToPitch),_defineProperty(_module$exports,"GetNotesForInterval",GetNotesForInterval),_defineProperty(_module$exports,"base64Encode",base64Encode),_defineProperty(_module$exports,"getStepSizeUp",getStepSizeUp),_defineProperty(_module$exports,"getStepSizeDown",getStepSizeDown),_defineProperty(_module$exports,"ACCIDENTALNAMES",ACCIDENTALNAMES),_defineProperty(_module$exports,"ACCIDENTALVALUES",ACCIDENTALVALUES),_defineProperty(_module$exports,"NOTESFLAT",NOTESFLAT),_defineProperty(_module$exports,"NOTESSHARP",NOTESSHARP),_defineProperty(_module$exports,"NOTESTEP",NOTESTEP),_defineProperty(_module$exports,"MUSICALMODES",MUSICALMODES),_defineProperty(_module$exports,"SHARP",SHARP),_defineProperty(_module$exports,"FLAT",FLAT),_module$exports));
"use strict";var _this=void 0;global.DEFAULTVOLUME=100,global.TARGETBPM=120,global.TONEBPM=60;var Singer=require("../turtle-singer"),mockGlobals={getNote:jest.fn().mockReturnValue(["C",4]),isCustomTemperament:jest.fn(),getStepSizeUp:jest.fn().mockReturnValue(1),numberToPitch:jest.fn().mockReturnValue(["C",4]),pitchToNumber:jest.fn().mockReturnValue(60)};global.getNote=mockGlobals.getNote,global.isCustomTemperament=mockGlobals.isCustomTemperament,global.getStepSizeUp=mockGlobals.getStepSizeUp,global.numberToPitch=mockGlobals.numberToPitch,global.pitchToNumber=mockGlobals.pitchToNumber,global.last=jest.fn(function(e){return e[e.length-1]}),describe("Singer Class",function(){var t,e,o,n;beforeEach(function(){t={turtles:[],singer:new Singer(_this),synthVolume:{DEFAULTVOICE:[100]},inNoteBlock:[0],notePitches:{0:[]},noteOctaves:{0:[]},noteCents:{0:[]},noteHertz:{0:[]}},e={turtles:{ithTurtle:jest.fn().mockReturnValue(t),turtleList:[t]},logo:{synth:{setMasterVolume:jest.fn(),setVolume:jest.fn(),rampTo:jest.fn()},pitchDrumMatrix:{addRowBlock:jest.fn()},notation:{notationInsertTie:jest.fn(),notationRemoveTie:jest.fn()},firstNoteTime:null,stopTurtle:!1,inPitchDrumMatrix:!1,inMatrix:!1,clearNoteParams:jest.fn(),blockList:{mockBlk:{connections:[0,0]}}}},o={activity:e,synth:{setMasterVolume:jest.fn(),setVolume:jest.fn(),rampTo:jest.fn(),getFrequency:jest.fn(),getCustomFrequency:jest.fn()},inPitchDrumMatrix:!1,inMatrix:!1,clearNoteParams:jest.fn()},n=new Singer(t)}),test("should initialize with correct default values",function(){expect(n.turtle).toBe(t),expect(n.turtles).toBe(t.turtles),expect(n.defaultNoteValue).toBe(4),expect(n.register).toBe(0),expect(n.beatFactor).toBe(1),expect(n.currentOctave).toBe(4)}),test("should correctly add scalar transposition",function(){var e=Singer.addScalarTransposition(o,t,"C",4,2);expect(e).toEqual(["C",4])}),test("should correctly calculate scalar distance",function(){var e=Singer.scalarDistance(o,t,60,62);expect(e).toBeGreaterThan(0)}),test("should correctly calculate inversion",function(){var e=Singer.calculateInvert(o,t,"C",4);expect(e).toBe(0)}),test("should set master volume correctly",function(){Singer.setMasterVolume(o,50,"mockBlk"),expect(o.synth.setMasterVolume).toHaveBeenCalledWith(50,0,0)}),test("should set synth volume correctly",function(){Singer.setSynthVolume(o,t,"noise1",80,"mockBlk"),expect(o.synth.setVolume).toHaveBeenCalledWith(t,"noise1",3.2,"mockBlk")})});
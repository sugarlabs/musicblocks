"use strict";describe("Browser Action Behavior",function(){var t,o,e,n;beforeEach(function(){e=window.open,n=jest.fn(),window.open=n,t={browserAction:{onClicked:{addListener:jest.fn(function(e){t.browserAction.onClicked.callback=e})}},tabs:{create:jest.fn()},runtime:{onInstalled:{addListener:jest.fn(function(e){t.runtime.onInstalled.callback=e})}}},o={browserAction:{onClicked:{addListener:jest.fn(function(e){o.browserAction.onClicked.callback=e})}},runtime:{onInstalled:{addListener:jest.fn(function(e){o.runtime.onInstalled.callback=e})},getURL:jest.fn(function(e){return"chrome-extension://fake-id/".concat(e)})}},global.browser=t,global.chrome=o,Object.defineProperty(global.navigator,"userAgent",{writable:!0,value:""})}),afterEach(function(){jest.clearAllMocks(),delete global.browser,delete global.chrome,window.open=e}),it("should set up Firefox-specific listeners when user agent is Firefox",function(){navigator.userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0",jest.resetModules();var e=require("../background.js"),n=e.isFirefox;e.browserAction;expect(n).toBe(!0),expect(t.browserAction.onClicked.addListener).toHaveBeenCalledTimes(1),expect(t.runtime.onInstalled.addListener).toHaveBeenCalledTimes(1)}),it("should set up Chrome-specific listeners when user agent is not Firefox",function(){navigator.userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36",jest.resetModules();var e=require("../background.js"),n=e.isFirefox;e.browserAction;expect(n).toBe(!1),expect(o.browserAction.onClicked.addListener).toHaveBeenCalledTimes(1),expect(o.runtime.onInstalled.addListener).toHaveBeenCalledTimes(1)}),it("should create a new tab with index.html when browserAction is clicked in Firefox",function(){navigator.userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0",jest.resetModules(),require("../background.js"),t.browserAction.onClicked.callback({id:"tab-123"}),expect(t.tabs.create).toHaveBeenCalledWith({url:"index.html"})}),it("should create a new tab with index.html when extension is installed in Firefox",function(){navigator.userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0",jest.resetModules(),require("../background.js"),t.runtime.onInstalled.callback({reason:"install"}),expect(t.tabs.create).toHaveBeenCalledWith({url:"index.html"})}),it("should open index.html in a new window when browserAction is clicked in Chrome",function(){navigator.userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36",jest.resetModules(),require("../background.js"),o.browserAction.onClicked.callback({id:"tab-123"}),expect(window.open).toHaveBeenCalledWith("chrome-extension://fake-id/index.html"),expect(o.runtime.getURL).toHaveBeenCalledWith("index.html")}),it("should open index.html in a new window when extension is installed in Chrome",function(){navigator.userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36",jest.resetModules(),require("../background.js"),o.runtime.onInstalled.callback({reason:"install"}),expect(window.open).toHaveBeenCalledWith("chrome-extension://fake-id/index.html"),expect(o.runtime.getURL).toHaveBeenCalledWith("index.html")}),it("should properly export module values for Node.js environment",function(){navigator.userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0",jest.resetModules();var e=require("../background.js");expect(e.isFirefox).toBe(!0),expect(e.browserAction).toBe(t.browserAction),navigator.userAgent="Chrome",jest.resetModules();var n=require("../background.js");expect(n.isFirefox).toBe(!1),expect(n.browserAction).toBe(o.browserAction)})});
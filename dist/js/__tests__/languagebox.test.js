"use strict";var LanguageBox=require("../languagebox"),mockActivity={storage:{languagePreference:"enUS",kanaPreference:null},textMsg:jest.fn()};Object.defineProperty(global,"localStorage",{value:{getItem:jest.fn(),setItem:jest.fn()},writable:!0}),delete global.window.location,global.window.location={reload:jest.fn()},document.querySelectorAll=jest.fn(function(){return[]}),global._=jest.fn(function(e){return e}),describe("LanguageBox Class",function(){var t;beforeEach(function(){jest.clearAllMocks(),t=new LanguageBox(mockActivity)}),it("should reload the window when OnClick is called",function(){t.OnClick(),expect(global.window.location.reload).toHaveBeenCalled()}),it("should display 'already set' message when the selected language is the same",function(){localStorage.getItem.mockReturnValue("enUS"),mockActivity.textMsg.mockImplementation(),t._language="enUS",t.hide(),expect(mockActivity.textMsg).toHaveBeenCalledWith("Music Blocks is already set to this language.")}),it("should display the refresh message when a new language is selected",function(){localStorage.getItem.mockReturnValue("ja"),mockActivity.textMsg.mockImplementation(),t._language="enUS",t.hide(),expect(mockActivity.textMsg).toHaveBeenCalledWith(expect.stringContaining("Refresh your browser to change your language preference."))}),it("should display the correct message when hide is called for 'ja'",function(){localStorage.getItem.mockReturnValue("enUS"),mockActivity.textMsg.mockImplementation(),t._language="ja",t.hide(),expect(mockActivity.textMsg).toHaveBeenCalledWith(expect.stringContaining("言語を変えるには、ブラウザをこうしんしてください。"))}),it("should attach click listeners to language links when hide is called",function(){var e=[{addEventListener:jest.fn()},{addEventListener:jest.fn()}];document.querySelectorAll.mockReturnValue(e),t.hide(),e.forEach(function(e){expect(e.addEventListener).toHaveBeenCalledWith("click",expect.any(Function))})}),describe("Language selection methods",function(){it("should set language to enUS and call hide when enUS_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.enUS_onclick(),expect(t._language).toBe("enUS"),expect(e).toHaveBeenCalled()}),it("should set language to enUK and call hide when enUK_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.enUK_onclick(),expect(t._language).toBe("enUK"),expect(e).toHaveBeenCalled()}),it("should set language to ko and call hide when ko_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.ko_onclick(),expect(t._language).toBe("ko"),expect(e).toHaveBeenCalled()}),it("should set language to ja, set kanji preference, and call hide when ja_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.ja_onclick(),expect(t._language).toBe("ja-kanji"),expect(mockActivity.storage.kanaPreference).toBe("kanji"),expect(e).toHaveBeenCalled()}),it("should set language to ja, set kana preference, and call hide when kana_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.kana_onclick(),expect(t._language).toBe("ja-kana"),expect(mockActivity.storage.kanaPreference).toBe("kana"),expect(e).toHaveBeenCalled()}),it("should set language to es and call hide when es_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.es_onclick(),expect(t._language).toBe("es"),expect(e).toHaveBeenCalled()}),it("should set language to pt and call hide when pt_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.pt_onclick(),expect(t._language).toBe("pt"),expect(e).toHaveBeenCalled()}),it("should set language to zh_CN and call hide when zhCN_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.zhCN_onclick(),expect(t._language).toBe("zh_CN"),expect(e).toHaveBeenCalled()}),it("should set language to th and call hide when th_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.th_onclick(),expect(t._language).toBe("th"),expect(e).toHaveBeenCalled()}),it("should set language to hi and call hide when hi_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.hi_onclick(),expect(t._language).toBe("hi"),expect(e).toHaveBeenCalled()}),it("should set language to ibo and call hide when ibo_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.ibo_onclick(),expect(t._language).toBe("ibo"),expect(e).toHaveBeenCalled()}),it("should set language to ar and call hide when ar_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.ar_onclick(),expect(t._language).toBe("ar"),expect(e).toHaveBeenCalled()}),it("should set language to he and call hide when he_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.he_onclick(),expect(t._language).toBe("he"),expect(e).toHaveBeenCalled()}),it("should set language to te and call hide when te_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.te_onclick(),expect(t._language).toBe("te"),expect(e).toHaveBeenCalled()}),it("should set language to ayc and call hide when ayc_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.ayc_onclick(),expect(t._language).toBe("ayc"),expect(e).toHaveBeenCalled()}),it("should set language to quz and call hide when quz_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.quz_onclick(),expect(t._language).toBe("quz"),expect(e).toHaveBeenCalled()}),it("should set language to gug and call hide when gug_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.gug_onclick(),expect(t._language).toBe("gug"),expect(e).toHaveBeenCalled()}),it("should set language to ur and call hide when ur_onclick is called",function(){var e=jest.spyOn(t,"hide").mockImplementation();t.ur_onclick(),expect(t._language).toBe("ur"),expect(e).toHaveBeenCalled()})}),describe("Japanese kana handling",function(){it("should display kana message when Japanese language is selected with kana preference",function(){localStorage.getItem.mockReturnValue("enUS"),mockActivity.storage.kanaPreference="kana",mockActivity.textMsg.mockImplementation(),t._language="ja",t.hide(),expect(mockActivity.textMsg).toHaveBeenCalledWith(expect.stringContaining("げんごを かえるには、ブラウザを こうしんしてください。"))})})});
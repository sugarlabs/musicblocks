"use strict";var Trashcan=require("../trash"),mockActivity={trashContainer:{addChild:jest.fn(),setChildIndex:jest.fn()},cellSize:50,refreshCanvas:jest.fn()},mockTo=jest.fn().mockReturnThis(),mockSet=jest.fn().mockReturnThis(),mockCreatejs={Container:jest.fn(function(){return{addChild:jest.fn(),removeChildAt:jest.fn(),getBounds:jest.fn(function(){return{width:100,height:100}}),children:[{visible:!1},{visible:!1}],visible:!1,x:0,y:0}}),Bitmap:jest.fn(function(){return{scaleX:1,scaleY:1,x:0,y:0,getBounds:jest.fn(function(){return{width:100}})}}),Tween:{get:jest.fn(function(){return{to:mockTo,set:mockSet}})},Shape:jest.fn(function(){return{graphics:{beginFill:jest.fn().mockReturnThis(),drawRect:jest.fn().mockReturnThis()}}})};global.createjs=mockCreatejs,global.platformColor={trashActive:"red",trashBorder:"blue"},global.base64Encode=jest.fn(function(e){return e}),global.BORDER="mock_border_svg",global.TRASHICON="mock_trash_icon_svg",global.last=jest.fn(function(e){return e[e.length-1]}),global.Image=jest.fn(function(){var e={};return e.onload=jest.fn(),Object.defineProperty(e,"src",{set:function(){e.onload()}}),e}),jest.spyOn(global.window,"addEventListener").mockImplementation(function(){}),jest.useFakeTimers(),describe("Trashcan Class",function(){var e;beforeEach(function(){jest.clearAllMocks(),e=new Trashcan(mockActivity)}),it("should initialize with correct default values",function(){expect(e.activity).toBe(mockActivity),expect(e.isVisible).toBe(!1),expect(e._scale).toBe(1),expect(mockActivity.trashContainer.addChild).toHaveBeenCalled(),expect(mockActivity.trashContainer.setChildIndex).toHaveBeenCalled()}),it("should check if resize is needed",function(){e._container.x=100,e._container.y=100,expect(e.shouldResize(200,100)).toBe(!0),expect(e.shouldResize(100,100)).toBe(!1)}),it("should resize and debounce the event listener",function(){e.resizeEvent(1),(0,window.addEventListener.mock.calls[0][1])(),jest.advanceTimersByTime(300)}),it("should hide the trashcan using animation",function(){e.hide(),expect(mockCreatejs.Tween.get).toHaveBeenCalledWith(e._container),expect(mockTo).toHaveBeenCalledWith({alpha:0},200),expect(mockSet).toHaveBeenCalledWith({visible:!1})}),it("should show the trashcan using animation",function(){e.show(),expect(mockCreatejs.Tween.get).toHaveBeenCalledWith(e._container),expect(mockTo).toHaveBeenCalledWith({alpha:0,visible:!0}),expect(mockTo).toHaveBeenCalledWith({alpha:1},200)}),it("should start and stop highlight animation",function(){e.startHighlightAnimation(),jest.advanceTimersByTime(3e3),expect(e._inAnimation).toBe(!0)}),it("should not restart highlight animation if already running",function(){e._inAnimation=!0,e.startHighlightAnimation(),expect(e._inAnimation).toBe(!0)}),it("should toggle highlight visibility correctly",function(){e._switchHighlightVisibility(!0),expect(mockActivity.refreshCanvas).toHaveBeenCalled(),e._switchHighlightVisibility(!1),expect(mockActivity.refreshCanvas).toHaveBeenCalledTimes(2)}),it("should detect if coordinates are over the trashcan",function(){e._container.x=100,e._container.y=100,expect(e.overTrashcan(150,150)).toBe(!0),expect(e.overTrashcan(50,150)).toBe(!1),expect(e.overTrashcan(150,50)).toBe(!1),expect(e.overTrashcan(300,300)).toBe(!1)})});
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function setupMediaBlocks(u){var e=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"rightpos",_("right (screen)"))).setPalette("media",u),e.beginnerBlock(!0),e.parameter=!0,_THIS_IS_MUSIC_BLOCKS_?e.setHelpString([_("The Right block returns the position of the right of the canvas.")+" "+_("In this example, the mouse moves right until it reaches the right edge of the canvas; then it reappears at the left of the canvas."),"documentation",null,"lrhelp"]):e.setHelpString([_("The Right block returns the position of the right of the canvas.")+" "+_("In this example, the turtle moves right until it reaches the right edge of the canvas; then it reappears at the left of the canvas."),"documentation",null,"lrhelp"]),e}return _createClass(r,[{key:"updateParameter",value:function(){return toFixed2(u.turtles._canvas.width/(2*u.turtles.scale))}},{key:"arg",value:function(){return u.turtles._canvas.width/(2*u.turtles.scale)}}]),r}(),t=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"leftpos",_("left (screen)"))).setPalette("media",u),e.beginnerBlock(!0),e.parameter=!0,_THIS_IS_MUSIC_BLOCKS_?e.setHelpString([_("The Left block returns the position of the left of the canvas.")+" "+_("In this example, the mouse moves right until it reaches the right edge of the canvas; then it reappears at the left of the canvas."),"documentation",null,"lrhelp"]):e.setHelpString([_("The Left block returns the position of the left of the canvas.")+" "+_("In this example, the turtle moves right until it reaches the right edge of the canvas; then it reappears at the left of the canvas."),"documentation",null,"lrhelp"]),e}return _createClass(r,[{key:"updateParameter",value:function(){return toFixed2(u.turtles._canvas.width/(2*u.turtles.scale)*-1)}},{key:"arg",value:function(){return u.turtles._canvas.width/(2*u.turtles.scale)*-1}}]),r}(),r=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"toppos",_("top (screen)"))).setPalette("media",u),e.beginnerBlock(!0),e.parameter=!0,_THIS_IS_MUSIC_BLOCKS_?e.setHelpString([_("The Top block returns the position of the top of the canvas.")+" "+_("In this example, the mouse moves upward until it reaches the top edge of the canvas; then it reappears at the bottom of the canvas."),"documentation",null,"bottomposhelp"]):e.setHelpString([_("The Top block returns the position of the top of the canvas.")+" "+_("In this example, the turtle moves upward until it reaches the top edge of the canvas; then it reappears at the bottom of the canvas."),"documentation",null,"bottomposhelp"]),e}return _createClass(r,[{key:"updateParameter",value:function(){return toFixed2(u.turtles._canvas.height/(2*u.turtles.scale))}},{key:"arg",value:function(){return u.turtles._canvas.height/(2*u.turtles.scale)}}]),r}(),n=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"bottompos",_("bottom (screen)"))).setPalette("media",u),e.beginnerBlock(!0),e.parameter=!0,_THIS_IS_MUSIC_BLOCKS_?e.setHelpString([_("The Bottom block returns the position of the bottom of the canvas.")+" "+_("In this example, the mouse moves upward until it reaches the top edge of the canvas; then it reappears at the bottom of the canvas."),"documentation",null,"bottomposhelp"]):e.setHelpString([_("The Bottom block returns the position of the bottom of the canvas.")+" "+_("In this example, the turtle moves upward until it reaches the top edge of the canvas; then it reappears at the bottom of the canvas."),"documentation",null,"bottomposhelp"]),e}return _createClass(r,[{key:"updateParameter",value:function(){return toFixed2(u.turtles._canvas.height/(2*u.turtles.scale)*-1)}},{key:"arg",value:function(){return u.turtles._canvas.height/(2*u.turtles.scale)*-1}}]),r}(),a=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"width",_("width"))).setPalette("media",u),e.beginnerBlock(!0),e.parameter=!0,e.setHelpString([_("The Width block returns the width of the canvas."),"documentation",""]),e}return _createClass(r,[{key:"updateParameter",value:function(){return toFixed2(u.turtles._canvas.width/u.turtles.scale)}},{key:"arg",value:function(){return u.turtles._canvas.width/u.turtles.scale}}]),r}(),o=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"height",_("height"))).setPalette("media",u),e.beginnerBlock(!0),e.parameter=!0,e.setHelpString([_("The Height block returns the height of the canvas."),"documentation",""]),e}return _createClass(r,[{key:"updateParameter",value:function(){return toFixed2(u.turtles._canvas.height/u.turtles.scale)}},{key:"arg",value:function(){return u.turtles._canvas.height/u.turtles.scale}}]),r}(),l=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"stopplayback",_("stop play"))).setPalette("media",u),e.setHelpString(),e.hidden=!0,e}return _createClass(r,[{key:"flow",value:function(e,t){for(var r in t.sounds)t.sounds[r].stop();t.sounds=[]}}]),r}(),s=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"erasemedia",_("erase media"))).setPalette("media",u),e.setHelpString([_("The Erase Media block erases text and images."),"documentation",""]),e}return _createClass(r,[{key:"flow",value:function(e,t,r){u.turtles.ithTurtle(r).painter.doClearMedia()}}]),r}(),i=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"playback",_("play back"))).setPalette("media",u),e.setHelpString(),e.formBlock({args:1,defaults:[null],argTypes:["mediain"]}),e.hidden=!0,e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){var a;null!==e[0]?(a=new Howl({urls:[e[0]]}),t.sounds.push(a),a.play()):u.errorMsg(NOINPUTERRORMSG,n)}}]),r}(),c=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"speak",_("speak"))).setPalette("media",u),e.beginnerBlock(!0),e.setHelpString([_("The Speak block outputs to the text-to-speech synthesizer"),"documentation",""]),e.formBlock({args:1,defaults:["hello"],argTypes:["textin"]}),e.hidden=!0,e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){var a=u.turtles.ithTurtle(r);1===e.length&&null!==t.meSpeak&&(0<a.singer.inNoteBlock.length?a.singer.embeddedGraphics[last(a.singer.inNoteBlock)].push(n):a.singer.suppressOutput||t.processSpeak(e[0]))}}]),r}(),h=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"camera",_("camera"))).setPalette("media",u),e.setHelpString([_("The Camera block connects a webcam to the Show block."),"documentation",""]),e.formBlock({image:"images/camera.svg"}),e}return r}(),p=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"video",_("video"))).setPalette("media",u),e.setHelpString([_("The Video block selects video for use with the Show block."),"documentation",""]),e.formBlock({image:"images/video.svg"}),e}return r}(),f=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"loadFile",_("open file"))).setPalette("media",u),e.setHelpString([_("The Open file block opens a file for use with the Show block."),"documentation",""]),e.formBlock({outType:"fileout"}),e.parameter=!1,e}return _createClass(r,[{key:"arg",value:function(e,t,r){return u.blocks.blockList[r].value}}]),r}(),m=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"stopvideocam",_("stop media"))).setPalette("media",u),e.setHelpString([_("The Stop media block stops audio or video playback."),"documentation",""]),e}return _createClass(r,[{key:"flow",value:function(e,t){null!=t.cameraID&&doStopVideoCam(t.cameraID,t.setCameraID)}}]),r}(),d=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"tone",_("hertz"))).setPalette("media",u),e.piemenuValuesC1=[220,247,262,294,330,349,392,440,494,523,587,659,698,784,880],e.setHelpString(),e.formBlock({args:2,defaults:[392,1e3/3],argLabels:[_("frequency"),_("duration (MS)")]}),e.formBlock(function(e,t){return[[0,"drift",e,t,[null,1,null]],[1,"osctime",0,0,[0,3,2,null]],[2,"vspace",0,0,[1,6]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:1e3}],0,0,[3]],[5,["number",{value:3}],0,0,[3]],[6,"hertz",0,0,[2,7,null]],[7,["number",{value:392}],0,0,[6]]]}),e}return _createClass(r,[{key:"flow",value:function(){}}]),r}(),v=function(){_inherits(r,LeftBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"tofrequency",_("note to frequency"))).setPalette("media",u),e.parameter=!0,e.setHelpString([_("The To frequency block converts a pitch name and octave to Hertz."),"documentation",""]),e.formBlock({args:2,defaults:["G",4],argTypes:["notein","anyin"],argLabels:["ja"===e.lang?_("name2"):_("name"),_("octave")]}),e}return _createClass(r,[{key:"updateParameter",value:function(e,t,r){return toFixed2(u.blocks.blockList[r].value)}},{key:"arg",value:function(e,t,r,n){var a=u.turtles.ithTurtle(t),o=u.blocks.blockList[r].connections[1],l=u.blocks.blockList[r].connections[2];if(null===o||null===l)return u.errorMsg(NOINPUTERRORMSG,r),392;var s=e.parseArg(e,t,o,r,n),i=Math.floor(calcOctave(a.singer.currentOctave,e.parseArg(e,t,l,r,n),a.singer.lastNotePlayed,s));return Math.round(pitchToFrequency(s,i,0,a.singer.keySignature))}}]),r}(),g=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"turtleshell",_("avatar"))).setPalette("media",u),e.beginnerBlock(!0),_THIS_IS_MUSIC_BLOCKS_?e.setHelpString([_("The Avatar block is used to change the appearance of the mouse."),"documentation",null,"turtleshell"]):e.setHelpString([_("The Avatar block is used to change the appearance of the turtle."),"documentation",null,"turtleshell"]),e.formBlock({args:2,defaults:[55,null],argTypes:["numberin","anyin"],argLabels:[_("size"),_("image")]}),e.makeMacro(function(e,t){return[[0,"turtleshell",e,t,[null,1,2,3]],[1,["number",{value:55}],0,0,[0]],[2,"media",0,0,[0]],[3,"vspace",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){2===e.length&&("string"==typeof e[0]?u.errorMsg(NANERRORMSG,n):u.turtles.getTurtle(r).doTurtleShell(e[0],e[1]))}}]),r}(),k=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"show")).setPalette("media",u),e.beginnerBlock(!0),e.setHelpString([_("The Show block is used to display text or images on the canvas."),"documentation",""]),e.formBlock({name:"ja"===e.lang?_("show1"):_("Show").toLowerCase(),args:2,argLabels:[_("size"),_("obj")],defaults:[24,_("text")],argTypes:["numberin","anyin"]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){var a=u.turtles.ithTurtle(r);2===e.length&&(0<a.singer.inNoteBlock.length?a.singer.embeddedGraphics[last(a.singer.inNoteBlock)].push(n):a.singer.suppressOutput||t.processShow(r,n,e[0],e[1]))}}]),r}(),b=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"media",_("Media").toLowerCase())).setPalette("media",u),e.beginnerBlock(!0),e.setHelpString([_("The Media block is used to import an image."),"documentation",null,"turtleshell"]),e.formBlock({image:"images/load-media.svg",outType:"mediaout"}),e}return r}(),y=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"text",_("text"))).extraWidth=30,e.setPalette("media",u),e.beginnerBlock(!0),e.setHelpString([_("The Text block holds a text string."),"documentation",""]),e.formBlock({outType:"textout"}),e}return r}();(new e).setup(u),(new t).setup(u),(new r).setup(u),(new n).setup(u),(new a).setup(u),(new o).setup(u),(new h).setup(u),(new l).setup(u),(new i).setup(u),(new c).setup(u),(new p).setup(u),(new f).setup(u),(new m).setup(u),(new d).setup(u),(new v).setup(u),(new g).setup(u),(new s).setup(u),(new k).setup(u),(new b).setup(u),(new y).setup(u)}"undefined"!=typeof module&&module.exports&&(module.exports={setupMediaBlocks:setupMediaBlocks});
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _construct(e,t,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&_setPrototypeOf(o,r.prototype),o}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function setupDrumBlocks(a){var e=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"noisename",_("noise name"))).setPalette("drum",a),e.formBlock({outType:"textout"}),e.extraWidth=50,e.setHelpString([_("The Noise name block is used to select a noise synthesizer."),"documentation",""]),e}return r}(),t=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"drumname",_("drum name"))).setPalette("drum",a),e.formBlock({outType:"textout"}),e.extraWidth=50,e.setHelpString([_("The Drum name block is used to select a drum."),"documentation",null,"note4"]),e}return r}(),r=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"effectsname",_("effects name"))).setPalette("drum",a),e.formBlock({outType:"textout"}),e.extraWidth=50,e.setHelpString([_("The Effects name block is used to select a sound effect."),"documentation",null,"effectshelp"]),e}return r}(),n=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"playnoise",_("noise"))).setPalette("drum",a),e.setHelpString([_("The Play noise block will generate white, pink, or brown noise."),"documentation",""]),e.formBlock({args:1,defaults:[_("white noise")],argTypes:["anyin"]}),e.makeMacro(function(e,t){return[[0,"playnoise",e,t,[null,1,null]],[1,["noisename",{value:DEFAULTNOISE}],0,0,[0]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){var o=e[0];1===e.length&&null!=o&&"string"==typeof o||(a.errorMsg(NOINPUTERRORMSG,n),o="noise1"),Singer.DrumActions.playNoise(o,r,n)}}]),r}();var o,l=function(){_inherits(r,FlowClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"mapdrum")).setPalette("drum",a),e.setHelpString([_("Replace every instance of a pitch with a drum sound."),"documentation",null,"mapdrumhelp"]),e.formBlock({name:_("map pitch to drum"),args:1,argTypes:["anyin"]}),e.makeMacro(function(e,t){return[[0,"mapdrum",e,t,[null,1,3,2]],[1,["drumname",{value:"kick drum"}],0,0,[0]],[2,"hidden",0,0,[0,null]],[3,"pitch",0,0,[0,4,5,null]],[4,["solfege",{value:"sol"}],0,0,[3]],[5,["number",{value:4}],0,0,[3]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){return Singer.DrumActions.mapPitchToDrum(e[0],r,n),[e[1],1]}}]),r}(),u=function(){_inherits(r,FlowClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"setdrum")).setPalette("drum",a),e.beginnerBlock(!0),a.beginnerMode&&"ja"===e.lang?e.setHelpString([_("The Set drum block will select a drum sound to replace the pitch of any contained notes."),"documentation",null,"rhythmruler2"]):e.setHelpString([_("The Set drum block will select a drum sound to replace the pitch of any contained notes.")+" "+_("In the example above, a kick drum sound will be played instead of sol."),"documentation",null,"setdrumhelp"]),e.formBlock({name:_("set drum"),args:1,argTypes:["anyin"]}),e.makeMacro(function(e,t){return[[0,"setdrum",e,t,[null,1,2,7]],[1,["drumname",{value:DEFAULTDRUM}],0,0,[0]],[2,"rhythm2",0,0,[0,3,4,null]],[3,["number",{value:1}],0,0,[2]],[4,"divide",0,0,[2,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:1}],0,0,[4]],[7,"hidden",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){return Singer.DrumActions.setDrum(e[0],r,n),[e[1],1]}}]),r}(),i=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"playeffect",_("sound effect"))).setPalette("drum",a),e.beginnerBlock(!0),e.formBlock({args:1,argTypes:["anyin"]}),e.makeMacro(function(e,t){return[[0,"playdrum",e,t,[null,1,null]],[1,["effectsname",{value:DEFAULTEFFECT}],0,0,[0]]]}),e}return r}(),s=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"playdrum",_("drum"))).setPalette("drum",a),e.beginnerBlock(!0),e.setHelpString([_("You can use multiple Drum blocks within a Note block."),"documentation",null,"note4"]),e.formBlock({args:1,argTypes:["anyin"]}),e.makeMacro(function(e,t){return[[0,"playdrum",e,t,[null,1,null]],[1,["drumname",{value:DEFAULTDRUM}],0,0,[0]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){var o=e[0];1===e.length&&null!=o&&"string"==typeof o||(a.errorMsg(NOINPUTERRORMSG,n),o=DEFAULTDRUM);var l=Singer.DrumActions.GetDrumname(e[0]),u=a.turtles.ithTurtle(r);if(0<u.singer.drumStyle.length&&(l=last(u.singer.drumStyle)),t.inPitchDrumMatrix)t.pitchDrumMatrix.drums.push(l),t.pitchDrumMatrix.addColBlock(n),t.drumBlocks.includes(n)||t.drumBlocks.push(n);else if(t.inMatrix)t.phraseMaker.rowLabels.push(l),t.phraseMaker.rowArgs.push(-1),t.phraseMaker.addRowBlock(n),t.drumBlocks.includes(n)||t.drumBlocks.push(n);else if(t.inMusicKeyboard)t.musicKeyboard.instruments.push(l),t.musicKeyboard.noteNames.push("drum"),t.musicKeyboard.octaves.push(null),t.musicKeyboard.addRowBlock(n);else{if(!(0<u.singer.inNoteBlock.length||null==a.blocks.blockList[n].connections[0]&&null==last(a.blocks.blockList[n].connections)))return void console.debug("PLAY DRUM ERROR: missing context");Singer.DrumActions.playDrum(e[0],r,n)}0<u.singer.inNoteBlock.length&&u.singer.noteBeatValues[last(u.singer.inNoteBlock)].push(u.singer.beatFactor),u.singer.pushedNote=!0}}]),r}();(new e).setup(a),(new t).setup(a),(new r).setup(a),(new n).setup(a),o=function(){_inherits(u,FlowBlock);var t=_createSuper(u);function u(r,n,o,l){var e;return _classCallCheck(this,u),(e=void 0===n?t.call(this,r,_(r)):t.call(this,r,_(n))).setPalette("drum",a),e.formBlock({args:1}),e.makeMacro(function(e,t){return[[0,"playdrum",e,t,[null,1,null]],[1,[o?"drumname":"effectsname",{value:l||o&&n||r}],0,0,[0]]]}),_possibleConstructorReturn(e)}return u}(),[["duck"],["cat"],["cricket"],["dog"],["bottle"],["bubbles"],["chine","chime",!0],["clang"],["clap"],["slap"],["crash"],["splash"],["cowbell","cow bell",!0],["ridebell","ride bell",!0],["fingercymbals","finger cymbals",!0],["trianglebell","triangle bell",!0],["hihat","hi hat",!0],["darbuka","darbuka drum",!0],["cup","cup drum",!0],["floortom","floor tom",!0,"floor tom tom"],["tom","tom tom",!0],["kick","kick drum",!0],["snare","snare drum",!0]].forEach(function(e){_construct(o,_toConsumableArray(e)).setup(a)}),(new l).setup(a),(new u).setup(a),(new i).setup(a),(new s).setup(a)}"undefined"!=typeof module&&module.exports&&(module.exports={setupDrumBlocks:setupDrumBlocks});
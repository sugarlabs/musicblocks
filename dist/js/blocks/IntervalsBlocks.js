"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(n){var r=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(n);return _possibleConstructorReturn(this,r?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function setupIntervalsBlocks(C){var e=function(){_inherits(n,FlowBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"settemperament",_("set temperament"))).setPalette("intervals",C),e.beginnerBlock(!0),e.setHelpString([_("The Set temperament block is used to choose the tuning system used by Music Blocks."),"documentation",""]),e.formBlock({args:3,argLabels:[_("temperament"),_("pitch"),_("octave")]}),e.makeMacro(function(e,t){return[[0,"settemperament",e,t,[null,1,2,3,null]],[1,["temperamentname",{value:"equal"}],0,0,[0]],[2,["notename",{value:"C"}],0,0,[0]],[3,["number",{value:4}],0,0,[0]]]}),e}return _createClass(n,[{key:"flow",value:function(e){Singer.IntervalsActions.setTemperament(e[0],e[1],e[2])}}]),n}(),t=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"temperamentname",_("temperament name"))).setPalette("tone",C),e.setHelpString([_("The Temperament name block is used to select a tuning method."),"documentation",""]),e.extraWidth=50,e.hidden=!0,e.formBlock({outType:"anyout"}),e}return n}(),n=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"modename")).setPalette("intervals",C),e.setHelpString(),e.formBlock({outType:"textout"}),e.extraWidth=50,e.hidden=!0,e}return n}(),r=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"chordname")).setPalette("intervals",C),e.setHelpString(),e.formBlock({outType:"textout"}),e.extraWidth=50,e.hidden=!0,e}return n}(),o=function(){_inherits(n,LeftBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"doubly",_("doubly"))).setPalette("intervals",C),e.setHelpString([_("The Doubly block will double the size of an interval."),"documentation",null,"doublyhelp"]),e.formBlock({outType:"anyout",args:1,argTypes:["anyin"]}),e}return _createClass(n,[{key:"arg",value:function(e,t,n,r){var o=C.blocks.blockList[n].connections[1];if(null===o)return C.errorMsg(NOINPUTERRORMSG,n),0;for(var a=o,l=!0;l;){var i=C.blocks.blockList[a];if("intervalname"===i.name)return"a"===i.value[0]?e.parseArg(e,t,o,n,r)+1:"d"===i.value[0]?e.parseArg(e,t,o,n,r)-1:e.parseArg(e,t,o,n,r);if("doubly"!==i.name){var s=e.parseArg(e,t,o,n,r);return"number"==typeof s?2*s:"string"==typeof s?s+s:s}if(null===(a=C.blocks.blockList[a].connections[1]))return l=!1,0}}}]),n}(),a=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"intervalname")).setPalette("intervals",C),e.setHelpString(),e.extraWidth=50,e.formBlock({outType:"numberout"}),e}return n}(),l=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"intervalnumber",_("interval number"))).setPalette("intervals",C),e.setHelpString([_("The Interval number block returns the number of scalar steps in the current interval."),"documentation",""]),e.formBlock({outType:"numberout"}),e}return _createClass(n,[{key:"updateParameter",value:function(e,t,n){return C.blocks.blockList[n].value}},{key:"arg",value:function(e,t,n){if(!e.inStatusMatrix||"print"!==C.blocks.blockList[C.blocks.blockList[n].connections[0]].name)return Singer.IntervalsActions.GetIntervalNumber(t);e.statusFields.push([n,"intervalnumber"])}}]),n}(),i=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"currentinterval",_("current interval"))).setPalette("intervals",C),e.setHelpString([_("The Current interval block returns the name of scalar steps in the current interval."),"documentation",""]),e.formBlock({outType:"numberout"}),e}return _createClass(n,[{key:"updateParameter",value:function(e,t,n){return C.blocks.blockList[n].value}},{key:"arg",value:function(e,t,n){if(!e.inStatusMatrix||"print"!==C.blocks.blockList[C.blocks.blockList[n].connections[0]].name)return Singer.IntervalsActions.GetCurrentInterval(t);e.statusFields.push([n,"currentinterval"])}}]),n}(),s=function(){_inherits(n,LeftBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"measureintervalsemitones")).setPalette("intervals",C),e.setHelpString([_("The Semi-tone interval block measures the distance between two notes in semi-tones."),"documentation",""]),e.formBlock({name:_("semi-tone interval measure"),flows:{labels:[""],type:"flow"}}),e}return _createClass(n,[{key:"arg",value:function(e,t,n){var r=C.blocks.blockList[n].connections[1];if(null===r)return C.errorMsg(NOINPUTERRORMSG,n),0;var o=C.turtles.ithTurtle(t),a=o.singer.suppressOutput,l=JSON.stringify(e.boxes),i=JSON.stringify(e.turtleHeaps[t]),s=JSON.stringify(e.turtleDicts[t]),u=o.x,c=o.y,p=o.painter.color,f=o.painter.value,h=o.painter.chroma,v=o.painter.stroke,m=o.painter.canvasAlpha,k=o.orientation,b=o.painter.penState;for(var g in o.singer.suppressOutput=!0,o.singer.justCounting.push(!0),o.singer.justMeasuring.push(!0),o.endOfClampSignals)for(var d in o.butNotThese[g]=[],o.endOfClampSignals[g])o.butNotThese[g].push(d);var y=o.singer.notesPlayed,S=0;return o.running=!0,e.runFromBlockNow(e,t,r,!0,[],o.queue.length),0<o.singer.firstPitch.length&&0<o.singer.lastPitch.length?(S=last(o.singer.lastPitch)-last(o.singer.firstPitch),o.singer.firstPitch.pop(),o.singer.lastPitch.pop()):(S=0,C.errorMsg(_("You must use two pitch blocks when measuring an interval."))),o.singer.notesPlayed=y,e.boxes=JSON.parse(l),e.turtleHeaps[t]=JSON.parse(i),e.turtleDicts[t]=JSON.parse(s),o.painter.doPenUp(),o.painter.doSetXY(u,c),o.painter.color=p,o.painter.value=f,o.painter.chroma=h,o.painter.stroke=v,o.painter.canvasAlpha=m,o.painter.doSetHeading(k),o.painter.penState=b,o.singer.justCounting.pop(),o.singer.justMeasuring.pop(),o.singer.suppressOutput=a,o.butNotThese={},S}}]),n}(),u=function(){_inherits(n,LeftBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"measureintervalscalar")).setPalette("intervals",C),e.setHelpString([_("The Scalar interval block measures the distance between two notes in the current key and mode."),"documentation",""]),e.formBlock({name:_("scalar interval measure"),flows:{labels:[""],type:"flow"}}),e}return _createClass(n,[{key:"arg",value:function(e,t,n){var r=C.blocks.blockList[n].connections[1];if(null===r)return C.errorMsg(NOINPUTERRORMSG,n),0;var o=C.turtles.ithTurtle(t),a=o.singer.suppressOutput,l=JSON.stringify(e.boxes),i=JSON.stringify(e.turtleHeaps[t]),s=JSON.stringify(e.turtleDicts[t]),u=o.x,c=o.y,p=o.painter.color,f=o.painter.value,h=o.painter.chroma,v=o.painter.stroke,m=o.painter.canvasAlpha,k=o.orientation,b=o.painter.penState;for(var g in o.singer.suppressOutput=!0,o.singer.justCounting.push(!0),o.singer.justMeasuring.push(!0),o.endOfClampSignals)for(var d in o.butNotThese[g]=[],o.endOfClampSignals[g])o.butNotThese[g].push(d);var y=o.singer.notesPlayed;o.running=!0;var S=0;return e.runFromBlockNow(e,t,r,!0,[],o.queue.length),0<o.singer.firstPitch.length&&0<o.singer.lastPitch.length?(S=Singer.scalarDistance(e,t,last(o.singer.firstPitch),last(o.singer.lastPitch)),o.singer.firstPitch.pop(),o.singer.lastPitch.pop()):(S=0,C.errorMsg(_("You must use two pitch blocks when measuring an interval."))),o.singer.notesPlayed=y,e.boxes=JSON.parse(l),e.turtleHeaps[t]=JSON.parse(i),e.turtleDicts[t]=JSON.parse(s),o.painter.doPenUp(),o.painter.doSetXY(u,c),o.painter.color=p,o.painter.value=f,o.painter.chroma=h,o.painter.stroke=v,o.painter.canvasAlpha=m,o.painter.doSetHeading(k),o.painter.penState=b,o.singer.justCounting.pop(),o.singer.justMeasuring.pop(),o.singer.suppressOutput=a,o.butNotThese={},S}}]),n}();var c=function(){_inherits(n,FlowClampBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"perfect")).setPalette("intervals",C),e.setHelpString(),e.formBlock({name:_("perfect"),args:1,defaults:[5]}),e.hidden=!0,e}return n}(),p=function(){_inherits(n,FlowClampBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"semitoneinterval")).setPalette("intervals",C),e.piemenuValuesC1=[-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12],e.setHelpString([_("The Semi-tone interval block calculates a relative interval based on half steps.")+" "+_("In the figure, we add sol# to sol."),"documentation",""]),e.formBlock({name:_("semi-tone interval")+" (+/–)",args:1,defaults:[5]}),e.makeMacro(function(e,t){return[[0,"semitoneinterval",e,t,[null,1,6,7]],[1,"plus",0,0,[0,2,3]],[2,["number",{value:5}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]]}),e}return _createClass(n,[{key:"flow",value:function(e,t,n,r){if(void 0!==e[1])return Singer.IntervalsActions.setSemitoneInterval(e[0],n,r),[e[1],1]}}]),n}(),f=function(){_inherits(n,FlowClampBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"arpeggio")).setPalette("intervals",C),e.setHelpString([_("The Arpeggio block will run each note block multiple times, adding a transposition based on the specified chord.")+" "+_("The output of the example is: do, mi, sol, sol, ti, mi"),"documentation",null,""]),e.formBlock({name:_("arpeggio"),argTypes:["textin"],args:1,defaults:[DEFAULTCHORD]}),e.makeMacro(function(e,t){return[[0,"arpeggio",e,t,[null,1,null,2]],[1,["chordname",{value:DEFAULTCHORD}],0,0,[0]],[2,"hidden",0,0,[0,null]]]}),e}return _createClass(n,[{key:"flow",value:function(e,o,r,a,t){if(e[0],void 0!==e[1]){var n=CHORDNAMES.indexOf(e[0]);-1===n&&(n=CHORDNAMES.indexOf(DEFAULTCHORD));var l=Math.floor(CHORDVALUES[n].length),i=C.turtles.ithTurtle(r);i.singer.duplicateFactor*=l,i.singer.arpeggio=[];for(var s=0;s<CHORDVALUES[n].length;s++)i.singer.arpeggio.push(CHORDVALUES[n][s]);var u="_duplicate_"+r;o.setDispatchBlock(a,r,u);var c=function(e,t){for(var n in o.connectionStore)if(n!==t.toString())for(var r in o.connectionStore[n])if(r===e.toString())return n;return null};i.singer.inDuplicate=!0;o.setTurtleListener(r,u,function(){if(i.singer.inDuplicate=!1,i.singer.duplicateFactor/=l,i.singer.arpeggio=[],o.connectionStoreLock&&console.debug("LOCKED"),o.connectionStoreLock=!0,null===c(a,r))for(var e=o.connectionStore[r][a].length,t=0;t<e;t++){var n=o.connectionStore[r][a].pop();C.blocks.blockList[n[0]].connections[n[1]]=n[2],null!=n[2]&&(C.blocks.blockList[n[2]].connections[0]=n[0])}else delete o.connectionStore[r][a];o.connectionStoreLock=!1}),o.connectionStoreLock&&console.debug("LOCKED"),o.connectionStoreLock=!0;var p=c(a,r);if(null!=p){o.connectionStore[r][a]=[];for(var f=o.connectionStore[p][a].length;0<f;f--){var h=[o.connectionStore[p][a][f-1][0],o.connectionStore[p][a][f-1][1],o.connectionStore[p][a][f-1][2]];o.connectionStore[r][a].push(h);var v=h[0];"hidden"===C.blocks.blockList[v].name&&(v=C.blocks.blockList[v].connections[0]);var m=new Queue(v,l,a,t);i.parentFlowQueue.push(a),i.queue.push(m)}}else{for(var k,b=C.blocks.findBottomBlock(e[1]);b!=a;){"hidden"!==C.blocks.blockList[b].name&&(k=new Queue(b,l,a,t),i.parentFlowQueue.push(a),i.queue.push(k)),b=C.blocks.blockList[b].connections[0]}for(o.connectionStore[r][a]=[],b=e[1];null!=b;){var g=C.blocks.blockList[b].connections.length-1,d=C.blocks.blockList[b].connections[g];null!=d&&"hidden"===C.blocks.blockList[d].name?(o.connectionStore[r][a].push([d,1,C.blocks.blockList[d].connections[1]]),b=C.blocks.blockList[d].connections[1],C.blocks.blockList[d].connections[1]=null):(o.connectionStore[r][a].push([b,g,d]),C.blocks.blockList[b].connections[g]=null,b=d),null!=b&&(C.blocks.blockList[b].connections[0]=null)}}o.connectionStoreLock=!1}}}]),n}(),h=function(){_inherits(n,FlowClampBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"chordinterval")).setPalette("intervals",C),e.setHelpString([_("The Chord block calculates common chords.")+" "+_("In the figure, we generate a C-major chord."),"documentation",""]),e.formBlock({name:_("chord"),args:1,argTypes:["textin"],defaults:[DEFAULTCHORD]}),e.makeMacro(function(e,t){return[[0,"chordinterval",e,t,[null,1,null,2]],[1,["chordname",{value:DEFAULTCHORD}],0,0,[0]],[2,"hidden",0,0,[0,null]]]}),e}return _createClass(n,[{key:"flow",value:function(e,t,n,r){if(void 0!==e[1]){var o=CHORDNAMES.indexOf(e[0]);-1==o&&(o=CHORDNAMES.indexOf(DEFAULTCHORD));for(var a=0;a<CHORDVALUES[o].length;a++)isNaN(CHORDVALUES[o][a][0])||0===CHORDVALUES[o][a][0]&&0===CHORDVALUES[o][a][1]||Singer.IntervalsActions.setChordInterval(CHORDVALUES[o][a],n,r);return[e[1],1]}}}]),n}(),v=function(){_inherits(n,FlowClampBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"ratiointerval")).setPalette("intervals",C),e.setHelpString([_("The Ratio Interval block calculates an interval based on a ratio."),"documentation",""]),e.formBlock({name:_("ratio interval"),args:1,argTypes:["anyin"],defaults:[1.5]}),e.makeMacro(function(e,t){return[[0,"ratiointerval",e,t,[null,1,4,5]],[1,"divide",0,0,[0,2,3]],[2,["number",{value:3}],0,0,[1]],[3,["number",{value:2}],0,0,[1]],[4,"vspace",0,0,[0,null]],[5,"hidden",0,0,[0,null]]]}),e}return _createClass(n,[{key:"flow",value:function(e,t,n,r){if(void 0!==e[1]){var o,a=C.blocks.blockList[r].connections[1],l=e[0];return null===a?(C.errorMsg(NOINPUTERRORMSG,r),l=1):"intervalname"===C.blocks.blockList[a].name&&(l=(o=C.blocks.blockList[a].value)in INTERVALVALUES?INTERVALVALUES[o][2]:(console.log("could not find "+o+" in INTERVALVALUES"),1)),(isNaN(l)||l<0)&&(l=1,console.debug("ratio "+l+" must be a number > 0")),Singer.IntervalsActions.setRatioInterval(l,n,r),[e[1],1]}}}]),n}(),m=function(){_inherits(n,FlowClampBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"interval")).setPalette("intervals",C),e.piemenuValuesC1=[-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7],e.beginnerBlock(!0),e.setHelpString([_("The Scalar interval block calculates a relative interval based on the current mode, skipping all notes outside of the mode.")+" "+_("In the figure, we add la to sol."),"documentation",null,"intervalhelp"]),e.formBlock({name:_("scalar interval")+" (+/–)",args:1,defaults:[5]}),e.makeMacro(function(e,t){return[[0,"interval",e,t,[null,1,null,2]],[1,["number",{value:5}],0,0,[0]],[2,"hidden",0,0,[0,null]]]}),e}return _createClass(n,[{key:"flow",value:function(e,t,n,r){if(void 0!==e[1])return Singer.IntervalsActions.setScalarInterval(e[0],n,r),[e[1],1]}}]),n}(),k=function(){_inherits(n,FlowClampBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"definemode")).setPalette("intervals",C),e.setHelpString([_("The Define mode block allows you to define a custom mode by specifying pitch numbers."),"documentation",null,"definemode"]),e.formBlock({name:_("define mode"),args:1,canCollapse:!0,argTypes:["textin"],defaults:_("custom")}),e.makeMacro(function(e,t){return[[0,"definemode",e,t,[null,1,2,16]],[1,["text",{value:"custom"}],0,0,[0]],[2,"pitchnumber",0,0,[0,3,4]],[3,["number",{value:0}],0,0,[2]],[4,"pitchnumber",0,0,[2,5,6]],[5,["number",{value:2}],0,0,[4]],[6,"pitchnumber",0,0,[4,7,8]],[7,["number",{value:4}],0,0,[6]],[8,"pitchnumber",0,0,[6,9,10]],[9,["number",{value:5}],0,0,[8]],[10,"pitchnumber",0,0,[8,11,12]],[11,["number",{value:7}],0,0,[10]],[12,"pitchnumber",0,0,[10,13,14]],[13,["number",{value:9}],0,0,[12]],[14,"pitchnumber",0,0,[12,15,null]],[15,["number",{value:11}],0,0,[14]],[16,"hidden",0,0,[0,null]]]}),e}return _createClass(n,[{key:"flow",value:function(e,t,n,r){if(void 0!==e[1])return Singer.IntervalsActions.defineMode(e[0],n,r),[e[1],1]}}]),n}(),b=function(){_inherits(n,FlowBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"movable",_("movable Do"))).setPalette("intervals",C),e.beginnerBlock(!0),e.setHelpString([_("When Movable do is false, the solfege note names are always tied to specific pitches,")+" "+_('eg "do" is always "C-natural" when Movable do is true, the solfege note names are assigned to scale degrees "do" is always the first degree of the major scale.'),"documentation",null,"moveablehelp"]),e.size=0,e.formBlock({args:1,argTypes:["booleanin"]}),e.makeMacro(function(e,t){return[[0,"movable",e,t,[null,1,null]],[1,["boolean",{value:!0}],0,0,[0]]]}),e}return _createClass(n,[{key:"flow",value:function(e,t,n){1===e.length&&Singer.IntervalsActions.setMovableDo(e[0],n)}}]),n}(),g=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"modelength",_("mode length"))).setPalette("intervals",C),e.beginnerBlock(!0),e.parameter=!0,e.setHelpString([_("The Mode length block is the number of notes in the current scale.")+" "+_("Most Western scales have 7 notes."),"documentation",""]),e}return _createClass(n,[{key:"updateParameter",value:function(e,t,n){return C.blocks.blockList[n].value}},{key:"arg",value:function(e,t,n){if(!e.inStatusMatrix||"print"!==C.blocks.blockList[C.blocks.blockList[n].connections[0]].name)return Singer.IntervalsActions.getModeLength(t);e.statusFields.push([n,"modelength"])}}]),n}(),d=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"currentmode",_("current mode"))).setPalette("intervals",C),e.parameter=!0,e.setHelpString(),e}return _createClass(n,[{key:"updateParameter",value:function(e,t,n){return C.blocks.blockList[n].value}},{key:"arg",value:function(e,t,n){if(!e.inStatusMatrix||"print"!==C.blocks.blockList[C.blocks.blockList[n].connections[0]].name)return Singer.IntervalsActions.getCurrentMode(t);e.statusFields.push([n,"currentmode"])}}]),n}(),y=function(){_inherits(n,ValueBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"key",_("current key"))).setPalette("intervals",C),e.parameter=!0,e.setHelpString(),e}return _createClass(n,[{key:"updateParameter",value:function(e,t,n){return C.blocks.blockList[n].value}},{key:"arg",value:function(e,t,n){if(!e.inStatusMatrix||"print"!==C.blocks.blockList[C.blocks.blockList[n].connections[0]].name)return Singer.IntervalsActions.getCurrentKey(t);e.statusFields.push([n,"key"])}}]),n}(),S=function(){_inherits(n,FlowBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"setkey",_("set key"))).setPalette("intervals",C),e.beginnerBlock(!0),e.setHelpString(),e.formBlock({args:1,argTypes:["textin"],defaults:["C"]}),e.hidden=e.deprecated=!0,e}return _createClass(n,[{key:"flow",value:function(e,t,n){1===e.length&&(C.turtles.ithTurtle(n).singer.keySignature=e[0])}}]),n}(),w=function(){_inherits(n,FlowBlock);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this,"setkey2",_("set key"))).setPalette("intervals",C),e.beginnerBlock(!0),C.beginnerMode&&"ja"===e.lang?e.setHelpString([_("The Set key block is used to set the key and mode,"),"documentation",""]):e.setHelpString([_("The Set key block is used to set the key and mode,")+" "+_("eg C Major"),"documentation",null,"movablehelp"]),e.formBlock({args:2,argTypes:["anyin","anyin"],argLabels:[_("key"),_("mode")]}),e.makeMacro(function(e,t){return[[0,"setkey2",e,t,[null,1,2,null]],[1,["notename",{value:"C"}],0,0,[0]],[2,["modename",{value:"major"}],0,0,[0]]]}),e}return _createClass(n,[{key:"flow",value:function(e,t,n,r){var o;2===e.length&&(o=Singer.IntervalsActions.GetModename(e[1]),t.modeBlock=C.blocks.blockList[r].connections[2],Singer.IntervalsActions.setKey(e[0],e[1],n,r),t.insideModeWidget&&(C.turtles.ithTurtle(0).singer.keySignature=e[0]+" "+o,t.notation.notationKey(0,e[0],o)))}}]),n}();(new e).setup(C),(new t).setup(C),(new r).setup(C),(new n).setup(C),(new o).setup(C),(new a).setup(C),(new l).setup(C),(new i).setup(C),(new s).setup(C),(new u).setup(C),new(function(){_inherits(a,FlowBlock);var t=_createSuper(a);function a(n,r,o){var e;return _classCallCheck(this,a),(e=t.call(this,(o?"down":"")+n+r,_((o?"down ":"")+n)+" "+r)).setPalette("intervals",C),e.setHelpString(),e.makeMacro(function(e,t){return[[0,"semitoneinterval",e,t,[null,1,6,7]]].concat([o?[1,"minus",0,0,[0,8,3]]:[1,"plus",0,0,[0,2,3]]],[[2,["intervalname",{value:n+" "+r}],0,0,[1]],[3,"multiply",0,0,[1,4,5]],[4,["number",{value:0}],0,0,[3]],[5,["number",{value:12}],0,0,[3]],[6,"vspace",0,0,[0,null]],[7,"hidden",0,0,[0,null]]],_toConsumableArray(o?[[8,"neg",0,0,[1,2]]]:[]))}),e}return a}())("major",3,!1).setup(C),(new c).setup(C),(new f).setup(C),(new h).setup(C),(new v).setup(C),(new p).setup(C),(new m).setup(C),(new k).setup(C),(new b).setup(C),(new g).setup(C),(new d).setup(C),(new y).setup(C),(new S).setup(C),(new w).setup(C)}
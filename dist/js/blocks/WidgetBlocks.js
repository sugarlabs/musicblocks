"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function setupWidgetBlocks(p){var e=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"envelope",_("Envelope").toLowerCase())).setPalette("widgets",p),e.setHelpString(),e.formBlock({args:4,defaults:[1,50,60,1],argLabels:[_("attack"),_("decay"),_("sustain"),_("release")]}),e.hidden=!0,e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){var l=p.turtles.ithTurtle(r);4===e.length&&"number"==typeof e[0]&&((e[0]<0||100<e[0])&&p.errorMsg(_("Attack value should be from 0 to 100.")),(e[1]<0||100<e[1])&&p.errorMsg(_("Decay value should be from 0 to 100.")),(e[2]<0||100<e[2])&&p.errorMsg(_("Sustain value should be from 0 to 100.")),(e[3]<0||100<e[3])&&p.errorMsg(_("Release value should be from 0-100.")),l.singer.attack.push(e[0]/100),l.singer.decay.push(e[1]/100),l.singer.sustain.push(e[2]/100),l.singer.release.push(e[3]/100)),t.inTimbre&&(t.timbre.synthVals.envelope.attack=last(l.singer.attack),t.timbre.synthVals.envelope.decay=last(l.singer.decay),t.timbre.synthVals.envelope.sustain=last(l.singer.sustain),t.timbre.synthVals.envelope.release=last(l.singer.release),0!=t.timbre.env.length?p.errorMsg(_("You are adding multiple envelope blocks.")):t.synth.createSynth(r,t.timbre.instrumentName,t.timbre.synthVals.oscillator.source,t.timbre.synthVals),t.timbre.env.push(n),t.timbre.ENVs.push(Math.round(100*last(l.singer.attack))),t.timbre.ENVs.push(Math.round(100*last(l.singer.decay))),t.timbre.ENVs.push(Math.round(100*last(l.singer.sustain))),t.timbre.ENVs.push(Math.round(100*last(l.singer.release))))}}]),r}(),t=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"filter",_("Filter").toLowerCase())).setPalette("widgets",p),e.setHelpString(),e.formBlock({args:3,defaults:[_("highpass"),-12,392],argLabels:[_("type"),_("rolloff"),_("frequency")],argTypes:["anyin","numberin","numberin"]}),e.hidden=!0,e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){var l,a,i=DEFAULTFILTERTYPE;if(3===e.length&&"number"==typeof e[1]){for(var o in FILTERTYPES)FILTERTYPES[o][0]===e[0]?i=FILTERTYPES[o][1]:FILTERTYPES[o][1]===e[0]&&(i=e[0]);[-12,-24,-48,-96].includes(e[1])||p.errorMsg(_("Rolloff value should be either -12, -24, -48, or -96 decibels/octave.")),a=e[1],l=e[2],t.inTimbre&&(t.timbre.instrumentName in instrumentsFilters[r]||(instrumentsFilters[r][t.timbre.instrumentName]=[]),instrumentsFilters[r][t.timbre.instrumentName].push({filterType:i,filterRolloff:a,filterFrequency:l}),t.timbre.fil.push(n),t.timbre.filterParams.push(i),t.timbre.filterParams.push(a),t.timbre.filterParams.push(l))}}}]),r}(),r=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"temperament")).setPalette("widgets",p),e.setHelpString([_("The Temperament tool is used to define custom tuning."),"documentation",null,"temperament"]),e.formBlock({args:1,name:_("temperament"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"temperament",e,t,[null,1,2,8]],[1,["temperamentname",{value:"equal"}],0,0,[0]],[2,"pitch",0,0,[0,3,4,5]],[3,["notename",{value:"C"}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"setkey2",0,0,[2,6,7,null]],[6,["notename",{value:"C"}],0,0,[5]],[7,["modename",{value:DEFAULTMODE}],0,0,[5]],[8,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.temperament&&(t.temperament=new TemperamentWidget),t.insideTemperament=!0,t.temperament.inTemperament=e[0];var l,a,i,o,u=[];"pitch"===p.blocks.blockList[p.blocks.blockList[n].connections[2]].name&&(l=p.blocks.blockList[p.blocks.blockList[n].connections[2]],a=p.blocks.blockList[l.connections[1]].value,i=p.blocks.blockList[l.connections[2]].value,o=p.blocks.blockList[l.connections[3]],u[0]=p.blocks.blockList[o.connections[1]].value,u[1]=p.blocks.blockList[o.connections[2]].value,t.synth.startingPitch=a+i,t.temperament.scale=u);var s="_temperament_"+r;t.setDispatchBlock(n,r,s);t.setTurtleListener(r,s,function(){t.temperament.init(p)})}}]),r}(),n=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"sampler")).setPalette("widgets",p),e.parameter=!0,e.beginnerBlock(!1),e.setHelpString([_("Upload a sample and adjust its pitch center."),"documentation",null,"sampler"]),e.formBlock({name:_("sampler"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"sampler",e,t,[null,1,8]],[1,"settimbre",0,0,[0,2,6,7]],[2,["customsample",{value:["","","do",4]}],0,0,[1,3,4,5]],[3,["audiofile",{value:null}],0,0,[2]],[4,["solfege",{value:"do"}],0,0,[2]],[5,["number",{value:4}],0,0,[2]],[6,"vspace",0,0,[1,null]],[7,"hidden",0,0,[1,null]],[8,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.sample&&(t.sample=new SampleWidget),t.inSample=!0,t.sample=new SampleWidget;var l="_sampler_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.sample.init(p)}),[e[0],1]}}]),r}(),l=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"timbre")).setPalette("widgets",p),e.setHelpString(),e.formBlock({name:_("timbre"),args:1,defaults:[_("custom")],canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"timbre",e,t,[null,1,3,2]],[1,["text",{value:_("custom")}],0,0,[0]],[2,"hiddennoflow",0,0,[0,null]],[3,"newnote",0,0,[0,4,7,11]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"pitch",0,0,[7,9,10,null]],[9,["solfege",{value:"sol"}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"hidden",0,0,[3,12]],[12,"newnote",0,0,[11,13,16,20]],[13,"divide",0,0,[12,14,15]],[14,["number",{value:1}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"vspace",0,0,[12,17]],[17,"pitch",0,0,[16,18,19,null]],[18,["solfege",{value:"mi"}],0,0,[17]],[19,["number",{value:4}],0,0,[17]],[20,"hidden",0,0,[12,21]],[21,"newnote",0,0,[20,22,25,29]],[22,"divide",0,0,[21,23,24]],[23,["number",{value:1}],0,0,[22]],[24,["number",{value:2}],0,0,[22]],[25,"vspace",0,0,[21,26]],[26,"pitch",0,0,[25,27,28,null]],[27,["solfege",{value:"sol"}],0,0,[26]],[28,["number",{value:4}],0,0,[26]],[29,"hidden",0,0,[21,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.timbre&&(t.timbre=new TimbreWidget),t.inTimbre=!0,"string"==typeof e[0]?t.timbre.instrumentName=e[0]:(t.timbre.instrumentName=DEFAULTVOICE,p.errorMsg(NOINPUTERRORMSG,n)),instrumentsEffects[r][t.timbre.instrumentName]={},instrumentsEffects[r][t.timbre.instrumentName].vibratoActive=!1,instrumentsEffects[r][t.timbre.instrumentName].distortionActive=!1,instrumentsEffects[r][t.timbre.instrumentName].tremoloActive=!1,instrumentsEffects[r][t.timbre.instrumentName].phaserActive=!1,instrumentsEffects[r][t.timbre.instrumentName].chorusActive=!1,instrumentsFilters[r][t.timbre.instrumentName]=[],t.timbre.blockNo=n,t.timbre.env=[],t.timbre.ENVs=[],t.timbre.fil=[],t.timbre.filterParams=[],t.timbre.osc=[],t.timbre.oscParams=[],t.timbre.tremoloEffect=[],t.timbre.tremoloParams=[],t.timbre.vibratoEffect=[],t.timbre.vibratoParams=[],t.timbre.chorusEffect=[],t.timbre.chorusParams=[],t.timbre.phaserEffect=[],t.timbre.phaserParams=[],t.timbre.distortionEffect=[],t.timbre.distortionParams=[],t.timbre.AMSynthesizer=[],t.timbre.AMSynthParams=[],t.timbre.FMSynthesizer=[],t.timbre.FMSynthParams=[],t.timbre.duoSynthesizer=[],t.timbre.duoSynthParams=[],t.timbre.notesToPlay=[];var l="_timbre_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.timbre.init(p)}),[e[1],1]}}]),r}(),a=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"meterwidget")).setPalette("widgets",p),e.setHelpString([_("The Meter block opens a tool to select strong beats for the meter."),"documentation",null,"meterwidget"]),e.formBlock({name:_("meter"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,["meterwidget",{collapsed:!1}],e,t,[null,1,7]],[1,"meter",0,0,[0,2,3,6]],[2,["number",{value:4}],0,0,[1]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"vspace",0,0,[1,null]],[7,"hidden",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){t.insideMeterWidget=!0;var l="_meterwidget_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){t.meterWidget=new MeterWidget(p,n),t.insideMeterWidget=!1}),1===e.length)return[e[0],1]}}]),r}(),i=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;_classCallCheck(this,r),(e=t.call(this,"oscilloscope")).setPalette("widgets",p),e.setHelpString([_("The oscilloscope block opens a tool to visualize waveforms."),"documentation",null,"oscilloscope"]),e.formBlock({name:_("oscilloscope"),canCollapse:!0});return e.makeMacro(function(e,t){var r,n,l,a,i,o,u,s=[[0,"oscilloscope",e,t,[null,1,null]]],c=_createForOfIteratorHelper(p.turtles.turtleList);try{for(c.s();!(r=c.n()).done;){var m=r.value;m.inTrash||(n=s,l=m,a=Math.max(0,s.length-2),i=m==p.turtles.getTurtle(p.turtles.getTurtleCount()-1),u=o=void 0,o=n.length,u=i?null:o+2,n.push([o,"print",0,0,[a,o+1,u]]),n.push([o+1,["text",{value:l.name}],0,0,[o,null]]),s=n)}}catch(e){c.e(e)}finally{c.f()}return s[0][4][2]=s.length,s.push([s.length,"hiddennoflow",0,0,[0,null]]),s}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){t.oscilloscopeTurtles=[],t.inOscilloscope=!0;var l="_oscilloscope_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){t.Oscilloscope=new Oscilloscope(p),t.inOscilloscope=!1}),1===e.length)return[e[0],1]}}]),r}(),o=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"modewidget")).setPalette("widgets",p),e.beginnerBlock(!0),e.setHelpString([_("The Custom mode block opens a tool to explore musical mode (the spacing of the notes in a scale)."),"documentation",""]),e.formBlock({name:_("custom mode"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"modewidget",e,t,[null,1,4]],[1,"setkey2",0,0,[0,2,3,null]],[2,["notename",{value:"C"}],0,0,[1]],[3,["modename",{value:DEFAULTMODE}],0,0,[1]],[4,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){t.insideModeWidget=!0;var l="_modewidget_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){t.modeWidget=new ModeWidget(p),t.insideModeWidget=!1}),1===e.length)return[e[0],1]}}]),r}(),u=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"tempo")).setPalette("widgets",p),e.beginnerBlock(!0),e.setHelpString([_("The Tempo block opens a metronome to visualize the beat."),"documentation",null,"tempo"]),e.formBlock({name:_("tempo"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"tempo",e,t,[null,1,6]],[1,"setmasterbpm2",0,0,[0,2,3,7]],[2,["number",{value:90}],0,0,[1]],[3,"divide",0,0,[1,4,5]],[4,["number",{value:1}],0,0,[3]],[5,["number",{value:4}],0,0,[3]],[6,"hiddennoflow",0,0,[0,null]],[7,"vspace",0,0,[1,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.tempo&&(t.tempo=new Tempo),t.inTempo=!0,t.tempo.BPMBlocks=[],t.tempo.BPMs=[];var l="_tempo_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.tempo.init(p)}),[e[0],1]}}]),r}(),s=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"arpeggiomatrix")).setPalette("widgets",p),e.setHelpString([_("The Arpeggio Widget is used to compose chord sequences."),"documentation",""]),e.formBlock({name:_("arpeggio"),canCollapse:!0,args:1,defaults:[4]}),e.makeMacro(function(e,t){return[[0,"arpeggiomatrix",e,t,[null,1,3,2]],[1,["number",{value:4}],0,0,[0]],[2,"hiddennoflow",0,0,[0,null]],[3,"newnote",0,0,[0,4,7,null]],[4,"divide",0,0,[3,5,6]],[5,["number",{value:1}],0,0,[4]],[6,["number",{value:16}],0,0,[4]],[7,"vspace",0,0,[3,8]],[8,"pitch",0,0,[7,9,10,null]],[9,["solfege",{value:"do"}],0,0,[8]],[10,["number",{value:4}],0,0,[8]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.arpeggio&&(t.arpeggio=new Arpeggio),t.inArpeggio=!0,0<e.length&&1<e[0]&&e[0]<21&&(t.arpeggio.defaultCols=e[0]),t.arpeggio.notesToPlay=[];var l="_arpeggio_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.arpeggio.init(p)}),[e[1],1]}}]),r}(),c=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"pitchdrummatrix")).setPalette("widgets",p),e.setHelpString([_("The Pitch drum matrix is used to map pitches to drum sounds."),"documentation",""]),e.formBlock({name:_("pitch-drum mapper"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"pitchdrummatrix",e,t,[null,1,16]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"sol"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"mi"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"re"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"playdrum",0,0,[7,11,12]],[11,["drumname",{value:"kick drum"}],0,0,[10]],[12,"playdrum",0,0,[10,13,14]],[13,["drumname",{value:"snare drum"}],0,0,[12]],[14,"playdrum",0,0,[12,15,null]],[15,["drumname",{value:"ride bell"}],0,0,[14]],[16,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.pitchDrumMatrix&&(t.pitchDrumMatrix=new PitchDrumMatrix),t.inPitchDrumMatrix=!0,t.pitchDrumMatrix.rowLabels=[],t.pitchDrumMatrix.rowArgs=[],t.pitchDrumMatrix.drums=[],t.pitchDrumMatrix.clearBlocks();var l="_pitchdrummatrix_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){0===t.pitchDrumMatrix.drums.length||0===t.pitchDrumMatrix.rowLabels.length?p.errorMsg(_("You must have at least one pitch block and one drum block in the matrix."),n):(t.pitchDrumMatrix.init(p),t.pitchDrumMatrix.makeClickable())}),1===e.length)return[e[0],1]}}]),r}(),m=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"pitchslider")).setPalette("widgets",p),e.beginnerBlock(!0),e.setHelpString([_("The Pitch slider tool to is used to generate pitches at selected frequencies."),"documentation",""]),e.formBlock({name:_("pitch slider"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"pitchslider",e,t,[null,1,3]],[1,"hertz",0,0,[0,2,null]],[2,["number",{value:392}],0,0,[1]],[3,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.pitchSlider&&(t.pitchSlider=new PitchSlider),t.inPitchSlider=!0,t.pitchSlider.frequencies=[];var l="_pitchslider_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.pitchSlider.init(p),t.inPitchSlider=!1}),[e[0],1]}}]),r}(),h=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"chromatic")).setPalette("widgets",p),e.setHelpString(),e.formBlock({name:_("chromatic keyboard"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,["musickeyboard",{collapsed:!1}],e,t,[null,2,1]],[1,["hiddennoflow",{}],0,0,[0,null]],[2,["setkey2",{}],0,0,[0,3,4,5]],[3,["notename",{value:"C"}],0,0,[2]],[4,["modename",{value:"chromatic"}],0,0,[2]],[5,["pitch",{}],0,0,[2,6,7,8]],[6,["solfege",{value:"do"}],0,0,[5]],[7,["number",{value:5}],0,0,[5]],[8,["repeat",{}],0,0,[5,9,10,null]],[9,["modelength",{}],0,0,[8]],[10,["steppitch",{}],0,0,[8,11,null]],[11,["number",{value:-1}],0,0,[10]]]}),e}return _createClass(r,[{key:"flow",value:function(){}}]),r}(),f=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"musickeyboard2")).setPalette("widgets",p),e.setHelpString(),e.formBlock({name:_("music keyboard"),canCollapse:!0}),e.beginnerBlock("ja"!==e.lang),e.makeMacro(function(e,t){return[[0,"setbpm3",0,0,[12,1,2,5]],[1,["number",{value:90}],0,0,[0]],[2,"divide",0,0,[0,3,4]],[3,["number",{value:1}],0,0,[2]],[4,["number",{value:4}],0,0,[2]],[5,"vspace",0,0,[0,6]],[6,"meter",0,0,[5,7,8,11]],[7,["number",{value:4}],0,0,[6]],[8,"divide",0,0,[6,9,10]],[9,["number",{value:1}],0,0,[8]],[10,["number",{value:4}],0,0,[8]],[11,"vspace",0,0,[6,13]],[12,["musickeyboard",{collapsed:!1}],e,t,[null,0,28]],[13,"pitch",0,0,[11,14,15,16]],[14,["solfege",{value:"sol"}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"pitch",0,0,[13,17,18,19]],[17,["solfege",{value:"fa"}],0,0,[16]],[18,["number",{value:4}],0,0,[16]],[19,"pitch",0,0,[16,20,21,22]],[20,["solfege",{value:"mi"}],0,0,[19]],[21,["number",{value:4}],0,0,[19]],[22,"pitch",0,0,[19,23,24,25]],[23,["solfege",{value:"re"}],0,0,[22]],[24,["number",{value:4}],0,0,[22]],[25,"pitch",0,0,[22,26,27,null]],[26,["solfege",{value:"do"}],0,0,[25]],[27,["number",{value:4}],0,0,[25]],[28,"hiddennoflow",0,0,[12,null]]]}),e}return r}(),d=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"musickeyboard")).setPalette("widgets",p),e.beginnerBlock(!0),p.beginnerMode&&"ja"===e.lang?e.setHelpString([_("The Music keyboard block opens a piano keyboard that can be used to create notes."),"documentation",null,"musickeyboardja"]):e.setHelpString([_("The Music keyboard block opens a piano keyboard that can be used to create notes."),"documentation",null,"musickeyboard2"]),e.formBlock({name:_("music keyboard"),canCollapse:!0}),e.hidden=!0,e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.musicKeyboard&&(t.musicKeyboard=new MusicKeyboard(p)),t.inMusicKeyboard=!0,t.musicKeyboard.blockNo=n,t.musicKeyboard.instruments=[],t.musicKeyboard.noteNames=[],t.musicKeyboard.octaves=[],t.musicKeyboard._rowBlocks=[];var l="_musickeyboard_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){t.musicKeyboard.init(t)}),1===e.length)return[e[0],1]}}]),r}(),v=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"pitchstaircase")).setPalette("widgets",p),e.beginnerBlock(!0),e.setHelpString([_("The Pitch staircase tool to is used to generate pitches from a given ratio."),"documentation",null,"pitchstaircase"]),e.formBlock({name:_("pitch staircase"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"pitchstaircase",e,t,[null,1,4]],[1,"pitch",0,0,[0,2,3,null]],[2,["solfege",{value:"sol"}],0,0,[1]],[3,["number",{value:3}],0,0,[1]],[4,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.pitchStaircase&&(t.pitchStaircase=new PitchStaircase),t.pitchStaircase.Stairs=[],t.pitchStaircase.stairPitchBlocks=[],t.inPitchStaircase=!0;var l="_pitchstaircase_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.pitchStaircase.init(p),t.inPitchStaircase=!1}),[e[0],1]}}]),r}(),b=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"rhythmruler3")).setPalette("widgets",p),e.setHelpString(),e.formBlock({name:_("rhythm maker"),canCollapse:!0}),e.beginnerBlock(!0),e.makeMacro(function(e,t){return[[0,"rhythmruler2",e,t,[null,1,9]],[1,"setdrum",0,0,[0,2,3,8]],[2,["drumname",{value:"snare drum"}],0,0,[1]],[3,"rhythm2",0,0,[1,4,5,null]],[4,["number",{value:1}],0,0,[3]],[5,"divide",0,0,[3,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:1}],0,0,[5]],[8,"hidden",0,0,[1,null]],[9,"hiddennoflow",0,0,[0,null]]]}),e.hidden=!p.beginnerMode,e}return r}(),g=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"rhythmruler2")).setPalette("widgets",p),e.setHelpString([_("The Rhythm Maker block opens a tool to create drum machines."),"documentation",null,"rhythmruler2"]),e.formBlock({name:_("rhythm maker"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"rhythmruler2",e,t,[null,1,17]],[1,"setdrum",0,0,[0,2,3,8]],[2,["drumname",{value:"snare drum"}],0,0,[1]],[3,"rhythm2",0,0,[1,4,5,null]],[4,["number",{value:1}],0,0,[3]],[5,"divide",0,0,[3,6,7]],[6,["number",{value:1}],0,0,[5]],[7,["number",{value:1}],0,0,[5]],[8,"hidden",0,0,[1,9]],[9,"setdrum",0,0,[8,10,11,16]],[10,["drumname",{value:"kick drum"}],0,0,[9]],[11,"rhythm2",0,0,[9,12,13,null]],[12,["number",{value:1}],0,0,[11]],[13,"divide",0,0,[11,14,15]],[14,["number",{value:1}],0,0,[13]],[15,["number",{value:1}],0,0,[13]],[16,"hidden",0,0,[9,null]],[17,"hiddennoflow",0,0,[0,null]]]}),e.hidden=p.beginnerMode,e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null==t.rhythmRuler&&(t.rhythmRuler=new RhythmRuler),t.rhythmRuler.Rulers=[],t.rhythmRuler.Drums=[],t.inRhythmRuler=!0;var l="_rhythmruler_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.rhythmRuler.init(p)}),[e[0],1]}}]),r}(),k=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"matrixgmajor",_("G major scale"))).setPalette("widgets",p),e.beginnerBlock(!0),e.makeMacro(function(e,t){return[[0,["matrix",{collapsed:!1}],e,t,[null,5,16]],[1,["solfege",{value:"sol"}],0,0,[10]],[2,["number",{value:5}],0,0,[10]],[3,"steppitch",0,0,[8,4,null]],[4,["number",{value:-1}],0,0,[3]],[5,"setkey2",0,0,[0,6,7,10]],[6,["notename",{value:"G"}],0,0,[5]],[7,["modename",{value:"major"}],0,0,[5]],[8,"repeat",0,0,[10,9,3,11]],[9,"modelength",0,0,[8]],[10,"pitch",0,0,[5,1,2,8]],[11,"rhythm2",0,0,[8,12,14,null]],[12,["number",{value:8}],0,0,[11]],[13,["number",{value:1}],0,0,[14]],[14,"divide",0,0,[11,13,15]],[15,["number",{value:4}],0,0,[14]],[16,"hiddennoflow",0,0,[0,null]]]}),e}return r}(),y=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"matrixcmajor",_("C major scale"))).setPalette("widgets",p),e.beginnerBlock(!0),e.makeMacro(function(e,t){return[[0,["matrix",{collapsed:!1}],e,t,[null,5,16]],[1,["solfege",{value:"do"}],0,0,[10]],[2,["number",{value:5}],0,0,[10]],[3,"steppitch",0,0,[8,4,null]],[4,["number",{value:-1}],0,0,[3]],[5,"setkey2",0,0,[0,6,7,10]],[6,["notename",{value:"C"}],0,0,[5]],[7,["modename",{value:"major"}],0,0,[5]],[8,"repeat",0,0,[10,9,3,11]],[9,"modelength",0,0,[8]],[10,"pitch",0,0,[5,1,2,8]],[11,"rhythm2",0,0,[8,12,14,null]],[12,["number",{value:8}],0,0,[11]],[13,["number",{value:1}],0,0,[14]],[14,"divide",0,0,[11,13,15]],[15,["number",{value:4}],0,0,[14]],[16,"hiddennoflow",0,0,[0,null]]]}),e}return r}(),w=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"matrix")).setPalette("widgets",p),e.beginnerBlock(!0),e.setHelpString([_("The Phrase Maker block opens a tool to create musical phrases."),"documentation",null,"matrix"]),e.formBlock({name:_("phrase maker"),canCollapse:!0}),p.beginnerMode?e.makeMacro(function(e,t){return[[0,"matrix",e,t,[null,1,33]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"ti"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"la"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"sol"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"pitch",0,0,[7,11,12,13]],[11,["solfege",{value:"mi"}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"pitch",0,0,[10,14,15,16]],[14,["solfege",{value:"re"}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"playdrum",0,0,[13,17,18]],[17,["drumname",{value:"snare drum"}],0,0,[16]],[18,"forward",0,0,[16,19,20]],[19,["number",{value:100}],0,0,[18]],[20,"right",0,0,[18,21,22]],[21,["number",{value:90}],0,0,[20]],[22,"rhythm2",0,0,[20,23,24,27]],[23,["number",{value:6}],0,0,[22]],[24,"divide",0,0,[22,25,26]],[25,["number",{value:1}],0,0,[24]],[26,["number",{value:4}],0,0,[24]],[27,"vspace",0,0,[22,28]],[28,"rhythm2",0,0,[27,29,30,null]],[29,["number",{value:1}],0,0,[28]],[30,"divide",0,0,[28,31,32]],[31,["number",{value:1}],0,0,[30]],[32,["number",{value:2}],0,0,[30]],[33,"hiddennoflow",0,0,[0,null]]]}):e.makeMacro(function(e,t){return[[0,"matrix",e,t,[null,1,35]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"ti"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"la"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"sol"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"pitch",0,0,[7,11,12,13]],[11,["solfege",{value:"mi"}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"pitch",0,0,[10,14,15,16]],[14,["solfege",{value:"re"}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"playdrum",0,0,[13,17,18]],[17,["drumname",{value:"snare drum"}],0,0,[16]],[18,"forward",0,0,[16,19,20]],[19,["number",{value:100}],0,0,[18]],[20,"right",0,0,[18,21,22]],[21,["number",{value:90}],0,0,[20]],[22,"print",0,0,[20,23,24]],[23,["text",{value:_("lyrics")}],0,0,[22]],[24,"rhythm2",0,0,[22,25,26,29]],[25,["number",{value:6}],0,0,[24]],[26,"divide",0,0,[24,27,28]],[27,["number",{value:1}],0,0,[26]],[28,["number",{value:4}],0,0,[26]],[29,"vspace",0,0,[24,30]],[30,"rhythm2",0,0,[29,31,32,null]],[31,["number",{value:1}],0,0,[30]],[32,"divide",0,0,[30,33,34]],[33,["number",{value:1}],0,0,[32]],[34,["number",{value:2}],0,0,[32]],[35,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,n,t,l){n.inMatrix=!0,null===n.phraseMaker&&(n.phraseMaker=new PhraseMaker),n.phraseMaker.blockNo=l,n.phraseMaker._instrumentName=DEFAULTVOICE,n.phraseMaker.rowLabels=[],n.phraseMaker.rowArgs=[],n.phraseMaker.graphicsBlocks=[],n.phraseMaker.clearBlocks(),n.phraseMaker.lyricsON=!1,n.tupletRhythms=[],n.tupletParams=[],n.addingNotesToTuplet=!1;var r="_matrix_"+t;n.setDispatchBlock(l,t,r);if(n.setTurtleListener(t,r,function(){if(0===n.tupletRhythms.length||0===n.phraseMaker.rowLabels.length)p.errorMsg(_("You must have at least one pitch block and one rhythm block in the matrix."),l);else{n.phraseMaker.blockNo=l,n.phraseMaker.sorted=!1,n.phraseMaker.init(p);for(var e=0;e<n.tupletRhythms.length;e++)switch(n.tupletRhythms[e][0]){case"notes":case"simple":var t=[n.tupletParams[n.tupletRhythms[e][1]]];t.push([]);for(var r=2;r<n.tupletRhythms[e].length;r++)t[1].push(n.tupletRhythms[e][r]);n.phraseMaker.addTuplet(t);break;default:n.phraseMaker.addNotes(n.tupletRhythms[e][1],n.tupletRhythms[e][2])}n.phraseMaker.makeClickable()}}),1===e.length)return[e[0],1]}}]),r}(),C=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"status")).setPalette("widgets",p),e.beginnerBlock(!0),e.setHelpString([_("The Status block opens a tool for inspecting the status of Music Blocks as it is running."),"documentation",null,"status"]),e.formBlock({name:_("status"),canCollapse:!0}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.statusMatrix&&(t.statusMatrix=new StatusMatrix),t.statusMatrix.init(p),t.statusFields=[],t.inStatusMatrix=!0;var l="_status_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){t.statusMatrix.init(p),t.inStatusMatrix=!1}),1===e.length)return[e[0],1]}}]),r}(),S=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"reflection")).setPalette("widgets",p),e.beginnerBlock(!0),e.setHelpString([_("The Reflection block opens a space for you to think about your learning."),null,"reflection"]),e.formBlock({name:_("reflection"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"reflection",e,t,[null,1]],[1,"print",0,0,[0,2,null]],[2,["text",{value:"Reflective Learning"}],0,0,[1]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.reflection&&(t.reflection=new ReflectionMatrix),t.reflection.init(p),t.statusFields=[],t.inReflectionMatrix=!0;var l="_reflection_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){t.reflection.init(p),t.inReflectionMatrix=!1}),1===e.length)return[e[0],1]}}]),r}(),M=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"legobricks")).setPalette("widgets",p),e.parameter=!0,e.beginnerBlock(!0),e.setHelpString([_("The LEGO Bricks block opens a widget for designing virtual LEGO creations."),"documentation",null,"legobricks"]),e.formBlock({name:_("LEGO Bricks"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"legobricks",e,t,[null,1,18]],[1,"pitch",0,0,[0,2,3,4]],[2,["solfege",{value:"do"}],0,0,[1]],[3,["number",{value:4}],0,0,[1]],[4,"pitch",0,0,[1,5,6,7]],[5,["solfege",{value:"re"}],0,0,[4]],[6,["number",{value:4}],0,0,[4]],[7,"pitch",0,0,[4,8,9,10]],[8,["solfege",{value:"mi"}],0,0,[7]],[9,["number",{value:4}],0,0,[7]],[10,"pitch",0,0,[7,11,12,13]],[11,["solfege",{value:"fa"}],0,0,[10]],[12,["number",{value:4}],0,0,[10]],[13,"pitch",0,0,[10,14,15,16]],[14,["solfege",{value:"sol"}],0,0,[13]],[15,["number",{value:4}],0,0,[13]],[16,"playdrum",0,0,[13,17,null]],[17,["drumname",{value:"kick drum"}],0,0,[16]],[18,"hiddennoflow",0,0,[0,null]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){t.inLegoWidget=!0,null===t.legoWidget&&(t.legoWidget=new LegoWidget),t.legoWidget.blockNo=n,t.legoWidget.rowLabels=[],t.legoWidget.rowArgs=[],t.legoWidget.clearBlocks();var l="_legobricks_"+r;t.setDispatchBlock(n,r,l);if(t.setTurtleListener(r,l,function(){0===t.legoWidget.rowLabels.length?p.errorMsg(_("You must have at least one pitch block in the LEGO bricks widget."),n):(t.legoWidget.blockNo=n,t.legoWidget.init(p)),t.inLegoWidget=!1}),1===e.length)return[e[0],1]}}]),r}(),B=function(){_inherits(r,StackClampBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"aidebugger")).setPalette("widgets",p),e.parameter=!0,e.beginnerBlock(!0),e.setHelpString([_("Debug your music blocks project with new possibilities and more understanding."),"documentation",null,"aidebugger"]),e.formBlock({name:_("Debugger"),canCollapse:!0}),e.makeMacro(function(e,t){return[[0,"aidebugger",e,t,[null,1]],[1,"print",0,0,[0,2,null]],[2,["text",{value:"Debugger Initiated"}],0,0,[1]]]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null===t.sample&&(t.sample=new AIDebuggerWidget),t.inSample=!0,t.sample=new AIDebuggerWidget;var l="_sampler_"+r;t.setDispatchBlock(n,r,l);return t.setTurtleListener(r,l,function(){t.sample.init(p)}),[e[0],1]}}]),r}();_THIS_IS_MUSIC_BLOCKS_&&((new e).setup(p),(new t).setup(p),(new r).setup(p),(new l).setup(p),(new a).setup(p),(new o).setup(p),(new u).setup(p),(new n).setup(p),(new s).setup(p),(new c).setup(p),(new i).setup(p),(new m).setup(p),(new h).setup(p),(new M).setup(p),(new S).setup(p),(new f).setup(p),(new d).setup(p),(new v).setup(p),(new b).setup(p),(new g).setup(p),(new k).setup(p),(new y).setup(p),(new w).setup(p)),(new B).setup(p),(new C).setup(p)}
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(o){var i=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(o);return _possibleConstructorReturn(this,i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperty(t,e,o){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0===o)return("string"===e?String:Number)(t);var i=o.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}global.LeftBlock=function(){return function t(){_classCallCheck(this,t),_defineProperty(this,"setPalette",jest.fn()),_defineProperty(this,"setHelpString",jest.fn()),_defineProperty(this,"formBlock",jest.fn()),_defineProperty(this,"setup",jest.fn()),_defineProperty(this,"makeMacro",jest.fn()),_defineProperty(this,"beginnerBlock",jest.fn()),_defineProperty(this,"updateDockValue",jest.fn()),_defineProperty(this,"flow",jest.fn().mockImplementation(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0;return t.includes("test.abc")&&this.activity.save.afterSaveAbc("test.abc"),t.includes("test.ly")&&this.activity.save.afterSaveLilypond("test.ly"),t.includes("test.svg")&&this.activity.save.saveSVG("test.svg"),this instanceof this.activity.blocks.NoBackgroundBlock&&(e.svgBackground=!1),this instanceof this.activity.blocks.WaitBlock&&this.activity.turtles.ithTurtle(o),this instanceof this.activity.blocks.DrumBlock?[1,1]:(this instanceof this.activity.blocks.ShowBlocksBlock&&this.activity.blocks.showBlocks(),this instanceof this.activity.blocks.HideBlocksBlock&&this.activity.blocks.hideBlocks(),this instanceof this.activity.blocks.CommentBlock&&this.activity.textMsg(t[0]),this instanceof this.activity.blocks.PrintBlock&&this.activity.textMsg(t[0]),this instanceof this.activity.blocks.DisplayGridBlock&&("Cartesian"===t[0]?this.activity.blocks.activity._showCartesian():"polar"===t[0]&&this.activity.blocks.activity._showPolar()),t)})),_defineProperty(this,"arg",jest.fn().mockImplementation(function(){return"parsedArg"}))}}(),global.FlowBlock=function(){_inherits(e,global.LeftBlock);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return e}(),global.ValueBlock=function(){_inherits(e,global.LeftBlock);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return e}(),global.StackClampBlock=function(){_inherits(e,global.LeftBlock);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return e}(),global._=jest.fn(function(t){return t});var _require=require("../ExtrasBlocks"),setupExtrasBlocks=_require.setupExtrasBlocks;describe("ExtrasBlocks",function(){var i,e,s;beforeEach(function(){i={blocks:{blockList:{},showBlocks:jest.fn(),hideBlocks:jest.fn(),activity:{_showCartesian:jest.fn(),_showPolar:jest.fn(),_showTreble:jest.fn(),_showGrand:jest.fn(),_showSoprano:jest.fn(),_showAlto:jest.fn(),_showTenor:jest.fn(),_showBass:jest.fn()}},turtles:{ithTurtle:jest.fn(function(){return{singer:{suppressOutput:!1,bpm:[120],inNoteBlock:[],turtleTime:0,previousTurtleTime:0},doWait:jest.fn()}}),getTurtleCount:jest.fn(function(){return 1}),getTurtle:jest.fn(function(){return{inTrash:!1,name:"turtle1"}})},save:{afterSaveAbc:jest.fn(),afterSaveLilypond:jest.fn(),saveSVG:jest.fn()},errorMsg:jest.fn(),textMsg:jest.fn()},e={parseArg:jest.fn(function(t,e,o,i,s){return o?"parsedArg":null}),inOscilloscope:!1,inMatrix:!1,inStatusMatrix:!1,svgOutput:"",canvas:{height:500,width:500},svgBackground:!0,oscilloscopeTurtles:[],turtleDelay:0,runningLilypond:!1,notation:{notationMarkup:jest.fn()},phraseMaker:{lyricsON:!1}},s=0,setupExtrasBlocks(i);var o=function(){_inherits(o,global.FlowBlock);var e=_createSuper(o);function o(){var t;return _classCallCheck(this,o),(t=e.call(this)).activity=i,t}return o}();["FloatToStringBlock","SaveABCBlock","SaveLilypondBlock","SaveSVGBlock","NoBackgroundBlock","ShowBlocksBlock","HideBlocksBlock","VSpaceBlock","HSpaceBlock","WaitBlock","CommentBlock","PrintBlock","DrumBlock","GridBlock","NOPValueBlock","NOPOneArgMathBlock","NOPTwoArgMathBlock","NOPZeroArgBlock","NOPOneArgBlock","NOPTwoArgBlock","NOPThreeArgBlock","NOPFourArgBlock","DisplayGridBlock"].forEach(function(t){var e=new o;e.flow=jest.fn().mockImplementation(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0;return t.includes("test.abc")&&this.activity.save.afterSaveAbc("test.abc"),t.includes("test.ly")&&this.activity.save.afterSaveLilypond("test.ly"),t.includes("test.svg")&&this.activity.save.saveSVG("test.svg"),this instanceof this.activity.blocks.NoBackgroundBlock&&(e.svgBackground=!1),this instanceof this.activity.blocks.WaitBlock&&this.activity.turtles.ithTurtle(o),this instanceof this.activity.blocks.ShowBlocksBlock&&this.activity.blocks.showBlocks(),this instanceof this.activity.blocks.HideBlocksBlock&&this.activity.blocks.hideBlocks(),this instanceof this.activity.blocks.CommentBlock&&this.activity.textMsg(t[0]),this instanceof this.activity.blocks.PrintBlock&&this.activity.textMsg(t[0]),this instanceof this.activity.blocks.DisplayGridBlock&&("Cartesian"===t[0]?this.activity.blocks.activity._showCartesian():"polar"===t[0]&&this.activity.blocks.activity._showPolar()),t}),e.arg=jest.fn().mockReturnValue("parsedArg"),i.blocks[t]=o,i.blocks.blockList[t]=e,Object.setPrototypeOf(e,o.prototype)})}),test("should setup all blocks",function(){expect(Object.keys(i.blocks.blockList).length).toBeGreaterThan(0)}),test("FloatToStringBlock: should convert float to fraction",function(){var t=new i.blocks.FloatToStringBlock;expect(t.arg(e,s,1,{value:.5})).toBe("parsedArg")}),test("SaveABCBlock: should trigger save function",function(){(new i.blocks.SaveABCBlock).flow(["test.abc"],e,s),expect(i.save.afterSaveAbc).toHaveBeenCalledWith("test.abc")}),test("SaveLilypondBlock: should trigger save function",function(){(new i.blocks.SaveLilypondBlock).flow(["test.ly"],e,s),expect(i.save.afterSaveLilypond).toHaveBeenCalledWith("test.ly")}),test("SaveSVGBlock: should save SVG with background",function(){(new i.blocks.SaveSVGBlock).flow(["test.svg"],e,s,1),expect(i.save.saveSVG).toHaveBeenCalledWith("test.svg")}),test("NoBackgroundBlock: should disable background",function(){(new i.blocks.NoBackgroundBlock).flow([],e),expect(e.svgBackground).toBe(!1)}),test("VSpaceBlock: should flow without logic",function(){var t=new i.blocks.VSpaceBlock;expect(function(){return t.flow([],e)}).not.toThrow()}),test("HSpaceBlock: should return parsed argument",function(){var t=new i.blocks.HSpaceBlock;expect(t.arg(e,s,1,{value:5})).toBe("parsedArg")}),test("WaitBlock: should wait and update time",function(){(new i.blocks.WaitBlock).flow([2],e,s),expect(i.turtles.ithTurtle).toHaveBeenCalledWith(s)}),test("DrumBlock: should flow with args",function(){var t=new i.blocks.DrumBlock;expect(t.flow([1],e)).toEqual([1,1])}),test("GridBlock: should initialize correctly",function(){var t=new i.blocks.GridBlock;expect(t).toBeInstanceOf(i.blocks.GridBlock)}),test("NOP blocks: should initialize without errors",function(){[new i.blocks.NOPValueBlock,new i.blocks.NOPOneArgMathBlock,new i.blocks.NOPTwoArgMathBlock,new i.blocks.NOPZeroArgBlock,new i.blocks.NOPOneArgBlock,new i.blocks.NOPTwoArgBlock,new i.blocks.NOPThreeArgBlock,new i.blocks.NOPFourArgBlock].forEach(function(t){expect(t).toBeDefined()})})});
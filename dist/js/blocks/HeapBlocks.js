"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function setupHeapBlocks(s){var e=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"heap")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Heap block returns the heap."),"documentation",""]),e.formBlock({name:_("heap"),outType:"numberout"}),e}return _createClass(r,[{key:"arg",value:function(e,t,r){if(!e.inStatusMatrix||"print"!==s.blocks.blockList[s.blocks.blockList[r].connections[0]].name)return JSON.stringify(e.turtleHeaps[t]);e.statusFields.push([r,"heap"])}}]),r}(),t=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"showHeap")).setPalette("heap",s),e.hidden=e.deprecated=!0,e.beginnerBlock(!0),e.setHelpString([_("The Show-heap block displays the contents of the heap at the top of the screen."),"documentation",""]),e.formBlock({name:_("show heap")}),e}return _createClass(r,[{key:"flow",value:function(e,t,r){r in t.turtleHeaps||(t.turtleHeaps[r]=[]),s.textMsg(JSON.stringify(t.turtleHeaps[r]))}}]),r}(),r=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"heapLength")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Heap-length block returns the length of the heap."),"documentation",""]),e.formBlock({name:_("heap length"),outType:"numberout"}),e}return _createClass(r,[{key:"arg",value:function(e,t,r){if(t in e.turtleHeaps||(e.turtleHeaps[t]=[]),!e.inStatusMatrix||"print"!==s.blocks.blockList[s.blocks.blockList[r].connections[0]].name)return e.turtleHeaps[t].length;e.statusFields.push([r,"heapLength"])}}]),r}(),n=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"heapEmpty")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Heap-empty? block returns true if the heap is empty."),"documentation",""]),e.formBlock({name:_("heap empty?"),outType:"booleanout"}),e}return _createClass(r,[{key:"arg",value:function(e,t){return!(t in e.turtleHeaps)||0===e.turtleHeaps[t].length}}]),r}(),o=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"emptyHeap")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Empty-heap block empties the heap."),"documentation",""]),e.formBlock({name:_("empty heap")}),e}return _createClass(r,[{key:"flow",value:function(e,t,r){t.turtleHeaps[r]=[]}}]),r}(),a=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"reverseHeap")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Reverse-heap block reverses the order of the heap."),"documentation",""]),e.formBlock({name:_("reverse heap")}),e}return _createClass(r,[{key:"flow",value:function(e,t,r){t.turtleHeaps[r]=t.turtleHeaps[r].reverse()}}]),r}(),l=function(){_inherits(r,LeftBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"indexHeap")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Index-heap block returns a value in the heap at a specified location."),"documentation",""]),e.formBlock({name:_("index heap"),args:1,defaults:[1]}),e}return _createClass(r,[{key:"arg",value:function(e,t,r,n){var o=s.blocks.blockList[r].connections[1];if(null===o)return s.errorMsg(NOINPUTERRORMSG,r),0;var a=e.parseArg(e,t,o,r,n);if("number"!=typeof a)return s.errorMsg(NANERRORMSG,r),0;t in e.turtleHeaps||(e.turtleHeaps[t]=[]),-1===a?a=e.turtleHeaps[t].length:a<1&&(a=1,s.errorMsg(_("Index must be > 0."))),1e3<a&&(a=1e3,s.errorMsg(_("Maximum heap size is 1000.")));for(;e.turtleHeaps[t].length<a;)e.turtleHeaps[t].push(0);return e.turtleHeaps[t][a-1]}}]),r}(),i=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"setHeapEntry")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Set-heap entry block sets a value in he heap at the specified location."),"documentation",""]),e.formBlock({name:_("set heap"),args:2,argTypes:["numberin","anyin"],defaults:[1,100],argLabels:[_("index"),"ja"===e.lang?_("value1"):_("value")]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){if(null!==e[0]&&null!==e[1])if("number"==typeof e[0]&&"number"==typeof e[1]){r in t.turtleHeaps||(t.turtleHeaps[r]=[]);var o=Math.floor(e[0]);for(o<1&&(s.errorMsg(_("Index must be > 0.")),o=1),1e3<o&&(s.errorMsg(_("Maximum heap size is 1000.")),o=1e3);t.turtleHeaps[r].length<o;)t.turtleHeaps[r].push(0);t.turtleHeaps[r][o-1]=e[1]}else s.errorMsg(NANERRORMSG,n);else s.errorMsg(NOINPUTERRORMSG,n)}}]),r}(),u=function(){_inherits(r,ValueBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"pop")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Pop block removes the value at the top of the heap."),"documentation",""]),e.formBlock({name:_("pop")}),e}return _createClass(r,[{key:"arg",value:function(e,t){return t in e.turtleHeaps&&0<e.turtleHeaps[t].length?e.turtleHeaps[t].pop():(s.errorMsg(_("empty heap")),0)}}]),r}(),c=function(){_inherits(r,FlowBlock);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this,"push")).setPalette("heap",s),e.beginnerBlock(!0),e.setHelpString([_("The Push block adds a value to the top of the heap."),"documentation",""]),e.formBlock({name:_("push"),args:1,argTypes:["anyin"],defaults:[1]}),e}return _createClass(r,[{key:"flow",value:function(e,t,r,n){null!==e[0]?(r in t.turtleHeaps||(t.turtleHeaps[r]=[]),t.turtleHeaps[r].push(e[0])):s.errorMsg(NOINPUTERRORMSG,n)}}]),r}();(new e).setup(s),(new t).setup(s),(new r).setup(s),(new n).setup(s),(new o).setup(s),(new a).setup(s),(new l).setup(s),(new i).setup(s),(new u).setup(s),(new c).setup(s)}"undefined"!=typeof module&&module.exports&&(module.exports={setupHeapBlocks:setupHeapBlocks});
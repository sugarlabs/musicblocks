"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function setupNumberBlocks(p){var t=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"int")).setPalette("number",p),t.setHelpString([_("The Int block returns an integer."),"documentation",""]),t.formBlock({name:_("int"),args:1,argTypes:["anyin"],defaults:[100]}),t}return _createClass(r,[{key:"arg",value:function(t,e,r,n){if(t.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)t.statusFields.push([r,"int"]);else{var o=p.blocks.blockList[r].connections[1];if(null===o)return p.errorMsg(NOINPUTERRORMSG,r),0;var s=t.parseArg(t,e,o,r,n);try{return MathUtility.doInt(s)}catch(t){return this.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}}}]),r}(),e=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"mod")).setPalette("number",p),t.setHelpString([_("The Mod block returns the remainder from a division."),"documentation",""]),t.formBlock({name:_("mod"),args:2,defaults:[100,12]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(e,t,r,n){if(e.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)e.statusFields.push([r,"mod"]);else{var o=p.blocks.blockList[r].connections[1],s=p.blocks.blockList[r].connections[2];if(null===o||null===s)return p.errorMsg(NOINPUTERRORMSG,r),0;var l=e.parseArg(e,t,o,r,n);if("string"==typeof l)try{l=parseInt(l)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}var c=e.parseArg(e,t,s,r,n);if("string"==typeof c)try{c=parseInt(c)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}try{return MathUtility.doMod(l,c)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}}}]),r}(),r=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"power")).setPalette("number",p),t.setHelpString([_("The Power block calculates a power function."),"documentation",""]),t.fontsize=14,t.formBlock({name:"^",args:2,defaults:[2,4]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(e,t,r,n){if(e.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)e.statusFields.push([r,"power"]);else{var o=p.blocks.blockList[r].connections[1],s=p.blocks.blockList[r].connections[2];if(null===o||null===s)return p.errorMsg(NOINPUTERRORMSG,r),null!==o?e.parseArg(e,t,o,r,n):0;var l=e.parseArg(e,t,o,r,n),c=e.parseArg(e,t,s,r,n);try{return MathUtility.doPower(l,c)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}}}]),r}(),n=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"sqrt")).setPalette("number",p),t.setHelpString([_("The Sqrt block returns the square root."),"documentation",""]),t.formBlock({name:_("sqrt"),args:1,defaults:[64]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(e,t,r,n){if(e.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)e.statusFields.push([r,p.blocks.blockList[r].name]);else{var o=p.blocks.blockList[r].connections[1];if(null===o)return p.errorMsg(NOINPUTERRORMSG,r),0;var s=e.parseArg(e,t,o,r,n);try{return MathUtility.doSqrt(s)}catch(t){if(e.stopTurtle=!0,"NanError"===t)p.errorMsg(NANERRORMSG,r);else if("NoSqrtError"===t)return p.errorMsg(NOSQRTERRORMSG,r),MathUtility.doSqrt(-s);return 0}}}}]),r}(),o=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"abs")).setPalette("number",p),t.setHelpString([_("The Abs block returns the absolute value."),"documentation",""]),t.formBlock({name:_("abs"),args:1}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(t,e,r,n){if(t.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)t.statusFields.push([r,p.blocks.blockList[r].name]);else{var o=p.blocks.blockList[r].connections[1];if(null===o)return p.errorMsg(NOINPUTERRORMSG,r),0;var s=t.parseArg(t,e,o,r,n);try{return MathUtility.doAbs(s)}catch(t){return this.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}}}]),r}(),s=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"distance")).setPalette("number",p),t.setHelpString([_("The Distance block returns the distance between two points. For example, between the mouse and the center of the screen."),"documentation",""]),t.formBlock({name:_("distance"),args:4,defaults:[0,0,100,100],argTypes:["anyin","anyin","anyin","anyin"],outType:"anyout",argLabels:["x1","y1","x2","y2"]}),t.makeMacro(function(t,e){return[[0,"distance",t,e,[null,1,2,3,4]],[1,["number",{value:0}],0,0,[0]],[2,["number",{value:0}],0,0,[0]],[3,"x",0,0,[0]],[4,"y",0,0,[0]]]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(t,e,r,n){if(t.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)t.statusFields.push([r,"distance"]);else{var o=p.blocks.blockList[r].connections[1],s=p.blocks.blockList[r].connections[2],l=p.blocks.blockList[r].connections[3],c=p.blocks.blockList[r].connections[4];if(null===o||null===s||null===l||null===c)return p.errorMsg(NOINPUTERRORMSG,r),0;var i=t.parseArg(t,e,o,r,n),a=t.parseArg(t,e,s,r,n),u=t.parseArg(t,e,l,r,n),b=t.parseArg(t,e,c,r,n);try{return MathUtility.doCalculateDistance(i,a,u,b)}catch(t){return p.errorMsg(NANERRORMSG,r),0}}}}]),r}(),l=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"divide")).setPalette("number",p),t.beginnerBlock(!0),t.setHelpString([_("The Divide block is used to divide."),"documentation",null,"note1"]),t.fontsize=9,t.formBlock({name:"ja"===t.lang?"➗":"/",args:2,argTypes:["anyin","anyin"],defaults:[1,4]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return p.blocks.blockList[r].value}},{key:"arg",value:function(e,t,r,n){if(e.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)e.statusFields.push([r,"divide"]);else{var o=p.blocks.blockList[r].connections[1],s=p.blocks.blockList[r].connections[2];if(null===o||null===s)return p.errorMsg(NOINPUTERRORMSG,r),null!==o?e.parseArg(e,t,o,r,n):0;var l=e.parseArg(e,t,o,r,n);if("string"==typeof l)try{l=parseInt(l)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}var c=e.parseArg(e,t,s,r,n);if("string"==typeof c)try{c=parseInt(c)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}try{return MathUtility.doDivide(l,c)}catch(t){return e.stopTurtle=!0,"NanError"===t?p.errorMsg(NANERRORMSG,r):"DivByZeroError"===t&&p.errorMsg(ZERODIVIDEERRORMSG,r),0}}}}]),r}(),c=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"multiply")).setPalette("number",p),t.beginnerBlock(!0),t.setHelpString([_("The Multiply block is used to multiply."),"documentation",""]),t.fontsize=14,t.formBlock({name:"×",args:2,argTypes:["anyin","anyin"],defaults:[1,12]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(e,t,r,n){if(e.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)e.statusFields.push([r,"multiply"]);else{var o=p.blocks.blockList[r].connections[1],s=p.blocks.blockList[r].connections[2];if(null===o||null===s)return p.errorMsg(NOINPUTERRORMSG,r),null!==o?e.parseArg(e,t,o,r,n):null!==s?e.parseArg(e,t,s,r,n):0;var l=p.turtles.ithTurtle(t),c=p.blocks.blockList[r].connections[0];if(null!==c&&"pitch"===p.blocks.blockList[c].name){var i=p.blocks.blockList[c].connections[1],a="string"==typeof p.blocks.blockList[o].value?calcOctave(l.singer.currentOctave,p.blocks.blockList[o].value,l.singer.lastNotePlayed,p.blocks.blockList[i].value):e.parseArg(e,t,o,r,n),u="string"==typeof p.blocks.blockList[s].value?calcOctave(l.singer.currentOctave,p.blocks.blockList[s].value,l.singer.lastNotePlayed,p.blocks.blockList[i].value):e.parseArg(e,t,s,r,n);try{return MathUtility.doMultiply(a,u)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}else{if("string"==typeof(a=e.parseArg(e,t,o,r,n)))try{a=parseInt(a)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}if("string"==typeof(u=e.parseArg(e,t,s,r,n)))try{u=parseInt(u)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}try{return MathUtility.doMultiply(a,u)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}}}}]),r}(),i=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"neg")).setPalette("number",p),t.setHelpString(),t.fontsize=14,t.formBlock({name:"–",args:1,argTypes:["anyin"],outType:"numberout"}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return p.blocks.blockList[r].value}},{key:"arg",value:function(e,t,r,n){if(e.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)e.statusFields.push([r,"neg"]);else{var o=p.blocks.blockList[r].connections[1];if(null===o)return p.errorMsg(NOINPUTERRORMSG,r),0;var s=e.parseArg(e,t,o,r,n);if("string"==typeof s)try{s=parseInt(s)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}try{return MathUtility.doNegate(s)}catch(t){return s}}}}]),r}(),a=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"minus")).setPalette("number",p),t.beginnerBlock(!0),t.setHelpString([_("The Minus block is used to subtract."),"documentation",""]),t.fontsize=14,t.formBlock({name:"–",args:2,defaults:[8,4],argTypes:["anyin","anyin"]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(e,t,r,n){if(e.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)e.statusFields.push([r,"minus"]);else{var o=p.blocks.blockList[r].connections[1],s=p.blocks.blockList[r].connections[2];if(null===o||null===s)return p.errorMsg(NOINPUTERRORMSG,r),null!==o?e.parseArg(e,t,o,r,n):null!==s?-1*e.parseArg(e,t,s,r,n):0;var l=p.turtles.ithTurtle(t),c=p.blocks.blockList[r].connections[0];if(null!==c&&"pitch"===p.blocks.blockList[c].name)var i=p.blocks.blockList[c].connections[1],a="string"==typeof p.blocks.blockList[o].value?calcOctave(l.singer.currentOctave,p.blocks.blockList[o].value,l.singer.lastNotePlayed,p.blocks.blockList[i].value):e.parseArg(e,t,o,r,n),u="string"==typeof p.blocks.blockList[s].value?calcOctave(l.singer.currentOctave,p.blocks.blockList[s].value,l.singer.lastNotePlayed,p.blocks.blockList[i].value):e.parseArg(e,t,s,r,n);else{if("string"==typeof(a=e.parseArg(e,t,o,r,n)))try{a=parseInt(a)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}if("string"==typeof(u=e.parseArg(e,t,s,r,n)))try{u=parseInt(u)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}try{return MathUtility.doMinus(a,u)}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}}}]),r}(),u=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"plus")).setPalette("number",p),t.beginnerBlock(!0),t.setHelpString([_("The Plus block is used to add."),"documentation",""]),t.fontsize=14,t.formBlock({name:"+",outType:"anyout",args:2,defaults:[2,2],argTypes:["anyin","anyin"]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return"string"==typeof p.blocks.blockList[r].value?p.blocks.blockList[r].value:toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(t,e,r,n){if(t.inStatusMatrix&&"print"===p.blocks.blockList[p.blocks.blockList[r].connections[0]].name)t.statusFields.push([r,"plus"]);else{var o=p.blocks.blockList[r].connections[1],s=p.blocks.blockList[r].connections[2];if(null===o||null===s)return p.errorMsg(NOINPUTERRORMSG,r),null!==o?t.parseArg(t,e,o,r,n):null!==s?t.parseArg(t,e,s,r,n):0;var l=p.turtles.ithTurtle(e),c=p.blocks.blockList[r].connections[0];if(null!==c&&"pitch"===p.blocks.blockList[c].name){if("accidentalname"===p.blocks.blockList[s].name){var i="namedbox"===p.blocks.blockList[o].name?t.boxes[p.blocks.blockList[o].overrideName]:p.blocks.blockList[o].value,a=p.blocks.blockList[s].value.split(" ");return i+=a=a[a.length-1]}var u=p.blocks.blockList[c].connections[1],b="string"==typeof p.blocks.blockList[o].value?calcOctave(l.singer.currentOctave,p.blocks.blockList[o].value,l.singer.lastNotePlayed,p.blocks.blockList[u].value):t.parseArg(t,e,o,r,n),k="string"==typeof p.blocks.blockList[s].value?calcOctave(l.singer.currentOctave,p.blocks.blockList[s].value,l.singer.lastNotePlayed,p.blocks.blockList[u].value):t.parseArg(t,e,s,r,n)}else b=t.parseArg(t,e,o,r,n),k=t.parseArg(t,e,s,r,n);if(!isNaN(b)&&!isNaN(k))return MathUtility.doPlus(b,k);try{return MathUtility.doPlus(b,k)}catch(t){return p.errorMsg(NOINPUTERRORMSG,r),console.debug(b+" "+k),console.debug(t),isNaN(b)?isNaN(k)?0:k:b}}}}]),r}(),b=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"oneOf")).setPalette("number",p),t.beginnerBlock(!0),t.setHelpString([_("The One-of block returns one of two choices."),"documentation",null,"oneofhelp"]),t.formBlock({name:_("one of"),args:2,argLabels:[_("this"),_("that")],outType:"anyout",argTypes:["anyin","anyin"],defaults:[-90,90]}),t.makeMacro(function(t,e){return[[0,"oneOf",t,e,[null,1,2,null]],[1,["number",{value:0}],0,0,[0]],[2,["number",{value:1}],0,0,[0]]]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return"string"==typeof p.blocks.blockList[r].value?p.blocks.blockList[r].value:toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(t,e,r,n){var o,s,l=p.blocks.blockList[r].connections[1],c=p.blocks.blockList[r].connections[2];return null!==l&&(o=t.parseArg(t,e,l,r,n)),null!==c&&(s=t.parseArg(t,e,c,r,n)),null===l||null===c?(p.errorMsg(NOINPUTERRORMSG,r),null!==l?o:null!==c?s:0):MathUtility.doOneOf(o,s)}}]),r}(),k=function(){_inherits(r,LeftBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"random")).setPalette("number",p),t.beginnerBlock(!0),t.setHelpString([_("The Random block returns a random number."),"documentation",null,"randomhelp"]),t.formBlock({name:_("random"),args:2,argLabels:[_("min"),_("max")],argTypes:["anyin","anyin"],defaults:[0,12]}),t}return _createClass(r,[{key:"updateParameter",value:function(t,e,r){return"string"==typeof p.blocks.blockList[r].value?p.blocks.blockList[r].value:toFixed2(p.blocks.blockList[r].value)}},{key:"arg",value:function(e,t,r,n){var o=p.blocks.blockList[r].connections[0],s=p.blocks.blockList[r].connections[1],l=p.blocks.blockList[r].connections[2];if(null===s||null===l)return p.errorMsg(NOINPUTERRORMSG,r),0;var c=e.parseArg(e,t,s,r,n),i=e.parseArg(e,t,l,r,n),a=void 0;if(null!==o){for(var u=p.blocks.blockList[o];"hspace"===u.name;)u=p.blocks.blockList[u.connections[0]];"pitch"===u.name&&(a=p.blocks.blockList[u.connections[2]].value)}try{if(void 0!==a)return MathUtility.doRandom(c,i,a);var b=MathUtility.doRandom(c,i,a);return"object"===_typeof(b)?b[0]:b}catch(t){return e.stopTurtle=!0,p.errorMsg(NANERRORMSG,r),0}}}]),r}(),f=function(){_inherits(r,ValueBlock);var e=_createSuper(r);function r(){var t;return _classCallCheck(this,r),(t=e.call(this,"number",_("number"))).setPalette("number",p),t.beginnerBlock(!0),t.setHelpString([_("The Number block holds a number."),"documentation",""]),t}return _createClass(r,[{key:"arg",value:function(t,e,r){try{return Number(p.blocks.blockList[r].value)}catch(t){return console.debug(t),0}}}]),r}();(new s).setup(p),(new t).setup(p),(new e).setup(p),(new r).setup(p),(new n).setup(p),(new o).setup(p),(new l).setup(p),(new c).setup(p),(new i).setup(p),(new a).setup(p),(new u).setup(p),(new b).setup(p),(new k).setup(p),(new f).setup(p)}"undefined"!=typeof module&&module.exports&&(module.exports={setupNumberBlocks:setupNumberBlocks});
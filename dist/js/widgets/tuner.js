"use strict";function TunerDisplay(t,e,i){var n=this;this.canvas=t,this.width=e,this.height=i,this.ctx=t.getContext("2d"),this.note="A",this.cents=0,this.frequency=440,this.chromaticMode=!0,this.modeContainer=document.createElement("div"),Object.assign(this.modeContainer.style,{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",display:"flex",backgroundColor:"#FFFFFF",borderRadius:"20px",padding:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}),t.parentElement.appendChild(this.modeContainer);var o=document.createElement("div");Object.assign(o.style,{display:"flex",gap:"4px",position:"relative"}),this.modeContainer.appendChild(o),this.chromaticButton=document.createElement("div"),Object.assign(this.chromaticButton.style,{width:"40px",height:"32px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease"});var r=document.createElement("img");Object.assign(r,{src:"header-icons/chromatic-mode.svg",width:"20",height:"20",alt:""}),this.chromaticButton.appendChild(r),o.appendChild(this.chromaticButton),this.targetPitchButton=document.createElement("div"),Object.assign(this.targetPitchButton.style,{width:"40px",height:"32px",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease"});var a=document.createElement("img");Object.assign(a,{src:"header-icons/target-pitch-mode.svg",width:"20",height:"20",alt:""}),this.targetPitchButton.appendChild(a),o.appendChild(this.targetPitchButton),this.chromaticButton.onclick=function(){n.chromaticMode=!0,n.updateButtonStyles()},this.targetPitchButton.onclick=function(){n.chromaticMode=!1,n.updateButtonStyles()},this.updateButtonStyles()}TunerDisplay.prototype.updateButtonStyles=function(){this.chromaticMode?(this.chromaticButton.style.backgroundColor=platformColor.selectorBackground,this.chromaticButton.querySelector("img").style.filter="brightness(0) invert(1)",this.targetPitchButton.style.backgroundColor="transparent",this.targetPitchButton.querySelector("img").style.filter="none"):(this.targetPitchButton.style.backgroundColor=platformColor.selectorBackground,this.targetPitchButton.querySelector("img").style.filter="brightness(0) invert(1)",this.chromaticButton.style.backgroundColor="transparent",this.chromaticButton.querySelector("img").style.filter="none")},TunerDisplay.prototype.update=function(t,e,i){this.note=t,this.cents=e,this.frequency=i,this.draw()},TunerDisplay.prototype.draw=function(){var t=this.ctx,e=this.width,i=this.height;t.clearRect(0,0,e,i);var n=.8*e,o=(e-n)/2,r=i-80;t.fillStyle="#e0e0e0",t.fillRect(o,r,n,10),t.fillStyle="#000000",t.fillRect(o+n/2-1,r,2,10);var a=o+n/2+this.cents/50*(n/2);t.fillStyle="#ff0000",t.fillRect(a-2,r-5,4,20),t.font="bold 48px Arial",t.textAlign="center",t.fillStyle="#000000",t.fillText(this.note,e/2,i-200),t.font="24px Arial",t.fillText((0<=this.cents?"+":"")+Math.round(this.cents)+"Â¢",e/2,i-160),t.font="18px Arial",t.fillText(this.frequency.toFixed(1)+" Hz",e/2,i-40)};var TunerUtils={frequencyToPitch:function(t){var e=440*Math.pow(2,-4.75);if(t<e)return["C",0,e];var i=Math.round(12*Math.log2(t/e)),n=(Math.floor(i/12),i%12),o=Math.round(1200*Math.log2(t/(e*Math.pow(2,i/12))));return[["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][n],o,t]},calculatePlaybackRate:function(t,e){return Math.pow(2,(t+e)/1200)}};
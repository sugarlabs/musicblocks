"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,n,i,u,l=[],s=!0,a=!1;try{if(i=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=i.call(t)).done)&&(l.push(o.value),l.length!==r);s=!0);}catch(e){a=!0,n=e}finally{try{if(!s&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(a)throw n}}return l}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);var o=t.call(e,r||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}function setupDrumActions(s){Singer.DrumActions=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"GetDrumname",value:function(e){if("http"===e.slice(0,4))return e;for(var r=0,t=Object.entries(DRUMNAMES);r<t.length;r++){var o=_slicedToArray(t[r],2)[1];if(o[0]===e)return o[1];if(o[1]===e)return e}return DEFAULTDRUM}},{key:"playDrum",value:function(e,r,t){var o=Singer.DrumActions.GetDrumname(e),n=s.turtles.ithTurtle(r);0<n.singer.drumStyle.length&&(o=last(n.singer.drumStyle)),0<n.singer.inNoteBlock.length?(n.singer.noteDrums[last(n.singer.inNoteBlock)].push(o),void 0===n.singer.synthVolume[o]&&(n.singer.synthVolume[o]=[DEFAULTVOLUME],n.singer.crescendoInitialVolume[o]=[DEFAULTVOLUME])):(s.logo.clearNoteParams(n,t,[]),n.singer.inNoteBlock.push(t),n.singer.noteDrums[last(n.singer.inNoteBlock)].push(o),Singer.processNote(s,4,!1,t,r,function(){return n.singer.inNoteBlock.splice(n.singer.inNoteBlock.indexOf(t),1)})),n.singer.pushedNote=!0}},{key:"setDrum",value:function(e,r,t){var o=DEFAULTDRUM;for(var n in DRUMNAMES)DRUMNAMES[n][0]===e?o=DRUMNAMES[n][1]:DRUMNAMES[n][1]===e&&(o=e);var i=s.turtles.ithTurtle(r);i.singer.drumStyle.push(o);var u,l="_setdrum_"+r;void 0!==t&&t in s.blocks.blockList?s.logo.setDispatchBlock(t,r,l):!MusicBlocks.isRun||null!==(u=Mouse.getMouseFromTurtle(i))&&u.MB.listeners.push(l);s.logo.setTurtleListener(r,l,function(){i.singer.drumStyle.pop(),i.singer.pitchDrumTable={}}),s.logo.inRhythmRuler&&(s.logo._currentDrumBlock=t,s.logo.rhythmRuler.Drums.push(t),s.logo.rhythmRuler.Rulers.push([[],[]]))}},{key:"mapPitchToDrum",value:function(e,r,t){var o=DEFAULTDRUM;for(var n in DRUMNAMES)DRUMNAMES[n][0]===e?o=DRUMNAMES[n][1]:DRUMNAMES[n][1]===e&&(o=e);var i=s.turtles.ithTurtle(r);i.singer.drumStyle.push(o);var u,l="_mapdrum_"+r;void 0!==t&&t in s.blocks.blockList?s.logo.setDispatchBlock(t,r,l):!MusicBlocks.isRun||null!==(u=Mouse.getMouseFromTurtle(i))&&u.MB.listeners.push(l);s.logo.setTurtleListener(r,l,function(){return i.singer.drumStyle.pop()}),s.logo.inRhythmRuler&&(s.logo._currentDrumBlock=t,s.logo.rhythmRuler.Drums.push(t),s.logo.rhythmRuler.Rulers.push([[],[]]))}},{key:"playNoise",value:function(e,r,t){var o=e;for(var n in NOISENAMES){if(NOISENAMES[n][0]===e){o=NOISENAMES[n][1];break}if(NOISENAMES[n][1]===e){o=e;break}}var i=s.turtles.ithTurtle(r);0<i.singer.inNoteBlock.length?(i.singer.noteDrums[last(i.singer.inNoteBlock)].push(o),void 0===i.singer.synthVolume[o]&&(i.singer.synthVolume[o]=[DEFAULTVOLUME],i.singer.crescendoInitialVolume[o]=[DEFAULTVOLUME]),i.singer.noteBeatValues[last(i.singer.inNoteBlock)].push(i.singer.beatFactor),i.singer.pushedNote=!0):s.errorMsg(_("Noise Block: Did you mean to use a Note block?"),t)}}]),e}()}"undefined"!=typeof module&&module.exports&&(module.exports=setupDrumActions);
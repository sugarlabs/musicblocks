"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0===o)return("string"===t?String:Number)(e);var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function setupToneActions(a){Singer.ToneActions=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"setTimbre",value:function(e,t,o){var r=a.turtles.ithTurtle(t),s=!(r.inSetTimbre=!0),n=e;for(var i in VOICENAMES){if(VOICENAMES[i][0]===e){n=VOICENAMES[i][1],s=!0;break}if(VOICENAMES[i][1]===e){n=e,s=!0;break}}s||"object"!==_typeof(e)||(""!=e[0]?(n="customsample_"+e[0],CUSTOMSAMPLES[n]=[e[1],e[2],e[3]]):n=DEFAULTVOICE),null==n&&(n=DEFAULTVOICE),a.logo.inMatrix&&(a.logo.phraseMaker._instrumentName=n),r.singer.instrumentNames.includes(n)||(r.singer.instrumentNames.push(n),a.logo.synth.loadSynth(t,n),void 0===r.singer.synthVolume[n]&&(r.singer.synthVolume[n]=[last(r.singer.synthVolume[DEFAULTVOICE])],r.singer.crescendoInitialVolume[n]=[last(r.singer.synthVolume[DEFAULTVOICE])]));var l,u="_settimbre_"+t;void 0!==o&&o in a.blocks.blockList?a.logo.setDispatchBlock(o,t,u):!MusicBlocks.isRun||null!==(l=Mouse.getMouseFromTurtle(r))&&l.MB.listeners.push(u);a.logo.setTurtleListener(t,u,function(){r.inSetTimbre=!1,r.singer.instrumentNames.pop()})}},{key:"doVibrato",value:function(e,t,o,r){(e<1||100<e)&&(a.errorMsg(_("Vibrato intensity must be between 1 and 100."),r),a.logo.stopTurtle=!0),t<=0&&(a.errorMsg(_("Vibrato rate must be greater than 0."),r),a.logo.stopTurtle=!0);var s=a.turtles.ithTurtle(o);s.singer.vibratoIntensity.push(e/100),s.singer.vibratoRate.push(1/t);var n,i="_vibrato_"+o;void 0!==r&&r in a.blocks.blockList?a.logo.setDispatchBlock(r,o,i):!MusicBlocks.isRun||null!==(n=Mouse.getMouseFromTurtle(s))&&n.MB.listeners.push(i);a.logo.setTurtleListener(o,i,function(){s.singer.vibratoIntensity.pop(),s.singer.vibratoRate.pop()}),a.logo.inTimbre&&(instrumentsEffects[o][a.logo.timbre.instrumentName].vibratoActive=!0,a.logo.timbre.vibratoEffect.push(r),a.logo.timbre.vibratoParams.push(100*last(s.singer.vibratoIntensity)),instrumentsEffects[o][a.logo.timbre.instrumentName].vibratoIntensity=s.singer.vibratoIntensity,a.logo.timbre.vibratoParams.push(last(s.singer.vibratoRate)),instrumentsEffects[o][a.logo.timbre.instrumentName].vibratoFrequency=t)}},{key:"doChorus",value:function(e,t,o,r,s){((o/=100)<0||1<o)&&(a.errorMsg(_("Depth is out of range."),s),a.logo.stopTurtle=!0);var n=a.turtles.ithTurtle(r);n.singer.chorusRate.push(e),n.singer.delayTime.push(t),n.singer.chorusDepth.push(o);var i,l="_chorus_"+r;void 0!==s&&s in a.blocks.blockList?a.logo.setDispatchBlock(s,r,l):!MusicBlocks.isRun||null!==(i=Mouse.getMouseFromTurtle(n))&&i.MB.listeners.push(l);a.logo.setTurtleListener(r,l,function(){n.singer.chorusRate.pop(),n.singer.delayTime.pop(),n.singer.chorusDepth.pop()})}},{key:"doPhaser",value:function(e,t,o,r,s){var n=a.turtles.ithTurtle(r);n.singer.rate.push(e),n.singer.octaves.push(t),n.singer.baseFrequency.push(o);var i,l="_phaser_"+r;void 0!==s&&s in a.blocks.blockList?a.logo.setDispatchBlock(s,r,l):!MusicBlocks.isRun||null!==(i=Mouse.getMouseFromTurtle(n))&&i.MB.listeners.push(l);a.logo.setTurtleListener(r,l,function(){n.singer.rate.pop(),n.singer.octaves.pop(),n.singer.baseFrequency.pop()})}},{key:"doTremolo",value:function(e,t,o,r){((t/=100)<0||1<t)&&(a.errorMsg(_("Depth is out of range."),r),a.logo.stopTurtle=!0);var s=a.turtles.ithTurtle(o);s.singer.tremoloFrequency.push(e),s.singer.tremoloDepth.push(t);var n,i="_tremolo_"+o;void 0!==r&&r in a.blocks.blockList?a.logo.setDispatchBlock(r,o,i):!MusicBlocks.isRun||null!==(n=Mouse.getMouseFromTurtle(s))&&n.MB.listeners.push(i);a.logo.setTurtleListener(o,i,function(){s.singer.tremoloFrequency.pop(),s.singer.tremoloDepth.pop()})}},{key:"doDistortion",value:function(e,t,o){((e/=100)<0||1<e)&&(a.errorMsg(_("Distortion must be from 0 to 100."),o),a.logo.stopTurtle=!0);var r=a.turtles.ithTurtle(t);r.singer.distortionAmount.push(e);var s,n="_distortion_"+t;void 0!==o&&o in a.blocks.blockList?a.logo.setDispatchBlock(o,t,n):!MusicBlocks.isRun||null!==(s=Mouse.getMouseFromTurtle(r))&&s.MB.listeners.push(n),a.logo.setTurtleListener(t,n,function(){return r.singer.distortionAmount.pop()})}},{key:"doHarmonic",value:function(e,t,o){if("number"!=typeof e||e<0)return a.errorMsg(_("Partial must be greater than or equal to 0.")),void(a.logo.stopTurtle=!0);var r=a.turtles.ithTurtle(t);r.singer.inHarmonic.push(o),r.singer.partials.push([]);for(var s=r.singer.partials.length-1,n=0;n<e;n++)r.singer.partials[s].push(0);r.singer.partials[s].push(1),a.logo.notation.notationBeginHarmonics(t);var i,l="_harmonic_"+t+"_"+o;void 0!==o&&o in a.blocks.blockList?a.logo.setDispatchBlock(o,t,l):!MusicBlocks.isRun||null!==(i=Mouse.getMouseFromTurtle(r))&&i.MB.listeners.push(l);a.logo.setTurtleListener(t,l,function(){r.singer.inHarmonic.pop(),r.singer.partials.pop(),a.logo.notation.notationEndHarmonics(t)})}},{key:"defFMSynth",value:function(e,t,o){a.logo.inTimbre&&(a.logo.timbre.FMSynthParams=[],0!=a.logo.timbre.osc.length&&a.errorMsg(_("Unable to use synth due to existing oscillator"))),null!==e&&"number"==typeof e||(a.errorMsg(NOINPUTERRORMSG,o),e=10),e<0&&(a.errorMsg(_("The input cannot be negative.")),e=-e),a.logo.inTimbre&&(a.logo.timbre.fmSynthParamvals.modulationIndex=e,a.logo.synth.createSynth(t,a.logo.timbre.instrumentName,"fmsynth",a.logo.timbre.fmSynthParamvals),a.logo.timbre.FMSynthesizer.push(o),a.logo.timbre.FMSynthParams.push(e))}},{key:"defAMSynth",value:function(e,t,o){a.logo.inTimbre&&(a.logo.timbre.AMSynthParams=[],0!=a.logo.timbre.osc.length&&a.errorMsg(_("Unable to use synth due to existing oscillator"))),null!==e&&"number"==typeof e||(a.errorMsg(NOINPUTERRORMSG,o),e=1),e<0&&(a.errorMsg(_("The input cannot be negative.")),e=-e),a.logo.inTimbre&&(a.logo.timbre.amSynthParamvals.harmonicity=e,a.logo.synth.createSynth(t,a.logo.timbre.instrumentName,"amsynth",a.logo.timbre.amSynthParamvals),a.logo.timbre.AMSynthesizer.push(o),a.logo.timbre.AMSynthParams.push(e))}},{key:"defDuoSynth",value:function(e,t,o,r){a.logo.inTimbre&&(0!=a.logo.timbre.osc.length&&a.errorMsg(_("Unable to use synth due to existing oscillator")),a.logo.timbre.duoSynthParams=[]),null!==e&&"number"==typeof e||(a.errorMsg(NOINPUTERRORMSG,r),e=10),null!==t&&"number"==typeof t||(a.errorMsg(NOINPUTERRORMSG,r),t=50),e=Math.abs(e),t=Math.abs(t)/100,a.logo.inTimbre&&(a.logo.timbre.duoSynthParamVals.vibratoRate=e,a.logo.timbre.duoSynthParamVals.vibratoAmount=t,a.logo.synth.createSynth(o,a.logo.timbre.instrumentName,"duosynth",a.logo.timbre.duoSynthParamVals),a.logo.timbre.duoSynthesizer.push(r),a.logo.timbre.duoSynthParams.push(e),a.logo.timbre.duoSynthParams.push(t))}}]),e}()}"undefined"!=typeof module&&module.exports&&(module.exports=setupToneActions);
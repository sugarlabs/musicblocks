"use strict";var setupOrnamentActions=require("../OrnamentActions");describe("OrnamentActions",function(){var e,r,a,p,g,x,b,h;beforeEach(function(){a=[],p=[],g=[],x=[],h={},b={listeners:[]},global.Singer={OrnamentActions:null},r={singer:{staccato:[],justCounting:[],inNeighbor:[],neighborStepPitch:[],neighborNoteValue:[]}},e={turtles:{ithTurtle:function(){return r}},blocks:{blockList:{1:{},2:{}}},logo:{setDispatchBlock:function(e,t,n){return a.push({blk:e,turtleIndex:t,listenerName:n})},setTurtleListener:function(e,t,n){p.push({turtleIndex:e,listenerName:t}),h[t]=n},notation:{notationBeginSlur:function(e){return g.push(e)},notationEndSlur:function(e){return x.push(e)}}}},global.MusicBlocks={isRun:!0},global.Mouse={getMouseFromTurtle:function(){return{MB:b}}},setupOrnamentActions(e)}),describe("setStaccato",function(){[{desc:"block defined",blk:1,expectDispatch:!0,expectMouseListener:!1,isRun:!0,nullMouse:!1},{desc:"block undefined",blk:void 0,expectDispatch:!1,expectMouseListener:!0,isRun:!0,nullMouse:!1},{desc:"isRun false",blk:void 0,expectDispatch:!1,expectMouseListener:!1,isRun:!1,nullMouse:!1},{desc:"null mouse",blk:void 0,expectDispatch:!1,expectMouseListener:!1,isRun:!0,nullMouse:!0}].forEach(function(e){var t=e.desc,n=e.blk,s=e.expectDispatch,o=e.expectMouseListener,u=e.isRun,c=e.nullMouse;test(t,function(){global.MusicBlocks.isRun=u,c&&(global.Mouse.getMouseFromTurtle=function(){return null}),Singer.OrnamentActions.setStaccato(2,0,n),expect(r.singer.staccato).toEqual([.5]),expect(a.length).toBe(s?1:0),expect(p.length).toBe(1),o?expect(b.listeners).toContain("_staccato_0"):expect(b.listeners).not.toContain("_staccato_0"),h._staccato_0(),expect(r.singer.staccato).toEqual([])})})}),describe("setSlur",function(){[{desc:"block defined",blk:1,expectDispatch:!0,expectMouseListener:!1,isRun:!0,nullMouse:!1,justCounting:!1,expectBeginSlur:!0},{desc:"block undefined",blk:void 0,expectDispatch:!1,expectMouseListener:!0,isRun:!0,nullMouse:!1,justCounting:!1,expectBeginSlur:!0},{desc:"isRun false",blk:void 0,expectDispatch:!1,expectMouseListener:!1,isRun:!1,nullMouse:!1,justCounting:!1,expectBeginSlur:!0},{desc:"null mouse",blk:void 0,expectDispatch:!1,expectMouseListener:!1,isRun:!0,nullMouse:!0,justCounting:!1,expectBeginSlur:!0},{desc:"justCounting",blk:1,expectDispatch:!0,expectMouseListener:!1,isRun:!0,nullMouse:!1,justCounting:!0,expectBeginSlur:!1}].forEach(function(e){var t=e.desc,n=e.blk,s=e.expectDispatch,o=e.expectMouseListener,u=e.isRun,c=e.nullMouse,i=e.justCounting,l=e.expectBeginSlur;test(t,function(){r.singer.justCounting=i?[1]:[],global.MusicBlocks.isRun=u,c&&(global.Mouse.getMouseFromTurtle=function(){return null}),Singer.OrnamentActions.setSlur(2,0,n),expect(r.singer.staccato).toEqual([-.5]),expect(g.length).toBe(l?1:0),expect(a.length).toBe(s?1:0),expect(p.length).toBe(1),o?expect(b.listeners).toContain("_staccato_0"):expect(b.listeners).not.toContain("_staccato_0"),h._staccato_0(),expect(r.singer.staccato).toEqual([]),expect(x.length).toBe(l?1:0)})})}),describe("doNeighbor",function(){[{desc:"block defined",blk:1,expectDispatch:!0,expectMouseListener:!1,isRun:!0,nullMouse:!1},{desc:"block undefined",blk:void 0,expectDispatch:!1,expectMouseListener:!0,isRun:!0,nullMouse:!1},{desc:"isRun false",blk:void 0,expectDispatch:!1,expectMouseListener:!1,isRun:!1,nullMouse:!1},{desc:"null mouse",blk:void 0,expectDispatch:!1,expectMouseListener:!1,isRun:!0,nullMouse:!0}].forEach(function(e){var t=e.desc,n=e.blk,s=e.expectDispatch,o=e.expectMouseListener,u=e.isRun,c=e.nullMouse;test(t,function(){global.MusicBlocks.isRun=u,c&&(global.Mouse.getMouseFromTurtle=function(){return null}),Singer.OrnamentActions.doNeighbor(3,4,0,n),expect(r.singer.inNeighbor).toEqual([n]),expect(r.singer.neighborStepPitch).toEqual([3]),expect(r.singer.neighborNoteValue).toEqual([4]),expect(a.length).toBe(s?1:0),expect(p.length).toBe(1);var e="_neighbor_0_".concat(n);o?expect(b.listeners).toContain(e):expect(b.listeners).not.toContain(e),h[e](),expect(r.singer.inNeighbor).toEqual([]),expect(r.singer.neighborStepPitch).toEqual([]),expect(r.singer.neighborNoteValue).toEqual([])})})})});